/*



 SoundManager 2: JavaScript Sound for the Web
 ----------------------------------------------
 http://schillmania.com/projects/soundmanager2/

 Copyright (c) 2007, Scott Schiller. All rights reserved.
 Code provided under the BSD License:
 http://schillmania.com/projects/soundmanager2/license.txt

 V2.97a.20130512
*/
YUI.add("panel",function(b,d){var c=b.ClassNameManager.getClassName;b.Panel=b.Base.create("panel",b.Widget,[b.WidgetPosition,b.WidgetStdMod,b.WidgetAutohide,b.WidgetButtons,b.WidgetModality,b.WidgetPositionAlign,b.WidgetPositionConstrain,b.WidgetStack],{BUTTONS:{close:{label:"Close",action:"hide",section:"header",template:'<button type="button" />',classNames:c("button","close")}}},{ATTRS:{buttons:{value:["close"]}}})},"3.17.2",{requires:"widget widget-autohide widget-buttons widget-modality widget-position widget-position-align widget-position-constrain widget-stack widget-stdmod".split(" "),
skinnable:!0});
YUI.add("squarespace-plugin-loading-overlay",function(b){b.namespace("Squarespace.Plugins").LoadingOverlay=b.Base.create("LoadingOverlay",b.Plugin.Base,[],{initializer:function(){this._overlayNode=b.Node.create('<div class="sqs-loading-overlay-node"><div class="title"></div></div>');this._overlayNode.on("mousedown",function(b){b.halt()});this.spinner=new b.Squarespace.Spinner(b.merge(this.get("spinnerConfig"),{render:this._overlayNode}));this.on("spinnerConfigChange",function(b){this.spinner.setAttrs(b.newVal)},this);
this.after("visibleChange",this.syncOverlaySize,this);this.syncOverlaySize();this.get("host").addClass("sqs-loading-overlay-active")},destructor:function(){this.spinner.destroy();this._overlayNode.remove(!0);this.get("host").removeClass("sqs-loading-overlay-active")},syncOverlaySize:function(){this.get("visible")?this._showOverlay():this._hideOverlay()},_showOverlay:function(){var d=this.get("title");this._overlayNode.one(".title").setContent(d);this._overlayNode.toggleClass("has-title",""!==d);d=
this.get("host");this._overlayNode.setStyles({position:"absolute",width:d.get("offsetWidth"),height:d.get("offsetHeight"),top:d.get("offsetTop"),left:d.get("offsetLeft")});d.append(this._overlayNode);(new b.Anim({node:this._overlayNode,duration:0.25,from:{opacity:this._overlayNode.getStyle("opacity")},to:{opacity:1}})).run()},_hideOverlay:function(){this._overlayNode&&this._overlayNode.anim({opacity:0},{from:{opacity:1},end:function(){this._overlayNode&&(null!==this._overlayNode.getDOMNode()&&this._overlayNode.inDoc())&&
this._overlayNode.remove()}},this).run()}},{NS:"loadingOverlay",ATTRS:{visible:{value:!0},title:{value:"",validator:b.Lang.isString},description:{value:""},spinnerConfig:{value:{size:"large",color:"dark"}}}})},"1.0",{requires:["node","plugin","squarespace-spinner"]});
YUI.add("squarespace-content-manager-widgets-products",function(b){b.namespace("Squarespace.ContentManagerWidgets").Products=b.Base.create("ContentManagerProducts",b.Squarespace.ContentManagerWidgets.Gallery,[],{},{CSS_PREFIX:"sqs-content-manager-products",ATTRS:{helpSectionIdentifier:{value:"welcome"}}})},"1.0",{requires:["base","squarespace-ss-widget","squarespace-content-item-grid","squarespace-content-manager-widgets-gallery"]});
YUI.add("squarespace-settings-site-share-buttons",function(b){var d={round:{small:"16",large:"32"},rect:{small:"20",large:"28"}},c=b.namespace("Squarespace.Settings.Site").ShareButtons=b.Base.create("shareButtonSettings",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){window.PINTEREST.f.init({})},destructor:function(){window.PINTEREST.f.hideFloatingButton()},bindUI:function(){c.superclass.bindUI.call(this);this.on("fields-rendered",function(){this._registerEvent(this.getField("pinterestButtonMode").after("dataChange",
this._syncPinterestFieldVisibility,this));this._registerEvent(this.getField("pinterestButtonShape").after("dataChange",this._syncPinterestFieldVisibility,this));this._registerEvent(this.getField("pinterestButtonSize").after("dataChange",this._syncPinterestFieldVisibility,this));this._registerEvent(this.getField("pinterestButtonColor").after("dataChange",this._syncPinterestFieldVisibility,this));this._syncPinterestFieldVisibility();var c=this.getField("pinterestSharingEnabled");this._registerEvent(c.on("dataChange",
function(f){f.newVal&&f.source!=this.name&&(f.preventDefault(),b.Squarespace.Fluent.Confirm({"strings.title":"Activate Share Option","strings.message":"Are you sure you wish to enable Pinterest share buttons? Pinterest sharing is only available for posts with a thumbnail image.",showOverlay:!0}).then(b.bind(function(){c.set("data",!0,{source:this.name})},this)))},this))})},_syncPinterestFieldVisibility:function(){var c=this.getField("pinterestButtonMode"),f=this.getField("pinterestButtonSize"),g=
this.getField("pinterestButtonShape"),h=this.getField("pinterestButtonColor"),k=this.getField("pinterest-preview"),l=k.get("contentBox").one("img").getDOMNode();"disabled"!==c.get("data")?("round"===g.get("data")?h.hide():h.show(),f.show(),g.show(),k.show(),c={hover:!0},g=g.get("data"),f=f.get("data"),c.shape=g,c.height=d[g][f],c.color=h.get("data"),b.config.win.PINTEREST.f.setConfig(c),b.config.win.PINTEREST.f.hideFloatingButton(l),b.config.win.PINTEREST.f.showFloatingButton(l),b.one(b.config.win.PINTEREST.s.floatingButton).addClass("pinterest-button"),
k.get("contentBox").one("img").insert(b.config.win.PINTEREST.s.floatingButton,"before"),b.config.win.PINTEREST.s.floatingButton.onclick=function(){},b.one(b.config.win.PINTEREST.s.floatingButton).on("click",function(b){b.halt()}),this.getField("pinterest-preview").show()):(f.hide(),g.hide(),h.hide(),k.hide(),b.config.win.PINTEREST.f.hideFloatingButton(l),this.getField("pinterest-preview").hide())},_getSanitizedPanelData:function(){var e=c.superclass._getSanitizedPanelData.call(this),f=[];b.Object.each(b.Squarespace.SocialServices,
function(b,c){e[c.toLowerCase()+"SharingEnabled"]&&f.push(b)});return{shareButtonOptions:f,pinterestOverlayOptions:{mode:e.pinterestButtonMode,size:e.pinterestButtonSize,shape:e.pinterestButtonShape,color:e.pinterestButtonColor}}},_processResponseData:function(c){var f=c.shareButtonOptions,d={};b.Lang.isObject(c.pinterestOverlayOptions)?(d.pinterestButtonMode=c.pinterestOverlayOptions.mode,d.pinterestButtonSize=c.pinterestOverlayOptions.size,d.pinterestButtonShape=c.pinterestOverlayOptions.shape,
d.pinterestButtonColor=c.pinterestOverlayOptions.color):d.pinterestButtonMode="disabled";var h={};b.Object.each(b.Squarespace.SocialServices,function(b,c){h[c.toLowerCase()+"SharingEnabled"]=f[b]});return b.merge(h,d)}},{CSS_PREFIX:"sqs-share-buttons-setting-panel",ATTRS:{initialDataUrl:{value:"/api/config/GetSocialSettings"},postChangesAsJson:{value:!0},saveUrl:{value:"/api/config/SaveSocialSettings"},"strings.title":{value:"Share Buttons"},"strings.description":{value:'Some Squarespace templates include <strong>share buttons</strong> that let users share your content with their friends (on your blog posts, for instance).  Turn on the services you wish to enable sharing links for. <a target="new" href="'+
b.Squarespace.HelpLinks.SHARE_BUTTONS+'">Click here for more help regarding sharing buttons.</a>'},fields:{valueFn:function(){return[{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"facebookSharingEnabled","strings.title":"Facebook"}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"twitterSharingEnabled","strings.title":"Twitter"}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"googleSharingEnabled","strings.title":"Google"}},{ctor:b.Squarespace.DialogFields.Check,
config:{className:"dark",name:"linkedinSharingEnabled","strings.title":"Linkedin"}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"stumbleSharingEnabled","strings.title":"StumbleUpon"}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"redditSharingEnabled","strings.title":"Reddit"}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"pinterestSharingEnabled","strings.title":"Pinterest"}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",
name:"tumblrSharingEnabled","strings.title":"Tumblr"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"pinterest-description",title:"Pinterest Pin-It Button",text:'Display options related to displaying a "Pin-It" Pinterest overlay on your website.'}},{ctor:b.Squarespace.DialogFields.LabeledSelect,config:{className:"thin",name:"pinterestButtonMode",options:[{value:"disabled",label:"Disabled"},{value:"enabled_for_blogs",label:"Enabled for Blogs"},{value:"enabled_for_blogs_and_pages",label:"Enabled for Blogs and Pages"}]}},
{ctor:b.Squarespace.DialogFields.LabeledSelect,config:{name:"pinterestButtonSize",className:"thin",width:200,focusable:!1,defaultValue:"small",options:[{value:"small",label:"Small"},{value:"large",label:"Large"}],"strings.title":"Size"}},{ctor:b.Squarespace.DialogFields.LabeledSelect,config:{name:"pinterestButtonShape",className:"thin",width:200,focusable:!1,defaultValue:"rect",options:[{value:"rect",label:"Rectangle"},{value:"round",label:"Circle"}],"strings.title":"Shape"}},{ctor:b.Squarespace.DialogFields.LabeledSelect,
config:{name:"pinterestButtonColor",className:"thin",width:200,focusable:!1,defaultValue:"white",options:[{value:"gray",label:"Gray"},{value:"red",label:"Red"},{value:"white",label:"White"}],"strings.title":"Color"}},{ctor:b.Squarespace.DialogFields.HTML,config:{name:"pinterest-preview",content:{$valueFn:function(){return'<p>Example:</p><img class="demo-image image-'+Math.floor(3*Math.random())+'" />'}}}}]}}}})},"1.0",{requires:"node base-build anim json datatype-number squarespace-settings-panel squarespace-dombuilder squarespace-animations squarespace-dialog-multi-select squarespace-social-share-toggle squarespace-pinterest squarespace-settings-site-share-buttons-template".split(" ")});
YUI.add("squarespace-widgets-newsletters-subscribers-list-manager",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.NewslettersSubscribersListsManager=b.Base.create("NewslettersSubscribersListsManager",b.Squarespace.Widgets.SyncModelListManager,[],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-manager-content");var b=this.get("models");b.after(["firstPage","previousPage","nextPage","currentPage"],function(){b.load()})},renderUI:function(){d.superclass.renderUI.call(this);
this.get("body").set("actionTrayButtons",this._getBodyActionTrayButtons())},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("body");this.get("header").after("currentTabChange",function(){b.set("actionTrayButtons",this._getBodyActionTrayButtons())},this)},_getBodyActionTrayButtons:function(){var b=this.get("body");return[{label:"Remove Selected",action:b.removeSelected,context:b,className:"dark"}]}},{CSS_PREFIX:"sqs-newsletters-subscribers-list-manager",ATTRS:{constructors:{value:{models:b.Squarespace.Models.SiteUserList,
header:b.Squarespace.Widgets.NewslettersSubscribersListHeader,body:b.Squarespace.Widgets.NewslettersSubscribersList}}}})},"1.0",{requires:"base squarespace-enum squarespace-models-site-user-list squarespace-widgets-sync-model-list-manager squarespace-widgets-newsletters-subscribers-list squarespace-widgets-newsletters-subscribers-list-header".split(" ")});
YUI.add("squarespace-models-layout",function(b){var d={type:b.Squarespace.BlockType.HTML,value:{html:""}},c={type:b.Squarespace.BlockType.MARKDOWN},e=b.namespace("Squarespace.Models").PageLayout=b.Base.create("PageLayout",b.Model,[],{toJSON:function(){var b=e.superclass.toJSON.call(this);b.rows=this.get("rows").toJSON();return b},isEmpty:function(){function c(f){b.Lang.isArray(f.rows)&&0<f.rows.length&&b.Array.each(f.rows,c);b.Lang.isArray(f.columns)&&0<f.columns.length&&b.Array.each(f.columns,c);
b.Lang.isArray(f.blocks)&&0<f.blocks.length&&(e+=f.blocks.length)}var e=0;c(this.toJSON());return 0===e},_getDefaultRows:function(){return[{columns:[{span:this.get("columns"),blocks:[this._getDefaultBlock()]}]}]},_getDefaultBlock:function(){return b.Object.getValue(Static,["SQUARESPACE_CONTEXT","websiteSettings","markdownMode"])?c:d},hasPromotedBlock:function(c){var e=this.toJSON();c=this._getPromotedBlockInfo(e,c);return b.Lang.isObject(c)&&c.span==this.get("columns")},_getPromotedBlockInfo:function(c,
e){if(b.Lang.isArray(c.rows)&&0<c.rows.length)return this._getPromotedBlockInfo(c.rows[0],e);if(b.Lang.isArray(c.columns)&&0<c.columns.length)return this._getPromotedBlockInfo(c.columns[0],e);if(b.Lang.isArray(c.blocks)&&0<c.blocks.length){var f=c.blocks[0];return b.Lang.isValue(f.floatDir)||-1===e.indexOf(f.type)?!1:{block:f,span:c.span,parentBlocksList:c.blocks}}},getPageLayoutSansPromotedBlock:function(c){var f=b.clone(this.toJSON());c=this._getPromotedBlockInfo(f,c);b.Lang.isObject(c)&&c.span==
this.get("columns")&&c.parentBlocksList.remove(c.block);return new e(b.merge(f,{columns:this.get("columns")}))},getPageLayoutWithPromotedBlock:function(c){var f=this.toJSON();c=this._getPromotedBlockInfo(f,c);if(!b.Lang.isObject(c)||c.span!==this.get("columns"))return new e({columns:this.get("columns")});f=b.clone(c.block);return new e({rows:[{columns:[{blocks:[f],span:c.span}]}]})}},{ATTRS:{rows:{valueFn:"_getDefaultRows",setter:function(c){if(b.Lang.isArray(c))return 0===c.length&&(c=this._getDefaultRows()),
new l({items:c});if(b.instanceOf(c,l))return c}},columns:{value:12}}}),f=b.namespace("Squarespace.Models").EditableContentBlock=b.Base.create("EditableContentBlock",b.Model,[],{toJSON:function(){var c=f.superclass.toJSON.call(this);c.layout=this.get("layout").toJSON();b.Lang.isValue(c.updatedOn)||(c.updatedOn=new Date);c.updatedOn=c.updatedOn.getTime();return c},_setLayout:function(c){var f=this.get("layout");return b.instanceOf(f,e)?(f.setAttrs(c),f):b.instanceOf(c,e)?c:new e(c)}},{ATTRS:{layout:{valueFn:function(){return new e},
setter:"_setLayout"},updatedOn:{setter:function(c){if(b.Lang.isNumber(c))return new Date(c);if(b.Lang.isDate(c))return c;console.warn("Invalid updatedOn field set: ",c);return b.Attribute.INVALID_VALUE}}}}),g=b.namespace("Squarespace.Models").PageCollectionData=b.Base.create("Layout",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.API_ROOT+"page-collection-data/{collectionId}",root:b.Squarespace.API_ROOT+"page-collection-data",isNew:function(){return!b.Lang.isValue(this.get("collectionId"))},
_setData:function(c){var e=this.get("data");return b.instanceOf(e,f)?(e.setAttrs(c),e):b.instanceOf(c,f)?c:new f(c)},toJSON:function(){var b=g.superclass.toJSON.call(this);delete b.collection;return b},parse:function(c){c=g.superclass.parse.call(this,c);b.Lang.isObject(c)||(c={});b.Lang.isObject(c.data)||(c.data={layout:{columns:12,rows:[]}});return c}},{ATTRS:{collectionId:{getter:function(){return this.get("collection").get("id")}},collection:{},data:{value:{},setter:"_setData"}}});b.namespace("Squarespace.Models").BlockField=
b.Base.create("BlockField",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.API_ROOT+"block-fields/{widgetName}",root:b.Squarespace.API_ROOT+"block-fields",idAttribute:"widgetName",_setData:function(c){var e=this.get("data");return b.instanceOf(e,f)?(e.setAttrs(c),e):b.instanceOf(c,f)?c:new f(c)}},{ATTRS:{widgetName:{validator:b.Lang.isString},data:{value:{},setter:"_setData"}}});var h=b.Base.create("BlockList",b.ModelList,[],{});b.Base.create("Column",b.Model,[],{},{ATTRS:{blocks:{value:[],
setter:function(c){if(b.Lang.isArray(c))return new h({items:c});if(b.instanceOf(c,h))return c}}}});var k=b.Base.create("Row",b.Model,[],{}),l=b.Base.create("RowList",b.ModelList,[],{model:k})},"1.0",{requires:["base-build","model","model-list","squarespace-save-manager","squarespace-model-sync-rest"]});
YUI.add("squarespace-settings-sessions",function(b){var d=b.Base.create("SessionList",b.Squarespace.DialogField2,[],{initializer:function(){this.sessions=new b.Squarespace.Models.SessionList;this.sessions.once("load",function(){this.view=new c({model:this.sessions});this.get("contentBox").append(this.view.get("container"));this.syncUI()},this);this.sessions.load()},syncUI:function(){this.view&&this.view.render()}}),c=b.Base.create("SessionList",b.Squarespace.View,[],{events:{".delete":{click:"removeSession"}},
template:"settings-sessions-list.html",initializer:function(){c.superclass.initializer.apply(this,arguments);this.get("model").after(["add","remove","reset"],this.render,this)},_getTemplateContext:function(){return{sessions:this.get("model").toJSON()}},removeSession:function(c){c=c.target.ancestor(".session-item");var f=c.get("id");c.plug(b.Squarespace.Animations.Expandable,{duration:0.15});c.once("closed",function(){this.get("model").getById(f).destroy({remove:!0});new b.Squarespace.Widgets.Information({"strings.title":"Session Removed",
"strings.message":"The selected session has been deauthorized."})},this);c.hide()}},{ATTRS:{}});b.namespace("Squarespace.Widgets").SessionSettings=b.Base.create("sessionSettings",b.Squarespace.Widgets.SettingsPanel,[],{},{CSS_PREFIX:"sqs-settings-sessions",ATTRS:{buttons:{value:[]},"strings.title":{value:"Active Sessions"},"strings.description":{value:"When logging into Squarespace you can use the &ldquo;Stay Logged In&rdquo; option to have Squarespace automatically log you into the same machine without a password. To forget a machine and require your password next time, click &ldquo;delete&rdquo; next to the login you'd like to remove."},
fields:{value:[{ctor:d,config:{name:"sessions"}}]}}})},"1.0",{requires:"squarespace-dombuilder squarespace-settings-panel squarespace-model-session squarespace-view squarespace-settings-sessions-list-template squarespace-animations squarespace-hb-humanizedate-format squarespace-hb-date-format squarespace-widgets-information".split(" ")});
YUI.add("squarespace-newsletters-draft-messages-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["newsletters-draft-messages.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f,h;e='\n    <div class="message">\n      <div class="item" id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===r?f.apply(b):f);e+=s(f)+'">\n        <div class="thumbnail"><img src=""></img></div>\n        <div class="subject">';if((f=d["if"].call(b,b.subject,{hash:{},
inverse:t.program(5,q,c),fn:t.program(3,p,c),data:c}))||0===f)e+=f;h={hash:{},data:c};return e=e+'</div>\n        <div class="meta">\n          <span class="updatedOn">'+(s((f=d["humanizedate-format"]||b["humanizedate-format"],f?f.call(b,b.updatedOn,h):u.call(b,"humanizedate-format",b.updatedOn,h)))+'</span>\n          \x3c!-- <span class="authorName">Julien Feasson</span> --\x3e\n        </div>\n      </div>\n    </div>\n  ')}function p(b,c){var e;(e=d.subject)?e=e.call(b,{hash:{},data:c}):(e=b.subject,
e=typeof e===r?e.apply(b):e);return s(e)}function q(b,c){return"New Message"}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var r="function",s=this.escapeExpression,t=this,u=d.helperMissing;if((c=d["if"].call(c,c.drafts,{hash:{},inverse:t.noop,fn:t.program(1,function(b,c){var e,f;e='\n<div class="field-wrapper newsletters-draft-messages-list">\n    <div class="title"><span>Drafts</span></div>\n  ';if((f=d.each.call(b,b.drafts,{hash:{},inverse:t.noop,fn:t.program(2,l,c),data:c}))||
0===f)e+=f;return e+"\n</div>\n"},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("newsletters-draft-messages.html".replace("/","."),d.templates["newsletters-draft-messages.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-content-manager-navigation-ui-utils",function(b){b.namespace("Squarespace").NavigationUIUtils={deleteNavigationItem:function(d){if(!d)throw"Unknown entity trying to be deleted.";var c="Delete "+b.Escape.html(d.get("title")),e="Are you sure you want to delete <strong>"+b.Escape.html(d.get("title"))+"</strong>?",f=b.Lang.isValue(d.get("collectionId")),g=!d.get("children").isEmpty();if(f&&d.get("collectionId")===b.Squarespace.Singletons.Template.get("homepageCollectionId"))return new b.Squarespace.Widgets.Alert({"strings.title":"Cannot Delete Homepage",
"strings.message":"This page cannot be deleted because it is your homepage. Please assign a new homepage before deleting this homepage."}),b.Promise.reject("Cannot Delete Homepage");f&&(d.get("collection").get("isDemoCollection")?(c="Remove Example Page",e="Are you sure you wish to remove this example page?"):e+=" <strong>All contained data will be deleted.</strong>");return b.Squarespace.Fluent.Confirm({"strings.title":c,"strings.message":e,"strings.confirm":"Delete"}).then(function(){f&&g&&d.get("children").each(function(b){b.destroy({remove:!0})});
d.destroy({remove:!0})})},deleteCollection:function(d){d=d.get("id");var c=b.Squarespace.Singletons.Template.get("navigations").getNavigationItemForCollectionId(d);if(!c)throw"Could not find the navigation item for collection #"+d;return this.deleteNavigationItem(c)}}},"1.0",{requires:["squarespace-fluent-confirmation","squarespace-widgets-alert"]});
YUI.add("squarespace-block-in-browser-message-link-editor",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.InBrowserMessageLink=b.Base.create("in-browser-message-link-block-editor",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(){this.get("host").set("floatable",!1);this.set("lockedLayout",!0);this._model.get("hideLink")&&this._toggleHideLink(!0);this._model.on("hideLinkChange",function(b){this._toggleHideLink(b.newVal)},this);this.afterHostEvent("widget:contentUpdate",
function(){this._model.get("hideLink")&&this._cb.setHTML('<span class="sqs-restore-in-browser-message-link-message">"Having trouble" link disabled. (Double click to re-enable)</span>')},this)},_toggleHideLink:function(b){this._bb.toggleClass("sqs-hide-link",b)},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.InBrowserMessageLink")}},{NS:"blockEditor",ATTRS:{blockName:{value:"InBrowserMessageLink"},minHSize:{value:6}}});b.namespace("Squarespace.Block.ModelEditorDialog").InBrowserMessageLink=
b.Base.create("blockInBrowserMessageLinkEditor",b.Squarespace.ModelEditorDialog,[],{},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={initialDataByReference:!0,name:"editInBrowserMessageLinkBlock",width:500,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit View on Web Settings",icon:"/universal/images-v6/icons/icon-link-16-light-solid.png",scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:'Configure the "Having trouble" link at the top of your email.'}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"webviewText",validator:function(c){return b.Lang.isString(c)&&0<c.length}}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"hideLink",defaultValue:!1,"strings.title":"Disable Webview Link","strings.description":"Your email won't include a link to view in a browser"}}]}]}},"1.0",{requires:"base squarespace-attr-validators squarespace-block-editor-base squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-description squarespace-dialog-select squarespace-model-editor".split(" ")});
YUI.add("squarespace-models-inventory",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.Inventory=b.Base.create("Inventory",b.Squarespace.Models.ModelList,[b.Squarespace.Mixins.SortableModelList],{model:b.Squarespace.Models.ContentItem,url:b.Squarespace.API_ROOT+"commerce/inventory",initializer:function(){this.after("*:save",function(b){b=b.target;this.remove(b);this.add(b)},this)}},{getViolation:function(c){b.Data.get({url:"/api/commerce/inventory/violation",success:function(e){b.Lang.isFunction(c)&&
c(e)}})},getProductStock:function(c,e){b.Data.get({url:"/api/commerce/inventory/stock",data:{itemId:c.join(",")},success:function(c){b.Lang.isFunction(e)&&e(c)}})},_itemComparator:function(c){c=c.get("title");return b.Lang.isValue(c)?c.toLowerCase():null},_priceComparator:function(c){return b.Squarespace.ProductUtils.getProductAveragePrice(c)},_stockComparator:function(c){return b.Squarespace.ProductUtils.getProductEffectiveStock(c)},SORT_TYPES:{ITEM:1,PRICE:2,STOCK:3},ATTRS:{comparators:{valueFn:function(){var b=
{};b[d.SORT_TYPES.ITEM]=d._itemComparator;b[d.SORT_TYPES.PRICE]=d._priceComparator;b[d.SORT_TYPES.STOCK]=d._stockComparator;return b}},sortType:{valueFn:function(){return d.SORT_TYPES.ITEM}}}})},"1.0",{requires:"base squarespace-mixins-sortable-model-list squarespace-models-model-list squarespace-models-content-item squarespace-product-utils squarespace-util".split(" ")});
YUI.add("squarespace-editor-commerce-coupon",function(b){b.namespace("Squarespace.Editor");b.Squarespace.Editor.CommerceCoupon=b.Base.create("CommerceCoupon",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this._bindDialog()},_bindDialog:function(){var d=this.get("dialog"),c=this.get("model");d.on("remove-requested",function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Delete Coupon","strings.message":"Are you sure you wish to delete this coupon? This action cannot be undone."})).on("confirm",
function(){c.destroy({remove:!0});d.close()},this)},this);d.on("button-toggleActive",function(){c.set("active",!c.get("active"));c.save();d.close()},this);d.on("ready",function(){d.getField("startDate").after("dataChange",this._adjustEndDate,this)},this)},_adjustEndDate:function(b){var c=this.get("dialog").getField("endDate"),e=parseInt(b.prevVal,10);b=parseInt(b.newVal,10);e=c.get("data")-e;c.set("data",(new Date(b+e)).getTime())},_getDialogConfig:function(){return{name:"editCoupon",style:"flyout",
savingText:"Saving coupon...",overlay:0.5,width:600,height:445,closeOthers:!1,discardChangesConfirmation:!0,title:"Edit Coupon",icon:"/universal/images-v6/icons/icon-plus-16-light.png",tabs:[{tabTitle:"Coupon Details",fields:[{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:this.get("couponTitles")[this.get("model").get("type")]+": "+this.get("discountTitles")[this.get("model").get("discountType")],text:this.get("couponLongDescriptions")[this.get("model").get("type")]}},
{ctor:b.Squarespace.DialogFields.Text,config:{width:255,className:"thin",name:"name","strings.title":"Coupon Name","strings.description":'The name you want to call this coupon, eg. "Labor Day Special".',required:!0}},{ctor:b.Squarespace.DialogFields.PromoCodeField,config:{width:255,className:"thin",name:"promoCode","strings.title":"Promo Code","strings.description":'The code customers must enter at checkout to redeem this, eg. "laborday2012".',required:!0}}]},{$when:function(d){return d.get("type")===
b.Squarespace.CommerceCouponType.SINGLE_PRODUCT},ctor:b.Squarespace.DialogFields.ProductChooser,config:{name:"productId",maxResults:5,required:!0}},{$when:function(d){return d.get("type")===b.Squarespace.CommerceCouponType.CATEGORIES},ctor:b.Squarespace.DialogFields.CategorySelector,config:{name:"categories",categories:this.get("validCouponCategories"),"strings.title":"Categories"}},{type:"splitter",fields:[{$when:function(d){return d.get("discountType")===b.Squarespace.CommerceDiscountType.FLAT},
ctor:b.Squarespace.DialogFields.MoneyText,config:{width:255,name:"discountAmt","strings.title":"Flat Discount"}},{$when:function(d){return d.get("discountType")===b.Squarespace.CommerceDiscountType.PERCENTAGE},ctor:b.Squarespace.DialogFields.NumericText,config:{name:"discountAmt","strings.title":"Discount (%)","strings.validationFailMessage":"Percent discount must be a whole number.",width:255,validator:function(d){return b.Lang.isNumber(Number(d))&&0===d%1}}},{$when:function(d){return d.get("type")===
b.Squarespace.CommerceCouponType.ORDERS_OVER},ctor:b.Squarespace.DialogFields.MoneyText,config:{width:255,name:"minPrice","strings.title":"Minimum Price"}}]},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.TextDateTimePicker,config:{"strings.title":"Start Date",width:0.5,className:"event-datetime-picker thin",name:"startDate",direction:"up"}},{ctor:b.Squarespace.DialogFields.TextDateTimePicker,config:{width:0.5,"strings.title":"End Date",className:"event-datetime-picker thin",name:"endDate",
validator:function(b){return b>this.get("dialog").getField("startDate").get("data")},"strings.errorMessage":"End time must be later than start time.",direction:"up"}}]}]}],buttons:[{type:"cancel",title:"Cancel"},{$when:function(b){return null!==b.get("id")},type:"toggleActive",title:this.get("model").get("active")?"Deactivate":"Activate"},{$when:function(b){return null!==b.get("id")},type:"remove",title:"Delete Coupon"},{type:"saveAndClose",title:"Save"}]}}},{ATTRS:{model:{value:null,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.CommerceCoupon),
writeOnce:"initOnly"},dialogConfig:{getter:function(){return this._getDialogConfig()}},couponTitles:{valueFn:function(){var d={};d[b.Squarespace.CommerceCouponType.ALL_ORDERS]="Apply a discount to any order";d[b.Squarespace.CommerceCouponType.ORDERS_OVER]="Apply a discount to orders over a minimum subtotal";d[b.Squarespace.CommerceCouponType.CATEGORIES]="Apply a discount to products in chosen categories";d[b.Squarespace.CommerceCouponType.SINGLE_PRODUCT]="Apply a discount to a single product";return d},
readOnly:!0},couponLongDescriptions:{valueFn:function(){var d={};d[b.Squarespace.CommerceCouponType.ALL_ORDERS]="A customer with this coupon receives a discount to any order.";d[b.Squarespace.CommerceCouponType.ORDERS_OVER]="A customer with this coupon only receives a discount for orders over a certain amount.";d[b.Squarespace.CommerceCouponType.CATEGORIES]="A customer with this coupon receives a discount for each item in their shopping cart that is in the categories of your choosing.";d[b.Squarespace.CommerceCouponType.SINGLE_PRODUCT]=
"Useful for promoting a single item. You may search for one of the products in your store to discount.";return d},readOnly:!0},discountTitles:{valueFn:function(){var d={};d[b.Squarespace.CommerceDiscountType.FLAT]="Flat Discount";d[b.Squarespace.CommerceDiscountType.PERCENTAGE]="Percentage Discount";d[b.Squarespace.CommerceDiscountType.FREE_SHIPPING]="Free Shipping";return d},readOnly:!0},validCouponCategories:{value:[],writeOnce:"initOnly"}}})},"1.0",{requires:"base promise squarespace-attr-validators squarespace-dialog-text-datetime-picker squarespace-dialog-category-selector squarespace-dialog-product-chooser squarespace-dialog-promo-code-field squarespace-dialog-text squarespace-model-editor squarespace-models-commerce-coupon squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-widgets-google-places-autocomplete",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.GooglePlacesAutocomplete=b.Base.create("GooglePlacesAutoCompleteWidget",b.Squarespace.Widgets.ScrollingAutoCompleteList,[b.Squarespace.Mixins.GooglePlacesAutocomplete],{},{CSS_PREFIX:b.Squarespace.Widgets.ScrollingAutoCompleteList.CSS_PREFIX})},"1.0",{requires:["base","squarespace-scrolling-auto-complete-list","squarespace-mixins-google-places-autocomplete"]});
YUI.add("squarespace-content-manager-blog-item-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["content-manager-blog-item.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e="\n          <span class='status'>";(f=d.message)?f=f.call(b,{hash:{},data:c}):(f=b.message,f=typeof f===s?f.apply(b):f);return e+=t(f)+"</span>\n        "}function p(b,c){var e,f;e={hash:{format:"%a, %b %d"},data:c};return e='\n        <span class="publish-on">'+(t((f=d["date-format"]||
b["date-format"],f?f.call(b,b.publishOn,e):w.call(b,"date-format",b.publishOn,e)))+"</span>\n      ")}function q(b,c){var e,f;e="\n        ";if((f=d["if"].call(b,b.addedOn,{hash:{},inverse:u.noop,fn:u.program(20,r,c),data:c}))||0===f)e+=f;return e+"\n      "}function r(b,c){var e,f;e={hash:{format:"%a, %b %d"},data:c};return e='\n          <span class="added-on">'+(t((f=d["date-format"]||b["date-format"],f?f.call(b,b.addedOn,e):w.call(b,"date-format",b.addedOn,e)))+"</span>\n        ")}this.compilerInfo=
[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var s="function",t=this.escapeExpression,u=this,v=d.blockHelperMissing,w=d.helperMissing;b='<div class="blog-list-item ';if((h=d["if"].call(c,c.coverImageUrl,{hash:{},inverse:u.noop,fn:u.program(1,function(b,c){return"has-thumbnail"},k),data:k}))||0===h)b+=h;b+=" ";if((h=d["if"].call(c,c.commentCount,{hash:{},inverse:u.noop,fn:u.program(3,function(b,c){return"has-comments"},k),data:k}))||0===h)b+=h;b+='">\n    ';if((h=d["if"].call(c,c.coverImageUrl,
{hash:{},inverse:u.program(7,function(b,c){return'\n    <div class="thumbnail">\n    '},k),fn:u.program(5,function(b,c){var e,f;e='\n    <div class="thumbnail" style="background-image: url(';(f=d.coverImageUrl)?f=f.call(b,{hash:{},data:c}):(f=b.coverImageUrl,f=typeof f===s?f.apply(b):f);return e+=t(f)+'?format=100w)">\n\n    '},k),data:k}))||0===h)b+=h;b+='\n    </div>\n\n  <header class="blog-list-item-header">\n    <h2>\n      ';if((h=d["if"].call(c,c.title,{hash:{},inverse:u.program(12,function(b,
c){return'\n        <span class="no-title">No Title</span>\n      '},k),fn:u.program(9,function(b,c){var e,f,h;e="\n        ";h={hash:{},inverse:u.noop,fn:u.program(10,l,c),data:c};(f=d.flag)?f=f.call(b,h):(f=b.flag,f=typeof f===s?f.apply(b):f);d.flag||(f=v.call(b,f,h));if(f||0===f)e+=f;e+="\n        ";(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=typeof f===s?f.apply(b):f);return e+=t(f)+"\n      "},k),data:k}))||0===h)b+=h;b+='\n    </h2>\n  </header>\n\n  <div class="meta">\n    ';if((h=
d["if"].call(c,c.eventDateDescriptor,{hash:{},inverse:u.program(16,function(b,c){var e,f;e="\n      ";if((f=d["if"].call(b,b.publishOn,{hash:{},inverse:u.program(19,q,c),fn:u.program(17,p,c),data:c}))||0===f)e+=f;return e+"\n    "},k),fn:u.program(14,function(b,c){var e,f;e='\n      <span class="event">';(f=d.eventDateDescriptor)?f=f.call(b,{hash:{},data:c}):(f=b.eventDateDescriptor,f=typeof f===s?f.apply(b):f);if(f||0===f)e+=f;return e+"</span>\n    "},k),data:k}))||0===h)b+=h;b+='\n\n    <span class="author-name">'+
t((h=(h=c.author,null==h||!1===h?h:h.displayName),typeof h===s?h.apply(c):h))+'</span>\n    <span class="number-of-likes">';(h=d.likeCount)?h=h.call(c,{hash:{},data:k}):(h=c.likeCount,h=typeof h===s?h.apply(c):h);b+=t(h)+" Likes</span>\n\n    ";if((h=d["if"].call(c,c.commentCount,{hash:{},inverse:u.noop,fn:u.program(22,function(b,c){var e,f;e='\n      <span class="comment-count">';(f=d.commentCount)?f=f.call(b,{hash:{},data:c}):(f=b.commentCount,f=typeof f===s?f.apply(b):f);return e+=t(f)+"</span>\n    "},
k),data:k}))||0===h)b+=h;b+='\n  </div>\n\n  <div class="preview">\n    <a href="';(h=d.fullUrl)?h=h.call(c,{hash:{},data:k}):(h=c.fullUrl,h=typeof h===s?h.apply(c):h);b+=t(h)+'" class="icon icon-';(h=d.recordTypeLabel)?h=h.call(c,{hash:{},data:k}):(h=c.recordTypeLabel,h=typeof h===s?h.apply(c):h);b+=t(h)+'">\n      Preview ';(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h=typeof h===s?h.apply(c):h);b+=t(h)+'\n\n      <span class="arrow"></span>\n    </a>\n  </div>\n\n  ';k={hash:{},inverse:u.noop,
fn:u.program(24,function(b,c){var e,f;e='\n    <div class="flag ';(f=d.className)?f=f.call(b,{hash:{},data:c}):(f=b.className,f=typeof f===s?f.apply(b):f);e+=t(f)+'">\n      ';(f=d.message)?f=f.call(b,{hash:{},data:c}):(f=b.message,f=typeof f===s?f.apply(b):f);return e+=t(f)+"\n    </div>\n  "},k),data:k};(h=d.flag)?h=h.call(c,k):(h=c.flag,h=typeof h===s?h.apply(c):h);d.flag||(h=v.call(c,h,k));if(h||0===h)b+=h;return b+"\n</div>"})})();b.Handlebars.registerPartial("content-manager-blog-item.html".replace("/",
"."),d.templates["content-manager-blog-item.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-social-summary-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");var d=b.Squarespace.Block.ModelEditorDialog.SocialSummary=b.Base.create("SocialSummaryModelEditorDialog",b.Squarespace.Block.ModelEditorDialog.Summary,[],{initializer:function(b){this._publishEvents();this.after(["collection-synced","collection-sync-failed"],this._afterSyncAccount,this)},_publishEvents:function(){this.publish("accounts-refreshed",{emitFacade:!0,defaultFn:this._afterAccountsRefresh});
this.publish("collection-synced",{emitFacade:!0,defaultFn:this._onSyncSuccess});this.publish("collection-sync-failed",{emitFacade:!0,defaultFn:this._onSyncFail})},_refreshSocialAccounts:function(){b.Data.get({url:"/api/config/GetSocialAccounts",success:this._refreshSocialAccountsSuccess},this)},_refreshSocialAccountsSuccess:function(b){this._oauthRequestPending&&b.connectedAccounts.length>Static.SQUARESPACE_CONTEXT.connectedAccounts.length&&this._showOauthCompletePopup();this._oauthRequestPending=
!1;Static.SQUARESPACE_CONTEXT.connectedAccounts=b.connectedAccounts;this.fire("accounts-refreshed")},_afterAccountsRefresh:function(){var c=this.get("dialog");if(c&&!c.isState(b.Squarespace.DialogStates.CLOSED)&&(c=c.getField("collectionId"))){var e=this._getCollectionOptions();c.set("options",e);0<e.length?(c.set("visible",!0),c.set("data",e[0].value)):c.set("data",null)}},_showOauthCompletePopup:function(){new b.Squarespace.Widgets.Information({"strings.title":"Account Connected","strings.message":b.Lang.sub("Your {name} account has been connected",
this.get("strings"))})},_getCollectionOptions:function(){var c=[],e=Static.SQUARESPACE_CONTEXT.connectedAccounts.sort(function(b,c){return 0+(b.addedOn<c.addedOn)});if(!b.Lang.isValue(this.get("model").get("collectionId"))||""===this.get("model").get("collectionId"))c=[{value:"",label:"Choose an account"}];return b.Array.reduce(e,c,function(b,c,e,d){c.collectionId&&c.serviceId==this.get("socialAccountType")&&b.push(this._createSelectOption(c.collectionId,c.screenname));return b},this)},_onAddAccountClick:function(){this._oauthPopup()},
_oauthPopup:function(){var c=this.get("socialAccountType"),e;e="serviceProvider="+c+"&type=website&startSubscription=true";c===b.Squarespace.ExternalServiceProviders.FACEBOOK&&(e=e+"&redirArgs="+encodeURIComponent("scope="+b.Squarespace.FacebookExtendedPermissions));clientKey=b.guid();e+="&clientKey="+clientKey;this.once("oauth-completed",function(){this._accountRefreshHandle&&(this._accountRefreshHandle.detach(),this._accountRefreshHandle=null);this._refreshSocialAccounts()});this._oauthRequestPending=
!0;this._oauthWindow=window.open("/auth/ExternalAuthenticationInitiate?"+e,"AddConnectedAccount","location=0,status=0,width=1020,height=520");this.closeCheckHandle=b.later(500,this,this._closeCheck,{},!0)},_closeCheck:function(){if(this._oauthWindow.closed||window.callbackFinished)window.callbackFinished=!1,this.closeCheckHandle.cancel(),this.fire("oauth-completed")},_onSendRequested:function(c){var e=this.get("model").get("collectionId"),f=b.Array.find(Static.SQUARESPACE_CONTEXT.connectedAccounts,
function(b){return b.collectionId===e});f&&(c.preventDefault(),this._syncAccount(f))},_syncAccount:function(c){b.Data.post({url:"/api/config/PullRecentActivity",data:{accountId:c.id},failure:function(){this.fire("collection-sync-failed")},success:function(b){c.pullEnabled=!0;b.synced?this.fire("collection-synced"):this._afterSyncAccount()}},this)},_onSyncSuccess:function(c){c=b.Lang.sub("Retrieving past {itemTypePlural}.  Squarespace will pull future {itemTypePlural} from {name} automatically.",this.get("strings"));
new b.Squarespace.Widgets.Information({"strings.title":"Sync Successful","strings.message":c})},_onSyncFail:function(c){c=b.Lang.sub("Failed to retrieve past {itemTypePlural}. Squarespace will pull future {itemTypePlural} from {name} automatically.",this.get("strings"));(new b.Squarespace.Error({position:"top-right"})).show("Sync Failed",c)},_afterSyncAccount:function(){d.superclass._onSendRequested.call(this)},_getDefaultDialogConfig:function(){var c=this.get("icon"),e=this.get("strings.name"),f=
{name:"collectionId",icon:c,className:"thin dark",padding:[10,10],visible:0<this._getCollectionOptions().length,options:this._getCollectionOptions()};f.visible&&!this.get("model").get("collectionId")&&(f.data=f.options[0].value,f.defaultValue=f.options[0].value);return{closeOthers:!1,name:"block-configuration",style:"flyout",flyoutPointerDirection:"hidden",draggable:9!==b.UA.ie&&10!==b.UA.ie,loadingText:"Editing "+e+"...",width:395,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},
{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit "+e+" Block",tabTitle:"Account",icon:"/universal/images-v6/icons/icon-"+c+"-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Connected Account.</strong>  Pick the account below you would like to import content from, or press Add Account to connect a new one."}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Select,config:f},{ctor:b.Squarespace.DialogFields.Button,config:{alignment:"right","strings.text":"Add Account",
name:"addAccount",onClick:b.bind(this._onAddAccountClick,this)}}]},{ctor:b.Squarespace.DialogFields.Description,config:{padding:[15,0],text:"<strong>Items to Display.</strong>  Select the number of items this block should display."}},{ctor:b.Squarespace.DialogFields.Slider,required:!0,config:{name:"pageSize",range:[1,20],"strings.suffix":"Item",pluralize:!0,labelWidth:60,submitOnEnter:!0}}]}]}}},{ATTRS:{dialogConfig:{valueFn:void 0,getter:"_getDefaultDialogConfig",validator:b.Lang.isObject},strings:{value:{name:"Summary",
itemType:"Social Item",itemTypePlural:"Social Items"}},socialAccountType:{value:null}}})},"1.0",{requires:"base model squarespace-model-editor squarespace-dialog-select squarespace-dialog-button squarespace-dialog-slider squarespace-block-summary-model-editor squarespace-widgets-information".split(" ")});
YUI.add("squarespace-block-foursquare",function(b){b.namespace("Squarespace.Block").Foursquare=b.Base.create("block-foursquare",b.Squarespace.Block.SocialSummaryBase,[],{},{CSS_PREFIX:"sqs-block-foursquare",MODEL:b.Squarespace.ContentModel.FoursquareBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Foursquare},type:{value:b.Squarespace.BlockType.FOURSQUARE}}})},"1.0",{requires:["base","squarespace-enum","squarespace-block-social-summary","squarespace-block-foursquare-editor","squarespace-block-foursquare-model"]});
YUI.add("squarespace-dialog-layout",function(b){b.namespace("Squarespace.DialogFields");b.namespace("Squarespace.Block.Editor");var d=b.Squarespace.DialogFields.Layout=b.Base.create("Layout",b.Squarespace.DialogField2,[b.Squarespace.Mixins.Recoverable],{initializer:function(){this._didDataChange=!1;this.publish("recovery-requested",{emitFacade:!0});this.publish("recovery-keep",{emitFacade:!0});this.publish("recovery-discard",{emitFacade:!0})},destructor:function(){var c=b.Squarespace.EditControllerWebApp.getInstance();
c.destroyLayoutEditor(this.getLayoutNode());c.destroyBlockTrashInstance();for(c=b.Array.some(b.Squarespace.Block.Editor.OPEN_DIALOGS,function(b){return b.layout===this.get("contentBox")},this);c&&b.Squarespace.Block.Editor.OPEN_DIALOGS&&b.Squarespace.Block.Editor.OPEN_DIALOGS.length;)b.Squarespace.Block.Editor.OPEN_DIALOGS.shift().dialog.close()},renderUI:function(){this._recoveryBar=this.get("contentBox").appendChild('<div class="sqs-recovery-bar"><span class="text">'+this.get("strings.recoveryMessage")+
"</span></div>");var c=b.Node.create('<div class="button-holder"></div>');this.add(new b.Squarespace.Widgets.Button({strings:{text:this.get("strings.discard")},className:"sqs-button-link",render:c,onClick:b.bind(function(){this.fire("recovery-discard")},this)}));this.add(new b.Squarespace.Widgets.Button({strings:{text:this.get("strings.keep")},className:"light",render:c,onClick:b.bind(function(){this.fire("recovery-keep")},this)}));this._recoveryBar.append(c);this.get("contentBox").append('<div class="sqs-layout-wrapper"><div class="sqs-layout-scroll"><div class="sqs-layout"></div></div></div>');
this.get("contentBox").one(".sqs-layout-scroll").plug(b.Squarespace.ScrollLock);this._nodeExpander=this.get("contentBox").one(".sqs-layout-wrapper").plug(b.Squarespace.Plugins.NodeExpander).NodeExpander;b.Squarespace.Layout.Help.showIfNeeded()},bindUI:function(){this.after("dataChange",this.syncUI,this);var c=this.get("dialog"),e=b.Squarespace.EditControllerWebApp.getInstance();b.Lang.isValue(c)&&(this.after("focusedChange",function(b){this._replugImageLoader();b.newVal&&(e.alignInsertPoints(this.getLayoutNode()),
e.updateInsertMarkerConstrainNode())},this),this._bindRecoveryEvents(c),this._bindExpanderEvents(c),c.on("ready",this._onReady,this))},syncUI:function(){var c=this._getECB().get("layout"),e=b.Squarespace.EditControllerWebApp.getInstance();this.destroyLayout();this.pluginLayout();e=e.getBlockTrashInstance().get("boundingBox");this.get("boundingBox").append(e);e=this.get("id");c.detach(e+"|*");this._didDataChange=!1;this._registerEvent(c.after(e+"|change",function(){this._didDataChange=!0;this.get("dialog").setEdited()},
this))},_bindRecoveryEvents:function(){this.SQS_RECOVERY_BAR_ACTIVE="sqs-recovery-bar-active";this.after("recoveryBarActiveChange",this.syncUI,this);var b=this.get("dialog").on({"send-requested":function(){b.detach();this.destroyBufferOnSave()},close:this.destroyBufferOnRevert,cancel:this.destroyBufferOnRevert},null,this);this._registerEvent(b);this._registerEvent(this.get("contentItem").on("destroy",function(e){b.detach();this.destroyBufferOnRevert()},this));this.on("recovery-requested",this._onRecoveryRequested,
this);this.on("recovery-keep",this._onRecoveryKeep,this);this.on("recovery-discard",this._onRecoveryDiscard,this)},_onRecoveryRequested:function(b){b=this._getECB().get("layout");var e=this._recoveryBuffers[0];this.get("dialog").el.addClass(this.SQS_RECOVERY_BAR_ACTIVE);this._lastSavedLayout=b.toJSON();this._getECB().set("layout",e.editableBlock.layout);this.set("recoveryBarActive",!0)},_onRecoveryKeep:function(c){this.get("dialog").el.removeClass(this.SQS_RECOVERY_BAR_ACTIVE);this.set("recoveryBarActive",
!1);c=this._recoveryBuffers[0];this._recoveryBuffers.splice(0,1);(new b.Squarespace.Models.RecoveryBuffer(c)).destroy({remove:!0,headers:{"revert-changes":!1}});this.destroyBuffers(this._recoveryBuffers);this.initializeRecoveryBuffer()},_onRecoveryDiscard:function(b){this.get("dialog").el.removeClass(this.SQS_RECOVERY_BAR_ACTIVE);this._getECB().set("layout",this._lastSavedLayout);this.set("recoveryBarActive",!1);this.destroyBuffers(this._recoveryBuffers);this.initializeRecoveryBuffer()},_bindExpanderEvents:function(c){var e=
b.Squarespace.EditControllerWebApp.getInstance();this._nodeExpander.on("expand-start",function(b){c.el.addClass("sqs-node-expander-active");c.overlayEl.addClass("sqs-node-expander-active")},this);this._nodeExpander.on("contract-end",function(b){c.el.removeClass("sqs-node-expander-active");c.overlayEl.removeClass("sqs-node-expander-active")},this);this._nodeExpander.on(["expand-start","contract-start"],function(){e.disableInsertPoints()});this._nodeExpander.on(["contract-end","expand-end"],function(b){e.enableInsertPoints();
e.updateInsertMarkerConstrainNode()},this)},show:function(){d.superclass.show.apply(this,arguments);var c=this.getLayoutEditor();b.Lang.isValue(c)&&b.Array.each(c.getBlocks(),function(b){b.show()},this)},checkForUnsavedChanges:function(){this.createLoadingOverlay();this.loadBuffers(b.bind(function(b){this._loadingOverlay.set("visible",!1);0<b.length?(this._recoveryBuffers=b,this.fire("recovery-requested")):this.initializeRecoveryBuffer()},this))},didDataChange:function(){return this._didDataChange},
getLayoutEditor:function(){return this.getLayoutNode()[b.Squarespace.Layout.Editor.NS]||null},getLayoutNode:function(){return this.get("contentBox").one(".sqs-layout")},destroyLayout:function(){var c=this.getLayoutNode(),e=b.Squarespace.EditControllerWebApp.getInstance();c.hasPlugin(b.Squarespace.Layout.Builder)&&e.destroyLayoutEditor(c)},pluginLayout:function(){b.Squarespace.PageLayoutTools.sanitizeImportedECB(this._getECB());var c=this._getECB().get("layout"),e=this.getLayoutNode(),f=b.Squarespace.EditControllerWebApp.getInstance();
this.get("recoveryBarActive")?(f.destroyLayoutEditor(e),f.pluginLayoutBuilder(e,c)):(f.destroyLayoutBuilder(e),f.pluginLayoutEditor(e,c,this.getLayoutNode()))},createLoadingOverlay:function(){this._loadingOverlay=this.get("contentBox").plug(b.Squarespace.Plugins.LoadingOverlay,{spinnerConfig:{size:"extra-large",color:"dark"}}).loadingOverlay},_getECB:function(){b.Lang.isValue(this._ecb)||(this._ecb=new b.Squarespace.Models.EditableContentBlock);return this._ecb},_setData:function(b){this._getECB().setAttrs(b)},
_getData:function(c){if(!this.get("rendered"))return c;c=this._ecb.toJSON();c.layout=b.merge(c.layout,this.getLayoutNode().LayoutBuilder.toJSON());return c},_onReady:function(){var c=this.getLayoutNode(),e=b.Squarespace.EditControllerWebApp.getInstance();e.alignInsertPoints(c);e.setInsertMarkerLayout(c);e.updateInsertMarkerConstrainNode(this.get("dialog").zIndex+1);c=this.get("contentItem");if(b.Lang.isValue(c.get("id")))this.checkForUnsavedChanges();else c.onceAfter("save",function(b){this.initializeRecoveryBuffer()},
this)},_replugImageLoader:function(){this.get("contentBox").all("img").each(function(c){if(c.hasPlugin(b.Squarespace.Loader2.NS)){var e=c.getAttribute("src");if(!b.Lang.isValue(e)||0===e.length)c.unplug(b.Squarespace.Loader2),c.plug(b.Squarespace.Loader2)}})}},{CSS_PREFIX:"sqs-dialog-layout-wrapper",ATTRS:{data:{lazyAdd:!1,setter:"_setData",getter:"_getData"},dialog:{getter:function(c){return b.Object.isEmpty(c)?this.get("panel"):c}},contentItem:{value:null},itemClass:{value:""},panel:{value:null},
strings:{value:{recoveryMessage:"An unsaved version of this content was recovered.",keep:"Keep",discard:"Discard"}},recoveryBarActive:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},recoveryType:{value:b.Squarespace.RecoveryBufferType.CONTENT_ITEM},recoverableField:{getter:"_getECB"},recoverableFieldName:{getter:function(){return this.get("name")}},recoverableSourceId:{getter:function(){return this.get("contentItem").get("id")}},layoutNode:{getter:"getLayoutNode"}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-dialog squarespace-dialog-field-2 squarespace-edit-controller-web-app squarespace-layout-help squarespace-mixins-recoverable squarespace-models-layout squarespace-plugin-node-expander squarespace-util".split(" ")});
YUI.add("squarespace-newsletters-sent-messages-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["newsletters-sent-messages.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n    <div class="message">\n      <div class="item" id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===z?f.apply(b):f);e+=y(f)+'">\n        <div class="thumbnail"><img src=""></img></div>\n        <div class="subject"><span>';(f=d.subject)?f=f.call(b,{hash:{},
data:c}):(f=b.subject,f=typeof f===z?f.apply(b):f);e+=y(f)+"</span></div>\n        ";if((f=d["if"].call(b,b.status_sent,{hash:{},inverse:B.noop,fn:B.program(3,p,c),data:c}))||0===f)e+=f;e+="\n        ";if((f=d["if"].call(b,b.status_sent,{hash:{},inverse:B.noop,fn:B.program(5,q,c),data:c}))||0===f)e+=f;e+="\n        ";if((f=d["if"].call(b,b.status_pending,{hash:{},inverse:B.program(9,s,c),fn:B.program(7,r,c),data:c}))||0===f)e+=f;e+="\n        ";if((f=d["if"].call(b,b.status_error,{hash:{},inverse:B.noop,
fn:B.program(12,u,c),data:c}))||0===f)e+=f;e+="\n        ";if((f=d["if"].call(b,b.status_error,{hash:{},inverse:B.noop,fn:B.program(14,v,c),data:c}))||0===f)e+=f;return e+"\n      </div>\n    </div>\n  "}function p(b,c){var e,f;e={hash:{},data:c};return e='\n        <div class="meta">\n          <span class="sentOn">'+(y((f=d["humanizedate-format"]||b["humanizedate-format"],f?f.call(b,b.sentOn,e):w.call(b,"humanizedate-format",b.sentOn,e)))+'</span>\n          \x3c!-- <span class="authorName">Julien Feasson</span> --\x3e\n        </div>\n        ')}
function q(b,c){var e,f;e='\n        <div class="stats">\n          <div class="stat"><span class="statlabel">Queued:</span><span class="statvalue">N/A\x3c!-- ';(f=d.queued)?f=f.call(b,{hash:{},data:c}):(f=b.queued,f=typeof f===z?f.apply(b):f);e+=y(f)+' --\x3e</span></div>\n          <div class="stat"><span class="statlabel">Delivered:</span><span class="statvalue">N/A\x3c!-- ';(f=d.delivered)?f=f.call(b,{hash:{},data:c}):(f=b.delivered,f=typeof f===z?f.apply(b):f);e+=y(f)+' --\x3e</span></div>\n          <div class="stat"><span class="statlabel">Failed:</span><span class="statvalue">N/A\x3c!-- ';
(f=d.sendFailed)?f=f.call(b,{hash:{},data:c}):(f=b.sendFailed,f=typeof f===z?f.apply(b):f);e+=y(f)+' --\x3e</span></div>\n          <div class="stat"><span class="statlabel">Bounced:</span><span class="statvalue">N/A\x3c!-- ';(f=d.deliveryFailed)?f=f.call(b,{hash:{},data:c}):(f=b.deliveryFailed,f=typeof f===z?f.apply(b):f);e+=y(f)+' --\x3e</span></div>\n          <div class="stat"><span class="statlabel">Reported:</span><span class="statvalue">N/A\x3c!-- ';(f=d.reported)?f=f.call(b,{hash:{},data:c}):
(f=b.reported,f=typeof f===z?f.apply(b):f);return e+=y(f)+" --\x3e</span></div>\n        </div>\n        "}function r(b,c){return'\n        <div class="pendingprogress">Sending... <a class="undo" href="#">Undo?</a></div>\n        '}function s(b,c){var e,f;e="\n        ";if((f=d["if"].call(b,b.status_sending,{hash:{},inverse:B.noop,fn:B.program(10,t,c),data:c}))||0===f)e+=f;return e+"\n        "}function t(b,c){return'\n        <div class="sendingprogress">Sending...</div>\n        '}function u(b,
c){return'\n        <div class="errormessage">An error occurred</div>\n        '}function v(b,c){return'\n        <div class="control button retry"><a href="#">Retry</a></div>\n        '}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var w=d.helperMissing,y=this.escapeExpression,z="function",B=this;if((c=d["if"].call(c,c.sents,{hash:{},inverse:B.noop,fn:B.program(1,function(b,c){var e,f;e='\n<div class="field-wrapper newsletters-sent-messages-list">\n    <div class="title"><span>Sent</span></div>\n  ';
if((f=d.each.call(b,b.sents,{hash:{},inverse:B.noop,fn:B.program(2,l,c),data:c}))||0===f)e+=f;return e+"\n</div>\n"},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("newsletters-sent-messages.html".replace("/","."),d.templates["newsletters-sent-messages.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-commerce-analytics",function(b){var d=new b.Base.create("commerceTrack",b.Base,[],{itemViewed:function(b){this.fire("commerce-item-viewed",b)},itemAdded:function(b){this.fire("commerce-item-added",b)},itemRemoved:function(b){this.fire("commerce-item-removed",b)},itemModified:function(b){this.fire("commerce-item-modified",b)},checkoutStarted:function(b){this.fire("commerce-checkout-started",b)},checkoutConfirmed:function(b){this.fire("commerce-checkout-confirmed",b)},contributionConfirmed:function(b){this.fire("commerce-contribution-confirmed",
b)}},{ATTRS:{}});b.namespace("Squarespace").CommerceAnalytics=new d;var c=b.Base.create("commerceAnalytics",b.Base,[],{initializer:function(){b.Squarespace.CommerceAnalytics.on("commerce-item-viewed",this._getProtectedTracker("onItemViewed"),this);b.Squarespace.CommerceAnalytics.on("commerce-item-added",this._getProtectedTracker("onItemAdded"),this);b.Squarespace.CommerceAnalytics.on("commerce-item-removed",this._getProtectedTracker("onItemRemoved"),this);b.Squarespace.CommerceAnalytics.on("commerce-item-modified",
this._getProtectedTracker("onItemModified"),this);b.Squarespace.CommerceAnalytics.on("commerce-checkout-started",this._getProtectedTracker("onCheckoutStarted"),this);b.Squarespace.CommerceAnalytics.on("commerce-checkout-confirmed",this._getProtectedTracker("onCheckoutConfirmed"),this);b.Squarespace.CommerceAnalytics.on("commerce-contribution-confirmed",this._getProtectedTracker("onContributionConfirmed"),this);this._setCartMode()},_setCartMode:function(){var b=!0;try{b=Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.testModeOn}catch(c){}this.cartMode=
b?"test":"live"},_getProtectedTracker:function(b){return function(c){try{this[b].call(this,c)}catch(e){}}},onItemViewed:function(b){},onItemAdded:function(b){},onItemRemoved:function(b){},onItemModified:function(b){},onCheckoutStarted:function(b){},onCheckoutConfirmed:function(b){},onContributionConfirmed:function(b){}},{ATTRS:{}}),d=b.Base.create("commerceAnalyticsInternal",c,[],{_createCartData:function(b){return{CartOrderId:b.id,CartSubtotal:b.subtotalCents/100,CartTax:b.taxCents/100,CartCurrency:"USD",
CartMode:this.cartMode}},_createProductData:function(c){var e=c.productType;return{ProductId:c.itemId,ProductName:c.title,ProductType:e===b.Squarespace.ProductTypes.PHYSICAL?"PHYSICAL":e===b.Squarespace.ProductTypes.DIGITAL?"DIGITAL":"SERVICE",ProductSKU:c.chosenVariant?c.chosenVariant.sku:"",ProductPrice:c.purchasePriceCents/100,ProductQuantity:c.quantity}},_getItemVariantPrice:function(c){return b.Object.hasKey(c,"onSale")&&c.onSale?(b.Object.hasKey(c,"salePrice")?c.salePrice:c.salePriceCents)/
100:(b.Object.hasKey(c,"price")?c.price:c.priceCents)/100},_getItemPrice:function(c){var e=0;b.Object.hasKey(c,"variants")&&0<c.variants.length?(b.Array.each(c.variants,function(b){e+=this._getItemVariantPrice(b)},this),e/=c.variants.length):e=this._getItemVariantPrice(c);return e},_createItemData:function(b){return{ProductId:b.id,ProductName:b.title}},_createItemAddedData:function(c){return b.merge(this._createCartData(c.shoppingCart),this._createProductData(c.newlyAdded))},_createItemRemovedData:function(c){return b.merge(this._createCartData(c.shoppingCart),
this._createProductData(c.updatedEntry))},_createItemModifiedData:function(c){return b.merge(this._createCartData(c.shoppingCart),this._createProductData(c.updatedEntry))},_createItemCheckoutStartedData:function(c,e){return b.merge(this._createCartData(c),this._createProductData(e))},_createItemCheckoutCompletedData:function(c,e){return b.merge(this._createCartData(c),this._createProductData(e))},_track:function(c,e){b.Squarespace.Analytics.trackInternal(c,e)},onItemViewed:function(b){this._track("shopper_product_viewed",
this._createItemData(b))}},{ATTRS:{}}),e=b.Base.create("commerceAnalyticsMixpanel",d,[],{_track:function(c,e){b.Squarespace.Analytics.track(c,e)},onItemViewed:function(b){this._track("shopper_product_viewed",this._createItemData(b))},onItemAdded:function(b){this._track("shopper_product_added",this._createItemAddedData(b))},onItemRemoved:function(b){this._track("shopper_product_removed",this._createItemRemovedData(b))},onItemModified:function(b){this._track("shopper_product_modified",this._createItemModifiedData(b))},
onCheckoutStarted:function(c){b.each(c.entries,function(b){this._track("shopper_product_checkout_started",this._createItemCheckoutStartedData(c,b))},this)},onCheckoutConfirmed:function(c){b.each(c.purchasedCart.entries,function(b){this._track("shopper_product_purchased",this._createItemCheckoutCompletedData(c.purchasedCart,b))},this);this._track("shopper_order_submitted",{CartOrderId:c.purchasedCart.id,CartCurrency:"USD",CartGrandTotal:c.purchasedCart.grandTotalCents/100,CartSubtotal:c.purchasedCart.subtotalCents/
100,CartTax:c.purchasedCart.taxCents/100,CartShipping:c.purchasedCart.shippingCostCents/100,CartTotalQuantity:c.purchasedCart.totalQuantity,CartMode:this.cartMode})},onContributionConfirmed:function(b){this._track("donation_submitted",{Currency:"USD",Total:b.amountCents/100,CartMode:this.cartMode})}},{ATTRS:{}}),c=b.Base.create("commerceAnalyticsGoogle",c,[],{onCheckoutConfirmed:function(c){_gaq&&(_gaq.push(["_addTrans",c.id,"",c.purchasedCart.subtotalCents/100,c.purchasedCart.taxCents/100,c.purchasedCart.shippingCostCents/
100,c.customer.billingAddress.city,c.customer.billingAddress.state,c.customer.billingAddress.country]),b.each(c.purchasedCart.entries,function(b){_gaq.push(["_addItem",c.id,b.chosenVariant?b.chosenVariant.sku:"digital",b.title,"",b.purchasePriceCents/100,b.quantity])}),_gaq.push(["_trackTrans"]))}},{ATTRS:{}});new d;new e;new c;b.Lang.isObject(Static)&&b.Object.hasKey(Static,"SQUARESPACE_CONTEXT")&&b.Object.hasKey(Static.SQUARESPACE_CONTEXT,"item")&&Static.SQUARESPACE_CONTEXT.item.recordType===b.Squarespace.RecordType.STORE_ITEM&&
b.Squarespace.CommerceAnalytics.itemViewed(Static.SQUARESPACE_CONTEXT.item)},"1.0",{requires:["event-custom","node","base","squarespace-enum","squarespace-util"]});
YUI.add("squarespace-settings-billing-trial",function(b){b.namespace("Squarespace.Widgets").BillingSettingsTrial=b.Base.create("billingSettingsTrial",b.Squarespace.Widgets.SettingsPanel,[b.Squarespace.Widgets.BillingSettingsBase],{initializer:function(){var d=Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.StatusConstants.EXPIRED;titleString=Static.SQUARESPACE_CONTEXT.website.siteStatus.expiration?this._getExpirationString():d?"This Account is Expired":"This is a Trial Account";
var d=[{ctor:b.Squarespace.DialogFields.Description,config:{padding:[0,10],className:"trial billing-subpanel-unavailable",title:titleString,text:"Click the button below to upgrade your account today."}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"upgradeAccount","strings.text":(d?"Expired":"Trial")+" Account &mdash; Upgrade Now",href:"/config/upgrade"}}],c={ctor:b.Squarespace.DialogFields.Description,config:{className:"removed billing-subpanel-unavailable",title:"Remove Account",text:"This will take down your site and it will no longer be accessible."}},
e={ctor:b.Squarespace.DialogFields.Button,config:{name:"removeAccount","strings.text":"Remove Account"}};Static.SQUARESPACE_CONTEXT.website.developerMode?d.push({ctor:b.Squarespace.DialogFields.Description,config:{text:"Note: Developer accounts cannot link to an existing Squarespace 5 account."}}):d.push(this._linkAccountDescription,this._linkAccountButton);d.push(c,e);this.onceAfter("fields-rendered",function(){this.getField("removeAccount").setOnClick(this._removeAccount,this);this._bindLinkAccountButton()},
this);this.set("fields",d)},_removeAccount:function(){var d=this.getField("removeAccount");(new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.ELEMENT,anchor:d.getNode(),showOverlay:!0,"strings.confirm":"Remove Account","strings.title":"Remove Account","strings.message":"Your account will be taken down immediately and no longer be accessible."})).on("confirm",function(){b.Data.post({url:"/api/billing/RemoveAccount",data:{autorenew:!1},success:function(){window.location=
"/"}},this)},this)}},{CSS_PREFIX:"sqs-billing-settings-trial",ATTRS:{buttons:{value:[]}}})},"1.0",{requires:"datatype-date-format squarespace-dialog-button squarespace-dialog-description squarespace-settings-billing-base squarespace-settings-panel squarespace-widgets-confirmation".split(" ")});
YUI.add("resize-proxy",function(b,d){function c(){c.superclass.constructor.apply(this,arguments)}var e=b.ClassNameManager.getClassName,e=e("resize","proxy");b.mix(c,{NAME:"resize-proxy",NS:"proxy",ATTRS:{proxyNode:{setter:b.one,valueFn:function(){return b.Node.create(this.PROXY_TEMPLATE)}}}});b.extend(c,b.Plugin.Base,{PROXY_TEMPLATE:'<div class="'+e+'"></div>',initializer:function(){this.afterHostEvent("resize:start",this._afterResizeStart);this.beforeHostMethod("_resize",this._beforeHostResize);
this.afterHostMethod("_resizeEnd",this._afterHostResizeEnd)},destructor:function(){this.get("proxyNode").remove(!0)},_afterHostResizeEnd:function(b){b.dragEvent.target.actXY=[];this._syncProxyUI();this.get("proxyNode").hide()},_afterResizeStart:function(){this._renderProxy()},_beforeHostResize:function(c){this.get("host")._handleResizeAlignEvent(c.dragEvent);this._syncProxyUI();return new b.Do.Prevent},_renderProxy:function(){var b=this.get("host"),c=this.get("proxyNode");c.inDoc()||b.get("wrapper").get("parentNode").append(c.hide())},
_syncProxyUI:function(){var b=this.get("host"),c=b.info,e=b.get("activeHandleNode"),d=this.get("proxyNode"),e=e.getStyle("cursor");d.show().setStyle("cursor",e);b.delegate.dd.set("dragCursor",e);d.sizeTo(c.offsetWidth,c.offsetHeight);d.setXY([c.left,c.top])}});b.namespace("Plugin");b.Plugin.ResizeProxy=c},"3.17.2",{requires:["plugin","resize-base"]});
YUI.add("squarespace-dialog-site-subscriptions",function(b){b.namespace("Squarespace.DialogFields");b.Squarespace.DialogFields.SiteSubscription=b.Base.create("siteSubscription",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(){this._toggle=new b.Squarespace.Widgets.ToggleButton({active:this.get("data.subscribed")});this.add(this._toggle)},renderUI:function(){var d=this.get("contentBox"),c=this.get("data.websiteName");d.append(b.Node.create('<div class="website-info">'+b.substitute('<a class="name" target="_blank" href="//{identifier}.{appDomain}">{identifier}</span>',
{identifier:c,appDomain:Static.SQUARESPACE_CONTEXT.appDomain})+"</div>"));b.Squarespace.DialogFields.SiteSubscription.superclass.renderUI.apply(this,arguments)},bindUI:function(){b.Squarespace.DialogFields.SiteSubscription.superclass.bindUI.apply(this,arguments);this._toggle.after(this.get("id")+"|activeChange",this._afterToggle,this)},_afterToggle:function(){this.set("data.subscribed",this._toggle.get("active"))}},{CSS_PREFIX:"sqs-site-subscription"});b.Squarespace.DialogFields.SiteSubscriptions=
b.Base.create("siteSubscriptions",b.Squarespace.DialogFields.List,[],{initializer:function(){this.set("strings.emptyText","No Sites to Manage");this.set("strings.title","")},syncUI:function(){b.Squarespace.DialogFields.SiteSubscriptions.superclass.syncUI.apply(this,arguments);var d=this._maxNameWidth();b.Array.each(this._items,function(b){b.get("contentBox").one(".website-info").setStyle("width",d)},this)},_maxNameWidth:function(){return b.Array.reduce(this._items,0,function(b,c){var e=c.get("contentBox").one(".website-info");
return Math.max(b,e.get("offsetWidth")+parseInt(e.getStyle("marginLeft"),10)+parseInt(e.getStyle("marginRight"),10))},this)}},{ATTRS:{showAddControl:{value:!1},listItemConstructor:{value:b.Squarespace.DialogFields.SiteSubscription}},CSS_PREFIX:"sqs-site-subscriptions"})},"1.0",{requires:["squarespace-list","squarespace-dialog-field-2","squarespace-toggle"]});
YUI.add("squarespace-timezone-dialog-field-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["timezone-dialog-field.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n\t\t\t\t<option value="';(f=d.key)?f=f.call(b,{hash:{},data:c}):(f=b.key,f=typeof f===q?f.apply(b):f);e+=r(f)+'" ';if((f=d["if"].call(b,b.selected,{hash:{},inverse:s.noop,fn:s.program(3,p,c),data:c}))||0===f)e+=f;return e+=">["+r((f=(f=b.data,null==f||!1===f?f:f.offset),typeof f===
q?f.apply(b):f))+"] "+r((f=(f=b.data,null==f||!1===f?f:f.title),typeof f===q?f.apply(b):f))+" ("+r((f=(f=b.data,null==f||!1===f?f:f.tname),typeof f===q?f.apply(b):f))+")</option>\n\t\t\t\t"}function p(b,c){return'selected="true"'}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var q="function",r=this.escapeExpression,s=this;b='<div class="custom-field-description">\n\t<div class="timezone-map-viewport">\n\t\t<img class="timezone-highlight" height="551" width="42" src="/universal/images-v6/timezone/map-highlight.png" >\n\t\t<img id="mapCanvas" class="timezone-mousefield">\n\t\t<img id="marker" class="timezone-marker" src="/universal/images-v6/timezone/map-spot.png" >\n\t</div>\n\t';
if((c=d.unless.call(c,c.isloading,{hash:{},inverse:s.noop,fn:s.program(1,function(b,c){var e,f;e=""+('\n\t<div class="timezone-datafield">\n\t\t<div class="timezone-time-block">\n\t\t\t<div class="timezone-time">\n\t\t\t\t<div class="timezone-datafield-top"></div>\n\t\t\t\t<div class="timezone-datafield-bottom"></div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="timezone-zone-container">\n\t\t\t<div class="timezone-zone" style="position: absolute; top: 0px; left: 0px;">\n\t\t\t\t<div class="timezone-datafield-top">\n\t\t\t\t\t<span>'+
r((f=(f=b.selected,null==f||!1===f?f:f.title),typeof f===q?f.apply(b):f))+'</span>\n\t\t\t\t\t<img class="timezone-select-arrow" src="/universal/images-v6/dialog/select-arrow-dark.png">\n\t\t\t\t\t<span class="nearest-city">Nearest City</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="timezone-datafield-bottom">'+r((f=(f=b.selected,null==f||!1===f?f:f.tname),typeof f===q?f.apply(b):f))+'</div>\n\t\t\t</div>\n\t\t\t<select class="timezone-select">\n\t\t\t\t');if((f=d.each.call(b,b.options,{hash:{},inverse:s.noop,
fn:s.program(2,l,c),data:c}))||0===f)e+=f;return e+"\n\t\t\t</select>\n\t\t</div>\n\t</div>\n\t"},k),data:k}))||0===c)b+=c;return b+"\n</div>\n"})})();b.Handlebars.registerPartial("timezone-dialog-field.html".replace("/","."),d.templates["timezone-dialog-field.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-content-manager",function(b){var d=b.namespace("Squarespace.ContentManager").Base=b.Base.create("ContentManager",b.Squarespace.Widgets.SSWidget,[b.WidgetParent],{renderUI:function(){var c=b.Node.create('<div class="loading-state"></div>');(new b.Squarespace.Spinner({size:100,color:"dark",render:c})).spin();this.get("contentBox").append(c);this.navigationBar=this.add({childType:b.Squarespace.ContentManager.NavigationBar,template:this.get("template"),render:this.get("rootBar").showPanel({style:"navigation",
title:"Navigation Builder",className:"navigation-builder"}).getContentEl()}).item(0);this.autoSelectCollection({useHistory:!0});this.panelFooter=new b.Squarespace.ConfigurationPanelFooter({scrollingNode:b.one(".config-panel-wrapper .config-panel.navigation-builder"),render:b.one("body")})},bindUI:function(){this.before("selectedCollectionChange",this._attemptCollectionChange,this);this.after("selectedCollectionChange",this._doCollectionChange,this);this._registerEvent(b.Squarespace.ContentCollectionCache.on("*:destroy",
function(b){var e=this.get("selectedCollection");(!e||b.target.get("id")==e.get("id"))&&this.autoSelectCollection()},this));this._registerEvent(b.on("beforeunload",function(b){this.hasUnsavedChanges()&&(b.returnValue="You have unsaved changes.")},this))},syncUI:function(){this._syncUISelectedCollection()},autoSelectCollection:function(c){c=b.merge({useHistory:!1},c);var e=[this.navigationBar.get("contentBox").one("#collection-"+this.get("template").get("homepageCollectionId")),this.navigationBar.get("contentBox").one(".sqs-navigation-item-type-collection")];
c.useHistory&&e.unshift(this.navigationBar.get("contentBox").one("#collection-"+this.get("rootBar").getHistory().get("collectionId")));b.Array.find(e,function(e){return e&&(!e.hasClass("sqs-navigation-item-folder")||e.hasClass("sqs-navigation-item-folder")&&e.hasClass("sqs-navigation-item-folder-index"))?(e=b.Widget.getByNode(e),this.setWidgetSelected(e,!0),e=e.get("item").get("collection"),this.set("selectedCollection",e),e.after("urlIdChange",this._handleUrlChange,this),c.useHistory&&this.get("rootBar").get("history").replaceValue("collectionId",
e.get("id")),!0):!1},this)},setWidgetSelected:function(c,e){b.Lang.isValue(this._lastSelected)&&this._lastSelected.set("isSelected",!1);c.set("isSelected",e);this._lastSelected=c},_attemptCollectionChange:function(c){if(!0!==c.noSaveChangesCheck){var e=c.newVal;this.currentCollectionWidget&&this.currentCollectionWidget.hasUnsavedChanges()&&(c.preventDefault(),this.currentCollectionWidget.ensureSavedChanges().then(b.bind(function(){this.set("selectedCollection",e,{noSaveChangesCheck:!0})},this)))}},
_doCollectionChange:function(c){var e=c.newVal;(c=c.prevVal)&&c.detach(this.get("id")+"|*");if(e){if(c&&e.get("id")==c.get("id"))return;c&&c.detach("urlIdChange",this._handleUrlChange,this);e.after("urlIdChange",this._handleUrlChange,this);this.get("rootBar").get("history").replaceValue("collectionId",e.get("id"));e=b.Widget.getByNode(b.one("#collection-"+e.get("id")));this.setWidgetSelected(e,!0)}else this.get("rootBar").get("history").replaceValue("collectionId",null);this._syncUISelectedCollection()},
_handleUrlChange:function(b){this.get("rootBar").updateLastUrl(b.newVal)},hasUnsavedChanges:function(){return!b.Lang.isUndefined(this.currentCollectionWidget)?this.currentCollectionWidget.hasUnsavedChanges():!1},ensureSavedChanges:function(){return this.currentCollectionWidget?this.currentCollectionWidget.ensureSavedChanges():b.when()},showReycleBin:function(c){if(!b.instanceOf(this.currentCollectionWidget,b.Squarespace.Widgets.RecycleBin)){var e=this.get("selectedCollection");e?(this.once("ui-anim-nude-out-complete",
function(){var f=b.Widget.getByNode(b.one("#collection-"+e.get("id")));f&&this.setWidgetSelected(f,!1);this._renderRecycleBin(c)},this),this.set("selectedCollection",null)):this._renderRecycleBin(c)}},_renderRecycleBin:function(c){this.currentCollectionWidget=this.add(new b.Squarespace.Widgets.RecycleBin({menuItemNode:c,render:this.get("contentBox")})).item(0);this._setPageBackgroundColumnWidth();this._uiAnimNudgeIn(function(){})},_uiAddChild:function(b,e){var f=b.get("boundingBox");e.contains(f)||
e.appendChild(b.get("boundingBox"))},_syncUISelectedCollection:function(){this.currentCollectionWidget?this._isAnimating?console.warn("IGNORING, currently animating."):(this._isAnimating=!0,this._uiAnimNudgeOut(function(){this._isAnimating=!1;this.currentCollectionWidget&&(this.currentCollectionWidget.setAttrs({selected:0,focused:!1}),this.currentCollectionWidget.destroy(),delete this.currentCollectionWidget);this._renderSelectedCollection()},this)):this._renderSelectedCollection()},_renderSelectedCollection:function(){var c=
this.get("selectedCollection");c&&(this._setPageBackgroundColumnWidth(c),this._uiAnimNudgeIn(function(){this._setLoadingState();c.load({},function(e){!this.get("selectedCollection")||c.get("id")!==this.get("selectedCollection").get("id")?console.warn("Load came back too late, selectedCollection has changed.. Not taking any further actions."):(this._setLoadedState(),e=b.Squarespace.ContentManager.Utils.getEditingWidgetForCollection(c,this.get("template")),b.Lang.isFunction(e.childType)&&(this.currentCollectionWidget=
this.add(b.merge({render:this.get("contentBox")},e)).item(0),this.get("rootBar").updateLastUrl("/"+c.get("urlId"))))},this)}))},_setPageBackgroundColumnWidth:function(c){var e=!1;c&&(e=c.getTemplateConfiguration(),c=e.get("collectionType"),e=c===b.Squarespace.CollectionTypes.GENERIC&&e.get("ordering")===b.Squarespace.CollectionOrdering.USER,c=c===b.Squarespace.CollectionTypes.PRODUCT,e=e||c);this.get("pageBackgroundColumnEl").toggleClass("full-width",e);b.one(".sqs-configuration.main-content-wrapper").toggleClass("full-width",
e)},_setLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=b.later(500,this,function(){this.get("boundingBox").addClass("content-loading")})},_setLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this.get("boundingBox").removeClass("content-loading")},_uiAnimNudgeOut:function(b,e){this._uiAnimNudge("out",b,e)},_uiAnimNudgeIn:function(b,e){this._uiAnimNudge("in",b,e)},_uiAnimNudge:function(c,e,f){JSTween.tween(this.get("pageBackgroundColumnEl").getDOMNode(),
{left:{duration:"in"==c?0.2:0.05,easing:"easeOut",time:0,stop:"in"==c?0:-10,start:"in"==c?-10:0},opacity:{duration:"in"==c?0.2:0.05,easing:"easeOut",time:0,stop:"in"==c?100:0,start:"in"==c?0:100}});this.currentCollectionWidget&&this.currentCollectionWidget.headerTray&&JSTween.tween(this.currentCollectionWidget.headerTray.get("boundingBox").getDOMNode(),{left:{duration:"in"==c?0.2:0.05,easing:"easeOut",time:0,stop:"in"==c?350:340,start:"in"==c?340:350},opacity:{duration:"in"==c?0.2:0.05,easing:"easeOut",
time:0,stop:"in"==c?100:0,start:"in"==c?0:100}});JSTween.tween(this.get("boundingBox").getDOMNode(),{left:{duration:"in"==c?0.2:0.05,easing:"easeOut",time:0,stop:"in"==c?0:-10,start:"in"==c?-10:0,onStop:b.bind(function(){e&&b.bind(e,f||this)();this.fire("ui-anim-nude-"+c+"-complete")},this)},opacity:{duration:"in"==c?0.2:0.05,easing:"easeOut",time:0,stop:"in"==c?100:0,start:"in"==c?0:100}});JSTween.play()},destructor:function(){this.panelFooter.destroy();this.get("rootBar").popPanel()}},{CSS_PREFIX:"sqs-content-manager",
ATTRS:{rootBar:{},template:{valueFn:function(){return b.Squarespace.Singletons.Template||new b.Squarespace.Models.Template(Static.SQUARESPACE_CONTEXT.template)}},selectedCollection:{},pageBackgroundColumnEl:{valueFn:function(){return b.one(".page-background-column")}}}});b.namespace("Squarespace.ConfigurationPanelRenderers").content=d},"1.0",{requires:"base widget-anim squarespace-spinner squarespace-models-template squarespace-ss-widget squarespace-content-manager-navigation-bar squarespace-content-manager-utils squarespace-beforeunload".split(" ")});
YUI.add("squarespace-owner-transfer-dialog-flow",function(b){var d=b.namespace("Squarespace").OwnerTransferFlow=b.Base.create("OwnerTransferFlow",b.Base,[],{start:function(){this._chooseMemberStep();this.after("newOwnerPermissionChange",function(){hadAdmin=b.Object.hasKey(this.get("newOwnerPermission").get("permissions"),b.Squarespace.WebsiteRole.ADMIN);this.set("hadAdmin",hadAdmin);this._passwordStep()},this);this.after("transfer-complete",function(){new b.Squarespace.Widgets.Information({"strings.title":"Ownership Transferred",
"strings.message":"The site owner for this account has been succcessfully updated."})})},_chooseMemberStep:function(){var c=new b.Squarespace.MemberSelectDialog({title:"Transfer Ownership",description:"<strong>Every website has one owner who cannot be removed.</strong> Right now, you are the owner. Ownership may be transferred away to another administrator, but this cannot be undone. To give full access to this website without transferring ownership, add a contributor and assign administrator permissions.",
didntSelectError:"You must pick an owner",saveButtonText:"Transfer",icon:"/universal/images-v6/icons/icon-keys-16-light.png",selectPlaceholder:"New Owner",noOptionsErrorText:{title:"No one to transfer to",body:"There are no other contributors on this website. First invite a contributor and assign administrator permissions."},showConfirmation:!1,filter:function(b){return!b.isMe()}});c.on("member-chosen",function(b){c.allowEditing();this.setAttrs({newOwner:b.memberAccount,newOwnerPermission:b.memberPermission})},
this);this.on("transfer-complete",function(){c.close()},this);c.show()},_passwordStep:function(){var c=d.createPasswordDialog({title:"Confirm Ownership Transfer",message:b.Lang.sub("<p>By providing your password you indicate that you understand that <strong>{name}</strong> will become the <strong>owner</strong> of this website and the authoritative point of contact for it. <strong>Be careful, {name} will be able to remove your access to the website.</strong></p><p><strong>This cannot be undone.</p>",
{name:this.get("newOwner").get("displayName")}),okBtnText:"Finalize Ownership Transfer"});c.on("send-requested",function(e){var f=c.getField("password");e=f.getValue();c.showSaveOverlay();this.submitChangeOwner(e,function(e){var d=b.Object.getValue(e,["errors","password"]);b.Lang.isValue(d)?f.showError(d):(d="An error occured while changing the owner.",b.Lang.isString(e.message)&&(d=e.message),new b.Squarespace.Widgets.Alert({"strings.title":"Error","strings.message":d}));c.allowEditing()})},this);
this.after("transfer-complete",function(){c.close()});c.show()},submitChangeOwner:function(c,e){var f=this.get("newOwner").get("id");b.Squarespace.Models.WebsiteSettings.setNewOwner(f,c,b.bind(function(){this.fire("transfer-complete")},this),e)}},{createPasswordDialog:function(c){return new b.Squarespace.EditingDialog({style:"flyout",name:"get-password",closeOthers:!1,overlay:0.5,width:420,top:150,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:c.okBtnText}],tabs:[{title:c.title,
icon:"/universal/images-v6/dialog/login-icon.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:c.message,padding:[0,10]}},{ctor:b.Squarespace.DialogFields.Text,name:"password",config:{required:!0,password:!0,submitOnEnter:!0,strings:{title:"Password",description:"Please enter your member account password to continue."}}}]}]})},ATTRS:{newOwner:{},newOwnerPermission:{},hadAdmin:{validator:b.Lang.isBoolean}}})},"1.0",{requires:"base squarespace-member-select-dialog squarespace-models-website-settings squarespace-ui-base squarespace-widgets-alert squarespace-widgets-information".split(" ")});
YUI.add("widget-position-constrain",function(b,d){function c(b){}var e=b.Node,f;c.ATTRS={constrain:{value:null,setter:"_setConstrain"},preventOverlap:{value:!1}};f=c._PREVENT_OVERLAP={x:{tltr:1,blbr:1,brbl:1,trtl:1},y:{trbr:1,tlbl:1,bltl:1,brtr:1}};c.prototype={initializer:function(){this._posNode||b.error("WidgetPosition needs to be added to the Widget, before WidgetPositionConstrain is added");b.after(this._bindUIPosConstrained,this,"bindUI")},getConstrainedXY:function(b,c){c=c||this.get("constrain");
var e=this._getRegion(!0===c?null:c),f=this._posNode.get("region");return[this._constrain(b[0],"x",f,e),this._constrain(b[1],"y",f,e)]},constrain:function(b,c){var e,f;if(f=c||this.get("constrain"))e=b||this.get("xy"),f=this.getConstrainedXY(e,f),(f[0]!==e[0]||f[1]!==e[1])&&this.set("xy",f,{constrained:!0})},_setConstrain:function(b){return!0===b?b:e.one(b)},_constrain:function(b,c,e,f){if(f){this.get("preventOverlap")&&(b=this._preventOverlap(b,c,e,f));var d="x"==c;c=d?f.width:f.height;e=d?e.width:
e.height;var q=d?f.left:f.top;f=d?f.right-e:f.bottom-e;if(b<q||b>f)e<c?b<q?b=q:b>f&&(b=f):b=q}return b},_preventOverlap:function(b,c,e,d){var p=this.get("align"),q="x"===c,r,s,t,u,v;if(p&&p.points&&f[c][p.points.join("")]){if(c=this._getRegion(p.node))r=q?e.width:e.height,s=q?c.left:c.top,t=q?c.right:c.bottom,u=q?c.left-d.left:c.top-d.top,v=q?d.right-c.right:d.bottom-c.bottom;b>s?v<r&&u>r&&(b=s-r):u<r&&v>r&&(b=t)}return b},_bindUIPosConstrained:function(){this.after("constrainChange",this._afterConstrainChange);
this._enableConstraints(this.get("constrain"))},_afterConstrainChange:function(b){this._enableConstraints(b.newVal)},_enableConstraints:function(b){b?(this.constrain(),this._cxyHandle=this._cxyHandle||this.on("constrain|xyChange",this._constrainOnXYChange)):this._cxyHandle&&(this._cxyHandle.detach(),this._cxyHandle=null)},_constrainOnXYChange:function(b){b.constrained||(b.newVal=this.getConstrainedXY(b.newVal))},_getRegion:function(b){var c;b?(b=e.one(b))&&(c=b.get("region")):c=this._posNode.get("viewportRegion");
return c}};b.WidgetPositionConstrain=c},"3.17.2",{requires:["widget-position"]});
YUI.add("squarespace-dialog-order-history",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.Utils.reverseMap(b.Squarespace.OrderStates),c=b.Squarespace.Utils.reverseMap(b.Squarespace.OrderPaymentStates);b.Squarespace.DialogFields.OrderHistory=b.Base.create("order-history",b.Squarespace.DialogField2,[],{_getHBTemplateContext:function(){return b.Array.map(this.get("data"),this._createOrderEvent,this)},_createOrderEvent:function(e){if(e.eventType===b.Squarespace.OrderEventType.STATE_CHANGE)return{eventDate:new Date(e.date),
statusType:"Fulfillment status",fromState:d[e.oldState],toState:d[e.newState],actorName:e.actorName};if(e.eventType===b.Squarespace.OrderEventType.PAYMENT_STATE_CHANGE)return{eventDate:new Date(e.date),statusType:"Payment status",fromState:c[e.oldState],toState:c[e.newState],amountRefunded:b.Squarespace.Commerce.moneyString(e.amountCredited),actorName:e.actorName};throw"Unsupported Order Event Type";}},{CSS_PREFIX:"sqs-order-history",HANDLEBARS_TEMPLATE:"dialog-order-history.html"})},"1.0.0",{requires:["squarespace-dialog-field-2",
"squarespace-util","squarespace-dialog-order-history-template"]});
YUI.add("squarespace-basic-check",function(b){var d=function(b){return function(c){c.halt();b.call(this,c)}},c=b.namespace("Squarespace.Widgets").BasicCheck=b.Base.create("basicCheck",b.Squarespace.Widgets.DataWidget,[],{bindUI:function(){c.superclass.bindUI.call(this);this.get("boundingBox").on("click",d(this._toggleActive),this)},renderUI:function(){var c=this.get("contentBox");b.Lang.isValue(this.get("title"))&&c.append('<div class="title">'+this.get("title")+"</div>");c.append('<div class="check-element"></div>')},
syncUI:function(){c.superclass.syncUI.call(this);this.get("contentBox").one(".check-element").toggleClass("active",this.get("data"))},_toggleActive:function(){this.set("data",!this.get("data"))}},{CSS_PREFIX:"sqs-basic-check",ATTRS:{data:{value:!1,validator:b.Lang.isBoolean},name:{value:null},title:{value:null}}})},"1.0",{requires:["base","base-build","squarespace-dialog-field-2","squarespace-dialog-check-template"]});
YUI.add("highlight-base",function(b,d){var c=b.Array,e=b.Escape,f=b.Text.WordBreak,g=b.Lang.isArray,h={},k={_REGEX:"(&[^;\\s]*)?(%needles)",_REPLACER:function(b,c,e){return c&&!/\s/.test(e)?b:k._TEMPLATE.replace(/\{s\}/g,e)},_START_REGEX:"^(&[^;\\s]*)?(%needles)",_TEMPLATE:'<b class="'+b.ClassNameManager.getClassName("highlight")+'">{s}</b>',all:function(b,c,f){var d=[],s,t,u,v,w,y;f||(f=h);s=!1!==f.escapeHTML;w=f.startsWith?k._START_REGEX:k._REGEX;y=f.replacer||k._REPLACER;c=g(c)?c:[c];t=0;for(u=
c.length;t<u;++t)(v=c[t])&&d.push(e.regex(s?e.html(v):v));s&&(b=e.html(b));return!d.length?b:b.replace(RegExp(w.replace("%needles",d.join("|")),f.caseSensitive?"g":"gi"),y)},allCase:function(c,e,f){return k.all(c,e,b.merge(f||h,{caseSensitive:!0}))},start:function(c,e,f){return k.all(c,e,b.merge(f||h,{startsWith:!0}))},startCase:function(b,c){return k.start(b,c,{caseSensitive:!0})},words:function(b,d,q){var r,s,t=k._TEMPLATE;q||(q=h);r=!!q.caseSensitive;d=c.hash(g(d)?d:f.getUniqueWords(d,{ignoreCase:!r}));
s=q.mapper||function(b,c){return c.hasOwnProperty(r?b:b.toLowerCase())?t.replace(/\{s\}/g,e.html(b)):e.html(b)};b=f.getWords(b,{includePunctuation:!0,includeWhitespace:!0});return c.map(b,function(b){return s(b,d)}).join("")},wordsCase:function(b,c){return k.words(b,c,{caseSensitive:!0})}};b.Highlight=k},"3.17.2",{requires:["array-extras","classnamemanager","escape","text-wordbreak"]});
YUI.add("squarespace-layout-drag-scroll",function(b){b.namespace("Squarespace.Layout");var d=b.Squarespace.Layout.DragScroll=b.Base.create("layoutDragScroll",b.Plugin.Base,[],{initializer:function(){var b=d.NS,e=this.get("host");this._drag=e.dd;e.before(b+"|drag:start",this._prepareScroll,this);e.on(b+"|drag:drag",this._checkScroll,this);e.on(b+"|drag:end",this._stopScroll,this);e.on(b+"|drag:enter",this._lockScroll,this);e.on(b+"|drag:exit",this._unlockScroll,this);this.after("scrollLockChange",
this._pauseOrResumeScroll,this)},destructor:function(){this.get("host").detach(d.NS+"|*");this._detachEventsOnScroll()},_bindEventsOnScroll:function(){var c=this.get("scrollableNode"),e=d.NS;c.detach(e+"|*");if(b.UA.mobile&&b.UA.ios)c.after(e+"|scroll",function(){this._forceScrollNodeHeight();this._repositionLockableDropTargets()},this);else c.on(e+"|scroll",b.throttle(b.bind(function(){this.scrollAnim&&this._repositionLockableDropTargets()},this),20),this)},_detachEventsOnScroll:function(){this.get("scrollableNode").detach(d.NS+
"|*")},_prepareScroll:function(){var c=this.get("scrollNode");this.set("scrollableHeight",c.get("scrollHeight"));this.set("scrollLock",!1);this.set("scrollNodeComputedHeight",c.getComputedStyle("height"));this.set("lockableTargets",b.Array.filter(b.DD.DDM.targets,function(b){return b.get("lockScroll")}));this._onDestroy||(this._onDestroy=this.on("destroy",this._stopScroll,this))},_lockScroll:function(b){b.drop.get("lockScroll")&&this.set("scrollLock",!0)},_unlockScroll:function(b){b.drop.get("lockScroll")&&
this.set("scrollLock",!1)},_getScrollDirection:function(){var c=this.get("scrollNode"),e=c.get("scrollTop"),f=this.get("innerHeight"),d=this._drag.mouseXY[1];this._isScrollNodeBody()&&(d-=e);var e=this.get("scrollBuffer"),h=null;this.get("scrollableHeight")>f&&(0>d-e?h="up":d+e>f+c.getY()&&(h="down",b.UA.mobile&&b.UA.ios&&this._forceScrollNodeHeight()));return h},_checkScroll:function(){var b=this._getScrollDirection();b&&!this.get("scrollLock")?(this._currentDirection=b,this._startScroll(b)):(this.scrollTimer||
this.scrollAnim)&&this._stopScroll()},_startScroll:function(c){if(!this.scrollTimer&&!this.scrollAnim){var e=this.get("scrollDelay");this.scrollTo=this._getScrollTo(c);this.scrollTo!==this.get("scrollNode").get("scrollTop")&&(this.scrollTimer=b.later(e,this,this.scroll,c));this._bindEventsOnScroll()}},_stopScroll:function(){this.get("scrollNode").setStyle("height",null);this._updateMarkerLock(!1);this._detachEventsOnScroll();this.scrollTimer&&(this.scrollTimer.cancel(),delete this.scrollTimer);this.scrollAnim&&
(this.scrollAnim.get("running")?(this.scrollAnim.set("easing","easeOutStrong"),this.scrollAnim.set("duration",0.3),this.scrollAnim.detach("end"),this.scrollAnim.on("end",function(){this._removeScrollClasses();this.scrollAnim.destroy();delete this.scrollAnim},this),this.scrollAnim.stop()):(this.scrollAnim.destroy(),delete this.scrollAnim));this.reset("scrollSpeed");this.reset("scrollAcceleration");b.DD.DDM.syncActiveShims()},_getScrollTo:function(b){var e=this.get("scrollNode").get("scrollTop"),f=
this.get("scrollableHeight"),d=this.get("innerHeight"),h=0.95*this.get("scrollAcceleration"),k=this.get("scrollMaxSpeed"),k=Math.min(this.get("scrollSpeed")+h,k),e=e+("up"===b?-k:k);if("down"===b&&e>f-d)return f-d;if("up"===b&&0>e)return 0;this.set("scrollSpeed",k);this.set("scrollAcceleration",h);return e},scroll:function(c){var e=this.get("scrollNode"),f=this.get("scrollDelay")/1E3;this._lastScrollTop||(this._lastScrollTop=e.get("scrollTop"));if(!this.scrollAnim){this.scrollAnim=new b.Anim({node:e,
duration:f,easing:"easeNone",to:{scroll:b.bind(function(){return[0,this.scrollTo]},this)}});this.scrollAnim.on("end",function(){this.scrollTo=this._getScrollTo(c);this.scrollAnim&&!this.get("scrollLock")&&this.scrollTo!==e.get("scrollTop")?this.scrollAnim.run():this._removeScrollClasses();b.UA.mobile&&b.UA.ios&&this._repositionLockableDropTargets()},this);var d=this._isScrollNodeBody(),h=this._drag;this.scrollAnim.on("tween",function(){var b=h.mouseXY,c=e.get("scrollTop"),b=[b[0],b[1]+(c-this._lastScrollTop)];
h.actXY=b;d&&(h.mouseXY=b);h._alignNode(b);this._lastScrollTop=c},this)}this._updateMarkerLock(!0);this._addScrollClasses(c);this.scrollAnim.run()},_pauseOrResumeScroll:function(b){this.scrollAnim&&(b.newVal?(this.scrollAnim.pause(),this._removeScrollClasses()):this.scrollAnim.get("paused")&&(this.scrollAnim.run(),this._addScrollClasses()))},_repositionLockableDropTargets:function(){b.Array.each(this.get("lockableTargets"),function(b){b.sizeShim()},this)},_isScrollNodeBody:function(){return this.get("scrollNode").test("html, body")},
_forceScrollNodeHeight:function(){this._drag.get("dragging")&&this.get("scrollNode").setStyle("height",this.get("scrollNodeComputedHeight"))},_addScrollClasses:function(c){var e=b.one("html");c?this._currentDirection=c:c=this._currentDirection;e.addClass("scrolling scrolling-"+c)},_removeScrollClasses:function(){var c=b.one("html");c.removeClass("scrolling");c.removeClass("scrolling-down");c.removeClass("scrolling-up")},_updateMarkerLock:function(b){this.get("scrollLock")||this.get("host").get("editController").toggleInsertMarkerLock(!!b)}},
{NS:"dragScroll",ATTRS:{scrollNode:{valueFn:function(){return this.get("host").get("scrollNode")},setter:function(b){return b.hasClass("sqs-layout")&&b.ancestor(".sqs-layout-scroll")||b}},scrollableNode:{valueFn:function(){return this._isScrollNodeBody()?b.one(b.config.doc):this.get("scrollNode")}},scrollLock:{value:!1},lockableTargets:{value:[]},scrollableHeight:{setter:function(b){b=parseInt(b,10);if(!isNaN(b))return b}},scrollNodeComputedHeight:{},innerHeight:{getter:function(){var c=this.get("scrollNode");
return c.hasClass("sqs-layout-scroll")?parseInt(c.getComputedStyle("height"),10):b.config.win.innerHeight}},scrollBuffer:{value:80},scrollDelay:{value:250},scrollSpeed:{valueFn:function(){return b.UA.mobile?15:45}},scrollAcceleration:{valueFn:function(){return b.UA.mobile?10:30}},scrollMaxSpeed:{valueFn:function(){return b.UA.mobile?100:250}}}})},"1.0",{requires:["base","plugin","dd-delegate","squarespace-dd-behaviors","squarespace-layout-insert-marker"]});
YUI.add("squarespace-notifications-service",function(b){b.namespace("Squarespace");b.Squarespace.NotificationsService=new (b.Base.create("NotificationsService",b.Base,[],{initializer:function(){(new b.JSONPRequest("//blog.squarespace.com/blog?category=product&format=json&callback={callback}",{context:this,on:{success:function(b){this.set("notifications",this._getFilteredList(b.items));this.set("loaded",!0)}}})).send()},_getFilteredList:function(d){var c=this.get("notificationsRead");return b.Array.filter(d.slice(0,
3),function(b,f){return-1===c.indexOf(b.id)},this)},markAsRead:function(d){var c=b.Squarespace.Singletons.AuthenticatedMemberAccount;c.set("notificationsRead."+d,!0);c.save();this.set("notifications",this._getFilteredList(this.get("notifications")))}},{ATTRS:{notifications:{value:[],validator:b.Squarespace.AttrValidators.isArray},notificationsRead:{getter:function(){return b.Object.keys(b.Squarespace.Singletons.AuthenticatedMemberAccount.get("notificationsRead"))}},loaded:{value:!1}}}))},"1.0",{requires:["base",
"base-build","event","squarespace-attr-validators","squarespace-models-member-account"]});
YUI.add("squarespace-tiny-social-account-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["tiny-social-account.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p=d.helperMissing,q=this.escapeExpression;h={hash:{},data:k};b='<img class="icon" src="'+(q((l=d["icon-url"]||c["icon-url"],l?l.call(c,c.account,h):p.call(c,"icon-url",c.account,h)))+'" alt="');h={hash:{},data:k};return b+=q((l=d["service-display-name"]||
c["service-display-name"],l?l.call(c,c.account,h):p.call(c,"service-display-name",c.account,h)))+'" />\n<div class="name">'+q((l=(l=c.account,null==l||!1===l?l:l.screenname),"function"===typeof l?l.apply(c):l))+"</div>\n"})})();b.Handlebars.registerPartial("tiny-social-account.html".replace("/","."),d.templates["tiny-social-account.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-domain-error-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["domain-error.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f,d;e='\n    <li class="error">\n      <span class="error-message">';if((d=(f=b.message,typeof f===p?f.apply(b):f))||0===d)e+=d;return e+"</span>\n    </li>\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p="function",q=this.escapeExpression,r=this;if((h=d["if"].call(c,
c.title,{hash:{},inverse:r.noop,fn:r.program(1,function(b,c){var e,f;e='<div class="title">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=typeof f===p?f.apply(b):f);return e+=q(f)+"</div>"},k),data:k}))||0===h)b+=h;b+="\n\n";if((h=d["if"].call(c,c.message,{hash:{},inverse:r.noop,fn:r.program(3,function(b,c){var e,f;e='<div class="message">';(f=d.message)?f=f.call(b,{hash:{},data:c}):(f=b.message,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>"},k),data:k}))||0===h)b+=h;b+=
"\n\n";if((h=d["if"].call(c,c.errors,{hash:{},inverse:r.noop,fn:r.program(5,function(b,c){var e,f;e='\n  <ul class="error-list">\n    ';if((f=d.each.call(b,b.errors,{hash:{},inverse:r.noop,fn:r.program(6,l,c),data:c}))||0===f)e+=f;return e+"\n  </ul>\n"},k),data:k}))||0===h)b+=h;return b+"\n"})})();b.Handlebars.registerPartial("domain-error.html".replace("/","."),d.templates["domain-error.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-model",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.Model=b.Base.create("Model",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{bindUI:function(){d.superclass.bindUI.call(this);this._registerEvent(this.get("model").after("change",this.syncUI,this))},_getHBTemplateContext:function(){var b=d.superclass._getHBTemplateContext.call(this);b.model=b.model.toJSON();return b}},{CSS_PREFIX:"sqs-model",ATTRS:{model:{valueFn:function(){return new b.Model},
validator:b.Squarespace.AttrValidators.isInstanceOf(b.Model),writeOnce:"initOnly"}}})},"1.0",{requires:["base","model","widget-child","squarespace-attr-validators","squarespace-ss-widget"]});
YUI.add("squarespace-settings-commerce-store",function(b){var d=[{ctor:b.Squarespace.DialogFields.StateIndicatorBanner,config:{name:"storeState",stateDisplays:[{value:b.Squarespace.StoreStates.LIVE,state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.OK,message:"Your store is live!"},{value:b.Squarespace.StoreStates.NOT_CONNECTED,state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.WARN,message:"<b>Your store is not live.</b> Connect to Stripe to accept payments."},{value:b.Squarespace.StoreStates.TEST_MODE,
state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.WARN,message:"<b>Your store is not live.</b> When you are ready, flip the switch to launch your store."}]}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"paymentsTitle",className:"paymentsTitle",title:'Payment Gateway <div class="status-tag not-connected">not connected</div><div class="status-tag livemode">live</div><div class="status-tag testmode">test mode</div>',text:""}},{ctor:b.Squarespace.DialogFields.HTML,config:{name:"lastCharge",
content:'<div class="stripe-last-charge"></div>'}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"toggleStripe","strings.text":"Connect Stripe",waiting:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"testModeTitle",title:"Store Live",text:"Launch your store and start accepting payments. When this is off, you can test your store without charging a real credit card."}},{ctor:b.Squarespace.DialogFields.Toggle,config:{name:"isLive",height:50}},{ctor:b.Squarespace.DialogFields.Description,
config:{name:"storeCurrencyDescription",title:"Store Currency",text:"Charge customers in one of the currencies supported for your Stripe account.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"selectedCurrency",className:"settings",width:220}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"measurementStandardDescription",title:"Measurement Standard",text:"Select the standard to use when defining physical product measurements such as weight.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,
config:{name:"measurementStandard",className:"settings",width:220,numeric:!0,options:[{label:"Imperial",value:b.Squarespace.MeasurementStandard.IMPERIAL},{label:"Metric",value:b.Squarespace.MeasurementStandard.METRIC}]}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"nextOrderNumberDescription",title:"Next Order Number",text:"When orders are placed, they are assigned a number that appears on invoices. Select the number that will be assigned to the next order you receive.",padding:[15,
0]}},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"nextOrderId",width:220,displayFormatter:function(b){for(b+="";5>b.length;)b="0"+b;return b}}},{$when:b.Squarespace.Utils.isCheckoutTweaksEnabled,ctor:b.Squarespace.DialogFields.Description,config:{name:"checkoutStyleDescription",title:"Checkout Page Style",text:"Apply custom styles and branding to your checkout page."}},{$when:b.Squarespace.Utils.isCheckoutTweaksEnabled,ctor:b.Squarespace.DialogFields.Button,config:{name:"editCheckoutStyle",
"strings.text":"Go to Edit Style",waiting:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"expressCheckoutDescription",title:"Express Checkout",text:'If "Express Checkout" is enabled, customers will see "Purchase" buttons instead of "Add to Cart" on your product pages. "Purchase" buttons take customers directly to the checkout page, bypassing the shopping cart page. It is recommended for single-product stores.'}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"expressCheckout",
className:"dark",defaultValue:!1,"strings.title":"Enable Express Checkout"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"shoppingCartStyleDescription",title:"Shopping Cart Style",text:"If your site has a dark background, you might prefer to use a light color scheme for the shopping cart."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"useLightCart",className:"dark",defaultValue:!1,"strings.title":"Use Light Color Scheme"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"storeMailingListDescription",
title:"Newsletter",text:"Connecting Mailchimp will allow you to collect email addresses from your customers at checkout."}},{ctor:b.Squarespace.DialogFields.MailChimpServiceConnect,config:{name:"storeMailingList",oauthOwner:{name:"store",getId:function(){return Static.SQUARESPACE_CONTEXT.website.id}}}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"showCustomFormFieldDescription",title:"Checkout Page: Custom Form",text:'If "Enable Custom Checkout Form" is enabled, the checkout page will display a custom form that you can use to collect extra information from your customers.',
style:"title"}},{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Enable Custom Checkout Form",name:"showCustomCheckoutForm",className:"dark",defaultValue:!1}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Edit Custom Checkout Form",name:"editCheckoutPageFormButton"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"storePoliciesDescription",title:"Checkout Page: Store Policies",text:"Squarespace will automatically display links to your store policies in the footer of the <br />checkout page if you specify them below. Customers will be able to review your policies without <br /> leaving checkout.",
style:"title"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"returnPolicyDescription",title:"Return Policy",style:"minor",text:"Describe the return policy for your store, how to return items, and contact info."}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"returnPolicy",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:197,classNames:"title",submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"termsOfServiceDescription",title:"Terms of Service",
text:"Describe the Terms of Service customers of your store are subject to."}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"termsOfService",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:197,classNames:"title",submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"privacyPolicyDescription",title:"Privacy Policy",text:"Describe the Privacy Policy customers of your store are subject to."}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"privacyPolicy",
toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:197,classNames:"title",submitOnEnter:!0}}],c=b.namespace("Squarespace.Settings.Commerce").Store=b.Base.create("storeSettings",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){this.saveManager=new b.Squarespace.QueueManager},bindUI:function(){c.superclass.bindUI.call(this);this.after("dataChange",function(){this.get("checkoutForm").set("id",this.get("data").customCheckoutFormId)},this)},_trackUserAction:function(c){b.Squarespace.Analytics.trackInternal("merchant_"+
c)},isConnectedWithStripe:function(){return Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.stripeConnected},_getHBTemplateContext:function(){return b.merge(c.superclass._getHBTemplateContext.call(this),{connectedWithStripe:this.isConnectedWithStripe()})},syncStatusTags:function(b){var c=this.getField("paymentsTitle");"not-connected"===b&&(c.html.all(".status-tag").hide(),c.html.one(".not-connected").show())},saveMailingList:function(){this.saveManager.addTask({fn:this._saveMailingList,context:this})},
_saveMailingList:function(c){var f=this.getField("storeMailingList").getValue(),f={mailchimpConnect:b.JSON.stringify(f)};b.Data.post({url:"/api/commerce/admin/SaveStoreMailingListBackend",data:f,success:c,failure:c})},_showCheckoutFormEditor:function(){function c(){(new b.Squarespace.FormModelEditor({model:f,dialogConfigStrings:{title:"Edit Custom Checkout Form",loadingText:"Editing Form..."},buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Save"}]})).show()}var f=this.get("checkoutForm");
console.log(f.get("id"));b.Lang.isValue(f.get("id"))?f.load(c):c()},_syncRenderedFields:function(){c.superclass._syncRenderedFields.call(this);var e=this.getField("editCheckoutStyle");b.Squarespace.Utils.isCheckoutTweaksEnabled()&&e.setOnClick(function(){window.location="/commerce/checkout/design"});var e=this.isConnectedWithStripe(),f=this.getField("toggleStripe");b.Lang.isValue(f)&&this._syncStripeButton(f,e);f=this.getField("paymentsTitle");b.Lang.isValue(f)&&this._syncPaymentsTitleField(f,e);
e=this.getField("selectedCurrency");b.Lang.isValue(e)&&this._syncSelectedCurrencyField(e);e=this.getField("isLive");b.Lang.isValue(e)&&this._bindLiveToggleBehavior(e);e=this.getField("editCheckoutPageFormButton");b.Lang.isValue(e)&&(this.getField("editCheckoutPageFormButton").setOnClick(b.bind(this._showCheckoutFormEditor,this)),this.get("contentBox").one('[data-field-name="editCheckoutPageFormButton"]').toggleClass("enabled",this.get("data").showCustomCheckoutForm));this.on("saved-changes",function(){this.getField("showCustomCheckoutForm").getValue()&&
this.get("checkoutForm").load()},this)},_syncStripeButton:function(c,f){var d=this.get("id");if(f)c.setText("Disconnect Stripe"),c.setOnClick(this._disconnectStripe,this);else{c.setText("Connect Stripe");var h=new b.Squarespace.ExternalAuthentication({authenticationType:"website"});h.on(d+"|completed",function(){window.location.reload()});c.setOnClick(function(){h.openPopupWindow(b.Squarespace.ExternalServiceProviders.STRIPE)})}},_syncPaymentsTitleField:function(b,c){c?(b.setText("Squarespace has partnered with Stripe to provide your store the easiest way to accept credit cards on the web. <br /><br /> Your Stripe account <strong>("+
this.get("data").stripeUserEmail+")</strong> is now connected. Your store can now process credit cards."),b.setTitle("Connected with Stripe")):(b.setText('Squarespace has partnered with Stripe to provide your store the easiest way to accept credit cards on the web. Click "Connect Stripe", fill out a short form, and start processing payments immediately. <br /><br /><a target="new" href="http://help.squarespace.com/customer/portal/articles/938628-stripe-faq">Learn more about Stripe &rarr;</a><br /><a target="new" href="https://stripe.com/us/terms">Review the Stripe Terms of Service &rarr;</a>'),
b.setTitle("Connect Stripe To Accept Payments"))},_syncSelectedCurrencyField:function(c){var f=this.get("data"),f=b.Array.map(f.currenciesSupported,function(b){return{label:b,value:b}});c.set("options",f)},_bindLiveToggleBehavior:function(e){c.superclass.bindUI.call(this);e.on("value-changed",function(c){var e=this.getField("paymentsTitle"),d=this.getField("storeState");if(b.Lang.isValue(e)&&b.Lang.isValue(e.html)){var e=e.html.one(".status-tag"),k=e.hasClass("livemode");e.toggleClass("livemode",
!k);e.toggleClass("testmode",k);e.setContent(k?"test mode":"live")}e=this.get("responseData");c.field.getValue()?(this._trackUserAction("attempted_store_live"),!e.canUseCommerce&&!b.Squarespace.Utils.isSquarespaceAdmin()?(this._trackUserAction("attempted_store_live_fail"),d=new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Cannot Go Live","strings.message":"Launching your store and accepting payments is not available in trial. You must upgrade to a paid package to launch your store."}),
d.on("cancel",function(){this._trackUserAction("attempted_store_live_fail_upgrade_canceled");c.field.setValue(!1)},this),d.on("confirm",function(){this._trackUserAction("attempted_store_live_fail_upgrade_attemted");c.field.setValue(!1);this.markAsClean();CONFIG_PANEL.goToUpgrade()},this)):(this._saveChanges(),d.set("data",b.Squarespace.StoreStates.LIVE))):(d.set("data",b.Squarespace.StoreStates.TEST_MODE),this._saveChanges())},this);e=this.getField("storeMailingList");if(b.Lang.isValue(e))e.on("dataChange",
function(){this.saveMailingList()},this);this.getField("showCustomCheckoutForm").on("dataChange",function(b){this.get("contentBox").one('[data-field-name="editCheckoutPageFormButton"]').toggleClass("enabled",b.newVal)},this)},_disconnectStripe:function(){b.Data.post({url:"/api/commerce/admin/RemoveStripe",data:{},success:function(){window.location.reload()}},this)},_sendDialogData:function(c){var f=b.Squarespace.Widgets.GeneralSettings.superclass._sendDialogData,d=this._currentDialog.getData(),h;
for(h in Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings)d.hasOwnProperty(h)&&(Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings[h]=d[h]);f.call(this,c)}},{TEMPLATED:!0,HANDLEBARS_TEMPLATE:"store-settings.html",CSS_PREFIX:"sqs-store-settings",ATTRS:{initialDataUrl:{value:"/api/commerce/admin/GetStoreSettings"},initialDataPropertyName:{value:"storeSettings"},saveUrl:{value:"/api/commerce/admin/SaveStoreSettings"},"strings.title":{value:"Store Settings"},"strings.description":{value:"The store settings area allows you to control high-level details about your online store, ranging from inventory alerts to store policies. You can also use this area to connect with Stripe to accept payments."},
fields:{value:d},checkoutForm:{value:new b.Squarespace.Models.CheckoutPageForm({name:"Additional Information",fields:[{type:"textarea",id:"textarea-yui_3_10_1_1_1394561158755_6106",locked:!1,title:"Note / Additional Info",description:"",placeholder:"",required:!1,textarea:!0}],submissionMessage:{html:"Thank you!"}}),validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.CheckoutPageForm)}}})},"1.0",{requires:"squarespace-attr-validators squarespace-dombuilder squarespace-settings-panel squarespace-util squarespace-enum squarespace-models-checkout-page-form squarespace-dialog-html squarespace-dialog-mailchimp-service-connect squarespace-dialog-numeric-text squarespace-dialog-select squarespace-dialog-state-indicator-banner squarespace-dialog-toggle squarespace-dialog-wysiwyg squarespace-dombuilder squarespace-enum squarespace-external-authentication squarespace-dialog-mailchimp-service-connect squarespace-dialog-state-indicator-banner squarespace-store-settings-template squarespace-util squarespace-widgets-confirmation".split(" ")});
YUI.add("uploader-queue",function(b,d){var c=function(){this.queuedFiles=[];this.uploadRetries={};this.numberOfUploads=0;this.currentUploadedByteValues={};this.currentFiles={};this.totalBytes=this.totalBytesUploaded=0;c.superclass.constructor.apply(this,arguments)};b.extend(c,b.Base,{_currentState:c.STOPPED,initializer:function(){},_uploadStartHandler:function(b){b.file=b.target;b.originEvent=b;this.fire("uploadstart",b)},_uploadErrorHandler:function(b){var f=this.get("errorAction"),d;b.file=b.target;
b.originEvent=b;this.numberOfUploads-=1;delete this.currentFiles[b.target.get("id")];this._detachFileEvents(b.target);b.target.cancelUpload();f===c.STOP?this.pauseUpload():f===c.RESTART_ASAP?(f=b.target.get("id"),d=this.uploadRetries[f]||0,d<this.get("retryCount")&&(this.uploadRetries[f]=d+1,this.addToQueueTop(b.target)),this._startNextFile()):f===c.RESTART_AFTER&&(f=b.target.get("id"),d=this.uploadRetries[f]||0,d<this.get("retryCount")&&(this.uploadRetries[f]=d+1,this.addToQueueBottom(b.target)),
this._startNextFile());this.fire("uploaderror",b)},_startNextFile:function(){if(0<this.queuedFiles.length){var b=this.queuedFiles.shift(),c=b.get("id"),d=this.get("perFileParameters"),d=d.hasOwnProperty(c)?d[c]:d;this.currentUploadedByteValues[c]=0;b.on("uploadstart",this._uploadStartHandler,this);b.on("uploadprogress",this._uploadProgressHandler,this);b.on("uploadcomplete",this._uploadCompleteHandler,this);b.on("uploaderror",this._uploadErrorHandler,this);b.on("uploadcancel",this._uploadCancelHandler,
this);b.set("xhrHeaders",this.get("uploadHeaders"));b.set("xhrWithCredentials",this.get("withCredentials"));b.startUpload(this.get("uploadURL"),d,this.get("fileFieldName"));this._registerUpload(b)}},_registerUpload:function(b){this.numberOfUploads+=1;this.currentFiles[b.get("id")]=b},_unregisterUpload:function(b){0<this.numberOfUploads&&(this.numberOfUploads-=1);delete this.currentFiles[b.get("id")];delete this.uploadRetries[b.get("id")];this._detachFileEvents(b)},_detachFileEvents:function(b){b.detach("uploadstart",
this._uploadStartHandler);b.detach("uploadprogress",this._uploadProgressHandler);b.detach("uploadcomplete",this._uploadCompleteHandler);b.detach("uploaderror",this._uploadErrorHandler);b.detach("uploadcancel",this._uploadCancelHandler)},_uploadCompleteHandler:function(e){this._unregisterUpload(e.target);this.totalBytesUploaded+=e.target.get("size");delete this.currentUploadedByteValues[e.target.get("id")];0<this.queuedFiles.length&&this._currentState===c.UPLOADING&&this._startNextFile();var f=this.totalBytesUploaded,
d=Math.min(100,Math.round(1E4*f/this.totalBytes)/100);e.file=e.target;e.originEvent=e;b.each(this.currentUploadedByteValues,function(b){f+=b});this.fire("totaluploadprogress",{bytesLoaded:f,bytesTotal:this.totalBytes,percentLoaded:d});this.fire("uploadcomplete",e);0===this.queuedFiles.length&&0>=this.numberOfUploads&&(this.fire("alluploadscomplete"),this._currentState=c.STOPPED)},_uploadCancelHandler:function(b){b.originEvent=b;b.file=b.target;this.fire("uploadcancel",b)},_uploadProgressHandler:function(c){this.currentUploadedByteValues[c.target.get("id")]=
c.bytesLoaded;var f=this.totalBytesUploaded,d=Math.min(100,Math.round(1E4*f/this.totalBytes)/100);c.originEvent=c;c.file=c.target;this.fire("uploadprogress",c);b.each(this.currentUploadedByteValues,function(b){f+=b});this.fire("totaluploadprogress",{bytesLoaded:f,bytesTotal:this.totalBytes,percentLoaded:d})},startUpload:function(){this.queuedFiles=this.get("fileList").slice(0);this.numberOfUploads=0;this.currentUploadedByteValues={};this.currentFiles={};this.totalBytesUploaded=0;for(this._currentState=
c.UPLOADING;this.numberOfUploads<this.get("simUploads")&&0<this.queuedFiles.length;)this._startNextFile()},pauseUpload:function(){this._currentState=c.STOPPED},restartUpload:function(){for(this._currentState=c.UPLOADING;this.numberOfUploads<this.get("simUploads");)this._startNextFile()},forceReupload:function(b){var c=b.get("id");this.currentFiles.hasOwnProperty(c)&&(b.cancelUpload(),this._unregisterUpload(b),this.addToQueueTop(b),this._startNextFile())},addToQueueTop:function(b){this.queuedFiles.unshift(b)},
addToQueueBottom:function(b){this.queuedFiles.push(b)},cancelUpload:function(b){var f;if(b)if(b=b.get("id"),this.currentFiles[b])this.currentFiles[b].cancelUpload(),this._unregisterUpload(this.currentFiles[b]),this._currentState===c.UPLOADING&&this._startNextFile();else{f=0;for(len=this.queuedFiles.length;f<len;f++)if(this.queuedFiles[f].get("id")===b){this.queuedFiles.splice(f,1);break}}else{for(f in this.currentFiles)this.currentFiles[f].cancelUpload(),this._unregisterUpload(this.currentFiles[f]);
this.currentUploadedByteValues={};this.currentFiles={};this.totalBytesUploaded=0;this.fire("alluploadscancelled");this._currentState=c.STOPPED}}},{CONTINUE:"continue",STOP:"stop",RESTART_ASAP:"restartasap",RESTART_AFTER:"restartafter",STOPPED:"stopped",UPLOADING:"uploading",NAME:"uploaderqueue",ATTRS:{simUploads:{value:2,validator:function(b){return 1<=b&&5>=b}},errorAction:{value:"continue",validator:function(b){return b===c.CONTINUE||b===c.STOP||b===c.RESTART_ASAP||b===c.RESTART_AFTER}},bytesUploaded:{readOnly:!0,
value:0},bytesTotal:{readOnly:!0,value:0},fileList:{value:[],lazyAdd:!1,setter:function(c){b.Array.each(c,function(b){this.totalBytes+=b.get("size")},this);return c}},fileFieldName:{value:"Filedata"},uploadURL:{value:""},uploadHeaders:{value:{}},withCredentials:{value:!0},perFileParameters:{value:{}},retryCount:{value:3}}});b.namespace("Uploader");b.Uploader.Queue=c},"3.17.2",{requires:["base"]});
YUI.add("squarespace-dialog-stateflow",function(b){var d,c;d=function(c,e){if(!b.Lang.isObject(c)||!b.Lang.isObject(e))return c===e;var h=!0;b.Object.each(c,function(c,f){b.Lang.isObject(c)&&b.Lang.isObject(e[f])?h=h&&d(c,e[f]):c!==e[f]&&(h=!1)});return h};c=function(b){b=/\[\s*([^|\]]+?)\s*(?:\|([^]]*))?\s*\]/g.exec(b);return null!==b?String(b[1]).toLowerCase():!1};b.namespace("Squarespace.DialogFields");var e=b.Squarespace.DialogFields.Stateflow=b.Base.create("stateflow",b.Squarespace.DialogField2,
[b.WidgetParent],{initializer:function(c){this.get("contentBox");var e=Date.now();this._resizeEmitter=new b.Squarespace.ResizeEmitter({timeout:100});this._childrenContainer=b.one("body");b.Lang.isValue(c.data)||(c.data={state:c.stateOrder[0],date:c.allowNever?null:e},this.set("data",c.data));b.Lang.isNull(c.data.date)&&c.allowNever?this.set("durationOffset",-1):(c=b.Squarespace.DateUtils.calculateFullDayOffset(new Date,c.data.date),this.set("durationOffset",c));this.set("stateType",this.getStateType());
this._addChildWidgets()},renderUI:function(){e.superclass.renderUI.call(this);var b=this.get("contentBox");this.stateLabel=b.one(".field-workflow-title");this.stateDesc=b.one(".field-workflow-description")},bindUI:function(){e.superclass.bindUI.call(this);this.get("id");this._resizeEmitter.on("resize:end",function(){this.each(function(b){b.align()},this)},this);this.get("boundingBox").on("clickoutside",function(b){!this._timer.get("boundingBox").contains(b.target)&&!this._picker.get("boundingBox").contains(b.target)&&
this.closeFlyout()},this);this.stateDesc.on("click",this.onStateChangeRequest,this);this.stateLabel.on("click",this.onStateChangeRequest,this);this.on("dataChange",this.onDataChange,this);this.after("stateScheduler:dataChange",this.aggregateWidgetData,this,{noSyncUI:!0});this.after("statepicker:dataChange",this.aggregateWidgetData,this)},syncUI:function(){e.superclass.syncUI.call(this);var b=this.get("data"),c=this.get("states")[b.state];this.stateLabel.set("text",c.title);this.stateDesc.setHTML(this.getStateDesc(c.stateDesc,
b.date))},destructor:function(){this._resizeEmitter.destroy();this.each(function(b){b.hide();b.destroy()},this)},_addChildWidgets:function(){this.get("contentBox");this._timer=this.add({childType:b.Squarespace.DialogFields.StateScheduler,data:this.get("data").date,type:this.get("stateType"),allowNever:this.get("allowNever"),durationOffset:this.get("durationOffset"),visible:!1,align:{node:this.get("contentBox").one(".duration-wrapper, .date-wrapper"),points:[b.WidgetPositionAlign.BC,b.WidgetPositionAlign.TC]}}).item(0);
this._picker=this.add({childType:b.Squarespace.DialogFields.Statepicker,data:this.get("data"),states:this.get("states"),stateOrder:this.get("stateOrder"),stateType:this.get("stateType"),allowNever:this.get("allowNever"),visible:!1,align:{node:this.get("boundingBox"),points:[b.WidgetPositionAlign.BC,b.WidgetPositionAlign.BC]}}).item(0)},onStateChangeRequest:function(b){b=b.target.hasClass("duration")||b.target.hasClass("date");this.showFlyout(b?"timer":"picker")},onDataChange:function(c){var e;e=c.newVal;
b.Lang.isValue(e.state)&&this.set("stateType",this.getStateType(e));b.Lang.isNull(e.date)&&this.get("allowNever")?this.set("durationOffset",-1):(e=b.Squarespace.DateUtils.calculateFullDayOffset(new Date,e.date),this.set("durationOffset",e));c.closeFlyout&&this.closeFlyout()},aggregateWidgetData:function(c){var e=this.get("data");c=c.newVal;var d={},k={closeFlyout:!1};b.Lang.isDate(c)?d.date=c.getTime():b.Lang.isString(c)?(d.state=c,k.closeFlyout=!0):b.Lang.isNumber(c)?isNaN((new Date(c)).getTime())||
(d.date=c):b.Lang.isObject(c)?(b.Object.hasKey(c,"state")&&(d.state=c.state),k.closeFlyout=!0):b.Lang.isNull(c)&&(d.date=null);this.set("data",b.merge(e,d),k)},showFlyout:function(b){"picker"===b&&this._picker.get("visible")||"timer"===b&&this._timer.get("visible")||("picker"===b?(this._timer.hide(),this._picker.set("data",this.get("data")),this._picker.show(),this._picker.align()):(target=this._picker.hide(),this._timer.setAttrs({data:this.get("data").date,"align.node":this.get("contentBox").one(".duration-wrapper, .date-wrapper")}),
this._timer.show(),this._timer.align()))},closeFlyout:function(b,c,e){this.each(function(b){b.hide()},this);this.syncUI()},getStateType:function(e){e=e||this.get("data");var d=this.get("states");return!b.Object.hasKey(d,e.state)?!1:c(d[e.state].stateDesc)||"none"},getStateDesc:function(c,e){c=c.replace("[","{").replace("]","}");return b.Lang.sub(c,{DATE:this.getDateText(e),DURATION:this.getDurationText(e)})},getDateText:function(c){var e="-";b.Lang.isValue(c)&&(e=b.Squarespace.DateUtils.dateFormat(new Date(c),
{format:"%a, %b %d at %l:%M %p"}));return b.Lang.sub('<span class="date-wrapper"><span class="date">{date}</span></span>',{date:e})},getDurationText:function(c){var e=this.get("durationOffset"),d=this.get("allowNever")&&!b.Lang.isValue(c);c=b.Squarespace.DateUtils.dateFormat(c,{format:"%l:%M %p"});return b.Lang.sub('<span class="duration-wrapper"><span class="duration">{duration}</span></span>',{duration:-1===e&&d?"never":0>e?"now":0===e?"today at "+c:1===e?"tomorrow at "+c:"in "+e+" days at "+c})},
didDataChange:function(){var b=this.get("data");return d(b,this._initialData)}},{CSS_PREFIX:"sqs-stateflow",TEMPLATE:'<div class="clear field-workflow-wrapper"><div class="field-workflow-title">&nbsp</div><div class="field-workflow-description">&nbsp</div></div>',ATTRS:{strings:{},data:{},states:{},stateOrder:{validator:b.Lang.isArray},stateType:{},durationOffset:{value:-1,validator:function(c){return b.Lang.isNumber(Number(c))},setter:function(b){return parseInt(b,10)}},allowNever:{validator:b.Lang.isBoolean}}})},
"1.0",{requires:["base","squarespace-date-utils","squarespace-dialog-field-2","squarespace-dialog-statepicker","squarespace-dialog-statepicker-scheduler"]});
YUI.add("squarespace-dialog-member-permission-list",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.MemberPermissionList=b.Base.create("MemberPermissionList",b.Squarespace.Widgets.DialogField2,[b.WidgetParent],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");b.append('<div class="title">'+this.get("strings.title")+"</div>");this._memberPermissionsEl=b.appendChild('<div class="member-permissions"></div>')},bindUI:function(){d.superclass.bindUI.call(this);
var b=this.get("data");this._registerEvent(b.after("add",this._addMemberPermission,this));this._registerEvent(b.after("remove",this._removeMemberPermission,this))},syncUI:function(){d.superclass.syncUI.call(this);this._destroyChildren();this._addChildren()},_addChildren:function(){var c=this._memberPermissionsEl;this.get("data").each(function(e){this.add(new b.Squarespace.Widgets.MemberPermission({render:c,memberPermission:e,authenticatedAccount:this.get("authenticatedAccount")}))},this)},_addMemberPermission:function(c){this.add(new b.Squarespace.Widgets.MemberPermission({render:this._memberPermissionsEl,
memberPermission:c.model,authenticatedAccount:this.get("authenticatedAccount")}))},_removeMemberPermission:function(b){this.each(function(e){e.get("memberPermission")===b.model&&e.destroy()})}},{CSS_PREFIX:"sqs-member-permission-list",ATTRS:{data:{value:new b.Squarespace.Models.MemberPermissionList,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberPermissionList)},readOnly:{value:!0},strings:{title:"Contributors"},authenticatedAccount:{value:null}}})},"1.0",{requires:"base widget-parent squarespace-dialog-field-2 squarespace-models-member-permission squarespace-member-permission squarespace-attr-validators squarespace-context".split(" ")});
YUI.add("squarespace-dialog-file-image",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.FileImage=b.Base.create("fileImage",b.Squarespace.DialogFields.FileRequiresProcessing,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this._imagePickerEl=b.Node.create('<div class="'+this.getClassName()+'-external-image-picker"></div>');this.get("contentBox").append(c)},bindUI:function(){d.superclass.bindUI.call(this);this._imagePickerEl.on("click",function(b){b.halt();
this._initializeExternalImagePicker()},this)},getAssociatedVars:function(){var b=[],e=this.get("data");e&&(b=[{name:this.get("name")+"Id",value:e.get("id")},{name:"mediaFocalPoint",value:e.get("mediaFocalPoint")}]);return b},_cleanupResidualElements:function(){d.superclass._cleanupResidualElements.call(this);var b=this._focalPoint;b&&b.get("host").unplug(b.constructor)},_renderFilePreview:function(){var c=this.get("data"),e=this.get("contentBox");e.removeClass("loaded");e.addClass("image-loading");
var c=b.Node.create('<div class="'+this.getClassName()+'-preview content-fit"><img data-load="false" data-src="'+c.get("assetUrl")+'" data-image-dimensions="'+c.get("originalSize")+'"data-image-focal-point="'+c.get("mediaFocalPoint.x")+","+c.get("mediaFocalPoint.y")+'" /></div>'),d=c.one("img[data-src]");d.plug(b.Squarespace.Animations.Scalable);d.hide();this._spinner=new b.Squarespace.Spinner({size:"extra-large",render:e,color:this.get("spinnerColor")});this._spinner.get("boundingBox").setStyles({top:"50%",
left:"50%",position:"absolute",marginLeft:"-20px",marginTop:"-20px"});this._bindPreviewImage(d);this.get("contentBox").append(c);d.plug(b.Squarespace.Loader2,{load:!0})},_plugActionOverlay:function(c){var e=this.get("data"),d=this._actionOverlay=this.get("contentBox").plug(b.Squarespace.Plugin.ActionOverlay,{buttons:this.get("disableEdit")?["remove"]:["edit","remove"],anchor:c,position:0.5<=e.get("mediaFocalPoint.y")?"top":"bottom"}).actionOverlay;d.on("button-edit",function(){d.setLoadingState("edit",
!0);b.Aviary.once("ready",function(){d.setLoadingState("edit",!1)});b.Aviary.launch(e,this.get("mode"))},this);d.on("button-remove",function(){this.set("data",null)},this)},_bindPreviewImage:function(b){b.on("error",function(){this.get("destroyed")||this._cleanupImagePreviewError(b)},this);b.once("load",function(){this.get("destroyed")||this._animateLoadedImage(b)},this)},_cleanupImagePreviewError:function(c){null===c||(null===c.getDOMNode()||!c.inDoc())||(this._spinner.destroy(),this.get("contentBox").removeClass("image-loading"),
this.set("data",null),new b.Squarespace.Widgets.Alert({"strings.title":this.LANG.TITLE_PROCESSING_FAIL,"strings.message":this.LANG.ERR_PROCESSING_FAIL}))},_animateLoadedImage:function(c){var e=this.get("contentBox");e.plug(b.Squarespace.Animations.Scalable);e.once("hidden",function(){this.get("destroyed")||(this._spinner.destroy(),e.removeClass("image-loading"),e.addClass("loaded"),e.show(!0),c.once("shown",function(){this.get("destroyed")||(this._plugActionOverlay(c),this.get("useFocalPoint")&&this._plugFocalPoint(c))},
this),c.show())},this);e.show(!0);e.hide()},_plugFocalPoint:function(c){var e=this.get("data");c=this._focalPoint=c.plug(b.Squarespace.Plugin.FocalPoint,{focalPoint:e.get("mediaFocalPoint")||{x:0.5,y:0.5},parentNode:this.get("contentBox")}).focalPoint;c.on("focalPointChange",function(b){"DialogFileImage"!=b.source&&e.set("mediaFocalPoint",{x:b.newVal.x,y:b.newVal.y})},this);c.on("focalPointChanged",function(b){this.get("autoSaveFocalPoint")&&e.save({fields:["mediaFocalPoint"]});this._actionOverlay.set("position",
0.5<e.get("mediaFocalPoint.y")?"top":"bottom")},this)},setFocalPointPluginValue:function(b){this._focalPoint&&this._focalPoint.set("focalPoint",b,{source:"DialogFileImage"})},_initializeExternalImagePicker:function(){var c=this.get("imagePickerScrapeUrl"),e=this.get("data");!c&&e&&(c=e.get("sourceUrl"));var d=new b.Squarespace.EditingDialog({name:"choose-image-picker-url",closeOthers:!1,top:250,width:468,overlay:0.5,primaryTabs:[{title:this.LANG.TITLE_DOWNLOAD_IMAGES,icon:"/universal/images-v6/configuration/icon-importing-32-light.png",
fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:this.LANG.DESC_DOWNLOAD_IMAGES}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"imagePickerScrapeUrl",submitOnEnter:!0,strings:{required:!0,placeholder:"http://"}}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Find Images"}],initialData:{imagePickerScrapeUrl:c}});d.on("send-requested",function(){var c=d.getField("imagePickerScrapeUrl"),e=c.getValue();/^https?:\/\//.test(e)||(e=e.replace(/^(?:\/\/)?/,"http://"));
/^https?:\/\/[-A-Za-z0-9+&@#\/%?=~_()|!:,.;]*[-A-Za-z0-9+&@#\/%=~_()|]/.test(e)&&-1<e.indexOf(".")?this.get("imagePickerDownloadFromSource")||e.match(/.*(jpg|jpeg|gif|png)$/i)?(this.saveFromUrl(e),d.cancel()):(c=new b.Squarespace.Widgets.ExternalImagePicker({scrapeUrl:e,render:!0}),c.after("selectedImageURLChange",function(b){this.saveFromUrl(b.newVal)},this),c.after("visibleChange",function(b){b.newVal&&d.cancel()},this),c.show()):(c.showError(this.LANG.ERR_INVALID_URL),d.allowEditing())},this);
d.show()}},{CSS_PREFIX:"sqs-file-image",FILE_FILTER:{description:"Images",extensions:"*.jpg;*.jpeg;*.png;*.gif;*.ico"},PROCESSING_JOB:b.Squarespace.ImageProcessingJob,PROCESSING_COPY:"Processing and resizing.",ATTRS:{contentType:{value:"image"},contentLabel:{value:"an image"},disableEdit:{value:!1},useFocalPoint:{value:!0},autoSaveFocalPoint:{value:!1},imagePickerScrapeUrl:{value:""},imagePickerDownloadFromSource:{value:!1}}})},"1.0",{requires:"base node squarespace-dialog-file-requires-processing squarespace-image-loader squarespace-animations squarespace-job-manager squarespace-aviary squarespace-ui-base squarespace-spinner squarespace-plugin-focalpoint squarespace-plugin-actionoverlay squarespace-external-image-picker squarespace-dialog squarespace-dialog-description squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-block-video-editor",function(b){var d=b.namespace("Squarespace.Block.Editor").Video=b.Base.create("video-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Video")},_updateModel:function(c){var f=this._model;b.Object.each(c,function(d,h){var k=f.get(h);b.Lang.isObject(d)&&b.Lang.isObject(k)&&(b.Object.size(d)!==b.Object.size(k)||b.Object.some(d,function(b,
c){return k[c]!==b})||delete c[h])});d.superclass._updateModel.call(this,c)}},{NS:"blockEditor",ATTRS:{blockName:{value:"Video"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Video=b.Base.create("blockOpentableEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this.get("dialog").once("ready",function(){this.get("model").after("oembedChange",this._updateDescriptionField,this)},this)},_updateDescriptionField:function(c){var d=b.Object.getValue(c,["newVal","description"]);c=b.Object.getValue(c,
["prevVal","description"]);var g=this.get("dialog");c&&!b.Lang.isValue(d)?g.getField("description").setValue({html:""}):b.Lang.isValue(d)&&d!==c&&g.getField("description").setValue({html:d})},getDialogData:function(){var c=this.get("model"),d=c.toJSON();return b.merge(d,{customThumb:c.get("customThumb"),oembed:c.get("oembed")})}},{ATTRS:{dialogConfig:{valueFn:function(){return c}}}});var c={initialDataByReference:!0,name:"editVideoBlock",width:400,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?
642:550}},buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Video",icon:"/universal/images-v6/icons/icon-video-16-light-solid.png",scroll:!1,fields:[{name:"oembed",ctor:b.Squarespace.DialogFields.Oembed,config:{filter:"video","strings.title":"Video URL","strings.description":"Paste the URL of a video (YouTube, Vimeo, etc.) to embed it.","strings.inputPlaceholder":"Enter a video URL here"}},{name:"customThumb",ctor:b.Squarespace.DialogFields.FileImage,
config:{"strings.title":"Custom Overlay",contentType:"image",transientStore:!0,contentLabel:"a thumbnail",height:183,fullHeight:!0,useFocalPoint:!0,autoSaveFocalPoint:!0}},{name:"overlay",ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Use Thumbnail"}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"layout",className:"thin dark",defaultValue:"caption-hidden",options:[{value:"caption-hidden",label:"Do Not Display Caption"},{value:"caption-below",label:"Caption Below"}]}},{ctor:b.Squarespace.DialogFields.Wysiwyg,
config:{name:"description",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:135,classNames:"major"}}]}]}},"1.0",{requires:"squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-description squarespace-dialog-file-image squarespace-dialog-oembed squarespace-dialog-select squarespace-dialog-wysiwyg squarespace-models-content-item".split(" ")});
YUI.add("squarespace-google-domains-consent-service",function(b){b.namespace("Squarespace");b.Squarespace.GoogleDomainsConsentService=new (b.Base.create("domainConsentService",b.Base,[],{initializer:function(){this._openWindows={};this._messageCallbacks={};this._messageEventHandler=window.addEventListener("message",b.bind(this._routeMessage,this))},destructor:function(){window.removeEventListener("message",this._messageEventHandler);this._endMonitor()},getConsent:function(d,c,e){return b.Squarespace.Promises.create(function(b,
g){this._messageCallbacks[d]=function(c){c.consentGranted?b({requestId:c.requestId}):g()};this._openConsentWindow(d,c,e)},this)},getConsentForNewSite:function(d,c){return b.Squarespace.Promises.create(function(b,f){this._messageCallbacks[d]=function(c){c.consentGranted?b({requestId:c.requestId}):f()};this._openSignupConsentWindow(d,c)},this)},getDomainOnlyConsent:function(d,c,e){return b.Squarespace.Promises.create(function(b,g){this._messageCallbacks[d]=function(c){c.consentGranted?b({requestId:c.requestId}):
g()};this._openDomainConsentOnlyWindow(d,c,e)},this)},getConsentForList:function(){return b.Squarespace.Promises.create(function(d,c){var e=b.guid();this._messageCallbacks[e]=function(b){b.consentGranted?d({requestId:b.requestId}):c()};this._openListConsentWindow(e)},this)},_routeMessage:function(d){var c=d.data.domain;if(b.Lang.isString(c)){var e=this._messageCallbacks[c];b.Lang.isFunction(e)&&(e.call(this,d.data),delete this._messageCallbacks[c])}},_registerOpenWindow:function(d,c){0>=b.Object.size(this._openWindows)&&
this._beginMonitor();this._openWindows[d]=c},_unregisterOpenWindow:function(d){delete this._openWindows[d];0>=b.Object.size(this._openWindows)&&this._endMonitor()},_endMonitor:function(){this._monitor&&this._monitor.cancel()},_beginMonitor:function(){this._monitor=b.later(300,this,function(){var d=[];b.Object.each(this._openWindows,function(b,e){b.closed&&(this._routeMessage({data:{domain:e,consentGranted:!1}}),d.push(e))},this);b.Array.each(d,this._unregisterOpenWindow,this)},null,!0)},_openListConsentWindow:function(d){var c=
b.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/list-domains-consent-initialize?requestIdentifier={identifier}",{identifier:d,appDomain:Static.SQUARESPACE_CONTEXT.appDomain});this._openConsentPopup(c,d)},_openDomainConsentOnlyWindow:function(d,c,e){c=b.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/domain-consent-initialize?domain={domain}&requestId={requestId}",{requestId:c,domain:d,websiteId:e,appDomain:Static.SQUARESPACE_CONTEXT.appDomain});this._openConsentPopup(c,d)},
_openConsentWindow:function(d,c,e){c=b.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/consent-initialize?domain={domain}&websiteId={websiteId}&userId={userId}",{domain:d,appDomain:Static.SQUARESPACE_CONTEXT.appDomain,websiteId:e||"",userId:c});this._openConsentPopup(c,d)},_openSignupConsentWindow:function(d,c){var e=b.Lang.sub("https://oauth.{appDomain}/auth/google-web-hosting/signup-consent-initialize?domain={domain}&userId={userId}",{domain:d,userId:c,appDomain:Static.SQUARESPACE_CONTEXT.appDomain});
this._openConsentPopup(e,d)},_openConsentPopup:function(b,c){var e=window.open(b,"Google Domains Consent","status=0,width=1020,height=520");this._registerOpenWindow(c,e)}}))},"1.0",{requires:["base","promise","squarespace-promises"]});
YUI.add("squarespace-settings-panel",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.SettingsPanel=b.Base.create("dialogSettingsPanel",b.Squarespace.Widgets.DataWidget,[b.WidgetParent,b.Squarespace.Mixins.SaveChanges],{initializer:function(b){(b=this.get("initialDataUrl"))?this._loadInitialPanelData(b):this.setLoadedState();this._headerTray=this._initHeaderTray();this.publish("fields-rendered");this.publish("saved-changes");this.publish("saved-changes-failed")},destructor:function(){this._headerTray&&
this._headerTray.destroy();b.Array.each(this._renderedFields,function(b){b.destroy()})},_initHeaderTray:function(){var c=this._getButtonConfigurationForHeaderTray();b.Squarespace.Utils.isDamaskEnabled()&&this._bindSaveButtonBehaviorForDamask();return this.add(new b.Squarespace.Widgets.HeaderTray({loading:this.get("dataState")===this.getProperty("DATA_STATES").LOADING,"strings.title":this.get("strings.title"),buttons:c})).item(0)},_bindSaveButtonBehaviorForDamask:function(){this.after("dirtyChange",
function(b){this._hasSaveButton&&this.get("damask").get("menuHeader").set("changesWorkflowVisible",b.newVal)},this);this.on("destroy",function(){this.get("damask").get("menuHeader").set("changesWorkflowVisible",!1)},this);this._registerEvent(this.get("damask").get("menuHeader").on("save",function(){this._initSaveChanges()},this));this._registerEvent(this.get("damask").get("menuHeader").on("revert",function(){this._revertChanges()},this))},_getButtonConfigurationForHeaderTray:function(){var c=b.clone(this.get("buttons"));
b.Array.each(c,function(c){"save"===c.type?(c.className=c.className||"primary",c.action=c.action||function(b){this._initSaveChanges()}):"add"===c.type&&(c.className=c.className||"add primary",c.action=c.action||this.addItem);b.Lang.isString(c.className)?c.className+=" no-frame":c.className="no-frame";c.context=c.context||this},this);b.Squarespace.Utils.isDamaskEnabled()&&(this._hasSaveButton=!1,c=b.Array.filter(c,function(b){return"save"==b.type?(this._hasSaveButton=!0,!1):!0},this));return c},_loadInitialPanelData:function(c){this.setLoadingState();
b.Data.get({url:c,data:this.get("initialSendData"),success:function(c){if(!this.get("destroyed")){b.Lang.isFunction(this._processResponseData)&&(c=this._processResponseData(c));var d=this.get("initialDataPropertyName"),g=c;c&&d&&(g=c[d]);this.setLoadedState();this.set("responseData",c);this.set("data",g);this.markAsClean()}},failure:function(b){this.setLoadedState();this.set("data",b)}},this)},renderUI:function(){d.superclass.renderUI.call(this);this._headerTray.setAttrs({"strings.title":this.get("strings.title"),
buttons:this._getButtonConfigurationForHeaderTray()});this._headerTray.render(this.get("contentBox"));this.get("contentBox").prepend(this._headerTray.get("boundingBox"));this.get("contentBox").addClass("sqs-settings-panel-content")},bindUI:function(){d.superclass.bindUI.call(this);this.after("stringsChange",function(b){("strings.title"==b.subAttrName||!b.subAttrName)&&this._headerTray.set("strings.title",b.newVal.title)});this.after("buttonsChange",function(c){this._headerTray.set("buttons",b.Array.filter(this._getButtonConfigurationForHeaderTray(),
function(b){return"save"!==b.type}))})},syncUI:function(){d.superclass.syncUI.call(this);this._headerTray.set("loading",this.isLoading());var b=this.get("contentBox").one(".panel-description");b&&b.setContent(this.get("strings.description"));this.loadedSuccessfully()&&this._syncRenderedFields()},_syncRenderedFields:function(){var c=this._renderedFields,e=this.get("data");b.Array.each(c,function(b){b.destroy()});this._renderedFields=c=[];c=b.Squarespace.ObjectBuilder.make({fields:this.get("fields")},
{},e).fields;if(0===c.length)console.warn("No fields were found. This either a very good thing or a very bad thing.");else{c=b.Array.map(c,function(c){var d=c.config;b.Lang.isObject(e)&&(b.Lang.isString(d.name)&&b.Lang.isValue(e[d.name]))&&(d.data=e[d.name]);return new c.ctor(d)});if(this.getProperty("TEMPLATED"))b.Squarespace.FormUtils.template(this.get("contentBox"),c);else{var d=this.get("contentBox").one(".settings-panel-fields");if(!d)throw"The contentBox does not seem to have a .settings-panel-fields element. This is a required element.";
b.Array.each(c,function(b){b.render(d)})}b.Array.each(c,function(b){this._registerEvent(b.after("dataChange",function(b){b.silent||this.markAsDirty()},this))},this);this._renderedFields=c;this.fire("fields-rendered",{fields:c})}},getField:function(c){return b.Array.find(this._renderedFields,function(b){return b.get("name")===c})},_getSanitizedPanelData:function(){return b.merge(this.get("data"),b.Squarespace.FormUtils.getData(this._renderedFields))},_saveChanges:function(){return new b.Promise(b.bind(function(c,
e){var d=b.Squarespace.FormUtils.validate(this._renderedFields);0<b.Object.keys(d).length?(b.Squarespace.FormUtils.showErrors(this._renderedFields,d),e({errors:d})):b.Data.post({url:this.get("saveUrl"),data:this._getSanitizedPanelData(),json:this.get("postChangesAsJson"),success:function(b){this.showSuccessConfirmation();this.fire("saved-changes",{responseData:b});c()},failure:function(c){b.Squarespace.FormUtils.showErrors(this._renderedFields,c.errors);this.fire("saved-changes-failed",{responseData:c});
e(c.errors)}},this)},this))},_revertChanges:function(){var b=this.get("initialDataUrl");b?(this.setLoadingState(),this._loadInitialPanelData(b)):(this._syncRenderedFields(),this.markAsClean())},showSuccessConfirmation:function(c,e){var d=this.get("strings");c=c||d.saveSuccessfulTitle;e=e||d.saveSuccessfulDescription;new b.Squarespace.Widgets.Information({"strings.title":c,"strings.message":e})},addItem:function(){throw"Add Item was called by no implementation was added!";}},{ASYNC_DATA:!0,CSS_PREFIX:"sqs-settings-panel",
HANDLEBARS_TEMPLATE:"settings-panel.html",TEMPLATED:!1,ATTRS:{strings:{value:{title:"The Title for this Subpanel",description:"The Description for this Subpanel",saveSuccessfulTitle:"Settings Saved",saveSuccessfulDescription:"Your settings have been saved.",loadingMessage:"Loading &hellip;"}},buttons:{value:[{label:"Save",type:"save"}],validator:b.Lang.isArray},fields:{value:[]},initialDataUrl:{value:null},initialSendData:{value:{}},postChangesAsJson:{value:!1,validator:b.Lang.isBoolean},initialDataPropertyName:{value:null},
saveUrl:{value:null},siteContext:{value:{}},damask:{}}})},"1.0",{requires:"base-build squarespace-dialog squarespace-form-utils squarespace-mixin-save-changes squarespace-settings-panel-template squarespace-ss-widget squarespace-tray squarespace-widgets-information widget-anim".split(" ")});
YUI.add("squarespace-content-manager-widgets-knowledge-base",function(b){var d=b.namespace("Squarespace.ContentManagerWidgets").KnowledgeBase=b.Base.create("ContentManagerKnowledgeBase",b.Squarespace.ContentManagerWidgets.Blog,[],{initializer:function(){d.superclass.initializer.call(this);this._emptyPlaceholderWidget=this.add({childType:b.Squarespace.ContentManagerWidgets.PlaceHolderWidget,icon:"add",strings:{title:"Add Article",description:"This Knowledge Base contains no articles. Click here to add your first article."},
visible:!1,onClickHandler:b.bind(d.superclass.handleAddContentRequest,this)}).item(0)},_bindSearchFilterUI:function(){d.superclass._bindSearchFilterUI.call(this);this._searchFilter.after("loadingChange",this.syncUI,this)},_initSearchFilter:function(){d.superclass._initSearchFilter.call(this);this._loadingPlaceholder=this.add({childType:b.Squarespace.ContentManagerWidgets.PlaceHolderWidget,icon:"search",strings:{title:"Loading",description:"Waiting on results..."},visible:!1,onClickHandler:b.bind(this._searchFilter.focusInput,
this._searchFilter)}).item(0)},syncUI:function(){d.superclass.syncUI.call(this);contentBox=this.get("contentBox");this._loadingPlaceholder.set("visible",this._searchFilter.get("loading"))}},{LIST_WIDGET:b.Squarespace.KnowledgeBase.List,FILTER_WIDGET:b.Squarespace.Widgets.KnowledgeBaseFilter,PAGINATION_WIDGET:b.Squarespace.Widgets.BlogListPagination,CSS_PREFIX:"sqs-content-manager-kb",ATTRS:{helpSectionIdentifier:{value:"knowledge-base"},pageSize:{value:20}}})},"1.0",{requires:"squarespace-content-manager-widgets-blog squarespace-content-manager-widgets-placeholder squarespace-content-manager-widgets-knowledge-base-list squarespace-knowledge-base-filter squarespace-pagination squarespace-blog-list-pagination squarespace-content-manager-kb-item-template squarespace-spinner".split(" ")});
YUI.add("squarespace-block-newsletter",function(b){var d=b.Base.create("NewsletterFormModel",b.Squarespace.Models.BlockFormModel,[],{toJSON:function(){return{formId:this.get("formId"),showName:this.get("showName"),title:this.get("title"),description:this.get("description"),disclaimer:this.get("disclaimer")}},_createFormModel:function(){var c=[{type:"email",id:null,locked:!0,title:"Email Address",description:"",placeholder:"Email Address",required:!0,email:!0},{type:"name",id:null,locked:!1,title:"Name",
description:"",required:!1,name:!0}];b.Array.each(c,function(d){b.Squarespace.FormEditingUtils.resolveFieldId(d,c)},this);return new b.Squarespace.Models.Form({type:b.Squarespace.FormType.NEWSLETTER_BLOCK,name:"Newsletter Form",fields:c,submitButtonText:"Sign Up"})}},{FORM_MODEL_FIELDS:["submitButtonText","submissionMessage","submissionHTML"],ATTRS:{showName:!1,title:{value:"Subscribe"},description:{value:{engine:"wysiwyg",html:"<p>Sign up with your email address to receive news and updates.</p>",
source:"<p>Sign up with your email address to receive news and updates.</p>"}},disclaimer:{value:{engine:"wysiwyg",html:"<p>We respect your privacy.</p>",source:"<p>We respect your privacy.</p>"}},formId:{value:null},emailConnect:{value:null}}}),c=b.namespace("Squarespace.Block").Newsletter=b.Base.create("block-newsletter",b.Squarespace.Block.ModelSyncBase,[],{renderUI:function(){this.get("model").load(b.bind(this._renderBlock,this))},_renderBlock:function(){this.get("model").get("formId")&&c.superclass._renderBlock.call(this)}},
{CSS_PREFIX:"sqs-block-newsletter",MODEL:d,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Newsletter},type:{value:b.Squarespace.BlockType.NEWSLETTER}}})},"1.0",{requires:["squarespace-block-form","squarespace-block-newsletter-editor","squarespace-form-editing-utils"]});
YUI.add("squarespace-bar-table",function(b){function d(b){d.superclass.constructor.apply(this,arguments)}b.namespace("Squarespace");var c=b.Squarespace.BarTable=b.Base.create("barTable",b.Squarespace.DataBackedWidget,[],{initializer:function(b){this._scales={};this._maxValues={}},renderUI:function(){var b=d3.select(this.get("contentBox").getDOMNode()).select(".bar-table");b.empty()&&(b=this.initializeBarTable());this.buildScales();this.renderBarTable(b)},initializeBarTable:function(){return d3.select(this.get("contentBox").getDOMNode()).append("div").attr("class",
"table-container")},renderBarTable:function(e){var d=this.get("data"),g=this.get("values"),h=this.get("key"),k=this.get("barAnimDuration"),l=this.get("valueNameMap")||{},p=this.get("title"),q=this.get("keyColWidth"),r=this._scales,s=Math.round(100/g.length);b.Lang.isUndefined(p)||e.append("div").attr("class","table-title").text(p);e.append("div").attr("class","column-titles").selectAll("div.title").data(g).enter().append("div").attr("class","title-container").style("width",s+"%").append("div").attr("class",
function(b){return"title "+(l[b]||b)}).text(function(b){return l[b]||b});e.selectAll("div.bar-table-row").data(d).enter().append("div").attr("class","bar-table-row").each(function(b,e){var d=d3.select(this),f;d.append("div").attr("class","bar-table-column key").append("span").text(b[h]);f=d.append("div").attr("class","columns").style("position","absolute").style("left",q).style("right","0px");g.forEach(function(e,d){var g=(0,r[e])(b[e]),h=c.formatNumber(b[e]),l=f.append("div").attr("class","bar-table-column "+
e).style("width",s+"%");l.append("div").attr("class","bar "+e).style("width","0%").transition().delay(500).duration(k*g).style("width",function(b,c){return 100*g+"%"});l.append("span").attr("class","label").text(h)})})},bindUI:function(){var c=this.get("values"),d=this.get("valueNameMap")||{},g=this.get("contentBox"),h=this.get("toolTips");h&&c.forEach(function(c){var e=h[c];new b.Squarespace.ToolTip({target:g.one(".title."+(d[c]||c)),title:c.charAt(0).toUpperCase()+c.slice(1),body:e})})},buildScales:function(){this._maxValues=
this.findMaximumValues();var b=this.get("values");this.get("data");var c=this.get("maxBarFill");b.forEach(function(b){this._scales[b]=d3.scale.linear().domain([0,this._maxValues[b]]).range([0,c])},this)}},{formatNumber:function(c){return b.DataType.Number.format(c,{thousandsSeparator:",",decimalSeparator:"."})},ATTRS:{barAnimDuration:{value:500},keyColWidth:{value:"80px"},maxBarFill:{value:0.9},valueNameMap:{},toolTips:{}}});d.NAME="dynamicScale";d.NS="scale";d.ATTRS={maxVariance:{value:20}};b.extend(d,
b.Plugin.Base,{initializer:function(b){this.doBefore("buildScales",this._buildDynamicScales)},_buildDynamicScales:function(){var c=this.get("host");c._maxValues=c.findMaximumValues();var d=c.get("values"),g=c.get("data"),h=c.get("maxBarFill"),k=this.get("maxVariance"),l=0,p=0,q=0,r=0,s=[];d.forEach(function(b){l=g.reduce(function(c,e){return c+e[b]},g[0][b]);p=l/g.length;s=g.map(function(c){return Math.pow(c[b]-p,2)});r=s.reduce(function(b,c){return b+c});q=Math.sqrt(r/g.length);c._scales[b]=q>k?
d3.scale.log().domain([0.1,c._maxValues[b]]).range([0,h]):d3.scale.linear().domain([0,c._maxValues[b]]).range([0,h])},this);return new b.Do.Prevent}});b.Squarespace.DynamicScale=d},"1.0",{requires:["squarespace-data-backed-widget","base","thirdparty-d3","squarespace-ui-base"]});
YUI.add("squarespace-block-calendar-editor",function(b){b.namespace("Squarespace.Block.Editor").CalendarDialog=b.Base.create("calendar-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Calendar")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Calendar"},minHSize:{value:4}}});b.namespace("Squarespace.Block.ModelEditorDialog").Calendar=b.Base.create("blockCalendarEditor",b.Squarespace.ModelEditorDialog,
[],{},{ATTRS:{dialogConfig:{valueFn:function(){return d}},strings:{value:{title:"Index",description:"Select a collection below."}}}});var d={width:275,height:420,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Calendar",icon:"/universal/images-v6/icons/icon-event-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Choose a collection for this calendar to display.",padding:[0,0]}},{ctor:b.Squarespace.DialogFields.ContentIdSelector,
config:{name:"collectionId",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionFilter:{collectionType:[b.Squarespace.CollectionTypes.PRODUCT,b.Squarespace.CollectionTypes.GENERIC],folder:!1}}}]}]}},"1.0",{requires:"base model squarespace-block-calendar-model squarespace-calendar-block-renderer squarespace-damask-context-globals squarespace-dialog-description squarespace-dialog-content-selector squarespace-models-content-collection".split(" ")});
YUI.add("squarespace-xero-utils",function(b){b.namespace("Squarespace.XeroUtils");var d=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]),c=b.Squarespace.XeroUtils.HUMAN_XERO_ACCOUNT_TYPES={};c[b.Squarespace.XeroAccountTypes.BANK]="Bank Account";c[b.Squarespace.XeroAccountTypes.CURRENT_ASSET]="Current Asset";c[b.Squarespace.XeroAccountTypes.CURRENT_LIABILITY]="Current Liability";c[b.Squarespace.XeroAccountTypes.DEPRECIATION]="Depreciation";c[b.Squarespace.XeroAccountTypes.DIRECT_COSTS]=
"Direct Costs";c[b.Squarespace.XeroAccountTypes.EQUITY]="Equity";c[b.Squarespace.XeroAccountTypes.EXPENSE]="Expense";c[b.Squarespace.XeroAccountTypes.FIXED_ASSET]="Fixed Asset";c[b.Squarespace.XeroAccountTypes.LIABILITY]="Liability";c[b.Squarespace.XeroAccountTypes.NON_CURRENT_ASSET]="Non-current Asset";c[b.Squarespace.XeroAccountTypes.OTHER_INCOME]="Other Income";c[b.Squarespace.XeroAccountTypes.OVERHEAD]="Overhead";c[b.Squarespace.XeroAccountTypes.PRE_PAYMENT]="Prepayment";c[b.Squarespace.XeroAccountTypes.REVENUE]=
"Revenue";c[b.Squarespace.XeroAccountTypes.SALES]="Sales";c[b.Squarespace.XeroAccountTypes.TERM_LIABILITY]="Term Liability";var e="502eaf8624ac2660dce75263 504e119ac4aabf8347d7c10d 52c1fe1fe4b077a7b0307724 52c5bac6e4b0e8f18b95ebc4 52d98c9ae4b0f4c23c2b5252 52e1acb4e4b06841efe4d361".split(" "),f="52594417e4b030e5f06cf43c 520c175ce4b08c3424a277fb 51953be3e4b0dd9b7b26e59a 511d27c2e4b0bc0f6a784380 52011d13e4b0dae23ffa1519 52ae7b18e4b0f29916f88053 52098825e4b08d9753c7c40a 51638317e4b05d2e2299576b 505a3ab2e4b0f1416c7df69a 526714a0e4b04f7def5608e4 525f402ce4b03075c47e0f9a 5251127de4b062435b66e879 5085aec5e4b0c9f0193ab3d4 52447855e4b0a976f0abb248 516cc42be4b06cb596b99720 4feb30c5c4aaa03b060dccd8 518c6492e4b0bd8e26390be7 517f0ccbe4b0337a30294fb7 5238cfa7e4b04823aa86ae5b 52c57553e4b0d825d816b23e 507df8ec84ae4cfb9e22af94 528d1228e4b094513494cbb0 52c9cb90e4b01bdd66ab2f06 51fed36be4b0d0712764aaae".split(" "),
g=b.Squarespace.XeroUtils.isPartOfInternalBeta=function(){return b.Squarespace.Utils.isBetaFeatureEnabled()||-1!==e.indexOf(d)},h=b.Squarespace.XeroUtils.isPartOfCustomerBeta=function(){return-1!==f.indexOf(d)};b.Squarespace.XeroUtils.shouldSeeAccountingBeta=function(){return g()||h()};b.Squarespace.XeroUtils.shouldSeeAdminControls=function(){return b.Squarespace.Utils.isSquarespaceAdmin()||-1!==e.indexOf(d)}},"1.0",{requires:["squarespace-util"]});
YUI.add("squarespace-dialog-stringset-select-editor",function(b){var d;d=b.namespace("Squarespace.DialogFields").SelectEditor=b.Base.create("selectEditor",b.Squarespace.DialogField2,[b.WidgetChild,b.Squarespace.Mixins.StringSetUtils],{initalizer:function(b){this.publish("memberCreated",{emitFacade:!0})},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("options"),e=this.get("contentBox"),f=this.get("data"),g=e.one(this._optionsSelector),h=e.one(".workflow-flyout-options"),k=this.get("maxLength"),
l=[],p=this.get("editorLabel");e.one(".workflow-flyout").setStyle("width",this.get("width")+"px");b.Array.each(c,function(b,c){var e=this._createOptionNode(b,b,"data");this.memberInSet(f,b)&&e.addClass("active");g.append(e);l.push(e)},this);this.get("canAddMembers")&&(this._createOptionWrapper=this._createOptionNode(this.get("addMemberText")),this._createOptionWrapper.removeClass(this.get("memberClass")),this._createOptionWrapper.addClass("add"),g.append(this._createOptionWrapper));this._createInput=
b.Node.create('<input class="flyout-option-add">');b.Lang.isValue(k)&&this._createInput.setAttribute("maxlength",k);this.optionWrapEl=g;b.Lang.isString(p)&&p.length&&h.prepend(b.Node.create('<div class="flyout-title">'+p+"</div>"))},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox");this._createInput.on("blur",this._emptyCreateInput,this);this._createInput.on("keydown",this._addMemberOnEnter,this);this._createInput.on("keyup",this._haltEvent,this);this.after("optionsChange",
this._appendMembers,this);this.after("memberCreated",this._emptyCreateInput,this);b.one(this._optionsSelector).on("click",this._handleOptionElClick,this)},syncUI:function(){d.superclass.syncUI.call(this);var b=this.optionWrapEl.all("."+this.get("memberClass"));this.get("data");b.each(function(b){var c=this._memberExistsInData(b.getData("data"));b.toggleClass("active",c)},this)},_handleOptionElClick:function(b){var e=b.target;e.hasClass("flyout-option")&&(e.hasClass(this.get("memberClass"))?(b=e.getData("data"),
e=(e.hasClass("active")?"remove":"add")+"Member",this.fire(e,{newVal:b})):e.hasClass("add")&&(e.empty(),e.addClass("active"),e.append(this._createInput),this._createInput.focus(),e.scrollIntoView()))},_emptyCreateInput:function(b){this.get("blurring")||this._resetCreateInput()},_addMemberOnEnter:function(b){var e=this.cleanMember(b.target.get("value"));1>e.length||13!==b.keyCode||(this._memberExistsOnClient(e)?this.fire("addMember",{newVal:e}):this._createNewMember(e))},_haltEvent:function(b){b.halt()},
_appendMembers:function(c){var e=c.newVal,d=c.prevVal;b.one(this._optionsSelector);b.Array.each(e,function(b,c){if(!this.memberInSet(d,b)){var e=this._createOptionNode(b,b,"data");e.addClass("active");this.optionWrapEl.insertBefore(e,this._createOptionWrapper)}},this)},_toggleActiveMembersClass:function(b,e){var d=this.get("contentBox").all(this.get("memberClass"));d.each(function(g){d.get("text")===b&&g.toggleClass("active",e)})},_memberExistsInData:function(b){return this.memberInSet(this.get("data"),
b)},_memberExistsOnClient:function(b){return this.memberInSet(this.get("options"),b)},_resetCreateInput:function(c){this.set("blurring",!0);b.Lang.isUndefined(c)&&(c=this.get("addMemberText"));this._createOptionWrapper.contains(this._createInput)?this._createInput.set("value",""):this._createOptionWrapper.empty();this._createOptionWrapper.set("text",c);this._createOptionWrapper.addClass("add");this._createOptionWrapper.removeClass("active");this.set("blurring",!1)},_createNewMember:function(c){var e=
this.get("collectionId");this.get("contentBox");this._resetCreateInput("Creating...");this._createOptionWrapper.removeClass("add");this._createOptionWrapper.addClass("active");b.Data.post({url:this.get("addMemberUrl"),data:{collectionId:e,category:c},args:c,success:b.bind(this._createNewMemberSuccess,this,c),failure:function(b){console.warn("Failed to add.")}},this)},_createNewMemberSuccess:function(c,e){var d=[],d=b.Array.map(e.collectionCategories,function(b,c){return b.name});this._toggleActiveMembersClass(c,
!0);this.set("options",d);this.fire("addMember",{newVal:c});this.fire("memberCreated",c);this._createInput.set("value","");this.optionWrapEl.set("scrollTop",this.optionWrapEl.get("scrollHeight"))},_createOptionNode:function(c,e,d){c=b.Lang.sub('<div class="flyout-option">{memberName}</div>',{memberName:c});c=b.Node.create(c);b.Lang.isUndefined(e)||c.setData(d||"data",e);c.addClass(this.get("memberClass"));return c},_optionsSelector:".flyout-select-options"},{CSS_PREFIX:"sqs-stringset-select-editor",
TEMPLATE:'<div class="workflow-flyout tight"><div class="workflow-flyout-options clear"><div class="flyout-select-options dialog-style-scroll"></div></div><div class="flyout-notch"></div></div>',ATTRS:{addMemberUrl:{value:"/api/commondata/AddCategory"},options:{value:[],validator:b.Lang.isArray,getter:function(b){return b.concat([])}},blurring:{value:!1},canAddMembers:{},collectionId:{},addMemberText:{},data:{},flyoutNode:{getter:function(){return this.get("contentBox").one(".workflow-flyout")}},
memberClass:{},maxLength:{value:null},editorLabel:{},width:{value:250}}})},"1.0.0",{requires:["base","base-build","squarespace-stringset-utils-mixin","squarespace-dialog-field-2"]});
YUI.add("squarespace-settings-billing-subscribed",function(b){var d=[{ctor:b.Squarespace.DialogFields.BillingStatus,config:{name:"plan"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"plan-description",title:"Plan Level",text:'Squarespace provides 3 levels of service. <a href="http://www.squarespace.com/pricing" target="new">Learn more.</a>'}},{$when:function(c){return b.Lang.isObject(c.productOffering)},ctor:b.Squarespace.DialogFields.Select,config:{name:"planId",required:!0,options:{$valueFn:function(c){return b.Array.map(c.productOffering.plans,
function(b){return{label:b.displayName,value:b.plan}})}},"strings.placeholder":"Plan"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"billing-period-description",title:"Billing Period",text:"Squarespace allows for monthly or yearly payments."}},{$when:function(c){return b.Lang.isObject(c.productOffering)},ctor:b.Squarespace.DialogFields.Select,config:{name:"billingPeriod",required:!0,options:{$valueFn:function(c){var d=c.currentProduct,g=d?d.plan.allowedPeriods:[];c=c.productOffering.periods;
b.Object.isEmpty(g)||(c=b.Array.filter(c,function(b){return g[b.intervalDays]===b.period}));return b.Array.map(c,function(b){return{label:b.displayName,value:b.period}})}},"strings.placeholder":"Period"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"disable-autorenewal-description",title:"Cancel Account",className:"light",text:"Use the button below to set your account to expire at the end of this billing period."}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"cancelAccount",
className:"light","strings.text":"Cancel Account"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"creditCardInformationDescription",title:"Credit Card Information",text:"The information for the credit card we have on file is below."}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"nameOnCard",required:!0,autoCompleteType:b.Squarespace.Constants.AutocompleteTypes.CC_FULL_NAME,"strings.placeholder":"Full Name","strings.label":"Full Name"}},{ctor:b.Squarespace.DialogFields.LabeledText,
config:{name:"ccNumber",required:!0,autocompleteType:b.Squarespace.Constants.AutocompleteTypes.CC_NUMBER,"strings.label":"Credit Card Number","strings.placeholder":"Card Number"}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"cvv",required:!0,autocompleteType:b.Squarespace.Constants.AutocompleteTypes.CC_CSC,"strings.label":"CVV","strings.placeholder":"CVV"}},{ctor:b.Squarespace.DialogFields.LabeledSelect,config:{name:"expirationMonth",numeric:!0,options:{$valueFn:function(){var b=[];
b.push({label:"Mo",value:""});for(var c=1;12>=c;c++)b.push({label:c+"",value:c+""});return b}},autocompleteType:b.Squarespace.Constants.AutocompleteTypes.CC_EXP_MONTH,"strings.label":"Exp. Month","strings.placeholder":"Mo"}},{ctor:b.Squarespace.DialogFields.LabeledSelect,config:{name:"expirationYear",numeric:!0,options:{$valueFn:function(){var b=(new Date).getFullYear(),c=[];c.push({label:"Yr",value:""});for(var d=b;d<b+20;d++)c.push({label:d,value:d});return c}},autocompleteType:b.Squarespace.Constants.AutocompleteTypes.CC_EXP_YEAR,
"strings.label":"Exp. Year","strings.placeholder":"Yr"}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"country",options:b.Squarespace.Localities.getAmericentricSortedCountryOptions()}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"zipCode","strings.placeholder":"Postal"}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"updatePaymentInformationButton",className:"light","strings.text":"Update Payment Information"}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"reactivateAccount",
"strings.text":"Reactivate Account"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"expired-reactivate-description",padding:[0,10],className:"expired billing-subpanel-unavailable",title:"Your Account Has Expired",text:"Click the button below to reactivate it."}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"re-enable-autorun-description",title:"Reactivate Account",text:"You can easily restore service to your Squarespace account using the button below. Your account will be reactivated into the same plan you had before you canceled."}},
{ctor:b.Squarespace.DialogFields.Description,config:{name:"remove-website-description",title:"Remove Website",text:"Your account will remain active until the end of the term you have paid for.  If you would like to remove your site entirely right now, you can use the control below.  You can not reverse this action."}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"turnOffWebsiteButton","strings.text":"Turn Off Website"}},{ctor:b.Squarespace.DialogFields.InvoiceList,config:{name:"invoiceList",
linkInvoices:!0,"strings.loading":"Loading..."}},b.Squarespace.Widgets.BillingSettingsBase.prototype._linkAccountDescription,b.Squarespace.Widgets.BillingSettingsBase.prototype._linkAccountButton],c=b.namespace("Squarespace.Widgets").BillingSettingsSubscribed=b.Base.create("billingSettingsSubscribed",b.Squarespace.Widgets.SettingsPanel,[b.Squarespace.Widgets.BillingSettingsBase],{_initHeaderTray:function(){return this.add(new b.Squarespace.Widgets.TabbedHeaderTray({loading:this.get("dataState")===
this.getProperty("DATA_STATES").LOADING,"strings.title":this.get("strings.title"),buttons:this._getButtonConfigurationForHeaderTray()})).item(0)},_getButtonConfigurationForHeaderTray:function(){return[{label:"Payment Information",action:b.bind(function(){this.get("contentBox").removeClass("tab-invoices-active")},this)},{label:"Invoices",action:b.bind(function(){this.get("contentBox").addClass("tab-invoices-active")},this)}]},_getHBTemplateContext:function(){var b=c.superclass._getHBTemplateContext.call(this);
if(!this.loadedSuccessfully())return b;b.autoRenewOff=!this._isAutorenewOn();b.expired=this._isExpired();return b},_isAutorenewOn:function(){return this.get("data.autorenew")},_isExpired:function(){return Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.StatusConstants.EXPIRED},bindUI:function(){c.superclass.bindUI.call(this);this.on("fields-rendered",function(){this._isExpired()?(this._bindReActivateAccountButton(),this._bindLinkAccountButton()):this._isAutorenewOn()?(this._bindAndSyncPlanAndPeriodOptions(),
this._bindAndSyncCardField(),this._bindUpdatePaymentInformationButton(),this._bindCancelAccount()):(this._bindReActivateAccountButton(),this._bindWebsiteRemoval());this._bindInvoiceListBehaviors();this.markAsClean()},this)},_bindWebsiteRemoval:function(){var b=this.getField("turnOffWebsiteButton");b&&b.setOnClick(this._cancelSubscription,this)},_cancelSubscription:function(){var c=this.getField("turnOffWebsiteButton");c&&c.disable();var d=new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.ELEMENT,
anchor:c?c.get("boundingBox"):null,showOverlay:!0,"strings.confirm":"Turn Off Website","strings.title":"Turn Off Website","strings.message":"Your account will be taken down immediately."});d.on("cancel",function(){c.enable()});d.on("confirm",function(){var c=new b.Squarespace.Lightbox({content:'<div class="squarespace-signup-spinner">&nbsp;</div><div class="squarespace-signup-text">Please wait a moment while we take down your site...</div>',zIndex:200100,transition:"scale",name:"billing-loading-indicator",
margin:0,clickAnywhereToExit:!1});c.show();b.Data.post({url:"/api/billing/CancelSubscription",success:function(){var e=function(){b.one(".squarespace-signup-text").setContent("<strong>Your site has been removed.</strong>");b.one(".squarespace-signup-spinner").addClass("stopped").setStyle("backgroundImage",'url("/universal/images-v6/big-check.png")');b.later(2E3,this,function(){window.location="/"})};if(b.one(".squarespace-signup-text"))e();else c.on("overlay-visible",function(){e()},this)}},this)},
this)},showBigSpinner:function(){this._overlay||(this._overlay=new b.Squarespace.Lightbox({content:'<div class="squarespace-signup-spinner">&nbsp;</div>',zIndex:200100,transition:"scale",name:"billing-loading-indicator",margin:0,clickAnywhereToExit:!1}));this._overlay.show()},hideBigSpinner:function(){this._overlay.hide()},_bindCancelAccount:function(){var b=this.getField("cancelAccount");b&&b.setOnClick(this._cancelClicked,this)},_cancelClicked:function(){var c=this.getField("cancelAccount");c.disable();
var d=new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.ELEMENT,anchor:c.get("boundingBox"),showOverlay:!0,"strings.confirm":"Cancel Account","strings.title":"Cancel Account","strings.message":"Your account will be set to expire at the end of your current billing period."});d.on("confirm",function(){b.Data.post({url:"/api/billing/DisableAutorenew",data:{autorenew:!1},success:function(){this.showSuccessConfirmation("Subscription Cancelled","Your account's auto renewal is off.",
!1);window.location.reload()}},this)},this);d.on("cancel",function(){c.enable()})},_bindUpdatePaymentInformationButton:function(){var b=this.getField("updatePaymentInformationButton");b&&b.setOnClick(function(){b.disable();this._initSaveChanges().then(function(){b.enable()},function(){b.enable()})},this)},_bindInvoiceListBehaviors:function(){var b=this.getField("invoiceList");b&&b.after("dataStateChange",function(b){b.target.loadedSuccessfully()&&this.markAsClean()},this)},_bindAndSyncCardField:function(){var b=
this.getField("ccNumber");b&&(b.set("strings.placeholder",this.get("data.ccNumber")),b.set("data",""))},_bindAndSyncPlanAndPeriodOptions:function(){var c=this.get("data.plan"),d=this.getField("planId"),g=this.getField("billingPeriod");this.getField("ccNumber");d.set("data",c.planId);d.setCurrentDataAsInitial();g.set("data",c.currentPeriodId);g.setCurrentDataAsInitial();Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.StatusConstants.PASTDUE?(d.disable(),g.disable()):(this._registerEvent(d.after("dataChange",
this._onPlanChanged,this)),this._registerEvent(g.after("dataChange",this._onPlanChanged,this)));c=new b.Squarespace.Models.Admin.MemberAccount(Static.SQUARESPACE_CONTEXT.authenticatedAccount);this.get("data.usedMarketingCoupon")&&!c.hasRole(b.Squarespace.MemberAccountRole.BILLING)&&g.disable()},_onPlanChanged:function(c){if(!c.revert){var d=this.getField("planId"),g=this.getField("billingPeriod");this.showBigSpinner();var h={planId:d.get("data"),periodId:g.get("data")};b.Data.get({url:"/api/billing/PreviewTermChange",
data:h,success:function(c){this.hideBigSpinner();c=c.switchPreview;var e=0>=c.amountTotal,p="Your account will be <strong>"+(e?"refunded ":"charged ")+c.currencySymbol+(c.amountTotal*(e?-1:1)).formatMoney()+c.currencySuffix+"</strong> upon accepting and will renew at the new rate.";if((c=c.planViolationMessages)&&c.length){if(e=b.Array.find(c,function(b){return b.userActionRequired})){new b.Squarespace.Widgets.Alert({"strings.title":"Action Required","strings.message":e.message});d.revert();g.revert();
return}c.length&&(p+="</br></br>");c.forEach(function(b){p+="\n"+b.message})}c=new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.CENTER,showOverlay:!0,"strings.confirm":"Change Plan","strings.title":"Change Billing Plan","strings.message":p});c.on("confirm",function(){this.showBigSpinner();b.Data.post({url:"/api/billing/ChangePlanTerm",data:h,success:function(c){this.hideBigSpinner();this.showSuccessConfirmation(!1,!1,!1);b.later(2E3,this,function(){window.onbeforeunload=
null;window.location.reload()})},failure:function(c){this.hideBigSpinner();c.declined?new b.Squarespace.Widgets.Alert({"strings.title":"Plan Change Failed","strings.message":"Failed to change plan. Your credit card was declined."}):new b.Squarespace.Widgets.Alert({"strings.title":"Plan Change Failed","strings.message":"Failed to change plan. Please try again."});d.revert();g.revert()}},this)},this);c.on("cancel",function(){d.revert();g.revert()})}},this)}},_bindReActivateAccountButton:function(){var b=
this.getField("reactivateAccount");b&&b.setOnClick(this._reactivateClicked,this)},_siteInactive:function(c){return c.siteStatus.value!==b.Squarespace.StatusConstants.ACTIVE},_reactivateClicked:function(){this._siteInactive(Static.SQUARESPACE_CONTEXT.website)?window.location="https://"+window.location.host+"/config/upgrade":this._enableAutorenew()},_enableAutorenew:function(){var c=this.getField("reactivateAccount");c.disable();var d=b.bind(function(){this.set("dataState","loading");b.Data.post({url:"/api/billing/EnableAutorenew",
success:function(){this.set("dataState","loaded");this.showSuccessConfirmation("You Have Resubscribed","Your account's auto renewal is back on.",!1);b.later(2E3,this,function(){window.location.reload()})},failure:function(){this.set("dataState","loaded");new b.Squarespace.Widgets.Information({"strings.title":"Reactivation Failed","strings.message":"Failed to reactivate your site."});g()}},this)},this),g=function(){c.enable()};b.Squarespace.Fluent.Confirm({"strings.title":"Reactivate Site?","strings.message":"Are you sure you want to reactivate your site? You will be charged at the end of your billing period."}).then(d,
g)},syncUI:function(){this.get("contentBox").one(".billing-subscribed-panel").remove(!0);this.get("contentBox").prepend(this.renderTemplate());c.superclass.syncUI.call(this)}},{TEMPLATED:!0,HANDLEBARS_TEMPLATE:"settings-site-billing-subscribed.html",CSS_PREFIX:"sqs-billing-settings-subscribed",ATTRS:{initialDataUrl:{value:"/api/billing/GetAccountInformation"},initialDataPropertyName:{value:"details"},saveUrl:{value:"/api/billing/UpdateAccountInformation"},fields:{value:d},buttons:{value:[]}}})},"1.0",
{requires:"base squarespace-settings-panel squarespace-billing-fields squarespace-dialog-description squarespace-dialog-text squarespace-admin-models-member-account squarespace-dialog-select squarespace-dialog-credit-card-number squarespace-dialog-hidden squarespace-settings-billing-base squarespace-fluent-confirmation squarespace-settings-site-billing-subscribed-template squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dialog-shipping-container-table",function(b){b.namespace("Squarespace");var d=b.Squarespace.DialogFields.ShippingContainerTable=b.Base.create("shippingContainerTable",b.Squarespace.DialogField2,[],{renderUI:function(){d.superclass.renderUI.call(this);this.get("contentBox");this._populateTable(this.get("data"))},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox");this.on("rowsChanged",this._updateDataFromTable,this);b.delegate("change",this._updateDataFromTable,
"input",this);b.delegate("click",this._insertNewRow,".add-row",this);b.delegate("click",this._removeRow,".user-row .remove",this);this.after("serviceTypeChange",this._updateSystemContainers,this)},_populateTable:function(c){b.Array.each(c,this._addRow,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("contentBox").toggleClass("empty",0===this.get("systemBoxes").length+this.get("data").length);this.get("contentBox").all(".system-row").remove();b.Array.each(this.get("systemBoxes"),function(b){this._addSystemRow(b)},
this)},_getErrors:function(){var c=this.get("contentBox").one("tbody"),e=[];b.Lang.isValue(c)&&c.all(".user-row").each(function(c){val=this._extractRowValue(c);b.Array.each(this.get("dimensionNames"),function(b){0===val[b]&&(this._set("errorFlyoutAnchor",c),e=["Dimensions cannot be 0"])},this)},this);0===this.get("data").length&&0===this.get("systemBoxes").length&&(this._set("errorFlyoutAnchor",c),e=["You should specify at least one box to pack items into."]);0<e.length&&this.fire("errors");return e},
_updateDataFromTable:function(){this.set("data",this._extractRowValuesFromTable())},_removeRow:function(b){b.currentTarget.ancestor(".row").remove();b.stopPropagation();this.fire("rowsChanged")},_insertNewRow:function(){var b=this.get("contentBox");this._addRow({name:"Custom Box"});b.one(".add-row").scrollIntoView();this.fire("rowsChanged")},_updateSystemContainers:function(){b.Data.get({url:"/api/rest/commerce/shipping-containers",data:{serviceType:this.get("serviceType")},success:b.bind(function(b){this.set("systemBoxes",
b);this.syncUI()},this)})},_addSystemRow:function(c){var e=this.get("contentBox");c=b.Node.create(b.Lang.sub(this.getProperty("SYSTEM_ROW_TEMPLATE"),{len:c.len,width:c.depth,height:c.height,name:b.Squarespace.Commerce.capitalizeFirst(c.name),unit:this.get("unit")}));e.one("tbody").prepend(c)},_addRow:function(c){var e=this.get("contentBox");c=b.Node.create(b.Lang.sub(this.getProperty("ROW_TEMPLATE"),{len:c.len,width:c.depth,height:c.height,name:c.name}));c.all(".right input").plug(b.Squarespace.Plugin.NumericFormatter,
{postfixUnit:this.get("unit")});e.one("tbody").append(c)},_extractRowValuesFromTable:function(){var b=[];this.get("contentBox").one("tbody").all(".user-row").each(function(e){b.push(this._extractRowValue(e))},this);return b},_extractRowValue:function(b){var e={};e.name=b.one('input[name="name"]').get("value");e.len=b.one('input[name="len"]').numericFormatterPlugin.get("data");e.depth=b.one('input[name="width"]').numericFormatterPlugin.get("data");e.height=b.one('input[name="height"]').numericFormatterPlugin.get("data");
return e}},{CSS_PREFIX:"sqs-shipping-container-table",HANDLEBARS_TEMPLATE:"dialog-shipping-container-table.html",SYSTEM_ROW_TEMPLATE:'<tr class="row system-row"><td class="left">{name}</td><td class="right">{len}{unit} \u2715 {width}{unit} \u2715 {height}{unit}</td><td class="remove"></td></tr>',ROW_TEMPLATE:'<tr class="row user-row"><td class="left"><input type="text" class="name" name="name" value="{name}" /></td><td class="right"><input type="text" placeholder="length" class="len" name="len" value="{len}" />\u2715 <input type="text" placeholder="width" class="width" name="width" value="{width}" />\u2715 <input type="text" placeholder="height" class="height" name="height" value="{height}" /></td><td class="remove"><div class="remove-row"></div></td></tr>',
ATTRS:{strings:{value:{title:"",description:"",emptyMessage:"You have no shipping containers. The packing algorithm will assume that each item will ship separately."}},dimensionNames:{value:["len","depth","height"]},systemBoxes:{value:[]},measurementStandard:{value:null},unit:{getter:function(){return this.get("measurementStandard")===b.Squarespace.MeasurementStandard.IMPERIAL?'"':"cm"}},serviceType:{value:null},data:{value:[]}}})},"1.0",{requires:"base json handlebars squarespace-animations squarespace-input-utils squarespace-dialog-field-2 squarespace-plugin-numeric-formatter squarespace-dialog-shipping-container-table-template".split(" ")});
YUI.add("button-core",function(b,d){function c(b){this.initializer(b)}var e=b.ClassNameManager.getClassName,f=b.AttributeCore;c.prototype={TEMPLATE:"<button/>",constructor:c,initializer:function(b){this._initNode(b);this._initAttributes(b);this._renderUI(b)},_initNode:function(c){this._host=c.host?b.one(c.host):b.Node.create(this.TEMPLATE)},_initAttributes:function(b){f.call(this,c.ATTRS,b)},_renderUI:function(){var b=this.getNode(),e=b.get("nodeName").toLowerCase();b.addClass(c.CLASS_NAMES.BUTTON);
"button"!==e&&"input"!==e&&b.set("role","button")},enable:function(){this.set("disabled",!1)},disable:function(){this.set("disabled",!0)},getNode:function(){this._host||(this._host=this.get("boundingBox"));return this._host},_getLabel:function(){var b=this.getNode();return c._getTextLabelFromNode(b)},_getLabelHTML:function(){var b=this.getNode();return c._getHTMLFromNode(b)},_setLabel:function(c,e,d){c=b.Escape.html(c);(!d||"internal"!==d.src)&&this.set("labelHTML",c,{src:"internal"});return c},_setLabelHTML:function(b,
e,d){e=this.getNode();var f=c._getLabelNodeFromParent(e);"input"===e.get("nodeName").toLowerCase()?f.set("value",b):f.setHTML(b);(!d||"internal"!==d.src)&&this.set("label",b,{src:"internal"});return b},_setDisabled:function(b){var e=this.getNode();e.getDOMNode().disabled=b;e.toggleClass(c.CLASS_NAMES.DISABLED,b);return b}};b.mix(c.prototype,f.prototype);c.ATTRS={label:{setter:"_setLabel",getter:"_getLabel",lazyAdd:!1},labelHTML:{setter:"_setLabelHTML",getter:"_getLabelHTML",lazyAdd:!1},disabled:{value:!1,
setter:"_setDisabled",lazyAdd:!1}};c.NAME="button";c.CLASS_NAMES={BUTTON:e("button"),DISABLED:e("button","disabled"),SELECTED:e("button","selected"),LABEL:e("button","label")};c.ARIA_STATES={PRESSED:"aria-pressed",CHECKED:"aria-checked"};c.ARIA_ROLES={BUTTON:"button",CHECKBOX:"checkbox",TOGGLE:"toggle"};c._getLabelNodeFromParent=function(b){return b.one("."+c.CLASS_NAMES.LABEL)||b};c._getTextLabelFromNode=function(b){b=c._getLabelNodeFromParent(b);var e=b.get("nodeName").toLowerCase();return b.get("input"===
e?"value":"text")};c._getHTMLFromNode=function(b){return c._getLabelNodeFromParent(b).getHTML()};c._getDisabledFromNode=function(b){return b.get("disabled")};b.ButtonCore=c},"3.17.2",{requires:["attribute-core","classnamemanager","node-base","escape"]});
YUI.add("squarespace-instagram-oembed-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["instagram-oembed.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="instagram-oembed">\n  <a href="';(h=d.url)?h=h.call(c,{hash:{},data:k}):(h=c.url,h="function"===typeof h?h.apply(c):h);b+=l(h)+'">\n    <img src="';(h=d["instagram-url"])?h=h.call(c,{hash:{},data:k}):(h=c["instagram-url"],
h="function"===typeof h?h.apply(c):h);b+=l(h)+'" width="100%" />\n  </a>\n  ';if((h=d["if"].call(c,c.title,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n    <p><a href="';(f=d.url)?f=f.call(b,{hash:{},data:c}):(f=b.url,f="function"===typeof f?f.apply(b):f);e+=l(f)+'">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f="function"===typeof f?f.apply(b):f);return e+=l(f)+"</a></p>\n  "},k),data:k}))||0===h)b+=h;return b+"\n</div>"})})();b.Handlebars.registerPartial("instagram-oembed.html".replace("/",
"."),d.templates["instagram-oembed.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-paginator",function(b){var d=function(){};b.namespace("Squarespace.Models");b.Squarespace.Models.Paginator=b.Base.create("Paginator",b.Base,[],{paginateURL:function(c){c=c.split("?");var e=c[1],e=b.Lang.isValue(e)?b.QueryString.parse(e):{},e=b.merge(e,this._getPaginationParams());return c[0]+"?"+b.QueryString.stringify(e)},firstPage:d,previousPage:d,nextPage:d,currentPage:d,_getPaginationParams:function(){return{limit:this.get("limit"),orderBy:this.get("orderBy"),orderDirection:this.get("orderDirection")}}},
{ATTRS:{models:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ModelList),writeOnce:"initOnly"},limit:{value:20,validator:b.Squarespace.AttrValidators.isNumber},orderBy:{value:"id",validator:b.Squarespace.AttrValidators.isString},orderDirection:{value:b.Squarespace.OrderDirection.ASCENDING,validator:function(c){if(b.Object.hasValue(b.Squarespace.OrderDirection,c))return!0;console.error("Paginator: Invalid orderDirection.");return!1}}}})},"1.0",{requires:["base","querystring",
"squarespace-attr-validators","squarespace-enum","squarespace-models-model-list"]});
YUI.add("squarespace-block-html-editor",function(b){b.namespace("Squarespace.Block.Editor").Html=b.Base.create("block-html-editor",b.Squarespace.Block.Editor.Base,[b.Squarespace.Block.Mixin.Splitable,b.Squarespace.Block.Mixin.Coalesceable],{insertContentIntoModel:function(b){this._model.set("source",b);this._model.set("html",b)},_onBlur:function(){this._disableEditing()},getBlockLevelElements:function(){var d=this.get("selectorsForInsertPoints");return new b.NodeList(b.Array.filter(this._cb.one(".sqs-html-content").get("children").getDOMNodes(),
function(c){c=b.one(c);return c.test(d)&&c.getContent()}))},_afterEditingChange:function(b){this._bb.toggleClass("sqs-block-editing",!!b.newVal)},_isCoalesceable:function(d){var c=b.Widget.getByNode(d);return!c.get("isNewBlock")&&d.get("text")!==c.contentHtml.get("placeholderText")},destructor:function(){this.ckEditor&&(this.ckEditor.destroy(),this.contentEl.set("contentEditable",!1))}},{NS:"blockEditor",ATTRS:{editingEvent:{value:"focus"},minHSize:{valueFn:function(){return this.get("host").get("editMode")===
b.Squarespace.Layout.EditMode.EMAIL?2:1}}}})},"1.0",{requires:["squarespace-block-editor-base","squarespace-block-mixin-splitable","squarespace-block-mixin-coalesceable","squarespace-visual-editor","squarespace-layout-drop"]});YUI.add("squarespace-hb-trim-cents",function(b){b.Handlebars.registerHelper("trim-cents",function(d){if(d)return b.Lang.isNumber(d)&&d.formatMoney(),b.Lang.isString(d)||(d=d.toString()),d.replace(".00","")})},"1.0",{requires:["handlebars-base","squarespace-common"]});
YUI.add("squarespace-hb-member-permission",function(b){var d={ADMIN:"/universal/images-v6/icons/icon-role-admin-dark-30.png",EDITOR:"/universal/images-v6/icons/icon-role-content-edit-dark-30.png",BILLING:"/universal/images-v6/icons/icon-role-billing-dark-30.png",REPORTING:"/universal/images-v6/icons/icon-role-reporting-dark-30.png",MODERATOR:"/universal/images-v6/icons/icon-role-comment-mod-dark-30.png",COMMENTER:"/universal/images-v6/icons/icon-role-trusted-commenter-dark-30.png",STORE_MANAGER:"/universal/images-v6/icons/icon-role-store-manager-dark-30.png"},
c={ADMIN:"Admin",EDITOR:"Editor",BILLING:"Billing",REPORTING:"Reporting",MODERATOR:"Moderator",COMMENTER:"Commenter",STORE_MANAGER:"Commerce"};b.Handlebars.registerHelper("with-member-permission-roles",function(e,f){var g="";b.Object.each(b.Squarespace.WebsiteRole,function(b,k){-1!=e.indexOf(b.toString())&&(g+=f.fn({role:k,imageUrl:d[k],shortText:c[k]}))});return g})},"1.0",{requires:["handlebars-base","squarespace-enum"]});
YUI.add("squarespace-block-menu",function(b){var d={raw:"MEALS\n=========\n\nSandwiches\n----------\n\nLE PAYSAN\nSmoked turkey, Brie & apple chutney\n$14\n\nSOHO MEDITERRANEAN SANDWICH\nHummus, grilled vegetables & halloumi cheese\n$15\n\nSTEAK SANDWICH\nSteak w/ onions, bacon & cheddar\n$18\n\n\nPasta\n------\n\nGRAMIGNA\nmacaroni, pork sausage, swiss chard, black pepper\n$20\n\nGARGANELLI\npasta quills, cream, peas, truffle butter, prosciutto\n$22\n\nSPALLINA \ndouble ravioli, squacquerone cheese, rabbit, porcini\n$24\n\n\nDRINKS\n=========\n\nWine\n----\n\nSauvignon Blanc, Kim Crawford, Imalborough\n$12.00 glass /  $45.00 bottle\n\nMeursault, Mat Rot, Burgundy, France\n$13 glass / $80 bottle",menus:b.Squarespace.Utils.parseMenu("MEALS\n=========\n\nSandwiches\n----------\n\nLE PAYSAN\nSmoked turkey, Brie & apple chutney\n$14\n\nSOHO MEDITERRANEAN SANDWICH\nHummus, grilled vegetables & halloumi cheese\n$15\n\nSTEAK SANDWICH\nSteak w/ onions, bacon & cheddar\n$18\n\n\nPasta\n------\n\nGRAMIGNA\nmacaroni, pork sausage, swiss chard, black pepper\n$20\n\nGARGANELLI\npasta quills, cream, peas, truffle butter, prosciutto\n$22\n\nSPALLINA \ndouble ravioli, squacquerone cheese, rabbit, porcini\n$24\n\n\nDRINKS\n=========\n\nWine\n----\n\nSauvignon Blanc, Kim Crawford, Imalborough\n$12.00 glass /  $45.00 bottle\n\nMeursault, Mat Rot, Burgundy, France\n$13 glass / $80 bottle"),
menuStyle:"classic",currencySymbol:"$"};b.namespace("Squarespace.Block").Menu=b.Base.create("block-menu",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-menu",ATTRS:{editor:{value:b.Squarespace.Block.Editor.Menu},defaultContentModel:{value:d},floatable:{value:!1}}})},"1.0",{requires:["squarespace-block-base-modelsync","squarespace-block-menu-parser","squarespace-block-menu-editor"]});
YUI.add("squarespace-stats-block-view",function(b){var d=b.namespace("Squarespace.Views.Stats").Block=b.Base.create("statsBlockFaceView",b.Squarespace.View,[],{destructor:function(){this._emptyContainer()},render:function(c){c&&b.instanceOf(c,b.Node)&&this._set("container",c);this._renderEventsBound||(this._bindUI(),this._renderEventsBound=!0);this._emptyContainer();this._renderLoadingState();this._loadData()},_bindUI:function(){var b=this.get("id");this.after([b+"|timeFrameChange",b+"|dataMetricChange",
b+"|granularityChange"],function(b){this.render()},this);this.after(b+"|dataLoaded",function(b){b.error?(this._emptyContainer(),this._renderErrorState(b.error)):(this._emptyContainer(),this._renderDefaultState(b.data))})},_loadData:function(){throw this.name+": Implement a _loadData for your dataView that fires dataLoaded with a data/error property.";},_emptyContainer:function(){this._loadingView&&(this._loadingView.destroy({remove:!0}),this._loadingView=null);this._errorView&&(this._errorView.destroy({remove:!0}),
this._errorView=null);this.get("container").empty()},_renderDefaultState:function(c){c=this._getTemplateContext(c);c=b.Squarespace.UITemplates.render(this.template,c);this.get("container").setHTML(c)},_renderErrorState:function(c){this._errorView=new b.Squarespace.Views.Stats.BlockError;this._errorView.render(this.get("container"))},_renderLoadingState:function(){this._loadingView=new b.Squarespace.Views.Stats.BlockLoading;this._loadingView.render(this.get("container"))},_getTemplateContext:function(c){var e=
d.superclass._getTemplateContext.apply(this,arguments);return b.merge(e,{dataMetric:b.Squarespace.CensusDataMetricUtils.getLabel(this.get("dataMetric")),timeFrame:b.Squarespace.StatsTimeFrameUtils.getLabel(this.get("timeFrame"))})},_getDateRange:function(){return b.Squarespace.StatsTimeFrameUtils.getDateRange(this.get("timeFrame"))},_getStartTime:function(){return this._getDateRange().start},_getEndTime:function(){return this._getDateRange().end},_calculateGranularity:function(){var c=this._getDateRange(),
c=c.end.getTime()-c.start.getTime();return 864E5>=c?b.Squarespace.CensusGranularity.HOURLY:26784E5>=c?b.Squarespace.CensusGranularity.DAILY:b.Squarespace.CensusGranularity.MONTHLY}},{ATTRS:{granularity:{value:b.Squarespace.CensusGranularity.HOURLY,readOnly:!0,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.CensusGranularity),getter:"_calculateGranularity"},dataMetric:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.CensusDataMetric)},timeFrame:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.StatsTimeFrames)}}})},
"1.0",{requires:"squarespace-view squarespace-census-datametrics squarespace-stats-timeframes squarespace-stats-block-loading-view squarespace-stats-block-error-view squarespace-attr-validators".split(" ")});
YUI.add("datatype-number-format",function(b,d){var c=b.Lang;b.mix(b.namespace("Number"),{format:function(b,d){if(c.isNumber(b)){d=d||{};var g=0>b,h=b+"",k=d.decimalPlaces,l=d.decimalSeparator||".",p=d.thousandsSeparator,q,r;c.isNumber(k)&&(0<=k&&20>=k)&&(h=b.toFixed(k));"."!==l&&(h=h.replace(".",l));if(p){k=h.lastIndexOf(l);k=-1<k?k:h.length;l=h.substring(k);q=0;for(r=k;0<r;r--){if(0===q%3&&r!==k&&(!g||1<r))l=p+l;l=h.charAt(r-1)+l;q++}h=l}h=d.prefix?d.prefix+h:h;return h=d.suffix?h+d.suffix:h}return c.isValue(b)&&
b.toString?b.toString():""}});b.namespace("DataType");b.DataType.Number=b.Number},"3.17.2");
YUI.add("squarespace-terms-of-service-overlay-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["terms-of-service-overlay.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p=this.escapeExpression;b=""+('<div class="overlay"></div>\n<div class="content">\n  <header class=\'title\'>\n    <h1>'+p((l=(l=c.strings,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'</h1>\n  </header>\n  <section>\n    <p>We have recently updated our Terms of Service. Please review them below.</p>\n    <div class=\'tos-frame\'>\n      <iframe name="tos-frame-iframe" src="');
(h=d.tosURL)?h=h.call(c,{hash:{},data:k}):(h=c.tosURL,h="function"===typeof h?h.apply(c):h);b+=p(h)+'?source=in-app" class="terms-of-service-frame" seamless="true" height="';(h=d.iframeHeight)?h=h.call(c,{hash:{},data:k}):(h=c.iframeHeight,h="function"===typeof h?h.apply(c):h);b+=p(h)+'" width="100%">\n        <a href="';(h=d.tosURL)?h=h.call(c,{hash:{},data:k}):(h=c.tosURL,h="function"===typeof h?h.apply(c):h);b+=p(h)+'" target="_blank">Squarespace Terms of Service</a>\n      </iframe>\n    </div>\n  <p>\n  By clicking \'I accept\' below you are agreeing to the <a href="';
(h=d.tosURL)?h=h.call(c,{hash:{},data:k}):(h=c.tosURL,h="function"===typeof h?h.apply(c):h);return b+=p(h)+"\" target=\"_blank\">Squarespace Terms of Service</a>.\n  </p>\n  <div class='buttons'>\n      <div class='control button cancel'>\n        <a class='cancel' href='http://www.squarespace.com/'>"+p((l=(l=c.strings,null==l||!1===l?l:l.cancel),"function"===typeof l?l.apply(c):l))+"</a>\n      </div>\n      <div class='control button primary accept'>\n        <a class='accept' href='#'>"+p((l=(l=
c.strings,null==l||!1===l?l:l.accept),"function"===typeof l?l.apply(c):l))+"</a>\n      </div>\n  </div>\n  </section>\n</div>\n"})})();b.Handlebars.registerPartial("terms-of-service-overlay.html".replace("/","."),d.templates["terms-of-service-overlay.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-commerce-coupon-list-manager",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.CommerceCouponListManager=b.Base.create("CommerceCouponListManager",b.Squarespace.Widgets.AsyncModelListManager,[],{_createHeader:function(){var b=this.get("constructors.header"),c={models:this.get("models"),validCouponCategories:this.get("couponSummary").get("categories")};return new b(c)},_createBody:function(){var b=this.get("constructors.body"),c={models:this.get("models"),
validCouponCategories:this.get("couponSummary").get("categories")};return new b(c)}},{CSS_PREFIX:"sqs-commerce-coupon-list-manager",ATTRS:{constructors:{value:{body:b.Squarespace.Widgets.CommerceCouponList,header:b.Squarespace.Widgets.CommerceCouponListHeader,models:b.Squarespace.Models.CommerceCouponList}},loadable:{valueFn:function(){return this.get("couponSummary")}},loadOnInitialize:{value:!0,writeOnce:"initOnly"},couponSummary:{valueFn:function(){return new b.Squarespace.Models.CommerceCouponSummary({coupons:this.get("models")})},
writeOnce:"initOnly"}}})},"1.0",{requires:"base squarespace-models-commerce-coupon-list squarespace-models-commerce-coupon-summary squarespace-widgets-async-model-list-manager squarespace-widgets-commerce-coupon-list squarespace-widgets-commerce-coupon-list-header".split(" ")});
YUI.add("widget-autohide",function(b,d){function c(c){b.after(this._bindUIAutohide,this,e);b.after(this._syncUIAutohide,this,f);this.get(g)&&(this._bindUIAutohide(),this._syncUIAutohide())}var e="bindUI",f="syncUI",g="rendered";c.ATTRS={hideOn:{validator:b.Lang.isArray,valueFn:function(){return[{node:b.one("document"),eventName:"key",keyCode:"esc"}]}}};c.prototype={_uiHandlesAutohide:null,destructor:function(){this._detachUIHandlesAutohide()},_bindUIAutohide:function(){this.after("visibleChange",
this._afterHostVisibleChangeAutohide);this.after("hideOnChange",this._afterHideOnChange)},_syncUIAutohide:function(){this._uiSetHostVisibleAutohide(this.get("visible"))},_uiSetHostVisibleAutohide:function(c){c?b.later(1,this,"_attachUIHandlesAutohide"):this._detachUIHandlesAutohide()},_attachUIHandlesAutohide:function(){if(!this._uiHandlesAutohide){for(var c=this.get("boundingBox"),e=b.bind(this.hide,this),d=[],f=this.get("hideOn"),g=0,r=void 0,s=void 0,t=void 0;g<f.length;g++)r=f[g].node,s=f[g].eventName,
t=f[g].keyCode,!r&&!t&&s?d.push(c.on(s,e)):r&&!t&&s?d.push(r.on(s,e)):r&&(t&&s)&&d.push(r.on(s,e,t));this._uiHandlesAutohide=d}},_detachUIHandlesAutohide:function(){b.each(this._uiHandlesAutohide,function(b){b.detach()});this._uiHandlesAutohide=null},_afterHostVisibleChangeAutohide:function(b){this._uiSetHostVisibleAutohide(b.newVal)},_afterHideOnChange:function(b){this._detachUIHandlesAutohide();this.get("visible")&&this._attachUIHandlesAutohide()}};b.WidgetAutohide=c},"3.17.2",{requires:["base-build",
"event-key","event-outside","widget"]});
YUI.add("squarespace-dialog-xero-setup-checklist",function(b){var d=b.namespace("Squarespace.DialogFields").XeroSetupCheckList=b.Base.create("xeroSetupChecklist",b.Squarespace.DialogField2,[b.Squarespace.Mixins.XeroConfigurationDialogs],{initializer:function(c){this._xeroAuthenticator=new b.Squarespace.ExternalAuthentication({authenticationType:"website",reloadAfterLogin:!1});this.publish("setupFinished");this._websiteSettings=new b.Squarespace.Models.WebsiteSettings(c.websiteSettings);this._connectedAccount=
new b.Squarespace.Models.XeroConnectedAccount;this._connectedAccount.on("load-requested",this._onLoadRequested,this);this._connectedAccount.after("save",this._connectedAccount.load,this._connectedAccount);this._connectedAccount.after("load",this._onAccountLoad,this);this._connectedAccount.after("error",this._onAccountLoadError,this);(this._isConnected=b.Lang.isValue(this._websiteSettings.get("storeSettings").xeroConnectedAccountId))&&this._connectedAccount.load()},_onLoadRequested:function(){this.get("rendered")&&
this._checklistContainer.loadingOverlay.set("visible",!0)},_onAccountLoad:function(c){c=this._connectedAccount;var e=c.get("metaData")||{service:"xero"};c.set("metaData",e);b.Lang.isNull(c.get("id"))||this.setAttrs(b.merge(e,{isConnected:!0}));this._checklistContainer.loadingOverlay.set("visible",!1);c=c.get("id");Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.xeroConnectedAccountId=c},_onAccountLoadError:function(){this._checklistContainer.loadingOverlay.set("visible",!1)},renderUI:function(){d.superclass.renderUI.call(this);
var c=this.get("contentBox");this._connectRow=c.one(".checklist-connect");this._taxesRow=c.one(".checklist-tax-rates");this._chartAccountsRow=c.one(".checklist-chart-of-accounts");this._finishRow=c.one(".checklist-finish");this.add({childType:b.Squarespace.DialogFields.Button,render:this._connectRow.one(".checklist-button"),className:"light","strings.text":"Connect Xero",onClick:this._doOAuth,context:this});this.add({childType:b.Squarespace.DialogFields.Button,render:this._taxesRow.one(".checklist-button"),
className:"light","strings.text":"Set Up Tax Rates",onClick:function(){this._showSetupTaxesDialog('<div class="sqs-xero-setup-copy"><p>Squarespace\'s Daily Sales Summary includes detailed information about your store\'s sales tax liabilities. To continue, you need to create Tax Rates in Xero that match your Taxes in Squarespace Commerce. Click "Create Missing Tax Rates" to add all the Tax Rates your store needs to Xero.</p><p>Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more about Tax Rates in Xero and Squarespace.</p></div>',
"Set Up Tax Rates")},context:this});this.add({childType:b.Squarespace.DialogFields.Button,render:this._chartAccountsRow.one(".checklist-button"),className:"light","strings.text":"Set Up Account Mappings",onClick:function(){this._showChartOfAccountsDialog(!0,'<div class="sqs-xero-setup-copy setup-copy-disabled"><h2>Step 2: Map Line Items</h2> <p>Now, choose which account each line item of your Daily Sales Summary will be mapped to. If you would like to rename any of the accounts made in Step 1, you may do so from Xero\'s Chart of Accounts area  afterward. Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more about setting up account mappings.</p><p> <strong>Note:</strong> The default choices below are only suggestions, and do not constitute accounting advice. If your business uses an accountant, it is highly recommended that you consult with them before continuing.</p></div>',
"Set Up Account Mappings")},context:this});this.add({childType:b.Squarespace.DialogFields.Button,render:this._finishRow.one(".checklist-button"),className:"light","strings.text":"Finish",onClick:this._finishSetup,context:this});this._checklistContainer=this.get("contentBox").one(".checklist-container");this._checklistContainer.plug(b.Squarespace.Plugins.LoadingOverlay,{spinnerConfig:{size:"extra-large",color:"dark"}});this._isConnected||this._checklistContainer.loadingOverlay.set("visible",!1)},bindUI:function(){d.superclass.bindUI.call(this);
this.get("contentBox");this.get("configPanel");this._xeroAuthenticator.on("completed",this._connectedAccount.load,this._connectedAccount);this.after(["isConnectedChange","taxesCompleteChange","chartOfAccountsCompleteChange","setupFinishedChange"],this.syncUI,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("setupFinished")&&(this.get("boundingBox").removeClass("checklist-loaded"),this.get("boundingBox").addClass("checklist-setup-finished"));var c=this.get("isConnected"),e=this.get("taxesComplete"),
f=this.get("chartOfAccountsComplete"),g=c&&f,h=c&&e&&f;this._chartAccountsRow.toggleClass("checklist-disabled",!c);this._taxesRow.toggleClass("checklist-disabled",!g);this._finishRow.toggleClass("checklist-disabled",!h);this._connectRow.toggleClass("checklist-complete",c);g&&this._taxesRow.toggleClass("checklist-complete",e);this._chartAccountsRow.toggleClass("checklist-complete",f);this.after("isConnectedChange",function(){this.get("isConnected")&&b.Squarespace.Analytics.trackInternal("merchant_connected_xero")});
this.after("setupFinishedChange",function(){this.get("setupFinished")&&b.Squarespace.Analytics.trackInternal("merchant_finished_xero_setup")})},_doOAuth:function(){this.get("disableConnect")||this._xeroAuthenticator.openPopupWindow(b.Squarespace.ExternalServiceProviders.XERO)},_finishSetup:function(){var c=this._websiteSettings,e=c.get("storeSettings"),d=this._connectedAccount;d.load(b.bind(function(){var g=d.get("metaData");g.taxesComplete&&g.chartOfAccountsComplete&&(e.xeroSetupComplete=!0,Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.xeroSetupComplete=
!0,c.set("storeSettings",e),c.set("socialAccountDisplayOrder",null),c.save(b.bind(function(){this.set("setupFinished",!0)},this)))},this))}},{CSS_PREFIX:"sqs-xero-setup-checklist",HANDLEBARS_TEMPLATE:"dialog-xero-setup-checklist.html",ATTRS:{isConnected:{value:!1},taxesComplete:{value:!1},chartOfAccountsComplete:{value:!1},setupFinished:{value:!1},timezoneAbbr:{},configPanel:{},disableConnect:{value:!1}}})},"1.0",{requires:"base node squarespace-dialog-field-2 squarespace-dialog-button squarespace-ui-templates squarespace-dialog-xero-setup-checklist-template squarespace-dialog-xero-setup-checklist-css squarespace-models-xero-connected-account squarespace-models-website-settings squarespace-xero-configuration-mixin squarespace-plugin-loading-overlay squarespace-util".split(" ")});
YUI.add("squarespace-block-search",function(b){var d=b.namespace("Squarespace.Block").Search=b.Base.create("block-search",b.Squarespace.Block.ModelSyncBase,[],{destructor:function(){this._searchPreview&&this._searchPreview.destroy()},_renderSuccess:function(c){d.superclass._renderSuccess.call(this,c);c=this.get("contentBox").one(".sqs-search-ui-text-input");b.Lang.isValue(c)&&(this._searchPreview=new b.Squarespace.Widgets.SearchPreview({render:c}))}},{CSS_PREFIX:"sqs-block-search",ATTRS:{editor:{value:b.Squarespace.Block.Editor.Search},
type:{value:b.Squarespace.BlockType.SEARCH}}})},"1.0",{requires:"base model squarespace-enum squarespace-search-preview squarespace-search-page squarespace-block-base-modelsync squarespace-block-search-editor".split(" ")});
YUI.add("squarespace-block-social-account-links-editor",function(b){b.namespace("Squarespace.Block.Editor").SocialAccountLinks=b.Base.create("socialAccountLinksEditor",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.SocialAccountLinks")}},{NS:"blockEditor"})},"1.0",{requires:["base","squarespace-block-social-account-links-model-editor","squarespace-damask-context-globals"]});
YUI.add("squarespace-dialog-state-indicator-banner",function(b){var d=b.namespace("Squarespace.DialogFields").StateIndicatorBanner=b.Base.create("stateIndicatorBanner",b.Squarespace.DialogField2,[],{initializer:function(c){this._stateDisplayMap={};b.Array.forEach(c.stateDisplays,function(b){this._stateDisplayMap[b.value]={state:b.state,message:b.message}},this)},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox");c.one(".warn-msg").plug(b.Squarespace.Animations.Scalable,
{duration:0.25});c.one(".live-msg").plug(b.Squarespace.Animations.Scalable,{duration:0.25});this._updateClass(this._getStateDisplay(this.get("data")))},bindUI:function(){d.superclass.bindUI.call(this)},syncUI:function(){var b=this.get("contentBox"),e=this._getStateDisplay(this.get("data"));e?(b.setStyle("opacity",1),this._updateCopy(e)):b.setStyle("opacity",0);this._doTransition(e);this._inDefinedState=e?!0:!1},_updateClass:function(b){var e=this.get("contentBox"),d=this._inOkState(b);b=d?"warn":
"live";var d=d?"live":"warn",g=!e.hasClass(d);e.removeClass(b);e.addClass(d);return g},_getStateDisplay:function(b){return this._stateDisplayMap[b]},_inOkState:function(c){return b.Lang.isObject(c)&&c.state===d.STATES.OK},_updateCopy:function(b){var e=this.get("contentBox");this._inOkState(b)?e.one(".live-msg span").setHTML(b.message):e.one(".warn-msg span").setHTML(b.message)},_doTransition:function(b){var e=this._inOkState(b),d=this.get("contentBox"),g=e?d.one(".warn-msg"):d.one(".live-msg"),h=
e?d.one(".live-msg"):d.one(".warn-msg"),k=this._updateClass(b);g.hide();g.once("hidden",function(){k&&h.show()})}},{STATES:{OK:1,WARN:2},CSS_PREFIX:"sqs-state-indicator-banner",TEMPLATE:'<div class="warning-wrapper"><div class="warn-msg"><img width="16" height="16" src="/universal/images-v6/dialog/tiny-alert.png" /><span></span></div><div class="live-msg"><img width="16" height="16" src="/universal/images-v6/dialog/checkbox-active-14-light.png" /><span></span></div></div>'})},"1.0",{requires:["base",
"node","squarespace-animations","squarespace-dialog-field-2","squarespace-dialog-state-indicator-banner-css"]});
YUI.add("text-wordbreak",function(b,d){var c=b.Text,e=c.Data.WordBreak,f=[RegExp(e.aletter),RegExp(e.midnumlet),RegExp(e.midletter),RegExp(e.midnum),RegExp(e.numeric),RegExp(e.cr),RegExp(e.lf),RegExp(e.newline),RegExp(e.extend),RegExp(e.format),RegExp(e.katakana),RegExp(e.extendnumlet)],g=RegExp("^"+e.punctuation+"$"),h=/\s/,k={getWords:function(b,c){var e=0,d=k._classify(b),f=d.length,t=[],u=[],v,w,y;c||(c={});c.ignoreCase&&(b=b.toLowerCase());w=c.includePunctuation;for(y=c.includeWhitespace;e<f;++e)v=
b.charAt(e),t.push(v),k._isWordBoundary(d,e)&&((t=t.join(""))&&((y||!h.test(t))&&(w||!g.test(t)))&&u.push(t),t=[]);return u},getUniqueWords:function(c,e){return b.Array.unique(k.getWords(c,e))},isWordBoundary:function(b,c){return k._isWordBoundary(k._classify(b),c)},_classify:function(b){for(var c,e=[],d=0,g,h,k=b.length,v=f.length,w;d<k;++d){c=b.charAt(d);w=12;for(g=0;g<v;++g)if((h=f[g])&&h.test(c)){w=g;break}e.push(w)}return e},_isWordBoundary:function(b,c){var e,d=b[c],f=b[c+1],g;if(0>c||c>b.length-
1&&0!==c||0===d&&0===f)return!1;g=b[c+2];if(0===d&&(2===f||1===f)&&0===g)return!1;e=b[c-1];return(2===d||1===d)&&0===f&&0===e||(4===d||0===d)&&(4===f||0===f)||(3===d||1===d)&&4===f&&4===e||4===d&&(3===f||1===f)&&4===g||(8===d||9===d||8===e||9===e||8===f||9===f)||5===d&&6===f?!1:7===d||5===d||6===d||7===f||5===f||6===f?!0:10===d&&10===f||11===f&&(0===d||4===d||10===d||11===d)||11===d&&(0===f||4===f||10===f)?!1:!0}};c.WordBreak=k},"3.17.2",{requires:["array-extras","text-data-wordbreak"]});
YUI.add("test",function(b,d){YUI.YUITest?b.Test=YUI.YUITest:(YUITest={version:"3.17.2",guid:function(c){return b.guid(c)}},b.namespace("Test"),YUITest.Object=b.Object,YUITest.Array=b.Array,YUITest.Util={mix:b.mix,JSON:b.JSON},YUITest.EventTarget=function(){this._handlers={}},YUITest.EventTarget.prototype={constructor:YUITest.EventTarget,attach:function(b,c){"undefined"==typeof this._handlers[b]&&(this._handlers[b]=[]);this._handlers[b].push(c)},subscribe:function(b,c){this.attach.apply(this,arguments)},
fire:function(b){"string"==typeof b&&(b={type:b});b.target||(b.target=this);if(!b.type)throw Error("Event object missing 'type' property.");if(this._handlers[b.type]instanceof Array)for(var c=this._handlers[b.type],e=0,d=c.length;e<d;e++)c[e].call(this,b)},detach:function(b,c){if(this._handlers[b]instanceof Array)for(var e=this._handlers[b],d=0,f=e.length;d<f;d++)if(e[d]===c){e.splice(d,1);break}},unsubscribe:function(b,c){this.detach.apply(this,arguments)}},YUITest.TestSuite=function(b){this.name=
"";this.items=[];if("string"==typeof b)this.name=b;else if(b instanceof Object)for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c]);if(""===this.name||!this.name)this.name=YUITest.guid("testSuite_")},YUITest.TestSuite.prototype={constructor:YUITest.TestSuite,add:function(b){(b instanceof YUITest.TestSuite||b instanceof YUITest.TestCase)&&this.items.push(b);return this},setUp:function(){},tearDown:function(){}},YUITest.TestCase=function(b){this._should={};for(var c in b)this[c]=b[c];"string"!=typeof this.name&&
(this.name=YUITest.guid("testCase_"))},YUITest.TestCase.DEFAULT_WAIT=1E4,YUITest.TestCase._waitTimeout=function(){YUITest.Assert.fail("Timeout: wait() called but resume() never called.")},YUITest.TestCase.prototype={constructor:YUITest.TestCase,callback:function(){return YUITest.TestRunner.callback.apply(YUITest.TestRunner,arguments)},resume:function(b){YUITest.TestRunner.resume(b)},wait:function(b,c){c="number"===typeof b?b:"number"===typeof c?c:YUITest.TestCase.DEFAULT_WAIT;"function"!==typeof b&&
(b=YUITest.TestCase._waitTimeout);throw new YUITest.Wait(b,c);},next:function(b,c){var e=this;c=2<=arguments.length?arguments[1]:void 0;return function(){var d=arguments;void 0===c&&(c=this);e.resume(function(){b.apply(c,d)})}},waitFor:function(b,c,e,d){var f=this,g;("function"!==typeof b||"function"!==typeof c)&&f.fail("waitFor() called with invalid parameters.");"number"!==typeof e&&(e=YUITest.TestCase.DEFAULT_WAIT);g=+new Date+e;"number"!==typeof d&&(d=100);f.wait(function(){var e;b.call(f)?c.call(f):
(e=+new Date,e>g?YUITest.TestCase._waitTimeout():f.waitFor(b,c,g-e,d))},d)},assert:function(b,c){YUITest.Assert._increment();if(!b)throw new YUITest.AssertionError(YUITest.Assert._formatMessage(c,"Assertion failed."));},fail:function(b){YUITest.Assert.fail(b)},init:function(){},destroy:function(){},setUp:function(){},tearDown:function(){}},YUITest.TestFormat=function(){function b(c){return c.replace(/[<>"'&]/g,function(b){switch(b){case "<":return"&lt;";case ">":return"&gt;";case '"':return"&quot;";
case "'":return"&apos;";case "&":return"&amp;"}})}return{JSON:function(b){return YUITest.Util.JSON.stringify(b)},XML:function(c){function e(c){var d="<"+c.type+' name="'+b(c.name)+'"';"number"==typeof c.duration&&(d+=' duration="'+c.duration+'"');if("test"==c.type)d+=' result="'+c.result+'" message="'+b(c.message)+'">';else{var d=d+(' passed="'+c.passed+'" failed="'+c.failed+'" ignored="'+c.ignored+'" total="'+c.total+'">'),f;for(f in c)c.hasOwnProperty(f)&&c[f]&&("object"==typeof c[f]&&!(c[f]instanceof
Array))&&(d+=e(c[f]))}return d+="</"+c.type+">"}return'<?xml version="1.0" encoding="UTF-8"?>'+e(c)},JUnitXML:function(c){function e(c){var d="";switch(c.type){case "test":"ignore"!=c.result&&(d='<testcase name="'+b(c.name)+'" time="'+c.duration/1E3+'">',"fail"==c.result&&(d+='<failure message="'+b(c.message)+'"><![CDATA['+c.message+"]]\x3e</failure>"),d+="</testcase>");break;case "testcase":var d='<testsuite name="'+b(c.name)+'" tests="'+c.total+'" failures="'+c.failed+'" time="'+c.duration/1E3+
'">',f;for(f in c)c.hasOwnProperty(f)&&c[f]&&("object"==typeof c[f]&&!(c[f]instanceof Array))&&(d+=e(c[f]));d+="</testsuite>";break;case "testsuite":for(f in c)c.hasOwnProperty(f)&&c[f]&&("object"==typeof c[f]&&!(c[f]instanceof Array))&&(d+=e(c[f]));break;case "report":d="<testsuites>";for(f in c)c.hasOwnProperty(f)&&c[f]&&("object"==typeof c[f]&&!(c[f]instanceof Array))&&(d+=e(c[f]));d+="</testsuites>"}return d}return'<?xml version="1.0" encoding="UTF-8"?>'+e(c)},TAP:function(b){function c(b){var d=
"";switch(b.type){case "test":"ignore"!=b.result?(d="ok "+e++ +" - "+b.name,"fail"==b.result&&(d="not "+d+" - "+b.message),d+="\n"):d="#Ignored test "+b.name+"\n";break;case "testcase":var d="#Begin testcase "+b.name+"("+b.failed+" failed of "+b.total+")\n",f;for(f in b)b.hasOwnProperty(f)&&b[f]&&("object"==typeof b[f]&&!(b[f]instanceof Array))&&(d+=c(b[f]));d+="#End testcase "+b.name+"\n";break;case "testsuite":d="#Begin testsuite "+b.name+"("+b.failed+" failed of "+b.total+")\n";for(f in b)b.hasOwnProperty(f)&&
b[f]&&("object"==typeof b[f]&&!(b[f]instanceof Array))&&(d+=c(b[f]));d+="#End testsuite "+b.name+"\n";break;case "report":for(f in b)b.hasOwnProperty(f)&&b[f]&&("object"==typeof b[f]&&!(b[f]instanceof Array))&&(d+=c(b[f]))}return d}var e=1;return"1.."+b.total+"\n"+c(b)}}}(),YUITest.Reporter=function(b,c){this.url=b;this.format=c||YUITest.TestFormat.XML;this._fields={};this._iframe=this._form=null},YUITest.Reporter.prototype={constructor:YUITest.Reporter,addField:function(b,c){this._fields[b]=c},clearFields:function(){this._fields=
{}},destroy:function(){this._form&&(this._form.parentNode.removeChild(this._form),this._form=null);this._iframe&&(this._iframe.parentNode.removeChild(this._iframe),this._iframe=null);this._fields=null},report:function(b,c){if(!this._form){this._form=document.createElement("form");this._form.method="post";this._form.style.visibility="hidden";this._form.style.position="absolute";this._form.style.top=0;document.body.appendChild(this._form);try{this._iframe=document.createElement('<iframe name="yuiTestTarget" />')}catch(e){this._iframe=
document.createElement("iframe"),this._iframe.name="yuiTestTarget"}this._iframe.src="javascript:false";this._iframe.style.visibility="hidden";this._iframe.style.position="absolute";this._iframe.style.top=0;document.body.appendChild(this._iframe);this._form.target="yuiTestTarget"}for(this._form.action=this.url;this._form.hasChildNodes();)this._form.removeChild(this._form.lastChild);this._fields.results=this.format(b);this._fields.useragent=navigator.userAgent;this._fields.timestamp=(new Date).toLocaleString();
for(var d in this._fields){var f=this._fields[d];if(this._fields.hasOwnProperty(d)&&"function"!=typeof f){var g=document.createElement("input");g.type="hidden";g.name=d;g.value=f;this._form.appendChild(g)}}delete this._fields.results;delete this._fields.useragent;delete this._fields.timestamp;!1!==c&&this._form.submit()}},YUITest.TestRunner=function(){function b(c,e){if(e.length){if(c)for(var d=0,f=c.length;d<f;d++)if(-1<e.indexOf(","+c[d]+","))return!0;return!1}return!0}function c(b){this.testObject=
b;this.next=this.parent=this.lastChild=this.firstChild=null;this.results=new YUITest.Results;b instanceof YUITest.TestSuite?(this.results.type="testsuite",this.results.name=b.name):b instanceof YUITest.TestCase&&(this.results.type="testcase",this.results.name=b.name)}function e(){YUITest.EventTarget.call(this);this.masterSuite=new YUITest.TestSuite(YUITest.guid("testSuite_"));this._root=this._cur=null;this._log=!0;this._running=this._waiting=!1;this._context=this._lastResults=null;this._groups=""}
c.prototype={appendChild:function(b){b=new c(b);null===this.firstChild?this.firstChild=this.lastChild=b:this.lastChild=this.lastChild.next=b;b.parent=this;return b}};e.prototype=YUITest.Util.mix(new YUITest.EventTarget,{_ignoreEmpty:!1,constructor:YUITest.TestRunner,TEST_CASE_BEGIN_EVENT:"testcasebegin",TEST_CASE_COMPLETE_EVENT:"testcasecomplete",TEST_SUITE_BEGIN_EVENT:"testsuitebegin",TEST_SUITE_COMPLETE_EVENT:"testsuitecomplete",TEST_PASS_EVENT:"pass",TEST_FAIL_EVENT:"fail",ERROR_EVENT:"error",
TEST_IGNORE_EVENT:"ignore",COMPLETE_EVENT:"complete",BEGIN_EVENT:"begin",_addTestCaseToTestTree:function(b,c){var e=b.appendChild(c),d;for(d in c)(0===d.indexOf("test")||-1<d.indexOf(" "))&&"function"==typeof c[d]&&e.appendChild(d)},_addTestSuiteToTestTree:function(b,c){for(var e=b.appendChild(c),d=0;d<c.items.length;d++)c.items[d]instanceof YUITest.TestSuite?this._addTestSuiteToTestTree(e,c.items[d]):c.items[d]instanceof YUITest.TestCase&&this._addTestCaseToTestTree(e,c.items[d])},_buildTestTree:function(){this._root=
new c(this.masterSuite);for(var b=0;b<this.masterSuite.items.length;b++)this.masterSuite.items[b]instanceof YUITest.TestSuite?this._addTestSuiteToTestTree(this._root,this.masterSuite.items[b]):this.masterSuite.items[b]instanceof YUITest.TestCase&&this._addTestCaseToTestTree(this._root,this.masterSuite.items[b])},_handleTestObjectComplete:function(b){var c;if(b&&"object"==typeof b.testObject){if(c=b.parent)c.results.include(b.results),c.results[b.testObject.name]=b.results;b.testObject instanceof YUITest.TestSuite?
(this._execNonTestMethod(b,"tearDown",!1),b.results.duration=new Date-b._start,this.fire({type:this.TEST_SUITE_COMPLETE_EVENT,testSuite:b.testObject,results:b.results})):b.testObject instanceof YUITest.TestCase&&(this._execNonTestMethod(b,"destroy",!1),b.results.duration=new Date-b._start,this.fire({type:this.TEST_CASE_COMPLETE_EVENT,testCase:b.testObject,results:b.results}))}},_next:function(){if(null===this._cur)this._cur=this._root;else if(this._cur.firstChild)this._cur=this._cur.firstChild;else if(this._cur.next)this._cur=
this._cur.next;else{for(;this._cur&&!this._cur.next&&this._cur!==this._root;)this._handleTestObjectComplete(this._cur),this._cur=this._cur.parent;this._handleTestObjectComplete(this._cur);this._cur==this._root?(this._cur.results.type="report",this._cur.results.timestamp=(new Date).toLocaleString(),this._cur.results.duration=new Date-this._cur._start,this._lastResults=this._cur.results,this._running=!1,this.fire({type:this.COMPLETE_EVENT,results:this._lastResults}),this._cur=null):this._cur&&(this._cur=
this._cur.next)}return this._cur},_execNonTestMethod:function(b,c,e){var d=b.testObject,f={type:this.ERROR_EVENT};try{if(e&&d["async:"+c])return d["async:"+c](this._context),!0;d[c](this._context)}catch(g){b.results.errors++,f.error=g,f.methodName=c,d instanceof YUITest.TestCase?f.testCase=d:f.testSuite=testSuite,this.fire(f)}return!1},_run:function(){var b=this._next();if(null!==b){this._running=!0;this._lastResult=null;var c=b.testObject;if("object"==typeof c&&null!==c){if(c instanceof YUITest.TestSuite)this.fire({type:this.TEST_SUITE_BEGIN_EVENT,
testSuite:c}),b._start=new Date,this._execNonTestMethod(b,"setUp",!1);else if(c instanceof YUITest.TestCase&&(this.fire({type:this.TEST_CASE_BEGIN_EVENT,testCase:c}),b._start=new Date,this._execNonTestMethod(b,"init",!0)))return;"undefined"!=typeof setTimeout?setTimeout(function(){YUITest.TestRunner._run()},0):this._run()}else this._runTest(b)}},_resumeTest:function(b){var c=this._cur;this._waiting=!1;if(c){var e=c.testObject,d=c.parent.testObject;d.__yui_wait&&(clearTimeout(d.__yui_wait),delete d.__yui_wait);
var f=0===e.indexOf("fail:")||(d._should.fail||{})[e],g=(d._should.error||{})[e],h=!1,k=null;try{b.call(d,this._context);if(0==YUITest.Assert._getCount()&&!this._ignoreEmpty)throw new YUITest.AssertionError("Test has no asserts.");f?(k=new YUITest.ShouldFail,h=!0):g&&(k=new YUITest.ShouldError,h=!0)}catch(l){if(d.__yui_wait&&(clearTimeout(d.__yui_wait),delete d.__yui_wait),l instanceof YUITest.AssertionError)f||(k=l,h=!0);else{if(l instanceof YUITest.Wait){if("function"==typeof l.segment&&"number"==
typeof l.delay)if("undefined"!=typeof setTimeout)d.__yui_wait=setTimeout(function(){YUITest.TestRunner._resumeTest(l.segment)},l.delay),this._waiting=!0;else throw Error("Asynchronous tests not supported in this environment.");return}if(g)if("string"==typeof g)l.message!=g&&(k=new YUITest.UnexpectedError(l),h=!0);else if("function"==typeof g)l instanceof g||(k=new YUITest.UnexpectedError(l),h=!0);else{if("object"==typeof g&&null!==g&&(!(l instanceof g.constructor)||l.message!=g.message))k=new YUITest.UnexpectedError(l),
h=!0}else k=new YUITest.UnexpectedError(l),h=!0}}h?this.fire({type:this.TEST_FAIL_EVENT,testCase:d,testName:e,error:k}):this.fire({type:this.TEST_PASS_EVENT,testCase:d,testName:e});this._execNonTestMethod(c.parent,"tearDown",!1);YUITest.Assert._reset();b=new Date-c._start;c.parent.results[e]={result:h?"fail":"pass",message:k?k.getMessage():"Test passed",type:"test",name:e,duration:b};h?c.parent.results.failed++:c.parent.results.passed++;c.parent.results.total++;"undefined"!=typeof setTimeout?setTimeout(function(){YUITest.TestRunner._run()},
0):this._run()}},_handleError:function(b){if(this._waiting)this._resumeTest(function(){throw b;});else throw b;},_runTest:function(c){var e=c.testObject,d=c.parent.testObject,f=d[e];0===e.indexOf("ignore:")||!b(d.groups,this._groups)||(d._should.ignore||{})[e]?(c.parent.results[e]={result:"ignore",message:"Test ignored",type:"test",name:0===e.indexOf("ignore:")?e.substring(7):e},c.parent.results.ignored++,c.parent.results.total++,this.fire({type:this.TEST_IGNORE_EVENT,testCase:d,testName:e}),"undefined"!=
typeof setTimeout?setTimeout(function(){YUITest.TestRunner._run()},0):this._run()):(c._start=new Date,this._execNonTestMethod(c.parent,"setUp",!1),this._resumeTest(f))},getName:function(){return this.masterSuite.name},setName:function(b){this.masterSuite.name=b},add:function(b){this.masterSuite.add(b);return this},clear:function(){this.masterSuite=new YUITest.TestSuite(YUITest.guid("testSuite_"))},isWaiting:function(){return this._waiting},isRunning:function(){return this._running},getResults:function(b){return!this._running&&
this._lastResults?"function"==typeof b?b(this._lastResults):this._lastResults:null},getCoverage:function(b){var c=null;"object"===typeof _yuitest_coverage&&(c=_yuitest_coverage);"object"===typeof __coverage__&&(c=__coverage__);return!this._running&&"object"==typeof c?"function"==typeof b?b(c):c:null},callback:function(){var b=arguments,c=this._context,e=this;return function(){for(var d=0;d<arguments.length;d++)c[b[d]]=arguments[d];e._run()}},resume:function(b){if(this._waiting)this._resumeTest(b||
function(){});else throw Error("resume() called without wait().");},run:function(b){b=b||{};var c=YUITest.TestRunner;!b.oldMode&&(1==this.masterSuite.items.length&&this.masterSuite.items[0]instanceof YUITest.TestSuite)&&(this.masterSuite=this.masterSuite.items[0]);c._groups=b.groups instanceof Array?","+b.groups.join(",")+",":"";c._buildTestTree();c._context={};c._root._start=new Date;c.fire(c.BEGIN_EVENT);c._run()}});return new e}(),YUITest.ArrayAssert={_indexOf:function(b,c){if(b.indexOf)return b.indexOf(c);
for(var e=0;e<b.length;e++)if(b[e]===c)return e;return-1},_some:function(b,c){if(b.some)return b.some(c);for(var e=0;e<b.length;e++)if(c(b[e]))return!0;return!1},contains:function(b,c,e){YUITest.Assert._increment();-1==this._indexOf(c,b)&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Value "+b+" ("+typeof b+") not found in array ["+c+"]."))},containsItems:function(b,c,e){YUITest.Assert._increment();for(var d=0;d<b.length;d++)-1==this._indexOf(c,b[d])&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,
"Value "+b[d]+" ("+typeof b[d]+") not found in array ["+c+"]."))},containsMatch:function(b,c,e){YUITest.Assert._increment();if("function"!=typeof b)throw new TypeError("ArrayAssert.containsMatch(): First argument must be a function.");this._some(c,b)||YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"No match found in array ["+c+"]."))},doesNotContain:function(b,c,e){YUITest.Assert._increment();-1<this._indexOf(c,b)&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Value found in array ["+
c+"]."))},doesNotContainItems:function(b,c,e){YUITest.Assert._increment();for(var d=0;d<b.length;d++)-1<this._indexOf(c,b[d])&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Value found in array ["+c+"]."))},doesNotContainMatch:function(b,c,e){YUITest.Assert._increment();if("function"!=typeof b)throw new TypeError("ArrayAssert.doesNotContainMatch(): First argument must be a function.");this._some(c,b)&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Value found in array ["+c+"]."))},indexOf:function(b,
c,e,d){YUITest.Assert._increment();for(var f=0;f<c.length;f++)if(c[f]===b){e!=f&&YUITest.Assert.fail(YUITest.Assert._formatMessage(d,"Value exists at index "+f+" but should be at index "+e+"."));return}YUITest.Assert.fail(YUITest.Assert._formatMessage(d,"Value doesn't exist in array ["+c+"]."))},itemsAreEqual:function(b,c,e){YUITest.Assert._increment();("object"!=typeof b||"object"!=typeof c)&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Value should be an array."));b.length!=c.length&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,
"Array should have a length of "+b.length+" but has a length of "+c.length+"."));for(var d=0;d<b.length;d++)if(b[d]!=c[d])throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Values in position "+d+" are not equal."),b[d],c[d]);},itemsAreEquivalent:function(b,c,e,d){YUITest.Assert._increment();if("function"!=typeof e)throw new TypeError("ArrayAssert.itemsAreEquivalent(): Third argument must be a function.");b.length!=c.length&&YUITest.Assert.fail(YUITest.Assert._formatMessage(d,"Array should have a length of "+
b.length+" but has a length of "+c.length));for(var f=0;f<b.length;f++)if(!e(b[f],c[f]))throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(d,"Values in position "+f+" are not equivalent."),b[f],c[f]);},isEmpty:function(b,c){YUITest.Assert._increment();0<b.length&&YUITest.Assert.fail(YUITest.Assert._formatMessage(c,"Array should be empty."))},isNotEmpty:function(b,c){YUITest.Assert._increment();0===b.length&&YUITest.Assert.fail(YUITest.Assert._formatMessage(c,"Array should not be empty."))},
itemsAreSame:function(b,c,e){YUITest.Assert._increment();b.length!=c.length&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Array should have a length of "+b.length+" but has a length of "+c.length));for(var d=0;d<b.length;d++)if(b[d]!==c[d])throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Values in position "+d+" are not the same."),b[d],c[d]);},lastIndexOf:function(b,c,e,d){for(var f=c.length;0<=f;f--)if(c[f]===b){e!=f&&YUITest.Assert.fail(YUITest.Assert._formatMessage(d,
"Value exists at index "+f+" but should be at index "+e+"."));return}YUITest.Assert.fail(YUITest.Assert._formatMessage(d,"Value doesn't exist in array."))},isUnique:function(c,e,d){YUITest.Assert._increment();if(!b.Lang.isArray(c))throw new TypeError("ArrayAssert.isUnique(): First argument must be an array");if(b.Lang.isValue(e)&&!b.Lang.isFunction(e))throw new TypeError("ArrayAssert.isUnique(): Second argument must be a function");b.Array.unique(c,e).length<c.length&&(d=YUITest.Assert._formatMessage(d,
"Array contains duplicate(s)"),YUITest.Assert.fail(d))}},YUITest.Assert={_asserts:0,_formatMessage:function(b,c){return"string"==typeof b&&0<b.length?b.replace("{message}",c):c},_getCount:function(){return this._asserts},_increment:function(){this._asserts++},_reset:function(){this._asserts=0},fail:function(b){throw new YUITest.AssertionError(YUITest.Assert._formatMessage(b,"Test force-failed."));},pass:function(b){YUITest.Assert._increment()},areEqual:function(b,c,e){YUITest.Assert._increment();
if(b!=c)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Values should be equal."),b,c);},areNotEqual:function(b,c,e){YUITest.Assert._increment();if(b==c)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(e,"Values should not be equal."),b);},areNotSame:function(b,c,e){YUITest.Assert._increment();if(b===c)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(e,"Values should not be the same."),b);},areSame:function(b,c,e){YUITest.Assert._increment();if(b!==
c)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Values should be the same."),b,c);},isFalse:function(b,c){YUITest.Assert._increment();if(!1!==b)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(c,"Value should be false."),!1,b);},isTrue:function(b,c){YUITest.Assert._increment();if(!0!==b)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(c,"Value should be true."),!0,b);},isNaN:function(b,c){YUITest.Assert._increment();if(!isNaN(b))throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(c,
"Value should be NaN."),NaN,b);},isNotNaN:function(b,c){YUITest.Assert._increment();if(isNaN(b))throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Values should not be NaN."),NaN);},isNotNull:function(b,c){YUITest.Assert._increment();if(null===b)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Values should not be null."),null);},isNotUndefined:function(b,c){YUITest.Assert._increment();if("undefined"==typeof b)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,
"Value should not be undefined."),void 0);},isNull:function(b,c){YUITest.Assert._increment();if(null!==b)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(c,"Value should be null."),null,b);},isUndefined:function(b,c){YUITest.Assert._increment();if("undefined"!=typeof b)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(c,"Value should be undefined."),void 0,b);},isArray:function(b,c){YUITest.Assert._increment();var e=!1;if(e=Array.isArray?!Array.isArray(b):"[object Array]"!=
Object.prototype.toString.call(b))throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Value should be an array."),b);},isBoolean:function(b,c){YUITest.Assert._increment();if("boolean"!=typeof b)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Value should be a Boolean."),b);},isFunction:function(b,c){YUITest.Assert._increment();if(!(b instanceof Function))throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Value should be a function."),b);},isInstanceOf:function(b,
c,e){YUITest.Assert._increment();if(!(c instanceof b))throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Value isn't an instance of expected type."),b,c);},isNumber:function(b,c){YUITest.Assert._increment();if("number"!=typeof b)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Value should be a number."),b);},isObject:function(b,c){YUITest.Assert._increment();if(!b||"object"!=typeof b&&"function"!=typeof b)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,
"Value should be an object."),b);},isString:function(b,c){YUITest.Assert._increment();if("string"!=typeof b)throw new YUITest.UnexpectedValue(YUITest.Assert._formatMessage(c,"Value should be a string."),b);},isTypeOf:function(b,c,e){YUITest.Assert._increment();if(typeof c!=b)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Value should be of type "+b+"."),b,typeof c);},throwsError:function(b,c,e){YUITest.Assert._increment();var d=!1;try{c()}catch(f){if("string"==typeof b)f.message!=
b&&(d=!0);else if("function"==typeof b)f instanceof b||(d=!0);else if("object"==typeof b&&null!==b){if(!(f instanceof b.constructor)||f.message!=b.message)d=!0}else d=!0;if(d)throw new YUITest.UnexpectedError(f);return}throw new YUITest.AssertionError(YUITest.Assert._formatMessage(e,"Error should have been thrown."));}},YUITest.AssertionError=function(b){this.message=b;this.name="Assert Error"},YUITest.AssertionError.prototype={constructor:YUITest.AssertionError,getMessage:function(){return this.message},
toString:function(){return this.name+": "+this.getMessage()}},YUITest.ComparisonFailure=function(b,c,e){YUITest.AssertionError.call(this,b);this.expected=c;this.actual=e;this.name="ComparisonFailure"},YUITest.ComparisonFailure.prototype=new YUITest.AssertionError,YUITest.ComparisonFailure.prototype.constructor=YUITest.ComparisonFailure,YUITest.ComparisonFailure.prototype.getMessage=function(){return this.message+"\nExpected: "+this.expected+" ("+typeof this.expected+")\nActual: "+this.actual+" ("+
typeof this.actual+")"},YUITest.CoverageFormat={JSON:function(b){return YUITest.Util.JSON.stringify(b)},XdebugJSON:function(b){for(var c in b)b.hasOwnProperty(c);return YUITest.Util.JSON.stringify(b)}},YUITest.DateAssert={datesAreEqual:function(b,c,e){YUITest.Assert._increment();if(b instanceof Date&&c instanceof Date){var d="";b.getFullYear()!=c.getFullYear()&&(d="Years should be equal.");b.getMonth()!=c.getMonth()&&(d="Months should be equal.");b.getDate()!=c.getDate()&&(d="Days of month should be equal.");
if(d.length)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,d),b,c);}else throw new TypeError("YUITest.DateAssert.datesAreEqual(): Expected and actual values must be Date objects.");},timesAreEqual:function(b,c,e){YUITest.Assert._increment();if(b instanceof Date&&c instanceof Date){var d="";b.getHours()!=c.getHours()&&(d="Hours should be equal.");b.getMinutes()!=c.getMinutes()&&(d="Minutes should be equal.");b.getSeconds()!=c.getSeconds()&&(d="Seconds should be equal.");if(d.length)throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,
d),b,c);}else throw new TypeError("YUITest.DateAssert.timesAreEqual(): Expected and actual values must be Date objects.");}},YUITest.Mock=function(b){b=b||{};var c,e;try{var d=function(){};d.prototype=b;c=new d}catch(f){c={}}for(e in b)b.hasOwnProperty(e)&&"function"==typeof b[e]&&(c[e]=function(b){return function(){YUITest.Assert.fail("Method "+b+"() was called but was not expected to be.")}}(e));return c},YUITest.Mock.expect=function(b,c){b.__expectations||(b.__expectations={});if(c.method){var e=
c.method,d=c.args||[],f=c.returns,g="number"==typeof c.callCount?c.callCount:1,s=c.error,t=c.run||function(){},u,v;b.__expectations[e]=c;c.callCount=g;for(v=c.actualCallCount=0;v<d.length;v++)d[v]instanceof YUITest.Mock.Value||(d[v]=YUITest.Mock.Value(YUITest.Assert.areSame,[d[v]],"Argument "+v+" of "+e+"() is incorrect."));b[e]=0<g?function(){try{c.actualCallCount++;YUITest.Assert.areEqual(d.length,arguments.length,"Method "+e+"() passed incorrect number of arguments.");for(var b=0,g=d.length;b<
g;b++)d[b].verify(arguments[b]);u=t.apply(this,arguments);if(s)throw s;}catch(h){YUITest.TestRunner._handleError(h)}return c.hasOwnProperty("returns")?f:u}:function(){try{YUITest.Assert.fail("Method "+e+"() should not have been called.")}catch(b){YUITest.TestRunner._handleError(b)}}}else c.property&&(b.__expectations[c.property]=c)},YUITest.Mock.verify=function(b){try{for(var c in b.__expectations)if(b.__expectations.hasOwnProperty(c)){var e=b.__expectations[c];e.method?YUITest.Assert.areEqual(e.callCount,
e.actualCallCount,"Method "+e.method+"() wasn't called the expected number of times."):e.property&&YUITest.Assert.areEqual(e.value,b[e.property],"Property "+e.property+" wasn't set to the correct value.")}}catch(d){YUITest.TestRunner._handleError(d)}},YUITest.Mock.Value=function(b,c,e){if(this instanceof YUITest.Mock.Value)this.verify=function(d){var f=[].concat(c||[]);f.push(d);f.push(e);b.apply(null,f)};else return new YUITest.Mock.Value(b,c,e)},YUITest.Mock.Value.Any=YUITest.Mock.Value(function(){}),
YUITest.Mock.Value.Boolean=YUITest.Mock.Value(YUITest.Assert.isBoolean),YUITest.Mock.Value.Number=YUITest.Mock.Value(YUITest.Assert.isNumber),YUITest.Mock.Value.String=YUITest.Mock.Value(YUITest.Assert.isString),YUITest.Mock.Value.Object=YUITest.Mock.Value(YUITest.Assert.isObject),YUITest.Mock.Value.Function=YUITest.Mock.Value(YUITest.Assert.isFunction),YUITest.ObjectAssert={areEqual:function(b,c,e){YUITest.Assert._increment();var d=YUITest.Object.keys(b),f=YUITest.Object.keys(c);d.length!=f.length&&
YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Object should have "+d.length+" keys but has "+f.length));for(var g in b)if(b.hasOwnProperty(g)&&b[g]!=c[g])throw new YUITest.ComparisonFailure(YUITest.Assert._formatMessage(e,"Values should be equal for property "+g),b[g],c[g]);},hasKey:function(b,c,e){YUITest.ObjectAssert.ownsOrInheritsKey(b,c,e)},hasKeys:function(b,c,e){YUITest.ObjectAssert.ownsOrInheritsKeys(b,c,e)},inheritsKey:function(b,c,e){YUITest.Assert._increment();(!(b in c)||c.hasOwnProperty(b))&&
YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Property '"+b+"' not found on object instance."))},inheritsKeys:function(b,c,e){YUITest.Assert._increment();for(var d=0;d<b.length;d++)(!(propertyName in c)||c.hasOwnProperty(b[d]))&&YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Property '"+b[d]+"' not found on object instance."))},ownsKey:function(b,c,e){YUITest.Assert._increment();c.hasOwnProperty(b)||YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Property '"+b+"' not found on object instance."))},
ownsKeys:function(b,c,e){YUITest.Assert._increment();for(var d=0;d<b.length;d++)c.hasOwnProperty(b[d])||YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Property '"+b[d]+"' not found on object instance."))},ownsNoKeys:function(b,c){YUITest.Assert._increment();var e=YUITest.Object.keys(b).length;0!==e&&YUITest.Assert.fail(YUITest.Assert._formatMessage(c,"Object owns "+e+" properties but should own none."))},ownsOrInheritsKey:function(b,c,e){YUITest.Assert._increment();b in c||YUITest.Assert.fail(YUITest.Assert._formatMessage(e,
"Property '"+b+"' not found on object."))},ownsOrInheritsKeys:function(b,c,e){YUITest.Assert._increment();for(var d=0;d<b.length;d++)b[d]in c||YUITest.Assert.fail(YUITest.Assert._formatMessage(e,"Property '"+b[d]+"' not found on object."))}},YUITest.Results=function(b){this.name=b;this.duration=this.total=this.ignored=this.errors=this.failed=this.passed=0},YUITest.Results.prototype.include=function(b){this.passed+=b.passed;this.failed+=b.failed;this.ignored+=b.ignored;this.total+=b.total;this.errors+=
b.errors},YUITest.ShouldError=function(b){YUITest.AssertionError.call(this,b||"This test should have thrown an error but didn't.");this.name="ShouldError"},YUITest.ShouldError.prototype=new YUITest.AssertionError,YUITest.ShouldError.prototype.constructor=YUITest.ShouldError,YUITest.ShouldFail=function(b){YUITest.AssertionError.call(this,b||"This test should fail but didn't.");this.name="ShouldFail"},YUITest.ShouldFail.prototype=new YUITest.AssertionError,YUITest.ShouldFail.prototype.constructor=YUITest.ShouldFail,
YUITest.UnexpectedError=function(b){YUITest.AssertionError.call(this,"Unexpected error: "+b.message);this.cause=b;this.name="UnexpectedError";this.stack=b.stack},YUITest.UnexpectedError.prototype=new YUITest.AssertionError,YUITest.UnexpectedError.prototype.constructor=YUITest.UnexpectedError,YUITest.UnexpectedValue=function(b,c){YUITest.AssertionError.call(this,b);this.unexpected=c;this.name="UnexpectedValue"},YUITest.UnexpectedValue.prototype=new YUITest.AssertionError,YUITest.UnexpectedValue.prototype.constructor=
YUITest.UnexpectedValue,YUITest.UnexpectedValue.prototype.getMessage=function(){return this.message+"\nUnexpected: "+this.unexpected+" ("+typeof this.unexpected+") "},YUITest.Wait=function(b,c){this.segment="function"==typeof b?b:null;this.delay="number"==typeof c?c:0},b.Test=YUITest,b.Object.each(YUITest,function(c,e){e=e.replace("Test","");b.Test[e]=c}));b.Assert=YUITest.Assert;b.Assert.Error=b.Test.AssertionError;b.Assert.ComparisonFailure=b.Test.ComparisonFailure;b.Assert.UnexpectedValue=b.Test.UnexpectedValue;
b.Mock=b.Test.Mock;b.ObjectAssert=b.Test.ObjectAssert;b.ArrayAssert=b.Test.ArrayAssert;b.DateAssert=b.Test.DateAssert;b.Test.ResultsFormat=b.Test.TestFormat;var c=b.Test.ArrayAssert.itemsAreEqual;b.Test.ArrayAssert.itemsAreEqual=function(e,d,f){return c.call(this,b.Array(e),b.Array(d),f)};b.assert=function(c,e){b.Assert._increment();if(!c)throw new b.Assert.Error(b.Assert._formatMessage(e,"Assertion failed."));};b.fail=b.Assert.fail;b.Test.Runner.once=b.Test.Runner.subscribe;b.Test.Runner.disableLogging=
function(){b.Test.Runner._log=!1};b.Test.Runner.enableLogging=function(){b.Test.Runner._log=!0};b.Test.Runner._ignoreEmpty=!0;b.Test.Runner._log=!0;b.Test.Runner.on=b.Test.Runner.attach;if(!YUI.YUITest){b.config.win&&(b.config.win.YUITest=YUITest);YUI.YUITest=b.Test;var e=function(c){var e="",d="";switch(c.type){case this.BEGIN_EVENT:e="Testing began at "+(new Date).toString()+".";d="info";break;case this.COMPLETE_EVENT:e=b.Lang.sub("Testing completed at "+(new Date).toString()+".\nPassed:{passed} Failed:{failed} Total:{total} ({ignored} ignored)",
c.results);d="info";break;case this.TEST_FAIL_EVENT:e=c.testName+": failed.\n"+c.error.getMessage();d="fail";break;case this.TEST_IGNORE_EVENT:e=c.testName+": ignored.";d="ignore";break;case this.TEST_PASS_EVENT:e=c.testName+": passed.";d="pass";break;case this.TEST_SUITE_BEGIN_EVENT:e='Test suite "'+c.testSuite.name+'" started.';d="info";break;case this.TEST_SUITE_COMPLETE_EVENT:e=b.Lang.sub('Test suite "'+c.testSuite.name+'" completed.\nPassed:{passed} Failed:{failed} Total:{total} ({ignored} ignored)',
c.results);d="info";break;case this.TEST_CASE_BEGIN_EVENT:e='Test case "'+c.testCase.name+'" started.';d="info";break;case this.TEST_CASE_COMPLETE_EVENT:e=b.Lang.sub('Test case "'+c.testCase.name+'" completed.\nPassed:{passed} Failed:{failed} Total:{total} ({ignored} ignored)',c.results);d="info";break;default:e="Unexpected event "+c.type,d="info"}b.Test.Runner._log&&b.log(e,d,"TestRunner")},f,g;for(f in b.Test.Runner)g=b.Test.Runner[f],-1<f.indexOf("_EVENT")&&b.Test.Runner.subscribe(g,e)}},"3.17.2",
{requires:["event-simulate","event-custom","json-stringify"]});
YUI.add("squarespace-editor-google-apps-user",function(b){b.namespace("Squarespace.Editor.GoogleApps");var d=b.Squarespace.Editor.GoogleApps.User=b.Base.create("googleAppsUserEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(c){if(!b.Lang.isString(c.model.get("domain")))throw"Cannot edit / create google apps user without specifying a domain.";},validateFields:function(){var b=d.superclass.validateFields.call(this),e=this.get("model").get("domain");this.get("dialog").getField("email").get("data").endsWith(e)||
(b=b||{},b.email="Email address must end with @"+e);return b},_showDialog:function(){d.superclass._showDialog.call(this);this.get("dialog").updateAutoSave("You will be charged an additional $5 per month for a new user.")}},{ATTRS:{model:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.GoogleAppsUser)},dialogConfig:{valueFn:function(){return{name:"googleAppsUser",closeOthers:!1,overlay:0.5,style:"flyout",width:600,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",
title:"Create Account"}],tabs:[{title:"Create New Email Account",icon:"/universal/images-v6/icons/icon-domains-18-light.png",fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{className:"description",content:'<div class="description-label">Account Details</div>Enter the details of the account you\'d like to create.'}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{width:0.5,name:"firstName","strings.placeholder":"First Name",required:!0,submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Text,
config:{width:0.5,name:"lastName","strings.placeholder":"Last Name",required:!0,submitOnEnter:!0}}]},{ctor:b.Squarespace.DialogFields.SuffixText,config:{name:"email",required:!0,selectable:!1,affixes:["@"+this.get("model").get("domain")]}},{ctor:b.Squarespace.DialogFields.HTML,className:"description",config:{content:'<div class="description-label">Invitation</div>Enter the current email address of the user you\'re creating this account for. They receive a temporary password via email.'}},{ctor:b.Squarespace.DialogFields.Text,
config:{name:"welcomeEmailRecipient","strings.placeholder":"recipient@example.com",required:!0,submitOnEnter:!0}}]}]}}}}})},"1.0",{requires:"base squarespace-model-editor squarespace-attr-validators squarespace-dialog-text squarespace-dialog-suffix-text squarespace-models-google-apps-user".split(" ")});
YUI.add("squarespace-oembed-resolvers",function(b){b.namespace("Squarespace");b.Squarespace.EmbedResolver=b.Base.create("embedResolver",b.Base,[],{canProcess:function(d,c){var e=RegExp(this.get("pattern"),"g");return d.match(e)&&(!b.Lang.isValue(c)||c===this.get("type"))},getProvider:function(){return this.get("serviceName").toLowerCase()},process:function(d,c,e){b.jsonp(this.get("serviceUrl")+"&url="+encodeURIComponent(d),{on:{success:b.bind(function(b,d){b=this._sanitizeResolvedData(b,d);c.onSuccess.apply(e,
arguments)},this),failure:c.onFailure,timeout:c.onTimeout},args:[d],timeout:5E3,context:e})},_sanitizeResolvedData:function(d,c){var e=this.getProvider();if("instagram"===e)"Instagram"===d.title&&(d.title=null),d["instagram-url"]=d.thumbnail_url;else if(!d.html)return null;this._camelCaseDataKeys(d);return b.merge(d,{url:c,html:this._getCleanedHTML(d,c),resolveObject:this.get("objectName"),resolvedBy:e,resolved:!0})},_camelCaseDataKeys:function(d){b.Array.each(["author_name","author_url","provider_name",
"provider_url","thumbnail_url"],function(c){var e=d[c];e&&(d[b.Squarespace.StringUtils.toCamelCase(c)]=e,delete d[c])})},_getCleanedHTML:function(d,c){var e=this.getProvider();if("instagram"===e)return b.Squarespace.UITemplates.render("instagram-oembed.html",d);if("youtube"===e){var e=(c.match(/^.*(?:youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/)||["",""])[1],f=c.split("?")[1]||"";f&&(f="?"+this._resolveYouTubeParams(f));e&&(d.html=b.Squarespace.UITemplates.render("youtube-oembed.html",
{data:d,src:"//www.youtube.com/embed/"+e+f}))}else"animoto"===e&&(d.html=d.html.replace(/\ssrc=["|'](.*)["|']/,function(b,c){var e=(c.match(/[?|&]r=(\d+p)/)||["",""])[1];return e&&0>c.search(/[?|&]start_res=/)?' src="'+c+"&start_res="+e+'"':b}));return this._augmentEmbed(d.html.trim())},_augmentEmbed:function(d){d=b.Node.create("<div>"+d+"</div>");var c="";d.all("iframe").each(this._augmentIframeEmbed,this);d.all("object").each(this._augmentObjectEmbed,this);c=d.get("innerHTML");d.destroy();return c},
_augmentIframeEmbed:function(d){var c=d.getAttribute("src"),e=c.match(/^[^\?&#]+/)[0],f=(c.match(/#[^\?&]+$/)||[""])[0],c=(c.match(/\?[^#]+/)||[""])[0].split(/[\?|&]/),c=b.Array.filter(c,function(b){return b&&0>b.search(/^wmode=/)});c.push("wmode=opaque");switch(this.getProvider()){case "vimeo":c.push("api=1");break;case "youtube":c.push("enablejsapi=1")}c=e+"?"+c.join("&")+f;d.setAttribute("src",c)},_augmentObjectEmbed:function(d){d.all("embed").each(function(b){b.setAttribute("wmode","opaque")});
d.all("param").each(function(b){"wmode"===b.getAttribute("name")&&b.remove(!0)});d.prepend(b.Node.create('<param name="wmode" value="opaque"/>'))},_resolveYouTubeParams:function(d){d=d.replace(/(^|\&)(?:v=)(?:[^#\&]*)(\&|$)/,function(b,e,d){return e&&d?"&":""});return d=d.replace(/(^|\&)(?:t=)([^#\&]*)/g,function(c,e,d){e=e||"";var g=0;d=d.match(/\d+\D/g);b.Array.each(d,function(b){var c=b.slice(-1);b=parseInt(b,10);switch(c){case "h":g+=3600*b;break;case "m":g+=60*b;break;case "s":g+=b;break;default:console.warn("[embedResolver] parameter `t` contains unknown character")}});
return!b.Lang.isNumber(g)||0===g?c:e+="start="+g})}},{ATTRS:{type:{},serviceName:{value:""},pattern:{value:""},serviceUrl:{value:""},objectName:{value:""}}});b.Squarespace.oEmbedResolvers={twitter:new b.Squarespace.EmbedResolver({serviceName:"Twitter",pattern:"^https?://twitter.com[^ ]*$",serviceUrl:"https://api.twitter.com/1/statuses/oembed.json?callback={callback}",objectName:"Tweet"}),vimeo:new b.Squarespace.EmbedResolver({serviceName:"Vimeo",pattern:"^https?://(?:www\\.)?vimeo.com/",serviceUrl:"https://vimeo.com/api/oembed.json?callback={callback}",
objectName:"Video",type:"video"}),wistia:new b.Squarespace.EmbedResolver({serviceName:"Wistia",pattern:"https?://(.+)?(wistia.com|wi.st)/(medias|embed)/.*",serviceUrl:"https://fast.wistia.com/oembed?callback={callback}",objectName:"Video",type:"video"}),animoto:new b.Squarespace.EmbedResolver({serviceName:"Animoto",pattern:"^https?://(?:www\\.)?animoto.com/play/",serviceUrl:"https://animoto.com/oembeds/create?format=json&ssl=true&callback={callback}",objectName:"Video",type:"video"}),flickr:new b.Squarespace.EmbedResolver({serviceName:"Flickr",
pattern:"^https?://[a-zA-Z\\.]*flickr.com/[^ ]*$",serviceUrl:"https://www.flickr.com/services/oembed?format=json&jsoncallback={callback}",objectName:"Picture"}),instagram:new b.Squarespace.EmbedResolver({serviceName:"Instagram",pattern:"^https?://[a-zA-Z\\.]*instagram.com/p[^ ]*$",serviceUrl:"https://api.embed.ly/1/oembed?format=json&callback={callback}",objectName:"Picture"}),youtube:new b.Squarespace.EmbedResolver({serviceName:"Youtube",pattern:"^https?://[a-zA-Z\\.]*((?:youtube.com/watch)|(?:.be/))[^ ]*$",
serviceUrl:"https://api.embed.ly/1/oembed?format=json&callback={callback}",objectName:"Video",type:"video"}),wikipedia:new b.Squarespace.EmbedResolver({serviceName:"Wikipedia",pattern:"^https?://en.wikipedia.org/wiki/[^ ]*$",serviceUrl:"https://api.embed.ly/1/oembed?format=json&callback={callback}",objectName:"Article"}),slideshare:new b.Squarespace.EmbedResolver({serviceName:"SlideShare",pattern:"^https?://www.slideshare.net[^ ]*$",serviceUrl:"https://www.slideshare.net/api/oembed/2?format=json&callback={callback}",
objectName:"Presentation"}),soundcloud:new b.Squarespace.EmbedResolver({serviceName:"Soundcloud",pattern:"^https?://soundcloud.com[^ ]*$",serviceUrl:"https://soundcloud.com/oembed?format=js&callback={callback}",objectName:"Audio"})}},"1.0",{requires:["base","squarespace-ui-templates","squarespace-flickr-oembed-template","squarespace-instagram-oembed-template","squarespace-youtube-oembed-template"]});
YUI.add("squarespace-block-summary-gallery-model",function(b){b.namespace("Squarespace.ContentModel").SummaryGalleryBlock=b.Base.create("summaryGalleryBlock",b.Squarespace.ContentModel.GalleryBlock,[],{},{})},"1.0",{requires:["base","model","squarespace-enum","squarespace-block-gallery-model"]});
YUI.add("squarespace-widgets-google-apps-active-subscription",function(b){b.namespace("Squarespace.Widgets.GoogleApps");var d=b.Squarespace.GoogleAppsPlanType,c=b.Squarespace.DialogFields.StateIndicatorBanner.STATES;b.Squarespace.Widgets.GoogleApps.ActiveSubscription=b.Base.create("GoogleAppsActiveSubscription",b.Squarespace.Widgets.GoogleApps.BaseSubscription,[],{_isTrial:function(){var b=this.get("model");return b&&b.get("plan.type")===d.TRIAL},_getBannerConfig:function(){if(this._isTrial()){var e=
this.get("model"),e=new Date(e.get("plan.endDate")),e=b.DataType.Date.format(e,{format:"%B %e, %Y"});return{name:"subscriptionState",data:d.TRIAL,stateDisplays:[{value:d.TRIAL,state:c.WARN,message:"Your Google Apps trial will end on "+e+"."}]}}return null}},{CSS_PREFIX:"sqs-google-apps-active-subscription",ATTRS:{stateBannerConfig:{getter:"_getBannerConfig"}}})},"1.0",{requires:["base","datatype-date-format","squarespace-widgets-google-apps-base-subscription","squarespace-dialog-state-indicator-banner"]});
YUI.add("squarespace-shipping-rule-list",function(b){b.namespace("Squarespace.DialogFields").ShippingRuleList=b.Base.create("ShippingRuleList",b.Squarespace.DialogField2,[],{renderUI:function(){this.html=b.Node.create('<div class="shipping-rule-list"></div>');this.html.append('<div class="list-summary regionsServed"></div>');this.html.appendChild('<div class="list-body"></div>').append('<div class="loading-text">Loading options&hellip;</div>');this.html.on("click",this.onClick,this);this.html.delegate("click",
b.bind(function(b){b=b.currentTarget.getData();this.addEditOption(b)},this),".rule");this.get("contentBox").append(this.html);this._customRender(this.get("data"))},_customRender:function(d){this.html.one(".list-body").empty();this.data=d;if(void 0===d.shippingOptions||0===d.shippingOptions.length)this.html.one(".list-summary").setContent(""),this.showNoOptionsAlert();else{var c={},e=!1;d.shippingOptions.forEach(b.bind(function(d){var g=this._getShipsToString(d);b.Array.each(d.countries,function(b){c[b]=
!0});!0===d.availableEverywhere&&(e=!0);if(d.rateType==b.Squarespace.ShippingRateTypes.WEIGHT_RANGE)g=b.Node.create('<div class="rule"></div>').append('<div class="name">'+d.name+"</div>").append('<div class="description">Weight Ranges</div>').append('<div class="description shipsTo">'+g+"</div>").append('<div class="remove"></div>');else if(d.rateType==b.Squarespace.ShippingRateTypes.AMOUNT_RANGE)g=b.Node.create('<div class="rule"></div>').append('<div class="name">'+d.name+"</div>").append('<div class="description">Order Amount Ranges</div>').append('<div class="description shipsTo">'+
g+"</div>").append('<div class="remove"></div>');else if(d.rateType==b.Squarespace.ShippingRateTypes.PERCENTAGE)g=b.Node.create('<div class="rule"></div>').append('<div class="name">'+d.name+"</div>").append('<div class="description">Percentage Rate: '+d.percentage+"% of order subtotal</div>").append('<div class="description shipsTo">'+g+"</div>").append('<div class="remove"></div>');else if(d.rateType==b.Squarespace.ShippingRateTypes.USPS)g=b.Node.create('<div class="rule"></div>').append('<div class="name">'+
d.name+"</div>").append('<div class="description">Calculated by USPS (with '+d.markupPercent+"% markup)</div>").append('<div class="description shipsTo">'+g+"</div>").append('<div class="remove"></div>');else if(d.rateType==b.Squarespace.ShippingRateTypes.FLAT)var h=b.Squarespace.Commerce.moneyString(d.perOrderFeeCents)+" per order + "+b.Squarespace.Commerce.moneyString(d.perItemFeeCents)+" per item",g=b.Node.create('<div class="rule"></div>').append('<div class="name">'+d.name+"</div>").append('<div class="description">Flat Rate: '+
h+"</div>").append('<div class="description shipsTo">'+g+"</div>").append('<div class="remove"></div>');else throw"Unsupported shipping rule rateType";g.setData(d);this.html.one(".list-body").append(g)},this));d=b.Object.keys(c);e?this.html.one(".list-summary").setContent("Your store is prepared to sell to customers <b>everywhere in the world</b>."):0<d.length?this.html.one(".list-summary").setContent("Your store is prepared to sell to customers in: <b>"+d.join(", ")+"</b>"):this.html.one(".list-summary").setContent("");
this.fire("rulesChanged")}},_getShipsToString:function(b){return!0===b.availableEverywhere?"Ships to the rest of the world.":3<b.countries.length?"Ships to: "+b.countries.slice(0,3).join(", ")+" and "+(b.countries.length-3)+" other countries":"Ships to: "+b.countries.join(", ")},updateRules:function(b){this._customRender(b)},showNoOptionsAlert:function(){noOptions=b.Node.create('<div class="no-options"><img class="icon large" src="/universal/images-v6/configuration/no-shipping.png" /><div class="empty-text">You have not created any shipping options yet. Customers will not be able to purchase physical goods.</div>');
this.html.one(".list-body").append(noOptions)},getCountryTags:function(){var d=[],c;for(c in b.Squarespace.Localities.COUNTRY_OPTIONS)b.Squarespace.Localities.COUNTRY_OPTIONS[c].empty||d.push(b.Squarespace.Localities.COUNTRY_OPTIONS[c].title);return d},showShippingTypeChooser:function(){var d;d=new b.Squarespace.DialogFlow({fieldName:"rateType",title:"Add Shipping Option",description:"Shipping Options may be calculated by a variety of methods. Choose how you would like your option's costs to be calculated.",
options:[{value:b.Squarespace.ShippingRateTypes.FLAT,title:"Flat Rate",description:"Define a charge for every order and a flat fee for each item.",icon:"shipping-flat"},{value:b.Squarespace.ShippingRateTypes.WEIGHT_RANGE,title:"Depending on Weight",description:"Let the cost depend on the total weight of the purchase.",icon:"shipping-weight"},{value:b.Squarespace.ShippingRateTypes.USPS,title:"Carrier Calculated via USPS",description:"Approximates an efficient packing using the containers available. Request a real-time rate from the USPS using weight, size, and distance.",
icon:"shipping-carrier",upgradeLocked:!Static.SQUARESPACE_CONTEXT.website.canUseAdvancedCommerce,upgradeConfirmCb:function(){d.close();CONFIG_PANEL.goToUpgrade()}}],nextDialogGenerator:b.bind(this.getAddEditOptionDialog,this)});d.showPrescreen({countries:["United States"]})},getAddEditOptionDialog:function(d){var c=[{type:"cancel",title:"Cancel"}];void 0!==d.id&&c.push({type:"remove",title:"Remove"});c.push({type:"saveAndClose",title:"Save"});var e;this._ruleEditDialog=e=new b.Squarespace.EditingDialog({name:"addEditRule",
style:"flyout",savingText:"Saving Shipping Option...",initialData:d,overlay:0.5,width:450,height:300,closeOthers:!1,discardChangesConfirmation:!0,buttons:c,primaryTabs:this.getPrimaryTabsForRateType(d.rateType),secondaryTabs:this.getSecondaryTabs(d)});this._registerEvent(e.on("send-requested",function(){var c=e.getData();c.customContainers=b.JSON.stringify(c.customContainers);b.Data.post({url:"/api/commerce/admin/SaveShippingOption",data:c,success:function(b){e.close();this.updateRules(b)},failure:function(c){b.Object.each(c.errors,
function(b,c){var d={};d[c]=b;e.showErrors(d)},this);e.allowEditing()}},this)},this));this._registerEvent(e.on("remove-requested",function(){b.Data.sendForm(e,{url:"/api/commerce/admin/RemoveShippingOption",success:function(b){e.close();this.updateRules(b)}},this)},this));this._registerEvent(e.on("datachange",function(b){if("availableEverywhere"==b.getName()){var c=e.getField("countries");!0===b.getValue()?c.temporaryHide():c.temporaryShow()}},this));e.after("shown",function(){d.availableEverywhere&&
e.getField("countries").temporaryHide()},this);d.rateType==b.Squarespace.ShippingRateTypes.USPS&&e.after("shown",function(){var b=e.getField("serviceType"),c=e.getField("customContainers");c.set("serviceType",b.get("data"));b.after("dataChange",function(){c.set("serviceType",b.get("data"))})});return e},addEditOption:function(b){void 0===b&&(b={countries:["United States"]});this.getAddEditOptionDialog(b).show()},getSecondaryTabs:function(d){if(d.rateType!=b.Squarespace.ShippingRateTypes.USPS)return[{tabTitle:"Country Restrictions",
scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Control Where this Option Is Available",text:"You can charge different rates for different countries. Let this shipping option only appear to customers in countries of your choosing, or to all other countries."}},{ctor:b.Squarespace.DialogFields.Check,name:"availableEverywhere","strings.title":"Ship To The Rest of the World","strings.description":"Make this shipping method available to the rest of world, wherever your other methods do not allow."},
{ctor:b.Squarespace.DialogFields.Stringset,config:{mode:"input",allowOnlyExistingMembers:!0,name:"countries",title:"Countries Allowed",style:"minor",addText:"Click to add countries.",emptyText:"No countries added.",memberClass:"tag",editorLabel:"Add Countries",description:"Only countries listed will be served by this shipping method.",existingMembers:this.getCountryTags()}}]}]},getPrimaryTabsForRateType:function(b){return this.getTabForRateType(b)},getTabForRateType:function(d){var c={ctor:b.Squarespace.DialogFields.Text,
config:{name:"name",className:"thin",maxLength:100,"strings.title":"Option Name","strings.description":'e.g. "Fedex Next Day", "USPS Express Mail"',required:!0}};if(d==b.Squarespace.ShippingRateTypes.FLAT)return[{title:"Edit Flat Rate",tabTitle:"Formula",icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[c,{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.MoneyText,config:{name:"perOrderFeeCents",width:0.5,required:!0,"strings.title":"Per Order Fee","strings.description":"A base fee for every order placed"}},
{ctor:b.Squarespace.DialogFields.MoneyText,config:{name:"perItemFeeCents",width:0.5,required:!0,"strings.title":"Fee Per Item","strings.description":"An additional fee for each physical item in the order"}}]},{type:"hidden",name:"rateType"}]}];if(d==b.Squarespace.ShippingRateTypes.WEIGHT_RANGE)return[{title:"Weight Range Rate",tabTitle:"Formula",icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",scroll:!0,fields:[c,{ctor:b.Squarespace.DialogFields.RangeTable,name:"ranges",title:"Weight Ranges",
description:"Depending on the total item weight, you can charge different amounts for shipping."},{type:"hidden",name:"rateType"}]}];if(d==b.Squarespace.ShippingRateTypes.USPS)return d=[],d.push({value:b.Squarespace.USPSServiceTypes.PRIORITY,label:"USPS Priority Mail  (1 to 3 days)"}),d.push({value:b.Squarespace.USPSServiceTypes.EXPRESS,label:"USPS Priority Mail Express  (Overnight)"}),d.push({value:b.Squarespace.USPSServiceTypes.STANDARD,label:"USPS Standard Post  (2 to 8 days)"}),[{title:"Carrier Calculated Rate",
tabTitle:"Formula",icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.Select,config:{className:"thin dark",name:"serviceType","strings.title":"Service Type","strings.description":"One of the shipping options supported by USPS",options:d,defaultValue:b.Squarespace.USPSServiceTypes.PRIORITY}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"markupPercent",className:"thin","strings.title":"Markup (+%)","strings.description":"Add a percentage markup to the shipping costs estimated by USPS.",
width:0.5}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"zipOrigination",width:0.5,className:"thin","strings.title":"Ship from Zip Code","strings.description":"The Zip Code where you will be shipping from."}}]},{type:"hidden",name:"rateType"}]},{title:"Containers",tabTitle:"Containers",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Containers",text:"Squarespace will estimate shipping costs by attempting to pack the items in your customers' shopping carts into as few packages as possible and using the smallest containers it can fit the items into. You may define your available box sizes here. Flat Rate boxes offered by the carrier are available by default."}},
{ctor:b.Squarespace.DialogFields.ShippingContainerTable,config:{name:"customContainers",measurementStandard:Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.measurementStandard}}]}];throw"Shipping Rate Type not supported: "+d;}},{CSS_PREFIX:"sqs-shipping-rule-list",ATTRS:{readOnly:{value:!0}}})});
YUI.add("squarespace-wistia-player",function(b){var d=b.QueryString.stringify({fullscreenButton:!1,smallPlayButton:!1,chromeless:!0,volumeControl:!1,playButton:!1,playerColor:"000000",version:"v1"});b.namespace("Squarespace.Widgets").WistiaPlayer=b.Base.create("wistiaPlayer",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this._loadWistiaApi()},destructor:function(){b.Array.each([this._seekSlider,this._volumeSlider],function(b){b&&b.destroy()})},renderUI:function(){this.get("boundingBox").addClass(this.get("className"))},
bindUI:function(){b.Squarespace.Widgets.WistiaPlayer.superclass.bindUI.call(this);this.get("boundingBox").on("click",function(b){b.halt()});this.after("loadedChange",this.syncUI,this);this.after("videoChange",function(){this.set("time",0);this.syncUI()},this);this.after("timeChange",function(){this.seek(this.get("time"))},this);this.after("volumeChange",function(){this._setPlayerVolume(this.get("volume"))});this.after("fullscreenChange",function(){this._toggleFullscreenClass();this.get("fullscreen")?
(this._initialFitToScreen(),this._bindResize()):(this._unfitFromScreen(),this._unbindResize())});this.after("playingChange",function(){this.get("boundingBox").toggleClass("playing");this.get("playing")?this._playVideo():this._pauseVideo()},this);var c=this.get("contentBox");c.delegate("click",this._toggleFullscreen,".fullscreen",this);c.delegate("click",this._togglePlayState,".play-button-bg, .play-triangle",this);c.delegate("click",function(b){b.halt();this.play()},".play-overlay",this);c.delegate("mouseenter",
function(){c.addClass("controls-visible")},".controls");c.delegate("mouseleave",function(){c.removeClass("controls-visible")},".controls");this.after("widthChange",function(){this._withWistiaHandle(function(b){this.get("contentBox").one("iframe").setAttribute("width",this.get("width"))},this)});this.after("heightChange",function(){this._withWistiaHandle(function(b){this.get("contentBox").one("iframe").setAttribute("height",this.get("height"))},this)})},syncUI:function(){b.Squarespace.Widgets.WistiaPlayer.superclass.syncUI.call(this);
this._volumeSlider&&(this._volumeSlider.destroy(),this._volumeSlider=null);this._seekSlider&&(this._seekSlider.destroy(),this._seekSlider=null);this.get("contentBox").empty().prepend(this.renderTemplate());this._initializeVolumeSlider();this._initializeSeekSlider();this._bindWistiaEvents();this.get("playing")&&this._withWistiaHandle(function(b){b.play()})},_toggleFullscreen:function(){this.set("fullscreen",!this.get("fullscreen"))},_toggleFullscreenClass:function(){this.get("boundingBox").toggleClass("fullscreen")},
_initialFitToScreen:function(){this._withWistiaHandle(function(b){this._previousWidth=this.get("width");this._previousHeight=this.get("height");this._fitToScreen(b)},this)},_fitToScreen:function(c){var e=b.one("body");c=e.get("winWidth");e=e.get("winHeight");this.set("height",e);this.set("width",c)},_unfitFromScreen:function(){this._withWistiaHandle(function(b){this.setAttrs({width:this._previousWidth,height:this._previousHeight});this._previousWidth=this._previousHeight=null},this)},_bindResize:function(){this._resizeHandler&&
this._unbindResize();var c=null;this._resizeHandler=b.one(b.config.win).on("resize",function(){c||(c=b.later(300,this,function(){this._withWistiaHandle(function(b){this._fitToScreen(b)},this);c=null}))},this)},_unbindResize:function(){this._resizeHandler&&(this._resizeHandler.detach(),this._resizeHandler=null)},_initializeVolumeSlider:function(){this._volumeSlider=new b.Slider({min:0,max:100,length:36,thumbUrl:"data:,",value:100*this.get("volume")});this._volumeSlider.plug(b.Squarespace.Plugin.SliderFill);
this._volumeSlider.render(this.get("contentBox").one(".volume"));this._bindVolumeSliderEvents(this._volumeSlider)},_initializeSeekSlider:function(){this._seekSlider=new b.Slider({min:0,thumbUrl:"data:,",length:this.get("seekBarLength"),value:this.get("time")});this._seekSlider.plug(b.Squarespace.Plugin.SliderFill);this._seekSlider.plug(b.Squarespace.Plugin.SliderTooltip,{templateFn:function(b){var e=b.value;b=Math.floor(e/60);e%=60;10>e&&(e="0"+e);e=[b,e];(b=Math.floor(b/60))&&e.unshift(b);return e.join(":")}});
this._seekSlider.render(this.get("contentBox").one(".seeker"));this._bindSeekSliderEvents(this._seekSlider);this._withWistiaHandle(function(b){this._seekSlider.set("max",b.duration())},this)},_bindWistiaEvents:function(){this._withWistiaHandle(function(c){c.bind("end",b.bind(function(){this._setNotPlaying();this._removeStartedClass()},this));c.bind("pause",b.bind(this._setNotPlaying,this));c.bind("play",b.bind(this._addStartedClass,this));c.bind("timechange",b.bind(this._updateSeekSlider,this))},
this)},_updateSeekSlider:function(b){this._seeking||this._seekSlider.set("value",Math.floor(b))},_bindSeekSliderEvents:function(c){c.after(["railMouseDown","slideEnd"],function(){var b=this.get("time");this.set("time",c.getValue());var d=this.get("time");this.fire("seek",{from:b,to:d})},this);c.on("slideStart",b.bind(this._beginImmediateSeekTiming,this,c));c.on("slideStart",function(){this._seeking=!0;c.tooltip&&c.tooltip.show()},this);c.on("slideEnd",function(){this._seeking=!1;c.tooltip&&c.tooltip.hide()},
this)},_bindVolumeSliderEvents:function(c){var e=null;c.after("valueChange",function(){var d=b.bind(function(){this.set("volume",c.getValue()/100)},this);e&&e.cancel();e=b.later(300,this,function(){d();e=null})},this)},_beginImmediateSeekTiming:function(c){var e=null,d=c.on("drag:drag",function(c){e&&e.cancel();e=b.later(500,this,function(){this.set("time",this._seekSlider.getValue())})},this);c.on("drag:end",function(){d.detach()})},_removeStartedClass:function(){this.get("boundingBox").removeClass("started")},
_addStartedClass:function(){this.get("boundingBox").addClass("started")},_togglePlayState:function(){this.set("playing",!this.get("playing"))},_setNotPlaying:function(){this.set("playing",!1)},_getHBTemplateContext:function(){var b=this.getAttrs();b.video&&(b.video.embedHTML=this._getWistiaEmbed(b.video.id));return b},_getWistiaEmbed:function(b){var e=this.get("width"),f=this.get("height");return'<iframe id="'+b+'" src="https://fast.wistia.com/embed/iframe/'+b+"?"+d+'" allowTransparency="true" frameborder="0" scrolling="no" class="wistia_embed" name="wistia_embed" width="'+
e+'" height="'+f+'"></iframe>'},_withWistia:function(b,e){if(this._wistiaLoaded)b.call(e);else{var d=this.onceAfter("wistia-loaded",function(){d.detach();b.call(this)},e);this._loadWistiaApi()}},_withWistiaHandle:function(b,e){this._withWistia(function(){window.wistiaBindIframes();var d=this._getWistiaHandle();d&&(d.ready()?b.call(e,d):d.ready(function(){b.call(e,d)}))},e)},_getWistiaHandle:function(){var b=this.get("contentBox").one(".video iframe");return b?b.getDOMNode().wistiaApi:null},_playVideo:function(){this._withWistiaHandle(function(b){b.play()},
this)},_pauseVideo:function(){this._withWistiaHandle(function(b){b.pause()},this)},_setPlayerVolume:function(b){this._withWistiaHandle(function(e){e.volume(b)})},_loadWistiaApi:function(){this._wistiaLoading||(b.Lang.isUndefined(window.wistiaBindIframes)?(this._wistiaLoading=!0,b.Get.script("//fast.wistia.com/static/iframe-api-v1.js",{context:this},function(c){c?console.error("Problem loading the wistia API script"):window.wistiaApi.ready(b.bind(function(){this._wistiaLoading=!1;this.set("loaded",
!0);this.fire("wistia-loaded")},this))})):(this.set("loaded",!0),this.fire("wistia-loaded")))},play:function(){this.get("video")&&this.set("playing",!0)},pause:function(){this.get("video")&&this.set("playing",!1)},seek:function(b){this.get("video")&&this._withWistiaHandle(function(e){e.time(b)})}},{HANDLEBARS_TEMPLATE:"wistia-player.html",CSS_PREFIX:"sqs-wistia-player",ATTRS:{video:{validator:b.Lang.isObject},playing:{value:!1,validator:b.Lang.isBoolean},volume:{validator:function(c){return b.Lang.isNumber(c)&&
1>=c&&0<=c},value:0.5},width:{value:867,validator:b.Lang.isNumber},height:{value:488,validator:b.Lang.isNumber},seekBarLength:{value:680},time:{value:0,validator:b.Lang.isNumber},fullscreen:{value:!1,validator:b.Lang.isBoolean}}})},"1.0",{requires:"squarespace-wistia-player-template squarespace-ss-widget squarespace-plugin-slider-value-tooltip squarespace-plugin-slider-fill slider querystring-stringify yui-throttle datatype-date-format".split(" ")});
YUI.add("squarespace-tax-rule-view",function(b){b.namespace("Squarespace");b.Squarespace.Widgets.TaxRuleView=b.Base.create("taxRule",b.Squarespace.SSWidget,[b.WidgetParent,b.WidgetChild],{initializer:function(d){this._taxRule=d.ruleInstance;this._parentTaxRules=d.parents;this.set("strings.name",this._taxRule.get("name"));switch(this._taxRule.get("scope")){case b.Squarespace.TaxScopes.COUNTRY:this._taxRule.hasStates()?this.set("strings.addAction","add state"):this.set("strings.addAction",null);break;
case b.Squarespace.TaxScopes.STATE:this._taxRule.hasLocalTaxes()?this.set("strings.addAction","add local"):this.set("strings.addAction",null);break;case b.Squarespace.TaxScopes.LOCAL:this.set("strings.addAction",null)}},renderUI:function(){this.constructor.superclass.renderUI.call(this);var d=this._parentTaxRules,c=this._taxRule.getAggregateRates(d),e=this.get("contentBox"),f=e.one(".description"),g,h=this._taxRule;0===d.length?0===h.get("rate")?f.setContent("No tax at this level."):(h.get("chargeTaxOnServices")?
(productsAndShipping="on products",h.get("chargeTaxOnShipping")&&(productsAndShipping="on products and shipping")):(g="0% on services. ",productsAndShipping="on all other products",h.get("chargeTaxOnShipping")&&(productsAndShipping="on all other products and shipping")),f.setContent(b.Handlebars.render("{{services}}{{rate}}% {{productsAndShipping}}",{services:g,rate:h.get("rate"),productsAndShipping:productsAndShipping}))):("CA"==h.get("countryCode")?h.get("showCombinedRate")?(c.services!=c.products&&
(g=b.Handlebars.render("<div class='directive'>{{total}}% {{name}} total on services/div>",{additional:h.get("chargeTaxOnServices")?h.get("rate"):0,total:c.services,name:h.get("taxName")})),d=b.Handlebars.render("<div class='directive'>{{total}}% {{name}} total on {{#if catchall}} all other {{/if}} products</div>",{additional:h.get("rate"),total:c.products,name:h.get("taxName"),catchall:c.services!=c.products}),f=b.Handlebars.render("<div class='directive'>{{total}}% {{name}} total on shipping</div>",
{additional:h.get("shippingRate"),total:c.shipping,name:h.get("taxName")})):(c.services!=c.products&&(g=b.Handlebars.render("<div class='directive'>+{{additional}}% {{name}} ({{total}}% {{name}} + GST total) on services</div>",{additional:h.get("chargeTaxOnServices")?h.get("rate"):0,total:c.services,name:h.get("taxName")})),d=b.Handlebars.render("<div class='directive'>+{{additional}}% {{name}} ({{total}}% {{name}} + GST total) on {{#if catchall}} all other {{/if}} products</div>",{additional:h.get("rate"),
total:c.products,name:h.get("taxName"),catchall:c.services!=c.products}),f=b.Handlebars.render("<div class='directive'>+{{additional}}% {{name}} ({{total}}% {{name}} + GST total) on shipping</div>",{additional:h.get("shippingRate"),total:c.shipping,name:h.get("taxName")})):(c.services!=c.products&&(g=b.Handlebars.render("<div class='directive'>+{{additional}} ({{total}}% total) on services</div>",{additional:h.get("chargeTaxOnServices")?h.get("rate"):0,total:c.services})),d=b.Handlebars.render("<div class='directive'>+{{additional}}% ({{total}}% total) on {{#if catchall}} all other {{/if}} products</div>",
{additional:h.get("rate"),total:c.products,catchall:c.services!=c.products}),f=b.Handlebars.render("<div class='directive'>+{{additional}}% ({{total}}% total) on shipping</div>",{additional:h.get("shippingRate"),total:c.shipping})),0===h.get("shippingRate")&&0===c.shipping&&(f=null),c=b.Handlebars.render("{{{services}}}{{{products}}}{{{shipping}}}",{services:g,products:d,shipping:f}),e.one(".description").append(c))},bindUI:function(){var d=this.get("contentBox");this.after("addChild",function(b){b.child.on("activated",
function(){this.deactivateScope();this.each(function(e){e!=b.child&&e.deactivateScope()})},this)},this);d.on("mouseover",this._activateScope,this);d.on("mouseleave",this.deactivateScope,this);if(!b.Lang.isNull(d.one(".add")))d.one(".add").on("click",this._requestCreateSubRule,this);d.on("click",this._edit,this)},_requestCreateSubRule:function(b){this.fire("create-requested",{parentModel:this._taxRule});b.halt()},_edit:function(d){var c=this._taxRule,e=c.get("scope")===b.Squarespace.TaxScopes.COUNTRY&&
c.isUSA()&&0===c.get("rate"),f=[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"}];e||f.push({type:"saveAndClose",title:"Save"});var e=c.isCanadian()&&c.get("scope")===b.Squarespace.TaxScopes.STATE?[{title:"Edit Rate for "+c.get("name"),icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"countryCode"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"state"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Provincial Tax Rate",text:"All customers from this province will have this sales tax added to their purchase."}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"taxName",className:"thin","strings.title":"Tax Name","strings.description":"E.g. HST, QST, PST",width:0.5}},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"rate",className:"thin","strings.title":"Provincial Tax Rate (%)","strings.description":"This rate is added to the federal rate.",
width:0.5}}]},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showCombinedRate","strings.title":"Show As Combined Rate","strings.description":"Typically for HST provinces, this displays the tax on invoices as a combined rate."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping","strings.description":"Apply sales tax to shipping charges."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services",
"strings.description":"Apply sales tax to service products."}}]}]:e?[{title:"Edit Rate for "+c.get("name"),icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"usTaxMessage",content:"The United States does not have a federal sales tax. This tax rule will charge 0% to your customers for products, services, and shipping."}}]}]:[{title:"Edit Rate for "+c.get("name"),icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.Hidden,
config:{name:"countryCode"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"state"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"zipStart"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"zipEnd"}},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"rate",className:"thin","strings.title":"Tax Rate (%)"}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping",
"strings.description":"Apply sales tax to shipping charges."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services","strings.description":"Apply sales tax to service products."}}]}],g=new b.Squarespace.EditingDialog({name:"addEditRule",style:"flyout",savingText:"Saving Tax Rule...",initialData:c.getAttrs(),overlay:0.5,width:390,closeOthers:!1,discardChangesConfirmation:!1,buttons:f,primaryTabs:e});g.on("remove-requested",b.bind(function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Tax Rule",
"strings.message":"Are you sure you want to delete this tax rate? This will also delete any lower level rates."})).on("confirm",function(){c.sync("delete",{},b.bind(function(){g.close();this.fire("rule-removed")},this))},this)},this));g.on("send-requested",b.bind(function(){c.set("rate",g.getData().rate);c.set("chargeTaxOnShipping",g.getData().chargeTaxOnShipping);c.set("chargeTaxOnServices",g.getData().chargeTaxOnServices);c.set("taxName",g.getData().taxName);c.set("showCombinedRate",g.getData().showCombinedRate);
this._taxRule.sync("update",{},b.bind(function(){g.close();this.fire("rule-updated")},this))},this));g.show();d.stopPropagation();d.halt()},deactivateScope:function(){this.get("contentBox").removeClass("active-scope")},_activateScope:function(b){this.fire("activated");this.get("contentBox").addClass("active-scope");b.halt();b.stopPropagation()},syncUI:function(){var d=this._taxRule.get("scope"),d=d==b.Squarespace.TaxScopes.COUNTRY?"country":d==b.Squarespace.TaxScopes.STATE?"state":"local";this.get("contentBox").addClass(d)}},
{CSS_PREFIX:"sqs-tax-rule",HANDLEBARS_TEMPLATE:"tax-rule-view.html",ATTRS:{strings:{value:{addAction:"add state"}}}})},"1.0",{requires:"base base-build squarespace-enum squarespace-ss-widget squarespace-dialog-numeric-text squarespace-dialog-description squarespace-models-tax-rule squarespace-tax-rule-view-template squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-pagination",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.Pagination=b.Base.create("Pagination",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{_initialData:{},initializer:function(){this._saveInitialData()},renderUI:function(){d.superclass.renderUI.apply(this,arguments);var b=this.get("contentBox");this._prevEl=b.one(".page-prev");this._nextEl=b.one(".page-next")},bindUI:function(){d.superclass.bindUI.apply(this,arguments);this._prevEl.on("click",
this.prevPage,this);this._nextEl.on("click",this.nextPage,this)},syncUI:function(){!this.get("hasNextPage")&&!this.get("hasPreviousPage")?this.set("visible",!1):(this.set("visible",!0),this._prevEl.toggleClass("disabled",!this.get("hasPreviousPage")),this._nextEl.toggleClass("disabled",!this.get("hasNextPage")))},_requestPage:function(c,e){var d=["next","previous"];b.Lang.isValue(e)&&!(e.hasClass("disabled")||-1===b.Array.indexOf(d,c))&&this.fire("pageRequested",{start:this.get(c+"PageStart"),direction:c})},
nextPage:function(){this._requestPage("next",this._nextEl)},prevPage:function(){this._requestPage("previous",this._prevEl)},reset:function(){b.Object.each(this._initialData,function(b,e){this.set(e,b)},this);this.syncUI()},_saveInitialData:function(){b.Object.each(this.constructor.ATTRS,function(b,e){this._initialData[e]=this.get(e)},this)},getData:function(){return{hasNextPage:this.get("hasNextPage"),hasPreviousPage:this.get("hasPreviousPage"),nextPageStart:this.get("nextPageStart"),previousPageStart:this.get("previousPageStart"),
totalItems:this.get("totalItems")}},update:function(c){b.Lang.isObject(c)&&(this.set("hasNextPage",c.hasNextPage),this.set("hasPreviousPage",c.hasPreviousPage),this.set("nextPageStart",c.nextPageStart),this.set("previousPageStart",c.previousPageStart),this.set("totalItems",c.totalItems));this.syncUI()}},{CSS_PREFIX:"sqs-pagination",TEMPLATE:'<span class="nav"><span class="page-prev"></span><span class="page">Pages</span><span class="page-next"></span><span class="loading"></span></span>',ATTRS:{visible:{value:!1},
nextPage:{value:!1},prevPage:{value:!1},totalItems:{}}})},"1.0",{requires:["base","widget-child","squarespace-ss-widget"]});
YUI.add("squarespace-widgets-newsletters-subscriber-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-newsletters-subscriber.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression,p=d.helperMissing;b='<div class="subscriber">\n  <div class="subscriber-selector"></div>\n  <div class="item ';if((h=d["if"].call(c,c.confirmed,{hash:{},inverse:this.program(3,function(b,c){return"unconfirmed"},
k),fn:this.program(1,function(b,c){return"confirmed"},k),data:k}))||0===h)b+=h;b+='" id="';(h=d.id)?h=h.call(c,{hash:{},data:k}):(h=c.id,h="function"===typeof h?h.apply(c):h);b+=l(h)+'">\n    <div class="name">'+l((h=(h=c.model,null==h||!1===h?h:h.firstName),"function"===typeof h?h.apply(c):h))+" "+l((h=(h=c.model,null==h||!1===h?h:h.lastName),"function"===typeof h?h.apply(c):h))+'</div>\n    <div class="email">'+l((h=(h=c.model,null==h||!1===h?h:h.email),"function"===typeof h?h.apply(c):h))+'</div>\n    <div class="addedOn">';
k={hash:{},data:k};return b+=l((h=d["humanizedate-format"]||c["humanizedate-format"],h?h.call(c,(h=c.model,null==h||!1===h?h:h.createdOn),k):p.call(c,"humanizedate-format",(h=c.model,null==h||!1===h?h:h.createdOn),k)))+'</div>\n    <div class="delete"></div>\n  </div>\n</div>\n'})})();b.Handlebars.registerPartial("widgets-newsletters-subscriber.html".replace("/","."),d.templates["widgets-newsletters-subscriber.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-google-apps-user-list-header",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.GoogleAppsUserListHeader=b.Base.create("GoogleAppsUserListHeader",b.Squarespace.Widgets.ModelListHeader,[],{initializer:function(){this._paginator=new b.Squarespace.Widgets.ModelListPaginator({models:this.get("models")})},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox").one(".header-controls");this._paginator.render(b)},bindUI:function(){d.superclass.bindUI.call(this);
this.get("models").after("load",this._updatePaginationVisibility,this)},_updatePaginationVisibility:function(){var b=this._paginator,e=this.get("models"),d=e.get("hasPreviousPage"),e=e.get("hasNextPage");b.set("visible",d||e)}},{CSS_PREFIX:"sqs-google-apps-user-list-header",ATTRS:{strings:{value:{title:"Email Accounts"}}}})},"1.0",{requires:["base","squarespace-promises","squarespace-widgets-model-list-header","squarespace-fluent-confirmation"]});
YUI.add("squarespace-dialog-xero-export-status",function(b){b.namespace("Squarespace.DialogFields").XeroExportStatus=b.Base.create("XeroExportStatus",b.Squarespace.DialogField2,[],{renderUI:function(){this.get("contentBox").setHTML('<div class="status-headline">Daily Export To Xero</div><div class="status-copy">Every day, Squarespace will export a Daily Sales Summary to Xero with a detailed breakdown of the previous day\'s sales and refunds.</div><div class="label-container organization"><div class="label">Organization</div><div class="value">(Loading)</div></div><div class="label-container lastexport"><div class="label">Last Daily Export</div><div class="value">(Loading)</div></div><div class="label-container nextexport"><div class="label">Next Scheduled Export</div><div class="value">(Loading)</div></div>');
this._add(new b.Squarespace.DialogFields.Button({"strings.text":"View Sales In Xero",onClick:this._openXeroInvoicesPage,context:this}))},bindUI:function(){this.after(["lastExportFmtChange","nextExportFmtChange","organizationNameChange"],this.syncUI,this)},syncUI:function(){var d=this.get("contentBox"),c=this.get("organizationName"),e=this.get("lastExportFmt"),f=this.get("nextExportFmt");b.Lang.isValue(e)&&d.one(".lastexport .value").setHTML(e);b.Lang.isValue(f)&&d.one(".nextexport .value").setHTML(f);
b.Lang.isValue(c)&&d.one(".organization .value").setHTML(c)},_openXeroInvoicesPage:function(){var d=b.Lang.sub("https://go.xero.com/organisationlogin/default.aspx?shortcode={shortcode}&redirecturl=/AccountsReceivable/Search.aspx?invoiceStatus=INVOICESTATUS%2fPAID",{shortcode:this.get("organizationShortCode")});window.open(d)}},{CSS_PREFIX:"sqs-xero-export-status",ATTRS:{lastExportFmt:{validator:b.Squarespace.AttrValidators.isString},nextExportFmt:{validator:b.Squarespace.AttrValidators.isString},
organizationName:{validator:b.Squarespace.AttrValidators.isString},organizationShortCode:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:"base node squarespace-dialog-field-2 squarespace-attr-validators squarespace-util squarespace-dialog-xero-export-css squarespace-dialog-button".split(" ")});
YUI.add("squarespace-block-calendar",function(b){var d=b.namespace("Squarespace.Block").Calendar=b.Base.create("block-calendar",b.Squarespace.Block.ModelSyncBase,[],{initializer:function(b){this._calendarInstance=!1},renderUI:function(){},bindUI:function(){d.superclass.bindUI.call(this);this.after("layout-rendered",this._renderBlock,this)},destructor:function(){this._calendarInstance&&this._calendarInstance.destroy()},_renderBlock:function(){var c=this.get("model").get("collectionId"),e=b.Squarespace.ContentCollectionCache.getById(c),
d=this.get("contentBox");d.one(".sqs-state-message")&&d.one(".sqs-state-message").remove();this._calendarInstance?this._calendarInstance.set("collectionId",c):c?this._calendarInstance=b.Squarespace.Rendering.renderCalendar(d,e):this._renderCollectionMissing()},_renderCollectionMissing:function(){this.get("contentBox").setHTML('<div class="sqs-state-message">You must select a collection to display.</div>')}},{MODEL:b.Squarespace.ContentModel.CalendarBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.CalendarDialog},
type:{value:b.Squarespace.BlockType.CALENDAR}},CSS_PREFIX:"sqs-block-calendar"})},"1.0",{requires:["base","model","squarespace-calendar-block-renderer","squarespace-block-calendar-editor","squarespace-block-calendar-model"]});
YUI.add("squarespace-block-opentable",function(b){var d=b.namespace("Squarespace.Block").Opentable=b.Base.create("block-opentable",b.Squarespace.Block.ModelSyncBase,[],{_renderSuccess:function(b){d.superclass._renderSuccess.call(this,b);this.get("contentBox").all("script").each(function(b){b.replace('<div class="state-message information"><div class="title">OpenTable</div><div>This block contains embedded code and will only be rendered on the front of your site.</div></div>')})}},{CSS_PREFIX:"sqs-block-opentable",
MODEL:b.Model,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Opentable},type:{value:b.Squarespace.BlockType.OPENTABLE}}})},"1.0",{requires:["base","squarespace-block-base-modelsync","squarespace-block-opentable-editor"]});
YUI.add("squarespace-smugmug-image-picker",function(b){b.namespace("Squarespace.Widgets").SmugMugImagePicker=b.Base.create("smugmugImagePicker",b.Squarespace.Widgets.DataWidget,[b.WidgetParent],{initializer:function(){this._imageMap={};this._imagePicker=new b.Squarespace.Widgets.ImagePicker({multiSelect:!0,hideOnSelect:!1,visible:!0,sizeInfo:!1,paginate:!0,maxSelected:b.Squarespace.Constants.MAX_SMUGMUG_GALLERY_SIZE,"strings.confirmButton":"Finish & Import","strings.instructions":"Select up to "+
b.Squarespace.Constants.MAX_SMUGMUG_GALLERY_SIZE+" images to import."});this._imagePicker.plug(b.Squarespace.Widgets.ImagePickerDragPlugin);this.add(this._imagePicker);this.publish("images-selected",{emitFacade:!0,defaultFn:this.close,context:this});this.publish("loaded",{});this.publish("load-failed",{});var d=this.get("id");this.after(d+"|dataStateChange",this._mirrorDataState,this);this.after(d+"|dataStateChange",this._updateSpinner,this);this._loadUrls()},destructor:function(){this._spinner&&
this._spinner.destroy()},_getIds:function(d){return b.Array.map(d,function(b){return this._imageMap[b].id},this)},bindUI:function(){var b=this.get("id");this._imagePicker.on(b+"|submit",function(){this.fire("images-selected",{ids:this._getIds(this._imagePicker.get("selectedImageURLs"))})},this);this.after(b+"|albumIdChange",this._loadUrls,this);this.after(b+"|connectedAccountIdChange",this._loadUrls,this);this._imagePicker.after(b+"|cancel",function(){this.fire("cancel")},this)},_updateSpinner:function(){var d=
this.getProperty("DATA_STATES");this.get("rendered")&&(this.get("dataState")===d.LOADING?this._spinnerEl=new b.Squarespace.Spinner({color:"light",render:this.get("boundingBox")}):this._spinner&&this._spinner.destroy())},_mirrorDataState:function(){this._imagePicker.set("dataState",this.get("dataState"))},_loadUrls:function(){var d=this.get("albumId"),c=this.get("connectedAccountId");!b.Lang.isUndefined(d)&&!b.Lang.isUndefined(c)&&(this.set("dataState",this.getProperty("DATA_STATES").LOADING),b.Data.get({url:"/api/smugmug/GetSmugMugAlbumURLs",
data:{albumId:d,connectedAccountId:c},success:function(c){this.set("dataState",this.getProperty("DATA_STATES").LOADED);this._imageMap=this._indexByThumbnailUrl(c.imagePreviews);this._imagePicker.set("imageURLs",b.Object.keys(this._imageMap));this.fire("loaded")},failure:function(b){this.set("dataState",this.getProperty("DATA_STATES").LOAD_FAILED);this.fire("load-failed")}},this))},_indexByThumbnailUrl:function(d){return b.Array.reduce(d,{},function(b,e){b[e.thumbnailUrl]=e;return b})}},{CSS_PREFIX:"sqs-smugmug-image-picker",
ATTRS:{connectedAccountId:{},albumId:{}}})},"1.0",{requires:["base-build","squarespace-image-picker","squarespace-ss-widget","squarespace-spinner","widget-parent"]});
YUI.add("squarespace-content-item-utils",function(b){var d=[b.Squarespace.MediaProcessingState.QUEUED,b.Squarespace.MediaProcessingState.PROCESSING],c=[b.Squarespace.MediaProcessingState.ERROR,b.Squarespace.MediaProcessingState.DOWNLOAD_ERROR,b.Squarespace.MediaProcessingState.ERROR_TOO_LARGE,b.Squarespace.MediaProcessingState.ERROR_FILE_NOT_FOUND,b.Squarespace.MediaProcessingState.ERROR_UNSUPPORTED_IMAGE_TYPE];b.namespace("Squarespace").ContentItemUtils={getWorkflowStateIdentifier:function(c){return c==
b.Squarespace.WorkflowStates.PUBLISHED?"published":c==b.Squarespace.WorkflowStates.SCHEDULED?"scheduled":c==b.Squarespace.WorkflowStates.NEEDS_REVIEW?"needsreview":"draft"},getWorkflowStateCopy:function(c){return c==b.Squarespace.WorkflowStates.PUBLISHED?"Published":c==b.Squarespace.WorkflowStates.SCHEDULED?"Scheduled":c==b.Squarespace.WorkflowStates.NEEDS_REVIEW?"Needs Review":"Draft"},getCommentStateIdentifier:function(c){return c==b.Squarespace.CommentStates.DISABLED?"disable":"allow"},isErrorProcessingState:function(b){b=
b.get("mediaProcessingState");return-1!==c.indexOf(b)},isProcessingState:function(b){b=b.get("mediaProcessingState");return-1!==d.indexOf(b)}}});"use strict";var THREE=THREE||{REVISION:"58"};self.console=self.console||{info:function(){},log:function(){},debug:function(){},warn:function(){},error:function(){}};self.Int32Array=self.Int32Array||Array;self.Float32Array=self.Float32Array||Array;String.prototype.trim=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")};
THREE.extend=function(b,d){if(Object.keys)for(var c=Object.keys(d),e=0,f=c.length;e<f;e++){var g=c[e];Object.defineProperty(b,g,Object.getOwnPropertyDescriptor(d,g))}else for(g in c={}.hasOwnProperty,d)c.call(d,g)&&(b[g]=d[g]);return b};
(function(){for(var b=0,d=["ms","moz","webkit","o"],c=0;c<d.length&&!window.requestAnimationFrame;++c)window.requestAnimationFrame=window[d[c]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[d[c]+"CancelAnimationFrame"]||window[d[c]+"CancelRequestAnimationFrame"];void 0===window.requestAnimationFrame&&(window.requestAnimationFrame=function(c){var d=Date.now(),g=Math.max(0,16-(d-b)),h=window.setTimeout(function(){c(d+g)},g);b=d+g;return h});window.cancelAnimationFrame=window.cancelAnimationFrame||
function(b){window.clearTimeout(b)}})();THREE.CullFaceNone=0;THREE.CullFaceBack=1;THREE.CullFaceFront=2;THREE.CullFaceFrontBack=3;THREE.FrontFaceDirectionCW=0;THREE.FrontFaceDirectionCCW=1;THREE.BasicShadowMap=0;THREE.PCFShadowMap=1;THREE.PCFSoftShadowMap=2;THREE.FrontSide=0;THREE.BackSide=1;THREE.DoubleSide=2;THREE.NoShading=0;THREE.FlatShading=1;THREE.SmoothShading=2;THREE.NoColors=0;THREE.FaceColors=1;THREE.VertexColors=2;THREE.NoBlending=0;THREE.NormalBlending=1;THREE.AdditiveBlending=2;
THREE.SubtractiveBlending=3;THREE.MultiplyBlending=4;THREE.CustomBlending=5;THREE.AddEquation=100;THREE.SubtractEquation=101;THREE.ReverseSubtractEquation=102;THREE.ZeroFactor=200;THREE.OneFactor=201;THREE.SrcColorFactor=202;THREE.OneMinusSrcColorFactor=203;THREE.SrcAlphaFactor=204;THREE.OneMinusSrcAlphaFactor=205;THREE.DstAlphaFactor=206;THREE.OneMinusDstAlphaFactor=207;THREE.DstColorFactor=208;THREE.OneMinusDstColorFactor=209;THREE.SrcAlphaSaturateFactor=210;THREE.MultiplyOperation=0;
THREE.MixOperation=1;THREE.AddOperation=2;THREE.UVMapping=function(){};THREE.CubeReflectionMapping=function(){};THREE.CubeRefractionMapping=function(){};THREE.SphericalReflectionMapping=function(){};THREE.SphericalRefractionMapping=function(){};THREE.RepeatWrapping=1E3;THREE.ClampToEdgeWrapping=1001;THREE.MirroredRepeatWrapping=1002;THREE.NearestFilter=1003;THREE.NearestMipMapNearestFilter=1004;THREE.NearestMipMapLinearFilter=1005;THREE.LinearFilter=1006;THREE.LinearMipMapNearestFilter=1007;
THREE.LinearMipMapLinearFilter=1008;THREE.UnsignedByteType=1009;THREE.ByteType=1010;THREE.ShortType=1011;THREE.UnsignedShortType=1012;THREE.IntType=1013;THREE.UnsignedIntType=1014;THREE.FloatType=1015;THREE.UnsignedShort4444Type=1016;THREE.UnsignedShort5551Type=1017;THREE.UnsignedShort565Type=1018;THREE.AlphaFormat=1019;THREE.RGBFormat=1020;THREE.RGBAFormat=1021;THREE.LuminanceFormat=1022;THREE.LuminanceAlphaFormat=1023;THREE.RGB_S3TC_DXT1_Format=2001;THREE.RGBA_S3TC_DXT1_Format=2002;
THREE.RGBA_S3TC_DXT3_Format=2003;THREE.RGBA_S3TC_DXT5_Format=2004;THREE.Color=function(b){void 0!==b&&this.set(b);return this};
THREE.Color.prototype={constructor:THREE.Color,r:1,g:1,b:1,set:function(b){b instanceof THREE.Color?this.copy(b):"number"===typeof b?this.setHex(b):"string"===typeof b&&this.setStyle(b);return this},setHex:function(b){b=Math.floor(b);this.r=(b>>16&255)/255;this.g=(b>>8&255)/255;this.b=(b&255)/255;return this},setRGB:function(b,d,c){this.r=b;this.g=d;this.b=c;return this},setHSL:function(b,d,c){if(0===d)this.r=this.g=this.b=c;else{var e=function(b,c,e){0>e&&(e+=1);1<e&&(e-=1);return e<1/6?b+6*(c-b)*
e:0.5>e?c:e<2/3?b+6*(c-b)*(2/3-e):b};d=0.5>=c?c*(1+d):c+d-c*d;c=2*c-d;this.r=e(c,d,b+1/3);this.g=e(c,d,b);this.b=e(c,d,b-1/3)}return this},setStyle:function(b){if(/^rgb\((\d+),(\d+),(\d+)\)$/i.test(b))return b=/^rgb\((\d+),(\d+),(\d+)\)$/i.exec(b),this.r=Math.min(255,parseInt(b[1],10))/255,this.g=Math.min(255,parseInt(b[2],10))/255,this.b=Math.min(255,parseInt(b[3],10))/255,this;if(/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.test(b))return b=/^rgb\((\d+)\%,(\d+)\%,(\d+)\%\)$/i.exec(b),this.r=Math.min(100,
parseInt(b[1],10))/100,this.g=Math.min(100,parseInt(b[2],10))/100,this.b=Math.min(100,parseInt(b[3],10))/100,this;if(/^\#([0-9a-f]{6})$/i.test(b))return b=/^\#([0-9a-f]{6})$/i.exec(b),this.setHex(parseInt(b[1],16)),this;if(/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.test(b))return b=/^\#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(b),this.setHex(parseInt(b[1]+b[1]+b[2]+b[2]+b[3]+b[3],16)),this;if(/^(\w+)$/i.test(b))return this.setHex(THREE.ColorKeywords[b]),this},copy:function(b){this.r=b.r;this.g=b.g;this.b=
b.b;return this},copyGammaToLinear:function(b){this.r=b.r*b.r;this.g=b.g*b.g;this.b=b.b*b.b;return this},copyLinearToGamma:function(b){this.r=Math.sqrt(b.r);this.g=Math.sqrt(b.g);this.b=Math.sqrt(b.b);return this},convertGammaToLinear:function(){var b=this.r,d=this.g,c=this.b;this.r=b*b;this.g=d*d;this.b=c*c;return this},convertLinearToGamma:function(){this.r=Math.sqrt(this.r);this.g=Math.sqrt(this.g);this.b=Math.sqrt(this.b);return this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*
this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(){var b={h:0,s:0,l:0};return function(){var d=this.r,c=this.g,e=this.b,f=Math.max(d,c,e),g=Math.min(d,c,e),h,k=(g+f)/2;if(g===f)g=h=0;else{var l=f-g,g=0.5>=k?l/(f+g):l/(2-f-g);switch(f){case d:h=(c-e)/l+(c<e?6:0);break;case c:h=(e-d)/l+2;break;case e:h=(d-c)/l+4}h/=6}b.h=h;b.s=g;b.l=k;return b}}(),getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(b,
d,c){var e=this.getHSL();e.h+=b;e.s+=d;e.l+=c;this.setHSL(e.h,e.s,e.l);return this},add:function(b){this.r+=b.r;this.g+=b.g;this.b+=b.b;return this},addColors:function(b,d){this.r=b.r+d.r;this.g=b.g+d.g;this.b=b.b+d.b;return this},addScalar:function(b){this.r+=b;this.g+=b;this.b+=b;return this},multiply:function(b){this.r*=b.r;this.g*=b.g;this.b*=b.b;return this},multiplyScalar:function(b){this.r*=b;this.g*=b;this.b*=b;return this},lerp:function(b,d){this.r+=(b.r-this.r)*d;this.g+=(b.g-this.g)*d;
this.b+=(b.b-this.b)*d;return this},equals:function(b){return b.r===this.r&&b.g===this.g&&b.b===this.b},clone:function(){return(new THREE.Color).setRGB(this.r,this.g,this.b)}};
THREE.ColorKeywords={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,
darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,
grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,
lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,
palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,
tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};THREE.Quaternion=function(b,d,c,e){this.x=b||0;this.y=d||0;this.z=c||0;this.w=void 0!==e?e:1};
THREE.Quaternion.prototype={constructor:THREE.Quaternion,set:function(b,d,c,e){this.x=b;this.y=d;this.z=c;this.w=e;return this},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=b.w;return this},setFromEuler:function(b,d){var c=Math.cos(b.x/2),e=Math.cos(b.y/2),f=Math.cos(b.z/2),g=Math.sin(b.x/2),h=Math.sin(b.y/2),k=Math.sin(b.z/2);void 0===d||"XYZ"===d?(this.x=g*e*f+c*h*k,this.y=c*h*f-g*e*k,this.z=c*e*k+g*h*f,this.w=c*e*f-g*h*k):"YXZ"===d?(this.x=g*e*f+c*h*k,this.y=c*h*f-g*e*k,this.z=c*e*
k-g*h*f,this.w=c*e*f+g*h*k):"ZXY"===d?(this.x=g*e*f-c*h*k,this.y=c*h*f+g*e*k,this.z=c*e*k+g*h*f,this.w=c*e*f-g*h*k):"ZYX"===d?(this.x=g*e*f-c*h*k,this.y=c*h*f+g*e*k,this.z=c*e*k-g*h*f,this.w=c*e*f+g*h*k):"YZX"===d?(this.x=g*e*f+c*h*k,this.y=c*h*f+g*e*k,this.z=c*e*k-g*h*f,this.w=c*e*f-g*h*k):"XZY"===d&&(this.x=g*e*f-c*h*k,this.y=c*h*f-g*e*k,this.z=c*e*k+g*h*f,this.w=c*e*f+g*h*k);return this},setFromAxisAngle:function(b,d){var c=d/2,e=Math.sin(c);this.x=b.x*e;this.y=b.y*e;this.z=b.z*e;this.w=Math.cos(c);
return this},setFromRotationMatrix:function(b){var d=b.elements,c=d[0];b=d[4];var e=d[8],f=d[1],g=d[5],h=d[9],k=d[2],l=d[6],d=d[10],p=c+g+d;0<p?(c=0.5/Math.sqrt(p+1),this.w=0.25/c,this.x=(l-h)*c,this.y=(e-k)*c,this.z=(f-b)*c):c>g&&c>d?(c=2*Math.sqrt(1+c-g-d),this.w=(l-h)/c,this.x=0.25*c,this.y=(b+f)/c,this.z=(e+k)/c):g>d?(c=2*Math.sqrt(1+g-c-d),this.w=(e-k)/c,this.x=(b+f)/c,this.y=0.25*c,this.z=(h+l)/c):(c=2*Math.sqrt(1+d-c-g),this.w=(f-b)/c,this.x=(e+k)/c,this.y=(h+l)/c,this.z=0.25*c);return this},
inverse:function(){this.conjugate().normalize();return this},conjugate:function(){this.x*=-1;this.y*=-1;this.z*=-1;return this},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},normalize:function(){var b=this.length();0===b?(this.z=this.y=this.x=0,this.w=1):(b=1/b,this.x*=b,this.y*=b,this.z*=b,this.w*=b);return this},multiply:function(b,d){return void 0!==d?(console.warn("DEPRECATED: Quaternion's .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),
this.multiplyQuaternions(b,d)):this.multiplyQuaternions(this,b)},multiplyQuaternions:function(b,d){var c=b.x,e=b.y,f=b.z,g=b.w,h=d.x,k=d.y,l=d.z,p=d.w;this.x=c*p+g*h+e*l-f*k;this.y=e*p+g*k+f*h-c*l;this.z=f*p+g*l+c*k-e*h;this.w=g*p-c*h-e*k-f*l;return this},multiplyVector3:function(b){console.warn("DEPRECATED: Quaternion's .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead.");return b.applyQuaternion(this)},slerp:function(b,d){var c=this.x,e=this.y,f=this.z,
g=this.w,h=g*b.w+c*b.x+e*b.y+f*b.z;0>h?(this.w=-b.w,this.x=-b.x,this.y=-b.y,this.z=-b.z,h=-h):this.copy(b);if(1<=h)return this.w=g,this.x=c,this.y=e,this.z=f,this;var k=Math.acos(h),l=Math.sqrt(1-h*h);if(0.001>Math.abs(l))return this.w=0.5*(g+this.w),this.x=0.5*(c+this.x),this.y=0.5*(e+this.y),this.z=0.5*(f+this.z),this;h=Math.sin((1-d)*k)/l;k=Math.sin(d*k)/l;this.w=g*h+this.w*k;this.x=c*h+this.x*k;this.y=e*h+this.y*k;this.z=f*h+this.z*k;return this},equals:function(b){return b.x===this.x&&b.y===
this.y&&b.z===this.z&&b.w===this.w},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];this.w=b[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Quaternion(this.x,this.y,this.z,this.w)}};THREE.Quaternion.slerp=function(b,d,c,e){return c.copy(b).slerp(d,e)};THREE.Vector2=function(b,d){this.x=b||0;this.y=d||0};
THREE.Vector2.prototype={constructor:THREE.Vector2,set:function(b,d){this.x=b;this.y=d;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setComponent:function(b,d){switch(b){case 0:this.x=d;break;case 1:this.y=d;break;default:throw Error("index is out of range: "+b);}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+b);}},copy:function(b){this.x=b.x;this.y=b.y;return this},add:function(b,
d){if(void 0!==d)return console.warn("DEPRECATED: Vector2's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(b,d);this.x+=b.x;this.y+=b.y;return this},addVectors:function(b,d){this.x=b.x+d.x;this.y=b.y+d.y;return this},addScalar:function(b){this.x+=b;this.y+=b;return this},sub:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector2's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(b,d);this.x-=b.x;this.y-=
b.y;return this},subVectors:function(b,d){this.x=b.x-d.x;this.y=b.y-d.y;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;return this},divideScalar:function(b){0!==b?(this.x/=b,this.y/=b):this.set(0,0);return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);return this},clamp:function(b,d){this.x<b.x?this.x=b.x:this.x>d.x&&(this.x=d.x);this.y<b.y?this.y=b.y:this.y>d.y&&(this.y=d.y);return this},
negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},normalize:function(){return this.divideScalar(this.length())},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(b){var d=this.x-b.x;b=this.y-b.y;return d*d+b*b},setLength:function(b){var d=this.length();0!==d&&b!==d&&this.multiplyScalar(b/
d);return this},lerp:function(b,d){this.x+=(b.x-this.x)*d;this.y+=(b.y-this.y)*d;return this},equals:function(b){return b.x===this.x&&b.y===this.y},fromArray:function(b){this.x=b[0];this.y=b[1];return this},toArray:function(){return[this.x,this.y]},clone:function(){return new THREE.Vector2(this.x,this.y)}};THREE.Vector3=function(b,d,c){this.x=b||0;this.y=d||0;this.z=c||0};
THREE.Vector3.prototype={constructor:THREE.Vector3,set:function(b,d,c){this.x=b;this.y=d;this.z=c;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},setComponent:function(b,d){switch(b){case 0:this.x=d;break;case 1:this.y=d;break;case 2:this.z=d;break;default:throw Error("index is out of range: "+b);}},getComponent:function(b){switch(b){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+
b);}},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;return this},add:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector3's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(b,d);this.x+=b.x;this.y+=b.y;this.z+=b.z;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;return this},addVectors:function(b,d){this.x=b.x+d.x;this.y=b.y+d.y;this.z=b.z+d.z;return this},sub:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector3's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),
this.subVectors(b,d);this.x-=b.x;this.y-=b.y;this.z-=b.z;return this},subVectors:function(b,d){this.x=b.x-d.x;this.y=b.y-d.y;this.z=b.z-d.z;return this},multiply:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector3's .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(b,d);this.x*=b.x;this.y*=b.y;this.z*=b.z;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;return this},multiplyVectors:function(b,d){this.x=b.x*
d.x;this.y=b.y*d.y;this.z=b.z*d.z;return this},applyMatrix3:function(b){var d=this.x,c=this.y,e=this.z;b=b.elements;this.x=b[0]*d+b[3]*c+b[6]*e;this.y=b[1]*d+b[4]*c+b[7]*e;this.z=b[2]*d+b[5]*c+b[8]*e;return this},applyMatrix4:function(b){var d=this.x,c=this.y,e=this.z;b=b.elements;this.x=b[0]*d+b[4]*c+b[8]*e+b[12];this.y=b[1]*d+b[5]*c+b[9]*e+b[13];this.z=b[2]*d+b[6]*c+b[10]*e+b[14];return this},applyProjection:function(b){var d=this.x,c=this.y,e=this.z;b=b.elements;var f=1/(b[3]*d+b[7]*c+b[11]*e+
b[15]);this.x=(b[0]*d+b[4]*c+b[8]*e+b[12])*f;this.y=(b[1]*d+b[5]*c+b[9]*e+b[13])*f;this.z=(b[2]*d+b[6]*c+b[10]*e+b[14])*f;return this},applyQuaternion:function(b){var d=this.x,c=this.y,e=this.z,f=b.x,g=b.y,h=b.z;b=b.w;var k=b*d+g*e-h*c,l=b*c+h*d-f*e,p=b*e+f*c-g*d,d=-f*d-g*c-h*e;this.x=k*b+d*-f+l*-h-p*-g;this.y=l*b+d*-g+p*-f-k*-h;this.z=p*b+d*-h+k*-g-l*-f;return this},transformDirection:function(b){var d=this.x,c=this.y,e=this.z;b=b.elements;this.x=b[0]*d+b[4]*c+b[8]*e;this.y=b[1]*d+b[5]*c+b[9]*e;
this.z=b[2]*d+b[6]*c+b[10]*e;this.normalize();return this},divide:function(b){this.x/=b.x;this.y/=b.y;this.z/=b.z;return this},divideScalar:function(b){0!==b?(this.x/=b,this.y/=b,this.z/=b):this.z=this.y=this.x=0;return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);this.z>b.z&&(this.z=b.z);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);this.z<b.z&&(this.z=b.z);return this},clamp:function(b,d){this.x<b.x?this.x=b.x:this.x>d.x&&(this.x=d.x);
this.y<b.y?this.y=b.y:this.y>d.y&&(this.y=d.y);this.z<b.z?this.z=b.z:this.z>d.z&&(this.z=d.z);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length())},
setLength:function(b){var d=this.length();0!==d&&b!==d&&this.multiplyScalar(b/d);return this},lerp:function(b,d){this.x+=(b.x-this.x)*d;this.y+=(b.y-this.y)*d;this.z+=(b.z-this.z)*d;return this},cross:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector3's .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(b,d);var c=this.x,e=this.y,f=this.z;this.x=e*b.z-f*b.y;this.y=f*b.x-c*b.z;this.z=c*b.y-e*b.x;return this},crossVectors:function(b,d){this.x=
b.y*d.z-b.z*d.y;this.y=b.z*d.x-b.x*d.z;this.z=b.x*d.y-b.y*d.x;return this},angleTo:function(b){b=this.dot(b)/(this.length()*b.length());return Math.acos(THREE.Math.clamp(b,-1,1))},distanceTo:function(b){return Math.sqrt(this.distanceToSquared(b))},distanceToSquared:function(b){var d=this.x-b.x,c=this.y-b.y;b=this.z-b.z;return d*d+c*c+b*b},setEulerFromRotationMatrix:function(b,d){function c(b){return Math.min(Math.max(b,-1),1)}var e=b.elements,f=e[0],g=e[4],h=e[8],k=e[1],l=e[5],p=e[9],q=e[2],r=e[6],
e=e[10];void 0===d||"XYZ"===d?(this.y=Math.asin(c(h)),0.99999>Math.abs(h)?(this.x=Math.atan2(-p,e),this.z=Math.atan2(-g,f)):(this.x=Math.atan2(r,l),this.z=0)):"YXZ"===d?(this.x=Math.asin(-c(p)),0.99999>Math.abs(p)?(this.y=Math.atan2(h,e),this.z=Math.atan2(k,l)):(this.y=Math.atan2(-q,f),this.z=0)):"ZXY"===d?(this.x=Math.asin(c(r)),0.99999>Math.abs(r)?(this.y=Math.atan2(-q,e),this.z=Math.atan2(-g,l)):(this.y=0,this.z=Math.atan2(k,f))):"ZYX"===d?(this.y=Math.asin(-c(q)),0.99999>Math.abs(q)?(this.x=Math.atan2(r,
e),this.z=Math.atan2(k,f)):(this.x=0,this.z=Math.atan2(-g,l))):"YZX"===d?(this.z=Math.asin(c(k)),0.99999>Math.abs(k)?(this.x=Math.atan2(-p,l),this.y=Math.atan2(-q,f)):(this.x=0,this.y=Math.atan2(h,e))):"XZY"===d&&(this.z=Math.asin(-c(g)),0.99999>Math.abs(g)?(this.x=Math.atan2(r,l),this.y=Math.atan2(h,f)):(this.x=Math.atan2(-p,e),this.y=0));return this},setEulerFromQuaternion:function(b,d){function c(b){return Math.min(Math.max(b,-1),1)}var e=b.x*b.x,f=b.y*b.y,g=b.z*b.z,h=b.w*b.w;void 0===d||"XYZ"===
d?(this.x=Math.atan2(2*(b.x*b.w-b.y*b.z),h-e-f+g),this.y=Math.asin(c(2*(b.x*b.z+b.y*b.w))),this.z=Math.atan2(2*(b.z*b.w-b.x*b.y),h+e-f-g)):"YXZ"===d?(this.x=Math.asin(c(2*(b.x*b.w-b.y*b.z))),this.y=Math.atan2(2*(b.x*b.z+b.y*b.w),h-e-f+g),this.z=Math.atan2(2*(b.x*b.y+b.z*b.w),h-e+f-g)):"ZXY"===d?(this.x=Math.asin(c(2*(b.x*b.w+b.y*b.z))),this.y=Math.atan2(2*(b.y*b.w-b.z*b.x),h-e-f+g),this.z=Math.atan2(2*(b.z*b.w-b.x*b.y),h-e+f-g)):"ZYX"===d?(this.x=Math.atan2(2*(b.x*b.w+b.z*b.y),h-e-f+g),this.y=Math.asin(c(2*
(b.y*b.w-b.x*b.z))),this.z=Math.atan2(2*(b.x*b.y+b.z*b.w),h+e-f-g)):"YZX"===d?(this.x=Math.atan2(2*(b.x*b.w-b.z*b.y),h-e+f-g),this.y=Math.atan2(2*(b.y*b.w-b.x*b.z),h+e-f-g),this.z=Math.asin(c(2*(b.x*b.y+b.z*b.w)))):"XZY"===d&&(this.x=Math.atan2(2*(b.x*b.w+b.y*b.z),h-e+f-g),this.y=Math.atan2(2*(b.x*b.z+b.y*b.w),h+e-f-g),this.z=Math.asin(c(2*(b.z*b.w-b.x*b.y))));return this},getPositionFromMatrix:function(b){this.x=b.elements[12];this.y=b.elements[13];this.z=b.elements[14];return this},getScaleFromMatrix:function(b){var d=
this.set(b.elements[0],b.elements[1],b.elements[2]).length(),c=this.set(b.elements[4],b.elements[5],b.elements[6]).length();b=this.set(b.elements[8],b.elements[9],b.elements[10]).length();this.x=d;this.y=c;this.z=b;return this},getColumnFromMatrix:function(b,d){var c=4*b,e=d.elements;this.x=e[c];this.y=e[c+1];this.z=e[c+2];return this},equals:function(b){return b.x===this.x&&b.y===this.y&&b.z===this.z},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];return this},toArray:function(){return[this.x,
this.y,this.z]},clone:function(){return new THREE.Vector3(this.x,this.y,this.z)}};
THREE.extend(THREE.Vector3.prototype,{applyEuler:function(){var b=new THREE.Quaternion;return function(d,c){var e=b.setFromEuler(d,c);this.applyQuaternion(e);return this}}(),applyAxisAngle:function(){var b=new THREE.Quaternion;return function(d,c){var e=b.setFromAxisAngle(d,c);this.applyQuaternion(e);return this}}(),projectOnVector:function(){var b=new THREE.Vector3;return function(d){b.copy(d).normalize();d=this.dot(b);return this.copy(b).multiplyScalar(d)}}(),projectOnPlane:function(){var b=new THREE.Vector3;
return function(d){b.copy(this).projectOnVector(d);return this.sub(b)}}(),reflect:function(){var b=new THREE.Vector3;return function(d){b.copy(this).projectOnVector(d).multiplyScalar(2);return this.subVectors(b,this)}}()});THREE.Vector4=function(b,d,c,e){this.x=b||0;this.y=d||0;this.z=c||0;this.w=void 0!==e?e:1};
THREE.Vector4.prototype={constructor:THREE.Vector4,set:function(b,d,c,e){this.x=b;this.y=d;this.z=c;this.w=e;return this},setX:function(b){this.x=b;return this},setY:function(b){this.y=b;return this},setZ:function(b){this.z=b;return this},setW:function(b){this.w=b;return this},setComponent:function(b,d){switch(b){case 0:this.x=d;break;case 1:this.y=d;break;case 2:this.z=d;break;case 3:this.w=d;break;default:throw Error("index is out of range: "+b);}},getComponent:function(b){switch(b){case 0:return this.x;
case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+b);}},copy:function(b){this.x=b.x;this.y=b.y;this.z=b.z;this.w=void 0!==b.w?b.w:1;return this},add:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector4's .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(b,d);this.x+=b.x;this.y+=b.y;this.z+=b.z;this.w+=b.w;return this},addScalar:function(b){this.x+=b;this.y+=b;this.z+=b;this.w+=b;return this},
addVectors:function(b,d){this.x=b.x+d.x;this.y=b.y+d.y;this.z=b.z+d.z;this.w=b.w+d.w;return this},sub:function(b,d){if(void 0!==d)return console.warn("DEPRECATED: Vector4's .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(b,d);this.x-=b.x;this.y-=b.y;this.z-=b.z;this.w-=b.w;return this},subVectors:function(b,d){this.x=b.x-d.x;this.y=b.y-d.y;this.z=b.z-d.z;this.w=b.w-d.w;return this},multiplyScalar:function(b){this.x*=b;this.y*=b;this.z*=b;this.w*=b;return this},
applyMatrix4:function(b){var d=this.x,c=this.y,e=this.z,f=this.w;b=b.elements;this.x=b[0]*d+b[4]*c+b[8]*e+b[12]*f;this.y=b[1]*d+b[5]*c+b[9]*e+b[13]*f;this.z=b[2]*d+b[6]*c+b[10]*e+b[14]*f;this.w=b[3]*d+b[7]*c+b[11]*e+b[15]*f;return this},divideScalar:function(b){0!==b?(this.x/=b,this.y/=b,this.z/=b,this.w/=b):(this.z=this.y=this.x=0,this.w=1);return this},setAxisAngleFromQuaternion:function(b){this.w=2*Math.acos(b.w);var d=Math.sqrt(1-b.w*b.w);1E-4>d?(this.x=1,this.z=this.y=0):(this.x=b.x/d,this.y=
b.y/d,this.z=b.z/d);return this},setAxisAngleFromRotationMatrix:function(b){var d,c,e;b=b.elements;var f=b[0];e=b[4];var g=b[8],h=b[1],k=b[5],l=b[9];c=b[2];d=b[6];var p=b[10];if(0.01>Math.abs(e-h)&&0.01>Math.abs(g-c)&&0.01>Math.abs(l-d)){if(0.1>Math.abs(e+h)&&0.1>Math.abs(g+c)&&0.1>Math.abs(l+d)&&0.1>Math.abs(f+k+p-3))return this.set(1,0,0,0),this;b=Math.PI;f=(f+1)/2;k=(k+1)/2;p=(p+1)/2;e=(e+h)/4;g=(g+c)/4;l=(l+d)/4;f>k&&f>p?0.01>f?(d=0,e=c=0.707106781):(d=Math.sqrt(f),c=e/d,e=g/d):k>p?0.01>k?(d=
0.707106781,c=0,e=0.707106781):(c=Math.sqrt(k),d=e/c,e=l/c):0.01>p?(c=d=0.707106781,e=0):(e=Math.sqrt(p),d=g/e,c=l/e);this.set(d,c,e,b);return this}b=Math.sqrt((d-l)*(d-l)+(g-c)*(g-c)+(h-e)*(h-e));0.001>Math.abs(b)&&(b=1);this.x=(d-l)/b;this.y=(g-c)/b;this.z=(h-e)/b;this.w=Math.acos((f+k+p-1)/2);return this},min:function(b){this.x>b.x&&(this.x=b.x);this.y>b.y&&(this.y=b.y);this.z>b.z&&(this.z=b.z);this.w>b.w&&(this.w=b.w);return this},max:function(b){this.x<b.x&&(this.x=b.x);this.y<b.y&&(this.y=b.y);
this.z<b.z&&(this.z=b.z);this.w<b.w&&(this.w=b.w);return this},clamp:function(b,d){this.x<b.x?this.x=b.x:this.x>d.x&&(this.x=d.x);this.y<b.y?this.y=b.y:this.y>d.y&&(this.y=d.y);this.z<b.z?this.z=b.z:this.z>d.z&&(this.z=d.z);this.w<b.w?this.w=b.w:this.w>d.w&&(this.w=d.w);return this},negate:function(){return this.multiplyScalar(-1)},dot:function(b){return this.x*b.x+this.y*b.y+this.z*b.z+this.w*b.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*
this.x+this.y*this.y+this.z*this.z+this.w*this.w)},lengthManhattan:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length())},setLength:function(b){var d=this.length();0!==d&&b!==d&&this.multiplyScalar(b/d);return this},lerp:function(b,d){this.x+=(b.x-this.x)*d;this.y+=(b.y-this.y)*d;this.z+=(b.z-this.z)*d;this.w+=(b.w-this.w)*d;return this},equals:function(b){return b.x===this.x&&b.y===this.y&&b.z===this.z&&
b.w===this.w},fromArray:function(b){this.x=b[0];this.y=b[1];this.z=b[2];this.w=b[3];return this},toArray:function(){return[this.x,this.y,this.z,this.w]},clone:function(){return new THREE.Vector4(this.x,this.y,this.z,this.w)}};THREE.Line3=function(b,d){this.start=void 0!==b?b:new THREE.Vector3;this.end=void 0!==d?d:new THREE.Vector3};
THREE.Line3.prototype={constructor:THREE.Line3,set:function(b,d){this.start.copy(b);this.end.copy(d);return this},copy:function(b){this.start.copy(b.start);this.end.copy(b.end);return this},center:function(b){return(b||new THREE.Vector3).addVectors(this.start,this.end).multiplyScalar(0.5)},delta:function(b){return(b||new THREE.Vector3).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(b,
d){var c=d||new THREE.Vector3;return this.delta(c).multiplyScalar(b).add(this.start)},closestPointToPointParameter:function(){var b=new THREE.Vector3,d=new THREE.Vector3;return function(c,e){b.subVectors(c,this.start);d.subVectors(this.end,this.start);var f=d.dot(d),f=d.dot(b)/f;e&&(f=THREE.Math.clamp(f,0,1));return f}}(),closestPointToPoint:function(b,d,c){b=this.closestPointToPointParameter(b,d);c=c||new THREE.Vector3;return this.delta(c).multiplyScalar(b).add(this.start)},applyMatrix4:function(b){this.start.applyMatrix4(b);
this.end.applyMatrix4(b);return this},equals:function(b){return b.start.equals(this.start)&&b.end.equals(this.end)},clone:function(){return(new THREE.Line3).copy(this)}};THREE.Box2=function(b,d){this.min=void 0!==b?b:new THREE.Vector2(Infinity,Infinity);this.max=void 0!==d?d:new THREE.Vector2(-Infinity,-Infinity)};
THREE.Box2.prototype={constructor:THREE.Box2,set:function(b,d){this.min.copy(b);this.max.copy(d);return this},setFromPoints:function(b){if(0<b.length){var d=b[0];this.min.copy(d);this.max.copy(d);for(var c=1,e=b.length;c<e;c++)d=b[c],d.x<this.min.x?this.min.x=d.x:d.x>this.max.x&&(this.max.x=d.x),d.y<this.min.y?this.min.y=d.y:d.y>this.max.y&&(this.max.y=d.y)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var b=new THREE.Vector2;return function(d,c){var e=b.copy(c).multiplyScalar(0.5);
this.min.copy(d).sub(e);this.max.copy(d).add(e);return this}}(),copy:function(b){this.min.copy(b.min);this.max.copy(b.max);return this},makeEmpty:function(){this.min.x=this.min.y=Infinity;this.max.x=this.max.y=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},center:function(b){return(b||new THREE.Vector2).addVectors(this.min,this.max).multiplyScalar(0.5)},size:function(b){return(b||new THREE.Vector2).subVectors(this.max,this.min)},expandByPoint:function(b){this.min.min(b);
this.max.max(b);return this},expandByVector:function(b){this.min.sub(b);this.max.add(b);return this},expandByScalar:function(b){this.min.addScalar(-b);this.max.addScalar(b);return this},containsPoint:function(b){return b.x<this.min.x||b.x>this.max.x||b.y<this.min.y||b.y>this.max.y?!1:!0},containsBox:function(b){return this.min.x<=b.min.x&&b.max.x<=this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y?!0:!1},getParameter:function(b){return new THREE.Vector2((b.x-this.min.x)/(this.max.x-this.min.x),
(b.y-this.min.y)/(this.max.y-this.min.y))},isIntersectionBox:function(b){return b.max.x<this.min.x||b.min.x>this.max.x||b.max.y<this.min.y||b.min.y>this.max.y?!1:!0},clampPoint:function(b,d){return(d||new THREE.Vector2).copy(b).clamp(this.min,this.max)},distanceToPoint:function(){var b=new THREE.Vector2;return function(d){return b.copy(d).clamp(this.min,this.max).sub(d).length()}}(),intersect:function(b){this.min.max(b.min);this.max.min(b.max);return this},union:function(b){this.min.min(b.min);this.max.max(b.max);
return this},translate:function(b){this.min.add(b);this.max.add(b);return this},equals:function(b){return b.min.equals(this.min)&&b.max.equals(this.max)},clone:function(){return(new THREE.Box2).copy(this)}};THREE.Box3=function(b,d){this.min=void 0!==b?b:new THREE.Vector3(Infinity,Infinity,Infinity);this.max=void 0!==d?d:new THREE.Vector3(-Infinity,-Infinity,-Infinity)};
THREE.Box3.prototype={constructor:THREE.Box3,set:function(b,d){this.min.copy(b);this.max.copy(d);return this},setFromPoints:function(b){if(0<b.length){var d=b[0];this.min.copy(d);this.max.copy(d);for(var c=1,e=b.length;c<e;c++)d=b[c],d.x<this.min.x?this.min.x=d.x:d.x>this.max.x&&(this.max.x=d.x),d.y<this.min.y?this.min.y=d.y:d.y>this.max.y&&(this.max.y=d.y),d.z<this.min.z?this.min.z=d.z:d.z>this.max.z&&(this.max.z=d.z)}else this.makeEmpty();return this},setFromCenterAndSize:function(){var b=new THREE.Vector3;
return function(d,c){var e=b.copy(c).multiplyScalar(0.5);this.min.copy(d).sub(e);this.max.copy(d).add(e);return this}}(),copy:function(b){this.min.copy(b.min);this.max.copy(b.max);return this},makeEmpty:function(){this.min.x=this.min.y=this.min.z=Infinity;this.max.x=this.max.y=this.max.z=-Infinity;return this},empty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},center:function(b){return(b||new THREE.Vector3).addVectors(this.min,this.max).multiplyScalar(0.5)},
size:function(b){return(b||new THREE.Vector3).subVectors(this.max,this.min)},expandByPoint:function(b){this.min.min(b);this.max.max(b);return this},expandByVector:function(b){this.min.sub(b);this.max.add(b);return this},expandByScalar:function(b){this.min.addScalar(-b);this.max.addScalar(b);return this},containsPoint:function(b){return b.x<this.min.x||b.x>this.max.x||b.y<this.min.y||b.y>this.max.y||b.z<this.min.z||b.z>this.max.z?!1:!0},containsBox:function(b){return this.min.x<=b.min.x&&b.max.x<=
this.max.x&&this.min.y<=b.min.y&&b.max.y<=this.max.y&&this.min.z<=b.min.z&&b.max.z<=this.max.z?!0:!1},getParameter:function(b){return new THREE.Vector3((b.x-this.min.x)/(this.max.x-this.min.x),(b.y-this.min.y)/(this.max.y-this.min.y),(b.z-this.min.z)/(this.max.z-this.min.z))},isIntersectionBox:function(b){return b.max.x<this.min.x||b.min.x>this.max.x||b.max.y<this.min.y||b.min.y>this.max.y||b.max.z<this.min.z||b.min.z>this.max.z?!1:!0},clampPoint:function(b,d){return(d||new THREE.Vector3).copy(b).clamp(this.min,
this.max)},distanceToPoint:function(){var b=new THREE.Vector3;return function(d){return b.copy(d).clamp(this.min,this.max).sub(d).length()}}(),getBoundingSphere:function(){var b=new THREE.Vector3;return function(d){d=d||new THREE.Sphere;d.center=this.center();d.radius=0.5*this.size(b).length();return d}}(),intersect:function(b){this.min.max(b.min);this.max.min(b.max);return this},union:function(b){this.min.min(b.min);this.max.max(b.max);return this},applyMatrix4:function(){var b=[new THREE.Vector3,
new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];return function(d){b[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(d);b[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(d);b[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(d);b[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(d);b[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(d);b[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(d);b[6].set(this.max.x,
this.max.y,this.min.z).applyMatrix4(d);b[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(d);this.makeEmpty();this.setFromPoints(b);return this}}(),translate:function(b){this.min.add(b);this.max.add(b);return this},equals:function(b){return b.min.equals(this.min)&&b.max.equals(this.max)},clone:function(){return(new THREE.Box3).copy(this)}};
THREE.Matrix3=function(b,d,c,e,f,g,h,k,l){this.elements=new Float32Array(9);this.set(void 0!==b?b:1,d||0,c||0,e||0,void 0!==f?f:1,g||0,h||0,k||0,void 0!==l?l:1)};
THREE.Matrix3.prototype={constructor:THREE.Matrix3,set:function(b,d,c,e,f,g,h,k,l){var p=this.elements;p[0]=b;p[3]=d;p[6]=c;p[1]=e;p[4]=f;p[7]=g;p[2]=h;p[5]=k;p[8]=l;return this},identity:function(){this.set(1,0,0,0,1,0,0,0,1);return this},copy:function(b){b=b.elements;this.set(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8]);return this},multiplyVector3:function(b){console.warn("DEPRECATED: Matrix3's .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead.");return b.applyMatrix3(this)},
multiplyVector3Array:function(){var b=new THREE.Vector3;return function(d){for(var c=0,e=d.length;c<e;c+=3)b.x=d[c],b.y=d[c+1],b.z=d[c+2],b.applyMatrix3(this),d[c]=b.x,d[c+1]=b.y,d[c+2]=b.z;return d}}(),multiplyScalar:function(b){var d=this.elements;d[0]*=b;d[3]*=b;d[6]*=b;d[1]*=b;d[4]*=b;d[7]*=b;d[2]*=b;d[5]*=b;d[8]*=b;return this},determinant:function(){var b=this.elements,d=b[0],c=b[1],e=b[2],f=b[3],g=b[4],h=b[5],k=b[6],l=b[7],b=b[8];return d*g*b-d*h*l-c*f*b+c*h*k+e*f*l-e*g*k},getInverse:function(b,
d){var c=b.elements,e=this.elements;e[0]=c[10]*c[5]-c[6]*c[9];e[1]=-c[10]*c[1]+c[2]*c[9];e[2]=c[6]*c[1]-c[2]*c[5];e[3]=-c[10]*c[4]+c[6]*c[8];e[4]=c[10]*c[0]-c[2]*c[8];e[5]=-c[6]*c[0]+c[2]*c[4];e[6]=c[9]*c[4]-c[5]*c[8];e[7]=-c[9]*c[0]+c[1]*c[8];e[8]=c[5]*c[0]-c[1]*c[4];c=c[0]*e[0]+c[1]*e[3]+c[2]*e[6];if(0===c){if(d)throw Error("Matrix3.getInverse(): can't invert matrix, determinant is 0");console.warn("Matrix3.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/
c);return this},transpose:function(){var b,d=this.elements;b=d[1];d[1]=d[3];d[3]=b;b=d[2];d[2]=d[6];d[6]=b;b=d[5];d[5]=d[7];d[7]=b;return this},getNormalMatrix:function(b){this.getInverse(b).transpose();return this},transposeIntoArray:function(b){var d=this.elements;b[0]=d[0];b[1]=d[3];b[2]=d[6];b[3]=d[1];b[4]=d[4];b[5]=d[7];b[6]=d[2];b[7]=d[5];b[8]=d[8];return this},clone:function(){var b=this.elements;return new THREE.Matrix3(b[0],b[3],b[6],b[1],b[4],b[7],b[2],b[5],b[8])}};
THREE.Matrix4=function(b,d,c,e,f,g,h,k,l,p,q,r,s,t,u,v){var w=this.elements=new Float32Array(16);w[0]=void 0!==b?b:1;w[4]=d||0;w[8]=c||0;w[12]=e||0;w[1]=f||0;w[5]=void 0!==g?g:1;w[9]=h||0;w[13]=k||0;w[2]=l||0;w[6]=p||0;w[10]=void 0!==q?q:1;w[14]=r||0;w[3]=s||0;w[7]=t||0;w[11]=u||0;w[15]=void 0!==v?v:1};
THREE.Matrix4.prototype={constructor:THREE.Matrix4,set:function(b,d,c,e,f,g,h,k,l,p,q,r,s,t,u,v){var w=this.elements;w[0]=b;w[4]=d;w[8]=c;w[12]=e;w[1]=f;w[5]=g;w[9]=h;w[13]=k;w[2]=l;w[6]=p;w[10]=q;w[14]=r;w[3]=s;w[7]=t;w[11]=u;w[15]=v;return this},identity:function(){this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return this},copy:function(b){b=b.elements;this.set(b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15]);return this},extractPosition:function(b){console.warn("DEPRECATED: Matrix4's .extractPosition() has been renamed to .copyPosition().");
return this.copyPosition(b)},copyPosition:function(b){var d=this.elements;b=b.elements;d[12]=b[12];d[13]=b[13];d[14]=b[14];return this},extractRotation:function(){var b=new THREE.Vector3;return function(d){var c=this.elements;d=d.elements;var e=1/b.set(d[0],d[1],d[2]).length(),f=1/b.set(d[4],d[5],d[6]).length(),g=1/b.set(d[8],d[9],d[10]).length();c[0]=d[0]*e;c[1]=d[1]*e;c[2]=d[2]*e;c[4]=d[4]*f;c[5]=d[5]*f;c[6]=d[6]*f;c[8]=d[8]*g;c[9]=d[9]*g;c[10]=d[10]*g;return this}}(),setRotationFromEuler:function(b,
d){console.warn("DEPRECATED: Matrix4's .setRotationFromEuler() has been deprecated in favor of makeRotationFromEuler.  Please update your code.");return this.makeRotationFromEuler(b,d)},makeRotationFromEuler:function(b,d){var c=this.elements,e=b.x,f=b.y,g=b.z,h=Math.cos(e),e=Math.sin(e),k=Math.cos(f),f=Math.sin(f),l=Math.cos(g),g=Math.sin(g);if(void 0===d||"XYZ"===d){var p=h*l,q=h*g,r=e*l,s=e*g;c[0]=k*l;c[4]=-k*g;c[8]=f;c[1]=q+r*f;c[5]=p-s*f;c[9]=-e*k;c[2]=s-p*f;c[6]=r+q*f;c[10]=h*k}else"YXZ"===d?
(p=k*l,q=k*g,r=f*l,s=f*g,c[0]=p+s*e,c[4]=r*e-q,c[8]=h*f,c[1]=h*g,c[5]=h*l,c[9]=-e,c[2]=q*e-r,c[6]=s+p*e,c[10]=h*k):"ZXY"===d?(p=k*l,q=k*g,r=f*l,s=f*g,c[0]=p-s*e,c[4]=-h*g,c[8]=r+q*e,c[1]=q+r*e,c[5]=h*l,c[9]=s-p*e,c[2]=-h*f,c[6]=e,c[10]=h*k):"ZYX"===d?(p=h*l,q=h*g,r=e*l,s=e*g,c[0]=k*l,c[4]=r*f-q,c[8]=p*f+s,c[1]=k*g,c[5]=s*f+p,c[9]=q*f-r,c[2]=-f,c[6]=e*k,c[10]=h*k):"YZX"===d?(p=h*k,q=h*f,r=e*k,s=e*f,c[0]=k*l,c[4]=s-p*g,c[8]=r*g+q,c[1]=g,c[5]=h*l,c[9]=-e*l,c[2]=-f*l,c[6]=q*g+r,c[10]=p-s*g):"XZY"===d&&
(p=h*k,q=h*f,r=e*k,s=e*f,c[0]=k*l,c[4]=-g,c[8]=f*l,c[1]=p*g+s,c[5]=h*l,c[9]=q*g-r,c[2]=r*g-q,c[6]=e*l,c[10]=s*g+p);c[3]=0;c[7]=0;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return this},setRotationFromQuaternion:function(b){console.warn("DEPRECATED: Matrix4's .setRotationFromQuaternion() has been deprecated in favor of makeRotationFromQuaternion.  Please update your code.");return this.makeRotationFromQuaternion(b)},makeRotationFromQuaternion:function(b){var d=this.elements,c=b.x,e=b.y,f=b.z,g=b.w,h=
c+c,k=e+e,l=f+f;b=c*h;var p=c*k,c=c*l,q=e*k,e=e*l,f=f*l,h=g*h,k=g*k,g=g*l;d[0]=1-(q+f);d[4]=p-g;d[8]=c+k;d[1]=p+g;d[5]=1-(b+f);d[9]=e-h;d[2]=c-k;d[6]=e+h;d[10]=1-(b+q);d[3]=0;d[7]=0;d[11]=0;d[12]=0;d[13]=0;d[14]=0;d[15]=1;return this},lookAt:function(){var b=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3;return function(e,f,g){var h=this.elements;c.subVectors(e,f).normalize();0===c.length()&&(c.z=1);b.crossVectors(g,c).normalize();0===b.length()&&(c.x+=1E-4,b.crossVectors(g,c).normalize());
d.crossVectors(c,b);h[0]=b.x;h[4]=d.x;h[8]=c.x;h[1]=b.y;h[5]=d.y;h[9]=c.y;h[2]=b.z;h[6]=d.z;h[10]=c.z;return this}}(),multiply:function(b,d){return void 0!==d?(console.warn("DEPRECATED: Matrix4's .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(b,d)):this.multiplyMatrices(this,b)},multiplyMatrices:function(b,d){var c=b.elements,e=d.elements,f=this.elements,g=c[0],h=c[4],k=c[8],l=c[12],p=c[1],q=c[5],r=c[9],s=c[13],t=c[2],u=c[6],v=c[10],w=c[14],
y=c[3],z=c[7],B=c[11],c=c[15],A=e[0],K=e[4],O=e[8],E=e[12],F=e[1],U=e[5],H=e[9],G=e[13],aa=e[2],D=e[6],M=e[10],I=e[14],Q=e[3],V=e[7],C=e[11],e=e[15];f[0]=g*A+h*F+k*aa+l*Q;f[4]=g*K+h*U+k*D+l*V;f[8]=g*O+h*H+k*M+l*C;f[12]=g*E+h*G+k*I+l*e;f[1]=p*A+q*F+r*aa+s*Q;f[5]=p*K+q*U+r*D+s*V;f[9]=p*O+q*H+r*M+s*C;f[13]=p*E+q*G+r*I+s*e;f[2]=t*A+u*F+v*aa+w*Q;f[6]=t*K+u*U+v*D+w*V;f[10]=t*O+u*H+v*M+w*C;f[14]=t*E+u*G+v*I+w*e;f[3]=y*A+z*F+B*aa+c*Q;f[7]=y*K+z*U+B*D+c*V;f[11]=y*O+z*H+B*M+c*C;f[15]=y*E+z*G+B*I+c*e;return this},
multiplyToArray:function(b,d,c){var e=this.elements;this.multiplyMatrices(b,d);c[0]=e[0];c[1]=e[1];c[2]=e[2];c[3]=e[3];c[4]=e[4];c[5]=e[5];c[6]=e[6];c[7]=e[7];c[8]=e[8];c[9]=e[9];c[10]=e[10];c[11]=e[11];c[12]=e[12];c[13]=e[13];c[14]=e[14];c[15]=e[15];return this},multiplyScalar:function(b){var d=this.elements;d[0]*=b;d[4]*=b;d[8]*=b;d[12]*=b;d[1]*=b;d[5]*=b;d[9]*=b;d[13]*=b;d[2]*=b;d[6]*=b;d[10]*=b;d[14]*=b;d[3]*=b;d[7]*=b;d[11]*=b;d[15]*=b;return this},multiplyVector3:function(b){console.warn("DEPRECATED: Matrix4's .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) or vector.applyProjection( matrix ) instead.");
return b.applyProjection(this)},multiplyVector4:function(b){console.warn("DEPRECATED: Matrix4's .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead.");return b.applyMatrix4(this)},multiplyVector3Array:function(){var b=new THREE.Vector3;return function(d){for(var c=0,e=d.length;c<e;c+=3)b.x=d[c],b.y=d[c+1],b.z=d[c+2],b.applyProjection(this),d[c]=b.x,d[c+1]=b.y,d[c+2]=b.z;return d}}(),rotateAxis:function(b){console.warn("DEPRECATED: Matrix4's .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead.");
b.transformDirection(this)},crossVector:function(b){console.warn("DEPRECATED: Matrix4's .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead.");return b.applyMatrix4(this)},determinant:function(){var b=this.elements,d=b[0],c=b[4],e=b[8],f=b[12],g=b[1],h=b[5],k=b[9],l=b[13],p=b[2],q=b[6],r=b[10],s=b[14];return b[3]*(+f*k*q-e*l*q-f*h*r+c*l*r+e*h*s-c*k*s)+b[7]*(+d*k*s-d*l*r+f*g*r-e*g*s+e*l*p-f*k*p)+b[11]*(+d*l*q-d*h*s-f*g*q+c*g*s+f*h*p-c*l*p)+b[15]*(-e*h*p-d*k*q+d*h*r+e*g*q-c*g*
r+c*k*p)},transpose:function(){var b=this.elements,d;d=b[1];b[1]=b[4];b[4]=d;d=b[2];b[2]=b[8];b[8]=d;d=b[6];b[6]=b[9];b[9]=d;d=b[3];b[3]=b[12];b[12]=d;d=b[7];b[7]=b[13];b[13]=d;d=b[11];b[11]=b[14];b[14]=d;return this},flattenToArray:function(b){var d=this.elements;b[0]=d[0];b[1]=d[1];b[2]=d[2];b[3]=d[3];b[4]=d[4];b[5]=d[5];b[6]=d[6];b[7]=d[7];b[8]=d[8];b[9]=d[9];b[10]=d[10];b[11]=d[11];b[12]=d[12];b[13]=d[13];b[14]=d[14];b[15]=d[15];return b},flattenToArrayOffset:function(b,d){var c=this.elements;
b[d]=c[0];b[d+1]=c[1];b[d+2]=c[2];b[d+3]=c[3];b[d+4]=c[4];b[d+5]=c[5];b[d+6]=c[6];b[d+7]=c[7];b[d+8]=c[8];b[d+9]=c[9];b[d+10]=c[10];b[d+11]=c[11];b[d+12]=c[12];b[d+13]=c[13];b[d+14]=c[14];b[d+15]=c[15];return b},getPosition:function(){var b=new THREE.Vector3;return function(){console.warn("DEPRECATED: Matrix4's .getPosition() has been removed. Use Vector3.getPositionFromMatrix( matrix ) instead.");var d=this.elements;return b.set(d[12],d[13],d[14])}}(),setPosition:function(b){var d=this.elements;
d[12]=b.x;d[13]=b.y;d[14]=b.z;return this},getInverse:function(b,d){var c=this.elements,e=b.elements,f=e[0],g=e[4],h=e[8],k=e[12],l=e[1],p=e[5],q=e[9],r=e[13],s=e[2],t=e[6],u=e[10],v=e[14],w=e[3],y=e[7],z=e[11],B=e[15];c[0]=q*v*y-r*u*y+r*t*z-p*v*z-q*t*B+p*u*B;c[4]=k*u*y-h*v*y-k*t*z+g*v*z+h*t*B-g*u*B;c[8]=h*r*y-k*q*y+k*p*z-g*r*z-h*p*B+g*q*B;c[12]=k*q*t-h*r*t-k*p*u+g*r*u+h*p*v-g*q*v;c[1]=r*u*w-q*v*w-r*s*z+l*v*z+q*s*B-l*u*B;c[5]=h*v*w-k*u*w+k*s*z-f*v*z-h*s*B+f*u*B;c[9]=k*q*w-h*r*w-k*l*z+f*r*z+h*l*B-
f*q*B;c[13]=h*r*s-k*q*s+k*l*u-f*r*u-h*l*v+f*q*v;c[2]=p*v*w-r*t*w+r*s*y-l*v*y-p*s*B+l*t*B;c[6]=k*t*w-g*v*w-k*s*y+f*v*y+g*s*B-f*t*B;c[10]=g*r*w-k*p*w+k*l*y-f*r*y-g*l*B+f*p*B;c[14]=k*p*s-g*r*s-k*l*t+f*r*t+g*l*v-f*p*v;c[3]=q*t*w-p*u*w-q*s*y+l*u*y+p*s*z-l*t*z;c[7]=g*u*w-h*t*w+h*s*y-f*u*y-g*s*z+f*t*z;c[11]=h*p*w-g*q*w-h*l*y+f*q*y+g*l*z-f*p*z;c[15]=g*q*s-h*p*s+h*l*t-f*q*t-g*l*u+f*p*u;c=e[0]*c[0]+e[1]*c[4]+e[2]*c[8]+e[3]*c[12];if(0==c){if(d)throw Error("Matrix4.getInverse(): can't invert matrix, determinant is 0");
console.warn("Matrix4.getInverse(): can't invert matrix, determinant is 0");this.identity();return this}this.multiplyScalar(1/c);return this},translate:function(){console.warn("DEPRECATED: Matrix4's .translate() has been removed.")},rotateX:function(){console.warn("DEPRECATED: Matrix4's .rotateX() has been removed.")},rotateY:function(){console.warn("DEPRECATED: Matrix4's .rotateY() has been removed.")},rotateZ:function(){console.warn("DEPRECATED: Matrix4's .rotateZ() has been removed.")},rotateByAxis:function(){console.warn("DEPRECATED: Matrix4's .rotateByAxis() has been removed.")},
scale:function(b){var d=this.elements,c=b.x,e=b.y;b=b.z;d[0]*=c;d[4]*=e;d[8]*=b;d[1]*=c;d[5]*=e;d[9]*=b;d[2]*=c;d[6]*=e;d[10]*=b;d[3]*=c;d[7]*=e;d[11]*=b;return this},getMaxScaleOnAxis:function(){var b=this.elements;return Math.sqrt(Math.max(b[0]*b[0]+b[1]*b[1]+b[2]*b[2],Math.max(b[4]*b[4]+b[5]*b[5]+b[6]*b[6],b[8]*b[8]+b[9]*b[9]+b[10]*b[10])))},makeTranslation:function(b,d,c){this.set(1,0,0,b,0,1,0,d,0,0,1,c,0,0,0,1);return this},makeRotationX:function(b){var d=Math.cos(b);b=Math.sin(b);this.set(1,
0,0,0,0,d,-b,0,0,b,d,0,0,0,0,1);return this},makeRotationY:function(b){var d=Math.cos(b);b=Math.sin(b);this.set(d,0,b,0,0,1,0,0,-b,0,d,0,0,0,0,1);return this},makeRotationZ:function(b){var d=Math.cos(b);b=Math.sin(b);this.set(d,-b,0,0,b,d,0,0,0,0,1,0,0,0,0,1);return this},makeRotationAxis:function(b,d){var c=Math.cos(d),e=Math.sin(d),f=1-c,g=b.x,h=b.y,k=b.z,l=f*g,p=f*h;this.set(l*g+c,l*h-e*k,l*k+e*h,0,l*h+e*k,p*h+c,p*k-e*g,0,l*k-e*h,p*k+e*g,f*k*k+c,0,0,0,0,1);return this},makeScale:function(b,d,c){this.set(b,
0,0,0,0,d,0,0,0,0,c,0,0,0,0,1);return this},compose:function(b,d,c){console.warn("DEPRECATED: Matrix4's .compose() has been deprecated in favor of makeFromPositionQuaternionScale. Please update your code.");return this.makeFromPositionQuaternionScale(b,d,c)},makeFromPositionQuaternionScale:function(b,d,c){this.makeRotationFromQuaternion(d);this.scale(c);this.setPosition(b);return this},makeFromPositionEulerScale:function(b,d,c,e){this.makeRotationFromEuler(d,c);this.scale(e);this.setPosition(b);return this},
makeFrustum:function(b,d,c,e,f,g){var h=this.elements;h[0]=2*f/(d-b);h[4]=0;h[8]=(d+b)/(d-b);h[12]=0;h[1]=0;h[5]=2*f/(e-c);h[9]=(e+c)/(e-c);h[13]=0;h[2]=0;h[6]=0;h[10]=-(g+f)/(g-f);h[14]=-2*g*f/(g-f);h[3]=0;h[7]=0;h[11]=-1;h[15]=0;return this},makePerspective:function(b,d,c,e){b=c*Math.tan(THREE.Math.degToRad(0.5*b));var f=-b;return this.makeFrustum(f*d,b*d,f,b,c,e)},makeOrthographic:function(b,d,c,e,f,g){var h=this.elements,k=d-b,l=c-e,p=g-f;h[0]=2/k;h[4]=0;h[8]=0;h[12]=-((d+b)/k);h[1]=0;h[5]=2/
l;h[9]=0;h[13]=-((c+e)/l);h[2]=0;h[6]=0;h[10]=-2/p;h[14]=-((g+f)/p);h[3]=0;h[7]=0;h[11]=0;h[15]=1;return this},clone:function(){var b=this.elements;return new THREE.Matrix4(b[0],b[4],b[8],b[12],b[1],b[5],b[9],b[13],b[2],b[6],b[10],b[14],b[3],b[7],b[11],b[15])}};
THREE.extend(THREE.Matrix4.prototype,{decompose:function(){var b=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3,e=new THREE.Matrix4;return function(f,g,h){var k=this.elements;b.set(k[0],k[1],k[2]);d.set(k[4],k[5],k[6]);c.set(k[8],k[9],k[10]);f=f instanceof THREE.Vector3?f:new THREE.Vector3;g=g instanceof THREE.Quaternion?g:new THREE.Quaternion;h=h instanceof THREE.Vector3?h:new THREE.Vector3;h.x=b.length();h.y=d.length();h.z=c.length();f.x=k[12];f.y=k[13];f.z=k[14];e.copy(this);e.elements[0]/=
h.x;e.elements[1]/=h.x;e.elements[2]/=h.x;e.elements[4]/=h.y;e.elements[5]/=h.y;e.elements[6]/=h.y;e.elements[8]/=h.z;e.elements[9]/=h.z;e.elements[10]/=h.z;g.setFromRotationMatrix(e);return[f,g,h]}}()});THREE.Ray=function(b,d){this.origin=void 0!==b?b:new THREE.Vector3;this.direction=void 0!==d?d:new THREE.Vector3};
THREE.Ray.prototype={constructor:THREE.Ray,set:function(b,d){this.origin.copy(b);this.direction.copy(d);return this},copy:function(b){this.origin.copy(b.origin);this.direction.copy(b.direction);return this},at:function(b,d){return(d||new THREE.Vector3).copy(this.direction).multiplyScalar(b).add(this.origin)},recast:function(){var b=new THREE.Vector3;return function(d){this.origin.copy(this.at(d,b));return this}}(),closestPointToPoint:function(b,d){var c=d||new THREE.Vector3;c.subVectors(b,this.origin);
var e=c.dot(this.direction);return c.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(){var b=new THREE.Vector3;return function(d){var c=b.subVectors(d,this.origin).dot(this.direction);b.copy(this.direction).multiplyScalar(c).add(this.origin);return b.distanceTo(d)}}(),isIntersectionSphere:function(b){return this.distanceToPoint(b.center)<=b.radius},isIntersectionPlane:function(b){return 0!=b.normal.dot(this.direction)||0==b.distanceToPoint(this.origin)?!0:!1},distanceToPlane:function(b){var d=
b.normal.dot(this.direction);if(0==d){if(0==b.distanceToPoint(this.origin))return 0}else return-(this.origin.dot(b.normal)+b.constant)/d},intersectPlane:function(b,d){var c=this.distanceToPlane(b);return void 0===c?void 0:this.at(c,d)},applyMatrix4:function(b){this.direction.add(this.origin).applyMatrix4(b);this.origin.applyMatrix4(b);this.direction.sub(this.origin);return this},equals:function(b){return b.origin.equals(this.origin)&&b.direction.equals(this.direction)},clone:function(){return(new THREE.Ray).copy(this)}};
THREE.Sphere=function(b,d){this.center=void 0!==b?b:new THREE.Vector3;this.radius=void 0!==d?d:0};
THREE.Sphere.prototype={constructor:THREE.Sphere,set:function(b,d){this.center.copy(b);this.radius=d;return this},setFromCenterAndPoints:function(b,d){for(var c=0,e=0,f=d.length;e<f;e++)var g=b.distanceToSquared(d[e]),c=Math.max(c,g);this.center=b;this.radius=Math.sqrt(c);return this},copy:function(b){this.center.copy(b.center);this.radius=b.radius;return this},empty:function(){return 0>=this.radius},containsPoint:function(b){return b.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(b){return b.distanceTo(this.center)-
this.radius},intersectsSphere:function(b){var d=this.radius+b.radius;return b.center.distanceToSquared(this.center)<=d*d},clampPoint:function(b,d){var c=this.center.distanceToSquared(b),e=d||new THREE.Vector3;e.copy(b);c>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center));return e},getBoundingBox:function(b){b=b||new THREE.Box3;b.set(this.center,this.center);b.expandByScalar(this.radius);return b},applyMatrix4:function(b){this.center.applyMatrix4(b);
this.radius*=b.getMaxScaleOnAxis();return this},translate:function(b){this.center.add(b);return this},equals:function(b){return b.center.equals(this.center)&&b.radius===this.radius},clone:function(){return(new THREE.Sphere).copy(this)}};THREE.Frustum=function(b,d,c,e,f,g){this.planes=[void 0!==b?b:new THREE.Plane,void 0!==d?d:new THREE.Plane,void 0!==c?c:new THREE.Plane,void 0!==e?e:new THREE.Plane,void 0!==f?f:new THREE.Plane,void 0!==g?g:new THREE.Plane]};
THREE.Frustum.prototype={constructor:THREE.Frustum,set:function(b,d,c,e,f,g){var h=this.planes;h[0].copy(b);h[1].copy(d);h[2].copy(c);h[3].copy(e);h[4].copy(f);h[5].copy(g);return this},copy:function(b){for(var d=this.planes,c=0;6>c;c++)d[c].copy(b.planes[c]);return this},setFromMatrix:function(b){var d=this.planes,c=b.elements;b=c[0];var e=c[1],f=c[2],g=c[3],h=c[4],k=c[5],l=c[6],p=c[7],q=c[8],r=c[9],s=c[10],t=c[11],u=c[12],v=c[13],w=c[14],c=c[15];d[0].setComponents(g-b,p-h,t-q,c-u).normalize();d[1].setComponents(g+
b,p+h,t+q,c+u).normalize();d[2].setComponents(g+e,p+k,t+r,c+v).normalize();d[3].setComponents(g-e,p-k,t-r,c-v).normalize();d[4].setComponents(g-f,p-l,t-s,c-w).normalize();d[5].setComponents(g+f,p+l,t+s,c+w).normalize();return this},intersectsObject:function(){var b=new THREE.Vector3;return function(d){var c=d.matrixWorld,e=this.planes;d=-d.geometry.boundingSphere.radius*c.getMaxScaleOnAxis();b.getPositionFromMatrix(c);for(c=0;6>c;c++)if(e[c].distanceToPoint(b)<d)return!1;return!0}}(),intersectsSphere:function(b){var d=
this.planes,c=b.center;b=-b.radius;for(var e=0;6>e;e++)if(d[e].distanceToPoint(c)<b)return!1;return!0},containsPoint:function(b){for(var d=this.planes,c=0;6>c;c++)if(0>d[c].distanceToPoint(b))return!1;return!0},clone:function(){return(new THREE.Frustum).copy(this)}};THREE.Plane=function(b,d){this.normal=void 0!==b?b:new THREE.Vector3(1,0,0);this.constant=void 0!==d?d:0};
THREE.Plane.prototype={constructor:THREE.Plane,set:function(b,d){this.normal.copy(b);this.constant=d;return this},setComponents:function(b,d,c,e){this.normal.set(b,d,c);this.constant=e;return this},setFromNormalAndCoplanarPoint:function(b,d){this.normal.copy(b);this.constant=-d.dot(this.normal);return this},setFromCoplanarPoints:function(){var b=new THREE.Vector3,d=new THREE.Vector3;return function(c,e,f){e=b.subVectors(f,e).cross(d.subVectors(c,e)).normalize();this.setFromNormalAndCoplanarPoint(e,
c);return this}}(),copy:function(b){this.normal.copy(b.normal);this.constant=b.constant;return this},normalize:function(){var b=1/this.normal.length();this.normal.multiplyScalar(b);this.constant*=b;return this},negate:function(){this.constant*=-1;this.normal.negate();return this},distanceToPoint:function(b){return this.normal.dot(b)+this.constant},distanceToSphere:function(b){return this.distanceToPoint(b.center)-b.radius},projectPoint:function(b,d){return this.orthoPoint(b,d).sub(b).negate()},orthoPoint:function(b,
d){var c=this.distanceToPoint(b);return(d||new THREE.Vector3).copy(this.normal).multiplyScalar(c)},isIntersectionLine:function(b){var d=this.distanceToPoint(b.start);b=this.distanceToPoint(b.end);return 0>d&&0<b||0>b&&0<d},intersectLine:function(){var b=new THREE.Vector3;return function(d,c){var e=c||new THREE.Vector3,f=d.delta(b),g=this.normal.dot(f);if(0==g){if(0==this.distanceToPoint(d.start))return e.copy(d.start)}else return g=-(d.start.dot(this.normal)+this.constant)/g,0>g||1<g?void 0:e.copy(f).multiplyScalar(g).add(d.start)}}(),
coplanarPoint:function(b){return(b||new THREE.Vector3).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var b=new THREE.Vector3,d=new THREE.Vector3;return function(c,e){e=e||(new THREE.Matrix3).getNormalMatrix(c);var f=b.copy(this.normal).applyMatrix3(e),g=this.coplanarPoint(d);g.applyMatrix4(c);this.setFromNormalAndCoplanarPoint(f,g);return this}}(),translate:function(b){this.constant-=b.dot(this.normal);return this},equals:function(b){return b.normal.equals(this.normal)&&
b.constant==this.constant},clone:function(){return(new THREE.Plane).copy(this)}};
THREE.Math={clamp:function(b,d,c){return b<d?d:b>c?c:b},clampBottom:function(b,d){return b<d?d:b},mapLinear:function(b,d,c,e,f){return e+(b-d)*(f-e)/(c-d)},smoothstep:function(b,d,c){if(b<=d)return 0;if(b>=c)return 1;b=(b-d)/(c-d);return b*b*(3-2*b)},smootherstep:function(b,d,c){if(b<=d)return 0;if(b>=c)return 1;b=(b-d)/(c-d);return b*b*b*(b*(6*b-15)+10)},random16:function(){return(65280*Math.random()+255*Math.random())/65535},randInt:function(b,d){return b+Math.floor(Math.random()*(d-b+1))},randFloat:function(b,
d){return b+Math.random()*(d-b)},randFloatSpread:function(b){return b*(0.5-Math.random())},sign:function(b){return 0>b?-1:0<b?1:0},degToRad:function(){var b=Math.PI/180;return function(d){return d*b}}(),radToDeg:function(){var b=180/Math.PI;return function(d){return d*b}}()};
THREE.Spline=function(b){function d(b,c,e,d,f,g,h){b=0.5*(e-b);d=0.5*(d-c);return(2*(c-e)+b+d)*h+(-3*(c-e)-2*b-d)*g+b*f+c}this.points=b;var c=[],e={x:0,y:0,z:0},f,g,h,k,l,p,q,r,s;this.initFromArray=function(b){this.points=[];for(var c=0;c<b.length;c++)this.points[c]={x:b[c][0],y:b[c][1],z:b[c][2]}};this.getPoint=function(b){f=(this.points.length-1)*b;g=Math.floor(f);h=f-g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>this.points.length-2?this.points.length-1:g+1;c[3]=g>this.points.length-3?this.points.length-1:
g+2;p=this.points[c[0]];q=this.points[c[1]];r=this.points[c[2]];s=this.points[c[3]];k=h*h;l=h*k;e.x=d(p.x,q.x,r.x,s.x,h,k,l);e.y=d(p.y,q.y,r.y,s.y,h,k,l);e.z=d(p.z,q.z,r.z,s.z,h,k,l);return e};this.getControlPointsArray=function(){var b,c,e=this.points.length,d=[];for(b=0;b<e;b++)c=this.points[b],d[b]=[c.x,c.y,c.z];return d};this.getLength=function(b){var c,e,d,f=0,g=new THREE.Vector3,h=new THREE.Vector3,k=[],l=0;k[0]=0;b||(b=100);e=this.points.length*b;g.copy(this.points[0]);for(b=1;b<e;b++)c=b/
e,d=this.getPoint(c),h.copy(d),l+=h.distanceTo(g),g.copy(d),c*=this.points.length-1,c=Math.floor(c),c!=f&&(k[c]=l,f=c);k[k.length]=l;return{chunks:k,total:l}};this.reparametrizeByArcLength=function(b){var c,e,d,f,g,h,k=[],l=new THREE.Vector3,p=this.getLength();k.push(l.copy(this.points[0]).clone());for(c=1;c<this.points.length;c++){e=p.chunks[c]-p.chunks[c-1];h=Math.ceil(b*e/p.total);f=(c-1)/(this.points.length-1);g=c/(this.points.length-1);for(e=1;e<h-1;e++)d=f+e*(1/h)*(g-f),d=this.getPoint(d),k.push(l.copy(d).clone());
k.push(l.copy(this.points[c]).clone())}this.points=k}};THREE.Triangle=function(b,d,c){this.a=void 0!==b?b:new THREE.Vector3;this.b=void 0!==d?d:new THREE.Vector3;this.c=void 0!==c?c:new THREE.Vector3};THREE.Triangle.normal=function(){var b=new THREE.Vector3;return function(d,c,e,f){f=f||new THREE.Vector3;f.subVectors(e,c);b.subVectors(d,c);f.cross(b);d=f.lengthSq();return 0<d?f.multiplyScalar(1/Math.sqrt(d)):f.set(0,0,0)}}();
THREE.Triangle.barycoordFromPoint=function(){var b=new THREE.Vector3,d=new THREE.Vector3,c=new THREE.Vector3;return function(e,f,g,h,k){b.subVectors(h,f);d.subVectors(g,f);c.subVectors(e,f);e=b.dot(b);f=b.dot(d);g=b.dot(c);var l=d.dot(d);h=d.dot(c);var p=e*l-f*f;k=k||new THREE.Vector3;if(0==p)return k.set(-2,-1,-1);p=1/p;l=(l*g-f*h)*p;e=(e*h-f*g)*p;return k.set(1-l-e,e,l)}}();
THREE.Triangle.containsPoint=function(){var b=new THREE.Vector3;return function(d,c,e,f){d=THREE.Triangle.barycoordFromPoint(d,c,e,f,b);return 0<=d.x&&0<=d.y&&1>=d.x+d.y}}();
THREE.Triangle.prototype={constructor:THREE.Triangle,set:function(b,d,c){this.a.copy(b);this.b.copy(d);this.c.copy(c);return this},setFromPointsAndIndices:function(b,d,c,e){this.a.copy(b[d]);this.b.copy(b[c]);this.c.copy(b[e]);return this},copy:function(b){this.a.copy(b.a);this.b.copy(b.b);this.c.copy(b.c);return this},area:function(){var b=new THREE.Vector3,d=new THREE.Vector3;return function(){b.subVectors(this.c,this.b);d.subVectors(this.a,this.b);return 0.5*b.cross(d).length()}}(),midpoint:function(b){return(b||
new THREE.Vector3).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(b){return THREE.Triangle.normal(this.a,this.b,this.c,b)},plane:function(b){return(b||new THREE.Plane).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(b,d){return THREE.Triangle.barycoordFromPoint(b,this.a,this.b,this.c,d)},containsPoint:function(b){return THREE.Triangle.containsPoint(b,this.a,this.b,this.c)},equals:function(b){return b.a.equals(this.a)&&b.b.equals(this.b)&&b.c.equals(this.c)},
clone:function(){return(new THREE.Triangle).copy(this)}};THREE.Vertex=function(b){console.warn("THREE.Vertex has been DEPRECATED. Use THREE.Vector3 instead.");return b};THREE.UV=function(b,d){console.warn("THREE.UV has been DEPRECATED. Use THREE.Vector2 instead.");return new THREE.Vector2(b,d)};THREE.Clock=function(b){this.autoStart=void 0!==b?b:!0;this.elapsedTime=this.oldTime=this.startTime=0;this.running=!1};
THREE.Clock.prototype={constructor:THREE.Clock,start:function(){this.oldTime=this.startTime=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();this.running=!0},stop:function(){this.getElapsedTime();this.running=!1},getElapsedTime:function(){this.getDelta();return this.elapsedTime},getDelta:function(){var b=0;this.autoStart&&!this.running&&this.start();if(this.running){var d=void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():
Date.now(),b=0.001*(d-this.oldTime);this.oldTime=d;this.elapsedTime+=b}return b}};THREE.EventDispatcher=function(){};
THREE.EventDispatcher.prototype={constructor:THREE.EventDispatcher,addEventListener:function(b,d){void 0===this._listeners&&(this._listeners={});var c=this._listeners;void 0===c[b]&&(c[b]=[]);-1===c[b].indexOf(d)&&c[b].push(d)},hasEventListener:function(b,d){if(void 0===this._listeners)return!1;var c=this._listeners;return void 0!==c[b]&&-1!==c[b].indexOf(d)?!0:!1},removeEventListener:function(b,d){if(void 0!==this._listeners){var c=this._listeners,e=c[b].indexOf(d);-1!==e&&c[b].splice(e,1)}},dispatchEvent:function(b){if(void 0!==
this._listeners){var d=this._listeners[b.type];if(void 0!==d){b.target=this;for(var c=0,e=d.length;c<e;c++)d[c].call(this,b)}}}};
(function(b){b.Raycaster=function(c,e,d,f){this.ray=new b.Ray(c,e);0<this.ray.direction.lengthSq()&&this.ray.direction.normalize();this.near=d||0;this.far=f||Infinity};var d=new b.Sphere,c=new b.Ray,e=new b.Plane,f=new b.Vector3,g=new b.Vector3,h=new b.Matrix4,k=function(b,c){return b.distance-c.distance},l=function(k,p,s){if(k instanceof b.Particle){g.getPositionFromMatrix(k.matrixWorld);var t=p.ray.distanceToPoint(g);if(t>k.scale.x)return s;s.push({distance:t,point:k.position,face:null,object:k})}else if(k instanceof
b.LOD)g.getPositionFromMatrix(k.matrixWorld),t=p.ray.origin.distanceTo(g),l(k.getObjectForDistance(t),p,s);else if(k instanceof b.Mesh){g.getPositionFromMatrix(k.matrixWorld);d.set(g,k.geometry.boundingSphere.radius*k.matrixWorld.getMaxScaleOnAxis());if(!p.ray.isIntersectionSphere(d))return s;var t=k.geometry,u=t.vertices,v=k.material instanceof b.MeshFaceMaterial,w=!0===v?k.material.materials:null,y=k.material.side,z,B,A,K=p.precision;h.getInverse(k.matrixWorld);c.copy(p.ray).applyMatrix4(h);for(var O=
0,E=t.faces.length;O<E;O++){var F=t.faces[O],y=!0===v?w[F.materialIndex]:k.material;if(void 0!==y){e.setFromNormalAndCoplanarPoint(F.normal,u[F.a]);var U=c.distanceToPlane(e);if(!(Math.abs(U)<K)&&!(0>U)&&(y=y.side,!(y!==b.DoubleSide&&(z=c.direction.dot(e.normal),!(y===b.FrontSide?0>z:0<z)))))if(!(U<p.near||U>p.far)){f=c.at(U,f);if(F instanceof b.Face3){if(y=u[F.a],z=u[F.b],B=u[F.c],!b.Triangle.containsPoint(f,y,z,B))continue}else if(F instanceof b.Face4){if(y=u[F.a],z=u[F.b],B=u[F.c],A=u[F.d],!b.Triangle.containsPoint(f,
y,z,A)&&!b.Triangle.containsPoint(f,z,B,A))continue}else throw Error("face type not supported");s.push({distance:U,point:p.ray.at(U),face:F,faceIndex:O,object:k})}}}}},p=function(b,c,e){b=b.getDescendants();for(var d=0,f=b.length;d<f;d++)l(b[d],c,e)};b.Raycaster.prototype.precision=1E-4;b.Raycaster.prototype.set=function(b,c){this.ray.set(b,c);0<this.ray.direction.length()&&this.ray.direction.normalize()};b.Raycaster.prototype.intersectObject=function(b,c){var e=[];!0===c&&p(b,this,e);l(b,this,e);
e.sort(k);return e};b.Raycaster.prototype.intersectObjects=function(b,c){for(var e=[],d=0,f=b.length;d<f;d++)l(b[d],this,e),!0===c&&p(b[d],this,e);e.sort(k);return e}})(THREE);
THREE.Object3D=function(){this.id=THREE.Object3DIdCount++;this.name="";this.parent=void 0;this.children=[];this.up=new THREE.Vector3(0,1,0);this.position=new THREE.Vector3;this.rotation=new THREE.Vector3;this.eulerOrder=THREE.Object3D.defaultEulerOrder;this.scale=new THREE.Vector3(1,1,1);this.renderDepth=null;this.rotationAutoUpdate=!0;this.matrix=new THREE.Matrix4;this.matrixWorld=new THREE.Matrix4;this.matrixWorldNeedsUpdate=this.matrixAutoUpdate=!0;this.quaternion=new THREE.Quaternion;this.useQuaternion=
!1;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.userData={}};
THREE.Object3D.prototype={constructor:THREE.Object3D,applyMatrix:function(){var b=new THREE.Matrix4;return function(d){this.matrix.multiplyMatrices(d,this.matrix);this.position.getPositionFromMatrix(this.matrix);this.scale.getScaleFromMatrix(this.matrix);b.extractRotation(this.matrix);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(b):this.rotation.setEulerFromRotationMatrix(b,this.eulerOrder)}}(),rotateOnAxis:function(){var b=new THREE.Quaternion,d=new THREE.Quaternion;return function(c,
e){b.setFromAxisAngle(c,e);!0===this.useQuaternion?this.quaternion.multiply(b):(d.setFromEuler(this.rotation,this.eulerOrder),d.multiply(b),this.rotation.setEulerFromQuaternion(d,this.eulerOrder));return this}}(),translateOnAxis:function(){var b=new THREE.Vector3;return function(d,c){b.copy(d);!0===this.useQuaternion?b.applyQuaternion(this.quaternion):b.applyEuler(this.rotation,this.eulerOrder);this.position.add(b.multiplyScalar(c));return this}}(),translate:function(b,d){console.warn("DEPRECATED: Object3D's .translate() has been removed. Use .translateOnAxis( axis, distance ) instead. Note args have been changed.");
return this.translateOnAxis(d,b)},translateX:function(){var b=new THREE.Vector3(1,0,0);return function(d){return this.translateOnAxis(b,d)}}(),translateY:function(){var b=new THREE.Vector3(0,1,0);return function(d){return this.translateOnAxis(b,d)}}(),translateZ:function(){var b=new THREE.Vector3(0,0,1);return function(d){return this.translateOnAxis(b,d)}}(),localToWorld:function(b){return b.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var b=new THREE.Matrix4;return function(d){return d.applyMatrix4(b.getInverse(this.matrixWorld))}}(),
lookAt:function(){var b=new THREE.Matrix4;return function(d){b.lookAt(d,this.position,this.up);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(b):this.rotation.setEulerFromRotationMatrix(b,this.eulerOrder)}}(),add:function(b){if(b===this)console.warn("THREE.Object3D.add: An object can't be added as a child of itself.");else if(b instanceof THREE.Object3D){void 0!==b.parent&&b.parent.remove(b);b.parent=this;this.children.push(b);for(var d=this;void 0!==d.parent;)d=d.parent;void 0!==d&&
d instanceof THREE.Scene&&d.__addObject(b)}},remove:function(b){var d=this.children.indexOf(b);if(-1!==d){b.parent=void 0;this.children.splice(d,1);for(d=this;void 0!==d.parent;)d=d.parent;void 0!==d&&d instanceof THREE.Scene&&d.__removeObject(b)}},traverse:function(b){b(this);for(var d=0,c=this.children.length;d<c;d++)this.children[d].traverse(b)},getObjectById:function(b,d){for(var c=0,e=this.children.length;c<e;c++){var f=this.children[c];if(f.id===b||!0===d&&(f=f.getObjectById(b,d),void 0!==f))return f}},
getObjectByName:function(b,d){for(var c=0,e=this.children.length;c<e;c++){var f=this.children[c];if(f.name===b||!0===d&&(f=f.getObjectByName(b,d),void 0!==f))return f}},getChildByName:function(b,d){console.warn("DEPRECATED: Object3D's .getChildByName() has been renamed to .getObjectByName().");return this.getObjectByName(b,d)},getDescendants:function(b){void 0===b&&(b=[]);Array.prototype.push.apply(b,this.children);for(var d=0,c=this.children.length;d<c;d++)this.children[d].getDescendants(b);return b},
updateMatrix:function(){!1===this.useQuaternion?this.matrix.makeFromPositionEulerScale(this.position,this.rotation,this.eulerOrder,this.scale):this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(b){!0===this.matrixAutoUpdate&&this.updateMatrix();if(!0===this.matrixWorldNeedsUpdate||!0===b)void 0===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),
this.matrixWorldNeedsUpdate=!1,b=!0;for(var d=0,c=this.children.length;d<c;d++)this.children[d].updateMatrixWorld(b)},clone:function(b){void 0===b&&(b=new THREE.Object3D);b.name=this.name;b.up.copy(this.up);b.position.copy(this.position);b.rotation instanceof THREE.Vector3&&b.rotation.copy(this.rotation);b.eulerOrder=this.eulerOrder;b.scale.copy(this.scale);b.renderDepth=this.renderDepth;b.rotationAutoUpdate=this.rotationAutoUpdate;b.matrix.copy(this.matrix);b.matrixWorld.copy(this.matrixWorld);b.matrixAutoUpdate=
this.matrixAutoUpdate;b.matrixWorldNeedsUpdate=this.matrixWorldNeedsUpdate;b.quaternion.copy(this.quaternion);b.useQuaternion=this.useQuaternion;b.visible=this.visible;b.castShadow=this.castShadow;b.receiveShadow=this.receiveShadow;b.frustumCulled=this.frustumCulled;b.userData=JSON.parse(JSON.stringify(this.userData));for(var d=0;d<this.children.length;d++)b.add(this.children[d].clone());return b}};THREE.Object3D.defaultEulerOrder="XYZ";THREE.Object3DIdCount=0;
THREE.Projector=function(){function b(){if(g===k){var b=new THREE.RenderableObject;h.push(b);k++;g++;return b}return h[g++]}function d(){if(p===r){var b=new THREE.RenderableVertex;q.push(b);r++;p++;return b}return q[p++]}function c(b,c){return c.z-b.z}function e(b,c){var e=0,d=1,f=b.z+b.w,g=c.z+c.w,h=-b.z+b.w,k=-c.z+c.w;if(0<=f&&0<=g&&0<=h&&0<=k)return!0;if(0>f&&0>g||0>h&&0>k)return!1;0>f?e=Math.max(e,f/(f-g)):0>g&&(d=Math.min(d,f/(f-g)));0>h?e=Math.max(e,h/(h-k)):0>k&&(d=Math.min(d,h/(h-k)));if(d<
e)return!1;b.lerp(c,e);c.lerp(b,1-d);return!0}var f,g,h=[],k=0,l,p,q=[],r=0,s,t,u=[],v=0,w,y=[],z=0,B,A,K=[],O=0,E,F,U=[],H=0,G={objects:[],sprites:[],lights:[],elements:[]},aa=new THREE.Vector3,D=new THREE.Vector4,M=new THREE.Box3(new THREE.Vector3(-1,-1,-1),new THREE.Vector3(1,1,1)),I=new THREE.Box3,Q=Array(3),V=Array(4),C=new THREE.Matrix4,Z=new THREE.Matrix4,N,ca=new THREE.Matrix4,R=new THREE.Matrix3,X=new THREE.Matrix3,ba=new THREE.Vector3,na=new THREE.Frustum,S=new THREE.Vector4,$=new THREE.Vector4;
this.projectVector=function(b,c){c.matrixWorldInverse.getInverse(c.matrixWorld);Z.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);return b.applyProjection(Z)};this.unprojectVector=function(b,c){c.projectionMatrixInverse.getInverse(c.projectionMatrix);Z.multiplyMatrices(c.matrixWorld,c.projectionMatrixInverse);return b.applyProjection(Z)};this.pickingRay=function(b,c){b.z=-1;var e=new THREE.Vector3(b.x,b.y,1);this.unprojectVector(b,c);this.unprojectVector(e,c);e.sub(b).normalize();return new THREE.Raycaster(b,
e)};this.projectScene=function(h,k,r,Na){var Qa=!1,Oa,fa,T,ia,ea,xa,Aa,ya,Ba,Ua,ha,Ra,Ha;F=A=w=t=0;G.elements.length=0;!0===h.autoUpdate&&h.updateMatrixWorld();void 0===k.parent&&k.updateMatrixWorld();C.copy(k.matrixWorldInverse.getInverse(k.matrixWorld));Z.multiplyMatrices(k.projectionMatrix,C);X.getNormalMatrix(C);na.setFromMatrix(Z);g=0;G.objects.length=0;G.sprites.length=0;G.lights.length=0;var sa=function(c){for(var e=0,d=c.children.length;e<d;e++){var g=c.children[e];if(!1!==g.visible){if(g instanceof
THREE.Light)G.lights.push(g);else if(g instanceof THREE.Mesh||g instanceof THREE.Line){if(!1===g.frustumCulled||!0===na.intersectsObject(g))f=b(),f.object=g,null!==g.renderDepth?f.z=g.renderDepth:(aa.getPositionFromMatrix(g.matrixWorld),aa.applyProjection(Z),f.z=aa.z),G.objects.push(f)}else g instanceof THREE.Sprite||g instanceof THREE.Particle?(f=b(),f.object=g,null!==g.renderDepth?f.z=g.renderDepth:(aa.getPositionFromMatrix(g.matrixWorld),aa.applyProjection(Z),f.z=aa.z),G.sprites.push(f)):(f=b(),
f.object=g,null!==g.renderDepth?f.z=g.renderDepth:(aa.getPositionFromMatrix(g.matrixWorld),aa.applyProjection(Z),f.z=aa.z),G.objects.push(f));sa(g)}}};sa(h);!0===r&&G.objects.sort(c);h=0;for(r=G.objects.length;h<r;h++)if(ya=G.objects[h].object,N=ya.matrixWorld,p=0,ya instanceof THREE.Mesh){Ba=ya.geometry;T=Ba.vertices;Ua=Ba.faces;Ba=Ba.faceVertexUvs;R.getNormalMatrix(N);Ra=ya.material instanceof THREE.MeshFaceMaterial;Ha=!0===Ra?ya.material:null;Oa=0;for(fa=T.length;Oa<fa;Oa++)l=d(),l.positionWorld.copy(T[Oa]).applyMatrix4(N),
l.positionScreen.copy(l.positionWorld).applyMatrix4(Z),l.positionScreen.x/=l.positionScreen.w,l.positionScreen.y/=l.positionScreen.w,l.positionScreen.z/=l.positionScreen.w,l.visible=!(-1>l.positionScreen.x||1<l.positionScreen.x||-1>l.positionScreen.y||1<l.positionScreen.y||-1>l.positionScreen.z||1<l.positionScreen.z);T=0;for(Oa=Ua.length;T<Oa;T++){fa=Ua[T];var eb=!0===Ra?Ha.materials[fa.materialIndex]:ya.material;if(void 0!==eb){xa=eb.side;if(fa instanceof THREE.Face3)if(ia=q[fa.a],ea=q[fa.b],Aa=
q[fa.c],Q[0]=ia.positionScreen,Q[1]=ea.positionScreen,Q[2]=Aa.positionScreen,!0===ia.visible||!0===ea.visible||!0===Aa.visible||M.isIntersectionBox(I.setFromPoints(Q)))if(Qa=0>(Aa.positionScreen.x-ia.positionScreen.x)*(ea.positionScreen.y-ia.positionScreen.y)-(Aa.positionScreen.y-ia.positionScreen.y)*(ea.positionScreen.x-ia.positionScreen.x),xa===THREE.DoubleSide||Qa===(xa===THREE.FrontSide))t===v?(ha=new THREE.RenderableFace3,u.push(ha),v++,t++,s=ha):s=u[t++],s.v1.copy(ia),s.v2.copy(ea),s.v3.copy(Aa);
else continue;else continue;else if(fa instanceof THREE.Face4)if(ia=q[fa.a],ea=q[fa.b],Aa=q[fa.c],ha=q[fa.d],V[0]=ia.positionScreen,V[1]=ea.positionScreen,V[2]=Aa.positionScreen,V[3]=ha.positionScreen,!0===ia.visible||!0===ea.visible||!0===Aa.visible||!0===ha.visible||M.isIntersectionBox(I.setFromPoints(V)))if(Qa=0>(ha.positionScreen.x-ia.positionScreen.x)*(ea.positionScreen.y-ia.positionScreen.y)-(ha.positionScreen.y-ia.positionScreen.y)*(ea.positionScreen.x-ia.positionScreen.x)||0>(ea.positionScreen.x-
Aa.positionScreen.x)*(ha.positionScreen.y-Aa.positionScreen.y)-(ea.positionScreen.y-Aa.positionScreen.y)*(ha.positionScreen.x-Aa.positionScreen.x),xa===THREE.DoubleSide||Qa===(xa===THREE.FrontSide)){if(w===z){var Xa=new THREE.RenderableFace4;y.push(Xa);z++;w++;s=Xa}else s=y[w++];s.v1.copy(ia);s.v2.copy(ea);s.v3.copy(Aa);s.v4.copy(ha)}else continue;else continue;s.normalModel.copy(fa.normal);!1===Qa&&(xa===THREE.BackSide||xa===THREE.DoubleSide)&&s.normalModel.negate();s.normalModel.applyMatrix3(R).normalize();
s.normalModelView.copy(s.normalModel).applyMatrix3(X);s.centroidModel.copy(fa.centroid).applyMatrix4(N);Aa=fa.vertexNormals;ia=0;for(ea=Aa.length;ia<ea;ia++)ha=s.vertexNormalsModel[ia],ha.copy(Aa[ia]),!1===Qa&&(xa===THREE.BackSide||xa===THREE.DoubleSide)&&ha.negate(),ha.applyMatrix3(R).normalize(),s.vertexNormalsModelView[ia].copy(ha).applyMatrix3(X);s.vertexNormalsLength=Aa.length;ia=0;for(ea=Ba.length;ia<ea;ia++)if(ha=Ba[ia][T],void 0!==ha){xa=0;for(Aa=ha.length;xa<Aa;xa++)s.uvs[ia][xa]=ha[xa]}s.color=
fa.color;s.material=eb;ba.copy(s.centroidModel).applyProjection(Z);s.z=ba.z;G.elements.push(s)}}}else if(ya instanceof THREE.Line){ca.multiplyMatrices(Z,N);T=ya.geometry.vertices;ia=d();ia.positionScreen.copy(T[0]).applyMatrix4(ca);Ua=ya.type===THREE.LinePieces?2:1;Oa=1;for(fa=T.length;Oa<fa;Oa++)ia=d(),ia.positionScreen.copy(T[Oa]).applyMatrix4(ca),0<(Oa+1)%Ua||(ea=q[p-2],S.copy(ia.positionScreen),$.copy(ea.positionScreen),!0===e(S,$)&&(S.multiplyScalar(1/S.w),$.multiplyScalar(1/$.w),A===O?(Ba=new THREE.RenderableLine,
K.push(Ba),O++,A++,B=Ba):B=K[A++],B.v1.positionScreen.copy(S),B.v2.positionScreen.copy($),B.z=Math.max(S.z,$.z),B.material=ya.material,ya.material.vertexColors===THREE.VertexColors&&(B.vertexColors[0].copy(ya.geometry.colors[Oa]),B.vertexColors[1].copy(ya.geometry.colors[Oa-1])),G.elements.push(B)))}h=0;for(r=G.sprites.length;h<r;h++)ya=G.sprites[h].object,N=ya.matrixWorld,ya instanceof THREE.Particle&&(D.set(N.elements[12],N.elements[13],N.elements[14],1),D.applyMatrix4(Z),D.z/=D.w,0<D.z&&1>D.z&&
(F===H?(Qa=new THREE.RenderableParticle,U.push(Qa),H++,F++,E=Qa):E=U[F++],E.object=ya,E.x=D.x/D.w,E.y=D.y/D.w,E.z=D.z,E.rotation=ya.rotation.z,E.scale.x=ya.scale.x*Math.abs(E.x-(D.x+k.projectionMatrix.elements[0])/(D.w+k.projectionMatrix.elements[12])),E.scale.y=ya.scale.y*Math.abs(E.y-(D.y+k.projectionMatrix.elements[5])/(D.w+k.projectionMatrix.elements[13])),E.material=ya.material,G.elements.push(E)));!0===Na&&G.elements.sort(c);return G}};
THREE.Face3=function(b,d,c,e,f,g){this.a=b;this.b=d;this.c=c;this.normal=e instanceof THREE.Vector3?e:new THREE.Vector3;this.vertexNormals=e instanceof Array?e:[];this.color=f instanceof THREE.Color?f:new THREE.Color;this.vertexColors=f instanceof Array?f:[];this.vertexTangents=[];this.materialIndex=void 0!==g?g:0;this.centroid=new THREE.Vector3};
THREE.Face3.prototype={constructor:THREE.Face3,clone:function(){var b=new THREE.Face3(this.a,this.b,this.c);b.normal.copy(this.normal);b.color.copy(this.color);b.centroid.copy(this.centroid);b.materialIndex=this.materialIndex;var d,c;d=0;for(c=this.vertexNormals.length;d<c;d++)b.vertexNormals[d]=this.vertexNormals[d].clone();d=0;for(c=this.vertexColors.length;d<c;d++)b.vertexColors[d]=this.vertexColors[d].clone();d=0;for(c=this.vertexTangents.length;d<c;d++)b.vertexTangents[d]=this.vertexTangents[d].clone();
return b}};THREE.Face4=function(b,d,c,e,f,g,h){this.a=b;this.b=d;this.c=c;this.d=e;this.normal=f instanceof THREE.Vector3?f:new THREE.Vector3;this.vertexNormals=f instanceof Array?f:[];this.color=g instanceof THREE.Color?g:new THREE.Color;this.vertexColors=g instanceof Array?g:[];this.vertexTangents=[];this.materialIndex=void 0!==h?h:0;this.centroid=new THREE.Vector3};
THREE.Face4.prototype={constructor:THREE.Face4,clone:function(){var b=new THREE.Face4(this.a,this.b,this.c,this.d);b.normal.copy(this.normal);b.color.copy(this.color);b.centroid.copy(this.centroid);b.materialIndex=this.materialIndex;var d,c;d=0;for(c=this.vertexNormals.length;d<c;d++)b.vertexNormals[d]=this.vertexNormals[d].clone();d=0;for(c=this.vertexColors.length;d<c;d++)b.vertexColors[d]=this.vertexColors[d].clone();d=0;for(c=this.vertexTangents.length;d<c;d++)b.vertexTangents[d]=this.vertexTangents[d].clone();
return b}};
THREE.Geometry=function(){this.id=THREE.GeometryIdCount++;this.name="";this.vertices=[];this.colors=[];this.normals=[];this.faces=[];this.faceUvs=[[]];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphColors=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.dynamic=!0;this.buffersNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.tangentsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=
this.elementsNeedUpdate=this.verticesNeedUpdate=!1};
THREE.Geometry.prototype={constructor:THREE.Geometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(b){for(var d=(new THREE.Matrix3).getNormalMatrix(b),c=0,e=this.vertices.length;c<e;c++)this.vertices[c].applyMatrix4(b);c=0;for(e=this.faces.length;c<e;c++){var f=
this.faces[c];f.normal.applyMatrix3(d).normalize();for(var g=0,h=f.vertexNormals.length;g<h;g++)f.vertexNormals[g].applyMatrix3(d).normalize();f.centroid.applyMatrix4(b)}},computeCentroids:function(){var b,d,c;b=0;for(d=this.faces.length;b<d;b++)c=this.faces[b],c.centroid.set(0,0,0),c instanceof THREE.Face3?(c.centroid.add(this.vertices[c.a]),c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.divideScalar(3)):c instanceof THREE.Face4&&(c.centroid.add(this.vertices[c.a]),
c.centroid.add(this.vertices[c.b]),c.centroid.add(this.vertices[c.c]),c.centroid.add(this.vertices[c.d]),c.centroid.divideScalar(4))},computeFaceNormals:function(){for(var b=new THREE.Vector3,d=new THREE.Vector3,c=0,e=this.faces.length;c<e;c++){var f=this.faces[c],g=this.vertices[f.a],h=this.vertices[f.b];b.subVectors(this.vertices[f.c],h);d.subVectors(g,h);b.cross(d);b.normalize();f.normal.copy(b)}},computeVertexNormals:function(b){var d,c,e,f;if(void 0===this.__tmpVertices){f=this.__tmpVertices=
Array(this.vertices.length);d=0;for(c=this.vertices.length;d<c;d++)f[d]=new THREE.Vector3;d=0;for(c=this.faces.length;d<c;d++)e=this.faces[d],e instanceof THREE.Face3?e.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3]:e instanceof THREE.Face4&&(e.vertexNormals=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3])}else{f=this.__tmpVertices;d=0;for(c=this.vertices.length;d<c;d++)f[d].set(0,0,0)}if(b){var g,h,k,l=new THREE.Vector3,p=new THREE.Vector3,q=new THREE.Vector3,
r=new THREE.Vector3,s=new THREE.Vector3;d=0;for(c=this.faces.length;d<c;d++)e=this.faces[d],e instanceof THREE.Face3?(b=this.vertices[e.a],g=this.vertices[e.b],h=this.vertices[e.c],l.subVectors(h,g),p.subVectors(b,g),l.cross(p),f[e.a].add(l),f[e.b].add(l),f[e.c].add(l)):e instanceof THREE.Face4&&(b=this.vertices[e.a],g=this.vertices[e.b],h=this.vertices[e.c],k=this.vertices[e.d],q.subVectors(k,g),p.subVectors(b,g),q.cross(p),f[e.a].add(q),f[e.b].add(q),f[e.d].add(q),r.subVectors(k,h),s.subVectors(g,
h),r.cross(s),f[e.b].add(r),f[e.c].add(r),f[e.d].add(r))}else{d=0;for(c=this.faces.length;d<c;d++)e=this.faces[d],e instanceof THREE.Face3?(f[e.a].add(e.normal),f[e.b].add(e.normal),f[e.c].add(e.normal)):e instanceof THREE.Face4&&(f[e.a].add(e.normal),f[e.b].add(e.normal),f[e.c].add(e.normal),f[e.d].add(e.normal))}d=0;for(c=this.vertices.length;d<c;d++)f[d].normalize();d=0;for(c=this.faces.length;d<c;d++)e=this.faces[d],e instanceof THREE.Face3?(e.vertexNormals[0].copy(f[e.a]),e.vertexNormals[1].copy(f[e.b]),
e.vertexNormals[2].copy(f[e.c])):e instanceof THREE.Face4&&(e.vertexNormals[0].copy(f[e.a]),e.vertexNormals[1].copy(f[e.b]),e.vertexNormals[2].copy(f[e.c]),e.vertexNormals[3].copy(f[e.d]))},computeMorphNormals:function(){var b,d,c,e,f;c=0;for(e=this.faces.length;c<e;c++){f=this.faces[c];f.__originalFaceNormal?f.__originalFaceNormal.copy(f.normal):f.__originalFaceNormal=f.normal.clone();f.__originalVertexNormals||(f.__originalVertexNormals=[]);b=0;for(d=f.vertexNormals.length;b<d;b++)f.__originalVertexNormals[b]?
f.__originalVertexNormals[b].copy(f.vertexNormals[b]):f.__originalVertexNormals[b]=f.vertexNormals[b].clone()}var g=new THREE.Geometry;g.faces=this.faces;b=0;for(d=this.morphTargets.length;b<d;b++){if(!this.morphNormals[b]){this.morphNormals[b]={};this.morphNormals[b].faceNormals=[];this.morphNormals[b].vertexNormals=[];var h=this.morphNormals[b].faceNormals,k=this.morphNormals[b].vertexNormals,l,p;c=0;for(e=this.faces.length;c<e;c++)f=this.faces[c],l=new THREE.Vector3,p=f instanceof THREE.Face3?
{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3}:{a:new THREE.Vector3,b:new THREE.Vector3,c:new THREE.Vector3,d:new THREE.Vector3},h.push(l),k.push(p)}h=this.morphNormals[b];g.vertices=this.morphTargets[b].vertices;g.computeFaceNormals();g.computeVertexNormals();c=0;for(e=this.faces.length;c<e;c++)f=this.faces[c],l=h.faceNormals[c],p=h.vertexNormals[c],l.copy(f.normal),f instanceof THREE.Face3?(p.a.copy(f.vertexNormals[0]),p.b.copy(f.vertexNormals[1]),p.c.copy(f.vertexNormals[2])):(p.a.copy(f.vertexNormals[0]),
p.b.copy(f.vertexNormals[1]),p.c.copy(f.vertexNormals[2]),p.d.copy(f.vertexNormals[3]))}c=0;for(e=this.faces.length;c<e;c++)f=this.faces[c],f.normal=f.__originalFaceNormal,f.vertexNormals=f.__originalVertexNormals},computeTangents:function(){function b(b,c,e,d,f,g,D){k=b.vertices[c];l=b.vertices[e];p=b.vertices[d];q=h[f];r=h[g];s=h[D];t=l.x-k.x;u=p.x-k.x;v=l.y-k.y;w=p.y-k.y;y=l.z-k.z;z=p.z-k.z;B=r.x-q.x;A=s.x-q.x;K=r.y-q.y;O=s.y-q.y;E=1/(B*O-A*K);G.set((O*t-K*u)*E,(O*v-K*w)*E,(O*y-K*z)*E);aa.set((B*
u-A*t)*E,(B*w-A*v)*E,(B*z-A*y)*E);U[c].add(G);U[e].add(G);U[d].add(G);H[c].add(aa);H[e].add(aa);H[d].add(aa)}var d,c,e,f,g,h,k,l,p,q,r,s,t,u,v,w,y,z,B,A,K,O,E,F,U=[],H=[],G=new THREE.Vector3,aa=new THREE.Vector3,D=new THREE.Vector3,M=new THREE.Vector3,I=new THREE.Vector3;d=0;for(c=this.vertices.length;d<c;d++)U[d]=new THREE.Vector3,H[d]=new THREE.Vector3;d=0;for(c=this.faces.length;d<c;d++)g=this.faces[d],h=this.faceVertexUvs[0][d],g instanceof THREE.Face3?b(this,g.a,g.b,g.c,0,1,2):g instanceof THREE.Face4&&
(b(this,g.a,g.b,g.d,0,1,3),b(this,g.b,g.c,g.d,1,2,3));var Q=["a","b","c","d"];d=0;for(c=this.faces.length;d<c;d++){g=this.faces[d];for(e=0;e<g.vertexNormals.length;e++)I.copy(g.vertexNormals[e]),f=g[Q[e]],F=U[f],D.copy(F),D.sub(I.multiplyScalar(I.dot(F))).normalize(),M.crossVectors(g.vertexNormals[e],F),f=M.dot(H[f]),f=0>f?-1:1,g.vertexTangents[e]=new THREE.Vector4(D.x,D.y,D.z,f)}this.hasTangents=!0},computeLineDistances:function(){for(var b=0,d=this.vertices,c=0,e=d.length;c<e;c++)0<c&&(b+=d[c].distanceTo(d[c-
1])),this.lineDistances[c]=b},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);this.boundingSphere.setFromCenterAndPoints(this.boundingSphere.center,this.vertices)},mergeVertices:function(){var b={},d=[],c=[],e,f=Math.pow(10,4),g,h,k,l,p;this.__tmpVertices=void 0;g=0;for(h=this.vertices.length;g<h;g++)e=this.vertices[g],
e=[Math.round(e.x*f),Math.round(e.y*f),Math.round(e.z*f)].join("_"),void 0===b[e]?(b[e]=g,d.push(this.vertices[g]),c[g]=d.length-1):c[g]=c[b[e]];f=[];g=0;for(h=this.faces.length;g<h;g++)if(b=this.faces[g],b instanceof THREE.Face3){b.a=c[b.a];b.b=c[b.b];b.c=c[b.c];k=[b.a,b.b,b.c];for(l=0;3>l;l++)if(k[l]==k[(l+1)%3]){f.push(g);break}}else if(b instanceof THREE.Face4){b.a=c[b.a];b.b=c[b.b];b.c=c[b.c];b.d=c[b.d];k=[b.a,b.b,b.c,b.d];e=-1;for(l=0;4>l;l++)k[l]==k[(l+1)%4]&&(0<=e&&f.push(g),e=l);if(0<=e){k.splice(e,
1);var q=new THREE.Face3(k[0],k[1],k[2],b.normal,b.color,b.materialIndex);k=0;for(l=this.faceVertexUvs.length;k<l;k++)(p=this.faceVertexUvs[k][g])&&p.splice(e,1);b.vertexNormals&&0<b.vertexNormals.length&&(q.vertexNormals=b.vertexNormals,q.vertexNormals.splice(e,1));b.vertexColors&&0<b.vertexColors.length&&(q.vertexColors=b.vertexColors,q.vertexColors.splice(e,1));this.faces[g]=q}}for(g=f.length-1;0<=g;g--){this.faces.splice(g,1);k=0;for(l=this.faceVertexUvs.length;k<l;k++)this.faceVertexUvs[k].splice(g,
1)}c=this.vertices.length-d.length;this.vertices=d;return c},clone:function(){for(var b=new THREE.Geometry,d=this.vertices,c=0,e=d.length;c<e;c++)b.vertices.push(d[c].clone());d=this.faces;c=0;for(e=d.length;c<e;c++)b.faces.push(d[c].clone());d=this.faceVertexUvs[0];c=0;for(e=d.length;c<e;c++){for(var f=d[c],g=[],h=0,k=f.length;h<k;h++)g.push(new THREE.Vector2(f[h].x,f[h].y));b.faceVertexUvs[0].push(g)}return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.GeometryIdCount=0;
THREE.BufferGeometry=function(){this.id=THREE.GeometryIdCount++;this.attributes={};this.dynamic=!1;this.offsets=[];this.boundingSphere=this.boundingBox=null;this.hasTangents=!1;this.morphTargets=[]};
THREE.BufferGeometry.prototype={constructor:THREE.BufferGeometry,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,applyMatrix:function(b){var d,c;this.attributes.position&&(d=this.attributes.position.array);this.attributes.normal&&(c=this.attributes.normal.array);void 0!==d&&(b.multiplyVector3Array(d),
this.verticesNeedUpdate=!0);void 0!==c&&((new THREE.Matrix3).getNormalMatrix(b).multiplyVector3Array(c),this.normalizeNormals(),this.normalsNeedUpdate=!0)},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new THREE.Box3);var b=this.attributes.position.array;if(b){var d=this.boundingBox,c,e,f;3<=b.length&&(d.min.x=d.max.x=b[0],d.min.y=d.max.y=b[1],d.min.z=d.max.z=b[2]);for(var g=3,h=b.length;g<h;g+=3)c=b[g],e=b[g+1],f=b[g+2],c<d.min.x?d.min.x=c:c>d.max.x&&(d.max.x=c),e<d.min.y?
d.min.y=e:e>d.max.y&&(d.max.y=e),f<d.min.z?d.min.z=f:f>d.max.z&&(d.max.z=f)}if(void 0===b||0===b.length)this.boundingBox.min.set(0,0,0),this.boundingBox.max.set(0,0,0)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new THREE.Sphere);var b=this.attributes.position.array;if(b){for(var d,c=0,e,f,g=0,h=b.length;g<h;g+=3)d=b[g],e=b[g+1],f=b[g+2],d=d*d+e*e+f*f,d>c&&(c=d);this.boundingSphere.radius=Math.sqrt(c)}},computeVertexNormals:function(){if(this.attributes.position){var b,
d,c,e;b=this.attributes.position.array.length;if(void 0===this.attributes.normal)this.attributes.normal={itemSize:3,array:new Float32Array(b),numItems:b};else{b=0;for(d=this.attributes.normal.array.length;b<d;b++)this.attributes.normal.array[b]=0}var f=this.attributes.position.array,g=this.attributes.normal.array,h,k,l,p,q,r,s=new THREE.Vector3,t=new THREE.Vector3,u=new THREE.Vector3,v=new THREE.Vector3,w=new THREE.Vector3;if(this.attributes.index){var y=this.attributes.index.array,z=this.offsets;
c=0;for(e=z.length;c<e;++c){d=z[c].start;h=z[c].count;var B=z[c].index;b=d;for(d+=h;b<d;b+=3)h=B+y[b],k=B+y[b+1],l=B+y[b+2],p=f[3*h],q=f[3*h+1],r=f[3*h+2],s.set(p,q,r),p=f[3*k],q=f[3*k+1],r=f[3*k+2],t.set(p,q,r),p=f[3*l],q=f[3*l+1],r=f[3*l+2],u.set(p,q,r),v.subVectors(u,t),w.subVectors(s,t),v.cross(w),g[3*h]+=v.x,g[3*h+1]+=v.y,g[3*h+2]+=v.z,g[3*k]+=v.x,g[3*k+1]+=v.y,g[3*k+2]+=v.z,g[3*l]+=v.x,g[3*l+1]+=v.y,g[3*l+2]+=v.z}}else{b=0;for(d=f.length;b<d;b+=9)p=f[b],q=f[b+1],r=f[b+2],s.set(p,q,r),p=f[b+
3],q=f[b+4],r=f[b+5],t.set(p,q,r),p=f[b+6],q=f[b+7],r=f[b+8],u.set(p,q,r),v.subVectors(u,t),w.subVectors(s,t),v.cross(w),g[b]=v.x,g[b+1]=v.y,g[b+2]=v.z,g[b+3]=v.x,g[b+4]=v.y,g[b+5]=v.z,g[b+6]=v.x,g[b+7]=v.y,g[b+8]=v.z}this.normalizeNormals();this.normalsNeedUpdate=!0}},normalizeNormals:function(){for(var b=this.attributes.normal.array,d,c,e,f=0,g=b.length;f<g;f+=3)d=b[f],c=b[f+1],e=b[f+2],d=1/Math.sqrt(d*d+c*c+e*e),b[f]*=d,b[f+1]*=d,b[f+2]*=d},computeTangents:function(){function b(b){N.x=e[3*b];N.y=
e[3*b+1];N.z=e[3*b+2];ca.copy(N);X=l[b];C.copy(X);C.sub(N.multiplyScalar(N.dot(X))).normalize();Z.crossVectors(ca,X);ba=Z.dot(p[b]);R=0>ba?-1:1;k[4*b]=C.x;k[4*b+1]=C.y;k[4*b+2]=C.z;k[4*b+3]=R}if(void 0===this.attributes.index||void 0===this.attributes.position||void 0===this.attributes.normal||void 0===this.attributes.uv)console.warn("Missing required attributes (index, position, normal or uv) in BufferGeometry.computeTangents()");else{var d=this.attributes.index.array,c=this.attributes.position.array,
e=this.attributes.normal.array,f=this.attributes.uv.array,g=c.length/3;if(void 0===this.attributes.tangent){var h=4*g;this.attributes.tangent={itemSize:4,array:new Float32Array(h),numItems:h}}for(var k=this.attributes.tangent.array,l=[],p=[],h=0;h<g;h++)l[h]=new THREE.Vector3,p[h]=new THREE.Vector3;var q,r,s,t,u,v,w,y,z,B,A,K,O,E,F,g=new THREE.Vector3,h=new THREE.Vector3,U,H,G,aa,D,M,I,Q=this.offsets;G=0;for(aa=Q.length;G<aa;++G){H=Q[G].start;D=Q[G].count;var V=Q[G].index;U=H;for(H+=D;U<H;U+=3)D=
V+d[U],M=V+d[U+1],I=V+d[U+2],q=c[3*D],r=c[3*D+1],s=c[3*D+2],t=c[3*M],u=c[3*M+1],v=c[3*M+2],w=c[3*I],y=c[3*I+1],z=c[3*I+2],B=f[2*D],A=f[2*D+1],K=f[2*M],O=f[2*M+1],E=f[2*I],F=f[2*I+1],t-=q,q=w-q,u-=r,r=y-r,v-=s,s=z-s,K-=B,B=E-B,O-=A,A=F-A,F=1/(K*A-B*O),g.set((A*t-O*q)*F,(A*u-O*r)*F,(A*v-O*s)*F),h.set((K*q-B*t)*F,(K*r-B*u)*F,(K*s-B*v)*F),l[D].add(g),l[M].add(g),l[I].add(g),p[D].add(h),p[M].add(h),p[I].add(h)}var C=new THREE.Vector3,Z=new THREE.Vector3,N=new THREE.Vector3,ca=new THREE.Vector3,R,X,ba;
G=0;for(aa=Q.length;G<aa;++G){H=Q[G].start;D=Q[G].count;V=Q[G].index;U=H;for(H+=D;U<H;U+=3)D=V+d[U],M=V+d[U+1],I=V+d[U+2],b(D),b(M),b(I)}this.tangentsNeedUpdate=this.hasTangents=!0}},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.Camera=function(){THREE.Object3D.call(this);this.matrixWorldInverse=new THREE.Matrix4;this.projectionMatrix=new THREE.Matrix4;this.projectionMatrixInverse=new THREE.Matrix4};THREE.Camera.prototype=Object.create(THREE.Object3D.prototype);
THREE.Camera.prototype.lookAt=function(){var b=new THREE.Matrix4;return function(d){b.lookAt(this.position,d,this.up);!0===this.useQuaternion?this.quaternion.setFromRotationMatrix(b):this.rotation.setEulerFromRotationMatrix(b,this.eulerOrder)}}();THREE.OrthographicCamera=function(b,d,c,e,f,g){THREE.Camera.call(this);this.left=b;this.right=d;this.top=c;this.bottom=e;this.near=void 0!==f?f:0.1;this.far=void 0!==g?g:2E3;this.updateProjectionMatrix()};THREE.OrthographicCamera.prototype=Object.create(THREE.Camera.prototype);
THREE.OrthographicCamera.prototype.updateProjectionMatrix=function(){this.projectionMatrix.makeOrthographic(this.left,this.right,this.top,this.bottom,this.near,this.far)};THREE.PerspectiveCamera=function(b,d,c,e){THREE.Camera.call(this);this.fov=void 0!==b?b:50;this.aspect=void 0!==d?d:1;this.near=void 0!==c?c:0.1;this.far=void 0!==e?e:2E3;this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype=Object.create(THREE.Camera.prototype);
THREE.PerspectiveCamera.prototype.setLens=function(b,d){void 0===d&&(d=24);this.fov=2*THREE.Math.radToDeg(Math.atan(d/(2*b)));this.updateProjectionMatrix()};THREE.PerspectiveCamera.prototype.setViewOffset=function(b,d,c,e,f,g){this.fullWidth=b;this.fullHeight=d;this.x=c;this.y=e;this.width=f;this.height=g;this.updateProjectionMatrix()};
THREE.PerspectiveCamera.prototype.updateProjectionMatrix=function(){if(this.fullWidth){var b=this.fullWidth/this.fullHeight,d=Math.tan(THREE.Math.degToRad(0.5*this.fov))*this.near,c=-d,e=b*c,b=Math.abs(b*d-e),c=Math.abs(d-c);this.projectionMatrix.makeFrustum(e+this.x*b/this.fullWidth,e+(this.x+this.width)*b/this.fullWidth,d-(this.y+this.height)*c/this.fullHeight,d-this.y*c/this.fullHeight,this.near,this.far)}else this.projectionMatrix.makePerspective(this.fov,this.aspect,this.near,this.far)};
THREE.Light=function(b){THREE.Object3D.call(this);this.color=new THREE.Color(b)};THREE.Light.prototype=Object.create(THREE.Object3D.prototype);THREE.Light.prototype.clone=function(b){void 0===b&&(b=new THREE.Light);THREE.Object3D.prototype.clone.call(this,b);b.color.copy(this.color);return b};THREE.AmbientLight=function(b){THREE.Light.call(this,b)};THREE.AmbientLight.prototype=Object.create(THREE.Light.prototype);
THREE.AmbientLight.prototype.clone=function(){var b=new THREE.AmbientLight;THREE.Light.prototype.clone.call(this,b);return b};THREE.AreaLight=function(b,d){THREE.Light.call(this,b);this.normal=new THREE.Vector3(0,-1,0);this.right=new THREE.Vector3(1,0,0);this.intensity=void 0!==d?d:1;this.height=this.width=1;this.constantAttenuation=1.5;this.linearAttenuation=0.5;this.quadraticAttenuation=0.1};THREE.AreaLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight=function(b,d){THREE.Light.call(this,b);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==d?d:1;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraLeft=-500;this.shadowCameraTop=this.shadowCameraRight=500;this.shadowCameraBottom=-500;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowCascade=!1;this.shadowCascadeOffset=new THREE.Vector3(0,
0,-1E3);this.shadowCascadeCount=2;this.shadowCascadeBias=[0,0,0];this.shadowCascadeWidth=[512,512,512];this.shadowCascadeHeight=[512,512,512];this.shadowCascadeNearZ=[-1,0.99,0.998];this.shadowCascadeFarZ=[0.99,0.998,1];this.shadowCascadeArray=[];this.shadowMatrix=this.shadowCamera=this.shadowMapSize=this.shadowMap=null};THREE.DirectionalLight.prototype=Object.create(THREE.Light.prototype);
THREE.DirectionalLight.prototype.clone=function(){var b=new THREE.DirectionalLight;THREE.Light.prototype.clone.call(this,b);b.target=this.target.clone();b.intensity=this.intensity;b.castShadow=this.castShadow;b.onlyShadow=this.onlyShadow;return b};THREE.HemisphereLight=function(b,d,c){THREE.Light.call(this,b);this.position.set(0,100,0);this.groundColor=new THREE.Color(d);this.intensity=void 0!==c?c:1};THREE.HemisphereLight.prototype=Object.create(THREE.Light.prototype);
THREE.HemisphereLight.prototype.clone=function(){var b=new THREE.PointLight;THREE.Light.prototype.clone.call(this,b);b.groundColor.copy(this.groundColor);b.intensity=this.intensity;return b};THREE.PointLight=function(b,d,c){THREE.Light.call(this,b);this.intensity=void 0!==d?d:1;this.distance=void 0!==c?c:0};THREE.PointLight.prototype=Object.create(THREE.Light.prototype);
THREE.PointLight.prototype.clone=function(){var b=new THREE.PointLight;THREE.Light.prototype.clone.call(this,b);b.intensity=this.intensity;b.distance=this.distance;return b};
THREE.SpotLight=function(b,d,c,e,f){THREE.Light.call(this,b);this.position.set(0,1,0);this.target=new THREE.Object3D;this.intensity=void 0!==d?d:1;this.distance=void 0!==c?c:0;this.angle=void 0!==e?e:Math.PI/3;this.exponent=void 0!==f?f:10;this.onlyShadow=this.castShadow=!1;this.shadowCameraNear=50;this.shadowCameraFar=5E3;this.shadowCameraFov=50;this.shadowCameraVisible=!1;this.shadowBias=0;this.shadowDarkness=0.5;this.shadowMapHeight=this.shadowMapWidth=512;this.shadowMatrix=this.shadowCamera=this.shadowMapSize=
this.shadowMap=null};THREE.SpotLight.prototype=Object.create(THREE.Light.prototype);THREE.SpotLight.prototype.clone=function(){var b=new THREE.SpotLight;THREE.Light.prototype.clone.call(this,b);b.target=this.target.clone();b.intensity=this.intensity;b.distance=this.distance;b.angle=this.angle;b.exponent=this.exponent;b.castShadow=this.castShadow;b.onlyShadow=this.onlyShadow;return b};
THREE.Loader=function(b){this.statusDomElement=(this.showStatus=b)?THREE.Loader.prototype.addStatusElement():null;this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){}};
THREE.Loader.prototype={constructor:THREE.Loader,crossOrigin:"anonymous",addStatusElement:function(){var b=document.createElement("div");b.style.position="absolute";b.style.right="0px";b.style.top="0px";b.style.fontSize="0.8em";b.style.textAlign="left";b.style.background="rgba(0,0,0,0.25)";b.style.color="#fff";b.style.width="120px";b.style.padding="0.5em 0.5em 0.5em 0.5em";b.style.zIndex=1E3;b.innerHTML="Loading ...";return b},updateProgress:function(b){var d="Loaded ",d=b.total?d+((100*b.loaded/
b.total).toFixed(0)+"%"):d+((b.loaded/1E3).toFixed(2)+" KB");this.statusDomElement.innerHTML=d},extractUrlBase:function(b){b=b.split("/");b.pop();return(1>b.length?".":b.join("/"))+"/"},initMaterials:function(b,d){for(var c=[],e=0;e<b.length;++e)c[e]=THREE.Loader.prototype.createMaterial(b[e],d);return c},needsTangents:function(b){for(var d=0,c=b.length;d<c;d++)if(b[d]instanceof THREE.ShaderMaterial)return!0;return!1},createMaterial:function(b,d){function c(b){b=Math.log(b)/Math.LN2;return Math.floor(b)==
b}function e(b){b=Math.log(b)/Math.LN2;return Math.pow(2,Math.round(b))}function f(b,f,g,k,l,p,w){var y=/\.dds$/i.test(g),z=d+"/"+g;if(y){var B=THREE.ImageUtils.loadCompressedTexture(z);b[f]=B}else B=document.createElement("canvas"),b[f]=new THREE.Texture(B);b[f].sourceFile=g;k&&(b[f].repeat.set(k[0],k[1]),1!==k[0]&&(b[f].wrapS=THREE.RepeatWrapping),1!==k[1]&&(b[f].wrapT=THREE.RepeatWrapping));l&&b[f].offset.set(l[0],l[1]);p&&(g={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==
g[p[0]]&&(b[f].wrapS=g[p[0]]),void 0!==g[p[1]]&&(b[f].wrapT=g[p[1]]));w&&(b[f].anisotropy=w);if(!y){var A=b[f];b=new Image;b.onload=function(){if(!c(this.width)||!c(this.height)){var b=e(this.width),d=e(this.height);A.image.width=b;A.image.height=d;A.image.getContext("2d").drawImage(this,0,0,b,d)}else A.image=this;A.needsUpdate=!0};b.crossOrigin=h.crossOrigin;b.src=z}}function g(b){return(255*b[0]<<16)+(255*b[1]<<8)+255*b[2]}var h=this,k="MeshLambertMaterial",l={color:15658734,opacity:1,map:null,
lightMap:null,normalMap:null,bumpMap:null,wireframe:!1};if(b.shading){var p=b.shading.toLowerCase();"phong"===p?k="MeshPhongMaterial":"basic"===p&&(k="MeshBasicMaterial")}void 0!==b.blending&&void 0!==THREE[b.blending]&&(l.blending=THREE[b.blending]);if(void 0!==b.transparent||1>b.opacity)l.transparent=b.transparent;void 0!==b.depthTest&&(l.depthTest=b.depthTest);void 0!==b.depthWrite&&(l.depthWrite=b.depthWrite);void 0!==b.visible&&(l.visible=b.visible);void 0!==b.flipSided&&(l.side=THREE.BackSide);
void 0!==b.doubleSided&&(l.side=THREE.DoubleSide);void 0!==b.wireframe&&(l.wireframe=b.wireframe);void 0!==b.vertexColors&&("face"===b.vertexColors?l.vertexColors=THREE.FaceColors:b.vertexColors&&(l.vertexColors=THREE.VertexColors));b.colorDiffuse?l.color=g(b.colorDiffuse):b.DbgColor&&(l.color=b.DbgColor);b.colorSpecular&&(l.specular=g(b.colorSpecular));b.colorAmbient&&(l.ambient=g(b.colorAmbient));b.transparency&&(l.opacity=b.transparency);b.specularCoef&&(l.shininess=b.specularCoef);b.mapDiffuse&&
d&&f(l,"map",b.mapDiffuse,b.mapDiffuseRepeat,b.mapDiffuseOffset,b.mapDiffuseWrap,b.mapDiffuseAnisotropy);b.mapLight&&d&&f(l,"lightMap",b.mapLight,b.mapLightRepeat,b.mapLightOffset,b.mapLightWrap,b.mapLightAnisotropy);b.mapBump&&d&&f(l,"bumpMap",b.mapBump,b.mapBumpRepeat,b.mapBumpOffset,b.mapBumpWrap,b.mapBumpAnisotropy);b.mapNormal&&d&&f(l,"normalMap",b.mapNormal,b.mapNormalRepeat,b.mapNormalOffset,b.mapNormalWrap,b.mapNormalAnisotropy);b.mapSpecular&&d&&f(l,"specularMap",b.mapSpecular,b.mapSpecularRepeat,
b.mapSpecularOffset,b.mapSpecularWrap,b.mapSpecularAnisotropy);b.mapBumpScale&&(l.bumpScale=b.mapBumpScale);b.mapNormal?(k=THREE.ShaderLib.normalmap,p=THREE.UniformsUtils.clone(k.uniforms),p.tNormal.value=l.normalMap,b.mapNormalFactor&&p.uNormalScale.value.set(b.mapNormalFactor,b.mapNormalFactor),l.map&&(p.tDiffuse.value=l.map,p.enableDiffuse.value=!0),l.specularMap&&(p.tSpecular.value=l.specularMap,p.enableSpecular.value=!0),l.lightMap&&(p.tAO.value=l.lightMap,p.enableAO.value=!0),p.uDiffuseColor.value.setHex(l.color),
p.uSpecularColor.value.setHex(l.specular),p.uAmbientColor.value.setHex(l.ambient),p.uShininess.value=l.shininess,void 0!==l.opacity&&(p.uOpacity.value=l.opacity),k=new THREE.ShaderMaterial({fragmentShader:k.fragmentShader,vertexShader:k.vertexShader,uniforms:p,lights:!0,fog:!0}),l.transparent&&(k.transparent=!0)):k=new THREE[k](l);void 0!==b.DbgName&&(k.name=b.DbgName);return k}};THREE.ImageLoader=function(){this.crossOrigin=null};
THREE.ImageLoader.prototype={constructor:THREE.ImageLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(b,d){var c=this;void 0===d&&(d=new Image);d.addEventListener("load",function(){c.dispatchEvent({type:"load",content:d})},!1);d.addEventListener("error",function(){c.dispatchEvent({type:"error",
message:"Couldn't load URL ["+b+"]"})},!1);c.crossOrigin&&(d.crossOrigin=c.crossOrigin);d.src=b}};THREE.JSONLoader=function(b){THREE.Loader.call(this,b);this.withCredentials=!1};THREE.JSONLoader.prototype=Object.create(THREE.Loader.prototype);THREE.JSONLoader.prototype.load=function(b,d,c){c=c&&"string"===typeof c?c:this.extractUrlBase(b);this.onLoadStart();this.loadAjaxJSON(this,b,d,c)};
THREE.JSONLoader.prototype.loadAjaxJSON=function(b,d,c,e,f){var g=new XMLHttpRequest,h=0;g.onreadystatechange=function(){if(g.readyState===g.DONE)if(200===g.status||0===g.status){if(g.responseText){var k=JSON.parse(g.responseText),k=b.parse(k,e);c(k.geometry,k.materials)}else console.warn("THREE.JSONLoader: ["+d+"] seems to be unreachable or file there is empty");b.onLoadComplete()}else console.error("THREE.JSONLoader: Couldn't load ["+d+"] ["+g.status+"]");else g.readyState===g.LOADING?f&&(0===h&&
(h=g.getResponseHeader("Content-Length")),f({total:h,loaded:g.responseText.length})):g.readyState===g.HEADERS_RECEIVED&&void 0!==f&&(h=g.getResponseHeader("Content-Length"))};g.open("GET",d,!0);g.withCredentials=this.withCredentials;g.send(null)};
THREE.JSONLoader.prototype.parse=function(b,d){var c=new THREE.Geometry,e=void 0!==b.scale?1/b.scale:1,f,g,h,k,l,p,q,r,s,t,u,v,w,y,z,B=b.faces;t=b.vertices;var A=b.normals,K=b.colors,O=0;for(f=0;f<b.uvs.length;f++)b.uvs[f].length&&O++;for(f=0;f<O;f++)c.faceUvs[f]=[],c.faceVertexUvs[f]=[];k=0;for(l=t.length;k<l;)p=new THREE.Vector3,p.x=t[k++]*e,p.y=t[k++]*e,p.z=t[k++]*e,c.vertices.push(p);k=0;for(l=B.length;k<l;){t=B[k++];p=t&1;h=t&2;f=t&4;g=t&8;r=t&16;q=t&32;u=t&64;t&=128;p?(v=new THREE.Face4,v.a=
B[k++],v.b=B[k++],v.c=B[k++],v.d=B[k++],p=4):(v=new THREE.Face3,v.a=B[k++],v.b=B[k++],v.c=B[k++],p=3);h&&(h=B[k++],v.materialIndex=h);h=c.faces.length;if(f)for(f=0;f<O;f++)w=b.uvs[f],s=B[k++],z=w[2*s],s=w[2*s+1],c.faceUvs[f][h]=new THREE.Vector2(z,s);if(g)for(f=0;f<O;f++){w=b.uvs[f];y=[];for(g=0;g<p;g++)s=B[k++],z=w[2*s],s=w[2*s+1],y[g]=new THREE.Vector2(z,s);c.faceVertexUvs[f][h]=y}r&&(r=3*B[k++],g=new THREE.Vector3,g.x=A[r++],g.y=A[r++],g.z=A[r],v.normal=g);if(q)for(f=0;f<p;f++)r=3*B[k++],g=new THREE.Vector3,
g.x=A[r++],g.y=A[r++],g.z=A[r],v.vertexNormals.push(g);u&&(q=B[k++],q=new THREE.Color(K[q]),v.color=q);if(t)for(f=0;f<p;f++)q=B[k++],q=new THREE.Color(K[q]),v.vertexColors.push(q);c.faces.push(v)}if(b.skinWeights){k=0;for(l=b.skinWeights.length;k<l;k+=2)B=b.skinWeights[k],A=b.skinWeights[k+1],c.skinWeights.push(new THREE.Vector4(B,A,0,0))}if(b.skinIndices){k=0;for(l=b.skinIndices.length;k<l;k+=2)B=b.skinIndices[k],A=b.skinIndices[k+1],c.skinIndices.push(new THREE.Vector4(B,A,0,0))}c.bones=b.bones;
c.animation=b.animation;if(void 0!==b.morphTargets){k=0;for(l=b.morphTargets.length;k<l;k++){c.morphTargets[k]={};c.morphTargets[k].name=b.morphTargets[k].name;c.morphTargets[k].vertices=[];K=c.morphTargets[k].vertices;O=b.morphTargets[k].vertices;B=0;for(A=O.length;B<A;B+=3)t=new THREE.Vector3,t.x=O[B]*e,t.y=O[B+1]*e,t.z=O[B+2]*e,K.push(t)}}if(void 0!==b.morphColors){k=0;for(l=b.morphColors.length;k<l;k++){c.morphColors[k]={};c.morphColors[k].name=b.morphColors[k].name;c.morphColors[k].colors=[];
A=c.morphColors[k].colors;K=b.morphColors[k].colors;e=0;for(B=K.length;e<B;e+=3)O=new THREE.Color(16755200),O.setRGB(K[e],K[e+1],K[e+2]),A.push(O)}}c.computeCentroids();c.computeFaceNormals();if(void 0===b.materials)return{geometry:c};e=this.initMaterials(b.materials,d);this.needsTangents(e)&&c.computeTangents();return{geometry:c,materials:e}};
THREE.LoadingMonitor=function(){var b=this,d=0,c=0,e=function(){d++;b.dispatchEvent({type:"progress",loaded:d,total:c});d===c&&b.dispatchEvent({type:"load"})};this.add=function(b){c++;b.addEventListener("load",e,!1)}};THREE.LoadingMonitor.prototype={constructor:THREE.LoadingMonitor,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent};
THREE.GeometryLoader=function(){};
THREE.GeometryLoader.prototype={constructor:THREE.GeometryLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(b){var d=this,c=new XMLHttpRequest;c.addEventListener("load",function(b){b=d.parse(JSON.parse(b.target.responseText));d.dispatchEvent({type:"load",content:b})},
!1);c.addEventListener("progress",function(b){d.dispatchEvent({type:"progress",loaded:b.loaded,total:b.total})},!1);c.addEventListener("error",function(){d.dispatchEvent({type:"error",message:"Couldn't load URL ["+b+"]"})},!1);c.open("GET",b,!0);c.send(null)},parse:function(){}};THREE.MaterialLoader=function(){};
THREE.MaterialLoader.prototype={constructor:THREE.MaterialLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(b){var d=this,c=new XMLHttpRequest;c.addEventListener("load",function(b){b=d.parse(JSON.parse(b.target.responseText));d.dispatchEvent({type:"load",content:b})},
!1);c.addEventListener("progress",function(b){d.dispatchEvent({type:"progress",loaded:b.loaded,total:b.total})},!1);c.addEventListener("error",function(){d.dispatchEvent({type:"error",message:"Couldn't load URL ["+b+"]"})},!1);c.open("GET",b,!0);c.send(null)},parse:function(b){var d;switch(b.type){case "MeshBasicMaterial":d=new THREE.MeshBasicMaterial({color:b.color,opacity:b.opacity,transparent:b.transparent,wireframe:b.wireframe});break;case "MeshLambertMaterial":d=new THREE.MeshLambertMaterial({color:b.color,
ambient:b.ambient,emissive:b.emissive,opacity:b.opacity,transparent:b.transparent,wireframe:b.wireframe});break;case "MeshPhongMaterial":d=new THREE.MeshPhongMaterial({color:b.color,ambient:b.ambient,emissive:b.emissive,specular:b.specular,shininess:b.shininess,opacity:b.opacity,transparent:b.transparent,wireframe:b.wireframe});break;case "MeshNormalMaterial":d=new THREE.MeshNormalMaterial({opacity:b.opacity,transparent:b.transparent,wireframe:b.wireframe});break;case "MeshDepthMaterial":d=new THREE.MeshDepthMaterial({opacity:b.opacity,
transparent:b.transparent,wireframe:b.wireframe})}return d}};THREE.SceneLoader=function(){this.onLoadStart=function(){};this.onLoadProgress=function(){};this.onLoadComplete=function(){};this.callbackSync=function(){};this.callbackProgress=function(){};this.geometryHandlerMap={};this.hierarchyHandlerMap={};this.addGeometryHandler("ascii",THREE.JSONLoader)};THREE.SceneLoader.prototype.constructor=THREE.SceneLoader;
THREE.SceneLoader.prototype.load=function(b,d){var c=this,e=new XMLHttpRequest;e.onreadystatechange=function(){if(4===e.readyState)if(200===e.status||0===e.status){var f=JSON.parse(e.responseText);c.parse(f,d,b)}else console.error("THREE.SceneLoader: Couldn't load ["+b+"] ["+e.status+"]")};e.open("GET",b,!0);e.send(null)};THREE.SceneLoader.prototype.addGeometryHandler=function(b,d){this.geometryHandlerMap[b]={loaderClass:d}};
THREE.SceneLoader.prototype.addHierarchyHandler=function(b,d){this.hierarchyHandlerMap[b]={loaderClass:d}};
THREE.SceneLoader.prototype.parse=function(b,d,c){function e(b,c){return"relativeToHTML"==c?b:r+"/"+b}function f(){g(F.scene,H.objects)}function g(b,c){var d,f,h,l,p,r,v;for(v in c)if(void 0===F.objects[v]){var w=c[v],A=null;if(w.type&&w.type in q.hierarchyHandlerMap){if(void 0===w.loading){f={type:1,url:1,material:1,position:1,rotation:1,scale:1,visible:1,children:1,userData:1,skin:1,morph:1,mirroredLoop:1,duration:1};h={};for(var E in w)E in f||(h[E]=w[E]);t=F.materials[w.material];w.loading=!0;
f=q.hierarchyHandlerMap[w.type].loaderObject;f.options?f.load(e(w.url,H.urlBaseType),k(v,b,t,w)):f.load(e(w.url,H.urlBaseType),k(v,b,t,w),h)}}else if(void 0!==w.geometry){if(s=F.geometries[w.geometry]){t=F.materials[w.material];A=t instanceof THREE.ShaderMaterial;h=w.position;l=w.rotation;p=w.scale;d=w.matrix;r=w.quaternion;w.material||(t=new THREE.MeshFaceMaterial(F.face_materials[w.geometry]));t instanceof THREE.MeshFaceMaterial&&0===t.materials.length&&(t=new THREE.MeshFaceMaterial(F.face_materials[w.geometry]));
if(t instanceof THREE.MeshFaceMaterial)for(f=0;f<t.materials.length;f++)A=A||t.materials[f]instanceof THREE.ShaderMaterial;A&&s.computeTangents();w.skin?A=new THREE.SkinnedMesh(s,t):w.morph?(A=new THREE.MorphAnimMesh(s,t),void 0!==w.duration&&(A.duration=w.duration),void 0!==w.time&&(A.time=w.time),void 0!==w.mirroredLoop&&(A.mirroredLoop=w.mirroredLoop),t.morphNormals&&s.computeMorphNormals()):A=new THREE.Mesh(s,t);A.name=v;d?(A.matrixAutoUpdate=!1,A.matrix.set(d[0],d[1],d[2],d[3],d[4],d[5],d[6],
d[7],d[8],d[9],d[10],d[11],d[12],d[13],d[14],d[15])):(A.position.set(h[0],h[1],h[2]),r?(A.quaternion.set(r[0],r[1],r[2],r[3]),A.useQuaternion=!0):A.rotation.set(l[0],l[1],l[2]),A.scale.set(p[0],p[1],p[2]));A.visible=w.visible;A.castShadow=w.castShadow;A.receiveShadow=w.receiveShadow;b.add(A);F.objects[v]=A}}else"DirectionalLight"===w.type||"PointLight"===w.type||"AmbientLight"===w.type?(z=void 0!==w.color?w.color:16777215,B=void 0!==w.intensity?w.intensity:1,"DirectionalLight"===w.type?(h=w.direction,
y=new THREE.DirectionalLight(z,B),y.position.set(h[0],h[1],h[2]),w.target&&(U.push({object:y,targetName:w.target}),y.target=null)):"PointLight"===w.type?(h=w.position,f=w.distance,y=new THREE.PointLight(z,B,f),y.position.set(h[0],h[1],h[2])):"AmbientLight"===w.type&&(y=new THREE.AmbientLight(z)),b.add(y),y.name=v,F.lights[v]=y,F.objects[v]=y):"PerspectiveCamera"===w.type||"OrthographicCamera"===w.type?(h=w.position,l=w.rotation,r=w.quaternion,"PerspectiveCamera"===w.type?u=new THREE.PerspectiveCamera(w.fov,
w.aspect,w.near,w.far):"OrthographicCamera"===w.type&&(u=new THREE.OrthographicCamera(w.left,w.right,w.top,w.bottom,w.near,w.far)),u.name=v,u.position.set(h[0],h[1],h[2]),void 0!==r?(u.quaternion.set(r[0],r[1],r[2],r[3]),u.useQuaternion=!0):void 0!==l&&u.rotation.set(l[0],l[1],l[2]),b.add(u),F.cameras[v]=u,F.objects[v]=u):(h=w.position,l=w.rotation,p=w.scale,r=w.quaternion,A=new THREE.Object3D,A.name=v,A.position.set(h[0],h[1],h[2]),r?(A.quaternion.set(r[0],r[1],r[2],r[3]),A.useQuaternion=!0):A.rotation.set(l[0],
l[1],l[2]),A.scale.set(p[0],p[1],p[2]),A.visible=void 0!==w.visible?w.visible:!1,b.add(A),F.objects[v]=A,F.empties[v]=A);if(A){if(void 0!==w.userData)for(var O in w.userData)A.userData[O]=w.userData[O];if(void 0!==w.groups)for(f=0;f<w.groups.length;f++)h=w.groups[f],void 0===F.groups[h]&&(F.groups[h]=[]),F.groups[h].push(v);void 0!==w.children&&g(A,w.children)}}}function h(b){return function(c,e){c.name=b;F.geometries[b]=c;F.face_materials[b]=e;f();A-=1;q.onLoadComplete();p()}}function k(b,c,e,d){return function(g){g=
g.content?g.content:g.dae?g.scene:g;var h=d.position,k=d.rotation,l=d.quaternion,r=d.scale;g.position.set(h[0],h[1],h[2]);l?(g.quaternion.set(l[0],l[1],l[2],l[3]),g.useQuaternion=!0):g.rotation.set(k[0],k[1],k[2]);g.scale.set(r[0],r[1],r[2]);e&&g.traverse(function(b){b.material=e});var s=void 0!==d.visible?d.visible:!0;g.traverse(function(b){b.visible=s});c.add(g);g.name=b;F.objects[b]=g;f();A-=1;q.onLoadComplete();p()}}function l(b){return function(c,e){c.name=b;F.geometries[b]=c;F.face_materials[b]=
e}}function p(){q.callbackProgress({totalModels:O,totalTextures:E,loadedModels:O-A,loadedTextures:E-K},F);q.onLoadProgress();if(0===A&&0===K){for(var b=0;b<U.length;b++){var c=U[b],e=F.objects[c.targetName];e?c.object.target=e:(c.object.target=new THREE.Object3D,F.scene.add(c.object.target));c.object.target.userData.targetInverse=c.object}d(F)}}var q=this,r=THREE.Loader.prototype.extractUrlBase(c),s,t,u,v,w,y,z,B,A,K,O,E,F,U=[],H=b,G;for(G in this.geometryHandlerMap)b=this.geometryHandlerMap[G].loaderClass,
this.geometryHandlerMap[G].loaderObject=new b;for(G in this.hierarchyHandlerMap)b=this.hierarchyHandlerMap[G].loaderClass,this.hierarchyHandlerMap[G].loaderObject=new b;K=A=0;F={scene:new THREE.Scene,geometries:{},face_materials:{},materials:{},textures:{},objects:{},cameras:{},lights:{},fogs:{},empties:{},groups:{}};if(H.transform&&(G=H.transform.position,b=H.transform.rotation,c=H.transform.scale,G&&F.scene.position.set(G[0],G[1],G[2]),b&&F.scene.rotation.set(b[0],b[1],b[2]),c&&F.scene.scale.set(c[0],
c[1],c[2]),G||b||c))F.scene.updateMatrix(),F.scene.updateMatrixWorld();G=function(b){return function(){K-=b;p();q.onLoadComplete()}};for(var aa in H.fogs)b=H.fogs[aa],"linear"===b.type?v=new THREE.Fog(0,b.near,b.far):"exp2"===b.type&&(v=new THREE.FogExp2(0,b.density)),b=b.color,v.color.setRGB(b[0],b[1],b[2]),F.fogs[aa]=v;for(var D in H.geometries)v=H.geometries[D],v.type in this.geometryHandlerMap&&(A+=1,q.onLoadStart());for(var M in H.objects)v=H.objects[M],v.type&&v.type in this.hierarchyHandlerMap&&
(A+=1,q.onLoadStart());O=A;for(D in H.geometries)if(v=H.geometries[D],"cube"===v.type)s=new THREE.CubeGeometry(v.width,v.height,v.depth,v.widthSegments,v.heightSegments,v.depthSegments),s.name=D,F.geometries[D]=s;else if("plane"===v.type)s=new THREE.PlaneGeometry(v.width,v.height,v.widthSegments,v.heightSegments),s.name=D,F.geometries[D]=s;else if("sphere"===v.type)s=new THREE.SphereGeometry(v.radius,v.widthSegments,v.heightSegments),s.name=D,F.geometries[D]=s;else if("cylinder"===v.type)s=new THREE.CylinderGeometry(v.topRad,
v.botRad,v.height,v.radSegs,v.heightSegs),s.name=D,F.geometries[D]=s;else if("torus"===v.type)s=new THREE.TorusGeometry(v.radius,v.tube,v.segmentsR,v.segmentsT),s.name=D,F.geometries[D]=s;else if("icosahedron"===v.type)s=new THREE.IcosahedronGeometry(v.radius,v.subdivisions),s.name=D,F.geometries[D]=s;else if(v.type in this.geometryHandlerMap){M={};for(w in v)"type"!==w&&"url"!==w&&(M[w]=v[w]);this.geometryHandlerMap[v.type].loaderObject.load(e(v.url,H.urlBaseType),h(D),M)}else"embedded"===v.type&&
(M=H.embeds[v.id],M.metadata=H.metadata,M&&(M=this.geometryHandlerMap.ascii.loaderObject.parse(M,""),l(D)(M.geometry,M.materials)));for(var I in H.textures)if(D=H.textures[I],D.url instanceof Array){K+=D.url.length;for(w=0;w<D.url.length;w++)q.onLoadStart()}else K+=1,q.onLoadStart();E=K;for(I in H.textures){D=H.textures[I];void 0!==D.mapping&&void 0!==THREE[D.mapping]&&(D.mapping=new THREE[D.mapping]);if(D.url instanceof Array){M=D.url.length;v=[];for(w=0;w<M;w++)v[w]=e(D.url[w],H.urlBaseType);w=
(w=/\.dds$/i.test(v[0]))?THREE.ImageUtils.loadCompressedTextureCube(v,D.mapping,G(M)):THREE.ImageUtils.loadTextureCube(v,D.mapping,G(M))}else w=/\.dds$/i.test(D.url),M=e(D.url,H.urlBaseType),v=G(1),w=w?THREE.ImageUtils.loadCompressedTexture(M,D.mapping,v):THREE.ImageUtils.loadTexture(M,D.mapping,v),void 0!==THREE[D.minFilter]&&(w.minFilter=THREE[D.minFilter]),void 0!==THREE[D.magFilter]&&(w.magFilter=THREE[D.magFilter]),D.anisotropy&&(w.anisotropy=D.anisotropy),D.repeat&&(w.repeat.set(D.repeat[0],
D.repeat[1]),1!==D.repeat[0]&&(w.wrapS=THREE.RepeatWrapping),1!==D.repeat[1]&&(w.wrapT=THREE.RepeatWrapping)),D.offset&&w.offset.set(D.offset[0],D.offset[1]),D.wrap&&(M={repeat:THREE.RepeatWrapping,mirror:THREE.MirroredRepeatWrapping},void 0!==M[D.wrap[0]]&&(w.wrapS=M[D.wrap[0]]),void 0!==M[D.wrap[1]]&&(w.wrapT=M[D.wrap[1]]));F.textures[I]=w}var Q,V;for(Q in H.materials){I=H.materials[Q];for(V in I.parameters)"envMap"===V||"map"===V||"lightMap"===V||"bumpMap"===V?I.parameters[V]=F.textures[I.parameters[V]]:
"shading"===V?I.parameters[V]="flat"===I.parameters[V]?THREE.FlatShading:THREE.SmoothShading:"side"===V?I.parameters[V]="double"==I.parameters[V]?THREE.DoubleSide:"back"==I.parameters[V]?THREE.BackSide:THREE.FrontSide:"blending"===V?I.parameters[V]=I.parameters[V]in THREE?THREE[I.parameters[V]]:THREE.NormalBlending:"combine"===V?I.parameters[V]=I.parameters[V]in THREE?THREE[I.parameters[V]]:THREE.MultiplyOperation:"vertexColors"===V?"face"==I.parameters[V]?I.parameters[V]=THREE.FaceColors:I.parameters[V]&&
(I.parameters[V]=THREE.VertexColors):"wrapRGB"===V&&(G=I.parameters[V],I.parameters[V]=new THREE.Vector3(G[0],G[1],G[2]));void 0!==I.parameters.opacity&&1>I.parameters.opacity&&(I.parameters.transparent=!0);I.parameters.normalMap?(G=THREE.ShaderLib.normalmap,D=THREE.UniformsUtils.clone(G.uniforms),w=I.parameters.color,M=I.parameters.specular,v=I.parameters.ambient,aa=I.parameters.shininess,D.tNormal.value=F.textures[I.parameters.normalMap],I.parameters.normalScale&&D.uNormalScale.value.set(I.parameters.normalScale[0],
I.parameters.normalScale[1]),I.parameters.map&&(D.tDiffuse.value=I.parameters.map,D.enableDiffuse.value=!0),I.parameters.envMap&&(D.tCube.value=I.parameters.envMap,D.enableReflection.value=!0,D.uReflectivity.value=I.parameters.reflectivity),I.parameters.lightMap&&(D.tAO.value=I.parameters.lightMap,D.enableAO.value=!0),I.parameters.specularMap&&(D.tSpecular.value=F.textures[I.parameters.specularMap],D.enableSpecular.value=!0),I.parameters.displacementMap&&(D.tDisplacement.value=F.textures[I.parameters.displacementMap],
D.enableDisplacement.value=!0,D.uDisplacementBias.value=I.parameters.displacementBias,D.uDisplacementScale.value=I.parameters.displacementScale),D.uDiffuseColor.value.setHex(w),D.uSpecularColor.value.setHex(M),D.uAmbientColor.value.setHex(v),D.uShininess.value=aa,I.parameters.opacity&&(D.uOpacity.value=I.parameters.opacity),t=new THREE.ShaderMaterial({fragmentShader:G.fragmentShader,vertexShader:G.vertexShader,uniforms:D,lights:!0,fog:!0})):t=new THREE[I.type](I.parameters);t.name=Q;F.materials[Q]=
t}for(Q in H.materials)if(I=H.materials[Q],I.parameters.materials){V=[];for(w=0;w<I.parameters.materials.length;w++)V.push(F.materials[I.parameters.materials[w]]);F.materials[Q].materials=V}f();F.cameras&&H.defaults.camera&&(F.currentCamera=F.cameras[H.defaults.camera]);F.fogs&&H.defaults.fog&&(F.scene.fog=F.fogs[H.defaults.fog]);q.callbackSync(F);p()};THREE.TextureLoader=function(){this.crossOrigin=null};
THREE.TextureLoader.prototype={constructor:THREE.TextureLoader,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,load:function(b){var d=this,c=new Image;c.addEventListener("load",function(){var b=new THREE.Texture(c);b.needsUpdate=!0;d.dispatchEvent({type:"load",content:b})},!1);c.addEventListener("error",
function(){d.dispatchEvent({type:"error",message:"Couldn't load URL ["+b+"]"})},!1);d.crossOrigin&&(c.crossOrigin=d.crossOrigin);c.src=b}};
THREE.Material=function(){this.id=THREE.MaterialIdCount++;this.name="";this.side=THREE.FrontSide;this.opacity=1;this.transparent=!1;this.blending=THREE.NormalBlending;this.blendSrc=THREE.SrcAlphaFactor;this.blendDst=THREE.OneMinusSrcAlphaFactor;this.blendEquation=THREE.AddEquation;this.depthWrite=this.depthTest=!0;this.polygonOffset=!1;this.alphaTest=this.polygonOffsetUnits=this.polygonOffsetFactor=0;this.overdraw=!1;this.needsUpdate=this.visible=!0};
THREE.Material.prototype={constructor:THREE.Material,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,setValues:function(b){if(void 0!==b)for(var d in b){var c=b[d];if(void 0===c)console.warn("THREE.Material: '"+d+"' parameter is undefined.");else if(d in this){var e=this[d];e instanceof
THREE.Color?e.set(c):e instanceof THREE.Vector3&&c instanceof THREE.Vector3?e.copy(c):this[d]=c}}},clone:function(b){void 0===b&&(b=new THREE.Material);b.name=this.name;b.side=this.side;b.opacity=this.opacity;b.transparent=this.transparent;b.blending=this.blending;b.blendSrc=this.blendSrc;b.blendDst=this.blendDst;b.blendEquation=this.blendEquation;b.depthTest=this.depthTest;b.depthWrite=this.depthWrite;b.polygonOffset=this.polygonOffset;b.polygonOffsetFactor=this.polygonOffsetFactor;b.polygonOffsetUnits=
this.polygonOffsetUnits;b.alphaTest=this.alphaTest;b.overdraw=this.overdraw;b.visible=this.visible;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.MaterialIdCount=0;THREE.LineBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.linewidth=1;this.linejoin=this.linecap="round";this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.LineBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.LineBasicMaterial.prototype.clone=function(){var b=new THREE.LineBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.linewidth=this.linewidth;b.linecap=this.linecap;b.linejoin=this.linejoin;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.LineDashedMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.scale=this.linewidth=1;this.dashSize=3;this.gapSize=1;this.vertexColors=!1;this.fog=!0;this.setValues(b)};
THREE.LineDashedMaterial.prototype=Object.create(THREE.Material.prototype);THREE.LineDashedMaterial.prototype.clone=function(){var b=new THREE.LineDashedMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.linewidth=this.linewidth;b.scale=this.scale;b.dashSize=this.dashSize;b.gapSize=this.gapSize;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};
THREE.MeshBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphTargets=this.skinning=!1;this.setValues(b)};
THREE.MeshBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshBasicMaterial.prototype.clone=function(){var b=new THREE.MeshBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.lightMap=this.lightMap;b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=
this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;return b};
THREE.MeshLambertMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.envMap=this.specularMap=this.lightMap=this.map=null;this.combine=THREE.MultiplyOperation;this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
"round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshLambertMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshLambertMaterial.prototype.clone=function(){var b=new THREE.MeshLambertMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.ambient.copy(this.ambient);b.emissive.copy(this.emissive);b.wrapAround=this.wrapAround;b.wrapRGB.copy(this.wrapRGB);b.map=this.map;b.lightMap=this.lightMap;b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;
b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};
THREE.MeshPhongMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.ambient=new THREE.Color(16777215);this.emissive=new THREE.Color(0);this.specular=new THREE.Color(1118481);this.shininess=30;this.metal=!1;this.perPixel=!0;this.wrapAround=!1;this.wrapRGB=new THREE.Vector3(1,1,1);this.bumpMap=this.lightMap=this.map=null;this.bumpScale=1;this.normalMap=null;this.normalScale=new THREE.Vector2(1,1);this.envMap=this.specularMap=null;this.combine=THREE.MultiplyOperation;
this.reflectivity=1;this.refractionRatio=0.98;this.fog=!0;this.shading=THREE.SmoothShading;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap="round";this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.MeshPhongMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.MeshPhongMaterial.prototype.clone=function(){var b=new THREE.MeshPhongMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.ambient.copy(this.ambient);b.emissive.copy(this.emissive);b.specular.copy(this.specular);b.shininess=this.shininess;b.metal=this.metal;b.perPixel=this.perPixel;b.wrapAround=this.wrapAround;b.wrapRGB.copy(this.wrapRGB);b.map=this.map;b.lightMap=this.lightMap;b.bumpMap=this.bumpMap;b.bumpScale=this.bumpScale;b.normalMap=this.normalMap;b.normalScale.copy(this.normalScale);
b.specularMap=this.specularMap;b.envMap=this.envMap;b.combine=this.combine;b.reflectivity=this.reflectivity;b.refractionRatio=this.refractionRatio;b.fog=this.fog;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.wireframeLinecap=this.wireframeLinecap;b.wireframeLinejoin=this.wireframeLinejoin;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=this.morphTargets;b.morphNormals=this.morphNormals;return b};
THREE.MeshDepthMaterial=function(b){THREE.Material.call(this);this.wireframe=!1;this.wireframeLinewidth=1;this.setValues(b)};THREE.MeshDepthMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshDepthMaterial.prototype.clone=function(){var b=new THREE.MeshDepthMaterial;THREE.Material.prototype.clone.call(this,b);b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;return b};
THREE.MeshNormalMaterial=function(b){THREE.Material.call(this,b);this.shading=THREE.FlatShading;this.wireframe=!1;this.wireframeLinewidth=1;this.morphTargets=!1;this.setValues(b)};THREE.MeshNormalMaterial.prototype=Object.create(THREE.Material.prototype);THREE.MeshNormalMaterial.prototype.clone=function(){var b=new THREE.MeshNormalMaterial;THREE.Material.prototype.clone.call(this,b);b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;return b};
THREE.MeshFaceMaterial=function(b){this.materials=b instanceof Array?b:[]};THREE.MeshFaceMaterial.prototype.clone=function(){return new THREE.MeshFaceMaterial(this.materials.slice(0))};THREE.ParticleBasicMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=null;this.size=1;this.sizeAttenuation=!0;this.vertexColors=!1;this.fog=!0;this.setValues(b)};THREE.ParticleBasicMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleBasicMaterial.prototype.clone=function(){var b=new THREE.ParticleBasicMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.size=this.size;b.sizeAttenuation=this.sizeAttenuation;b.vertexColors=this.vertexColors;b.fog=this.fog;return b};THREE.ParticleCanvasMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.program=function(){};this.setValues(b)};THREE.ParticleCanvasMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ParticleCanvasMaterial.prototype.clone=function(){var b=new THREE.ParticleCanvasMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.program=this.program;return b};
THREE.ShaderMaterial=function(b){THREE.Material.call(this);this.vertexShader=this.fragmentShader="void main() {}";this.uniforms={};this.defines={};this.attributes=null;this.shading=THREE.SmoothShading;this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.vertexColors=THREE.NoColors;this.morphNormals=this.morphTargets=this.skinning=!1;this.setValues(b)};THREE.ShaderMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.ShaderMaterial.prototype.clone=function(){var b=new THREE.ShaderMaterial;THREE.Material.prototype.clone.call(this,b);b.fragmentShader=this.fragmentShader;b.vertexShader=this.vertexShader;b.uniforms=THREE.UniformsUtils.clone(this.uniforms);b.attributes=this.attributes;b.defines=this.defines;b.shading=this.shading;b.wireframe=this.wireframe;b.wireframeLinewidth=this.wireframeLinewidth;b.fog=this.fog;b.lights=this.lights;b.vertexColors=this.vertexColors;b.skinning=this.skinning;b.morphTargets=
this.morphTargets;b.morphNormals=this.morphNormals;return b};
THREE.SpriteMaterial=function(b){THREE.Material.call(this);this.color=new THREE.Color(16777215);this.map=new THREE.Texture;this.useScreenCoordinates=!0;this.depthTest=!this.useScreenCoordinates;this.sizeAttenuation=!this.useScreenCoordinates;this.scaleByViewport=!this.sizeAttenuation;this.alignment=THREE.SpriteAlignment.center.clone();this.fog=!1;this.uvOffset=new THREE.Vector2(0,0);this.uvScale=new THREE.Vector2(1,1);this.setValues(b);b=b||{};void 0===b.depthTest&&(this.depthTest=!this.useScreenCoordinates);
void 0===b.sizeAttenuation&&(this.sizeAttenuation=!this.useScreenCoordinates);void 0===b.scaleByViewport&&(this.scaleByViewport=!this.sizeAttenuation)};THREE.SpriteMaterial.prototype=Object.create(THREE.Material.prototype);
THREE.SpriteMaterial.prototype.clone=function(){var b=new THREE.SpriteMaterial;THREE.Material.prototype.clone.call(this,b);b.color.copy(this.color);b.map=this.map;b.useScreenCoordinates=this.useScreenCoordinates;b.sizeAttenuation=this.sizeAttenuation;b.scaleByViewport=this.scaleByViewport;b.alignment.copy(this.alignment);b.uvOffset.copy(this.uvOffset);b.uvScale.copy(this.uvScale);b.fog=this.fog;return b};THREE.SpriteAlignment={};THREE.SpriteAlignment.topLeft=new THREE.Vector2(1,-1);
THREE.SpriteAlignment.topCenter=new THREE.Vector2(0,-1);THREE.SpriteAlignment.topRight=new THREE.Vector2(-1,-1);THREE.SpriteAlignment.centerLeft=new THREE.Vector2(1,0);THREE.SpriteAlignment.center=new THREE.Vector2(0,0);THREE.SpriteAlignment.centerRight=new THREE.Vector2(-1,0);THREE.SpriteAlignment.bottomLeft=new THREE.Vector2(1,1);THREE.SpriteAlignment.bottomCenter=new THREE.Vector2(0,1);THREE.SpriteAlignment.bottomRight=new THREE.Vector2(-1,1);
THREE.Texture=function(b,d,c,e,f,g,h,k,l){this.id=THREE.TextureIdCount++;this.name="";this.image=b;this.mipmaps=[];this.mapping=void 0!==d?d:new THREE.UVMapping;this.wrapS=void 0!==c?c:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==e?e:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==f?f:THREE.LinearFilter;this.minFilter=void 0!==g?g:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==l?l:1;this.format=void 0!==h?h:THREE.RGBAFormat;this.type=void 0!==k?k:THREE.UnsignedByteType;this.offset=new THREE.Vector2(0,
0);this.repeat=new THREE.Vector2(1,1);this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.needsUpdate=!1;this.onUpdate=null};
THREE.Texture.prototype={constructor:THREE.Texture,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(b){void 0===b&&(b=new THREE.Texture);b.image=this.image;b.mipmaps=this.mipmaps.slice(0);b.mapping=this.mapping;b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;
b.minFilter=this.minFilter;b.anisotropy=this.anisotropy;b.format=this.format;b.type=this.type;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.generateMipmaps=this.generateMipmaps;b.premultiplyAlpha=this.premultiplyAlpha;b.flipY=this.flipY;b.unpackAlignment=this.unpackAlignment;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.TextureIdCount=0;
THREE.CompressedTexture=function(b,d,c,e,f,g,h,k,l,p,q){THREE.Texture.call(this,null,g,h,k,l,p,e,f,q);this.image={width:d,height:c};this.mipmaps=b;this.generateMipmaps=!1};THREE.CompressedTexture.prototype=Object.create(THREE.Texture.prototype);THREE.CompressedTexture.prototype.clone=function(){var b=new THREE.CompressedTexture;THREE.Texture.prototype.clone.call(this,b);return b};
THREE.DataTexture=function(b,d,c,e,f,g,h,k,l,p,q){THREE.Texture.call(this,null,g,h,k,l,p,e,f,q);this.image={data:b,width:d,height:c}};THREE.DataTexture.prototype=Object.create(THREE.Texture.prototype);THREE.DataTexture.prototype.clone=function(){var b=new THREE.DataTexture;THREE.Texture.prototype.clone.call(this,b);return b};THREE.Particle=function(b){THREE.Object3D.call(this);this.material=b};THREE.Particle.prototype=Object.create(THREE.Object3D.prototype);
THREE.Particle.prototype.clone=function(b){void 0===b&&(b=new THREE.Particle(this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.ParticleSystem=function(b,d){THREE.Object3D.call(this);this.geometry=b;this.material=void 0!==d?d:new THREE.ParticleBasicMaterial({color:16777215*Math.random()});this.sortParticles=!1;this.geometry&&null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere();this.frustumCulled=!1};THREE.ParticleSystem.prototype=Object.create(THREE.Object3D.prototype);
THREE.ParticleSystem.prototype.clone=function(b){void 0===b&&(b=new THREE.ParticleSystem(this.geometry,this.material));b.sortParticles=this.sortParticles;THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Line=function(b,d,c){THREE.Object3D.call(this);this.geometry=b;this.material=void 0!==d?d:new THREE.LineBasicMaterial({color:16777215*Math.random()});this.type=void 0!==c?c:THREE.LineStrip;this.geometry&&(this.geometry.boundingSphere||this.geometry.computeBoundingSphere())};
THREE.LineStrip=0;THREE.LinePieces=1;THREE.Line.prototype=Object.create(THREE.Object3D.prototype);THREE.Line.prototype.clone=function(b){void 0===b&&(b=new THREE.Line(this.geometry,this.material,this.type));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Mesh=function(b,d){THREE.Object3D.call(this);this.material=this.geometry=null;this.setGeometry(b);this.setMaterial(d)};THREE.Mesh.prototype=Object.create(THREE.Object3D.prototype);
THREE.Mesh.prototype.setGeometry=function(b){void 0!==b&&(this.geometry=b,null===this.geometry.boundingSphere&&this.geometry.computeBoundingSphere(),this.updateMorphTargets())};THREE.Mesh.prototype.setMaterial=function(b){this.material=void 0!==b?b:new THREE.MeshBasicMaterial({color:16777215*Math.random(),wireframe:!0})};
THREE.Mesh.prototype.updateMorphTargets=function(){if(0<this.geometry.morphTargets.length){this.morphTargetBase=-1;this.morphTargetForcedOrder=[];this.morphTargetInfluences=[];this.morphTargetDictionary={};for(var b=0,d=this.geometry.morphTargets.length;b<d;b++)this.morphTargetInfluences.push(0),this.morphTargetDictionary[this.geometry.morphTargets[b].name]=b}};
THREE.Mesh.prototype.getMorphTargetIndexByName=function(b){if(void 0!==this.morphTargetDictionary[b])return this.morphTargetDictionary[b];console.log("THREE.Mesh.getMorphTargetIndexByName: morph target "+b+" does not exist. Returning 0.");return 0};THREE.Mesh.prototype.clone=function(b){void 0===b&&(b=new THREE.Mesh(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Bone=function(b){THREE.Object3D.call(this);this.skin=b;this.skinMatrix=new THREE.Matrix4};
THREE.Bone.prototype=Object.create(THREE.Object3D.prototype);THREE.Bone.prototype.update=function(b,d){this.matrixAutoUpdate&&(d|=this.updateMatrix());if(d||this.matrixWorldNeedsUpdate)b?this.skinMatrix.multiplyMatrices(b,this.matrix):this.skinMatrix.copy(this.matrix),this.matrixWorldNeedsUpdate=!1,d=!0;var c,e=this.children.length;for(c=0;c<e;c++)this.children[c].update(this.skinMatrix,d)};
THREE.SkinnedMesh=function(b,d,c){THREE.Mesh.call(this,b,d);this.useVertexTexture=void 0!==c?c:!0;this.identityMatrix=new THREE.Matrix4;this.bones=[];this.boneMatrices=[];var e,f,g;if(this.geometry&&void 0!==this.geometry.bones){for(b=0;b<this.geometry.bones.length;b++)c=this.geometry.bones[b],e=c.pos,f=c.rotq,g=c.scl,d=this.addBone(),d.name=c.name,d.position.set(e[0],e[1],e[2]),d.quaternion.set(f[0],f[1],f[2],f[3]),d.useQuaternion=!0,void 0!==g?d.scale.set(g[0],g[1],g[2]):d.scale.set(1,1,1);for(b=
0;b<this.bones.length;b++)c=this.geometry.bones[b],d=this.bones[b],-1===c.parent?this.add(d):this.bones[c.parent].add(d);b=this.bones.length;this.useVertexTexture?(this.boneTextureHeight=this.boneTextureWidth=256<b?64:64<b?32:16<b?16:8,this.boneMatrices=new Float32Array(4*this.boneTextureWidth*this.boneTextureHeight),this.boneTexture=new THREE.DataTexture(this.boneMatrices,this.boneTextureWidth,this.boneTextureHeight,THREE.RGBAFormat,THREE.FloatType),this.boneTexture.minFilter=THREE.NearestFilter,
this.boneTexture.magFilter=THREE.NearestFilter,this.boneTexture.generateMipmaps=!1,this.boneTexture.flipY=!1):this.boneMatrices=new Float32Array(16*b);this.pose()}};THREE.SkinnedMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.SkinnedMesh.prototype.addBone=function(b){void 0===b&&(b=new THREE.Bone(this));this.bones.push(b);return b};
THREE.SkinnedMesh.prototype.updateMatrixWorld=function(b){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||b)this.parent?this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix):this.matrixWorld.copy(this.matrix),this.matrixWorldNeedsUpdate=!1;b=0;for(var d=this.children.length;b<d;b++){var c=this.children[b];c instanceof THREE.Bone?c.update(this.identityMatrix,!1):c.updateMatrixWorld(!0)}if(void 0==this.boneInverses){this.boneInverses=[];b=0;for(d=this.bones.length;b<
d;b++)c=new THREE.Matrix4,c.getInverse(this.bones[b].skinMatrix),this.boneInverses.push(c)}b=0;for(d=this.bones.length;b<d;b++)THREE.SkinnedMesh.offsetMatrix.multiplyMatrices(this.bones[b].skinMatrix,this.boneInverses[b]),THREE.SkinnedMesh.offsetMatrix.flattenToArrayOffset(this.boneMatrices,16*b);this.useVertexTexture&&(this.boneTexture.needsUpdate=!0)};
THREE.SkinnedMesh.prototype.pose=function(){this.updateMatrixWorld(!0);for(var b=0;b<this.geometry.skinIndices.length;b++){var d=this.geometry.skinWeights[b],c=1/d.lengthManhattan();Infinity!==c?d.multiplyScalar(c):d.set(1)}};THREE.SkinnedMesh.prototype.clone=function(b){void 0===b&&(b=new THREE.SkinnedMesh(this.geometry,this.material,this.useVertexTexture));THREE.Mesh.prototype.clone.call(this,b);return b};THREE.SkinnedMesh.offsetMatrix=new THREE.Matrix4;
THREE.MorphAnimMesh=function(b,d){THREE.Mesh.call(this,b,d);this.duration=1E3;this.mirroredLoop=!1;this.currentKeyframe=this.lastKeyframe=this.time=0;this.direction=1;this.directionBackwards=!1;this.setFrameRange(0,this.geometry.morphTargets.length-1)};THREE.MorphAnimMesh.prototype=Object.create(THREE.Mesh.prototype);THREE.MorphAnimMesh.prototype.setFrameRange=function(b,d){this.startKeyframe=b;this.endKeyframe=d;this.length=this.endKeyframe-this.startKeyframe+1};
THREE.MorphAnimMesh.prototype.setDirectionForward=function(){this.direction=1;this.directionBackwards=!1};THREE.MorphAnimMesh.prototype.setDirectionBackward=function(){this.direction=-1;this.directionBackwards=!0};
THREE.MorphAnimMesh.prototype.parseAnimations=function(){var b=this.geometry;b.animations||(b.animations={});for(var d,c=b.animations,e=/([a-z]+)(\d+)/,f=0,g=b.morphTargets.length;f<g;f++){var h=b.morphTargets[f].name.match(e);if(h&&1<h.length){h=h[1];c[h]||(c[h]={start:Infinity,end:-Infinity});var k=c[h];f<k.start&&(k.start=f);f>k.end&&(k.end=f);d||(d=h)}}b.firstAnimation=d};
THREE.MorphAnimMesh.prototype.setAnimationLabel=function(b,d,c){this.geometry.animations||(this.geometry.animations={});this.geometry.animations[b]={start:d,end:c}};THREE.MorphAnimMesh.prototype.playAnimation=function(b,d){var c=this.geometry.animations[b];c?(this.setFrameRange(c.start,c.end),this.duration=1E3*((c.end-c.start)/d),this.time=0):console.warn("animation["+b+"] undefined")};
THREE.MorphAnimMesh.prototype.updateAnimation=function(b){var d=this.duration/this.length;this.time+=this.direction*b;if(this.mirroredLoop){if(this.time>this.duration||0>this.time)this.direction*=-1,this.time>this.duration&&(this.time=this.duration,this.directionBackwards=!0),0>this.time&&(this.time=0,this.directionBackwards=!1)}else this.time%=this.duration,0>this.time&&(this.time+=this.duration);b=this.startKeyframe+THREE.Math.clamp(Math.floor(this.time/d),0,this.length-1);b!==this.currentKeyframe&&
(this.morphTargetInfluences[this.lastKeyframe]=0,this.morphTargetInfluences[this.currentKeyframe]=1,this.morphTargetInfluences[b]=0,this.lastKeyframe=this.currentKeyframe,this.currentKeyframe=b);d=this.time%d/d;this.directionBackwards&&(d=1-d);this.morphTargetInfluences[this.currentKeyframe]=d;this.morphTargetInfluences[this.lastKeyframe]=1-d};
THREE.MorphAnimMesh.prototype.clone=function(b){void 0===b&&(b=new THREE.MorphAnimMesh(this.geometry,this.material));b.duration=this.duration;b.mirroredLoop=this.mirroredLoop;b.time=this.time;b.lastKeyframe=this.lastKeyframe;b.currentKeyframe=this.currentKeyframe;b.direction=this.direction;b.directionBackwards=this.directionBackwards;THREE.Mesh.prototype.clone.call(this,b);return b};THREE.Ribbon=function(b,d){THREE.Object3D.call(this);this.geometry=b;this.material=d};THREE.Ribbon.prototype=Object.create(THREE.Object3D.prototype);
THREE.Ribbon.prototype.clone=function(b){void 0===b&&(b=new THREE.Ribbon(this.geometry,this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.LOD=function(){THREE.Object3D.call(this);this.objects=[]};THREE.LOD.prototype=Object.create(THREE.Object3D.prototype);THREE.LOD.prototype.addLevel=function(b,d){void 0===d&&(d=0);d=Math.abs(d);for(var c=0;c<this.objects.length&&!(d<this.objects[c].distance);c++);this.objects.splice(c,0,{distance:d,object:b});this.add(b)};
THREE.LOD.prototype.getObjectForDistance=function(b){for(var d=1,c=this.objects.length;d<c&&!(b<this.objects[d].distance);d++);return this.objects[d-1].object};
THREE.LOD.prototype.update=function(){var b=new THREE.Vector3,d=new THREE.Vector3;return function(c){if(1<this.objects.length){b.getPositionFromMatrix(c.matrixWorld);d.getPositionFromMatrix(this.matrixWorld);c=b.distanceTo(d);this.objects[0].object.visible=!0;for(var e=1,f=this.objects.length;e<f;e++)if(c>=this.objects[e].distance)this.objects[e-1].object.visible=!1,this.objects[e].object.visible=!0;else break;for(;e<f;e++)this.objects[e].object.visible=!1}}}();THREE.LOD.prototype.clone=function(){};
THREE.Sprite=function(b){THREE.Object3D.call(this);this.material=void 0!==b?b:new THREE.SpriteMaterial;this.rotation3d=this.rotation;this.rotation=0};THREE.Sprite.prototype=Object.create(THREE.Object3D.prototype);THREE.Sprite.prototype.updateMatrix=function(){this.rotation3d.set(0,0,this.rotation);this.quaternion.setFromEuler(this.rotation3d,this.eulerOrder);this.matrix.makeFromPositionQuaternionScale(this.position,this.quaternion,this.scale);this.matrixWorldNeedsUpdate=!0};
THREE.Sprite.prototype.clone=function(b){void 0===b&&(b=new THREE.Sprite(this.material));THREE.Object3D.prototype.clone.call(this,b);return b};THREE.Scene=function(){THREE.Object3D.call(this);this.overrideMaterial=this.fog=null;this.autoUpdate=!0;this.matrixAutoUpdate=!1;this.__objects=[];this.__lights=[];this.__objectsAdded=[];this.__objectsRemoved=[]};THREE.Scene.prototype=Object.create(THREE.Object3D.prototype);
THREE.Scene.prototype.__addObject=function(b){if(b instanceof THREE.Light)-1===this.__lights.indexOf(b)&&this.__lights.push(b),b.target&&void 0===b.target.parent&&this.add(b.target);else if(!(b instanceof THREE.Camera||b instanceof THREE.Bone)&&-1===this.__objects.indexOf(b)){this.__objects.push(b);this.__objectsAdded.push(b);var d=this.__objectsRemoved.indexOf(b);-1!==d&&this.__objectsRemoved.splice(d,1)}for(d=0;d<b.children.length;d++)this.__addObject(b.children[d])};
THREE.Scene.prototype.__removeObject=function(b){if(b instanceof THREE.Light){var d=this.__lights.indexOf(b);-1!==d&&this.__lights.splice(d,1)}else b instanceof THREE.Camera||(d=this.__objects.indexOf(b),-1!==d&&(this.__objects.splice(d,1),this.__objectsRemoved.push(b),d=this.__objectsAdded.indexOf(b),-1!==d&&this.__objectsAdded.splice(d,1)));for(d=0;d<b.children.length;d++)this.__removeObject(b.children[d])};
THREE.Fog=function(b,d,c){this.name="";this.color=new THREE.Color(b);this.near=void 0!==d?d:1;this.far=void 0!==c?c:1E3};THREE.Fog.prototype.clone=function(){return new THREE.Fog(this.color.getHex(),this.near,this.far)};THREE.FogExp2=function(b,d){this.name="";this.color=new THREE.Color(b);this.density=void 0!==d?d:2.5E-4};THREE.FogExp2.prototype.clone=function(){return new THREE.FogExp2(this.color.getHex(),this.density)};
THREE.CanvasRenderer=function(b){function d(b){E!==b&&(E=A.globalAlpha=b)}function c(b){F!==b&&(b===THREE.NormalBlending?A.globalCompositeOperation="source-over":b===THREE.AdditiveBlending?A.globalCompositeOperation="lighter":b===THREE.SubtractiveBlending&&(A.globalCompositeOperation="darker"),F=b)}function e(b){G!==b&&(G=A.lineWidth=b)}function f(b){aa!==b&&(aa=A.lineCap=b)}function g(b){D!==b&&(D=A.lineJoin=b)}function h(b){U!==b&&(U=A.strokeStyle=b)}function k(b){H!==b&&(H=A.fillStyle=b)}function l(b,
c){if(M!==b||I!==c)A.setLineDash([b,c]),M=b,I=c}console.log("THREE.CanvasRenderer",THREE.REVISION);var p=THREE.Math.smoothstep;b=b||{};var q=this,r,s,t,u=new THREE.Projector,v=void 0!==b.canvas?b.canvas:document.createElement("canvas"),w,y,z,B,A=v.getContext("2d"),K=new THREE.Color(0),O=0,E=1,F=0,U=null,H=null,G=null,aa=null,D=null,M=null,I=0,Q,V,C,Z,N=new THREE.RenderableVertex,ca=new THREE.RenderableVertex,R,X,ba,na,S,$,ra,Y,ta,Na,Qa,Oa,fa=new THREE.Color,T=new THREE.Color,ia=new THREE.Color,ea=
new THREE.Color,xa=new THREE.Color,Aa=new THREE.Color,ya=new THREE.Color,Ba=new THREE.Color,Ua={},ha={},Ra,Ha,sa,eb,Xa,zb,Pa,va,db,Ib,Va=new THREE.Box2,Ta=new THREE.Box2,Ka=new THREE.Box2,bb=new THREE.Color,fb=new THREE.Color,wa=new THREE.Color,oa=new THREE.Vector3,Ia,x,cb,La,jb,Ab,ja=16;Ia=document.createElement("canvas");Ia.width=Ia.height=2;x=Ia.getContext("2d");x.fillStyle="rgba(0,0,0,1)";x.fillRect(0,0,2,2);cb=x.getImageData(0,0,2,2);La=cb.data;jb=document.createElement("canvas");jb.width=jb.height=
ja;Ab=jb.getContext("2d");Ab.translate(-ja/2,-ja/2);Ab.scale(ja,ja);ja--;void 0===A.setLineDash&&(A.setLineDash=void 0!==A.mozDash?function(b){A.mozDash=null!==b[0]?b:null}:function(){});this.domElement=v;this.devicePixelRatio=void 0!==b.devicePixelRatio?b.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.sortElements=this.sortObjects=this.autoClear=!0;this.info={render:{vertices:0,faces:0}};this.supportsVertexTextures=function(){};this.setFaceCulling=function(){};this.setSize=
function(b,c,e){w=b*this.devicePixelRatio;y=c*this.devicePixelRatio;z=Math.floor(w/2);B=Math.floor(y/2);v.width=w;v.height=y;1!==this.devicePixelRatio&&!1!==e&&(v.style.width=b+"px",v.style.height=c+"px");Va.set(new THREE.Vector2(-z,-B),new THREE.Vector2(z,B));Ta.set(new THREE.Vector2(-z,-B),new THREE.Vector2(z,B));E=1;F=0;D=aa=G=H=U=null};this.setClearColor=function(b,c){K.set(b);O=void 0!==c?c:1;Ta.set(new THREE.Vector2(-z,-B),new THREE.Vector2(z,B))};this.setClearColorHex=function(b,c){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");
this.setClearColor(b,c)};this.getMaxAnisotropy=function(){return 0};this.clear=function(){A.setTransform(1,0,0,-1,z,B);!1===Ta.empty()&&(Ta.intersect(Va),Ta.expandByScalar(2),1>O&&A.clearRect(Ta.min.x|0,Ta.min.y|0,Ta.max.x-Ta.min.x|0,Ta.max.y-Ta.min.y|0),0<O&&(c(THREE.NormalBlending),d(1),k("rgba("+Math.floor(255*K.r)+","+Math.floor(255*K.g)+","+Math.floor(255*K.b)+","+O+")"),A.fillRect(Ta.min.x|0,Ta.min.y|0,Ta.max.x-Ta.min.x|0,Ta.max.y-Ta.min.y|0)),Ta.makeEmpty())};this.render=function(b,v){function w(b,
c,e){for(var d=0,f=t.length;d<f;d++){var g=t[d];Ba.copy(g.color);if(g instanceof THREE.DirectionalLight){var h=oa.getPositionFromMatrix(g.matrixWorld).normalize(),k=c.dot(h);0>=k||(k*=g.intensity,e.add(Ba.multiplyScalar(k)))}else g instanceof THREE.PointLight&&(h=oa.getPositionFromMatrix(g.matrixWorld),k=c.dot(oa.subVectors(h,b).normalize()),0>=k||(k*=0==g.distance?1:1-Math.min(b.distanceTo(h)/g.distance,1),0!=k&&(k*=g.intensity,e.add(Ba.multiplyScalar(k)))))}}function y(b,e,f,g,h,k,l,r){q.info.render.vertices+=
3;q.info.render.faces++;d(r.opacity);c(r.blending);R=b.positionScreen.x;X=b.positionScreen.y;ba=e.positionScreen.x;na=e.positionScreen.y;S=f.positionScreen.x;$=f.positionScreen.y;E(R,X,ba,na,S,$);(r instanceof THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial)&&null===r.map?(Aa.copy(r.color),ya.copy(r.emissive),r.vertexColors===THREE.FaceColors&&Aa.multiply(l.color),!1===r.wireframe&&r.shading==THREE.SmoothShading&&3==l.vertexNormalsLength?(T.copy(bb),ia.copy(bb),ea.copy(bb),w(l.v1.positionWorld,
l.vertexNormalsModel[0],T),w(l.v2.positionWorld,l.vertexNormalsModel[1],ia),w(l.v3.positionWorld,l.vertexNormalsModel[2],ea),T.multiply(Aa).add(ya),ia.multiply(Aa).add(ya),ea.multiply(Aa).add(ya),xa.addColors(ia,ea).multiplyScalar(0.5),sa=K(T,ia,ea,xa),aa(R,X,ba,na,S,$,0,0,1,0,0,1,sa)):(fa.copy(bb),w(l.centroidModel,l.normalModel,fa),fa.multiply(Aa).add(ya),!0===r.wireframe?U(fa,r.wireframeLinewidth,r.wireframeLinecap,r.wireframeLinejoin):G(fa))):r instanceof THREE.MeshBasicMaterial||r instanceof
THREE.MeshLambertMaterial||r instanceof THREE.MeshPhongMaterial?null!==r.map?r.map.mapping instanceof THREE.UVMapping&&(eb=l.uvs[0],D(R,X,ba,na,S,$,eb[g].x,eb[g].y,eb[h].x,eb[h].y,eb[k].x,eb[k].y,r.map)):null!==r.envMap?r.envMap.mapping instanceof THREE.SphericalReflectionMapping&&(oa.copy(l.vertexNormalsModelView[g]),Xa=0.5*oa.x+0.5,zb=0.5*oa.y+0.5,oa.copy(l.vertexNormalsModelView[h]),Pa=0.5*oa.x+0.5,va=0.5*oa.y+0.5,oa.copy(l.vertexNormalsModelView[k]),db=0.5*oa.x+0.5,Ib=0.5*oa.y+0.5,D(R,X,ba,na,
S,$,Xa,zb,Pa,va,db,Ib,r.envMap)):(fa.copy(r.color),r.vertexColors===THREE.FaceColors&&fa.multiply(l.color),!0===r.wireframe?U(fa,r.wireframeLinewidth,r.wireframeLinecap,r.wireframeLinejoin):G(fa)):r instanceof THREE.MeshDepthMaterial?(Ra=v.near,Ha=v.far,T.r=T.g=T.b=1-p(b.positionScreen.z*b.positionScreen.w,Ra,Ha),ia.r=ia.g=ia.b=1-p(e.positionScreen.z*e.positionScreen.w,Ra,Ha),ea.r=ea.g=ea.b=1-p(f.positionScreen.z*f.positionScreen.w,Ra,Ha),xa.addColors(ia,ea).multiplyScalar(0.5),sa=K(T,ia,ea,xa),aa(R,
X,ba,na,S,$,0,0,1,0,0,1,sa)):r instanceof THREE.MeshNormalMaterial&&(r.shading==THREE.FlatShading?(b=l.normalModelView,fa.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),!0===r.wireframe?U(fa,r.wireframeLinewidth,r.wireframeLinecap,r.wireframeLinejoin):G(fa)):r.shading==THREE.SmoothShading&&(b=l.vertexNormalsModelView[g],T.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),b=l.vertexNormalsModelView[h],ia.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),b=l.vertexNormalsModelView[k],
ea.setRGB(b.x,b.y,b.z).multiplyScalar(0.5).addScalar(0.5),xa.addColors(ia,ea).multiplyScalar(0.5),sa=K(T,ia,ea,xa),aa(R,X,ba,na,S,$,0,0,1,0,0,1,sa)))}function E(b,c,e,d,f,g){A.beginPath();A.moveTo(b,c);A.lineTo(e,d);A.lineTo(f,g);A.closePath()}function O(b,c,e,d,f,g,h,k){A.beginPath();A.moveTo(b,c);A.lineTo(e,d);A.lineTo(f,g);A.lineTo(h,k);A.closePath()}function U(b,c,d,k){e(c);f(d);g(k);h(b.getStyle());A.stroke();Ka.expandByScalar(2*c)}function G(b){k(b.getStyle());A.fill()}function D(b,c,e,d,f,
g,h,l,p,q,r,s,t){if(!(t instanceof THREE.DataTexture||void 0===t.image||0==t.image.width)){if(!0===t.needsUpdate){var u=t.wrapS==THREE.RepeatWrapping,v=t.wrapT==THREE.RepeatWrapping;Ua[t.id]=A.createPattern(t.image,!0===u&&!0===v?"repeat":!0===u&&!1===v?"repeat-x":!1===u&&!0===v?"repeat-y":"no-repeat");t.needsUpdate=!1}void 0===Ua[t.id]?k("rgba(0,0,0,1)"):k(Ua[t.id]);var u=t.offset.x/t.repeat.x,v=t.offset.y/t.repeat.y,w=t.image.width*t.repeat.x,y=t.image.height*t.repeat.y;h=(h+u)*w;l=(1-l+v)*y;e-=
b;d-=c;f-=b;g-=c;p=(p+u)*w-h;q=(1-q+v)*y-l;r=(r+u)*w-h;s=(1-s+v)*y-l;u=p*s-r*q;0===u?(void 0===ha[t.id]&&(c=document.createElement("canvas"),c.width=t.image.width,c.height=t.image.height,c=c.getContext("2d"),c.drawImage(t.image,0,0),ha[t.id]=c.getImageData(0,0,t.image.width,t.image.height).data),c=ha[t.id],h=4*(Math.floor(h)+Math.floor(l)*t.image.width),fa.setRGB(c[h]/255,c[h+1]/255,c[h+2]/255),G(fa)):(u=1/u,t=(s*e-q*f)*u,q=(s*d-q*g)*u,e=(p*f-r*e)*u,d=(p*g-r*d)*u,b=b-t*h-e*l,h=c-q*h-d*l,A.save(),
A.transform(t,q,e,d,b,h),A.fill(),A.restore())}}function aa(b,c,e,d,f,g,h,k,l,p,q,r,s){var t,u;t=s.width-1;u=s.height-1;h*=t;k*=u;e-=b;d-=c;f-=b;g-=c;l=l*t-h;p=p*u-k;q=q*t-h;r=r*u-k;u=1/(l*r-q*p);t=(r*e-p*f)*u;p=(r*d-p*g)*u;e=(l*f-q*e)*u;d=(l*g-q*d)*u;b=b-t*h-e*k;c=c-p*h-d*k;A.save();A.transform(t,p,e,d,b,c);A.clip();A.drawImage(s,0,0);A.restore()}function K(b,c,e,d){La[0]=255*b.r|0;La[1]=255*b.g|0;La[2]=255*b.b|0;La[4]=255*c.r|0;La[5]=255*c.g|0;La[6]=255*c.b|0;La[8]=255*e.r|0;La[9]=255*e.g|0;La[10]=
255*e.b|0;La[12]=255*d.r|0;La[13]=255*d.g|0;La[14]=255*d.b|0;x.putImageData(cb,0,0);Ab.drawImage(Ia,0,0);return jb}function F(b,c){var e=c.x-b.x,d=c.y-b.y,f=e*e+d*d;0!==f&&(f=1/Math.sqrt(f),e*=f,d*=f,c.x+=e,c.y+=d,b.x-=e,b.y-=d)}if(!1===v instanceof THREE.Camera)console.error("THREE.CanvasRenderer.render: camera is not an instance of THREE.Camera.");else{!0===this.autoClear&&this.clear();A.setTransform(1,0,0,-1,z,B);q.info.render.vertices=0;q.info.render.faces=0;r=u.projectScene(b,v,this.sortObjects,
this.sortElements);s=r.elements;t=r.lights;bb.setRGB(0,0,0);fb.setRGB(0,0,0);wa.setRGB(0,0,0);for(var H=0,I=t.length;H<I;H++){var M=t[H],ga=M.color;M instanceof THREE.AmbientLight?bb.add(ga):M instanceof THREE.DirectionalLight?fb.add(ga):M instanceof THREE.PointLight&&wa.add(ga)}H=0;for(I=s.length;H<I;H++){var ja=s[H],M=ja.material;if(!(void 0===M||!1===M.visible)){Ka.makeEmpty();if(ja instanceof THREE.RenderableParticle){Q=ja;Q.x*=z;Q.y*=B;ga=Q;d(M.opacity);c(M.blending);var Gb=void 0,Kb=void 0,
Qb=void 0,Lb=void 0,xc=void 0,tc=void 0,uc=void 0;M instanceof THREE.ParticleBasicMaterial?null===M.map?(Qb=ja.object.scale.x,Lb=ja.object.scale.y,Qb*=ja.scale.x*z,Lb*=ja.scale.y*B,Ka.min.set(ga.x-Qb,ga.y-Lb),Ka.max.set(ga.x+Qb,ga.y+Lb),!1===Va.isIntersectionBox(Ka)?Ka.makeEmpty():(k(M.color.getStyle()),A.save(),A.translate(ga.x,ga.y),A.rotate(-ja.rotation),A.scale(Qb,Lb),A.fillRect(-1,-1,2,2),A.restore())):(xc=M.map.image,tc=xc.width>>1,uc=xc.height>>1,Qb=ja.scale.x*z,Lb=ja.scale.y*B,Gb=Qb*tc,Kb=
Lb*uc,Ka.min.set(ga.x-Gb,ga.y-Kb),Ka.max.set(ga.x+Gb,ga.y+Kb),!1===Va.isIntersectionBox(Ka)?Ka.makeEmpty():(A.save(),A.translate(ga.x,ga.y),A.rotate(-ja.rotation),A.scale(Qb,-Lb),A.translate(-tc,-uc),A.drawImage(xc,0,0),A.restore())):M instanceof THREE.ParticleCanvasMaterial&&(Gb=ja.scale.x*z,Kb=ja.scale.y*B,Ka.min.set(ga.x-Gb,ga.y-Kb),Ka.max.set(ga.x+Gb,ga.y+Kb),!1===Va.isIntersectionBox(Ka)?Ka.makeEmpty():(h(M.color.getStyle()),k(M.color.getStyle()),A.save(),A.translate(ga.x,ga.y),A.rotate(-ja.rotation),
A.scale(Gb,Kb),M.program(A),A.restore()))}else if(ja instanceof THREE.RenderableLine){if(Q=ja.v1,V=ja.v2,Q.positionScreen.x*=z,Q.positionScreen.y*=B,V.positionScreen.x*=z,V.positionScreen.y*=B,Ka.setFromPoints([Q.positionScreen,V.positionScreen]),!0===Va.isIntersectionBox(Ka))if(ga=Q,Gb=V,d(M.opacity),c(M.blending),A.beginPath(),A.moveTo(ga.positionScreen.x,ga.positionScreen.y),A.lineTo(Gb.positionScreen.x,Gb.positionScreen.y),M instanceof THREE.LineBasicMaterial){e(M.linewidth);f(M.linecap);g(M.linejoin);
if(M.vertexColors!==THREE.VertexColors)h(M.color.getStyle());else if(Kb=ja.vertexColors[0].getStyle(),ja=ja.vertexColors[1].getStyle(),Kb===ja)h(Kb);else{try{var Bb=A.createLinearGradient(ga.positionScreen.x,ga.positionScreen.y,Gb.positionScreen.x,Gb.positionScreen.y);Bb.addColorStop(0,Kb);Bb.addColorStop(1,ja)}catch(hd){Bb=Kb}h(Bb)}A.stroke();Ka.expandByScalar(2*M.linewidth)}else M instanceof THREE.LineDashedMaterial&&(e(M.linewidth),f(M.linecap),g(M.linejoin),h(M.color.getStyle()),l(M.dashSize,
M.gapSize),A.stroke(),Ka.expandByScalar(2*M.linewidth),l(null,null))}else if(ja instanceof THREE.RenderableFace3){Q=ja.v1;V=ja.v2;C=ja.v3;if(-1>Q.positionScreen.z||1<Q.positionScreen.z)continue;if(-1>V.positionScreen.z||1<V.positionScreen.z)continue;if(-1>C.positionScreen.z||1<C.positionScreen.z)continue;Q.positionScreen.x*=z;Q.positionScreen.y*=B;V.positionScreen.x*=z;V.positionScreen.y*=B;C.positionScreen.x*=z;C.positionScreen.y*=B;!0===M.overdraw&&(F(Q.positionScreen,V.positionScreen),F(V.positionScreen,
C.positionScreen),F(C.positionScreen,Q.positionScreen));Ka.setFromPoints([Q.positionScreen,V.positionScreen,C.positionScreen]);!0===Va.isIntersectionBox(Ka)&&y(Q,V,C,0,1,2,ja,M)}else if(ja instanceof THREE.RenderableFace4){Q=ja.v1;V=ja.v2;C=ja.v3;Z=ja.v4;if(-1>Q.positionScreen.z||1<Q.positionScreen.z)continue;if(-1>V.positionScreen.z||1<V.positionScreen.z)continue;if(-1>C.positionScreen.z||1<C.positionScreen.z)continue;if(-1>Z.positionScreen.z||1<Z.positionScreen.z)continue;Q.positionScreen.x*=z;
Q.positionScreen.y*=B;V.positionScreen.x*=z;V.positionScreen.y*=B;C.positionScreen.x*=z;C.positionScreen.y*=B;Z.positionScreen.x*=z;Z.positionScreen.y*=B;N.positionScreen.copy(V.positionScreen);ca.positionScreen.copy(Z.positionScreen);!0===M.overdraw&&(F(Q.positionScreen,V.positionScreen),F(V.positionScreen,Z.positionScreen),F(Z.positionScreen,Q.positionScreen),F(C.positionScreen,N.positionScreen),F(C.positionScreen,ca.positionScreen));Ka.setFromPoints([Q.positionScreen,V.positionScreen,C.positionScreen,
Z.positionScreen]);!0===Va.isIntersectionBox(Ka)&&(ga=Q,Gb=V,Kb=C,Qb=Z,Lb=N,xc=ca,q.info.render.vertices+=4,q.info.render.faces++,d(M.opacity),c(M.blending),void 0!==M.map&&null!==M.map||void 0!==M.envMap&&null!==M.envMap?(y(ga,Gb,Qb,0,1,3,ja,M),y(Lb,Kb,xc,1,2,3,ja,M)):(R=ga.positionScreen.x,X=ga.positionScreen.y,ba=Gb.positionScreen.x,na=Gb.positionScreen.y,S=Kb.positionScreen.x,$=Kb.positionScreen.y,ra=Qb.positionScreen.x,Y=Qb.positionScreen.y,ta=Lb.positionScreen.x,Na=Lb.positionScreen.y,Qa=xc.positionScreen.x,
Oa=xc.positionScreen.y,M instanceof THREE.MeshLambertMaterial||M instanceof THREE.MeshPhongMaterial?(Aa.copy(M.color),ya.copy(M.emissive),M.vertexColors===THREE.FaceColors&&Aa.multiply(ja.color),!1===M.wireframe&&M.shading==THREE.SmoothShading&&4==ja.vertexNormalsLength?(T.copy(bb),ia.copy(bb),ea.copy(bb),xa.copy(bb),w(ja.v1.positionWorld,ja.vertexNormalsModel[0],T),w(ja.v2.positionWorld,ja.vertexNormalsModel[1],ia),w(ja.v4.positionWorld,ja.vertexNormalsModel[3],ea),w(ja.v3.positionWorld,ja.vertexNormalsModel[2],
xa),T.multiply(Aa).add(ya),ia.multiply(Aa).add(ya),ea.multiply(Aa).add(ya),xa.multiply(Aa).add(ya),sa=K(T,ia,ea,xa),E(R,X,ba,na,ra,Y),aa(R,X,ba,na,ra,Y,0,0,1,0,0,1,sa),E(ta,Na,S,$,Qa,Oa),aa(ta,Na,S,$,Qa,Oa,1,0,1,1,0,1,sa)):(fa.copy(bb),w(ja.centroidModel,ja.normalModel,fa),fa.multiply(Aa).add(ya),O(R,X,ba,na,S,$,ra,Y),!0===M.wireframe?U(fa,M.wireframeLinewidth,M.wireframeLinecap,M.wireframeLinejoin):G(fa))):M instanceof THREE.MeshBasicMaterial?(fa.copy(M.color),M.vertexColors===THREE.FaceColors&&
fa.multiply(ja.color),O(R,X,ba,na,S,$,ra,Y),!0===M.wireframe?U(fa,M.wireframeLinewidth,M.wireframeLinecap,M.wireframeLinejoin):G(fa)):M instanceof THREE.MeshNormalMaterial?(ga=void 0,M.shading==THREE.FlatShading?(ga=ja.normalModelView,fa.setRGB(ga.x,ga.y,ga.z).multiplyScalar(0.5).addScalar(0.5),O(R,X,ba,na,S,$,ra,Y),!0===M.wireframe?U(fa,M.wireframeLinewidth,M.wireframeLinecap,M.wireframeLinejoin):G(fa)):M.shading==THREE.SmoothShading&&(ga=ja.vertexNormalsModelView[0],T.setRGB(ga.x,ga.y,ga.z).multiplyScalar(0.5).addScalar(0.5),
ga=ja.vertexNormalsModelView[1],ia.setRGB(ga.x,ga.y,ga.z).multiplyScalar(0.5).addScalar(0.5),ga=ja.vertexNormalsModelView[3],ea.setRGB(ga.x,ga.y,ga.z).multiplyScalar(0.5).addScalar(0.5),ga=ja.vertexNormalsModelView[2],xa.setRGB(ga.x,ga.y,ga.z).multiplyScalar(0.5).addScalar(0.5),sa=K(T,ia,ea,xa),E(R,X,ba,na,ra,Y),aa(R,X,ba,na,ra,Y,0,0,1,0,0,1,sa),E(ta,Na,S,$,Qa,Oa),aa(ta,Na,S,$,Qa,Oa,1,0,1,1,0,1,sa))):M instanceof THREE.MeshDepthMaterial&&(Ra=v.near,Ha=v.far,T.r=T.g=T.b=1-p(ga.positionScreen.z*ga.positionScreen.w,
Ra,Ha),ia.r=ia.g=ia.b=1-p(Gb.positionScreen.z*Gb.positionScreen.w,Ra,Ha),ea.r=ea.g=ea.b=1-p(Qb.positionScreen.z*Qb.positionScreen.w,Ra,Ha),xa.r=xa.g=xa.b=1-p(Kb.positionScreen.z*Kb.positionScreen.w,Ra,Ha),sa=K(T,ia,ea,xa),E(R,X,ba,na,ra,Y),aa(R,X,ba,na,ra,Y,0,0,1,0,0,1,sa),E(ta,Na,S,$,Qa,Oa),aa(ta,Na,S,$,Qa,Oa,1,0,1,1,0,1,sa))))}Ta.union(Ka)}}A.setTransform(1,0,0,1,0,0)}}};
THREE.ShaderChunk={fog_pars_fragment:"#ifdef USE_FOG\nuniform vec3 fogColor;\n#ifdef FOG_EXP2\nuniform float fogDensity;\n#else\nuniform float fogNear;\nuniform float fogFar;\n#endif\n#endif",fog_fragment:"#ifdef USE_FOG\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\n#ifdef FOG_EXP2\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n#else\nfloat fogFactor = smoothstep( fogNear, fogFar, depth );\n#endif\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n#endif",
envmap_pars_fragment:"#ifdef USE_ENVMAP\nuniform float reflectivity;\nuniform samplerCube envMap;\nuniform float flipEnvMap;\nuniform int combine;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nuniform bool useRefract;\nuniform float refractionRatio;\n#else\nvarying vec3 vReflect;\n#endif\n#endif",envmap_fragment:"#ifdef USE_ENVMAP\nvec3 reflectVec;\n#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nreflectVec = refract( cameraToVertex, normal, refractionRatio );\n} else { \nreflectVec = reflect( cameraToVertex, normal );\n}\n#else\nreflectVec = vReflect;\n#endif\n#ifdef DOUBLE_SIDED\nfloat flipNormal = ( -1.0 + 2.0 * float( gl_FrontFacing ) );\nvec4 cubeColor = textureCube( envMap, flipNormal * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#else\nvec4 cubeColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n#endif\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\nif ( combine == 1 ) {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularStrength * reflectivity );\n} else if ( combine == 2 ) {\ngl_FragColor.xyz += cubeColor.xyz * specularStrength * reflectivity;\n} else {\ngl_FragColor.xyz = mix( gl_FragColor.xyz, gl_FragColor.xyz * cubeColor.xyz, specularStrength * reflectivity );\n}\n#endif",
envmap_pars_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvarying vec3 vReflect;\nuniform float refractionRatio;\nuniform bool useRefract;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( PHONG ) || defined( LAMBERT ) || defined ( USE_SHADOWMAP )\n#ifdef USE_SKINNING\nvec4 worldPosition = modelMatrix * skinned;\n#endif\n#if defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( morphed, 1.0 );\n#endif\n#if ! defined( USE_MORPHTARGETS ) && ! defined( USE_SKINNING )\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\n#endif\n#endif",
envmap_vertex:"#if defined( USE_ENVMAP ) && ! defined( USE_BUMPMAP ) && ! defined( USE_NORMALMAP )\nvec3 worldNormal = mat3( modelMatrix[ 0 ].xyz, modelMatrix[ 1 ].xyz, modelMatrix[ 2 ].xyz ) * objectNormal;\nworldNormal = normalize( worldNormal );\nvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, worldNormal );\n}\n#endif",map_particle_pars_fragment:"#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
map_particle_fragment:"#ifdef USE_MAP\ngl_FragColor = gl_FragColor * texture2D( map, vec2( gl_PointCoord.x, 1.0 - gl_PointCoord.y ) );\n#endif",map_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\nuniform vec4 offsetRepeat;\n#endif",map_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\nuniform sampler2D map;\n#endif",
map_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP )\nvUv = uv * offsetRepeat.zw + offsetRepeat.xy;\n#endif",map_fragment:"#ifdef USE_MAP\nvec4 texelColor = texture2D( map, vUv );\n#ifdef GAMMA_INPUT\ntexelColor.xyz *= texelColor.xyz;\n#endif\ngl_FragColor = gl_FragColor * texelColor;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\nuniform sampler2D lightMap;\n#endif",lightmap_pars_vertex:"#ifdef USE_LIGHTMAP\nvarying vec2 vUv2;\n#endif",
lightmap_fragment:"#ifdef USE_LIGHTMAP\ngl_FragColor = gl_FragColor * texture2D( lightMap, vUv2 );\n#endif",lightmap_vertex:"#ifdef USE_LIGHTMAP\nvUv2 = uv2;\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\nuniform sampler2D bumpMap;\nuniform float bumpScale;\nvec2 dHdxy_fwd() {\nvec2 dSTdx = dFdx( vUv );\nvec2 dSTdy = dFdy( vUv );\nfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\nfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\nfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\nreturn vec2( dBx, dBy );\n}\nvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\nvec3 vSigmaX = dFdx( surf_pos );\nvec3 vSigmaY = dFdy( surf_pos );\nvec3 vN = surf_norm;\nvec3 R1 = cross( vSigmaY, vN );\nvec3 R2 = cross( vN, vSigmaX );\nfloat fDet = dot( vSigmaX, R1 );\nvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\nreturn normalize( abs( fDet ) * surf_norm - vGrad );\n}\n#endif",
normalmap_pars_fragment:"#ifdef USE_NORMALMAP\nuniform sampler2D normalMap;\nuniform vec2 normalScale;\nvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\nvec3 q0 = dFdx( eye_pos.xyz );\nvec3 q1 = dFdy( eye_pos.xyz );\nvec2 st0 = dFdx( vUv.st );\nvec2 st1 = dFdy( vUv.st );\nvec3 S = normalize(  q0 * st1.t - q1 * st0.t );\nvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\nvec3 N = normalize( surf_norm );\nvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\nmapN.xy = normalScale * mapN.xy;\nmat3 tsn = mat3( S, T, N );\nreturn normalize( tsn * mapN );\n}\n#endif",
specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\nuniform sampler2D specularMap;\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\nvec4 texelSpecular = texture2D( specularMap, vUv );\nspecularStrength = texelSpecular.r;\n#else\nspecularStrength = 1.0;\n#endif",lights_lambert_pars_vertex:"uniform vec3 ambient;\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif",
lights_lambert_vertex:"vLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\nvLightBack = vec3( 0.0 );\n#endif\ntransformedNormal = normalize( transformedNormal );\n#if MAX_DIR_LIGHTS > 0\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, dirVector );\nvec3 directionalLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 directionalLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 directionalLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\ndirectionalLightWeighting = mix( directionalLightWeighting, directionalLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\ndirectionalLightWeightingBack = mix( directionalLightWeightingBack, directionalLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += directionalLightColor[ i ] * directionalLightWeighting;\n#ifdef DOUBLE_SIDED\nvLightBack += directionalLightColor[ i ] * directionalLightWeightingBack;\n#endif\n}\n#endif\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 pointLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 pointLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 pointLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\npointLightWeighting = mix( pointLightWeighting, pointLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\npointLightWeightingBack = mix( pointLightWeightingBack, pointLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += pointLightColor[ i ] * pointLightWeighting * lDistance;\n#ifdef DOUBLE_SIDED\nvLightBack += pointLightColor[ i ] * pointLightWeightingBack * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - worldPosition.xyz ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\nfloat dotProduct = dot( transformedNormal, lVector );\nvec3 spotLightWeighting = vec3( max( dotProduct, 0.0 ) );\n#ifdef DOUBLE_SIDED\nvec3 spotLightWeightingBack = vec3( max( -dotProduct, 0.0 ) );\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalfBack = vec3( max( -0.5 * dotProduct + 0.5, 0.0 ) );\n#endif\n#endif\n#ifdef WRAP_AROUND\nvec3 spotLightWeightingHalf = vec3( max( 0.5 * dotProduct + 0.5, 0.0 ) );\nspotLightWeighting = mix( spotLightWeighting, spotLightWeightingHalf, wrapRGB );\n#ifdef DOUBLE_SIDED\nspotLightWeightingBack = mix( spotLightWeightingBack, spotLightWeightingHalfBack, wrapRGB );\n#endif\n#endif\nvLightFront += spotLightColor[ i ] * spotLightWeighting * lDistance * spotEffect;\n#ifdef DOUBLE_SIDED\nvLightBack += spotLightColor[ i ] * spotLightWeightingBack * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( transformedNormal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nfloat hemiDiffuseWeightBack = -0.5 * dotProduct + 0.5;\nvLightFront += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\n#ifdef DOUBLE_SIDED\nvLightBack += mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeightBack );\n#endif\n}\n#endif\nvLightFront = vLightFront * diffuse + ambient * ambientLightColor + emissive;\n#ifdef DOUBLE_SIDED\nvLightBack = vLightBack * diffuse + ambient * ambientLightColor + emissive;\n#endif",
lights_phong_pars_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif",
lights_phong_vertex:"#ifndef PHONG_PER_PIXEL\n#if MAX_POINT_LIGHTS > 0\nfor( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nvPointLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nfor( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz - mvPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nvSpotLight[ i ] = vec4( lVector, lDistance );\n}\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvWorldPosition = worldPosition.xyz;\n#endif",
lights_phong_pars_fragment:"uniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#else\nvarying vec4 vPointLight[ MAX_POINT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\n#ifdef PHONG_PER_PIXEL\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#else\nvarying vec4 vSpotLight[ MAX_SPOT_LIGHTS ];\n#endif\n#endif\n#if MAX_SPOT_LIGHTS > 0 || defined( USE_BUMPMAP )\nvarying vec3 vWorldPosition;\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",
lights_phong_fragment:"vec3 normal = normalize( vNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#ifdef DOUBLE_SIDED\nnormal = normal * ( -1.0 + 2.0 * float( gl_FrontFacing ) );\n#endif\n#ifdef USE_NORMALMAP\nnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\nnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse  = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / pointLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vPointLight[ i ].xyz );\nfloat lDistance = vPointLight[ i ].w;\n#endif\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dotProduct, 0.0 );\n#endif\npointDiffuse  += diffuse * pointLightColor[ i ] * pointDiffuseWeight * lDistance;\nvec3 pointHalfVector = normalize( lVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularStrength * max( pow( pointDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance * specularNormalization;\n#else\npointSpecular += specular * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * lDistance;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse  = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\n#ifdef PHONG_PER_PIXEL\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 lVector = lPosition.xyz + vViewPosition.xyz;\nfloat lDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nlDistance = 1.0 - min( ( length( lVector ) / spotLightDistance[ i ] ), 1.0 );\nlVector = normalize( lVector );\n#else\nvec3 lVector = normalize( vSpotLight[ i ].xyz );\nfloat lDistance = vSpotLight[ i ].w;\n#endif\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\nfloat dotProduct = dot( normal, lVector );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dotProduct, 0.0 );\n#endif\nspotDiffuse += diffuse * spotLightColor[ i ] * spotDiffuseWeight * lDistance * spotEffect;\nvec3 spotHalfVector = normalize( lVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularStrength * max( pow( spotDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += specular * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * lDistance * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse  = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, dirVector );\n#ifdef WRAP_AROUND\nfloat dirDiffuseWeightFull = max( dotProduct, 0.0 );\nfloat dirDiffuseWeightHalf = max( 0.5 * dotProduct + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( dirDiffuseWeightFull ), vec3( dirDiffuseWeightHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dotProduct, 0.0 );\n#endif\ndirDiffuse  += diffuse * directionalLightColor[ i ] * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularStrength * max( pow( dirDotNormalHalf, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlick = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += specular * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += diffuse * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularStrength * max( pow( hemiDotNormalHalfSky, shininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularStrength * max( pow( hemiDotNormalHalfGround, shininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( shininess + 2.0001 ) / 8.0;\nvec3 schlickSky = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = specular + vec3( 1.0 - specular ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += specular * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( emissive + totalDiffuse + ambientLightColor * ambient ) + totalSpecular;\n#endif",
color_pars_fragment:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_fragment:"#ifdef USE_COLOR\ngl_FragColor = gl_FragColor * vec4( vColor, opacity );\n#endif",color_pars_vertex:"#ifdef USE_COLOR\nvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n#ifdef GAMMA_INPUT\nvColor = color * color;\n#else\nvColor = color;\n#endif\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n#ifdef BONE_TEXTURE\nuniform sampler2D boneTexture;\nmat4 getBoneMatrix( const in float i ) {\nfloat j = i * 4.0;\nfloat x = mod( j, N_BONE_PIXEL_X );\nfloat y = floor( j / N_BONE_PIXEL_X );\nconst float dx = 1.0 / N_BONE_PIXEL_X;\nconst float dy = 1.0 / N_BONE_PIXEL_Y;\ny = dy * ( y + 0.5 );\nvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\nvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\nvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\nvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\nmat4 bone = mat4( v1, v2, v3, v4 );\nreturn bone;\n}\n#else\nuniform mat4 boneGlobalMatrices[ MAX_BONES ];\nmat4 getBoneMatrix( const in float i ) {\nmat4 bone = boneGlobalMatrices[ int(i) ];\nreturn bone;\n}\n#endif\n#endif",
skinbase_vertex:"#ifdef USE_SKINNING\nmat4 boneMatX = getBoneMatrix( skinIndex.x );\nmat4 boneMatY = getBoneMatrix( skinIndex.y );\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n#ifdef USE_MORPHTARGETS\nvec4 skinVertex = vec4( morphed, 1.0 );\n#else\nvec4 skinVertex = vec4( position, 1.0 );\n#endif\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n#ifndef USE_MORPHNORMALS\nuniform float morphTargetInfluences[ 8 ];\n#else\nuniform float morphTargetInfluences[ 4 ];\n#endif\n#endif",
morphtarget_vertex:"#ifdef USE_MORPHTARGETS\nvec3 morphed = vec3( 0.0 );\nmorphed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\nmorphed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\nmorphed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\nmorphed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n#ifndef USE_MORPHNORMALS\nmorphed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\nmorphed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\nmorphed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\nmorphed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n#endif\nmorphed += position;\n#endif",
default_vertex:"vec4 mvPosition;\n#ifdef USE_SKINNING\nmvPosition = modelViewMatrix * skinned;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( morphed, 1.0 );\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHTARGETS )\nmvPosition = modelViewMatrix * vec4( position, 1.0 );\n#endif\ngl_Position = projectionMatrix * mvPosition;",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\nvec3 morphedNormal = vec3( 0.0 );\nmorphedNormal +=  ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\nmorphedNormal +=  ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\nmorphedNormal +=  ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\nmorphedNormal +=  ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\nmorphedNormal += normal;\n#endif",
skinnormal_vertex:"#ifdef USE_SKINNING\nmat4 skinMatrix = skinWeight.x * boneMatX;\nskinMatrix \t+= skinWeight.y * boneMatY;\n#ifdef USE_MORPHNORMALS\nvec4 skinnedNormal = skinMatrix * vec4( morphedNormal, 0.0 );\n#else\nvec4 skinnedNormal = skinMatrix * vec4( normal, 0.0 );\n#endif\n#endif",defaultnormal_vertex:"vec3 objectNormal;\n#ifdef USE_SKINNING\nobjectNormal = skinnedNormal.xyz;\n#endif\n#if !defined( USE_SKINNING ) && defined( USE_MORPHNORMALS )\nobjectNormal = morphedNormal;\n#endif\n#if !defined( USE_SKINNING ) && ! defined( USE_MORPHNORMALS )\nobjectNormal = normal;\n#endif\n#ifdef FLIP_SIDED\nobjectNormal = -objectNormal;\n#endif\nvec3 transformedNormal = normalMatrix * objectNormal;",
shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\nuniform sampler2D shadowMap[ MAX_SHADOWS ];\nuniform vec2 shadowMapSize[ MAX_SHADOWS ];\nuniform float shadowDarkness[ MAX_SHADOWS ];\nuniform float shadowBias[ MAX_SHADOWS ];\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nfloat unpackDepth( const in vec4 rgba_depth ) {\nconst vec4 bit_shift = vec4( 1.0 / ( 256.0 * 256.0 * 256.0 ), 1.0 / ( 256.0 * 256.0 ), 1.0 / 256.0, 1.0 );\nfloat depth = dot( rgba_depth, bit_shift );\nreturn depth;\n}\n#endif",shadowmap_fragment:"#ifdef USE_SHADOWMAP\n#ifdef SHADOWMAP_DEBUG\nvec3 frustumColors[3];\nfrustumColors[0] = vec3( 1.0, 0.5, 0.0 );\nfrustumColors[1] = vec3( 0.0, 1.0, 0.8 );\nfrustumColors[2] = vec3( 0.0, 0.5, 1.0 );\n#endif\n#ifdef SHADOWMAP_CASCADE\nint inFrustumCount = 0;\n#endif\nfloat fDepth;\nvec3 shadowColor = vec3( 1.0 );\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvec3 shadowCoord = vShadowCoord[ i ].xyz / vShadowCoord[ i ].w;\nbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\nbool inFrustum = all( inFrustumVec );\n#ifdef SHADOWMAP_CASCADE\ninFrustumCount += int( inFrustum );\nbvec3 frustumTestVec = bvec3( inFrustum, inFrustumCount == 1, shadowCoord.z <= 1.0 );\n#else\nbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n#endif\nbool frustumTest = all( frustumTestVec );\nif ( frustumTest ) {\nshadowCoord.z += shadowBias[ i ];\n#if defined( SHADOWMAP_TYPE_PCF )\nfloat shadow = 0.0;\nconst float shadowDelta = 1.0 / 9.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.25 * xPixelOffset;\nfloat dy0 = -1.25 * yPixelOffset;\nfloat dx1 = 1.25 * xPixelOffset;\nfloat dy1 = 1.25 * yPixelOffset;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nfDepth = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nif ( fDepth < shadowCoord.z ) shadow += shadowDelta;\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\nfloat shadow = 0.0;\nfloat xPixelOffset = 1.0 / shadowMapSize[ i ].x;\nfloat yPixelOffset = 1.0 / shadowMapSize[ i ].y;\nfloat dx0 = -1.0 * xPixelOffset;\nfloat dy0 = -1.0 * yPixelOffset;\nfloat dx1 = 1.0 * xPixelOffset;\nfloat dy1 = 1.0 * yPixelOffset;\nmat3 shadowKernel;\nmat3 depthKernel;\ndepthKernel[0][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy0 ) ) );\ndepthKernel[0][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, 0.0 ) ) );\ndepthKernel[0][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx0, dy1 ) ) );\ndepthKernel[1][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy0 ) ) );\ndepthKernel[1][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy ) );\ndepthKernel[1][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( 0.0, dy1 ) ) );\ndepthKernel[2][0] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy0 ) ) );\ndepthKernel[2][1] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, 0.0 ) ) );\ndepthKernel[2][2] = unpackDepth( texture2D( shadowMap[ i ], shadowCoord.xy + vec2( dx1, dy1 ) ) );\nvec3 shadowZ = vec3( shadowCoord.z );\nshadowKernel[0] = vec3(lessThan(depthKernel[0], shadowZ ));\nshadowKernel[0] *= vec3(0.25);\nshadowKernel[1] = vec3(lessThan(depthKernel[1], shadowZ ));\nshadowKernel[1] *= vec3(0.25);\nshadowKernel[2] = vec3(lessThan(depthKernel[2], shadowZ ));\nshadowKernel[2] *= vec3(0.25);\nvec2 fractionalCoord = 1.0 - fract( shadowCoord.xy * shadowMapSize[i].xy );\nshadowKernel[0] = mix( shadowKernel[1], shadowKernel[0], fractionalCoord.x );\nshadowKernel[1] = mix( shadowKernel[2], shadowKernel[1], fractionalCoord.x );\nvec4 shadowValues;\nshadowValues.x = mix( shadowKernel[0][1], shadowKernel[0][0], fractionalCoord.y );\nshadowValues.y = mix( shadowKernel[0][2], shadowKernel[0][1], fractionalCoord.y );\nshadowValues.z = mix( shadowKernel[1][1], shadowKernel[1][0], fractionalCoord.y );\nshadowValues.w = mix( shadowKernel[1][2], shadowKernel[1][1], fractionalCoord.y );\nshadow = dot( shadowValues, vec4( 1.0 ) );\nshadowColor = shadowColor * vec3( ( 1.0 - shadowDarkness[ i ] * shadow ) );\n#else\nvec4 rgbaDepth = texture2D( shadowMap[ i ], shadowCoord.xy );\nfloat fDepth = unpackDepth( rgbaDepth );\nif ( fDepth < shadowCoord.z )\nshadowColor = shadowColor * vec3( 1.0 - shadowDarkness[ i ] );\n#endif\n}\n#ifdef SHADOWMAP_DEBUG\n#ifdef SHADOWMAP_CASCADE\nif ( inFrustum && inFrustumCount == 1 ) gl_FragColor.xyz *= frustumColors[ i ];\n#else\nif ( inFrustum ) gl_FragColor.xyz *= frustumColors[ i ];\n#endif\n#endif\n}\n#ifdef GAMMA_OUTPUT\nshadowColor *= shadowColor;\n#endif\ngl_FragColor.xyz = gl_FragColor.xyz * shadowColor;\n#endif",
shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\nvarying vec4 vShadowCoord[ MAX_SHADOWS ];\nuniform mat4 shadowMatrix[ MAX_SHADOWS ];\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif",alphatest_fragment:"#ifdef ALPHATEST\nif ( gl_FragColor.a < ALPHATEST ) discard;\n#endif",linear_to_gamma_fragment:"#ifdef GAMMA_OUTPUT\ngl_FragColor.xyz = sqrt( gl_FragColor.xyz );\n#endif"};
THREE.UniformsUtils={merge:function(b){var d,c,e,f={};for(d=0;d<b.length;d++)for(c in e=this.clone(b[d]),e)f[c]=e[c];return f},clone:function(b){var d,c,e,f={};for(d in b)for(c in f[d]={},b[d])e=b[d][c],f[d][c]=e instanceof THREE.Color||e instanceof THREE.Vector2||e instanceof THREE.Vector3||e instanceof THREE.Vector4||e instanceof THREE.Matrix4||e instanceof THREE.Texture?e.clone():e instanceof Array?e.slice():e;return f}};
THREE.UniformsLib={common:{diffuse:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},map:{type:"t",value:null},offsetRepeat:{type:"v4",value:new THREE.Vector4(0,0,1,1)},lightMap:{type:"t",value:null},specularMap:{type:"t",value:null},envMap:{type:"t",value:null},flipEnvMap:{type:"f",value:-1},useRefract:{type:"i",value:0},reflectivity:{type:"f",value:1},refractionRatio:{type:"f",value:0.98},combine:{type:"i",value:0},morphTargetInfluences:{type:"f",value:0}},bump:{bumpMap:{type:"t",
value:null},bumpScale:{type:"f",value:1}},normalmap:{normalMap:{type:"t",value:null},normalScale:{type:"v2",value:new THREE.Vector2(1,1)}},fog:{fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},lights:{ambientLightColor:{type:"fv",value:[]},directionalLightDirection:{type:"fv",value:[]},directionalLightColor:{type:"fv",value:[]},hemisphereLightDirection:{type:"fv",value:[]},hemisphereLightSkyColor:{type:"fv",
value:[]},hemisphereLightGroundColor:{type:"fv",value:[]},pointLightColor:{type:"fv",value:[]},pointLightPosition:{type:"fv",value:[]},pointLightDistance:{type:"fv1",value:[]},spotLightColor:{type:"fv",value:[]},spotLightPosition:{type:"fv",value:[]},spotLightDirection:{type:"fv",value:[]},spotLightDistance:{type:"fv1",value:[]},spotLightAngleCos:{type:"fv1",value:[]},spotLightExponent:{type:"fv1",value:[]}},particle:{psColor:{type:"c",value:new THREE.Color(15658734)},opacity:{type:"f",value:1},size:{type:"f",
value:1},scale:{type:"f",value:1},map:{type:"t",value:null},fogDensity:{type:"f",value:2.5E-4},fogNear:{type:"f",value:1},fogFar:{type:"f",value:2E3},fogColor:{type:"c",value:new THREE.Color(16777215)}},shadowmap:{shadowMap:{type:"tv",value:[]},shadowMapSize:{type:"v2v",value:[]},shadowBias:{type:"fv1",value:[]},shadowDarkness:{type:"fv1",value:[]},shadowMatrix:{type:"m4v",value:[]}}};
THREE.ShaderLib={basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.shadowmap]),vertexShader:[THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,
THREE.ShaderChunk.skinbase_vertex,"#ifdef USE_ENVMAP",THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"#endif",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,
THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},lambert:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",
THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_lambert_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,
THREE.ShaderChunk.defaultnormal_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,THREE.ShaderChunk.lights_lambert_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\nvarying vec3 vLightBack;\n#endif",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,
THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,"#ifdef DOUBLE_SIDED\nif ( gl_FrontFacing )\ngl_FragColor.xyz *= vLightFront;\nelse\ngl_FragColor.xyz *= vLightBack;\n#else\ngl_FragColor.xyz *= vLightFront;\n#endif",THREE.ShaderChunk.lightmap_fragment,
THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},phong:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.bump,THREE.UniformsLib.normalmap,THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{ambient:{type:"c",value:new THREE.Color(16777215)},emissive:{type:"c",value:new THREE.Color(0)},specular:{type:"c",
value:new THREE.Color(1118481)},shininess:{type:"f",value:30},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),vertexShader:["#define PHONG\nvarying vec3 vViewPosition;\nvarying vec3 vNormal;",THREE.ShaderChunk.map_pars_vertex,THREE.ShaderChunk.lightmap_pars_vertex,THREE.ShaderChunk.envmap_pars_vertex,THREE.ShaderChunk.lights_phong_pars_vertex,THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,
"void main() {",THREE.ShaderChunk.map_vertex,THREE.ShaderChunk.lightmap_vertex,THREE.ShaderChunk.color_vertex,THREE.ShaderChunk.morphnormal_vertex,THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,THREE.ShaderChunk.defaultnormal_vertex,"vNormal = normalize( transformedNormal );",THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"vViewPosition = -mvPosition.xyz;",THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.envmap_vertex,
THREE.ShaderChunk.lights_phong_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform vec3 ambient;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_pars_fragment,THREE.ShaderChunk.lightmap_pars_fragment,THREE.ShaderChunk.envmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.lights_phong_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,
THREE.ShaderChunk.bumpmap_pars_fragment,THREE.ShaderChunk.normalmap_pars_fragment,THREE.ShaderChunk.specularmap_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3 ( 1.0 ), opacity );",THREE.ShaderChunk.map_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.specularmap_fragment,THREE.ShaderChunk.lights_phong_fragment,THREE.ShaderChunk.lightmap_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.envmap_fragment,THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,
THREE.ShaderChunk.fog_fragment,"}"].join("\n")},particle_basic:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.particle,THREE.UniformsLib.shadowmap]),vertexShader:["uniform float size;\nuniform float scale;",THREE.ShaderChunk.color_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n#ifdef USE_SIZEATTENUATION\ngl_PointSize = size * ( scale / length( mvPosition.xyz ) );\n#else\ngl_PointSize = size;\n#endif\ngl_Position = projectionMatrix * mvPosition;",
THREE.ShaderChunk.worldpos_vertex,THREE.ShaderChunk.shadowmap_vertex,"}"].join("\n"),fragmentShader:["uniform vec3 psColor;\nuniform float opacity;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.map_particle_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,THREE.ShaderChunk.shadowmap_pars_fragment,"void main() {\ngl_FragColor = vec4( psColor, opacity );",THREE.ShaderChunk.map_particle_fragment,THREE.ShaderChunk.alphatest_fragment,THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.shadowmap_fragment,
THREE.ShaderChunk.fog_fragment,"}"].join("\n")},dashed:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.common,THREE.UniformsLib.fog,{scale:{type:"f",value:1},dashSize:{type:"f",value:1},totalSize:{type:"f",value:2}}]),vertexShader:["uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_vertex,"void main() {",THREE.ShaderChunk.color_vertex,"vLineDistance = scale * lineDistance;\nvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n}"].join("\n"),
fragmentShader:["uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;",THREE.ShaderChunk.color_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\nif ( mod( vLineDistance, totalSize ) > dashSize ) {\ndiscard;\n}\ngl_FragColor = vec4( diffuse, opacity );",THREE.ShaderChunk.color_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n")},depth:{uniforms:{mNear:{type:"f",value:1},mFar:{type:"f",value:2E3},opacity:{type:"f",
value:1}},vertexShader:"void main() {\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform float mNear;\nuniform float mFar;\nuniform float opacity;\nvoid main() {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat color = 1.0 - smoothstep( mNear, mFar, depth );\ngl_FragColor = vec4( vec3( color ), opacity );\n}"},normal:{uniforms:{opacity:{type:"f",value:1}},vertexShader:["varying vec3 vNormal;",THREE.ShaderChunk.morphtarget_pars_vertex,"void main() {\nvNormal = normalize( normalMatrix * normal );",
THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"uniform float opacity;\nvarying vec3 vNormal;\nvoid main() {\ngl_FragColor = vec4( 0.5 * normalize( vNormal ) + 0.5, opacity );\n}"},normalmap:{uniforms:THREE.UniformsUtils.merge([THREE.UniformsLib.fog,THREE.UniformsLib.lights,THREE.UniformsLib.shadowmap,{enableAO:{type:"i",value:0},enableDiffuse:{type:"i",value:0},enableSpecular:{type:"i",value:0},enableReflection:{type:"i",value:0},enableDisplacement:{type:"i",
value:0},tDisplacement:{type:"t",value:null},tDiffuse:{type:"t",value:null},tCube:{type:"t",value:null},tNormal:{type:"t",value:null},tSpecular:{type:"t",value:null},tAO:{type:"t",value:null},uNormalScale:{type:"v2",value:new THREE.Vector2(1,1)},uDisplacementBias:{type:"f",value:0},uDisplacementScale:{type:"f",value:1},uDiffuseColor:{type:"c",value:new THREE.Color(16777215)},uSpecularColor:{type:"c",value:new THREE.Color(1118481)},uAmbientColor:{type:"c",value:new THREE.Color(16777215)},uShininess:{type:"f",
value:30},uOpacity:{type:"f",value:1},useRefract:{type:"i",value:0},uRefractionRatio:{type:"f",value:0.98},uReflectivity:{type:"f",value:0.5},uOffset:{type:"v2",value:new THREE.Vector2(0,0)},uRepeat:{type:"v2",value:new THREE.Vector2(1,1)},wrapRGB:{type:"v3",value:new THREE.Vector3(1,1,1)}}]),fragmentShader:["uniform vec3 uAmbientColor;\nuniform vec3 uDiffuseColor;\nuniform vec3 uSpecularColor;\nuniform float uShininess;\nuniform float uOpacity;\nuniform bool enableDiffuse;\nuniform bool enableSpecular;\nuniform bool enableAO;\nuniform bool enableReflection;\nuniform sampler2D tDiffuse;\nuniform sampler2D tNormal;\nuniform sampler2D tSpecular;\nuniform sampler2D tAO;\nuniform samplerCube tCube;\nuniform vec2 uNormalScale;\nuniform bool useRefract;\nuniform float uRefractionRatio;\nuniform float uReflectivity;\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nuniform vec3 ambientLightColor;\n#if MAX_DIR_LIGHTS > 0\nuniform vec3 directionalLightColor[ MAX_DIR_LIGHTS ];\nuniform vec3 directionalLightDirection[ MAX_DIR_LIGHTS ];\n#endif\n#if MAX_HEMI_LIGHTS > 0\nuniform vec3 hemisphereLightSkyColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightGroundColor[ MAX_HEMI_LIGHTS ];\nuniform vec3 hemisphereLightDirection[ MAX_HEMI_LIGHTS ];\n#endif\n#if MAX_POINT_LIGHTS > 0\nuniform vec3 pointLightColor[ MAX_POINT_LIGHTS ];\nuniform vec3 pointLightPosition[ MAX_POINT_LIGHTS ];\nuniform float pointLightDistance[ MAX_POINT_LIGHTS ];\n#endif\n#if MAX_SPOT_LIGHTS > 0\nuniform vec3 spotLightColor[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightPosition[ MAX_SPOT_LIGHTS ];\nuniform vec3 spotLightDirection[ MAX_SPOT_LIGHTS ];\nuniform float spotLightAngleCos[ MAX_SPOT_LIGHTS ];\nuniform float spotLightExponent[ MAX_SPOT_LIGHTS ];\nuniform float spotLightDistance[ MAX_SPOT_LIGHTS ];\n#endif\n#ifdef WRAP_AROUND\nuniform vec3 wrapRGB;\n#endif\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.shadowmap_pars_fragment,THREE.ShaderChunk.fog_pars_fragment,"void main() {\ngl_FragColor = vec4( vec3( 1.0 ), uOpacity );\nvec3 specularTex = vec3( 1.0 );\nvec3 normalTex = texture2D( tNormal, vUv ).xyz * 2.0 - 1.0;\nnormalTex.xy *= uNormalScale;\nnormalTex = normalize( normalTex );\nif( enableDiffuse ) {\n#ifdef GAMMA_INPUT\nvec4 texelColor = texture2D( tDiffuse, vUv );\ntexelColor.xyz *= texelColor.xyz;\ngl_FragColor = gl_FragColor * texelColor;\n#else\ngl_FragColor = gl_FragColor * texture2D( tDiffuse, vUv );\n#endif\n}\nif( enableAO ) {\n#ifdef GAMMA_INPUT\nvec4 aoColor = texture2D( tAO, vUv );\naoColor.xyz *= aoColor.xyz;\ngl_FragColor.xyz = gl_FragColor.xyz * aoColor.xyz;\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * texture2D( tAO, vUv ).xyz;\n#endif\n}\nif( enableSpecular )\nspecularTex = texture2D( tSpecular, vUv ).xyz;\nmat3 tsb = mat3( normalize( vTangent ), normalize( vBinormal ), normalize( vNormal ) );\nvec3 finalNormal = tsb * normalTex;\n#ifdef FLIP_SIDED\nfinalNormal = -finalNormal;\n#endif\nvec3 normal = normalize( finalNormal );\nvec3 viewPosition = normalize( vViewPosition );\n#if MAX_POINT_LIGHTS > 0\nvec3 pointDiffuse = vec3( 0.0 );\nvec3 pointSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_POINT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( pointLightPosition[ i ], 1.0 );\nvec3 pointVector = lPosition.xyz + vViewPosition.xyz;\nfloat pointDistance = 1.0;\nif ( pointLightDistance[ i ] > 0.0 )\npointDistance = 1.0 - min( ( length( pointVector ) / pointLightDistance[ i ] ), 1.0 );\npointVector = normalize( pointVector );\n#ifdef WRAP_AROUND\nfloat pointDiffuseWeightFull = max( dot( normal, pointVector ), 0.0 );\nfloat pointDiffuseWeightHalf = max( 0.5 * dot( normal, pointVector ) + 0.5, 0.0 );\nvec3 pointDiffuseWeight = mix( vec3 ( pointDiffuseWeightFull ), vec3( pointDiffuseWeightHalf ), wrapRGB );\n#else\nfloat pointDiffuseWeight = max( dot( normal, pointVector ), 0.0 );\n#endif\npointDiffuse += pointDistance * pointLightColor[ i ] * uDiffuseColor * pointDiffuseWeight;\nvec3 pointHalfVector = normalize( pointVector + viewPosition );\nfloat pointDotNormalHalf = max( dot( normal, pointHalfVector ), 0.0 );\nfloat pointSpecularWeight = specularTex.r * max( pow( pointDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( pointVector, pointHalfVector ), 5.0 );\npointSpecular += schlick * pointLightColor[ i ] * pointSpecularWeight * pointDiffuseWeight * pointDistance * specularNormalization;\n#else\npointSpecular += pointDistance * pointLightColor[ i ] * uSpecularColor * pointSpecularWeight * pointDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_SPOT_LIGHTS > 0\nvec3 spotDiffuse = vec3( 0.0 );\nvec3 spotSpecular = vec3( 0.0 );\nfor ( int i = 0; i < MAX_SPOT_LIGHTS; i ++ ) {\nvec4 lPosition = viewMatrix * vec4( spotLightPosition[ i ], 1.0 );\nvec3 spotVector = lPosition.xyz + vViewPosition.xyz;\nfloat spotDistance = 1.0;\nif ( spotLightDistance[ i ] > 0.0 )\nspotDistance = 1.0 - min( ( length( spotVector ) / spotLightDistance[ i ] ), 1.0 );\nspotVector = normalize( spotVector );\nfloat spotEffect = dot( spotLightDirection[ i ], normalize( spotLightPosition[ i ] - vWorldPosition ) );\nif ( spotEffect > spotLightAngleCos[ i ] ) {\nspotEffect = max( pow( spotEffect, spotLightExponent[ i ] ), 0.0 );\n#ifdef WRAP_AROUND\nfloat spotDiffuseWeightFull = max( dot( normal, spotVector ), 0.0 );\nfloat spotDiffuseWeightHalf = max( 0.5 * dot( normal, spotVector ) + 0.5, 0.0 );\nvec3 spotDiffuseWeight = mix( vec3 ( spotDiffuseWeightFull ), vec3( spotDiffuseWeightHalf ), wrapRGB );\n#else\nfloat spotDiffuseWeight = max( dot( normal, spotVector ), 0.0 );\n#endif\nspotDiffuse += spotDistance * spotLightColor[ i ] * uDiffuseColor * spotDiffuseWeight * spotEffect;\nvec3 spotHalfVector = normalize( spotVector + viewPosition );\nfloat spotDotNormalHalf = max( dot( normal, spotHalfVector ), 0.0 );\nfloat spotSpecularWeight = specularTex.r * max( pow( spotDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( spotVector, spotHalfVector ), 5.0 );\nspotSpecular += schlick * spotLightColor[ i ] * spotSpecularWeight * spotDiffuseWeight * spotDistance * specularNormalization * spotEffect;\n#else\nspotSpecular += spotDistance * spotLightColor[ i ] * uSpecularColor * spotSpecularWeight * spotDiffuseWeight * spotEffect;\n#endif\n}\n}\n#endif\n#if MAX_DIR_LIGHTS > 0\nvec3 dirDiffuse = vec3( 0.0 );\nvec3 dirSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_DIR_LIGHTS; i++ ) {\nvec4 lDirection = viewMatrix * vec4( directionalLightDirection[ i ], 0.0 );\nvec3 dirVector = normalize( lDirection.xyz );\n#ifdef WRAP_AROUND\nfloat directionalLightWeightingFull = max( dot( normal, dirVector ), 0.0 );\nfloat directionalLightWeightingHalf = max( 0.5 * dot( normal, dirVector ) + 0.5, 0.0 );\nvec3 dirDiffuseWeight = mix( vec3( directionalLightWeightingFull ), vec3( directionalLightWeightingHalf ), wrapRGB );\n#else\nfloat dirDiffuseWeight = max( dot( normal, dirVector ), 0.0 );\n#endif\ndirDiffuse += directionalLightColor[ i ] * uDiffuseColor * dirDiffuseWeight;\nvec3 dirHalfVector = normalize( dirVector + viewPosition );\nfloat dirDotNormalHalf = max( dot( normal, dirHalfVector ), 0.0 );\nfloat dirSpecularWeight = specularTex.r * max( pow( dirDotNormalHalf, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlick = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( dirVector, dirHalfVector ), 5.0 );\ndirSpecular += schlick * directionalLightColor[ i ] * dirSpecularWeight * dirDiffuseWeight * specularNormalization;\n#else\ndirSpecular += directionalLightColor[ i ] * uSpecularColor * dirSpecularWeight * dirDiffuseWeight;\n#endif\n}\n#endif\n#if MAX_HEMI_LIGHTS > 0\nvec3 hemiDiffuse  = vec3( 0.0 );\nvec3 hemiSpecular = vec3( 0.0 );\nfor( int i = 0; i < MAX_HEMI_LIGHTS; i ++ ) {\nvec4 lDirection = viewMatrix * vec4( hemisphereLightDirection[ i ], 0.0 );\nvec3 lVector = normalize( lDirection.xyz );\nfloat dotProduct = dot( normal, lVector );\nfloat hemiDiffuseWeight = 0.5 * dotProduct + 0.5;\nvec3 hemiColor = mix( hemisphereLightGroundColor[ i ], hemisphereLightSkyColor[ i ], hemiDiffuseWeight );\nhemiDiffuse += uDiffuseColor * hemiColor;\nvec3 hemiHalfVectorSky = normalize( lVector + viewPosition );\nfloat hemiDotNormalHalfSky = 0.5 * dot( normal, hemiHalfVectorSky ) + 0.5;\nfloat hemiSpecularWeightSky = specularTex.r * max( pow( hemiDotNormalHalfSky, uShininess ), 0.0 );\nvec3 lVectorGround = -lVector;\nvec3 hemiHalfVectorGround = normalize( lVectorGround + viewPosition );\nfloat hemiDotNormalHalfGround = 0.5 * dot( normal, hemiHalfVectorGround ) + 0.5;\nfloat hemiSpecularWeightGround = specularTex.r * max( pow( hemiDotNormalHalfGround, uShininess ), 0.0 );\n#ifdef PHYSICALLY_BASED_SHADING\nfloat dotProductGround = dot( normal, lVectorGround );\nfloat specularNormalization = ( uShininess + 2.0001 ) / 8.0;\nvec3 schlickSky = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVector, hemiHalfVectorSky ), 5.0 );\nvec3 schlickGround = uSpecularColor + vec3( 1.0 - uSpecularColor ) * pow( 1.0 - dot( lVectorGround, hemiHalfVectorGround ), 5.0 );\nhemiSpecular += hemiColor * specularNormalization * ( schlickSky * hemiSpecularWeightSky * max( dotProduct, 0.0 ) + schlickGround * hemiSpecularWeightGround * max( dotProductGround, 0.0 ) );\n#else\nhemiSpecular += uSpecularColor * hemiColor * ( hemiSpecularWeightSky + hemiSpecularWeightGround ) * hemiDiffuseWeight;\n#endif\n}\n#endif\nvec3 totalDiffuse = vec3( 0.0 );\nvec3 totalSpecular = vec3( 0.0 );\n#if MAX_DIR_LIGHTS > 0\ntotalDiffuse += dirDiffuse;\ntotalSpecular += dirSpecular;\n#endif\n#if MAX_HEMI_LIGHTS > 0\ntotalDiffuse += hemiDiffuse;\ntotalSpecular += hemiSpecular;\n#endif\n#if MAX_POINT_LIGHTS > 0\ntotalDiffuse += pointDiffuse;\ntotalSpecular += pointSpecular;\n#endif\n#if MAX_SPOT_LIGHTS > 0\ntotalDiffuse += spotDiffuse;\ntotalSpecular += spotSpecular;\n#endif\n#ifdef METAL\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor + totalSpecular );\n#else\ngl_FragColor.xyz = gl_FragColor.xyz * ( totalDiffuse + ambientLightColor * uAmbientColor ) + totalSpecular;\n#endif\nif ( enableReflection ) {\nvec3 vReflect;\nvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\nif ( useRefract ) {\nvReflect = refract( cameraToVertex, normal, uRefractionRatio );\n} else {\nvReflect = reflect( cameraToVertex, normal );\n}\nvec4 cubeColor = textureCube( tCube, vec3( -vReflect.x, vReflect.yz ) );\n#ifdef GAMMA_INPUT\ncubeColor.xyz *= cubeColor.xyz;\n#endif\ngl_FragColor.xyz = mix( gl_FragColor.xyz, cubeColor.xyz, specularTex.r * uReflectivity );\n}",
THREE.ShaderChunk.shadowmap_fragment,THREE.ShaderChunk.linear_to_gamma_fragment,THREE.ShaderChunk.fog_fragment,"}"].join("\n"),vertexShader:["attribute vec4 tangent;\nuniform vec2 uOffset;\nuniform vec2 uRepeat;\nuniform bool enableDisplacement;\n#ifdef VERTEX_TEXTURES\nuniform sampler2D tDisplacement;\nuniform float uDisplacementScale;\nuniform float uDisplacementBias;\n#endif\nvarying vec3 vTangent;\nvarying vec3 vBinormal;\nvarying vec3 vNormal;\nvarying vec2 vUv;\nvarying vec3 vWorldPosition;\nvarying vec3 vViewPosition;",
THREE.ShaderChunk.skinning_pars_vertex,THREE.ShaderChunk.shadowmap_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.skinnormal_vertex,"#ifdef USE_SKINNING\nvNormal = normalize( normalMatrix * skinnedNormal.xyz );\nvec4 skinnedTangent = skinMatrix * vec4( tangent.xyz, 0.0 );\nvTangent = normalize( normalMatrix * skinnedTangent.xyz );\n#else\nvNormal = normalize( normalMatrix * normal );\nvTangent = normalize( normalMatrix * tangent.xyz );\n#endif\nvBinormal = normalize( cross( vNormal, vTangent ) * tangent.w );\nvUv = uv * uRepeat + uOffset;\nvec3 displacedPosition;\n#ifdef VERTEX_TEXTURES\nif ( enableDisplacement ) {\nvec3 dv = texture2D( tDisplacement, uv ).xyz;\nfloat df = uDisplacementScale * dv.x + uDisplacementBias;\ndisplacedPosition = position + normalize( normal ) * df;\n} else {\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n}\n#else\n#ifdef USE_SKINNING\nvec4 skinVertex = vec4( position, 1.0 );\nvec4 skinned  = boneMatX * skinVertex * skinWeight.x;\nskinned \t  += boneMatY * skinVertex * skinWeight.y;\ndisplacedPosition  = skinned.xyz;\n#else\ndisplacedPosition = position;\n#endif\n#endif\nvec4 mvPosition = modelViewMatrix * vec4( displacedPosition, 1.0 );\nvec4 worldPosition = modelMatrix * vec4( displacedPosition, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\nvWorldPosition = worldPosition.xyz;\nvViewPosition = -mvPosition.xyz;\n#ifdef USE_SHADOWMAP\nfor( int i = 0; i < MAX_SHADOWS; i ++ ) {\nvShadowCoord[ i ] = shadowMatrix[ i ] * worldPosition;\n}\n#endif\n}"].join("\n")},
cube:{uniforms:{tCube:{type:"t",value:null},tFlip:{type:"f",value:-1}},vertexShader:"varying vec3 vWorldPosition;\nvoid main() {\nvec4 worldPosition = modelMatrix * vec4( position, 1.0 );\nvWorldPosition = worldPosition.xyz;\ngl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",fragmentShader:"uniform samplerCube tCube;\nuniform float tFlip;\nvarying vec3 vWorldPosition;\nvoid main() {\ngl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n}"},
depthRGBA:{uniforms:{},vertexShader:[THREE.ShaderChunk.morphtarget_pars_vertex,THREE.ShaderChunk.skinning_pars_vertex,"void main() {",THREE.ShaderChunk.skinbase_vertex,THREE.ShaderChunk.morphtarget_vertex,THREE.ShaderChunk.skinning_vertex,THREE.ShaderChunk.default_vertex,"}"].join("\n"),fragmentShader:"vec4 pack_depth( const in float depth ) {\nconst vec4 bit_shift = vec4( 256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0 );\nconst vec4 bit_mask  = vec4( 0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0 );\nvec4 res = fract( depth * bit_shift );\nres -= res.xxyz * bit_mask;\nreturn res;\n}\nvoid main() {\ngl_FragData[ 0 ] = pack_depth( gl_FragCoord.z );\n}"}};
THREE.WebGLRenderer=function(b){function d(b){if(b.__webglCustomAttributesList)for(var c in b.__webglCustomAttributesList)x.deleteBuffer(b.__webglCustomAttributesList[c].buffer)}function c(b,c){var e=b.vertices.length,d=c.material;if(d.attributes){void 0===b.__webglCustomAttributesList&&(b.__webglCustomAttributesList=[]);for(var f in d.attributes){var g=d.attributes[f];if(!g.__webglInitialized||g.createUniqueBuffers){g.__webglInitialized=!0;var h=1;"v2"===g.type?h=2:"v3"===g.type?h=3:"v4"===g.type?
h=4:"c"===g.type&&(h=3);g.size=h;g.array=new Float32Array(e*h);g.buffer=x.createBuffer();g.buffer.belongsToAttribute=f;g.needsUpdate=!0}b.__webglCustomAttributesList.push(g)}}}function e(b,c){var e=c.geometry,d=b.faces3,k=b.faces4,l=3*d.length+4*k.length,p=1*d.length+2*k.length,k=3*d.length+4*k.length,d=f(c,b),q=h(d),r=g(d),s=d.vertexColors?d.vertexColors:!1;b.__vertexArray=new Float32Array(3*l);r&&(b.__normalArray=new Float32Array(3*l));e.hasTangents&&(b.__tangentArray=new Float32Array(4*l));s&&
(b.__colorArray=new Float32Array(3*l));if(q){if(0<e.faceUvs.length||0<e.faceVertexUvs.length)b.__uvArray=new Float32Array(2*l);if(1<e.faceUvs.length||1<e.faceVertexUvs.length)b.__uv2Array=new Float32Array(2*l)}c.geometry.skinWeights.length&&c.geometry.skinIndices.length&&(b.__skinIndexArray=new Float32Array(4*l),b.__skinWeightArray=new Float32Array(4*l));b.__faceArray=new Uint16Array(3*p);b.__lineArray=new Uint16Array(2*k);if(b.numMorphTargets){b.__morphTargetsArrays=[];e=0;for(q=b.numMorphTargets;e<
q;e++)b.__morphTargetsArrays.push(new Float32Array(3*l))}if(b.numMorphNormals){b.__morphNormalsArrays=[];e=0;for(q=b.numMorphNormals;e<q;e++)b.__morphNormalsArrays.push(new Float32Array(3*l))}b.__webglFaceCount=3*p;b.__webglLineCount=2*k;if(d.attributes){void 0===b.__webglCustomAttributesList&&(b.__webglCustomAttributesList=[]);for(var t in d.attributes){var p=d.attributes[t],e={},u;for(u in p)e[u]=p[u];if(!e.__webglInitialized||e.createUniqueBuffers)e.__webglInitialized=!0,k=1,"v2"===e.type?k=2:
"v3"===e.type?k=3:"v4"===e.type?k=4:"c"===e.type&&(k=3),e.size=k,e.array=new Float32Array(l*k),e.buffer=x.createBuffer(),e.buffer.belongsToAttribute=t,p.needsUpdate=!0,e.__original=p;b.__webglCustomAttributesList.push(e)}}b.__inittedArrays=!0}function f(b,c){return b.material instanceof THREE.MeshFaceMaterial?b.material.materials[c.materialIndex]:b.material}function g(b){return b instanceof THREE.MeshBasicMaterial&&!b.envMap||b instanceof THREE.MeshDepthMaterial?!1:b&&void 0!==b.shading&&b.shading===
THREE.SmoothShading?THREE.SmoothShading:THREE.FlatShading}function h(b){return b.map||b.lightMap||b.bumpMap||b.normalMap||b.specularMap||b instanceof THREE.ShaderMaterial?!0:!1}function k(b){Va[b]||(x.enableVertexAttribArray(b),Va[b]=!0)}function l(){for(var b in Va)Va[b]&&(x.disableVertexAttribArray(b),Va[b]=!1)}function p(b,c){return b.z!==c.z?c.z-b.z:b.id-c.id}function q(b,c){return c[0]-b[0]}function r(b,c,e){if(b.length)for(var d=0,f=b.length;d<f;d++)Oa=Y=null,Na=Qa=ea=ia=ha=Ua=xa=-1,oa=!0,b[d].render(c,
e,db,Ib),Oa=Y=null,Na=Qa=ea=ia=ha=Ua=xa=-1,oa=!0}function s(b,c,e,d,f,g,h,k){var l,p,q,r;c?(p=b.length-1,r=c=-1):(p=0,c=b.length,r=1);for(var s=p;s!==c;s+=r)if(l=b[s],l.render){p=l.object;q=l.buffer;if(k)l=k;else{l=l[e];if(!l)continue;h&&S.setBlending(l.blending,l.blendEquation,l.blendSrc,l.blendDst);S.setDepthTest(l.depthTest);S.setDepthWrite(l.depthWrite);H(l.polygonOffset,l.polygonOffsetFactor,l.polygonOffsetUnits)}S.setMaterialFaces(l);q instanceof THREE.BufferGeometry?S.renderBufferDirect(d,
f,g,l,q,p):S.renderBuffer(d,f,g,l,q,p)}}function t(b,c,e,d,f,g,h){for(var k,l,p=0,q=b.length;p<q;p++)if(k=b[p],l=k.object,l.visible){if(h)k=h;else{k=k[c];if(!k)continue;g&&S.setBlending(k.blending,k.blendEquation,k.blendSrc,k.blendDst);S.setDepthTest(k.depthTest);S.setDepthWrite(k.depthWrite);H(k.polygonOffset,k.polygonOffsetFactor,k.polygonOffsetUnits)}S.renderImmediateObject(e,d,f,k,l)}}function u(b,d){var f,g,h,k;if(void 0===b.__webglInit&&(b.__webglInit=!0,b._modelViewMatrix=new THREE.Matrix4,
b._normalMatrix=new THREE.Matrix3,void 0!==b.geometry&&void 0===b.geometry.__webglInit&&(b.geometry.__webglInit=!0,b.geometry.addEventListener("dispose",Gc)),g=b.geometry,void 0!==g))if(g instanceof THREE.BufferGeometry){var l,p;for(l in g.attributes)p="index"===l?x.ELEMENT_ARRAY_BUFFER:x.ARRAY_BUFFER,k=g.attributes[l],k.buffer=x.createBuffer(),x.bindBuffer(p,k.buffer),x.bufferData(p,k.array,x.STATIC_DRAW)}else if(b instanceof THREE.Mesh){h=b.material;if(void 0===g.geometryGroups){l=g;var q,r,s,t,
u;p={};var w=l.morphTargets.length,y=l.morphNormals.length,z=h instanceof THREE.MeshFaceMaterial;l.geometryGroups={};h=0;for(q=l.faces.length;h<q;h++)r=l.faces[h],s=z?r.materialIndex:0,void 0===p[s]&&(p[s]={hash:s,counter:0}),u=p[s].hash+"_"+p[s].counter,void 0===l.geometryGroups[u]&&(l.geometryGroups[u]={faces3:[],faces4:[],materialIndex:s,vertices:0,numMorphTargets:w,numMorphNormals:y}),t=r instanceof THREE.Face3?3:4,65535<l.geometryGroups[u].vertices+t&&(p[s].counter+=1,u=p[s].hash+"_"+p[s].counter,
void 0===l.geometryGroups[u]&&(l.geometryGroups[u]={faces3:[],faces4:[],materialIndex:s,vertices:0,numMorphTargets:w,numMorphNormals:y})),r instanceof THREE.Face3?l.geometryGroups[u].faces3.push(h):l.geometryGroups[u].faces4.push(h),l.geometryGroups[u].vertices+=t;l.geometryGroupsList=[];for(k in l.geometryGroups)l.geometryGroups[k].id=fa++,l.geometryGroupsList.push(l.geometryGroups[k])}for(f in g.geometryGroups)if(k=g.geometryGroups[f],!k.__webglVertexBuffer){l=k;l.__webglVertexBuffer=x.createBuffer();
l.__webglNormalBuffer=x.createBuffer();l.__webglTangentBuffer=x.createBuffer();l.__webglColorBuffer=x.createBuffer();l.__webglUVBuffer=x.createBuffer();l.__webglUV2Buffer=x.createBuffer();l.__webglSkinIndicesBuffer=x.createBuffer();l.__webglSkinWeightsBuffer=x.createBuffer();l.__webglFaceBuffer=x.createBuffer();l.__webglLineBuffer=x.createBuffer();if(l.numMorphTargets){l.__webglMorphTargetsBuffers=[];p=0;for(w=l.numMorphTargets;p<w;p++)l.__webglMorphTargetsBuffers.push(x.createBuffer())}if(l.numMorphNormals){l.__webglMorphNormalsBuffers=
[];p=0;for(w=l.numMorphNormals;p<w;p++)l.__webglMorphNormalsBuffers.push(x.createBuffer())}S.info.memory.geometries++;e(k,b);g.verticesNeedUpdate=!0;g.morphTargetsNeedUpdate=!0;g.elementsNeedUpdate=!0;g.uvsNeedUpdate=!0;g.normalsNeedUpdate=!0;g.tangentsNeedUpdate=!0;g.colorsNeedUpdate=!0}}else b instanceof THREE.Ribbon?g.__webglVertexBuffer||(k=g,k.__webglVertexBuffer=x.createBuffer(),k.__webglColorBuffer=x.createBuffer(),k.__webglNormalBuffer=x.createBuffer(),S.info.memory.geometries++,k=g,l=k.vertices.length,
k.__vertexArray=new Float32Array(3*l),k.__colorArray=new Float32Array(3*l),k.__normalArray=new Float32Array(3*l),k.__webglVertexCount=l,c(k,b),g.verticesNeedUpdate=!0,g.colorsNeedUpdate=!0,g.normalsNeedUpdate=!0):b instanceof THREE.Line?g.__webglVertexBuffer||(k=g,k.__webglVertexBuffer=x.createBuffer(),k.__webglColorBuffer=x.createBuffer(),k.__webglLineDistanceBuffer=x.createBuffer(),S.info.memory.geometries++,k=g,l=k.vertices.length,k.__vertexArray=new Float32Array(3*l),k.__colorArray=new Float32Array(3*
l),k.__lineDistanceArray=new Float32Array(1*l),k.__webglLineCount=l,c(k,b),g.verticesNeedUpdate=!0,g.colorsNeedUpdate=!0,g.lineDistancesNeedUpdate=!0):b instanceof THREE.ParticleSystem&&!g.__webglVertexBuffer&&(k=g,k.__webglVertexBuffer=x.createBuffer(),k.__webglColorBuffer=x.createBuffer(),S.info.memory.geometries++,k=g,l=k.vertices.length,k.__vertexArray=new Float32Array(3*l),k.__colorArray=new Float32Array(3*l),k.__sortArray=[],k.__webglParticleCount=l,c(k,b),g.verticesNeedUpdate=!0,g.colorsNeedUpdate=
!0);if(void 0===b.__webglActive){if(b instanceof THREE.Mesh)if(g=b.geometry,g instanceof THREE.BufferGeometry)v(d.__webglObjects,g,b);else{if(g instanceof THREE.Geometry)for(f in g.geometryGroups)k=g.geometryGroups[f],v(d.__webglObjects,k,b)}else b instanceof THREE.Ribbon||b instanceof THREE.Line||b instanceof THREE.ParticleSystem?(g=b.geometry,v(d.__webglObjects,g,b)):b instanceof THREE.ImmediateRenderObject||b.immediateRenderCallback?d.__webglObjectsImmediate.push({object:b,opaque:null,transparent:null}):
b instanceof THREE.Sprite?d.__webglSprites.push(b):b instanceof THREE.LensFlare&&d.__webglFlares.push(b);b.__webglActive=!0}}function v(b,c,e){b.push({buffer:c,object:e,opaque:null,transparent:null})}function w(b){for(var c in b.attributes)if(b.attributes[c].needsUpdate)return!0;return!1}function y(b){for(var c in b.attributes)b.attributes[c].needsUpdate=!1}function z(b,c){b instanceof THREE.Mesh||b instanceof THREE.ParticleSystem||b instanceof THREE.Ribbon||b instanceof THREE.Line?B(c.__webglObjects,
b):b instanceof THREE.Sprite?A(c.__webglSprites,b):b instanceof THREE.LensFlare?A(c.__webglFlares,b):(b instanceof THREE.ImmediateRenderObject||b.immediateRenderCallback)&&B(c.__webglObjectsImmediate,b);delete b.__webglActive}function B(b,c){for(var e=b.length-1;0<=e;e--)b[e].object===c&&b.splice(e,1)}function A(b,c){for(var e=b.length-1;0<=e;e--)b[e]===c&&b.splice(e,1)}function K(b,c,e,d,f){T=0;d.needsUpdate&&(d.program&&Hc(d),S.initMaterial(d,c,e,f),d.needsUpdate=!1);d.morphTargets&&!f.__webglMorphTargetInfluences&&
(f.__webglMorphTargetInfluences=new Float32Array(S.maxMorphTargets));var g=!1,h=d.program,k=h.uniforms,l=d.uniforms;h!==Y&&(x.useProgram(h),Y=h,g=!0);d.id!==Na&&(Na=d.id,g=!0);if(g||b!==Oa)x.uniformMatrix4fv(k.projectionMatrix,!1,b.projectionMatrix.elements),b!==Oa&&(Oa=b);if(d.skinning)if(Jb&&f.useVertexTexture){if(null!==k.boneTexture){var p=O();x.uniform1i(k.boneTexture,p);S.setTexture(f.boneTexture,p)}}else null!==k.boneGlobalMatrices&&x.uniformMatrix4fv(k.boneGlobalMatrices,!1,f.boneMatrices);
if(g){e&&d.fog&&(l.fogColor.value=e.color,e instanceof THREE.Fog?(l.fogNear.value=e.near,l.fogFar.value=e.far):e instanceof THREE.FogExp2&&(l.fogDensity.value=e.density));if(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d.lights){if(oa){var q,r=p=0,s=0,t,u,v,w=Ia,y=w.directional.colors,z=w.directional.positions,qa=w.point.colors,da=w.point.positions,A=w.point.distances,B=w.spot.colors,U=w.spot.positions,G=w.spot.distances,aa=w.spot.directions,K=w.spot.anglesCos,H=w.spot.exponents,
ba=w.hemi.skyColors,$=w.hemi.groundColors,na=w.hemi.positions,ta=0,ra=0,M=0,X=0,I=0,C=0,N=0,Qa=0,R=0;e=v=R=0;for(g=c.length;e<g;e++)q=c[e],q.onlyShadow||(t=q.color,u=q.intensity,v=q.distance,q instanceof THREE.AmbientLight?q.visible&&(S.gammaInput?(p+=t.r*t.r,r+=t.g*t.g,s+=t.b*t.b):(p+=t.r,r+=t.g,s+=t.b)):q instanceof THREE.DirectionalLight?(I+=1,q.visible&&(wa.getPositionFromMatrix(q.matrixWorld),fb.getPositionFromMatrix(q.target.matrixWorld),wa.sub(fb),wa.normalize(),0===wa.x&&0===wa.y&&0===wa.z||
(q=3*ta,z[q]=wa.x,z[q+1]=wa.y,z[q+2]=wa.z,S.gammaInput?E(y,q,t,u*u):F(y,q,t,u),ta+=1))):q instanceof THREE.PointLight?(C+=1,q.visible&&(R=3*ra,S.gammaInput?E(qa,R,t,u*u):F(qa,R,t,u),fb.getPositionFromMatrix(q.matrixWorld),da[R]=fb.x,da[R+1]=fb.y,da[R+2]=fb.z,A[ra]=v,ra+=1)):q instanceof THREE.SpotLight?(N+=1,q.visible&&(R=3*M,S.gammaInput?E(B,R,t,u*u):F(B,R,t,u),fb.getPositionFromMatrix(q.matrixWorld),U[R]=fb.x,U[R+1]=fb.y,U[R+2]=fb.z,G[M]=v,wa.copy(fb),fb.getPositionFromMatrix(q.target.matrixWorld),
wa.sub(fb),wa.normalize(),aa[R]=wa.x,aa[R+1]=wa.y,aa[R+2]=wa.z,K[M]=Math.cos(q.angle),H[M]=q.exponent,M+=1)):q instanceof THREE.HemisphereLight&&(Qa+=1,q.visible&&(wa.getPositionFromMatrix(q.matrixWorld),wa.normalize(),0===wa.x&&0===wa.y&&0===wa.z||(v=3*X,na[v]=wa.x,na[v+1]=wa.y,na[v+2]=wa.z,t=q.color,q=q.groundColor,S.gammaInput?(u*=u,E(ba,v,t,u),E($,v,q,u)):(F(ba,v,t,u),F($,v,q,u)),X+=1))));e=3*ta;for(g=Math.max(y.length,3*I);e<g;e++)y[e]=0;e=3*ra;for(g=Math.max(qa.length,3*C);e<g;e++)qa[e]=0;e=
3*M;for(g=Math.max(B.length,3*N);e<g;e++)B[e]=0;e=3*X;for(g=Math.max(ba.length,3*Qa);e<g;e++)ba[e]=0;e=3*X;for(g=Math.max($.length,3*Qa);e<g;e++)$[e]=0;w.directional.length=ta;w.point.length=ra;w.spot.length=M;w.hemi.length=X;w.ambient[0]=p;w.ambient[1]=r;w.ambient[2]=s;oa=!1}e=Ia;l.ambientLightColor.value=e.ambient;l.directionalLightColor.value=e.directional.colors;l.directionalLightDirection.value=e.directional.positions;l.pointLightColor.value=e.point.colors;l.pointLightPosition.value=e.point.positions;
l.pointLightDistance.value=e.point.distances;l.spotLightColor.value=e.spot.colors;l.spotLightPosition.value=e.spot.positions;l.spotLightDistance.value=e.spot.distances;l.spotLightDirection.value=e.spot.directions;l.spotLightAngleCos.value=e.spot.anglesCos;l.spotLightExponent.value=e.spot.exponents;l.hemisphereLightSkyColor.value=e.hemi.skyColors;l.hemisphereLightGroundColor.value=e.hemi.groundColors;l.hemisphereLightDirection.value=e.hemi.positions}if(d instanceof THREE.MeshBasicMaterial||d instanceof
THREE.MeshLambertMaterial||d instanceof THREE.MeshPhongMaterial){l.opacity.value=d.opacity;S.gammaInput?l.diffuse.value.copyGammaToLinear(d.color):l.diffuse.value=d.color;l.map.value=d.map;l.lightMap.value=d.lightMap;l.specularMap.value=d.specularMap;d.bumpMap&&(l.bumpMap.value=d.bumpMap,l.bumpScale.value=d.bumpScale);d.normalMap&&(l.normalMap.value=d.normalMap,l.normalScale.value.copy(d.normalScale));var fa;d.map?fa=d.map:d.specularMap?fa=d.specularMap:d.normalMap?fa=d.normalMap:d.bumpMap&&(fa=d.bumpMap);
void 0!==fa&&(e=fa.offset,fa=fa.repeat,l.offsetRepeat.value.set(e.x,e.y,fa.x,fa.y));l.envMap.value=d.envMap;l.flipEnvMap.value=d.envMap instanceof THREE.WebGLRenderTargetCube?1:-1;l.reflectivity.value=d.reflectivity;l.refractionRatio.value=d.refractionRatio;l.combine.value=d.combine;l.useRefract.value=d.envMap&&d.envMap.mapping instanceof THREE.CubeRefractionMapping}d instanceof THREE.LineBasicMaterial?(l.diffuse.value=d.color,l.opacity.value=d.opacity):d instanceof THREE.LineDashedMaterial?(l.diffuse.value=
d.color,l.opacity.value=d.opacity,l.dashSize.value=d.dashSize,l.totalSize.value=d.dashSize+d.gapSize,l.scale.value=d.scale):d instanceof THREE.ParticleBasicMaterial?(l.psColor.value=d.color,l.opacity.value=d.opacity,l.size.value=d.size,l.scale.value=V.height/2,l.map.value=d.map):d instanceof THREE.MeshPhongMaterial?(l.shininess.value=d.shininess,S.gammaInput?(l.ambient.value.copyGammaToLinear(d.ambient),l.emissive.value.copyGammaToLinear(d.emissive),l.specular.value.copyGammaToLinear(d.specular)):
(l.ambient.value=d.ambient,l.emissive.value=d.emissive,l.specular.value=d.specular),d.wrapAround&&l.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshLambertMaterial?(S.gammaInput?(l.ambient.value.copyGammaToLinear(d.ambient),l.emissive.value.copyGammaToLinear(d.emissive)):(l.ambient.value=d.ambient,l.emissive.value=d.emissive),d.wrapAround&&l.wrapRGB.value.copy(d.wrapRGB)):d instanceof THREE.MeshDepthMaterial?(l.mNear.value=b.near,l.mFar.value=b.far,l.opacity.value=d.opacity):d instanceof THREE.MeshNormalMaterial&&
(l.opacity.value=d.opacity);if(f.receiveShadow&&!d._shadowPass&&l.shadowMatrix){e=fa=0;for(g=c.length;e<g;e++)if(p=c[e],p.castShadow&&(p instanceof THREE.SpotLight||p instanceof THREE.DirectionalLight&&!p.shadowCascade))l.shadowMap.value[fa]=p.shadowMap,l.shadowMapSize.value[fa]=p.shadowMapSize,l.shadowMatrix.value[fa]=p.shadowMatrix,l.shadowDarkness.value[fa]=p.shadowDarkness,l.shadowBias.value[fa]=p.shadowBias,fa++}c=d.uniformsList;l=0;for(fa=c.length;l<fa;l++)if(g=h.uniforms[c[l][1]])if(e=c[l][0],
r=e.type,p=e.value,"i"===r)x.uniform1i(g,p);else if("f"===r)x.uniform1f(g,p);else if("v2"===r)x.uniform2f(g,p.x,p.y);else if("v3"===r)x.uniform3f(g,p.x,p.y,p.z);else if("v4"===r)x.uniform4f(g,p.x,p.y,p.z,p.w);else if("c"===r)x.uniform3f(g,p.r,p.g,p.b);else if("iv1"===r)x.uniform1iv(g,p);else if("iv"===r)x.uniform3iv(g,p);else if("fv1"===r)x.uniform1fv(g,p);else if("fv"===r)x.uniform3fv(g,p);else if("v2v"===r){void 0===e._array&&(e._array=new Float32Array(2*p.length));r=0;for(s=p.length;r<s;r++)w=
2*r,e._array[w]=p[r].x,e._array[w+1]=p[r].y;x.uniform2fv(g,e._array)}else if("v3v"===r){void 0===e._array&&(e._array=new Float32Array(3*p.length));r=0;for(s=p.length;r<s;r++)w=3*r,e._array[w]=p[r].x,e._array[w+1]=p[r].y,e._array[w+2]=p[r].z;x.uniform3fv(g,e._array)}else if("v4v"===r){void 0===e._array&&(e._array=new Float32Array(4*p.length));r=0;for(s=p.length;r<s;r++)w=4*r,e._array[w]=p[r].x,e._array[w+1]=p[r].y,e._array[w+2]=p[r].z,e._array[w+3]=p[r].w;x.uniform4fv(g,e._array)}else if("m4"===r)void 0===
e._array&&(e._array=new Float32Array(16)),p.flattenToArray(e._array),x.uniformMatrix4fv(g,!1,e._array);else if("m4v"===r){void 0===e._array&&(e._array=new Float32Array(16*p.length));r=0;for(s=p.length;r<s;r++)p[r].flattenToArrayOffset(e._array,16*r);x.uniformMatrix4fv(g,!1,e._array)}else if("t"===r){if(w=p,p=O(),x.uniform1i(g,p),w)if(w.image instanceof Array&&6===w.image.length){if(e=w,g=p,6===e.image.length)if(e.needsUpdate){e.image.__webglTextureCube||(e.image.__webglTextureCube=x.createTexture(),
S.info.memory.textures++);x.activeTexture(x.TEXTURE0+g);x.bindTexture(x.TEXTURE_CUBE_MAP,e.image.__webglTextureCube);x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,e.flipY);g=e instanceof THREE.CompressedTexture;p=[];for(r=0;6>r;r++)S.autoScaleCubemaps&&!g?(s=p,w=r,y=e.image[r],qa=za,y.width<=qa&&y.height<=qa||(da=Math.max(y.width,y.height),z=Math.floor(y.width*qa/da),qa=Math.floor(y.height*qa/da),da=document.createElement("canvas"),da.width=z,da.height=qa,da.getContext("2d").drawImage(y,0,0,y.width,y.height,
0,0,z,qa),y=da),s[w]=y):p[r]=e.image[r];r=p[0];s=0===(r.width&r.width-1)&&0===(r.height&r.height-1);w=Q(e.format);y=Q(e.type);D(x.TEXTURE_CUBE_MAP,e,s);for(r=0;6>r;r++)if(g){qa=p[r].mipmaps;da=0;for(A=qa.length;da<A;da++)z=qa[da],x.compressedTexImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+r,da,w,z.width,z.height,0,z.data)}else x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+r,0,w,w,y,p[r]);e.generateMipmaps&&s&&x.generateMipmap(x.TEXTURE_CUBE_MAP);e.needsUpdate=!1;if(e.onUpdate)e.onUpdate()}else x.activeTexture(x.TEXTURE0+
g),x.bindTexture(x.TEXTURE_CUBE_MAP,e.image.__webglTextureCube)}else w instanceof THREE.WebGLRenderTargetCube?(e=w,x.activeTexture(x.TEXTURE0+p),x.bindTexture(x.TEXTURE_CUBE_MAP,e.__webglTexture)):S.setTexture(w,p)}else if("tv"===r){void 0===e._array&&(e._array=[]);r=0;for(s=e.value.length;r<s;r++)e._array[r]=O();x.uniform1iv(g,e._array);r=0;for(s=e.value.length;r<s;r++)w=e.value[r],p=e._array[r],w&&S.setTexture(w,p)}if((d instanceof THREE.ShaderMaterial||d instanceof THREE.MeshPhongMaterial||d.envMap)&&
null!==k.cameraPosition)fb.getPositionFromMatrix(b.matrixWorld),x.uniform3f(k.cameraPosition,fb.x,fb.y,fb.z);(d instanceof THREE.MeshPhongMaterial||d instanceof THREE.MeshLambertMaterial||d instanceof THREE.ShaderMaterial||d.skinning)&&null!==k.viewMatrix&&x.uniformMatrix4fv(k.viewMatrix,!1,b.matrixWorldInverse.elements)}x.uniformMatrix4fv(k.modelViewMatrix,!1,f._modelViewMatrix.elements);k.normalMatrix&&x.uniformMatrix3fv(k.normalMatrix,!1,f._normalMatrix.elements);null!==k.modelMatrix&&x.uniformMatrix4fv(k.modelMatrix,
!1,f.matrixWorld.elements);return h}function O(){var b=T;b>=Vb&&console.warn("WebGLRenderer: trying to use "+b+" texture units while this GPU supports only "+Vb);T+=1;return b}function E(b,c,e,d){b[c]=e.r*e.r*d;b[c+1]=e.g*e.g*d;b[c+2]=e.b*e.b*d}function F(b,c,e,d){b[c]=e.r*d;b[c+1]=e.g*d;b[c+2]=e.b*d}function U(b){b!==eb&&(x.lineWidth(b),eb=b)}function H(b,c,e){Ra!==b&&(b?x.enable(x.POLYGON_OFFSET_FILL):x.disable(x.POLYGON_OFFSET_FILL),Ra=b);if(b&&(Ha!==c||sa!==e))x.polygonOffset(c,e),Ha=c,sa=e}function G(b){b=
b.split("\n");for(var c=0,e=b.length;c<e;c++)b[c]=c+1+": "+b[c];return b.join("\n")}function aa(b,c){var e;"fragment"===b?e=x.createShader(x.FRAGMENT_SHADER):"vertex"===b&&(e=x.createShader(x.VERTEX_SHADER));x.shaderSource(e,c);x.compileShader(e);return!x.getShaderParameter(e,x.COMPILE_STATUS)?(console.error(x.getShaderInfoLog(e)),console.error(G(c)),null):e}function D(b,c,e){e?(x.texParameteri(b,x.TEXTURE_WRAP_S,Q(c.wrapS)),x.texParameteri(b,x.TEXTURE_WRAP_T,Q(c.wrapT)),x.texParameteri(b,x.TEXTURE_MAG_FILTER,
Q(c.magFilter)),x.texParameteri(b,x.TEXTURE_MIN_FILTER,Q(c.minFilter))):(x.texParameteri(b,x.TEXTURE_WRAP_S,x.CLAMP_TO_EDGE),x.texParameteri(b,x.TEXTURE_WRAP_T,x.CLAMP_TO_EDGE),x.texParameteri(b,x.TEXTURE_MAG_FILTER,I(c.magFilter)),x.texParameteri(b,x.TEXTURE_MIN_FILTER,I(c.minFilter)));if(jb&&c.type!==THREE.FloatType&&(1<c.anisotropy||c.__oldAnisotropy))x.texParameterf(b,jb.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(c.anisotropy,yb)),c.__oldAnisotropy=c.anisotropy}function M(b,c){x.bindRenderbuffer(x.RENDERBUFFER,
b);c.depthBuffer&&!c.stencilBuffer?(x.renderbufferStorage(x.RENDERBUFFER,x.DEPTH_COMPONENT16,c.width,c.height),x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,b)):c.depthBuffer&&c.stencilBuffer?(x.renderbufferStorage(x.RENDERBUFFER,x.DEPTH_STENCIL,c.width,c.height),x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_STENCIL_ATTACHMENT,x.RENDERBUFFER,b)):x.renderbufferStorage(x.RENDERBUFFER,x.RGBA4,c.width,c.height)}function I(b){return b===THREE.NearestFilter||b===THREE.NearestMipMapNearestFilter||
b===THREE.NearestMipMapLinearFilter?x.NEAREST:x.LINEAR}function Q(b){if(b===THREE.RepeatWrapping)return x.REPEAT;if(b===THREE.ClampToEdgeWrapping)return x.CLAMP_TO_EDGE;if(b===THREE.MirroredRepeatWrapping)return x.MIRRORED_REPEAT;if(b===THREE.NearestFilter)return x.NEAREST;if(b===THREE.NearestMipMapNearestFilter)return x.NEAREST_MIPMAP_NEAREST;if(b===THREE.NearestMipMapLinearFilter)return x.NEAREST_MIPMAP_LINEAR;if(b===THREE.LinearFilter)return x.LINEAR;if(b===THREE.LinearMipMapNearestFilter)return x.LINEAR_MIPMAP_NEAREST;
if(b===THREE.LinearMipMapLinearFilter)return x.LINEAR_MIPMAP_LINEAR;if(b===THREE.UnsignedByteType)return x.UNSIGNED_BYTE;if(b===THREE.UnsignedShort4444Type)return x.UNSIGNED_SHORT_4_4_4_4;if(b===THREE.UnsignedShort5551Type)return x.UNSIGNED_SHORT_5_5_5_1;if(b===THREE.UnsignedShort565Type)return x.UNSIGNED_SHORT_5_6_5;if(b===THREE.ByteType)return x.BYTE;if(b===THREE.ShortType)return x.SHORT;if(b===THREE.UnsignedShortType)return x.UNSIGNED_SHORT;if(b===THREE.IntType)return x.INT;if(b===THREE.UnsignedIntType)return x.UNSIGNED_INT;
if(b===THREE.FloatType)return x.FLOAT;if(b===THREE.AlphaFormat)return x.ALPHA;if(b===THREE.RGBFormat)return x.RGB;if(b===THREE.RGBAFormat)return x.RGBA;if(b===THREE.LuminanceFormat)return x.LUMINANCE;if(b===THREE.LuminanceAlphaFormat)return x.LUMINANCE_ALPHA;if(b===THREE.AddEquation)return x.FUNC_ADD;if(b===THREE.SubtractEquation)return x.FUNC_SUBTRACT;if(b===THREE.ReverseSubtractEquation)return x.FUNC_REVERSE_SUBTRACT;if(b===THREE.ZeroFactor)return x.ZERO;if(b===THREE.OneFactor)return x.ONE;if(b===
THREE.SrcColorFactor)return x.SRC_COLOR;if(b===THREE.OneMinusSrcColorFactor)return x.ONE_MINUS_SRC_COLOR;if(b===THREE.SrcAlphaFactor)return x.SRC_ALPHA;if(b===THREE.OneMinusSrcAlphaFactor)return x.ONE_MINUS_SRC_ALPHA;if(b===THREE.DstAlphaFactor)return x.DST_ALPHA;if(b===THREE.OneMinusDstAlphaFactor)return x.ONE_MINUS_DST_ALPHA;if(b===THREE.DstColorFactor)return x.DST_COLOR;if(b===THREE.OneMinusDstColorFactor)return x.ONE_MINUS_DST_COLOR;if(b===THREE.SrcAlphaSaturateFactor)return x.SRC_ALPHA_SATURATE;
if(void 0!==Ab){if(b===THREE.RGB_S3TC_DXT1_Format)return Ab.COMPRESSED_RGB_S3TC_DXT1_EXT;if(b===THREE.RGBA_S3TC_DXT1_Format)return Ab.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(b===THREE.RGBA_S3TC_DXT3_Format)return Ab.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(b===THREE.RGBA_S3TC_DXT5_Format)return Ab.COMPRESSED_RGBA_S3TC_DXT5_EXT}return 0}console.log("THREE.WebGLRenderer",THREE.REVISION);b=b||{};var V=void 0!==b.canvas?b.canvas:document.createElement("canvas"),C=void 0!==b.precision?b.precision:"highp",Z=void 0!==
b.alpha?b.alpha:!0,N=void 0!==b.premultipliedAlpha?b.premultipliedAlpha:!0,ca=void 0!==b.antialias?b.antialias:!1,R=void 0!==b.stencil?b.stencil:!0,X=void 0!==b.preserveDrawingBuffer?b.preserveDrawingBuffer:!1,ba=new THREE.Color(0),na=0;void 0!==b.clearColor&&(console.warn("DEPRECATED: clearColor in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),ba.setHex(b.clearColor));void 0!==b.clearAlpha&&(console.warn("DEPRECATED: clearAlpha in WebGLRenderer constructor parameters is being removed. Use .setClearColor() instead."),
na=b.clearAlpha);this.domElement=V;this.context=null;this.devicePixelRatio=void 0!==b.devicePixelRatio?b.devicePixelRatio:void 0!==window.devicePixelRatio?window.devicePixelRatio:1;this.autoUpdateObjects=this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0;this.shadowMapEnabled=this.physicallyBasedShading=this.gammaOutput=this.gammaInput=!1;this.shadowMapAutoUpdate=!0;this.shadowMapType=THREE.PCFShadowMap;this.shadowMapCullFace=THREE.CullFaceFront;this.shadowMapCascade=
this.shadowMapDebug=!1;this.maxMorphTargets=8;this.maxMorphNormals=4;this.autoScaleCubemaps=!0;this.renderPluginsPre=[];this.renderPluginsPost=[];this.info={memory:{programs:0,geometries:0,textures:0},render:{calls:0,vertices:0,faces:0,points:0}};var S=this,$=[],ra=0,Y=null,ta=null,Na=-1,Qa=null,Oa=null,fa=0,T=0,ia=-1,ea=-1,xa=-1,Aa=-1,ya=-1,Ba=-1,Ua=-1,ha=-1,Ra=null,Ha=null,sa=null,eb=null,Xa=0,zb=0,Pa=0,va=0,db=0,Ib=0,Va={},Ta=new THREE.Frustum,Ka=new THREE.Matrix4,bb=new THREE.Matrix4,fb=new THREE.Vector3,
wa=new THREE.Vector3,oa=!0,Ia={ambient:[0,0,0],directional:{length:0,colors:[],positions:[]},point:{length:0,colors:[],positions:[],distances:[]},spot:{length:0,colors:[],positions:[],distances:[],directions:[],anglesCos:[],exponents:[]},hemi:{length:0,skyColors:[],groundColors:[],positions:[]}},x,cb,La,jb,Ab;try{if(!(x=V.getContext("experimental-webgl",{alpha:Z,premultipliedAlpha:N,antialias:ca,stencil:R,preserveDrawingBuffer:X})))throw"Error creating WebGL context.";}catch(ja){console.error(ja)}cb=
x.getExtension("OES_texture_float");La=x.getExtension("OES_standard_derivatives");jb=x.getExtension("EXT_texture_filter_anisotropic")||x.getExtension("MOZ_EXT_texture_filter_anisotropic")||x.getExtension("WEBKIT_EXT_texture_filter_anisotropic");Ab=x.getExtension("WEBGL_compressed_texture_s3tc")||x.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||x.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");cb||console.log("THREE.WebGLRenderer: Float textures not supported.");La||console.log("THREE.WebGLRenderer: Standard derivatives not supported.");
jb||console.log("THREE.WebGLRenderer: Anisotropic texture filtering not supported.");Ab||console.log("THREE.WebGLRenderer: S3TC compressed textures not supported.");void 0===x.getShaderPrecisionFormat&&(x.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}});x.clearColor(0,0,0,1);x.clearDepth(1);x.clearStencil(0);x.enable(x.DEPTH_TEST);x.depthFunc(x.LEQUAL);x.frontFace(x.CCW);x.cullFace(x.BACK);x.enable(x.CULL_FACE);x.enable(x.BLEND);x.blendEquation(x.FUNC_ADD);x.blendFunc(x.SRC_ALPHA,
x.ONE_MINUS_SRC_ALPHA);x.clearColor(ba.r,ba.g,ba.b,na);this.context=x;var Vb=x.getParameter(x.MAX_TEXTURE_IMAGE_UNITS),$a=x.getParameter(x.MAX_VERTEX_TEXTURE_IMAGE_UNITS);x.getParameter(x.MAX_TEXTURE_SIZE);var za=x.getParameter(x.MAX_CUBE_MAP_TEXTURE_SIZE),yb=jb?x.getParameter(jb.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0,gc=0<$a,Jb=gc&&cb;Ab&&x.getParameter(x.COMPRESSED_TEXTURE_FORMATS);var Fb=x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.HIGH_FLOAT),rc=x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.MEDIUM_FLOAT);
x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.LOW_FLOAT);var la=x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.HIGH_FLOAT),ob=x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.MEDIUM_FLOAT);x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.LOW_FLOAT);x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.HIGH_INT);x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.MEDIUM_INT);x.getShaderPrecisionFormat(x.VERTEX_SHADER,x.LOW_INT);x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.HIGH_INT);x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,
x.MEDIUM_INT);x.getShaderPrecisionFormat(x.FRAGMENT_SHADER,x.LOW_INT);var Bc=0<Fb.precision&&0<la.precision,hc=0<rc.precision&&0<ob.precision;"highp"===C&&!Bc&&(hc?(C="mediump",console.warn("WebGLRenderer: highp not supported, using mediump")):(C="lowp",console.warn("WebGLRenderer: highp and mediump not supported, using lowp")));"mediump"===C&&!hc&&(C="lowp",console.warn("WebGLRenderer: mediump not supported, using lowp"));this.getContext=function(){return x};this.supportsVertexTextures=function(){return gc};
this.supportsFloatTextures=function(){return cb};this.supportsStandardDerivatives=function(){return La};this.supportsCompressedTextureS3TC=function(){return Ab};this.getMaxAnisotropy=function(){return yb};this.getPrecision=function(){return C};this.setSize=function(b,c,e){V.width=b*this.devicePixelRatio;V.height=c*this.devicePixelRatio;1!==this.devicePixelRatio&&!1!==e&&(V.style.width=b+"px",V.style.height=c+"px");this.setViewport(0,0,V.width,V.height)};this.setViewport=function(b,c,e,d){Xa=void 0!==
b?b:0;zb=void 0!==c?c:0;Pa=void 0!==e?e:V.width;va=void 0!==d?d:V.height;x.viewport(Xa,zb,Pa,va)};this.setScissor=function(b,c,e,d){x.scissor(b,c,e,d)};this.enableScissorTest=function(b){b?x.enable(x.SCISSOR_TEST):x.disable(x.SCISSOR_TEST)};this.setClearColor=function(b,c){ba.set(b);na=void 0!==c?c:1;x.clearColor(ba.r,ba.g,ba.b,na)};this.setClearColorHex=function(b,c){console.warn("DEPRECATED: .setClearColorHex() is being removed. Use .setClearColor() instead.");this.setClearColor(b,c)};this.getClearColor=
function(){return ba};this.getClearAlpha=function(){return na};this.clear=function(b,c,e){var d=0;if(void 0===b||b)d|=x.COLOR_BUFFER_BIT;if(void 0===c||c)d|=x.DEPTH_BUFFER_BIT;if(void 0===e||e)d|=x.STENCIL_BUFFER_BIT;x.clear(d)};this.clearTarget=function(b,c,e,d){this.setRenderTarget(b);this.clear(c,e,d)};this.addPostPlugin=function(b){b.init(this);this.renderPluginsPost.push(b)};this.addPrePlugin=function(b){b.init(this);this.renderPluginsPre.push(b)};this.updateShadowMap=function(b,c){Y=null;Na=
Qa=ha=Ua=xa=-1;oa=!0;ea=ia=-1;this.shadowMapPlugin.update(b,c)};var Gc=function(b){b=b.target;b.removeEventListener("dispose",Gc);b.__webglInit=void 0;void 0!==b.__webglVertexBuffer&&x.deleteBuffer(b.__webglVertexBuffer);void 0!==b.__webglNormalBuffer&&x.deleteBuffer(b.__webglNormalBuffer);void 0!==b.__webglTangentBuffer&&x.deleteBuffer(b.__webglTangentBuffer);void 0!==b.__webglColorBuffer&&x.deleteBuffer(b.__webglColorBuffer);void 0!==b.__webglUVBuffer&&x.deleteBuffer(b.__webglUVBuffer);void 0!==
b.__webglUV2Buffer&&x.deleteBuffer(b.__webglUV2Buffer);void 0!==b.__webglSkinIndicesBuffer&&x.deleteBuffer(b.__webglSkinIndicesBuffer);void 0!==b.__webglSkinWeightsBuffer&&x.deleteBuffer(b.__webglSkinWeightsBuffer);void 0!==b.__webglFaceBuffer&&x.deleteBuffer(b.__webglFaceBuffer);void 0!==b.__webglLineBuffer&&x.deleteBuffer(b.__webglLineBuffer);void 0!==b.__webglLineDistanceBuffer&&x.deleteBuffer(b.__webglLineDistanceBuffer);if(void 0!==b.geometryGroups)for(var c in b.geometryGroups){var e=b.geometryGroups[c];
if(void 0!==e.numMorphTargets)for(var f=0,g=e.numMorphTargets;f<g;f++)x.deleteBuffer(e.__webglMorphTargetsBuffers[f]);if(void 0!==e.numMorphNormals){f=0;for(g=e.numMorphNormals;f<g;f++)x.deleteBuffer(e.__webglMorphNormalsBuffers[f])}d(e)}d(b);S.info.memory.geometries--},sc=function(b){b=b.target;b.removeEventListener("dispose",sc);b.image&&b.image.__webglTextureCube?x.deleteTexture(b.image.__webglTextureCube):b.__webglInit&&(b.__webglInit=!1,x.deleteTexture(b.__webglTexture));S.info.memory.textures--},
oc=function(b){b=b.target;b.removeEventListener("dispose",oc);if(b&&b.__webglTexture)if(x.deleteTexture(b.__webglTexture),b instanceof THREE.WebGLRenderTargetCube)for(var c=0;6>c;c++)x.deleteFramebuffer(b.__webglFramebuffer[c]),x.deleteRenderbuffer(b.__webglRenderbuffer[c]);else x.deleteFramebuffer(b.__webglFramebuffer),x.deleteRenderbuffer(b.__webglRenderbuffer);S.info.memory.textures--},ga=function(b){b=b.target;b.removeEventListener("dispose",ga);Hc(b)},Hc=function(b){var c=b.program;if(void 0!==
c){b.program=void 0;var e,d,f=!1;b=0;for(e=$.length;b<e;b++)if(d=$[b],d.program===c){d.usedTimes--;0===d.usedTimes&&(f=!0);break}if(!0===f){f=[];b=0;for(e=$.length;b<e;b++)d=$[b],d.program!==c&&f.push(d);$=f;x.deleteProgram(c);S.info.memory.programs--}}};this.renderBufferImmediate=function(b,c,e){b.hasPositions&&!b.__webglVertexBuffer&&(b.__webglVertexBuffer=x.createBuffer());b.hasNormals&&!b.__webglNormalBuffer&&(b.__webglNormalBuffer=x.createBuffer());b.hasUvs&&!b.__webglUvBuffer&&(b.__webglUvBuffer=
x.createBuffer());b.hasColors&&!b.__webglColorBuffer&&(b.__webglColorBuffer=x.createBuffer());b.hasPositions&&(x.bindBuffer(x.ARRAY_BUFFER,b.__webglVertexBuffer),x.bufferData(x.ARRAY_BUFFER,b.positionArray,x.DYNAMIC_DRAW),x.enableVertexAttribArray(c.attributes.position),x.vertexAttribPointer(c.attributes.position,3,x.FLOAT,!1,0,0));if(b.hasNormals){x.bindBuffer(x.ARRAY_BUFFER,b.__webglNormalBuffer);if(e.shading===THREE.FlatShading){var d,f,g,h,k,l,p,q,r,s,t,u=3*b.count;for(t=0;t<u;t+=9)s=b.normalArray,
d=s[t],f=s[t+1],g=s[t+2],h=s[t+3],l=s[t+4],q=s[t+5],k=s[t+6],p=s[t+7],r=s[t+8],d=(d+h+k)/3,f=(f+l+p)/3,g=(g+q+r)/3,s[t]=d,s[t+1]=f,s[t+2]=g,s[t+3]=d,s[t+4]=f,s[t+5]=g,s[t+6]=d,s[t+7]=f,s[t+8]=g}x.bufferData(x.ARRAY_BUFFER,b.normalArray,x.DYNAMIC_DRAW);x.enableVertexAttribArray(c.attributes.normal);x.vertexAttribPointer(c.attributes.normal,3,x.FLOAT,!1,0,0)}b.hasUvs&&e.map&&(x.bindBuffer(x.ARRAY_BUFFER,b.__webglUvBuffer),x.bufferData(x.ARRAY_BUFFER,b.uvArray,x.DYNAMIC_DRAW),x.enableVertexAttribArray(c.attributes.uv),
x.vertexAttribPointer(c.attributes.uv,2,x.FLOAT,!1,0,0));b.hasColors&&e.vertexColors!==THREE.NoColors&&(x.bindBuffer(x.ARRAY_BUFFER,b.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,b.colorArray,x.DYNAMIC_DRAW),x.enableVertexAttribArray(c.attributes.color),x.vertexAttribPointer(c.attributes.color,3,x.FLOAT,!1,0,0));x.drawArrays(x.TRIANGLES,0,b.count);b.count=0};this.renderBufferDirect=function(b,c,e,d,f,g){if(!1!==d.visible){var h,p,q;h=K(b,c,e,d,g);b=h.attributes;c=f.attributes;e=!1;h=16777215*f.id+
2*h.id+(d.wireframe?1:0);h!==Qa&&(Qa=h,e=!0);e&&l();if(g instanceof THREE.Mesh)if(d=c.index){f=f.offsets;1<f.length&&(e=!0);for(var r=0,s=f.length;r<s;r++){var t=f[r].index;if(e){for(p in c)"index"!==p&&(h=b[p],g=c[p],q=g.itemSize,0<=h&&(x.bindBuffer(x.ARRAY_BUFFER,g.buffer),k(h),x.vertexAttribPointer(h,q,x.FLOAT,!1,0,4*t*q)));x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,d.buffer)}x.drawElements(x.TRIANGLES,f[r].count,x.UNSIGNED_SHORT,2*f[r].start);S.info.render.calls++;S.info.render.vertices+=f[r].count;
S.info.render.faces+=f[r].count/3}}else{if(e)for(p in c)"index"!==p&&(h=b[p],g=c[p],q=g.itemSize,0<=h&&(x.bindBuffer(x.ARRAY_BUFFER,g.buffer),k(h),x.vertexAttribPointer(h,q,x.FLOAT,!1,0,0)));p=f.attributes.position;x.drawArrays(x.TRIANGLES,0,p.numItems/3);S.info.render.calls++;S.info.render.vertices+=p.numItems/3;S.info.render.faces+=p.numItems/3/3}else if(g instanceof THREE.ParticleSystem){if(e){for(p in c)h=b[p],g=c[p],q=g.itemSize,0<=h&&(x.bindBuffer(x.ARRAY_BUFFER,g.buffer),k(h),x.vertexAttribPointer(h,
q,x.FLOAT,!1,0,0));p=c.position;x.drawArrays(x.POINTS,0,p.numItems/3);S.info.render.calls++;S.info.render.points+=p.numItems/3}}else if(g instanceof THREE.Line&&e){for(p in c)h=b[p],g=c[p],q=g.itemSize,0<=h&&(x.bindBuffer(x.ARRAY_BUFFER,g.buffer),k(h),x.vertexAttribPointer(h,q,x.FLOAT,!1,0,0));U(d.linewidth);p=c.position;x.drawArrays(x.LINE_STRIP,0,p.numItems/3);S.info.render.calls++;S.info.render.points+=p.numItems}}};this.renderBuffer=function(b,c,e,d,f,g){if(!1!==d.visible){var h,p;e=K(b,c,e,d,
g);b=e.attributes;c=!1;e=16777215*f.id+2*e.id+(d.wireframe?1:0);e!==Qa&&(Qa=e,c=!0);c&&l();if(!d.morphTargets&&0<=b.position)c&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglVertexBuffer),k(b.position),x.vertexAttribPointer(b.position,3,x.FLOAT,!1,0,0));else if(g.morphTargetBase){e=d.program.attributes;-1!==g.morphTargetBase&&0<=e.position?(x.bindBuffer(x.ARRAY_BUFFER,f.__webglMorphTargetsBuffers[g.morphTargetBase]),k(e.position),x.vertexAttribPointer(e.position,3,x.FLOAT,!1,0,0)):0<=e.position&&(x.bindBuffer(x.ARRAY_BUFFER,
f.__webglVertexBuffer),k(e.position),x.vertexAttribPointer(e.position,3,x.FLOAT,!1,0,0));if(g.morphTargetForcedOrder.length){var r=0;p=g.morphTargetForcedOrder;for(h=g.morphTargetInfluences;r<d.numSupportedMorphTargets&&r<p.length;)0<=e["morphTarget"+r]&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglMorphTargetsBuffers[p[r]]),k(e["morphTarget"+r]),x.vertexAttribPointer(e["morphTarget"+r],3,x.FLOAT,!1,0,0)),0<=e["morphNormal"+r]&&d.morphNormals&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglMorphNormalsBuffers[p[r]]),
k(e["morphNormal"+r]),x.vertexAttribPointer(e["morphNormal"+r],3,x.FLOAT,!1,0,0)),g.__webglMorphTargetInfluences[r]=h[p[r]],r++}else{p=[];h=g.morphTargetInfluences;var s,t=h.length;for(s=0;s<t;s++)r=h[s],0<r&&p.push([r,s]);p.length>d.numSupportedMorphTargets?(p.sort(q),p.length=d.numSupportedMorphTargets):p.length>d.numSupportedMorphNormals?p.sort(q):0===p.length&&p.push([0,0]);for(r=0;r<d.numSupportedMorphTargets;)p[r]?(s=p[r][1],0<=e["morphTarget"+r]&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglMorphTargetsBuffers[s]),
k(e["morphTarget"+r]),x.vertexAttribPointer(e["morphTarget"+r],3,x.FLOAT,!1,0,0)),0<=e["morphNormal"+r]&&d.morphNormals&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglMorphNormalsBuffers[s]),k(e["morphNormal"+r]),x.vertexAttribPointer(e["morphNormal"+r],3,x.FLOAT,!1,0,0)),g.__webglMorphTargetInfluences[r]=h[s]):g.__webglMorphTargetInfluences[r]=0,r++}null!==d.program.uniforms.morphTargetInfluences&&x.uniform1fv(d.program.uniforms.morphTargetInfluences,g.__webglMorphTargetInfluences)}if(c){if(f.__webglCustomAttributesList){h=
0;for(p=f.__webglCustomAttributesList.length;h<p;h++)e=f.__webglCustomAttributesList[h],0<=b[e.buffer.belongsToAttribute]&&(x.bindBuffer(x.ARRAY_BUFFER,e.buffer),k(b[e.buffer.belongsToAttribute]),x.vertexAttribPointer(b[e.buffer.belongsToAttribute],e.size,x.FLOAT,!1,0,0))}0<=b.color&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglColorBuffer),k(b.color),x.vertexAttribPointer(b.color,3,x.FLOAT,!1,0,0));0<=b.normal&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglNormalBuffer),k(b.normal),x.vertexAttribPointer(b.normal,
3,x.FLOAT,!1,0,0));0<=b.tangent&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglTangentBuffer),k(b.tangent),x.vertexAttribPointer(b.tangent,4,x.FLOAT,!1,0,0));0<=b.uv&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglUVBuffer),k(b.uv),x.vertexAttribPointer(b.uv,2,x.FLOAT,!1,0,0));0<=b.uv2&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglUV2Buffer),k(b.uv2),x.vertexAttribPointer(b.uv2,2,x.FLOAT,!1,0,0));d.skinning&&0<=b.skinIndex&&0<=b.skinWeight&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglSkinIndicesBuffer),k(b.skinIndex),x.vertexAttribPointer(b.skinIndex,
4,x.FLOAT,!1,0,0),x.bindBuffer(x.ARRAY_BUFFER,f.__webglSkinWeightsBuffer),k(b.skinWeight),x.vertexAttribPointer(b.skinWeight,4,x.FLOAT,!1,0,0));0<=b.lineDistance&&(x.bindBuffer(x.ARRAY_BUFFER,f.__webglLineDistanceBuffer),k(b.lineDistance),x.vertexAttribPointer(b.lineDistance,1,x.FLOAT,!1,0,0))}g instanceof THREE.Mesh?(d.wireframe?(U(d.wireframeLinewidth),c&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,f.__webglLineBuffer),x.drawElements(x.LINES,f.__webglLineCount,x.UNSIGNED_SHORT,0)):(c&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,
f.__webglFaceBuffer),x.drawElements(x.TRIANGLES,f.__webglFaceCount,x.UNSIGNED_SHORT,0)),S.info.render.calls++,S.info.render.vertices+=f.__webglFaceCount,S.info.render.faces+=f.__webglFaceCount/3):g instanceof THREE.Line?(g=g.type===THREE.LineStrip?x.LINE_STRIP:x.LINES,U(d.linewidth),x.drawArrays(g,0,f.__webglLineCount),S.info.render.calls++):g instanceof THREE.ParticleSystem?(x.drawArrays(x.POINTS,0,f.__webglParticleCount),S.info.render.calls++,S.info.render.points+=f.__webglParticleCount):g instanceof
THREE.Ribbon&&(x.drawArrays(x.TRIANGLE_STRIP,0,f.__webglVertexCount),S.info.render.calls++)}};this.render=function(b,c,e,d){if(!1===c instanceof THREE.Camera)console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");else{var f,g,h,k,l=b.__lights,q=b.fog;Na=-1;oa=!0;!0===b.autoUpdate&&b.updateMatrixWorld();void 0===c.parent&&c.updateMatrixWorld();c.matrixWorldInverse.getInverse(c.matrixWorld);Ka.multiplyMatrices(c.projectionMatrix,c.matrixWorldInverse);Ta.setFromMatrix(Ka);
this.autoUpdateObjects&&this.initWebGLObjects(b);r(this.renderPluginsPre,b,c);S.info.render.calls=0;S.info.render.vertices=0;S.info.render.faces=0;S.info.render.points=0;this.setRenderTarget(e);(this.autoClear||d)&&this.clear(this.autoClearColor,this.autoClearDepth,this.autoClearStencil);k=b.__webglObjects;d=0;for(f=k.length;d<f;d++)if(g=k[d],h=g.object,g.id=d,g.render=!1,h.visible&&(!(h instanceof THREE.Mesh||h instanceof THREE.ParticleSystem)||!h.frustumCulled||Ta.intersectsObject(h))){var u=h;
u._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,u.matrixWorld);u._normalMatrix.getNormalMatrix(u._modelViewMatrix);var u=g,v=u.buffer,w=void 0,y=void 0,y=u.object.material;if(y instanceof THREE.MeshFaceMaterial)w=v.materialIndex,w=y.materials[w],w.transparent?(u.transparent=w,u.opaque=null):(u.opaque=w,u.transparent=null);else if(w=y)w.transparent?(u.transparent=w,u.opaque=null):(u.opaque=w,u.transparent=null);g.render=!0;!0===this.sortObjects&&(null!==h.renderDepth?g.z=h.renderDepth:(fb.getPositionFromMatrix(h.matrixWorld),
fb.applyProjection(Ka),g.z=fb.z))}this.sortObjects&&k.sort(p);k=b.__webglObjectsImmediate;d=0;for(f=k.length;d<f;d++)g=k[d],h=g.object,h.visible&&(h._modelViewMatrix.multiplyMatrices(c.matrixWorldInverse,h.matrixWorld),h._normalMatrix.getNormalMatrix(h._modelViewMatrix),h=g.object.material,h.transparent?(g.transparent=h,g.opaque=null):(g.opaque=h,g.transparent=null));b.overrideMaterial?(d=b.overrideMaterial,this.setBlending(d.blending,d.blendEquation,d.blendSrc,d.blendDst),this.setDepthTest(d.depthTest),
this.setDepthWrite(d.depthWrite),H(d.polygonOffset,d.polygonOffsetFactor,d.polygonOffsetUnits),s(b.__webglObjects,!1,"",c,l,q,!0,d),t(b.__webglObjectsImmediate,"",c,l,q,!1,d)):(d=null,this.setBlending(THREE.NoBlending),s(b.__webglObjects,!0,"opaque",c,l,q,!1,d),t(b.__webglObjectsImmediate,"opaque",c,l,q,!1,d),s(b.__webglObjects,!1,"transparent",c,l,q,!0,d),t(b.__webglObjectsImmediate,"transparent",c,l,q,!0,d));r(this.renderPluginsPost,b,c);e&&e.generateMipmaps&&(e.minFilter!==THREE.NearestFilter&&
e.minFilter!==THREE.LinearFilter)&&(e instanceof THREE.WebGLRenderTargetCube?(x.bindTexture(x.TEXTURE_CUBE_MAP,e.__webglTexture),x.generateMipmap(x.TEXTURE_CUBE_MAP),x.bindTexture(x.TEXTURE_CUBE_MAP,null)):(x.bindTexture(x.TEXTURE_2D,e.__webglTexture),x.generateMipmap(x.TEXTURE_2D),x.bindTexture(x.TEXTURE_2D,null)));this.setDepthTest(!0);this.setDepthWrite(!0)}};this.renderImmediateObject=function(b,c,e,d,f){var g=K(b,c,e,d,f);Qa=-1;S.setMaterialFaces(d);f.immediateRenderCallback?f.immediateRenderCallback(g,
x,Ta):f.render(function(b){S.renderBufferImmediate(b,g,d)})};this.initWebGLObjects=function(b){for(b.__webglObjects||(b.__webglObjects=[],b.__webglObjectsImmediate=[],b.__webglSprites=[],b.__webglFlares=[]);b.__objectsAdded.length;)u(b.__objectsAdded[0],b),b.__objectsAdded.splice(0,1);for(;b.__objectsRemoved.length;)z(b.__objectsRemoved[0],b),b.__objectsRemoved.splice(0,1);for(var c=0,d=b.__webglObjects.length;c<d;c++){var k=b.__webglObjects[c].object;void 0===k.__webglInit&&(void 0!==k.__webglActive&&
z(k,b),u(k,b));var l=k,p=l.geometry,r=void 0,s=void 0,t=void 0;if(p instanceof THREE.BufferGeometry){var v=x.DYNAMIC_DRAW,A=!p.dynamic,B=p.attributes,E=void 0,S=void 0;for(E in B)S=B[E],S.needsUpdate&&("index"===E?(x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,S.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,S.array,v)):(x.bindBuffer(x.ARRAY_BUFFER,S.buffer),x.bufferData(x.ARRAY_BUFFER,S.array,v)),S.needsUpdate=!1),A&&!S.dynamic&&delete S.array}else if(l instanceof THREE.Mesh){for(var O=0,U=p.geometryGroupsList.length;O<
U;O++)if(r=p.geometryGroupsList[O],t=f(l,r),p.buffersNeedUpdate&&e(r,l),s=t.attributes&&w(t),p.verticesNeedUpdate||p.morphTargetsNeedUpdate||p.elementsNeedUpdate||p.uvsNeedUpdate||p.normalsNeedUpdate||p.colorsNeedUpdate||p.tangentsNeedUpdate||s){var G=r,D=l,aa=x.DYNAMIC_DRAW,qa=!p.dynamic,da=t;if(G.__inittedArrays){var Yd=g(da),K=da.vertexColors?da.vertexColors:!1,F=h(da),Od=Yd===THREE.SmoothShading,W=void 0,H=void 0,ba=void 0,$=void 0,Na=void 0,na=void 0,ta=void 0,M=void 0,ra=void 0,Q=void 0,X=void 0,
I=void 0,C=void 0,Y=void 0,T=void 0,N=void 0,Qa=void 0,V=void 0,R=void 0,fa=void 0,Oa=void 0,La=void 0,cb=void 0,ea=void 0,Z=void 0,ia=void 0,jb=void 0,ca=void 0,ja=void 0,xa=void 0,ya=void 0,Aa=void 0,ha=void 0,la=void 0,oa=void 0,ga=void 0,Ab=void 0,va=void 0,za=void 0,Ha=void 0,sa=void 0,Pa=void 0,Ba=void 0,wa=void 0,Ua=void 0,Ta=void 0,Ia=0,Ra=0,db=0,eb=0,$a=0,Va=0,sb=0,Xa=0,tb=0,Ca=0,Sa=0,L=0,pa=void 0,Cb=G.__vertexArray,zb=G.__uvArray,Vb=G.__uv2Array,qb=G.__normalArray,pb=G.__tangentArray,vb=
G.__colorArray,ib=G.__skinIndexArray,wb=G.__skinWeightArray,Fb=G.__morphTargetsArrays,Ib=G.__morphNormalsArrays,Jb=G.__webglCustomAttributesList,J=void 0,yb=G.__faceArray,ob=G.__lineArray,Sb=D.geometry,hc=Sb.elementsNeedUpdate,gc=Sb.uvsNeedUpdate,oc=Sb.normalsNeedUpdate,sc=Sb.tangentsNeedUpdate,ic=Sb.colorsNeedUpdate,Bc=Sb.morphTargetsNeedUpdate,dc=Sb.vertices,kb=G.faces3,Ya=G.faces4,Mb=Sb.faces,Gc=Sb.faceVertexUvs[0],Hc=Sb.faceVertexUvs[1],rc=Sb.skinIndices,ub=Sb.skinWeights,Nb=Sb.morphTargets,Cd=
Sb.morphNormals;if(Sb.verticesNeedUpdate){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],I=dc[$.a],C=dc[$.b],Y=dc[$.c],Cb[Ra]=I.x,Cb[Ra+1]=I.y,Cb[Ra+2]=I.z,Cb[Ra+3]=C.x,Cb[Ra+4]=C.y,Cb[Ra+5]=C.z,Cb[Ra+6]=Y.x,Cb[Ra+7]=Y.y,Cb[Ra+8]=Y.z,Ra+=9;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],I=dc[$.a],C=dc[$.b],Y=dc[$.c],T=dc[$.d],Cb[Ra]=I.x,Cb[Ra+1]=I.y,Cb[Ra+2]=I.z,Cb[Ra+3]=C.x,Cb[Ra+4]=C.y,Cb[Ra+5]=C.z,Cb[Ra+6]=Y.x,Cb[Ra+7]=Y.y,Cb[Ra+8]=Y.z,Cb[Ra+9]=T.x,Cb[Ra+10]=T.y,Cb[Ra+11]=T.z,Ra+=12;x.bindBuffer(x.ARRAY_BUFFER,
G.__webglVertexBuffer);x.bufferData(x.ARRAY_BUFFER,Cb,aa)}if(Bc){sa=0;for(Pa=Nb.length;sa<Pa;sa++){W=Sa=0;for(H=kb.length;W<H;W++)Ua=kb[W],$=Mb[Ua],I=Nb[sa].vertices[$.a],C=Nb[sa].vertices[$.b],Y=Nb[sa].vertices[$.c],Ba=Fb[sa],Ba[Sa]=I.x,Ba[Sa+1]=I.y,Ba[Sa+2]=I.z,Ba[Sa+3]=C.x,Ba[Sa+4]=C.y,Ba[Sa+5]=C.z,Ba[Sa+6]=Y.x,Ba[Sa+7]=Y.y,Ba[Sa+8]=Y.z,da.morphNormals&&(Od?(Ta=Cd[sa].vertexNormals[Ua],fa=Ta.a,Oa=Ta.b,La=Ta.c):La=Oa=fa=Cd[sa].faceNormals[Ua],wa=Ib[sa],wa[Sa]=fa.x,wa[Sa+1]=fa.y,wa[Sa+2]=fa.z,wa[Sa+
3]=Oa.x,wa[Sa+4]=Oa.y,wa[Sa+5]=Oa.z,wa[Sa+6]=La.x,wa[Sa+7]=La.y,wa[Sa+8]=La.z),Sa+=9;W=0;for(H=Ya.length;W<H;W++)Ua=Ya[W],$=Mb[Ua],I=Nb[sa].vertices[$.a],C=Nb[sa].vertices[$.b],Y=Nb[sa].vertices[$.c],T=Nb[sa].vertices[$.d],Ba=Fb[sa],Ba[Sa]=I.x,Ba[Sa+1]=I.y,Ba[Sa+2]=I.z,Ba[Sa+3]=C.x,Ba[Sa+4]=C.y,Ba[Sa+5]=C.z,Ba[Sa+6]=Y.x,Ba[Sa+7]=Y.y,Ba[Sa+8]=Y.z,Ba[Sa+9]=T.x,Ba[Sa+10]=T.y,Ba[Sa+11]=T.z,da.morphNormals&&(Od?(Ta=Cd[sa].vertexNormals[Ua],fa=Ta.a,Oa=Ta.b,La=Ta.c,cb=Ta.d):cb=La=Oa=fa=Cd[sa].faceNormals[Ua],
wa=Ib[sa],wa[Sa]=fa.x,wa[Sa+1]=fa.y,wa[Sa+2]=fa.z,wa[Sa+3]=Oa.x,wa[Sa+4]=Oa.y,wa[Sa+5]=Oa.z,wa[Sa+6]=La.x,wa[Sa+7]=La.y,wa[Sa+8]=La.z,wa[Sa+9]=cb.x,wa[Sa+10]=cb.y,wa[Sa+11]=cb.z),Sa+=12;x.bindBuffer(x.ARRAY_BUFFER,G.__webglMorphTargetsBuffers[sa]);x.bufferData(x.ARRAY_BUFFER,Fb[sa],aa);da.morphNormals&&(x.bindBuffer(x.ARRAY_BUFFER,G.__webglMorphNormalsBuffers[sa]),x.bufferData(x.ARRAY_BUFFER,Ib[sa],aa))}}if(ub.length){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],ca=ub[$.a],ja=ub[$.b],xa=ub[$.c],wb[Ca]=
ca.x,wb[Ca+1]=ca.y,wb[Ca+2]=ca.z,wb[Ca+3]=ca.w,wb[Ca+4]=ja.x,wb[Ca+5]=ja.y,wb[Ca+6]=ja.z,wb[Ca+7]=ja.w,wb[Ca+8]=xa.x,wb[Ca+9]=xa.y,wb[Ca+10]=xa.z,wb[Ca+11]=xa.w,Aa=rc[$.a],ha=rc[$.b],la=rc[$.c],ib[Ca]=Aa.x,ib[Ca+1]=Aa.y,ib[Ca+2]=Aa.z,ib[Ca+3]=Aa.w,ib[Ca+4]=ha.x,ib[Ca+5]=ha.y,ib[Ca+6]=ha.z,ib[Ca+7]=ha.w,ib[Ca+8]=la.x,ib[Ca+9]=la.y,ib[Ca+10]=la.z,ib[Ca+11]=la.w,Ca+=12;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],ca=ub[$.a],ja=ub[$.b],xa=ub[$.c],ya=ub[$.d],wb[Ca]=ca.x,wb[Ca+1]=ca.y,wb[Ca+2]=ca.z,wb[Ca+3]=
ca.w,wb[Ca+4]=ja.x,wb[Ca+5]=ja.y,wb[Ca+6]=ja.z,wb[Ca+7]=ja.w,wb[Ca+8]=xa.x,wb[Ca+9]=xa.y,wb[Ca+10]=xa.z,wb[Ca+11]=xa.w,wb[Ca+12]=ya.x,wb[Ca+13]=ya.y,wb[Ca+14]=ya.z,wb[Ca+15]=ya.w,Aa=rc[$.a],ha=rc[$.b],la=rc[$.c],oa=rc[$.d],ib[Ca]=Aa.x,ib[Ca+1]=Aa.y,ib[Ca+2]=Aa.z,ib[Ca+3]=Aa.w,ib[Ca+4]=ha.x,ib[Ca+5]=ha.y,ib[Ca+6]=ha.z,ib[Ca+7]=ha.w,ib[Ca+8]=la.x,ib[Ca+9]=la.y,ib[Ca+10]=la.z,ib[Ca+11]=la.w,ib[Ca+12]=oa.x,ib[Ca+13]=oa.y,ib[Ca+14]=oa.z,ib[Ca+15]=oa.w,Ca+=16;0<Ca&&(x.bindBuffer(x.ARRAY_BUFFER,G.__webglSkinIndicesBuffer),
x.bufferData(x.ARRAY_BUFFER,ib,aa),x.bindBuffer(x.ARRAY_BUFFER,G.__webglSkinWeightsBuffer),x.bufferData(x.ARRAY_BUFFER,wb,aa))}if(ic&&K){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],ta=$.vertexColors,M=$.color,3===ta.length&&K===THREE.VertexColors?(ea=ta[0],Z=ta[1],ia=ta[2]):ia=Z=ea=M,vb[tb]=ea.r,vb[tb+1]=ea.g,vb[tb+2]=ea.b,vb[tb+3]=Z.r,vb[tb+4]=Z.g,vb[tb+5]=Z.b,vb[tb+6]=ia.r,vb[tb+7]=ia.g,vb[tb+8]=ia.b,tb+=9;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],ta=$.vertexColors,M=$.color,4===ta.length&&K===THREE.VertexColors?
(ea=ta[0],Z=ta[1],ia=ta[2],jb=ta[3]):jb=ia=Z=ea=M,vb[tb]=ea.r,vb[tb+1]=ea.g,vb[tb+2]=ea.b,vb[tb+3]=Z.r,vb[tb+4]=Z.g,vb[tb+5]=Z.b,vb[tb+6]=ia.r,vb[tb+7]=ia.g,vb[tb+8]=ia.b,vb[tb+9]=jb.r,vb[tb+10]=jb.g,vb[tb+11]=jb.b,tb+=12;0<tb&&(x.bindBuffer(x.ARRAY_BUFFER,G.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,vb,aa))}if(sc&&Sb.hasTangents){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],ra=$.vertexTangents,N=ra[0],Qa=ra[1],V=ra[2],pb[sb]=N.x,pb[sb+1]=N.y,pb[sb+2]=N.z,pb[sb+3]=N.w,pb[sb+4]=Qa.x,pb[sb+5]=Qa.y,
pb[sb+6]=Qa.z,pb[sb+7]=Qa.w,pb[sb+8]=V.x,pb[sb+9]=V.y,pb[sb+10]=V.z,pb[sb+11]=V.w,sb+=12;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],ra=$.vertexTangents,N=ra[0],Qa=ra[1],V=ra[2],R=ra[3],pb[sb]=N.x,pb[sb+1]=N.y,pb[sb+2]=N.z,pb[sb+3]=N.w,pb[sb+4]=Qa.x,pb[sb+5]=Qa.y,pb[sb+6]=Qa.z,pb[sb+7]=Qa.w,pb[sb+8]=V.x,pb[sb+9]=V.y,pb[sb+10]=V.z,pb[sb+11]=V.w,pb[sb+12]=R.x,pb[sb+13]=R.y,pb[sb+14]=R.z,pb[sb+15]=R.w,sb+=16;x.bindBuffer(x.ARRAY_BUFFER,G.__webglTangentBuffer);x.bufferData(x.ARRAY_BUFFER,pb,aa)}if(oc&&Yd){W=
0;for(H=kb.length;W<H;W++)if($=Mb[kb[W]],Na=$.vertexNormals,na=$.normal,3===Na.length&&Od)for(ga=0;3>ga;ga++)va=Na[ga],qb[Va]=va.x,qb[Va+1]=va.y,qb[Va+2]=va.z,Va+=3;else for(ga=0;3>ga;ga++)qb[Va]=na.x,qb[Va+1]=na.y,qb[Va+2]=na.z,Va+=3;W=0;for(H=Ya.length;W<H;W++)if($=Mb[Ya[W]],Na=$.vertexNormals,na=$.normal,4===Na.length&&Od)for(ga=0;4>ga;ga++)va=Na[ga],qb[Va]=va.x,qb[Va+1]=va.y,qb[Va+2]=va.z,Va+=3;else for(ga=0;4>ga;ga++)qb[Va]=na.x,qb[Va+1]=na.y,qb[Va+2]=na.z,Va+=3;x.bindBuffer(x.ARRAY_BUFFER,G.__webglNormalBuffer);
x.bufferData(x.ARRAY_BUFFER,qb,aa)}if(gc&&Gc&&F){W=0;for(H=kb.length;W<H;W++)if(ba=kb[W],Q=Gc[ba],void 0!==Q)for(ga=0;3>ga;ga++)za=Q[ga],zb[db]=za.x,zb[db+1]=za.y,db+=2;W=0;for(H=Ya.length;W<H;W++)if(ba=Ya[W],Q=Gc[ba],void 0!==Q)for(ga=0;4>ga;ga++)za=Q[ga],zb[db]=za.x,zb[db+1]=za.y,db+=2;0<db&&(x.bindBuffer(x.ARRAY_BUFFER,G.__webglUVBuffer),x.bufferData(x.ARRAY_BUFFER,zb,aa))}if(gc&&Hc&&F){W=0;for(H=kb.length;W<H;W++)if(ba=kb[W],X=Hc[ba],void 0!==X)for(ga=0;3>ga;ga++)Ha=X[ga],Vb[eb]=Ha.x,Vb[eb+1]=
Ha.y,eb+=2;W=0;for(H=Ya.length;W<H;W++)if(ba=Ya[W],X=Hc[ba],void 0!==X)for(ga=0;4>ga;ga++)Ha=X[ga],Vb[eb]=Ha.x,Vb[eb+1]=Ha.y,eb+=2;0<eb&&(x.bindBuffer(x.ARRAY_BUFFER,G.__webglUV2Buffer),x.bufferData(x.ARRAY_BUFFER,Vb,aa))}if(hc){W=0;for(H=kb.length;W<H;W++)yb[$a]=Ia,yb[$a+1]=Ia+1,yb[$a+2]=Ia+2,$a+=3,ob[Xa]=Ia,ob[Xa+1]=Ia+1,ob[Xa+2]=Ia,ob[Xa+3]=Ia+2,ob[Xa+4]=Ia+1,ob[Xa+5]=Ia+2,Xa+=6,Ia+=3;W=0;for(H=Ya.length;W<H;W++)yb[$a]=Ia,yb[$a+1]=Ia+1,yb[$a+2]=Ia+3,yb[$a+3]=Ia+1,yb[$a+4]=Ia+2,yb[$a+5]=Ia+3,$a+=
6,ob[Xa]=Ia,ob[Xa+1]=Ia+1,ob[Xa+2]=Ia,ob[Xa+3]=Ia+3,ob[Xa+4]=Ia+1,ob[Xa+5]=Ia+2,ob[Xa+6]=Ia+2,ob[Xa+7]=Ia+3,Xa+=8,Ia+=4;x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,G.__webglFaceBuffer);x.bufferData(x.ELEMENT_ARRAY_BUFFER,yb,aa);x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,G.__webglLineBuffer);x.bufferData(x.ELEMENT_ARRAY_BUFFER,ob,aa)}if(Jb){ga=0;for(Ab=Jb.length;ga<Ab;ga++)if(J=Jb[ga],J.__original.needsUpdate){L=0;if(1===J.size)if(void 0===J.boundTo||"vertices"===J.boundTo){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],
J.array[L]=J.value[$.a],J.array[L+1]=J.value[$.b],J.array[L+2]=J.value[$.c],L+=3;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],J.array[L]=J.value[$.a],J.array[L+1]=J.value[$.b],J.array[L+2]=J.value[$.c],J.array[L+3]=J.value[$.d],L+=4}else{if("faces"===J.boundTo){W=0;for(H=kb.length;W<H;W++)pa=J.value[kb[W]],J.array[L]=pa,J.array[L+1]=pa,J.array[L+2]=pa,L+=3;W=0;for(H=Ya.length;W<H;W++)pa=J.value[Ya[W]],J.array[L]=pa,J.array[L+1]=pa,J.array[L+2]=pa,J.array[L+3]=pa,L+=4}}else if(2===J.size)if(void 0===J.boundTo||
"vertices"===J.boundTo){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],I=J.value[$.a],C=J.value[$.b],Y=J.value[$.c],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=C.x,J.array[L+3]=C.y,J.array[L+4]=Y.x,J.array[L+5]=Y.y,L+=6;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],I=J.value[$.a],C=J.value[$.b],Y=J.value[$.c],T=J.value[$.d],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=C.x,J.array[L+3]=C.y,J.array[L+4]=Y.x,J.array[L+5]=Y.y,J.array[L+6]=T.x,J.array[L+7]=T.y,L+=8}else{if("faces"===J.boundTo){W=0;for(H=kb.length;W<
H;W++)Y=C=I=pa=J.value[kb[W]],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=C.x,J.array[L+3]=C.y,J.array[L+4]=Y.x,J.array[L+5]=Y.y,L+=6;W=0;for(H=Ya.length;W<H;W++)T=Y=C=I=pa=J.value[Ya[W]],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=C.x,J.array[L+3]=C.y,J.array[L+4]=Y.x,J.array[L+5]=Y.y,J.array[L+6]=T.x,J.array[L+7]=T.y,L+=8}}else if(3===J.size){var Da;Da="c"===J.type?["r","g","b"]:["x","y","z"];if(void 0===J.boundTo||"vertices"===J.boundTo){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],I=J.value[$.a],
C=J.value[$.b],Y=J.value[$.c],J.array[L]=I[Da[0]],J.array[L+1]=I[Da[1]],J.array[L+2]=I[Da[2]],J.array[L+3]=C[Da[0]],J.array[L+4]=C[Da[1]],J.array[L+5]=C[Da[2]],J.array[L+6]=Y[Da[0]],J.array[L+7]=Y[Da[1]],J.array[L+8]=Y[Da[2]],L+=9;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],I=J.value[$.a],C=J.value[$.b],Y=J.value[$.c],T=J.value[$.d],J.array[L]=I[Da[0]],J.array[L+1]=I[Da[1]],J.array[L+2]=I[Da[2]],J.array[L+3]=C[Da[0]],J.array[L+4]=C[Da[1]],J.array[L+5]=C[Da[2]],J.array[L+6]=Y[Da[0]],J.array[L+7]=Y[Da[1]],
J.array[L+8]=Y[Da[2]],J.array[L+9]=T[Da[0]],J.array[L+10]=T[Da[1]],J.array[L+11]=T[Da[2]],L+=12}else if("faces"===J.boundTo){W=0;for(H=kb.length;W<H;W++)Y=C=I=pa=J.value[kb[W]],J.array[L]=I[Da[0]],J.array[L+1]=I[Da[1]],J.array[L+2]=I[Da[2]],J.array[L+3]=C[Da[0]],J.array[L+4]=C[Da[1]],J.array[L+5]=C[Da[2]],J.array[L+6]=Y[Da[0]],J.array[L+7]=Y[Da[1]],J.array[L+8]=Y[Da[2]],L+=9;W=0;for(H=Ya.length;W<H;W++)T=Y=C=I=pa=J.value[Ya[W]],J.array[L]=I[Da[0]],J.array[L+1]=I[Da[1]],J.array[L+2]=I[Da[2]],J.array[L+
3]=C[Da[0]],J.array[L+4]=C[Da[1]],J.array[L+5]=C[Da[2]],J.array[L+6]=Y[Da[0]],J.array[L+7]=Y[Da[1]],J.array[L+8]=Y[Da[2]],J.array[L+9]=T[Da[0]],J.array[L+10]=T[Da[1]],J.array[L+11]=T[Da[2]],L+=12}else if("faceVertices"===J.boundTo){W=0;for(H=kb.length;W<H;W++)pa=J.value[kb[W]],I=pa[0],C=pa[1],Y=pa[2],J.array[L]=I[Da[0]],J.array[L+1]=I[Da[1]],J.array[L+2]=I[Da[2]],J.array[L+3]=C[Da[0]],J.array[L+4]=C[Da[1]],J.array[L+5]=C[Da[2]],J.array[L+6]=Y[Da[0]],J.array[L+7]=Y[Da[1]],J.array[L+8]=Y[Da[2]],L+=
9;W=0;for(H=Ya.length;W<H;W++)pa=J.value[Ya[W]],I=pa[0],C=pa[1],Y=pa[2],T=pa[3],J.array[L]=I[Da[0]],J.array[L+1]=I[Da[1]],J.array[L+2]=I[Da[2]],J.array[L+3]=C[Da[0]],J.array[L+4]=C[Da[1]],J.array[L+5]=C[Da[2]],J.array[L+6]=Y[Da[0]],J.array[L+7]=Y[Da[1]],J.array[L+8]=Y[Da[2]],J.array[L+9]=T[Da[0]],J.array[L+10]=T[Da[1]],J.array[L+11]=T[Da[2]],L+=12}}else if(4===J.size)if(void 0===J.boundTo||"vertices"===J.boundTo){W=0;for(H=kb.length;W<H;W++)$=Mb[kb[W]],I=J.value[$.a],C=J.value[$.b],Y=J.value[$.c],
J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=I.z,J.array[L+3]=I.w,J.array[L+4]=C.x,J.array[L+5]=C.y,J.array[L+6]=C.z,J.array[L+7]=C.w,J.array[L+8]=Y.x,J.array[L+9]=Y.y,J.array[L+10]=Y.z,J.array[L+11]=Y.w,L+=12;W=0;for(H=Ya.length;W<H;W++)$=Mb[Ya[W]],I=J.value[$.a],C=J.value[$.b],Y=J.value[$.c],T=J.value[$.d],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=I.z,J.array[L+3]=I.w,J.array[L+4]=C.x,J.array[L+5]=C.y,J.array[L+6]=C.z,J.array[L+7]=C.w,J.array[L+8]=Y.x,J.array[L+9]=Y.y,J.array[L+10]=Y.z,J.array[L+
11]=Y.w,J.array[L+12]=T.x,J.array[L+13]=T.y,J.array[L+14]=T.z,J.array[L+15]=T.w,L+=16}else if("faces"===J.boundTo){W=0;for(H=kb.length;W<H;W++)Y=C=I=pa=J.value[kb[W]],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=I.z,J.array[L+3]=I.w,J.array[L+4]=C.x,J.array[L+5]=C.y,J.array[L+6]=C.z,J.array[L+7]=C.w,J.array[L+8]=Y.x,J.array[L+9]=Y.y,J.array[L+10]=Y.z,J.array[L+11]=Y.w,L+=12;W=0;for(H=Ya.length;W<H;W++)T=Y=C=I=pa=J.value[Ya[W]],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=I.z,J.array[L+3]=I.w,J.array[L+
4]=C.x,J.array[L+5]=C.y,J.array[L+6]=C.z,J.array[L+7]=C.w,J.array[L+8]=Y.x,J.array[L+9]=Y.y,J.array[L+10]=Y.z,J.array[L+11]=Y.w,J.array[L+12]=T.x,J.array[L+13]=T.y,J.array[L+14]=T.z,J.array[L+15]=T.w,L+=16}else if("faceVertices"===J.boundTo){W=0;for(H=kb.length;W<H;W++)pa=J.value[kb[W]],I=pa[0],C=pa[1],Y=pa[2],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=I.z,J.array[L+3]=I.w,J.array[L+4]=C.x,J.array[L+5]=C.y,J.array[L+6]=C.z,J.array[L+7]=C.w,J.array[L+8]=Y.x,J.array[L+9]=Y.y,J.array[L+10]=Y.z,J.array[L+
11]=Y.w,L+=12;W=0;for(H=Ya.length;W<H;W++)pa=J.value[Ya[W]],I=pa[0],C=pa[1],Y=pa[2],T=pa[3],J.array[L]=I.x,J.array[L+1]=I.y,J.array[L+2]=I.z,J.array[L+3]=I.w,J.array[L+4]=C.x,J.array[L+5]=C.y,J.array[L+6]=C.z,J.array[L+7]=C.w,J.array[L+8]=Y.x,J.array[L+9]=Y.y,J.array[L+10]=Y.z,J.array[L+11]=Y.w,J.array[L+12]=T.x,J.array[L+13]=T.y,J.array[L+14]=T.z,J.array[L+15]=T.w,L+=16}x.bindBuffer(x.ARRAY_BUFFER,J.buffer);x.bufferData(x.ARRAY_BUFFER,J.array,aa)}}qa&&(delete G.__inittedArrays,delete G.__colorArray,
delete G.__normalArray,delete G.__tangentArray,delete G.__uvArray,delete G.__uv2Array,delete G.__faceArray,delete G.__vertexArray,delete G.__lineArray,delete G.__skinIndexArray,delete G.__skinWeightArray)}}p.verticesNeedUpdate=!1;p.morphTargetsNeedUpdate=!1;p.elementsNeedUpdate=!1;p.uvsNeedUpdate=!1;p.normalsNeedUpdate=!1;p.colorsNeedUpdate=!1;p.tangentsNeedUpdate=!1;p.buffersNeedUpdate=!1;t.attributes&&y(t)}else if(l instanceof THREE.Ribbon){t=f(l,p);s=t.attributes&&w(t);if(p.verticesNeedUpdate||
p.colorsNeedUpdate||p.normalsNeedUpdate||s){var jc=p,Cc=x.DYNAMIC_DRAW,Dd=void 0,ad=void 0,Ea=void 0,Oc=void 0,gb=void 0,Pc=void 0,od=void 0,id=void 0,Ed=void 0,Hb=void 0,pd=void 0,xb=void 0,Wb=void 0,xe=jc.vertices,Fd=jc.colors,Xc=jc.normals,qd=xe.length,rd=Fd.length,ye=Xc.length,Zb=jc.__vertexArray,sd=jc.__colorArray,td=jc.__normalArray,ee=jc.colorsNeedUpdate,Uc=jc.normalsNeedUpdate,Dc=jc.__webglCustomAttributesList;if(jc.verticesNeedUpdate){for(Dd=0;Dd<qd;Dd++)Oc=xe[Dd],gb=3*Dd,Zb[gb]=Oc.x,Zb[gb+
1]=Oc.y,Zb[gb+2]=Oc.z;x.bindBuffer(x.ARRAY_BUFFER,jc.__webglVertexBuffer);x.bufferData(x.ARRAY_BUFFER,Zb,Cc)}if(ee){for(ad=0;ad<rd;ad++)Pc=Fd[ad],gb=3*ad,sd[gb]=Pc.r,sd[gb+1]=Pc.g,sd[gb+2]=Pc.b;x.bindBuffer(x.ARRAY_BUFFER,jc.__webglColorBuffer);x.bufferData(x.ARRAY_BUFFER,sd,Cc)}if(Uc){for(Ea=0;Ea<ye;Ea++)od=Xc[Ea],gb=3*Ea,td[gb]=od.x,td[gb+1]=od.y,td[gb+2]=od.z;x.bindBuffer(x.ARRAY_BUFFER,jc.__webglNormalBuffer);x.bufferData(x.ARRAY_BUFFER,td,Cc)}if(Dc){id=0;for(Ed=Dc.length;id<Ed;id++)if(xb=Dc[id],
xb.needsUpdate&&(void 0===xb.boundTo||"vertices"===xb.boundTo)){gb=0;pd=xb.value.length;if(1===xb.size)for(Hb=0;Hb<pd;Hb++)xb.array[Hb]=xb.value[Hb];else if(2===xb.size)for(Hb=0;Hb<pd;Hb++)Wb=xb.value[Hb],xb.array[gb]=Wb.x,xb.array[gb+1]=Wb.y,gb+=2;else if(3===xb.size)if("c"===xb.type)for(Hb=0;Hb<pd;Hb++)Wb=xb.value[Hb],xb.array[gb]=Wb.r,xb.array[gb+1]=Wb.g,xb.array[gb+2]=Wb.b,gb+=3;else for(Hb=0;Hb<pd;Hb++)Wb=xb.value[Hb],xb.array[gb]=Wb.x,xb.array[gb+1]=Wb.y,xb.array[gb+2]=Wb.z,gb+=3;else if(4===
xb.size)for(Hb=0;Hb<pd;Hb++)Wb=xb.value[Hb],xb.array[gb]=Wb.x,xb.array[gb+1]=Wb.y,xb.array[gb+2]=Wb.z,xb.array[gb+3]=Wb.w,gb+=4;x.bindBuffer(x.ARRAY_BUFFER,xb.buffer);x.bufferData(x.ARRAY_BUFFER,xb.array,Cc)}}}p.verticesNeedUpdate=!1;p.colorsNeedUpdate=!1;p.normalsNeedUpdate=!1;t.attributes&&y(t)}else if(l instanceof THREE.Line){t=f(l,p);s=t.attributes&&w(t);if(p.verticesNeedUpdate||p.colorsNeedUpdate||p.lineDistancesNeedUpdate||s){var ec=p,Xb=x.DYNAMIC_DRAW,Gd=void 0,ud=void 0,$b=void 0,ac=void 0,
Db=void 0,vd=void 0,Vc=ec.vertices,fe=ec.colors,ge=ec.lineDistances,Ga=Vc.length,nb=fe.length,Wa=ge.length,Tb=ec.__vertexArray,kc=ec.__colorArray,ff=ec.__lineDistanceArray,bd=ec.colorsNeedUpdate,Hd=ec.lineDistancesNeedUpdate,Rd=ec.__webglCustomAttributesList,Id=void 0,cd=void 0,ka=void 0,ab=void 0,Ub=void 0,rb=void 0;if(ec.verticesNeedUpdate){for(Gd=0;Gd<Ga;Gd++)ac=Vc[Gd],Db=3*Gd,Tb[Db]=ac.x,Tb[Db+1]=ac.y,Tb[Db+2]=ac.z;x.bindBuffer(x.ARRAY_BUFFER,ec.__webglVertexBuffer);x.bufferData(x.ARRAY_BUFFER,
Tb,Xb)}if(bd){for(ud=0;ud<nb;ud++)vd=fe[ud],Db=3*ud,kc[Db]=vd.r,kc[Db+1]=vd.g,kc[Db+2]=vd.b;x.bindBuffer(x.ARRAY_BUFFER,ec.__webglColorBuffer);x.bufferData(x.ARRAY_BUFFER,kc,Xb)}if(Hd){for($b=0;$b<Wa;$b++)ff[$b]=ge[$b];x.bindBuffer(x.ARRAY_BUFFER,ec.__webglLineDistanceBuffer);x.bufferData(x.ARRAY_BUFFER,ff,Xb)}if(Rd){Id=0;for(cd=Rd.length;Id<cd;Id++)if(rb=Rd[Id],rb.needsUpdate&&(void 0===rb.boundTo||"vertices"===rb.boundTo)){Db=0;ab=rb.value.length;if(1===rb.size)for(ka=0;ka<ab;ka++)rb.array[ka]=
rb.value[ka];else if(2===rb.size)for(ka=0;ka<ab;ka++)Ub=rb.value[ka],rb.array[Db]=Ub.x,rb.array[Db+1]=Ub.y,Db+=2;else if(3===rb.size)if("c"===rb.type)for(ka=0;ka<ab;ka++)Ub=rb.value[ka],rb.array[Db]=Ub.r,rb.array[Db+1]=Ub.g,rb.array[Db+2]=Ub.b,Db+=3;else for(ka=0;ka<ab;ka++)Ub=rb.value[ka],rb.array[Db]=Ub.x,rb.array[Db+1]=Ub.y,rb.array[Db+2]=Ub.z,Db+=3;else if(4===rb.size)for(ka=0;ka<ab;ka++)Ub=rb.value[ka],rb.array[Db]=Ub.x,rb.array[Db+1]=Ub.y,rb.array[Db+2]=Ub.z,rb.array[Db+3]=Ub.w,Db+=4;x.bindBuffer(x.ARRAY_BUFFER,
rb.buffer);x.bufferData(x.ARRAY_BUFFER,rb.array,Xb)}}}p.verticesNeedUpdate=!1;p.colorsNeedUpdate=!1;p.lineDistancesNeedUpdate=!1;t.attributes&&y(t)}else if(l instanceof THREE.ParticleSystem){t=f(l,p);s=t.attributes&&w(t);if(p.verticesNeedUpdate||p.colorsNeedUpdate||l.sortParticles||s){var Ic=p,Sd=x.DYNAMIC_DRAW,Jd=l,pc=void 0,Jc=void 0,bc=void 0,Ma=void 0,yc=void 0,qc=void 0,Kd=Ic.vertices,Yc=Kd.length,wd=Ic.colors,he=wd.length,Qc=Ic.__vertexArray,Rc=Ic.__colorArray,Kc=Ic.__sortArray,Wc=Ic.verticesNeedUpdate,
xd=Ic.colorsNeedUpdate,Ec=Ic.__webglCustomAttributesList,zc=void 0,Ac=void 0,ua=void 0,vc=void 0,lb=void 0,Fa=void 0;if(Jd.sortParticles){bb.copy(Ka);bb.multiply(Jd.matrixWorld);for(pc=0;pc<Yc;pc++)bc=Kd[pc],fb.copy(bc),fb.applyProjection(bb),Kc[pc]=[fb.z,pc];Kc.sort(q);for(pc=0;pc<Yc;pc++)bc=Kd[Kc[pc][1]],Ma=3*pc,Qc[Ma]=bc.x,Qc[Ma+1]=bc.y,Qc[Ma+2]=bc.z;for(Jc=0;Jc<he;Jc++)Ma=3*Jc,qc=wd[Kc[Jc][1]],Rc[Ma]=qc.r,Rc[Ma+1]=qc.g,Rc[Ma+2]=qc.b;if(Ec){zc=0;for(Ac=Ec.length;zc<Ac;zc++)if(Fa=Ec[zc],void 0===
Fa.boundTo||"vertices"===Fa.boundTo)if(Ma=0,vc=Fa.value.length,1===Fa.size)for(ua=0;ua<vc;ua++)yc=Kc[ua][1],Fa.array[ua]=Fa.value[yc];else if(2===Fa.size)for(ua=0;ua<vc;ua++)yc=Kc[ua][1],lb=Fa.value[yc],Fa.array[Ma]=lb.x,Fa.array[Ma+1]=lb.y,Ma+=2;else if(3===Fa.size)if("c"===Fa.type)for(ua=0;ua<vc;ua++)yc=Kc[ua][1],lb=Fa.value[yc],Fa.array[Ma]=lb.r,Fa.array[Ma+1]=lb.g,Fa.array[Ma+2]=lb.b,Ma+=3;else for(ua=0;ua<vc;ua++)yc=Kc[ua][1],lb=Fa.value[yc],Fa.array[Ma]=lb.x,Fa.array[Ma+1]=lb.y,Fa.array[Ma+
2]=lb.z,Ma+=3;else if(4===Fa.size)for(ua=0;ua<vc;ua++)yc=Kc[ua][1],lb=Fa.value[yc],Fa.array[Ma]=lb.x,Fa.array[Ma+1]=lb.y,Fa.array[Ma+2]=lb.z,Fa.array[Ma+3]=lb.w,Ma+=4}}else{if(Wc)for(pc=0;pc<Yc;pc++)bc=Kd[pc],Ma=3*pc,Qc[Ma]=bc.x,Qc[Ma+1]=bc.y,Qc[Ma+2]=bc.z;if(xd)for(Jc=0;Jc<he;Jc++)qc=wd[Jc],Ma=3*Jc,Rc[Ma]=qc.r,Rc[Ma+1]=qc.g,Rc[Ma+2]=qc.b;if(Ec){zc=0;for(Ac=Ec.length;zc<Ac;zc++)if(Fa=Ec[zc],Fa.needsUpdate&&(void 0===Fa.boundTo||"vertices"===Fa.boundTo))if(vc=Fa.value.length,Ma=0,1===Fa.size)for(ua=
0;ua<vc;ua++)Fa.array[ua]=Fa.value[ua];else if(2===Fa.size)for(ua=0;ua<vc;ua++)lb=Fa.value[ua],Fa.array[Ma]=lb.x,Fa.array[Ma+1]=lb.y,Ma+=2;else if(3===Fa.size)if("c"===Fa.type)for(ua=0;ua<vc;ua++)lb=Fa.value[ua],Fa.array[Ma]=lb.r,Fa.array[Ma+1]=lb.g,Fa.array[Ma+2]=lb.b,Ma+=3;else for(ua=0;ua<vc;ua++)lb=Fa.value[ua],Fa.array[Ma]=lb.x,Fa.array[Ma+1]=lb.y,Fa.array[Ma+2]=lb.z,Ma+=3;else if(4===Fa.size)for(ua=0;ua<vc;ua++)lb=Fa.value[ua],Fa.array[Ma]=lb.x,Fa.array[Ma+1]=lb.y,Fa.array[Ma+2]=lb.z,Fa.array[Ma+
3]=lb.w,Ma+=4}}if(Wc||Jd.sortParticles)x.bindBuffer(x.ARRAY_BUFFER,Ic.__webglVertexBuffer),x.bufferData(x.ARRAY_BUFFER,Qc,Sd);if(xd||Jd.sortParticles)x.bindBuffer(x.ARRAY_BUFFER,Ic.__webglColorBuffer),x.bufferData(x.ARRAY_BUFFER,Rc,Sd);if(Ec){zc=0;for(Ac=Ec.length;zc<Ac;zc++)if(Fa=Ec[zc],Fa.needsUpdate||Jd.sortParticles)x.bindBuffer(x.ARRAY_BUFFER,Fa.buffer),x.bufferData(x.ARRAY_BUFFER,Fa.array,Sd)}}p.verticesNeedUpdate=!1;p.colorsNeedUpdate=!1;t.attributes&&y(t)}}};this.initMaterial=function(b,c,
e,d){var f,g,h,k;b.addEventListener("dispose",ga);var l,p,q,r,s;b instanceof THREE.MeshDepthMaterial?s="depth":b instanceof THREE.MeshNormalMaterial?s="normal":b instanceof THREE.MeshBasicMaterial?s="basic":b instanceof THREE.MeshLambertMaterial?s="lambert":b instanceof THREE.MeshPhongMaterial?s="phong":b instanceof THREE.LineBasicMaterial?s="basic":b instanceof THREE.LineDashedMaterial?s="dashed":b instanceof THREE.ParticleBasicMaterial&&(s="particle_basic");if(s){var t=THREE.ShaderLib[s];b.uniforms=
THREE.UniformsUtils.clone(t.uniforms);b.vertexShader=t.vertexShader;b.fragmentShader=t.fragmentShader}var u,v,w;f=h=v=w=t=0;for(g=c.length;f<g;f++)u=c[f],u.onlyShadow||(u instanceof THREE.DirectionalLight&&h++,u instanceof THREE.PointLight&&v++,u instanceof THREE.SpotLight&&w++,u instanceof THREE.HemisphereLight&&t++);f=h;g=v;h=w;k=t;t=u=0;for(w=c.length;t<w;t++)v=c[t],v.castShadow&&(v instanceof THREE.SpotLight&&u++,v instanceof THREE.DirectionalLight&&!v.shadowCascade&&u++);r=u;Jb&&d&&d.useVertexTexture?
q=1024:(c=x.getParameter(x.MAX_VERTEX_UNIFORM_VECTORS),c=Math.floor((c-20)/4),void 0!==d&&d instanceof THREE.SkinnedMesh&&(c=Math.min(d.bones.length,c),c<d.bones.length&&console.warn("WebGLRenderer: too many bones - "+d.bones.length+", this GPU supports just "+c+" (try OpenGL instead of ANGLE)")),q=c);a:{w=b.fragmentShader;v=b.vertexShader;t=b.uniforms;c=b.attributes;u=b.defines;e={map:!!b.map,envMap:!!b.envMap,lightMap:!!b.lightMap,bumpMap:!!b.bumpMap,normalMap:!!b.normalMap,specularMap:!!b.specularMap,
vertexColors:b.vertexColors,fog:e,useFog:b.fog,fogExp:e instanceof THREE.FogExp2,sizeAttenuation:b.sizeAttenuation,skinning:b.skinning,maxBones:q,useVertexTexture:Jb&&d&&d.useVertexTexture,boneTextureWidth:d&&d.boneTextureWidth,boneTextureHeight:d&&d.boneTextureHeight,morphTargets:b.morphTargets,morphNormals:b.morphNormals,maxMorphTargets:this.maxMorphTargets,maxMorphNormals:this.maxMorphNormals,maxDirLights:f,maxPointLights:g,maxSpotLights:h,maxHemiLights:k,maxShadows:r,shadowMapEnabled:this.shadowMapEnabled&&
d.receiveShadow,shadowMapType:this.shadowMapType,shadowMapDebug:this.shadowMapDebug,shadowMapCascade:this.shadowMapCascade,alphaTest:b.alphaTest,metal:b.metal,perPixel:b.perPixel,wrapAround:b.wrapAround,doubleSided:b.side===THREE.DoubleSide,flipSided:b.side===THREE.BackSide};var y,z,qa;d=[];s?d.push(s):(d.push(w),d.push(v));for(z in u)d.push(z),d.push(u[z]);for(y in e)d.push(y),d.push(e[y]);s=d.join();y=0;for(z=$.length;y<z;y++)if(d=$[y],d.code===s){d.usedTimes++;p=d.program;break a}y="SHADOWMAP_TYPE_BASIC";
e.shadowMapType===THREE.PCFShadowMap?y="SHADOWMAP_TYPE_PCF":e.shadowMapType===THREE.PCFSoftShadowMap&&(y="SHADOWMAP_TYPE_PCF_SOFT");z=[];for(qa in u)d=u[qa],!1!==d&&(d="#define "+qa+" "+d,z.push(d));d=z.join("\n");qa=x.createProgram();z=["precision "+C+" float;",d,gc?"#define VERTEX_TEXTURES":"",S.gammaInput?"#define GAMMA_INPUT":"",S.gammaOutput?"#define GAMMA_OUTPUT":"",S.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"","#define MAX_DIR_LIGHTS "+e.maxDirLights,"#define MAX_POINT_LIGHTS "+
e.maxPointLights,"#define MAX_SPOT_LIGHTS "+e.maxSpotLights,"#define MAX_HEMI_LIGHTS "+e.maxHemiLights,"#define MAX_SHADOWS "+e.maxShadows,"#define MAX_BONES "+e.maxBones,e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.lightMap?"#define USE_LIGHTMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.vertexColors?"#define USE_COLOR":"",e.skinning?"#define USE_SKINNING":"",e.useVertexTexture?"#define BONE_TEXTURE":
"",e.boneTextureWidth?"#define N_BONE_PIXEL_X "+e.boneTextureWidth.toFixed(1):"",e.boneTextureHeight?"#define N_BONE_PIXEL_Y "+e.boneTextureHeight.toFixed(1):"",e.morphTargets?"#define USE_MORPHTARGETS":"",e.morphNormals?"#define USE_MORPHNORMALS":"",e.perPixel?"#define PHONG_PER_PIXEL":"",e.wrapAround?"#define WRAP_AROUND":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+y:"",e.shadowMapDebug?
"#define SHADOWMAP_DEBUG":"",e.shadowMapCascade?"#define SHADOWMAP_CASCADE":"",e.sizeAttenuation?"#define USE_SIZEATTENUATION":"","uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\nattribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\nattribute vec2 uv2;\n#ifdef USE_COLOR\nattribute vec3 color;\n#endif\n#ifdef USE_MORPHTARGETS\nattribute vec3 morphTarget0;\nattribute vec3 morphTarget1;\nattribute vec3 morphTarget2;\nattribute vec3 morphTarget3;\n#ifdef USE_MORPHNORMALS\nattribute vec3 morphNormal0;\nattribute vec3 morphNormal1;\nattribute vec3 morphNormal2;\nattribute vec3 morphNormal3;\n#else\nattribute vec3 morphTarget4;\nattribute vec3 morphTarget5;\nattribute vec3 morphTarget6;\nattribute vec3 morphTarget7;\n#endif\n#endif\n#ifdef USE_SKINNING\nattribute vec4 skinIndex;\nattribute vec4 skinWeight;\n#endif\n"].join("\n");
y=["precision "+C+" float;",e.bumpMap||e.normalMap?"#extension GL_OES_standard_derivatives : enable":"",d,"#define MAX_DIR_LIGHTS "+e.maxDirLights,"#define MAX_POINT_LIGHTS "+e.maxPointLights,"#define MAX_SPOT_LIGHTS "+e.maxSpotLights,"#define MAX_HEMI_LIGHTS "+e.maxHemiLights,"#define MAX_SHADOWS "+e.maxShadows,e.alphaTest?"#define ALPHATEST "+e.alphaTest:"",S.gammaInput?"#define GAMMA_INPUT":"",S.gammaOutput?"#define GAMMA_OUTPUT":"",S.physicallyBasedShading?"#define PHYSICALLY_BASED_SHADING":"",
e.useFog&&e.fog?"#define USE_FOG":"",e.useFog&&e.fogExp?"#define FOG_EXP2":"",e.map?"#define USE_MAP":"",e.envMap?"#define USE_ENVMAP":"",e.lightMap?"#define USE_LIGHTMAP":"",e.bumpMap?"#define USE_BUMPMAP":"",e.normalMap?"#define USE_NORMALMAP":"",e.specularMap?"#define USE_SPECULARMAP":"",e.vertexColors?"#define USE_COLOR":"",e.metal?"#define METAL":"",e.perPixel?"#define PHONG_PER_PIXEL":"",e.wrapAround?"#define WRAP_AROUND":"",e.doubleSided?"#define DOUBLE_SIDED":"",e.flipSided?"#define FLIP_SIDED":
"",e.shadowMapEnabled?"#define USE_SHADOWMAP":"",e.shadowMapEnabled?"#define "+y:"",e.shadowMapDebug?"#define SHADOWMAP_DEBUG":"",e.shadowMapCascade?"#define SHADOWMAP_CASCADE":"","uniform mat4 viewMatrix;\nuniform vec3 cameraPosition;\n"].join("\n");z=aa("vertex",z+v);y=aa("fragment",y+w);x.attachShader(qa,z);x.attachShader(qa,y);x.linkProgram(qa);x.getProgramParameter(qa,x.LINK_STATUS)||console.error("Could not initialise shader\nVALIDATE_STATUS: "+x.getProgramParameter(qa,x.VALIDATE_STATUS)+", gl error ["+
x.getError()+"]");x.deleteShader(y);x.deleteShader(z);qa.uniforms={};qa.attributes={};var da;y="viewMatrix modelViewMatrix projectionMatrix normalMatrix modelMatrix cameraPosition morphTargetInfluences".split(" ");e.useVertexTexture?y.push("boneTexture"):y.push("boneGlobalMatrices");for(da in t)y.push(da);da=y;y=0;for(z=da.length;y<z;y++)t=da[y],qa.uniforms[t]=x.getUniformLocation(qa,t);y="position normal uv uv2 tangent color skinIndex skinWeight lineDistance".split(" ");for(da=0;da<e.maxMorphTargets;da++)y.push("morphTarget"+
da);for(da=0;da<e.maxMorphNormals;da++)y.push("morphNormal"+da);for(p in c)y.push(p);p=y;da=0;for(c=p.length;da<c;da++)y=p[da],qa.attributes[y]=x.getAttribLocation(qa,y);qa.id=ra++;$.push({program:qa,code:s,usedTimes:1});S.info.memory.programs=$.length;p=qa}b.program=p;da=b.program.attributes;if(b.morphTargets){b.numSupportedMorphTargets=0;c="morphTarget";for(p=0;p<this.maxMorphTargets;p++)qa=c+p,0<=da[qa]&&b.numSupportedMorphTargets++}if(b.morphNormals){b.numSupportedMorphNormals=0;c="morphNormal";
for(p=0;p<this.maxMorphNormals;p++)qa=c+p,0<=da[qa]&&b.numSupportedMorphNormals++}b.uniformsList=[];for(l in b.uniforms)b.uniformsList.push([b.uniforms[l],l])};this.setFaceCulling=function(b,c){b===THREE.CullFaceNone?x.disable(x.CULL_FACE):(c===THREE.FrontFaceDirectionCW?x.frontFace(x.CW):x.frontFace(x.CCW),b===THREE.CullFaceBack?x.cullFace(x.BACK):b===THREE.CullFaceFront?x.cullFace(x.FRONT):x.cullFace(x.FRONT_AND_BACK),x.enable(x.CULL_FACE))};this.setMaterialFaces=function(b){var c=b.side===THREE.DoubleSide;
b=b.side===THREE.BackSide;ia!==c&&(c?x.disable(x.CULL_FACE):x.enable(x.CULL_FACE),ia=c);ea!==b&&(b?x.frontFace(x.CW):x.frontFace(x.CCW),ea=b)};this.setDepthTest=function(b){Ua!==b&&(b?x.enable(x.DEPTH_TEST):x.disable(x.DEPTH_TEST),Ua=b)};this.setDepthWrite=function(b){ha!==b&&(x.depthMask(b),ha=b)};this.setBlending=function(b,c,e,d){b!==xa&&(b===THREE.NoBlending?x.disable(x.BLEND):b===THREE.AdditiveBlending?(x.enable(x.BLEND),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.SRC_ALPHA,x.ONE)):b===THREE.SubtractiveBlending?
(x.enable(x.BLEND),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.ZERO,x.ONE_MINUS_SRC_COLOR)):b===THREE.MultiplyBlending?(x.enable(x.BLEND),x.blendEquation(x.FUNC_ADD),x.blendFunc(x.ZERO,x.SRC_COLOR)):b===THREE.CustomBlending?x.enable(x.BLEND):(x.enable(x.BLEND),x.blendEquationSeparate(x.FUNC_ADD,x.FUNC_ADD),x.blendFuncSeparate(x.SRC_ALPHA,x.ONE_MINUS_SRC_ALPHA,x.ONE,x.ONE_MINUS_SRC_ALPHA)),xa=b);if(b===THREE.CustomBlending){if(c!==Aa&&(x.blendEquation(Q(c)),Aa=c),e!==ya||d!==Ba)x.blendFunc(Q(e),Q(d)),
ya=e,Ba=d}else Ba=ya=Aa=null};this.setTexture=function(b,c){if(b.needsUpdate){b.__webglInit||(b.__webglInit=!0,b.addEventListener("dispose",sc),b.__webglTexture=x.createTexture(),S.info.memory.textures++);x.activeTexture(x.TEXTURE0+c);x.bindTexture(x.TEXTURE_2D,b.__webglTexture);x.pixelStorei(x.UNPACK_FLIP_Y_WEBGL,b.flipY);x.pixelStorei(x.UNPACK_PREMULTIPLY_ALPHA_WEBGL,b.premultiplyAlpha);x.pixelStorei(x.UNPACK_ALIGNMENT,b.unpackAlignment);var e=b.image,d=0===(e.width&e.width-1)&&0===(e.height&e.height-
1),f=Q(b.format),g=Q(b.type);D(x.TEXTURE_2D,b,d);var h=b.mipmaps;if(b instanceof THREE.DataTexture)if(0<h.length&&d){for(var k=0,l=h.length;k<l;k++)e=h[k],x.texImage2D(x.TEXTURE_2D,k,f,e.width,e.height,0,f,g,e.data);b.generateMipmaps=!1}else x.texImage2D(x.TEXTURE_2D,0,f,e.width,e.height,0,f,g,e.data);else if(b instanceof THREE.CompressedTexture){k=0;for(l=h.length;k<l;k++)e=h[k],x.compressedTexImage2D(x.TEXTURE_2D,k,f,e.width,e.height,0,e.data)}else if(0<h.length&&d){k=0;for(l=h.length;k<l;k++)e=
h[k],x.texImage2D(x.TEXTURE_2D,k,f,f,g,e);b.generateMipmaps=!1}else x.texImage2D(x.TEXTURE_2D,0,f,f,g,b.image);b.generateMipmaps&&d&&x.generateMipmap(x.TEXTURE_2D);b.needsUpdate=!1;if(b.onUpdate)b.onUpdate()}else x.activeTexture(x.TEXTURE0+c),x.bindTexture(x.TEXTURE_2D,b.__webglTexture)};this.setRenderTarget=function(b){var c=b instanceof THREE.WebGLRenderTargetCube;if(b&&!b.__webglFramebuffer){void 0===b.depthBuffer&&(b.depthBuffer=!0);void 0===b.stencilBuffer&&(b.stencilBuffer=!0);b.addEventListener("dispose",
oc);b.__webglTexture=x.createTexture();S.info.memory.textures++;var e=0===(b.width&b.width-1)&&0===(b.height&b.height-1),d=Q(b.format),f=Q(b.type);if(c){b.__webglFramebuffer=[];b.__webglRenderbuffer=[];x.bindTexture(x.TEXTURE_CUBE_MAP,b.__webglTexture);D(x.TEXTURE_CUBE_MAP,b,e);for(var g=0;6>g;g++){b.__webglFramebuffer[g]=x.createFramebuffer();b.__webglRenderbuffer[g]=x.createRenderbuffer();x.texImage2D(x.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,d,b.width,b.height,0,d,f,null);var h=b,k=x.TEXTURE_CUBE_MAP_POSITIVE_X+
g;x.bindFramebuffer(x.FRAMEBUFFER,b.__webglFramebuffer[g]);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,k,h.__webglTexture,0);M(b.__webglRenderbuffer[g],b)}e&&x.generateMipmap(x.TEXTURE_CUBE_MAP)}else b.__webglFramebuffer=x.createFramebuffer(),b.__webglRenderbuffer=b.shareDepthFrom?b.shareDepthFrom.__webglRenderbuffer:x.createRenderbuffer(),x.bindTexture(x.TEXTURE_2D,b.__webglTexture),D(x.TEXTURE_2D,b,e),x.texImage2D(x.TEXTURE_2D,0,d,b.width,b.height,0,d,f,null),d=x.TEXTURE_2D,x.bindFramebuffer(x.FRAMEBUFFER,
b.__webglFramebuffer),x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,d,b.__webglTexture,0),b.shareDepthFrom?b.depthBuffer&&!b.stencilBuffer?x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,b.__webglRenderbuffer):b.depthBuffer&&b.stencilBuffer&&x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_STENCIL_ATTACHMENT,x.RENDERBUFFER,b.__webglRenderbuffer):M(b.__webglRenderbuffer,b),e&&x.generateMipmap(x.TEXTURE_2D);c?x.bindTexture(x.TEXTURE_CUBE_MAP,null):x.bindTexture(x.TEXTURE_2D,
null);x.bindRenderbuffer(x.RENDERBUFFER,null);x.bindFramebuffer(x.FRAMEBUFFER,null)}b?(c=c?b.__webglFramebuffer[b.activeCubeFace]:b.__webglFramebuffer,e=b.width,b=b.height,f=d=0):(c=null,e=Pa,b=va,d=Xa,f=zb);c!==ta&&(x.bindFramebuffer(x.FRAMEBUFFER,c),x.viewport(d,f,e,b),ta=c);db=e;Ib=b};this.shadowMapPlugin=new THREE.ShadowMapPlugin;this.addPrePlugin(this.shadowMapPlugin);this.addPostPlugin(new THREE.SpritePlugin);this.addPostPlugin(new THREE.LensFlarePlugin)};
THREE.WebGLRenderTarget=function(b,d,c){this.width=b;this.height=d;c=c||{};this.wrapS=void 0!==c.wrapS?c.wrapS:THREE.ClampToEdgeWrapping;this.wrapT=void 0!==c.wrapT?c.wrapT:THREE.ClampToEdgeWrapping;this.magFilter=void 0!==c.magFilter?c.magFilter:THREE.LinearFilter;this.minFilter=void 0!==c.minFilter?c.minFilter:THREE.LinearMipMapLinearFilter;this.anisotropy=void 0!==c.anisotropy?c.anisotropy:1;this.offset=new THREE.Vector2(0,0);this.repeat=new THREE.Vector2(1,1);this.format=void 0!==c.format?c.format:
THREE.RGBAFormat;this.type=void 0!==c.type?c.type:THREE.UnsignedByteType;this.depthBuffer=void 0!==c.depthBuffer?c.depthBuffer:!0;this.stencilBuffer=void 0!==c.stencilBuffer?c.stencilBuffer:!0;this.generateMipmaps=!0;this.shareDepthFrom=null};
THREE.WebGLRenderTarget.prototype={constructor:THREE.WebGLRenderTarget,addEventListener:THREE.EventDispatcher.prototype.addEventListener,hasEventListener:THREE.EventDispatcher.prototype.hasEventListener,removeEventListener:THREE.EventDispatcher.prototype.removeEventListener,dispatchEvent:THREE.EventDispatcher.prototype.dispatchEvent,clone:function(){var b=new THREE.WebGLRenderTarget(this.width,this.height);b.wrapS=this.wrapS;b.wrapT=this.wrapT;b.magFilter=this.magFilter;b.minFilter=this.minFilter;
b.anisotropy=this.anisotropy;b.offset.copy(this.offset);b.repeat.copy(this.repeat);b.format=this.format;b.type=this.type;b.depthBuffer=this.depthBuffer;b.stencilBuffer=this.stencilBuffer;b.generateMipmaps=this.generateMipmaps;b.shareDepthFrom=this.shareDepthFrom;return b},dispose:function(){this.dispatchEvent({type:"dispose"})}};THREE.WebGLRenderTargetCube=function(b,d,c){THREE.WebGLRenderTarget.call(this,b,d,c);this.activeCubeFace=0};THREE.WebGLRenderTargetCube.prototype=Object.create(THREE.WebGLRenderTarget.prototype);
THREE.RenderableVertex=function(){this.positionWorld=new THREE.Vector3;this.positionScreen=new THREE.Vector4;this.visible=!0};THREE.RenderableVertex.prototype.copy=function(b){this.positionWorld.copy(b.positionWorld);this.positionScreen.copy(b.positionScreen)};
THREE.RenderableFace3=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.material=this.color=null;this.uvs=[[]];this.z=null};
THREE.RenderableFace4=function(){this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.v3=new THREE.RenderableVertex;this.v4=new THREE.RenderableVertex;this.centroidModel=new THREE.Vector3;this.normalModel=new THREE.Vector3;this.normalModelView=new THREE.Vector3;this.vertexNormalsLength=0;this.vertexNormalsModel=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];this.vertexNormalsModelView=[new THREE.Vector3,new THREE.Vector3,new THREE.Vector3,new THREE.Vector3];
this.material=this.color=null;this.uvs=[[]];this.z=null};THREE.RenderableObject=function(){this.z=this.object=null};THREE.RenderableParticle=function(){this.rotation=this.z=this.y=this.x=this.object=null;this.scale=new THREE.Vector2;this.material=null};THREE.RenderableLine=function(){this.z=null;this.v1=new THREE.RenderableVertex;this.v2=new THREE.RenderableVertex;this.vertexColors=[new THREE.Color,new THREE.Color];this.material=null};
THREE.GeometryUtils={merge:function(b,d,c){var e,f,g=b.vertices.length,h=d instanceof THREE.Mesh?d.geometry:d,k=b.vertices,l=h.vertices,p=b.faces,q=h.faces;b=b.faceVertexUvs[0];h=h.faceVertexUvs[0];void 0===c&&(c=0);d instanceof THREE.Mesh&&(d.matrixAutoUpdate&&d.updateMatrix(),e=d.matrix,f=(new THREE.Matrix3).getNormalMatrix(e));d=0;for(var r=l.length;d<r;d++){var s=l[d].clone();e&&s.applyMatrix4(e);k.push(s)}d=0;for(r=q.length;d<r;d++){var s=q[d],t,u,v=s.vertexNormals,w=s.vertexColors;s instanceof
THREE.Face3?t=new THREE.Face3(s.a+g,s.b+g,s.c+g):s instanceof THREE.Face4&&(t=new THREE.Face4(s.a+g,s.b+g,s.c+g,s.d+g));t.normal.copy(s.normal);f&&t.normal.applyMatrix3(f).normalize();k=0;for(l=v.length;k<l;k++)u=v[k].clone(),f&&u.applyMatrix3(f).normalize(),t.vertexNormals.push(u);t.color.copy(s.color);k=0;for(l=w.length;k<l;k++)u=w[k],t.vertexColors.push(u.clone());t.materialIndex=s.materialIndex+c;t.centroid.copy(s.centroid);e&&t.centroid.applyMatrix4(e);p.push(t)}d=0;for(r=h.length;d<r;d++){c=
h[d];e=[];k=0;for(l=c.length;k<l;k++)e.push(new THREE.Vector2(c[k].x,c[k].y));b.push(e)}},removeMaterials:function(b,d){for(var c={},e=0,f=d.length;e<f;e++)c[d[e]]=!0;for(var g,h=[],e=0,f=b.faces.length;e<f;e++)g=b.faces[e],g.materialIndex in c||h.push(g);b.faces=h},randomPointInTriangle:function(b,d,c){var e,f,g,h=new THREE.Vector3,k=THREE.GeometryUtils.__v1;e=THREE.GeometryUtils.random();f=THREE.GeometryUtils.random();1<e+f&&(e=1-e,f=1-f);g=1-e-f;h.copy(b);h.multiplyScalar(e);k.copy(d);k.multiplyScalar(f);
h.add(k);k.copy(c);k.multiplyScalar(g);h.add(k);return h},randomPointInFace:function(b,d,c){var e,f,g;if(b instanceof THREE.Face3)return e=d.vertices[b.a],f=d.vertices[b.b],g=d.vertices[b.c],THREE.GeometryUtils.randomPointInTriangle(e,f,g);if(b instanceof THREE.Face4){e=d.vertices[b.a];f=d.vertices[b.b];g=d.vertices[b.c];d=d.vertices[b.d];var h;c?b._area1&&b._area2?(c=b._area1,h=b._area2):(c=THREE.GeometryUtils.triangleArea(e,f,d),h=THREE.GeometryUtils.triangleArea(f,g,d),b._area1=c,b._area2=h):(c=
THREE.GeometryUtils.triangleArea(e,f,d),h=THREE.GeometryUtils.triangleArea(f,g,d));return THREE.GeometryUtils.random()*(c+h)<c?THREE.GeometryUtils.randomPointInTriangle(e,f,d):THREE.GeometryUtils.randomPointInTriangle(f,g,d)}},randomPointsInGeometry:function(b,d){function c(b){function c(e,d){if(d<e)return e;var f=e+Math.floor((d-e)/2);return p[f]>b?c(e,f-1):p[f]<b?c(f+1,d):f}return c(0,p.length-1)}var e,f,g=b.faces,h=b.vertices,k=g.length,l=0,p=[],q,r,s,t;for(f=0;f<k;f++)e=g[f],e instanceof THREE.Face3?
(q=h[e.a],r=h[e.b],s=h[e.c],e._area=THREE.GeometryUtils.triangleArea(q,r,s)):e instanceof THREE.Face4&&(q=h[e.a],r=h[e.b],s=h[e.c],t=h[e.d],e._area1=THREE.GeometryUtils.triangleArea(q,r,t),e._area2=THREE.GeometryUtils.triangleArea(r,s,t),e._area=e._area1+e._area2),l+=e._area,p[f]=l;e=[];for(f=0;f<d;f++)h=THREE.GeometryUtils.random()*l,h=c(h),e[f]=THREE.GeometryUtils.randomPointInFace(g[h],b,!0);return e},triangleArea:function(b,d,c){var e=THREE.GeometryUtils.__v1,f=THREE.GeometryUtils.__v2;e.subVectors(d,
b);f.subVectors(c,b);e.cross(f);return 0.5*e.length()},center:function(b){b.computeBoundingBox();var d=b.boundingBox,c=new THREE.Vector3;c.addVectors(d.min,d.max);c.multiplyScalar(-0.5);b.applyMatrix((new THREE.Matrix4).makeTranslation(c.x,c.y,c.z));b.computeBoundingBox();return c},normalizeUVs:function(b){b=b.faceVertexUvs[0];for(var d=0,c=b.length;d<c;d++)for(var e=b[d],f=0,g=e.length;f<g;f++)1!==e[f].x&&(e[f].x-=Math.floor(e[f].x)),1!==e[f].y&&(e[f].y-=Math.floor(e[f].y))},triangulateQuads:function(b){var d,
c,e,f,g=[],h=[],k=[];d=0;for(c=b.faceUvs.length;d<c;d++)h[d]=[];d=0;for(c=b.faceVertexUvs.length;d<c;d++)k[d]=[];d=0;for(c=b.faces.length;d<c;d++)if(e=b.faces[d],e instanceof THREE.Face4){f=e.a;var l=e.b,p=e.c,q=e.d,r=new THREE.Face3,s=new THREE.Face3;r.color.copy(e.color);s.color.copy(e.color);r.materialIndex=e.materialIndex;s.materialIndex=e.materialIndex;r.a=f;r.b=l;r.c=q;s.a=l;s.b=p;s.c=q;4===e.vertexColors.length&&(r.vertexColors[0]=e.vertexColors[0].clone(),r.vertexColors[1]=e.vertexColors[1].clone(),
r.vertexColors[2]=e.vertexColors[3].clone(),s.vertexColors[0]=e.vertexColors[1].clone(),s.vertexColors[1]=e.vertexColors[2].clone(),s.vertexColors[2]=e.vertexColors[3].clone());g.push(r,s);e=0;for(f=b.faceVertexUvs.length;e<f;e++)b.faceVertexUvs[e].length&&(r=b.faceVertexUvs[e][d],l=r[1],p=r[2],q=r[3],r=[r[0].clone(),l.clone(),q.clone()],l=[l.clone(),p.clone(),q.clone()],k[e].push(r,l));e=0;for(f=b.faceUvs.length;e<f;e++)b.faceUvs[e].length&&(l=b.faceUvs[e][d],h[e].push(l,l))}else{g.push(e);e=0;for(f=
b.faceUvs.length;e<f;e++)h[e].push(b.faceUvs[e][d]);e=0;for(f=b.faceVertexUvs.length;e<f;e++)k[e].push(b.faceVertexUvs[e][d])}b.faces=g;b.faceUvs=h;b.faceVertexUvs=k;b.computeCentroids();b.computeFaceNormals();b.computeVertexNormals();b.hasTangents&&b.computeTangents()},setMaterialIndex:function(b,d,c,e){b=b.faces;e=e||b.length-1;for(c=c||0;c<=e;c++)b[c].materialIndex=d}};THREE.GeometryUtils.random=THREE.Math.random16;THREE.GeometryUtils.__v1=new THREE.Vector3;THREE.GeometryUtils.__v2=new THREE.Vector3;
THREE.ImageUtils={crossOrigin:"anonymous",loadTexture:function(b,d,c,e){var f=new Image,g=new THREE.Texture(f,d);d=new THREE.ImageLoader;d.addEventListener("load",function(b){g.image=b.content;g.needsUpdate=!0;c&&c(g)});d.addEventListener("error",function(b){e&&e(b.message)});d.crossOrigin=this.crossOrigin;d.load(b,f);g.sourceFile=b;return g},loadCompressedTexture:function(b,d,c,e){var f=new THREE.CompressedTexture;f.mapping=d;var g=new XMLHttpRequest;g.onload=function(){var b=THREE.ImageUtils.parseDDS(g.response,
!0);f.format=b.format;f.mipmaps=b.mipmaps;f.image.width=b.width;f.image.height=b.height;f.generateMipmaps=!1;f.needsUpdate=!0;c&&c(f)};g.onerror=e;g.open("GET",b,!0);g.responseType="arraybuffer";g.send(null);return f},loadTextureCube:function(b,d,c,e){var f=[];f.loadCount=0;var g=new THREE.Texture;g.image=f;void 0!==d&&(g.mapping=d);g.flipY=!1;d=0;for(var h=b.length;d<h;++d){var k=new Image;f[d]=k;k.onload=function(){f.loadCount+=1;6===f.loadCount&&(g.needsUpdate=!0,c&&c(g))};k.onerror=e;k.crossOrigin=
this.crossOrigin;k.src=b[d]}return g},loadCompressedTextureCube:function(b,d,c,e){var f=[];f.loadCount=0;var g=new THREE.CompressedTexture;g.image=f;void 0!==d&&(g.mapping=d);g.flipY=!1;g.generateMipmaps=!1;d=function(b,e){return function(){var d=THREE.ImageUtils.parseDDS(b.response,!0);e.format=d.format;e.mipmaps=d.mipmaps;e.width=d.width;e.height=d.height;f.loadCount+=1;6===f.loadCount&&(g.format=d.format,g.needsUpdate=!0,c&&c(g))}};if(b instanceof Array)for(var h=0,k=b.length;h<k;++h){var l={};
f[h]=l;var p=new XMLHttpRequest;p.onload=d(p,l);p.onerror=e;l=b[h];p.open("GET",l,!0);p.responseType="arraybuffer";p.send(null)}else p=new XMLHttpRequest,p.onload=function(){var b=THREE.ImageUtils.parseDDS(p.response,!0);if(b.isCubemap){for(var e=b.mipmaps.length/b.mipmapCount,d=0;d<e;d++){f[d]={mipmaps:[]};for(var h=0;h<b.mipmapCount;h++)f[d].mipmaps.push(b.mipmaps[d*b.mipmapCount+h]),f[d].format=b.format,f[d].width=b.width,f[d].height=b.height}g.format=b.format;g.needsUpdate=!0;c&&c(g)}},p.onerror=
e,p.open("GET",b,!0),p.responseType="arraybuffer",p.send(null);return g},parseDDS:function(b,d){function c(b){return b.charCodeAt(0)+(b.charCodeAt(1)<<8)+(b.charCodeAt(2)<<16)+(b.charCodeAt(3)<<24)}var e={mipmaps:[],width:0,height:0,format:null,mipmapCount:1},f=c("DXT1"),g=c("DXT3"),h=c("DXT5"),k=new Int32Array(b,0,31);if(542327876!==k[0])return console.error("ImageUtils.parseDDS(): Invalid magic number in DDS header"),e;if(!k[20]&4)return console.error("ImageUtils.parseDDS(): Unsupported format, must contain a FourCC code"),
e;var l=k[21];switch(l){case f:f=8;e.format=THREE.RGB_S3TC_DXT1_Format;break;case g:f=16;e.format=THREE.RGBA_S3TC_DXT3_Format;break;case h:f=16;e.format=THREE.RGBA_S3TC_DXT5_Format;break;default:return console.error("ImageUtils.parseDDS(): Unsupported FourCC code: ",String.fromCharCode(l&255,l>>8&255,l>>16&255,l>>24&255)),e}e.mipmapCount=1;k[2]&131072&&!1!==d&&(e.mipmapCount=Math.max(1,k[7]));e.isCubemap=k[28]&512?!0:!1;e.width=k[4];e.height=k[3];for(var k=k[1]+4,g=e.width,h=e.height,l=e.isCubemap?
6:1,p=0;p<l;p++){for(var q=0;q<e.mipmapCount;q++){var r=Math.max(4,g)/4*Math.max(4,h)/4*f,s={data:new Uint8Array(b,k,r),width:g,height:h};e.mipmaps.push(s);k+=r;g=Math.max(0.5*g,1);h=Math.max(0.5*h,1)}g=e.width;h=e.height}return e},getNormalMap:function(b,d){var c=function(b){var c=Math.sqrt(b[0]*b[0]+b[1]*b[1]+b[2]*b[2]);return[b[0]/c,b[1]/c,b[2]/c]};d|=1;var e=b.width,f=b.height,g=document.createElement("canvas");g.width=e;g.height=f;var h=g.getContext("2d");h.drawImage(b,0,0);for(var k=h.getImageData(0,
0,e,f).data,l=h.createImageData(e,f),p=l.data,q=0;q<e;q++)for(var r=0;r<f;r++){var s=0>r-1?0:r-1,t=r+1>f-1?f-1:r+1,u=0>q-1?0:q-1,v=q+1>e-1?e-1:q+1,w=[],y=[0,0,k[4*(r*e+q)]/255*d];w.push([-1,0,k[4*(r*e+u)]/255*d]);w.push([-1,-1,k[4*(s*e+u)]/255*d]);w.push([0,-1,k[4*(s*e+q)]/255*d]);w.push([1,-1,k[4*(s*e+v)]/255*d]);w.push([1,0,k[4*(r*e+v)]/255*d]);w.push([1,1,k[4*(t*e+v)]/255*d]);w.push([0,1,k[4*(t*e+q)]/255*d]);w.push([-1,1,k[4*(t*e+u)]/255*d]);s=[];u=w.length;for(t=0;t<u;t++){var v=w[t],z=w[(t+1)%
u],v=[v[0]-y[0],v[1]-y[1],v[2]-y[2]],z=[z[0]-y[0],z[1]-y[1],z[2]-y[2]];s.push(c([v[1]*z[2]-v[2]*z[1],v[2]*z[0]-v[0]*z[2],v[0]*z[1]-v[1]*z[0]]))}w=[0,0,0];for(t=0;t<s.length;t++)w[0]+=s[t][0],w[1]+=s[t][1],w[2]+=s[t][2];w[0]/=s.length;w[1]/=s.length;w[2]/=s.length;y=4*(r*e+q);p[y]=255*((w[0]+1)/2)|0;p[y+1]=255*((w[1]+1)/2)|0;p[y+2]=255*w[2]|0;p[y+3]=255}h.putImageData(l,0,0);return g},generateDataTexture:function(b,d,c){var e=b*d,f=new Uint8Array(3*e),g=Math.floor(255*c.r),h=Math.floor(255*c.g);c=
Math.floor(255*c.b);for(var k=0;k<e;k++)f[3*k]=g,f[3*k+1]=h,f[3*k+2]=c;b=new THREE.DataTexture(f,b,d,THREE.RGBFormat);b.needsUpdate=!0;return b}};THREE.SceneUtils={createMultiMaterialObject:function(b,d){for(var c=new THREE.Object3D,e=0,f=d.length;e<f;e++)c.add(new THREE.Mesh(b,d[e]));return c},detach:function(b,d,c){b.applyMatrix(d.matrixWorld);d.remove(b);c.add(b)},attach:function(b,d,c){var e=new THREE.Matrix4;e.getInverse(c.matrixWorld);b.applyMatrix(e);d.remove(b);c.add(b)}};
THREE.FontUtils={faces:{},face:"helvetiker",weight:"normal",style:"normal",size:150,divisions:10,getFace:function(){return this.faces[this.face][this.weight][this.style]},loadFace:function(b){var d=b.familyName.toLowerCase();this.faces[d]=this.faces[d]||{};this.faces[d][b.cssFontWeight]=this.faces[d][b.cssFontWeight]||{};this.faces[d][b.cssFontWeight][b.cssFontStyle]=b;return this.faces[d][b.cssFontWeight][b.cssFontStyle]=b},drawText:function(b){var d=this.getFace(),c=this.size/d.resolution,e=0,f=
String(b).split(""),g=f.length,h=[];for(b=0;b<g;b++){var k=new THREE.Path,k=this.extractGlyphPoints(f[b],d,c,e,k),e=e+k.offset;h.push(k.path)}return{paths:h,offset:e/2}},extractGlyphPoints:function(b,d,c,e,f){var g=[],h,k,l,p,q,r,s,t,u,v,w,y=d.glyphs[b]||d.glyphs["?"];if(y){if(y.o){d=y._cachedOutline||(y._cachedOutline=y.o.split(" "));p=d.length;for(b=0;b<p;)switch(l=d[b++],l){case "m":l=d[b++]*c+e;q=d[b++]*c;f.moveTo(l,q);break;case "l":l=d[b++]*c+e;q=d[b++]*c;f.lineTo(l,q);break;case "q":l=d[b++]*
c+e;q=d[b++]*c;t=d[b++]*c+e;u=d[b++]*c;f.quadraticCurveTo(t,u,l,q);if(h=g[g.length-1]){r=h.x;s=h.y;h=1;for(k=this.divisions;h<=k;h++){var z=h/k;THREE.Shape.Utils.b2(z,r,t,l);THREE.Shape.Utils.b2(z,s,u,q)}}break;case "b":if(l=d[b++]*c+e,q=d[b++]*c,t=d[b++]*c+e,u=d[b++]*-c,v=d[b++]*c+e,w=d[b++]*-c,f.bezierCurveTo(l,q,t,u,v,w),h=g[g.length-1]){r=h.x;s=h.y;h=1;for(k=this.divisions;h<=k;h++)z=h/k,THREE.Shape.Utils.b3(z,r,t,v,l),THREE.Shape.Utils.b3(z,s,u,w,q)}}}return{offset:y.ha*c,path:f}}}};
THREE.FontUtils.generateShapes=function(b,d){d=d||{};var c=void 0!==d.curveSegments?d.curveSegments:4,e=void 0!==d.font?d.font:"helvetiker",f=void 0!==d.weight?d.weight:"normal",g=void 0!==d.style?d.style:"normal";THREE.FontUtils.size=void 0!==d.size?d.size:100;THREE.FontUtils.divisions=c;THREE.FontUtils.face=e;THREE.FontUtils.weight=f;THREE.FontUtils.style=g;c=THREE.FontUtils.drawText(b).paths;e=[];f=0;for(g=c.length;f<g;f++)Array.prototype.push.apply(e,c[f].toShapes());return e};
(function(b){var d=function(b){for(var e=b.length,d=0,g=e-1,h=0;h<e;g=h++)d+=b[g].x*b[h].y-b[h].x*b[g].y;return 0.5*d};b.Triangulate=function(b,e){var f=b.length;if(3>f)return null;var g=[],h=[],k=[],l,p,q;if(0<d(b))for(p=0;p<f;p++)h[p]=p;else for(p=0;p<f;p++)h[p]=f-1-p;var r=2*f;for(p=f-1;2<f;){if(0>=r--){console.log("Warning, unable to triangulate polygon!");break}l=p;f<=l&&(l=0);p=l+1;f<=p&&(p=0);q=p+1;f<=q&&(q=0);var s;a:{var t=void 0,u=void 0,v=void 0,w=void 0,y=void 0,z=void 0,B=void 0,A=void 0,
t=b[h[l]].x,u=b[h[l]].y,v=b[h[p]].x,w=b[h[p]].y,y=b[h[q]].x,z=b[h[q]].y;if(1E-10>(v-t)*(z-u)-(w-u)*(y-t))s=!1;else{var K=void 0,O=void 0,E=void 0,F=void 0,U=void 0,H=void 0,G=void 0,aa=void 0,D=void 0,M=void 0,D=aa=G=A=B=void 0,K=y-v,O=z-w,E=t-y,F=u-z,U=v-t,H=w-u;for(s=0;s<f;s++)if(!(s===l||s===p||s===q))if(B=b[h[s]].x,A=b[h[s]].y,G=B-t,aa=A-u,D=B-v,M=A-w,B-=y,A-=z,D=K*M-O*D,G=U*aa-H*G,aa=E*A-F*B,0<=D&&0<=aa&&0<=G){s=!1;break a}s=!0}}if(s){g.push([b[h[l]],b[h[p]],b[h[q]]]);k.push([h[l],h[p],h[q]]);
l=p;for(q=p+1;q<f;l++,q++)h[l]=h[q];f--;r=2*f}}return e?k:g};b.Triangulate.area=d;return b})(THREE.FontUtils);self._typeface_js={faces:THREE.FontUtils.faces,loadFace:THREE.FontUtils.loadFace};THREE.typeface_js=self._typeface_js;THREE.Curve=function(){};THREE.Curve.prototype.getPoint=function(){console.log("Warning, getPoint() not implemented!");return null};THREE.Curve.prototype.getPointAt=function(b){b=this.getUtoTmapping(b);return this.getPoint(b)};
THREE.Curve.prototype.getPoints=function(b){b||(b=5);var d,c=[];for(d=0;d<=b;d++)c.push(this.getPoint(d/b));return c};THREE.Curve.prototype.getSpacedPoints=function(b){b||(b=5);var d,c=[];for(d=0;d<=b;d++)c.push(this.getPointAt(d/b));return c};THREE.Curve.prototype.getLength=function(){var b=this.getLengths();return b[b.length-1]};
THREE.Curve.prototype.getLengths=function(b){b||(b=this.__arcLengthDivisions?this.__arcLengthDivisions:200);if(this.cacheArcLengths&&this.cacheArcLengths.length==b+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var d=[],c,e=this.getPoint(0),f,g=0;d.push(0);for(f=1;f<=b;f++)c=this.getPoint(f/b),g+=c.distanceTo(e),d.push(g),e=c;return this.cacheArcLengths=d};THREE.Curve.prototype.updateArcLengths=function(){this.needsUpdate=!0;this.getLengths()};
THREE.Curve.prototype.getUtoTmapping=function(b,d){var c=this.getLengths(),e=0,f=c.length,g;g=d?d:b*c[f-1];for(var h=0,k=f-1,l;h<=k;)if(e=Math.floor(h+(k-h)/2),l=c[e]-g,0>l)h=e+1;else if(0<l)k=e-1;else{k=e;break}e=k;if(c[e]==g)return e/(f-1);h=c[e];return(e+(g-h)/(c[e+1]-h))/(f-1)};THREE.Curve.prototype.getTangent=function(b){var d=b-1E-4;b+=1E-4;0>d&&(d=0);1<b&&(b=1);d=this.getPoint(d);return this.getPoint(b).clone().sub(d).normalize()};
THREE.Curve.prototype.getTangentAt=function(b){b=this.getUtoTmapping(b);return this.getTangent(b)};THREE.LineCurve=function(b,d){this.v1=b;this.v2=d};THREE.LineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.LineCurve.prototype.getPoint=function(b){var d=this.v2.clone().sub(this.v1);d.multiplyScalar(b).add(this.v1);return d};THREE.LineCurve.prototype.getPointAt=function(b){return this.getPoint(b)};THREE.LineCurve.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()};
THREE.QuadraticBezierCurve=function(b,d,c){this.v0=b;this.v1=d;this.v2=c};THREE.QuadraticBezierCurve.prototype=Object.create(THREE.Curve.prototype);THREE.QuadraticBezierCurve.prototype.getPoint=function(b){var d;d=THREE.Shape.Utils.b2(b,this.v0.x,this.v1.x,this.v2.x);b=THREE.Shape.Utils.b2(b,this.v0.y,this.v1.y,this.v2.y);return new THREE.Vector2(d,b)};
THREE.QuadraticBezierCurve.prototype.getTangent=function(b){var d;d=THREE.Curve.Utils.tangentQuadraticBezier(b,this.v0.x,this.v1.x,this.v2.x);b=THREE.Curve.Utils.tangentQuadraticBezier(b,this.v0.y,this.v1.y,this.v2.y);d=new THREE.Vector2(d,b);d.normalize();return d};THREE.CubicBezierCurve=function(b,d,c,e){this.v0=b;this.v1=d;this.v2=c;this.v3=e};THREE.CubicBezierCurve.prototype=Object.create(THREE.Curve.prototype);
THREE.CubicBezierCurve.prototype.getPoint=function(b){var d;d=THREE.Shape.Utils.b3(b,this.v0.x,this.v1.x,this.v2.x,this.v3.x);b=THREE.Shape.Utils.b3(b,this.v0.y,this.v1.y,this.v2.y,this.v3.y);return new THREE.Vector2(d,b)};THREE.CubicBezierCurve.prototype.getTangent=function(b){var d;d=THREE.Curve.Utils.tangentCubicBezier(b,this.v0.x,this.v1.x,this.v2.x,this.v3.x);b=THREE.Curve.Utils.tangentCubicBezier(b,this.v0.y,this.v1.y,this.v2.y,this.v3.y);d=new THREE.Vector2(d,b);d.normalize();return d};
THREE.SplineCurve=function(b){this.points=void 0==b?[]:b};THREE.SplineCurve.prototype=Object.create(THREE.Curve.prototype);THREE.SplineCurve.prototype.getPoint=function(b){var d=new THREE.Vector2,c=[],e=this.points,f;f=(e.length-1)*b;b=Math.floor(f);f-=b;c[0]=0==b?b:b-1;c[1]=b;c[2]=b>e.length-2?e.length-1:b+1;c[3]=b>e.length-3?e.length-1:b+2;d.x=THREE.Curve.Utils.interpolate(e[c[0]].x,e[c[1]].x,e[c[2]].x,e[c[3]].x,f);d.y=THREE.Curve.Utils.interpolate(e[c[0]].y,e[c[1]].y,e[c[2]].y,e[c[3]].y,f);return d};
THREE.EllipseCurve=function(b,d,c,e,f,g,h){this.aX=b;this.aY=d;this.xRadius=c;this.yRadius=e;this.aStartAngle=f;this.aEndAngle=g;this.aClockwise=h};THREE.EllipseCurve.prototype=Object.create(THREE.Curve.prototype);THREE.EllipseCurve.prototype.getPoint=function(b){var d=this.aEndAngle-this.aStartAngle;this.aClockwise||(b=1-b);d=this.aStartAngle+b*d;b=this.aX+this.xRadius*Math.cos(d);d=this.aY+this.yRadius*Math.sin(d);return new THREE.Vector2(b,d)};
THREE.ArcCurve=function(b,d,c,e,f,g){THREE.EllipseCurve.call(this,b,d,c,c,e,f,g)};THREE.ArcCurve.prototype=Object.create(THREE.EllipseCurve.prototype);
THREE.Curve.Utils={tangentQuadraticBezier:function(b,d,c,e){return 2*(1-b)*(c-d)+2*b*(e-c)},tangentCubicBezier:function(b,d,c,e,f){return-3*d*(1-b)*(1-b)+3*c*(1-b)*(1-b)-6*b*c*(1-b)+6*b*e*(1-b)-3*b*b*e+3*b*b*f},tangentSpline:function(b){return 6*b*b-6*b+(3*b*b-4*b+1)+(-6*b*b+6*b)+(3*b*b-2*b)},interpolate:function(b,d,c,e,f){b=0.5*(c-b);e=0.5*(e-d);var g=f*f;return(2*d-2*c+b+e)*f*g+(-3*d+3*c-2*b-e)*g+b*f+d}};
THREE.Curve.create=function(b,d){b.prototype=Object.create(THREE.Curve.prototype);b.prototype.getPoint=d;return b};THREE.LineCurve3=THREE.Curve.create(function(b,d){this.v1=b;this.v2=d},function(b){var d=new THREE.Vector3;d.subVectors(this.v2,this.v1);d.multiplyScalar(b);d.add(this.v1);return d});
THREE.QuadraticBezierCurve3=THREE.Curve.create(function(b,d,c){this.v0=b;this.v1=d;this.v2=c},function(b){var d,c;d=THREE.Shape.Utils.b2(b,this.v0.x,this.v1.x,this.v2.x);c=THREE.Shape.Utils.b2(b,this.v0.y,this.v1.y,this.v2.y);b=THREE.Shape.Utils.b2(b,this.v0.z,this.v1.z,this.v2.z);return new THREE.Vector3(d,c,b)});
THREE.CubicBezierCurve3=THREE.Curve.create(function(b,d,c,e){this.v0=b;this.v1=d;this.v2=c;this.v3=e},function(b){var d,c;d=THREE.Shape.Utils.b3(b,this.v0.x,this.v1.x,this.v2.x,this.v3.x);c=THREE.Shape.Utils.b3(b,this.v0.y,this.v1.y,this.v2.y,this.v3.y);b=THREE.Shape.Utils.b3(b,this.v0.z,this.v1.z,this.v2.z,this.v3.z);return new THREE.Vector3(d,c,b)});
THREE.SplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(b){var d=new THREE.Vector3,c=[],e=this.points,f;b*=e.length-1;f=Math.floor(b);b-=f;c[0]=0==f?f:f-1;c[1]=f;c[2]=f>e.length-2?e.length-1:f+1;c[3]=f>e.length-3?e.length-1:f+2;f=e[c[0]];var g=e[c[1]],h=e[c[2]],c=e[c[3]];d.x=THREE.Curve.Utils.interpolate(f.x,g.x,h.x,c.x,b);d.y=THREE.Curve.Utils.interpolate(f.y,g.y,h.y,c.y,b);d.z=THREE.Curve.Utils.interpolate(f.z,g.z,h.z,c.z,b);return d});
THREE.ClosedSplineCurve3=THREE.Curve.create(function(b){this.points=void 0==b?[]:b},function(b){var d=new THREE.Vector3,c=[],e=this.points,f;f=(e.length-0)*b;b=Math.floor(f);f-=b;b+=0<b?0:(Math.floor(Math.abs(b)/e.length)+1)*e.length;c[0]=(b-1)%e.length;c[1]=b%e.length;c[2]=(b+1)%e.length;c[3]=(b+2)%e.length;d.x=THREE.Curve.Utils.interpolate(e[c[0]].x,e[c[1]].x,e[c[2]].x,e[c[3]].x,f);d.y=THREE.Curve.Utils.interpolate(e[c[0]].y,e[c[1]].y,e[c[2]].y,e[c[3]].y,f);d.z=THREE.Curve.Utils.interpolate(e[c[0]].z,
e[c[1]].z,e[c[2]].z,e[c[3]].z,f);return d});THREE.CurvePath=function(){this.curves=[];this.bends=[];this.autoClose=!1};THREE.CurvePath.prototype=Object.create(THREE.Curve.prototype);THREE.CurvePath.prototype.add=function(b){this.curves.push(b)};THREE.CurvePath.prototype.checkConnection=function(){};THREE.CurvePath.prototype.closePath=function(){var b=this.curves[0].getPoint(0),d=this.curves[this.curves.length-1].getPoint(1);b.equals(d)||this.curves.push(new THREE.LineCurve(d,b))};
THREE.CurvePath.prototype.getPoint=function(b){var d=b*this.getLength(),c=this.getCurveLengths();for(b=0;b<c.length;){if(c[b]>=d)return d=c[b]-d,b=this.curves[b],d=1-d/b.getLength(),b.getPointAt(d);b++}return null};THREE.CurvePath.prototype.getLength=function(){var b=this.getCurveLengths();return b[b.length-1]};
THREE.CurvePath.prototype.getCurveLengths=function(){if(this.cacheLengths&&this.cacheLengths.length==this.curves.length)return this.cacheLengths;var b=[],d=0,c,e=this.curves.length;for(c=0;c<e;c++)d+=this.curves[c].getLength(),b.push(d);return this.cacheLengths=b};
THREE.CurvePath.prototype.getBoundingBox=function(){var b=this.getPoints(),d,c,e,f,g,h;d=c=Number.NEGATIVE_INFINITY;f=g=Number.POSITIVE_INFINITY;var k,l,p,q,r=b[0]instanceof THREE.Vector3;q=r?new THREE.Vector3:new THREE.Vector2;l=0;for(p=b.length;l<p;l++)k=b[l],k.x>d?d=k.x:k.x<f&&(f=k.x),k.y>c?c=k.y:k.y<g&&(g=k.y),r&&(k.z>e?e=k.z:k.z<h&&(h=k.z)),q.add(k);b={minX:f,minY:g,maxX:d,maxY:c,centroid:q.divideScalar(p)};r&&(b.maxZ=e,b.minZ=h);return b};
THREE.CurvePath.prototype.createPointsGeometry=function(b){b=this.getPoints(b,!0);return this.createGeometry(b)};THREE.CurvePath.prototype.createSpacedPointsGeometry=function(b){b=this.getSpacedPoints(b,!0);return this.createGeometry(b)};THREE.CurvePath.prototype.createGeometry=function(b){for(var d=new THREE.Geometry,c=0;c<b.length;c++)d.vertices.push(new THREE.Vector3(b[c].x,b[c].y,b[c].z||0));return d};THREE.CurvePath.prototype.addWrapPath=function(b){this.bends.push(b)};
THREE.CurvePath.prototype.getTransformedPoints=function(b,d){var c=this.getPoints(b),e,f;d||(d=this.bends);e=0;for(f=d.length;e<f;e++)c=this.getWrapPoints(c,d[e]);return c};THREE.CurvePath.prototype.getTransformedSpacedPoints=function(b,d){var c=this.getSpacedPoints(b),e,f;d||(d=this.bends);e=0;for(f=d.length;e<f;e++)c=this.getWrapPoints(c,d[e]);return c};
THREE.CurvePath.prototype.getWrapPoints=function(b,d){var c=this.getBoundingBox(),e,f,g,h,k,l;e=0;for(f=b.length;e<f;e++)g=b[e],h=g.x,k=g.y,l=h/c.maxX,l=d.getUtoTmapping(l,h),h=d.getPoint(l),k=d.getNormalVector(l).multiplyScalar(k),g.x=h.x+k.x,g.y=h.y+k.y;return b};THREE.Gyroscope=function(){THREE.Object3D.call(this)};THREE.Gyroscope.prototype=Object.create(THREE.Object3D.prototype);
THREE.Gyroscope.prototype.updateMatrixWorld=function(b){this.matrixAutoUpdate&&this.updateMatrix();if(this.matrixWorldNeedsUpdate||b)this.parent?(this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorld.decompose(this.translationWorld,this.rotationWorld,this.scaleWorld),this.matrix.decompose(this.translationObject,this.rotationObject,this.scaleObject),this.matrixWorld.makeFromPositionQuaternionScale(this.translationWorld,this.rotationObject,this.scaleWorld)):this.matrixWorld.copy(this.matrix),
this.matrixWorldNeedsUpdate=!1,b=!0;for(var d=0,c=this.children.length;d<c;d++)this.children[d].updateMatrixWorld(b)};THREE.Gyroscope.prototype.translationWorld=new THREE.Vector3;THREE.Gyroscope.prototype.translationObject=new THREE.Vector3;THREE.Gyroscope.prototype.rotationWorld=new THREE.Quaternion;THREE.Gyroscope.prototype.rotationObject=new THREE.Quaternion;THREE.Gyroscope.prototype.scaleWorld=new THREE.Vector3;THREE.Gyroscope.prototype.scaleObject=new THREE.Vector3;
THREE.Path=function(b){THREE.CurvePath.call(this);this.actions=[];b&&this.fromPoints(b)};THREE.Path.prototype=Object.create(THREE.CurvePath.prototype);THREE.PathActions={MOVE_TO:"moveTo",LINE_TO:"lineTo",QUADRATIC_CURVE_TO:"quadraticCurveTo",BEZIER_CURVE_TO:"bezierCurveTo",CSPLINE_THRU:"splineThru",ARC:"arc",ELLIPSE:"ellipse"};THREE.Path.prototype.fromPoints=function(b){this.moveTo(b[0].x,b[0].y);for(var d=1,c=b.length;d<c;d++)this.lineTo(b[d].x,b[d].y)};
THREE.Path.prototype.moveTo=function(b,d){var c=Array.prototype.slice.call(arguments);this.actions.push({action:THREE.PathActions.MOVE_TO,args:c})};THREE.Path.prototype.lineTo=function(b,d){var c=Array.prototype.slice.call(arguments),e=this.actions[this.actions.length-1].args,e=new THREE.LineCurve(new THREE.Vector2(e[e.length-2],e[e.length-1]),new THREE.Vector2(b,d));this.curves.push(e);this.actions.push({action:THREE.PathActions.LINE_TO,args:c})};
THREE.Path.prototype.quadraticCurveTo=function(b,d,c,e){var f=Array.prototype.slice.call(arguments),g=this.actions[this.actions.length-1].args,g=new THREE.QuadraticBezierCurve(new THREE.Vector2(g[g.length-2],g[g.length-1]),new THREE.Vector2(b,d),new THREE.Vector2(c,e));this.curves.push(g);this.actions.push({action:THREE.PathActions.QUADRATIC_CURVE_TO,args:f})};
THREE.Path.prototype.bezierCurveTo=function(b,d,c,e,f,g){var h=Array.prototype.slice.call(arguments),k=this.actions[this.actions.length-1].args,k=new THREE.CubicBezierCurve(new THREE.Vector2(k[k.length-2],k[k.length-1]),new THREE.Vector2(b,d),new THREE.Vector2(c,e),new THREE.Vector2(f,g));this.curves.push(k);this.actions.push({action:THREE.PathActions.BEZIER_CURVE_TO,args:h})};
THREE.Path.prototype.splineThru=function(b){var d=Array.prototype.slice.call(arguments),c=this.actions[this.actions.length-1].args,c=[new THREE.Vector2(c[c.length-2],c[c.length-1])];Array.prototype.push.apply(c,b);c=new THREE.SplineCurve(c);this.curves.push(c);this.actions.push({action:THREE.PathActions.CSPLINE_THRU,args:d})};THREE.Path.prototype.arc=function(b,d,c,e,f,g){var h=this.actions[this.actions.length-1].args;this.absarc(b+h[h.length-2],d+h[h.length-1],c,e,f,g)};
THREE.Path.prototype.absarc=function(b,d,c,e,f,g){this.absellipse(b,d,c,c,e,f,g)};THREE.Path.prototype.ellipse=function(b,d,c,e,f,g,h){var k=this.actions[this.actions.length-1].args;this.absellipse(b+k[k.length-2],d+k[k.length-1],c,e,f,g,h)};THREE.Path.prototype.absellipse=function(b,d,c,e,f,g,h){var k=Array.prototype.slice.call(arguments),l=new THREE.EllipseCurve(b,d,c,e,f,g,h);this.curves.push(l);l=l.getPoint(h?1:0);k.push(l.x);k.push(l.y);this.actions.push({action:THREE.PathActions.ELLIPSE,args:k})};
THREE.Path.prototype.getSpacedPoints=function(b){b||(b=40);for(var d=[],c=0;c<b;c++)d.push(this.getPoint(c/b));return d};
THREE.Path.prototype.getPoints=function(b,d){if(this.useSpacedPoints)return console.log("tata"),this.getSpacedPoints(b,d);b=b||12;var c=[],e,f,g,h,k,l,p,q,r,s,t,u,v;e=0;for(f=this.actions.length;e<f;e++)switch(g=this.actions[e],h=g.action,g=g.args,h){case THREE.PathActions.MOVE_TO:c.push(new THREE.Vector2(g[0],g[1]));break;case THREE.PathActions.LINE_TO:c.push(new THREE.Vector2(g[0],g[1]));break;case THREE.PathActions.QUADRATIC_CURVE_TO:k=g[2];l=g[3];r=g[0];s=g[1];0<c.length?(h=c[c.length-1],t=h.x,
u=h.y):(h=this.actions[e-1].args,t=h[h.length-2],u=h[h.length-1]);for(g=1;g<=b;g++)v=g/b,h=THREE.Shape.Utils.b2(v,t,r,k),v=THREE.Shape.Utils.b2(v,u,s,l),c.push(new THREE.Vector2(h,v));break;case THREE.PathActions.BEZIER_CURVE_TO:k=g[4];l=g[5];r=g[0];s=g[1];p=g[2];q=g[3];0<c.length?(h=c[c.length-1],t=h.x,u=h.y):(h=this.actions[e-1].args,t=h[h.length-2],u=h[h.length-1]);for(g=1;g<=b;g++)v=g/b,h=THREE.Shape.Utils.b3(v,t,r,p,k),v=THREE.Shape.Utils.b3(v,u,s,q,l),c.push(new THREE.Vector2(h,v));break;case THREE.PathActions.CSPLINE_THRU:h=
this.actions[e-1].args;v=[new THREE.Vector2(h[h.length-2],h[h.length-1])];h=b*g[0].length;v=v.concat(g[0]);v=new THREE.SplineCurve(v);for(g=1;g<=h;g++)c.push(v.getPointAt(g/h));break;case THREE.PathActions.ARC:k=g[0];l=g[1];s=g[2];p=g[3];h=g[4];r=!!g[5];t=h-p;u=2*b;for(g=1;g<=u;g++)v=g/u,r||(v=1-v),v=p+v*t,h=k+s*Math.cos(v),v=l+s*Math.sin(v),c.push(new THREE.Vector2(h,v));break;case THREE.PathActions.ELLIPSE:k=g[0];l=g[1];s=g[2];q=g[3];p=g[4];h=g[5];r=!!g[6];t=h-p;u=2*b;for(g=1;g<=u;g++)v=g/u,r||
(v=1-v),v=p+v*t,h=k+s*Math.cos(v),v=l+q*Math.sin(v),c.push(new THREE.Vector2(h,v))}e=c[c.length-1];1E-10>Math.abs(e.x-c[0].x)&&1E-10>Math.abs(e.y-c[0].y)&&c.splice(c.length-1,1);d&&c.push(c[0]);return c};
THREE.Path.prototype.toShapes=function(){var b,d,c,e,f=[],g=new THREE.Path;b=0;for(d=this.actions.length;b<d;b++)c=this.actions[b],e=c.args,c=c.action,c==THREE.PathActions.MOVE_TO&&0!=g.actions.length&&(f.push(g),g=new THREE.Path),g[c].apply(g,e);0!=g.actions.length&&f.push(g);if(0==f.length)return[];var h;e=[];b=!THREE.Shape.Utils.isClockWise(f[0].getPoints());if(1==f.length)return g=f[0],h=new THREE.Shape,h.actions=g.actions,h.curves=g.curves,e.push(h),e;if(b){h=new THREE.Shape;b=0;for(d=f.length;b<
d;b++)g=f[b],THREE.Shape.Utils.isClockWise(g.getPoints())?(h.actions=g.actions,h.curves=g.curves,e.push(h),h=new THREE.Shape):h.holes.push(g)}else{b=0;for(d=f.length;b<d;b++)g=f[b],THREE.Shape.Utils.isClockWise(g.getPoints())?(h&&e.push(h),h=new THREE.Shape,h.actions=g.actions,h.curves=g.curves):h.holes.push(g);e.push(h)}return e};THREE.Shape=function(){THREE.Path.apply(this,arguments);this.holes=[]};THREE.Shape.prototype=Object.create(THREE.Path.prototype);
THREE.Shape.prototype.extrude=function(b){return new THREE.ExtrudeGeometry(this,b)};THREE.Shape.prototype.makeGeometry=function(b){return new THREE.ShapeGeometry(this,b)};THREE.Shape.prototype.getPointsHoles=function(b){var d,c=this.holes.length,e=[];for(d=0;d<c;d++)e[d]=this.holes[d].getTransformedPoints(b,this.bends);return e};THREE.Shape.prototype.getSpacedPointsHoles=function(b){var d,c=this.holes.length,e=[];for(d=0;d<c;d++)e[d]=this.holes[d].getTransformedSpacedPoints(b,this.bends);return e};
THREE.Shape.prototype.extractAllPoints=function(b){return{shape:this.getTransformedPoints(b),holes:this.getPointsHoles(b)}};THREE.Shape.prototype.extractPoints=function(b){return this.useSpacedPoints?this.extractAllSpacedPoints(b):this.extractAllPoints(b)};THREE.Shape.prototype.extractAllSpacedPoints=function(b){return{shape:this.getTransformedSpacedPoints(b),holes:this.getSpacedPointsHoles(b)}};
THREE.Shape.Utils={removeHoles:function(b,d){var c=b.concat(),e=c.concat(),f,g,h,k,l,p,q,r,s,t,u=[];for(l=0;l<d.length;l++){p=d[l];Array.prototype.push.apply(e,p);g=Number.POSITIVE_INFINITY;for(f=0;f<p.length;f++){s=p[f];t=[];for(r=0;r<c.length;r++)q=c[r],q=s.distanceToSquared(q),t.push(q),q<g&&(g=q,h=f,k=r)}f=0<=k-1?k-1:c.length-1;g=0<=h-1?h-1:p.length-1;var v=[p[h],c[k],c[f]];r=THREE.FontUtils.Triangulate.area(v);var w=[p[h],p[g],c[k]];s=THREE.FontUtils.Triangulate.area(w);t=k;q=h;k+=1;h+=-1;0>
k&&(k+=c.length);k%=c.length;0>h&&(h+=p.length);h%=p.length;f=0<=k-1?k-1:c.length-1;g=0<=h-1?h-1:p.length-1;v=[p[h],c[k],c[f]];v=THREE.FontUtils.Triangulate.area(v);w=[p[h],p[g],c[k]];w=THREE.FontUtils.Triangulate.area(w);r+s>v+w&&(k=t,h=q,0>k&&(k+=c.length),k%=c.length,0>h&&(h+=p.length),h%=p.length,f=0<=k-1?k-1:c.length-1,g=0<=h-1?h-1:p.length-1);r=c.slice(0,k);s=c.slice(k);t=p.slice(h);q=p.slice(0,h);g=[p[h],p[g],c[k]];u.push([p[h],c[k],c[f]]);u.push(g);c=r.concat(t).concat(q).concat(s)}return{shape:c,
isolatedPts:u,allpoints:e}},triangulateShape:function(b,d){var c=THREE.Shape.Utils.removeHoles(b,d),e=c.allpoints,f=c.isolatedPts,c=THREE.FontUtils.Triangulate(c.shape,!1),g,h,k,l,p={};g=0;for(h=e.length;g<h;g++)l=e[g].x+":"+e[g].y,void 0!==p[l]&&console.log("Duplicate point",l),p[l]=g;g=0;for(h=c.length;g<h;g++){k=c[g];for(e=0;3>e;e++)l=k[e].x+":"+k[e].y,l=p[l],void 0!==l&&(k[e]=l)}g=0;for(h=f.length;g<h;g++){k=f[g];for(e=0;3>e;e++)l=k[e].x+":"+k[e].y,l=p[l],void 0!==l&&(k[e]=l)}return c.concat(f)},
isClockWise:function(b){return 0>THREE.FontUtils.Triangulate.area(b)},b2p0:function(b,d){var c=1-b;return c*c*d},b2p1:function(b,d){return 2*(1-b)*b*d},b2p2:function(b,d){return b*b*d},b2:function(b,d,c,e){return this.b2p0(b,d)+this.b2p1(b,c)+this.b2p2(b,e)},b3p0:function(b,d){var c=1-b;return c*c*c*d},b3p1:function(b,d){var c=1-b;return 3*c*c*b*d},b3p2:function(b,d){return 3*(1-b)*b*b*d},b3p3:function(b,d){return b*b*b*d},b3:function(b,d,c,e,f){return this.b3p0(b,d)+this.b3p1(b,c)+this.b3p2(b,e)+
this.b3p3(b,f)}};
THREE.AnimationHandler=function(){var b=[],d={},c={update:function(c){for(var e=0;e<b.length;e++)b[e].update(c)},addToUpdate:function(c){-1===b.indexOf(c)&&b.push(c)},removeFromUpdate:function(c){c=b.indexOf(c);-1!==c&&b.splice(c,1)},add:function(b){void 0!==d[b.name]&&console.log("THREE.AnimationHandler.add: Warning! "+b.name+" already exists in library. Overwriting.");d[b.name]=b;if(!0!==b.initialized){for(var c=0;c<b.hierarchy.length;c++){for(var e=0;e<b.hierarchy[c].keys.length;e++)if(0>b.hierarchy[c].keys[e].time&&
(b.hierarchy[c].keys[e].time=0),void 0!==b.hierarchy[c].keys[e].rot&&!(b.hierarchy[c].keys[e].rot instanceof THREE.Quaternion)){var k=b.hierarchy[c].keys[e].rot;b.hierarchy[c].keys[e].rot=new THREE.Quaternion(k[0],k[1],k[2],k[3])}if(b.hierarchy[c].keys.length&&void 0!==b.hierarchy[c].keys[0].morphTargets){k={};for(e=0;e<b.hierarchy[c].keys.length;e++)for(var l=0;l<b.hierarchy[c].keys[e].morphTargets.length;l++){var p=b.hierarchy[c].keys[e].morphTargets[l];k[p]=-1}b.hierarchy[c].usedMorphTargets=k;
for(e=0;e<b.hierarchy[c].keys.length;e++){var q={};for(p in k){for(l=0;l<b.hierarchy[c].keys[e].morphTargets.length;l++)if(b.hierarchy[c].keys[e].morphTargets[l]===p){q[p]=b.hierarchy[c].keys[e].morphTargetsInfluences[l];break}l===b.hierarchy[c].keys[e].morphTargets.length&&(q[p]=0)}b.hierarchy[c].keys[e].morphTargetsInfluences=q}}for(e=1;e<b.hierarchy[c].keys.length;e++)b.hierarchy[c].keys[e].time===b.hierarchy[c].keys[e-1].time&&(b.hierarchy[c].keys.splice(e,1),e--);for(e=0;e<b.hierarchy[c].keys.length;e++)b.hierarchy[c].keys[e].index=
e}e=parseInt(b.length*b.fps,10);b.JIT={};b.JIT.hierarchy=[];for(c=0;c<b.hierarchy.length;c++)b.JIT.hierarchy.push(Array(e));b.initialized=!0}},get:function(b){if("string"===typeof b){if(d[b])return d[b];console.log("THREE.AnimationHandler.get: Couldn't find animation "+b);return null}},parse:function(b){var c=[];if(b instanceof THREE.SkinnedMesh)for(var d=0;d<b.bones.length;d++)c.push(b.bones[d]);else e(b,c);return c}},e=function(b,c){c.push(b);for(var d=0;d<b.children.length;d++)e(b.children[d],
c)};c.LINEAR=0;c.CATMULLROM=1;c.CATMULLROM_FORWARD=2;return c}();THREE.Animation=function(b,d,c){this.root=b;this.data=THREE.AnimationHandler.get(d);this.hierarchy=THREE.AnimationHandler.parse(b);this.currentTime=0;this.timeScale=1;this.isPlaying=!1;this.loop=this.isPaused=!0;this.interpolationType=void 0!==c?c:THREE.AnimationHandler.LINEAR;this.points=[];this.target=new THREE.Vector3};
THREE.Animation.prototype.play=function(b,d){if(!1===this.isPlaying){this.isPlaying=!0;this.loop=void 0!==b?b:!0;this.currentTime=void 0!==d?d:0;var c,e=this.hierarchy.length,f;for(c=0;c<e;c++){f=this.hierarchy[c];this.interpolationType!==THREE.AnimationHandler.CATMULLROM_FORWARD&&(f.useQuaternion=!0);f.matrixAutoUpdate=!0;void 0===f.animationCache&&(f.animationCache={},f.animationCache.prevKey={pos:0,rot:0,scl:0},f.animationCache.nextKey={pos:0,rot:0,scl:0},f.animationCache.originalMatrix=f instanceof
THREE.Bone?f.skinMatrix:f.matrix);var g=f.animationCache.prevKey;f=f.animationCache.nextKey;g.pos=this.data.hierarchy[c].keys[0];g.rot=this.data.hierarchy[c].keys[0];g.scl=this.data.hierarchy[c].keys[0];f.pos=this.getNextKeyWith("pos",c,1);f.rot=this.getNextKeyWith("rot",c,1);f.scl=this.getNextKeyWith("scl",c,1)}this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};
THREE.Animation.prototype.pause=function(){!0===this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};THREE.Animation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this)};
THREE.Animation.prototype.update=function(b){if(!1!==this.isPlaying){var d=["pos","rot","scl"],c,e,f,g,h,k,l,p,q;q=this.currentTime+=b*this.timeScale;p=this.currentTime%=this.data.length;parseInt(Math.min(p*this.data.fps,this.data.length*this.data.fps),10);for(var r=0,s=this.hierarchy.length;r<s;r++){b=this.hierarchy[r];l=b.animationCache;for(var t=0;3>t;t++){c=d[t];h=l.prevKey[c];k=l.nextKey[c];if(k.time<=q){if(p<q)if(this.loop){h=this.data.hierarchy[r].keys[0];for(k=this.getNextKeyWith(c,r,1);k.time<
p;)h=k,k=this.getNextKeyWith(c,r,k.index+1)}else{this.stop();return}else{do h=k,k=this.getNextKeyWith(c,r,k.index+1);while(k.time<p)}l.prevKey[c]=h;l.nextKey[c]=k}b.matrixAutoUpdate=!0;b.matrixWorldNeedsUpdate=!0;e=(p-h.time)/(k.time-h.time);f=h[c];g=k[c];if(0>e||1<e)console.log("THREE.Animation.update: Warning! Scale out of bounds:"+e+" on bone "+r),e=0>e?0:1;if("pos"===c)if(c=b.position,this.interpolationType===THREE.AnimationHandler.LINEAR)c.x=f[0]+(g[0]-f[0])*e,c.y=f[1]+(g[1]-f[1])*e,c.z=f[2]+
(g[2]-f[2])*e;else{if(this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD)this.points[0]=this.getPrevKeyWith("pos",r,h.index-1).pos,this.points[1]=f,this.points[2]=g,this.points[3]=this.getNextKeyWith("pos",r,k.index+1).pos,e=0.33*e+0.33,f=this.interpolateCatmullRom(this.points,e),c.x=f[0],c.y=f[1],c.z=f[2],this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD&&(e=this.interpolateCatmullRom(this.points,1.01*e),
this.target.set(e[0],e[1],e[2]),this.target.sub(c),this.target.y=0,this.target.normalize(),e=Math.atan2(this.target.x,this.target.z),b.rotation.set(0,e,0))}else"rot"===c?THREE.Quaternion.slerp(f,g,b.quaternion,e):"scl"===c&&(c=b.scale,c.x=f[0]+(g[0]-f[0])*e,c.y=f[1]+(g[1]-f[1])*e,c.z=f[2]+(g[2]-f[2])*e)}}}};
THREE.Animation.prototype.interpolateCatmullRom=function(b,d){var c=[],e=[],f,g,h,k,l,p;f=(b.length-1)*d;g=Math.floor(f);f-=g;c[0]=0===g?g:g-1;c[1]=g;c[2]=g>b.length-2?g:g+1;c[3]=g>b.length-3?g:g+2;g=b[c[0]];k=b[c[1]];l=b[c[2]];p=b[c[3]];c=f*f;h=f*c;e[0]=this.interpolate(g[0],k[0],l[0],p[0],f,c,h);e[1]=this.interpolate(g[1],k[1],l[1],p[1],f,c,h);e[2]=this.interpolate(g[2],k[2],l[2],p[2],f,c,h);return e};
THREE.Animation.prototype.interpolate=function(b,d,c,e,f,g,h){b=0.5*(c-b);e=0.5*(e-d);return(2*(d-c)+b+e)*h+(-3*(d-c)-2*b-e)*g+b*f+d};THREE.Animation.prototype.getNextKeyWith=function(b,d,c){var e=this.data.hierarchy[d].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?c<e.length-1?c:e.length-1:c%e.length;c<e.length;c++)if(void 0!==e[c][b])return e[c];return this.data.hierarchy[d].keys[0]};
THREE.Animation.prototype.getPrevKeyWith=function(b,d,c){var e=this.data.hierarchy[d].keys;for(c=this.interpolationType===THREE.AnimationHandler.CATMULLROM||this.interpolationType===THREE.AnimationHandler.CATMULLROM_FORWARD?0<c?c:0:0<=c?c:c+e.length;0<=c;c--)if(void 0!==e[c][b])return e[c];return this.data.hierarchy[d].keys[e.length-1]};
THREE.KeyFrameAnimation=function(b,d,c){this.root=b;this.data=THREE.AnimationHandler.get(d);this.hierarchy=THREE.AnimationHandler.parse(b);this.currentTime=0;this.timeScale=0.001;this.isPlaying=!1;this.loop=this.isPaused=!0;this.JITCompile=void 0!==c?c:!0;b=0;for(d=this.hierarchy.length;b<d;b++){c=this.data.hierarchy[b].sids;var e=this.hierarchy[b];if(this.data.hierarchy[b].keys.length&&c){for(var f=0;f<c.length;f++){var g=c[f],h=this.getNextKeyWith(g,b,0);h&&h.apply(g)}e.matrixAutoUpdate=!1;this.data.hierarchy[b].node.updateMatrix();
e.matrixWorldNeedsUpdate=!0}}};
THREE.KeyFrameAnimation.prototype.play=function(b,d){if(!this.isPlaying){this.isPlaying=!0;this.loop=void 0!==b?b:!0;this.currentTime=void 0!==d?d:0;this.startTimeMs=d;this.startTime=1E7;this.endTime=-this.startTime;var c,e=this.hierarchy.length,f,g;for(c=0;c<e;c++)f=this.hierarchy[c],g=this.data.hierarchy[c],f.useQuaternion=!0,void 0===g.animationCache&&(g.animationCache={},g.animationCache.prevKey=null,g.animationCache.nextKey=null,g.animationCache.originalMatrix=f instanceof THREE.Bone?f.skinMatrix:
f.matrix),f=this.data.hierarchy[c].keys,f.length&&(g.animationCache.prevKey=f[0],g.animationCache.nextKey=f[1],this.startTime=Math.min(f[0].time,this.startTime),this.endTime=Math.max(f[f.length-1].time,this.endTime));this.update(0)}this.isPaused=!1;THREE.AnimationHandler.addToUpdate(this)};THREE.KeyFrameAnimation.prototype.pause=function(){this.isPaused?THREE.AnimationHandler.addToUpdate(this):THREE.AnimationHandler.removeFromUpdate(this);this.isPaused=!this.isPaused};
THREE.KeyFrameAnimation.prototype.stop=function(){this.isPaused=this.isPlaying=!1;THREE.AnimationHandler.removeFromUpdate(this);for(var b=0;b<this.data.hierarchy.length;b++){var d=this.hierarchy[b],c=this.data.hierarchy[b];if(void 0!==c.animationCache){var e=c.animationCache.originalMatrix;d instanceof THREE.Bone?(e.copy(d.skinMatrix),d.skinMatrix=e):(e.copy(d.matrix),d.matrix=e);delete c.animationCache}}};
THREE.KeyFrameAnimation.prototype.update=function(b){if(this.isPlaying){var d,c,e,f,g=this.data.JIT.hierarchy,h,k,l;k=this.currentTime+=b*this.timeScale;h=this.currentTime%=this.data.length;h<this.startTimeMs&&(h=this.currentTime=this.startTimeMs+h);f=parseInt(Math.min(h*this.data.fps,this.data.length*this.data.fps),10);if((l=h<k)&&!this.loop){b=0;for(var p=this.hierarchy.length;b<p;b++){var q=this.data.hierarchy[b].keys,g=this.data.hierarchy[b].sids;e=q.length-1;f=this.hierarchy[b];if(q.length){for(q=
0;q<g.length;q++)h=g[q],(k=this.getPrevKeyWith(h,b,e))&&k.apply(h);this.data.hierarchy[b].node.updateMatrix();f.matrixWorldNeedsUpdate=!0}}this.stop()}else if(!(h<this.startTime)){b=0;for(p=this.hierarchy.length;b<p;b++){e=this.hierarchy[b];d=this.data.hierarchy[b];var q=d.keys,r=d.animationCache;if(this.JITCompile&&void 0!==g[b][f])e instanceof THREE.Bone?(e.skinMatrix=g[b][f],e.matrixWorldNeedsUpdate=!1):(e.matrix=g[b][f],e.matrixWorldNeedsUpdate=!0);else if(q.length){this.JITCompile&&r&&(e instanceof
THREE.Bone?e.skinMatrix=r.originalMatrix:e.matrix=r.originalMatrix);d=r.prevKey;c=r.nextKey;if(d&&c){if(c.time<=k){if(l&&this.loop){d=q[0];for(c=q[1];c.time<h;)d=c,c=q[d.index+1]}else if(!l)for(var s=q.length-1;c.time<h&&c.index!==s;)d=c,c=q[d.index+1];r.prevKey=d;r.nextKey=c}c.time>=h?d.interpolate(c,h):d.interpolate(c,c.time)}this.data.hierarchy[b].node.updateMatrix();e.matrixWorldNeedsUpdate=!0}}if(this.JITCompile&&void 0===g[0][f]){this.hierarchy[0].updateMatrixWorld(!0);for(b=0;b<this.hierarchy.length;b++)g[b][f]=
this.hierarchy[b]instanceof THREE.Bone?this.hierarchy[b].skinMatrix.clone():this.hierarchy[b].matrix.clone()}}}};THREE.KeyFrameAnimation.prototype.getNextKeyWith=function(b,d,c){d=this.data.hierarchy[d].keys;for(c%=d.length;c<d.length;c++)if(d[c].hasTarget(b))return d[c];return d[0]};THREE.KeyFrameAnimation.prototype.getPrevKeyWith=function(b,d,c){d=this.data.hierarchy[d].keys;for(c=0<=c?c:c+d.length;0<=c;c--)if(d[c].hasTarget(b))return d[c];return d[d.length-1]};
THREE.CubeCamera=function(b,d,c){THREE.Object3D.call(this);var e=new THREE.PerspectiveCamera(90,1,b,d);e.up.set(0,-1,0);e.lookAt(new THREE.Vector3(1,0,0));this.add(e);var f=new THREE.PerspectiveCamera(90,1,b,d);f.up.set(0,-1,0);f.lookAt(new THREE.Vector3(-1,0,0));this.add(f);var g=new THREE.PerspectiveCamera(90,1,b,d);g.up.set(0,0,1);g.lookAt(new THREE.Vector3(0,1,0));this.add(g);var h=new THREE.PerspectiveCamera(90,1,b,d);h.up.set(0,0,-1);h.lookAt(new THREE.Vector3(0,-1,0));this.add(h);var k=new THREE.PerspectiveCamera(90,
1,b,d);k.up.set(0,-1,0);k.lookAt(new THREE.Vector3(0,0,1));this.add(k);var l=new THREE.PerspectiveCamera(90,1,b,d);l.up.set(0,-1,0);l.lookAt(new THREE.Vector3(0,0,-1));this.add(l);this.renderTarget=new THREE.WebGLRenderTargetCube(c,c,{format:THREE.RGBFormat,magFilter:THREE.LinearFilter,minFilter:THREE.LinearFilter});this.updateCubeMap=function(b,c){var d=this.renderTarget,s=d.generateMipmaps;d.generateMipmaps=!1;d.activeCubeFace=0;b.render(c,e,d);d.activeCubeFace=1;b.render(c,f,d);d.activeCubeFace=
2;b.render(c,g,d);d.activeCubeFace=3;b.render(c,h,d);d.activeCubeFace=4;b.render(c,k,d);d.generateMipmaps=s;d.activeCubeFace=5;b.render(c,l,d)}};THREE.CubeCamera.prototype=Object.create(THREE.Object3D.prototype);THREE.CombinedCamera=function(b,d,c,e,f,g,h){THREE.Camera.call(this);this.fov=c;this.left=-b/2;this.right=b/2;this.top=d/2;this.bottom=-d/2;this.cameraO=new THREE.OrthographicCamera(b/-2,b/2,d/2,d/-2,g,h);this.cameraP=new THREE.PerspectiveCamera(c,b/d,e,f);this.zoom=1;this.toPerspective()};
THREE.CombinedCamera.prototype=Object.create(THREE.Camera.prototype);THREE.CombinedCamera.prototype.toPerspective=function(){this.near=this.cameraP.near;this.far=this.cameraP.far;this.cameraP.fov=this.fov/this.zoom;this.cameraP.updateProjectionMatrix();this.projectionMatrix=this.cameraP.projectionMatrix;this.inPerspectiveMode=!0;this.inOrthographicMode=!1};
THREE.CombinedCamera.prototype.toOrthographic=function(){var b=this.cameraP.aspect,d=(this.cameraP.near+this.cameraP.far)/2,d=Math.tan(this.fov/2)*d,b=2*d*b/2,d=d/this.zoom,b=b/this.zoom;this.cameraO.left=-b;this.cameraO.right=b;this.cameraO.top=d;this.cameraO.bottom=-d;this.cameraO.updateProjectionMatrix();this.near=this.cameraO.near;this.far=this.cameraO.far;this.projectionMatrix=this.cameraO.projectionMatrix;this.inPerspectiveMode=!1;this.inOrthographicMode=!0};
THREE.CombinedCamera.prototype.setSize=function(b,d){this.cameraP.aspect=b/d;this.left=-b/2;this.right=b/2;this.top=d/2;this.bottom=-d/2};THREE.CombinedCamera.prototype.setFov=function(b){this.fov=b;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.updateProjectionMatrix=function(){this.inPerspectiveMode?this.toPerspective():(this.toPerspective(),this.toOrthographic())};
THREE.CombinedCamera.prototype.setLens=function(b,d){void 0===d&&(d=24);var c=2*THREE.Math.radToDeg(Math.atan(d/(2*b)));this.setFov(c);return c};THREE.CombinedCamera.prototype.setZoom=function(b){this.zoom=b;this.inPerspectiveMode?this.toPerspective():this.toOrthographic()};THREE.CombinedCamera.prototype.toFrontView=function(){this.rotation.x=0;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toBackView=function(){this.rotation.x=0;this.rotation.y=Math.PI;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toLeftView=function(){this.rotation.x=0;this.rotation.y=-Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toRightView=function(){this.rotation.x=0;this.rotation.y=Math.PI/2;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CombinedCamera.prototype.toTopView=function(){this.rotation.x=-Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};THREE.CombinedCamera.prototype.toBottomView=function(){this.rotation.x=Math.PI/2;this.rotation.y=0;this.rotation.z=0;this.rotationAutoUpdate=!1};
THREE.CircleGeometry=function(b,d,c,e){THREE.Geometry.call(this);b=b||50;c=void 0!==c?c:0;e=void 0!==e?e:2*Math.PI;d=void 0!==d?Math.max(3,d):8;var f,g=[];f=new THREE.Vector3;var h=new THREE.Vector2(0.5,0.5);this.vertices.push(f);g.push(h);for(f=0;f<=d;f++){var k=new THREE.Vector3,l=c+f/d*e;k.x=b*Math.cos(l);k.y=b*Math.sin(l);this.vertices.push(k);g.push(new THREE.Vector2((k.x/b+1)/2,(k.y/b+1)/2))}c=new THREE.Vector3(0,0,1);for(f=1;f<=d;f++)this.faces.push(new THREE.Face3(f,f+1,0,[c,c,c])),this.faceVertexUvs[0].push([g[f],
g[f+1],h]);this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,b)};THREE.CircleGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CubeGeometry=function(b,d,c,e,f,g){function h(b,c,e,d,f,g,h,v){var w,y=k.widthSegments,z=k.heightSegments,B=f/2,A=g/2,K=k.vertices.length;if("x"===b&&"y"===c||"y"===b&&"x"===c)w="z";else if("x"===b&&"z"===c||"z"===b&&"x"===c)w="y",z=k.depthSegments;else if("z"===b&&"y"===c||"y"===b&&"z"===c)w="x",y=k.depthSegments;var O=y+1,E=z+1,F=f/y,U=g/z,H=new THREE.Vector3;H[w]=0<h?1:-1;for(f=0;f<E;f++)for(g=0;g<O;g++){var G=new THREE.Vector3;G[b]=(g*F-B)*e;G[c]=(f*U-A)*d;G[w]=h;k.vertices.push(G)}for(f=
0;f<z;f++)for(g=0;g<y;g++)b=new THREE.Face4(g+O*f+K,g+O*(f+1)+K,g+1+O*(f+1)+K,g+1+O*f+K),b.normal.copy(H),b.vertexNormals.push(H.clone(),H.clone(),H.clone(),H.clone()),b.materialIndex=v,k.faces.push(b),k.faceVertexUvs[0].push([new THREE.Vector2(g/y,1-f/z),new THREE.Vector2(g/y,1-(f+1)/z),new THREE.Vector2((g+1)/y,1-(f+1)/z),new THREE.Vector2((g+1)/y,1-f/z)])}THREE.Geometry.call(this);var k=this;this.width=b;this.height=d;this.depth=c;this.widthSegments=e||1;this.heightSegments=f||1;this.depthSegments=
g||1;b=this.width/2;d=this.height/2;c=this.depth/2;h("z","y",-1,-1,this.depth,this.height,b,0);h("z","y",1,-1,this.depth,this.height,-b,1);h("x","z",1,1,this.width,this.depth,d,2);h("x","z",1,-1,this.width,this.depth,-d,3);h("x","y",1,-1,this.width,this.height,c,4);h("x","y",-1,-1,this.width,this.height,-c,5);this.computeCentroids();this.mergeVertices()};THREE.CubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.CylinderGeometry=function(b,d,c,e,f,g){THREE.Geometry.call(this);this.radiusTop=b=void 0!==b?b:20;this.radiusBottom=d=void 0!==d?d:20;this.height=c=void 0!==c?c:100;this.radiusSegments=e=e||8;this.heightSegments=f=f||1;this.openEnded=g=void 0!==g?g:!1;var h=c/2,k,l,p=[],q=[];for(l=0;l<=f;l++){var r=[],s=[],t=l/f,u=t*(d-b)+b;for(k=0;k<=e;k++){var v=k/e,w=new THREE.Vector3;w.x=u*Math.sin(2*v*Math.PI);w.y=-t*c+h;w.z=u*Math.cos(2*v*Math.PI);this.vertices.push(w);r.push(this.vertices.length-1);s.push(new THREE.Vector2(v,
1-t))}p.push(r);q.push(s)}c=(d-b)/c;for(k=0;k<e;k++){0!==b?(r=this.vertices[p[0][k]].clone(),s=this.vertices[p[0][k+1]].clone()):(r=this.vertices[p[1][k]].clone(),s=this.vertices[p[1][k+1]].clone());r.setY(Math.sqrt(r.x*r.x+r.z*r.z)*c).normalize();s.setY(Math.sqrt(s.x*s.x+s.z*s.z)*c).normalize();for(l=0;l<f;l++){var t=p[l][k],u=p[l+1][k],v=p[l+1][k+1],w=p[l][k+1],y=r.clone(),z=r.clone(),B=s.clone(),A=s.clone(),K=q[l][k].clone(),O=q[l+1][k].clone(),E=q[l+1][k+1].clone(),F=q[l][k+1].clone();this.faces.push(new THREE.Face4(t,
u,v,w,[y,z,B,A]));this.faceVertexUvs[0].push([K,O,E,F])}}if(!1===g&&0<b){this.vertices.push(new THREE.Vector3(0,h,0));for(k=0;k<e;k++)t=p[0][k],u=p[0][k+1],v=this.vertices.length-1,y=new THREE.Vector3(0,1,0),z=new THREE.Vector3(0,1,0),B=new THREE.Vector3(0,1,0),K=q[0][k].clone(),O=q[0][k+1].clone(),E=new THREE.Vector2(O.u,0),this.faces.push(new THREE.Face3(t,u,v,[y,z,B])),this.faceVertexUvs[0].push([K,O,E])}if(!1===g&&0<d){this.vertices.push(new THREE.Vector3(0,-h,0));for(k=0;k<e;k++)t=p[l][k+1],
u=p[l][k],v=this.vertices.length-1,y=new THREE.Vector3(0,-1,0),z=new THREE.Vector3(0,-1,0),B=new THREE.Vector3(0,-1,0),K=q[l][k+1].clone(),O=q[l][k].clone(),E=new THREE.Vector2(O.u,1),this.faces.push(new THREE.Face3(t,u,v,[y,z,B])),this.faceVertexUvs[0].push([K,O,E])}this.computeCentroids();this.computeFaceNormals()};THREE.CylinderGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ExtrudeGeometry=function(b,d){"undefined"!==typeof b&&(THREE.Geometry.call(this),b=b instanceof Array?b:[b],this.shapebb=b[b.length-1].getBoundingBox(),this.addShapeList(b,d),this.computeCentroids(),this.computeFaceNormals())};THREE.ExtrudeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ExtrudeGeometry.prototype.addShapeList=function(b,d){for(var c=b.length,e=0;e<c;e++)this.addShape(b[e],d)};
THREE.ExtrudeGeometry.prototype.addShape=function(b,d){function c(b,c,e){c||console.log("die");return c.clone().multiplyScalar(e).add(b)}function e(b,c,e){var d=THREE.ExtrudeGeometry.__v1,f=THREE.ExtrudeGeometry.__v2,g=THREE.ExtrudeGeometry.__v3,h=THREE.ExtrudeGeometry.__v4,k=THREE.ExtrudeGeometry.__v5,l=THREE.ExtrudeGeometry.__v6;d.set(b.x-c.x,b.y-c.y);f.set(b.x-e.x,b.y-e.y);d=d.normalize();f=f.normalize();g.set(-d.y,d.x);h.set(f.y,-f.x);k.copy(b).add(g);l.copy(b).add(h);if(k.equals(l))return h.clone();
k.copy(c).add(g);l.copy(e).add(h);g=d.dot(h);h=l.sub(k).dot(h);0===g&&(console.log("Either infinite or no solutions!"),0===h?console.log("Its finite solutions."):console.log("Too bad, no solutions."));h/=g;return 0>h?(c=Math.atan2(c.y-b.y,c.x-b.x),b=Math.atan2(e.y-b.y,e.x-b.x),c>b&&(b+=2*Math.PI),e=(c+b)/2,b=-Math.cos(e),e=-Math.sin(e),new THREE.Vector2(b,e)):d.multiplyScalar(h).add(k).sub(b).clone()}function f(c,e){var f,g;for(R=c.length;0<=--R;){f=R;g=R-1;0>g&&(g=c.length-1);for(var h=0,k=t+2*q,
h=0;h<k;h++){var l=Z*h,p=Z*(h+1),r=e+f+l,l=e+g+l,s=e+g+p,p=e+f+p,u=c,v=h,w=k,y=f,A=g,r=r+aa,l=l+aa,s=s+aa,p=p+aa;G.faces.push(new THREE.Face4(r,l,s,p,null,null,z));r=B.generateSideWallUV(G,b,u,d,r,l,s,p,v,w,y,A);G.faceVertexUvs[0].push(r)}}}function g(b,c,e){G.vertices.push(new THREE.Vector3(b,c,e))}function h(c,e,f,g){c+=aa;e+=aa;f+=aa;G.faces.push(new THREE.Face3(c,e,f,null,null,y));c=g?B.generateBottomUV(G,b,d,c,e,f):B.generateTopUV(G,b,d,c,e,f);G.faceVertexUvs[0].push(c)}var k=void 0!==d.amount?
d.amount:100,l=void 0!==d.bevelThickness?d.bevelThickness:6,p=void 0!==d.bevelSize?d.bevelSize:l-2,q=void 0!==d.bevelSegments?d.bevelSegments:3,r=void 0!==d.bevelEnabled?d.bevelEnabled:!0,s=void 0!==d.curveSegments?d.curveSegments:12,t=void 0!==d.steps?d.steps:1,u=d.extrudePath,v,w=!1,y=d.material,z=d.extrudeMaterial,B=void 0!==d.UVGenerator?d.UVGenerator:THREE.ExtrudeGeometry.WorldUVGenerator,A,K,O,E;u&&(v=u.getSpacedPoints(t),w=!0,r=!1,A=void 0!==d.frames?d.frames:new THREE.TubeGeometry.FrenetFrames(u,
t,!1),K=new THREE.Vector3,O=new THREE.Vector3,E=new THREE.Vector3);r||(p=l=q=0);var F,U,H,G=this,aa=this.vertices.length,s=b.extractPoints(s),D=s.shape,s=s.holes;if(u=!THREE.Shape.Utils.isClockWise(D)){D=D.reverse();U=0;for(H=s.length;U<H;U++)F=s[U],THREE.Shape.Utils.isClockWise(F)&&(s[U]=F.reverse());u=!1}var M=THREE.Shape.Utils.triangulateShape(D,s),u=D;U=0;for(H=s.length;U<H;U++)F=s[U],D=D.concat(F);var I,Q,V,C,Z=D.length,N=M.length,ca=[],R=0,X=u.length;I=X-1;for(Q=R+1;R<X;R++,I++,Q++)I===X&&(I=
0),Q===X&&(Q=0),ca[R]=e(u[R],u[I],u[Q]);var ba=[],na,S=ca.concat();U=0;for(H=s.length;U<H;U++){F=s[U];na=[];R=0;X=F.length;I=X-1;for(Q=R+1;R<X;R++,I++,Q++)I===X&&(I=0),Q===X&&(Q=0),na[R]=e(F[R],F[I],F[Q]);ba.push(na);S=S.concat(na)}for(I=0;I<q;I++){F=I/q;V=l*(1-F);Q=p*Math.sin(F*Math.PI/2);R=0;for(X=u.length;R<X;R++)C=c(u[R],ca[R],Q),g(C.x,C.y,-V);U=0;for(H=s.length;U<H;U++){F=s[U];na=ba[U];R=0;for(X=F.length;R<X;R++)C=c(F[R],na[R],Q),g(C.x,C.y,-V)}}Q=p;for(R=0;R<Z;R++)C=r?c(D[R],S[R],Q):D[R],w?(O.copy(A.normals[0]).multiplyScalar(C.x),
K.copy(A.binormals[0]).multiplyScalar(C.y),E.copy(v[0]).add(O).add(K),g(E.x,E.y,E.z)):g(C.x,C.y,0);for(F=1;F<=t;F++)for(R=0;R<Z;R++)C=r?c(D[R],S[R],Q):D[R],w?(O.copy(A.normals[F]).multiplyScalar(C.x),K.copy(A.binormals[F]).multiplyScalar(C.y),E.copy(v[F]).add(O).add(K),g(E.x,E.y,E.z)):g(C.x,C.y,k/t*F);for(I=q-1;0<=I;I--){F=I/q;V=l*(1-F);Q=p*Math.sin(F*Math.PI/2);R=0;for(X=u.length;R<X;R++)C=c(u[R],ca[R],Q),g(C.x,C.y,k+V);U=0;for(H=s.length;U<H;U++){F=s[U];na=ba[U];R=0;for(X=F.length;R<X;R++)C=c(F[R],
na[R],Q),w?g(C.x,C.y+v[t-1].y,v[t-1].x+V):g(C.x,C.y,k+V)}}if(r){l=0*Z;for(R=0;R<N;R++)k=M[R],h(k[2]+l,k[1]+l,k[0]+l,!0);l=Z*(t+2*q);for(R=0;R<N;R++)k=M[R],h(k[0]+l,k[1]+l,k[2]+l,!1)}else{for(R=0;R<N;R++)k=M[R],h(k[2],k[1],k[0],!0);for(R=0;R<N;R++)k=M[R],h(k[0]+Z*t,k[1]+Z*t,k[2]+Z*t,!1)}k=0;f(u,k);k+=u.length;U=0;for(H=s.length;U<H;U++)F=s[U],f(F,k),k+=F.length};
THREE.ExtrudeGeometry.WorldUVGenerator={generateTopUV:function(b,d,c,e,f,g){d=b.vertices[f].x;f=b.vertices[f].y;c=b.vertices[g].x;g=b.vertices[g].y;return[new THREE.Vector2(b.vertices[e].x,b.vertices[e].y),new THREE.Vector2(d,f),new THREE.Vector2(c,g)]},generateBottomUV:function(b,d,c,e,f,g){return this.generateTopUV(b,d,c,e,f,g)},generateSideWallUV:function(b,d,c,e,f,g,h,k){d=b.vertices[f].x;c=b.vertices[f].y;f=b.vertices[f].z;e=b.vertices[g].x;var l=b.vertices[g].y;g=b.vertices[g].z;var p=b.vertices[h].x,
q=b.vertices[h].y;h=b.vertices[h].z;var r=b.vertices[k].x,s=b.vertices[k].y;b=b.vertices[k].z;return 0.01>Math.abs(c-l)?[new THREE.Vector2(d,1-f),new THREE.Vector2(e,1-g),new THREE.Vector2(p,1-h),new THREE.Vector2(r,1-b)]:[new THREE.Vector2(c,1-f),new THREE.Vector2(l,1-g),new THREE.Vector2(q,1-h),new THREE.Vector2(s,1-b)]}};THREE.ExtrudeGeometry.__v1=new THREE.Vector2;THREE.ExtrudeGeometry.__v2=new THREE.Vector2;THREE.ExtrudeGeometry.__v3=new THREE.Vector2;THREE.ExtrudeGeometry.__v4=new THREE.Vector2;
THREE.ExtrudeGeometry.__v5=new THREE.Vector2;THREE.ExtrudeGeometry.__v6=new THREE.Vector2;THREE.ShapeGeometry=function(b,d){THREE.Geometry.call(this);!1===b instanceof Array&&(b=[b]);this.shapebb=b[b.length-1].getBoundingBox();this.addShapeList(b,d);this.computeCentroids();this.computeFaceNormals()};THREE.ShapeGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.ShapeGeometry.prototype.addShapeList=function(b,d){for(var c=0,e=b.length;c<e;c++)this.addShape(b[c],d);return this};
THREE.ShapeGeometry.prototype.addShape=function(b,d){void 0===d&&(d={});var c=d.material,e=void 0===d.UVGenerator?THREE.ExtrudeGeometry.WorldUVGenerator:d.UVGenerator,f,g,h,k=this.vertices.length;f=b.extractPoints(void 0!==d.curveSegments?d.curveSegments:12);var l=f.shape,p=f.holes;if(!THREE.Shape.Utils.isClockWise(l)){l=l.reverse();f=0;for(g=p.length;f<g;f++)h=p[f],THREE.Shape.Utils.isClockWise(h)&&(p[f]=h.reverse())}var q=THREE.Shape.Utils.triangulateShape(l,p);f=0;for(g=p.length;f<g;f++)h=p[f],
l=l.concat(h);p=l.length;g=q.length;for(f=0;f<p;f++)h=l[f],this.vertices.push(new THREE.Vector3(h.x,h.y,0));for(f=0;f<g;f++)p=q[f],l=p[0]+k,h=p[1]+k,p=p[2]+k,this.faces.push(new THREE.Face3(l,h,p,null,null,c)),this.faceVertexUvs[0].push(e.generateBottomUV(this,b,d,l,h,p))};
THREE.LatheGeometry=function(b,d,c,e){THREE.Geometry.call(this);d=d||12;c=c||0;e=e||2*Math.PI;for(var f=1/(b.length-1),g=1/d,h=0,k=d;h<=k;h++)for(var l=c+h*g*e,p=Math.cos(l),q=Math.sin(l),l=0,r=b.length;l<r;l++){var s=b[l],t=new THREE.Vector3;t.x=p*s.x-q*s.y;t.y=q*s.x+p*s.y;t.z=s.z;this.vertices.push(t)}c=b.length;h=0;for(k=d;h<k;h++){l=0;for(r=b.length-1;l<r;l++)e=d=l+c*h,q=d+c,p=d+1+c,this.faces.push(new THREE.Face4(e,q,p,d+1)),p=h*g,d=l*f,e=p+g,q=d+f,this.faceVertexUvs[0].push([new THREE.Vector2(p,
d),new THREE.Vector2(e,d),new THREE.Vector2(e,q),new THREE.Vector2(p,q)])}this.mergeVertices();this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.LatheGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.PlaneGeometry=function(b,d,c,e){THREE.Geometry.call(this);this.width=b;this.height=d;this.widthSegments=c||1;this.heightSegments=e||1;c=b/2;var f=d/2;e=this.widthSegments;var g=this.heightSegments,h=e+1,k=g+1,l=this.width/e,p=this.height/g,q=new THREE.Vector3(0,0,1);for(b=0;b<k;b++)for(d=0;d<h;d++)this.vertices.push(new THREE.Vector3(d*l-c,-(b*p-f),0));for(b=0;b<g;b++)for(d=0;d<e;d++)c=new THREE.Face4(d+h*b,d+h*(b+1),d+1+h*(b+1),d+1+h*b),c.normal.copy(q),c.vertexNormals.push(q.clone(),q.clone(),
q.clone(),q.clone()),this.faces.push(c),this.faceVertexUvs[0].push([new THREE.Vector2(d/e,1-b/g),new THREE.Vector2(d/e,1-(b+1)/g),new THREE.Vector2((d+1)/e,1-(b+1)/g),new THREE.Vector2((d+1)/e,1-b/g)]);this.computeCentroids()};THREE.PlaneGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.RingGeometry=function(b,d,c,e,f,g){THREE.Geometry.call(this);b=b||0;d=d||50;f=void 0!==f?f:0;g=void 0!==g?g:2*Math.PI;c=void 0!==c?Math.max(3,c):8;e=void 0!==e?Math.max(3,e):8;var h=[],k=b,l=(d-b)/e;for(b=0;b<=e;b++){for(d=0;d<=c;d++){var p=new THREE.Vector3,q=f+d/c*g;p.x=k*Math.cos(q);p.y=k*Math.sin(q);this.vertices.push(p);h.push(new THREE.Vector2((p.x/k+1)/2,-(p.y/k+1)/2+1))}k+=l}f=new THREE.Vector3(0,0,1);for(b=0;b<e;b++){g=b*c;for(d=0;d<=c;d++){var q=d+g,l=q+b,p=q+c+b,r=q+c+1+b;this.faces.push(new THREE.Face3(l,
p,r,[f,f,f]));this.faceVertexUvs[0].push([h[l],h[p],h[r]]);l=q+b;p=q+c+1+b;r=q+1+b;this.faces.push(new THREE.Face3(l,p,r,[f,f,f]));this.faceVertexUvs[0].push([h[l],h[p],h[r]])}}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,k)};THREE.RingGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.SphereGeometry=function(b,d,c,e,f,g,h){THREE.Geometry.call(this);this.radius=b=b||50;this.widthSegments=d=Math.max(3,Math.floor(d)||8);this.heightSegments=c=Math.max(2,Math.floor(c)||6);this.phiStart=e=void 0!==e?e:0;this.phiLength=f=void 0!==f?f:2*Math.PI;this.thetaStart=g=void 0!==g?g:0;this.thetaLength=h=void 0!==h?h:Math.PI;var k,l,p=[],q=[];for(l=0;l<=c;l++){var r=[],s=[];for(k=0;k<=d;k++){var t=k/d,u=l/c,v=new THREE.Vector3;v.x=-b*Math.cos(e+t*f)*Math.sin(g+u*h);v.y=b*Math.cos(g+u*h);
v.z=b*Math.sin(e+t*f)*Math.sin(g+u*h);this.vertices.push(v);r.push(this.vertices.length-1);s.push(new THREE.Vector2(t,1-u))}p.push(r);q.push(s)}for(l=0;l<this.heightSegments;l++)for(k=0;k<this.widthSegments;k++){d=p[l][k+1];c=p[l][k];e=p[l+1][k];f=p[l+1][k+1];g=this.vertices[d].clone().normalize();h=this.vertices[c].clone().normalize();var r=this.vertices[e].clone().normalize(),s=this.vertices[f].clone().normalize(),t=q[l][k+1].clone(),u=q[l][k].clone(),v=q[l+1][k].clone(),w=q[l+1][k+1].clone();Math.abs(this.vertices[d].y)===
this.radius?(this.faces.push(new THREE.Face3(d,e,f,[g,r,s])),this.faceVertexUvs[0].push([t,v,w])):Math.abs(this.vertices[e].y)===this.radius?(this.faces.push(new THREE.Face3(d,c,e,[g,h,r])),this.faceVertexUvs[0].push([t,u,v])):(this.faces.push(new THREE.Face4(d,c,e,f,[g,h,r,s])),this.faceVertexUvs[0].push([t,u,v,w]))}this.computeCentroids();this.computeFaceNormals();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,b)};THREE.SphereGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TextGeometry=function(b,d){d=d||{};var c=THREE.FontUtils.generateShapes(b,d);d.amount=void 0!==d.height?d.height:50;void 0===d.bevelThickness&&(d.bevelThickness=10);void 0===d.bevelSize&&(d.bevelSize=8);void 0===d.bevelEnabled&&(d.bevelEnabled=!1);THREE.ExtrudeGeometry.call(this,c,d)};THREE.TextGeometry.prototype=Object.create(THREE.ExtrudeGeometry.prototype);
THREE.TorusGeometry=function(b,d,c,e,f){THREE.Geometry.call(this);this.radius=b||100;this.tube=d||40;this.radialSegments=c||8;this.tubularSegments=e||6;this.arc=f||2*Math.PI;f=new THREE.Vector3;b=[];d=[];for(c=0;c<=this.radialSegments;c++)for(e=0;e<=this.tubularSegments;e++){var g=e/this.tubularSegments*this.arc,h=2*c/this.radialSegments*Math.PI;f.x=this.radius*Math.cos(g);f.y=this.radius*Math.sin(g);var k=new THREE.Vector3;k.x=(this.radius+this.tube*Math.cos(h))*Math.cos(g);k.y=(this.radius+this.tube*
Math.cos(h))*Math.sin(g);k.z=this.tube*Math.sin(h);this.vertices.push(k);b.push(new THREE.Vector2(e/this.tubularSegments,c/this.radialSegments));d.push(k.clone().sub(f).normalize())}for(c=1;c<=this.radialSegments;c++)for(e=1;e<=this.tubularSegments;e++){f=(this.tubularSegments+1)*c+e-1;var g=(this.tubularSegments+1)*(c-1)+e-1,h=(this.tubularSegments+1)*(c-1)+e,k=(this.tubularSegments+1)*c+e,l=new THREE.Face4(f,g,h,k,[d[f],d[g],d[h],d[k]]);l.normal.add(d[f]);l.normal.add(d[g]);l.normal.add(d[h]);l.normal.add(d[k]);
l.normal.normalize();this.faces.push(l);this.faceVertexUvs[0].push([b[f].clone(),b[g].clone(),b[h].clone(),b[k].clone()])}this.computeCentroids()};THREE.TorusGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TorusKnotGeometry=function(b,d,c,e,f,g,h){function k(b,c,e,d,f,g){var h=Math.cos(b);Math.cos(c);c=Math.sin(b);b*=e/d;e=Math.cos(b);h*=0.5*f*(2+e);c*=0.5*f*(2+e);f=0.5*g*f*Math.sin(b);return new THREE.Vector3(h,c,f)}THREE.Geometry.call(this);this.radius=b||100;this.tube=d||40;this.radialSegments=c||64;this.tubularSegments=e||8;this.p=f||2;this.q=g||3;this.heightScale=h||1;this.grid=Array(this.radialSegments);c=new THREE.Vector3;e=new THREE.Vector3;f=new THREE.Vector3;for(b=0;b<this.radialSegments;++b){this.grid[b]=
Array(this.tubularSegments);for(d=0;d<this.tubularSegments;++d){var l=2*(b/this.radialSegments)*this.p*Math.PI;h=2*(d/this.tubularSegments)*Math.PI;g=k(l,h,this.q,this.p,this.radius,this.heightScale);l=k(l+0.01,h,this.q,this.p,this.radius,this.heightScale);c.subVectors(l,g);e.addVectors(l,g);f.crossVectors(c,e);e.crossVectors(f,c);f.normalize();e.normalize();l=-this.tube*Math.cos(h);h=this.tube*Math.sin(h);g.x+=l*e.x+h*f.x;g.y+=l*e.y+h*f.y;g.z+=l*e.z+h*f.z;this.grid[b][d]=this.vertices.push(new THREE.Vector3(g.x,
g.y,g.z))-1}}for(b=0;b<this.radialSegments;++b)for(d=0;d<this.tubularSegments;++d){f=(b+1)%this.radialSegments;g=(d+1)%this.tubularSegments;c=this.grid[b][d];e=this.grid[f][d];f=this.grid[f][g];g=this.grid[b][g];h=new THREE.Vector2(b/this.radialSegments,d/this.tubularSegments);var l=new THREE.Vector2((b+1)/this.radialSegments,d/this.tubularSegments),p=new THREE.Vector2((b+1)/this.radialSegments,(d+1)/this.tubularSegments),q=new THREE.Vector2(b/this.radialSegments,(d+1)/this.tubularSegments);this.faces.push(new THREE.Face4(c,
e,f,g));this.faceVertexUvs[0].push([h,l,p,q])}this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.TorusKnotGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry=function(b,d,c,e,f,g){THREE.Geometry.call(this);this.path=b;this.segments=d||64;this.radius=c||1;this.radiusSegments=e||8;this.closed=f||!1;g&&(this.debug=new THREE.Object3D);this.grid=[];var h,k;f=this.segments+1;var l,p,q;g=new THREE.Vector3;var r,s,t;d=new THREE.TubeGeometry.FrenetFrames(this.path,this.segments,this.closed);r=d.tangents;s=d.normals;t=d.binormals;this.tangents=r;this.normals=s;this.binormals=t;for(d=0;d<f;d++){this.grid[d]=[];e=d/(f-1);q=b.getPointAt(e);e=r[d];
h=s[d];k=t[d];this.debug&&(this.debug.add(new THREE.ArrowHelper(e,q,c,255)),this.debug.add(new THREE.ArrowHelper(h,q,c,16711680)),this.debug.add(new THREE.ArrowHelper(k,q,c,65280)));for(e=0;e<this.radiusSegments;e++)l=2*(e/this.radiusSegments)*Math.PI,p=-this.radius*Math.cos(l),l=this.radius*Math.sin(l),g.copy(q),g.x+=p*h.x+l*k.x,g.y+=p*h.y+l*k.y,g.z+=p*h.z+l*k.z,this.grid[d][e]=this.vertices.push(new THREE.Vector3(g.x,g.y,g.z))-1}for(d=0;d<this.segments;d++)for(e=0;e<this.radiusSegments;e++)f=this.closed?
(d+1)%this.segments:d+1,g=(e+1)%this.radiusSegments,b=this.grid[d][e],c=this.grid[f][e],f=this.grid[f][g],g=this.grid[d][g],r=new THREE.Vector2(d/this.segments,e/this.radiusSegments),s=new THREE.Vector2((d+1)/this.segments,e/this.radiusSegments),t=new THREE.Vector2((d+1)/this.segments,(e+1)/this.radiusSegments),h=new THREE.Vector2(d/this.segments,(e+1)/this.radiusSegments),this.faces.push(new THREE.Face4(b,c,f,g)),this.faceVertexUvs[0].push([r,s,t,h]);this.computeCentroids();this.computeFaceNormals();
this.computeVertexNormals()};THREE.TubeGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.TubeGeometry.FrenetFrames=function(b,d,c){new THREE.Vector3;var e=new THREE.Vector3;new THREE.Vector3;var f=[],g=[],h=[],k=new THREE.Vector3,l=new THREE.Matrix4;d+=1;var p,q,r;this.tangents=f;this.normals=g;this.binormals=h;for(p=0;p<d;p++)q=p/(d-1),f[p]=b.getTangentAt(q),f[p].normalize();g[0]=new THREE.Vector3;h[0]=new THREE.Vector3;b=Number.MAX_VALUE;p=Math.abs(f[0].x);q=Math.abs(f[0].y);r=Math.abs(f[0].z);p<=b&&(b=p,e.set(1,0,0));q<=b&&(b=q,e.set(0,1,0));r<=b&&e.set(0,0,1);k.crossVectors(f[0],
e).normalize();g[0].crossVectors(f[0],k);h[0].crossVectors(f[0],g[0]);for(p=1;p<d;p++)g[p]=g[p-1].clone(),h[p]=h[p-1].clone(),k.crossVectors(f[p-1],f[p]),1E-4<k.length()&&(k.normalize(),e=Math.acos(f[p-1].dot(f[p])),g[p].applyMatrix4(l.makeRotationAxis(k,e))),h[p].crossVectors(f[p],g[p]);if(c){e=Math.acos(g[0].dot(g[d-1]));e/=d-1;0<f[0].dot(k.crossVectors(g[0],g[d-1]))&&(e=-e);for(p=1;p<d;p++)g[p].applyMatrix4(l.makeRotationAxis(f[p],e*p)),h[p].crossVectors(f[p],g[p])}};
THREE.PolyhedronGeometry=function(b,d,c,e){function f(b){var c=b.normalize().clone();c.index=k.vertices.push(c)-1;var e=Math.atan2(b.z,-b.x)/2/Math.PI+0.5;b=Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))/Math.PI+0.5;c.uv=new THREE.Vector2(e,1-b);return c}function g(b,c,e){var d=new THREE.Face3(b.index,c.index,e.index,[b.clone(),c.clone(),e.clone()]);d.centroid.add(b).add(c).add(e).divideScalar(3);d.normal.copy(d.centroid).normalize();k.faces.push(d);d=Math.atan2(d.centroid.z,-d.centroid.x);k.faceVertexUvs[0].push([h(b.uv,
b,d),h(c.uv,c,d),h(e.uv,e,d)])}function h(b,c,e){0>e&&1===b.x&&(b=new THREE.Vector2(b.x-1,b.y));0===c.x&&0===c.z&&(b=new THREE.Vector2(e/2/Math.PI+0.5,b.y));return b.clone()}THREE.Geometry.call(this);c=c||1;e=e||0;for(var k=this,l=0,p=b.length;l<p;l++)f(new THREE.Vector3(b[l][0],b[l][1],b[l][2]));var q=this.vertices;b=[];l=0;for(p=d.length;l<p;l++){var r=q[d[l][0]],s=q[d[l][1]],t=q[d[l][2]];b[l]=new THREE.Face3(r.index,s.index,t.index,[r.clone(),s.clone(),t.clone()])}l=0;for(p=b.length;l<p;l++){s=
b[l];q=e;d=Math.pow(2,q);Math.pow(4,q);for(var q=f(k.vertices[s.a]),r=f(k.vertices[s.b]),u=f(k.vertices[s.c]),s=[],t=0;t<=d;t++){s[t]=[];for(var v=f(q.clone().lerp(u,t/d)),w=f(r.clone().lerp(u,t/d)),y=d-t,z=0;z<=y;z++)s[t][z]=0==z&&t==d?v:f(v.clone().lerp(w,z/y))}for(t=0;t<d;t++)for(z=0;z<2*(d-t)-1;z++)q=Math.floor(z/2),0==z%2?g(s[t][q+1],s[t+1][q],s[t][q]):g(s[t][q+1],s[t+1][q+1],s[t+1][q])}l=0;for(p=this.faceVertexUvs[0].length;l<p;l++)e=this.faceVertexUvs[0][l],b=e[0].x,d=e[1].x,q=e[2].x,r=Math.max(b,
Math.max(d,q)),s=Math.min(b,Math.min(d,q)),0.9<r&&0.1>s&&(0.2>b&&(e[0].x+=1),0.2>d&&(e[1].x+=1),0.2>q&&(e[2].x+=1));this.mergeVertices();l=0;for(p=this.vertices.length;l<p;l++)this.vertices[l].multiplyScalar(c);this.computeCentroids();this.boundingSphere=new THREE.Sphere(new THREE.Vector3,c)};THREE.PolyhedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.IcosahedronGeometry=function(b,d){this.radius=b;this.detail=d;var c=(1+Math.sqrt(5))/2;THREE.PolyhedronGeometry.call(this,[[-1,c,0],[1,c,0],[-1,-c,0],[1,-c,0],[0,-1,c],[0,1,c],[0,-1,-c],[0,1,-c],[c,0,-1],[c,0,1],[-c,0,-1],[-c,0,1]],[[0,11,5],[0,5,1],[0,1,7],[0,7,10],[0,10,11],[1,5,9],[5,11,4],[11,10,2],[10,7,6],[7,1,8],[3,9,4],[3,4,2],[3,2,6],[3,6,8],[3,8,9],[4,9,5],[2,4,11],[6,2,10],[8,6,7],[9,8,1]],b,d)};THREE.IcosahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.OctahedronGeometry=function(b,d){THREE.PolyhedronGeometry.call(this,[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],[[0,2,4],[0,4,3],[0,3,5],[0,5,2],[1,2,5],[1,5,3],[1,3,4],[1,4,2]],b,d)};THREE.OctahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);THREE.TetrahedronGeometry=function(b,d){THREE.PolyhedronGeometry.call(this,[[1,1,1],[-1,-1,1],[-1,1,-1],[1,-1,-1]],[[2,1,0],[0,3,2],[1,3,0],[2,3,1]],b,d)};THREE.TetrahedronGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ParametricGeometry=function(b,d,c,e){THREE.Geometry.call(this);var f=this.vertices,g=this.faces,h=this.faceVertexUvs[0];e=void 0===e?!1:e;var k,l,p,q,r=d+1;for(k=0;k<=c;k++){q=k/c;for(l=0;l<=d;l++)p=l/d,p=b(p,q),f.push(p)}var s,t,u,v;for(k=0;k<c;k++)for(l=0;l<d;l++)b=k*r+l,f=k*r+l+1,q=(k+1)*r+l,p=(k+1)*r+l+1,s=new THREE.Vector2(l/d,k/c),t=new THREE.Vector2((l+1)/d,k/c),u=new THREE.Vector2(l/d,(k+1)/c),v=new THREE.Vector2((l+1)/d,(k+1)/c),e?(g.push(new THREE.Face3(b,f,q)),g.push(new THREE.Face3(f,
p,q)),h.push([s,t,u]),h.push([t,v,u])):(g.push(new THREE.Face4(b,f,p,q)),h.push([s,t,v,u]));this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ParametricGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.ConvexGeometry=function(b){function d(b){var c=b.length();return new THREE.Vector2(b.x/c,b.y/c)}THREE.Geometry.call(this);for(var c=[[0,1,2],[0,2,1]],e=3;e<b.length;e++){var f=e,g=b[f].clone(),h=g.length();g.x+=2E-6*h*(Math.random()-0.5);g.y+=2E-6*h*(Math.random()-0.5);g.z+=2E-6*h*(Math.random()-0.5);for(var h=[],k=0;k<c.length;){var l=c[k],p=g,q=b[l[0]],r;r=q;var s=b[l[1]],t=b[l[2]],u=new THREE.Vector3,v=new THREE.Vector3;u.subVectors(t,s);v.subVectors(r,s);u.cross(v);u.normalize();r=u;q=r.dot(q);
if(r.dot(p)>=q){for(p=0;3>p;p++){q=[l[p],l[(p+1)%3]];r=!0;for(s=0;s<h.length;s++)if(h[s][0]===q[1]&&h[s][1]===q[0]){h[s]=h[h.length-1];h.pop();r=!1;break}r&&h.push(q)}c[k]=c[c.length-1];c.pop()}else k++}for(s=0;s<h.length;s++)c.push([h[s][0],h[s][1],f])}f=0;g=Array(b.length);for(e=0;e<c.length;e++){h=c[e];for(k=0;3>k;k++)void 0===g[h[k]]&&(g[h[k]]=f++,this.vertices.push(b[h[k]])),h[k]=g[h[k]]}for(e=0;e<c.length;e++)this.faces.push(new THREE.Face3(c[e][0],c[e][1],c[e][2]));for(e=0;e<this.faces.length;e++)h=
this.faces[e],this.faceVertexUvs[0].push([d(this.vertices[h.a]),d(this.vertices[h.b]),d(this.vertices[h.c])]);this.computeCentroids();this.computeFaceNormals();this.computeVertexNormals()};THREE.ConvexGeometry.prototype=Object.create(THREE.Geometry.prototype);
THREE.AxisHelper=function(b){b=b||1;var d=new THREE.Geometry;d.vertices.push(new THREE.Vector3,new THREE.Vector3(b,0,0),new THREE.Vector3,new THREE.Vector3(0,b,0),new THREE.Vector3,new THREE.Vector3(0,0,b));d.colors.push(new THREE.Color(16711680),new THREE.Color(16755200),new THREE.Color(65280),new THREE.Color(11206400),new THREE.Color(255),new THREE.Color(43775));b=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors});THREE.Line.call(this,d,b,THREE.LinePieces)};
THREE.AxisHelper.prototype=Object.create(THREE.Line.prototype);
THREE.ArrowHelper=function(b,d,c,e){THREE.Object3D.call(this);void 0===e&&(e=16776960);void 0===c&&(c=1);this.position=d;this.useQuaternion=!0;d=new THREE.Geometry;d.vertices.push(new THREE.Vector3(0,0,0));d.vertices.push(new THREE.Vector3(0,1,0));this.line=new THREE.Line(d,new THREE.LineBasicMaterial({color:e}));this.line.matrixAutoUpdate=!1;this.add(this.line);d=new THREE.CylinderGeometry(0,0.05,0.25,5,1);d.applyMatrix((new THREE.Matrix4).makeTranslation(0,0.875,0));this.cone=new THREE.Mesh(d,new THREE.MeshBasicMaterial({color:e}));
this.cone.matrixAutoUpdate=!1;this.add(this.cone);this.setDirection(b);this.setLength(c)};THREE.ArrowHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.ArrowHelper.prototype.setDirection=function(){var b=new THREE.Vector3,d;return function(c){0.999<c.y?this.quaternion.set(0,0,0,1):-0.999>c.y?this.quaternion.set(1,0,0,0):(b.set(c.z,0,-c.x).normalize(),d=Math.acos(c.y),this.quaternion.setFromAxisAngle(b,d))}}();THREE.ArrowHelper.prototype.setLength=function(b){this.scale.set(b,b,b)};
THREE.ArrowHelper.prototype.setColor=function(b){this.line.material.color.setHex(b);this.cone.material.color.setHex(b)};
THREE.BoxHelper=function(b){b=b||1;var d=new THREE.Geometry;b=[new THREE.Vector3(b,b,b),new THREE.Vector3(-b,b,b),new THREE.Vector3(-b,-b,b),new THREE.Vector3(b,-b,b),new THREE.Vector3(b,b,-b),new THREE.Vector3(-b,b,-b),new THREE.Vector3(-b,-b,-b),new THREE.Vector3(b,-b,-b)];d.vertices.push(b[0],b[1],b[1],b[2],b[2],b[3],b[3],b[0],b[4],b[5],b[5],b[6],b[6],b[7],b[7],b[4],b[0],b[4],b[1],b[5],b[2],b[6],b[3],b[7]);this.vertices=b;THREE.Line.call(this,d,new THREE.LineBasicMaterial,THREE.LinePieces)};
THREE.BoxHelper.prototype=Object.create(THREE.Line.prototype);
THREE.BoxHelper.prototype.update=function(b){var d=b.geometry;null===d.boundingBox&&d.computeBoundingBox();var c=d.boundingBox.min,d=d.boundingBox.max,e=this.vertices;e[0].set(d.x,d.y,d.z);e[1].set(c.x,d.y,d.z);e[2].set(c.x,c.y,d.z);e[3].set(d.x,c.y,d.z);e[4].set(d.x,d.y,c.z);e[5].set(c.x,d.y,c.z);e[6].set(c.x,c.y,c.z);e[7].set(d.x,c.y,c.z);this.geometry.computeBoundingSphere();this.geometry.verticesNeedUpdate=!0;this.matrixAutoUpdate=!1;this.matrixWorld=b.matrixWorld};
THREE.CameraHelper=function(b){function d(b,e,d){c(b,d);c(e,d)}function c(b,c){e.vertices.push(new THREE.Vector3);e.colors.push(new THREE.Color(c));void 0===g[b]&&(g[b]=[]);g[b].push(e.vertices.length-1)}THREE.Line.call(this);var e=new THREE.Geometry,f=new THREE.LineBasicMaterial({color:16777215,vertexColors:THREE.FaceColors}),g={};d("n1","n2",16755200);d("n2","n4",16755200);d("n4","n3",16755200);d("n3","n1",16755200);d("f1","f2",16755200);d("f2","f4",16755200);d("f4","f3",16755200);d("f3","f1",16755200);
d("n1","f1",16755200);d("n2","f2",16755200);d("n3","f3",16755200);d("n4","f4",16755200);d("p","n1",16711680);d("p","n2",16711680);d("p","n3",16711680);d("p","n4",16711680);d("u1","u2",43775);d("u2","u3",43775);d("u3","u1",43775);d("c","t",16777215);d("p","c",3355443);d("cn1","cn2",3355443);d("cn3","cn4",3355443);d("cf1","cf2",3355443);d("cf3","cf4",3355443);THREE.Line.call(this,e,f,THREE.LinePieces);this.camera=b;this.matrixWorld=b.matrixWorld;this.matrixAutoUpdate=!1;this.pointMap=g;this.update()};
THREE.CameraHelper.prototype=Object.create(THREE.Line.prototype);
THREE.CameraHelper.prototype.update=function(){var b=new THREE.Vector3,d=new THREE.Camera,c=new THREE.Projector;return function(){function e(e,h,k,l){b.set(h,k,l);c.unprojectVector(b,d);e=f.pointMap[e];if(void 0!==e){h=0;for(k=e.length;h<k;h++)f.geometry.vertices[e[h]].copy(b)}}var f=this;d.projectionMatrix.copy(this.camera.projectionMatrix);e("c",0,0,-1);e("t",0,0,1);e("n1",-1,-1,-1);e("n2",1,-1,-1);e("n3",-1,1,-1);e("n4",1,1,-1);e("f1",-1,-1,1);e("f2",1,-1,1);e("f3",-1,1,1);e("f4",1,1,1);e("u1",
0.7,1.1,-1);e("u2",-0.7,1.1,-1);e("u3",0,2,-1);e("cf1",-1,0,1);e("cf2",1,0,1);e("cf3",0,-1,1);e("cf4",0,1,1);e("cn1",-1,0,-1);e("cn2",1,0,-1);e("cn3",0,-1,-1);e("cn4",0,1,-1);this.geometry.verticesNeedUpdate=!0}}();
THREE.DirectionalLightHelper=function(b,d){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.light=b;var c=new THREE.SphereGeometry(d,4,2),e=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere=new THREE.Mesh(c,e);this.lightSphere.matrixWorld=this.light.matrixWorld;this.lightSphere.matrixAutoUpdate=!1;this.add(this.lightSphere);c=new THREE.Geometry;c.vertices.push(this.light.position);c.vertices.push(this.light.target.position);
c.computeLineDistances();e=new THREE.LineDashedMaterial({dashSize:4,gapSize:4,opacity:0.75,transparent:!0,fog:!1});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine=new THREE.Line(c,e);this.add(this.targetLine)};THREE.DirectionalLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.DirectionalLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.targetLine.geometry.computeLineDistances();this.targetLine.geometry.verticesNeedUpdate=!0;this.targetLine.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.GridHelper=function(b,d){for(var c=new THREE.Geometry,e=new THREE.LineBasicMaterial({vertexColors:THREE.VertexColors}),f=new THREE.Color(4473924),g=new THREE.Color(8947848),h=-b;h<=b;h+=d){c.vertices.push(new THREE.Vector3(-b,0,h));c.vertices.push(new THREE.Vector3(b,0,h));c.vertices.push(new THREE.Vector3(h,0,-b));c.vertices.push(new THREE.Vector3(h,0,b));var k=0===h?f:g;c.colors.push(k,k,k,k)}THREE.Line.call(this,c,e,THREE.LinePieces)};THREE.GridHelper.prototype=Object.create(THREE.Line.prototype);
THREE.HemisphereLightHelper=function(b,d){THREE.Object3D.call(this);this.light=b;var c=new THREE.SphereGeometry(d,4,2);c.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));for(var e=0;8>e;e++)c.faces[e].materialIndex=4>e?0:1;e=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});e.color.copy(b.color).multiplyScalar(b.intensity);var f=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});f.color.copy(b.groundColor).multiplyScalar(b.intensity);this.lightSphere=new THREE.Mesh(c,new THREE.MeshFaceMaterial([e,
f]));this.lightSphere.position=b.position;this.lightSphere.lookAt(new THREE.Vector3);this.add(this.lightSphere)};THREE.HemisphereLightHelper.prototype=Object.create(THREE.Object3D.prototype);THREE.HemisphereLightHelper.prototype.update=function(){this.lightSphere.lookAt(new THREE.Vector3);this.lightSphere.material.materials[0].color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere.material.materials[1].color.copy(this.light.groundColor).multiplyScalar(this.light.intensity)};
THREE.PointLightHelper=function(b,d){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.light=b;var c=new THREE.SphereGeometry(d,4,2),e=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere=new THREE.Mesh(c,e);this.lightSphere.matrixWorld=this.light.matrixWorld;this.lightSphere.matrixAutoUpdate=!1;this.add(this.lightSphere)};THREE.PointLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.PointLightHelper.prototype.update=function(){this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};
THREE.SpotLightHelper=function(b,d){THREE.Object3D.call(this);this.matrixAutoUpdate=!1;this.light=b;var c=new THREE.SphereGeometry(d,4,2),e=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightSphere=new THREE.Mesh(c,e);this.lightSphere.matrixWorld=this.light.matrixWorld;this.lightSphere.matrixAutoUpdate=!1;this.add(this.lightSphere);c=new THREE.CylinderGeometry(1E-4,1,1,8,1,!0);c.applyMatrix((new THREE.Matrix4).makeTranslation(0,
-0.5,0));c.applyMatrix((new THREE.Matrix4).makeRotationX(-Math.PI/2));e=new THREE.MeshBasicMaterial({fog:!1,wireframe:!0,opacity:0.3,transparent:!0});e.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightCone=new THREE.Mesh(c,e);this.lightCone.position=this.light.position;c=b.distance?b.distance:1E4;e=c*Math.tan(b.angle);this.lightCone.scale.set(e,e,c);this.lightCone.lookAt(this.light.target.position);this.add(this.lightCone)};THREE.SpotLightHelper.prototype=Object.create(THREE.Object3D.prototype);
THREE.SpotLightHelper.prototype.update=function(){var b=this.light.distance?this.light.distance:1E4,d=b*Math.tan(this.light.angle);this.lightCone.scale.set(d,d,b);this.lightCone.lookAt(this.light.target.position);this.lightSphere.material.color.copy(this.light.color).multiplyScalar(this.light.intensity);this.lightCone.material.color.copy(this.light.color).multiplyScalar(this.light.intensity)};THREE.ImmediateRenderObject=function(){THREE.Object3D.call(this);this.render=function(){}};
THREE.ImmediateRenderObject.prototype=Object.create(THREE.Object3D.prototype);THREE.LensFlare=function(b,d,c,e,f){THREE.Object3D.call(this);this.lensFlares=[];this.positionScreen=new THREE.Vector3;this.customUpdateCallback=void 0;void 0!==b&&this.add(b,d,c,e,f)};THREE.LensFlare.prototype=Object.create(THREE.Object3D.prototype);
THREE.LensFlare.prototype.add=function(b,d,c,e,f,g){void 0===d&&(d=-1);void 0===c&&(c=0);void 0===g&&(g=1);void 0===f&&(f=new THREE.Color(16777215));void 0===e&&(e=THREE.NormalBlending);c=Math.min(c,Math.max(0,c));this.lensFlares.push({texture:b,size:d,distance:c,x:0,y:0,z:0,scale:1,rotation:1,opacity:g,color:f,blending:e})};
THREE.LensFlare.prototype.updateLensFlares=function(){var b,d=this.lensFlares.length,c,e=2*-this.positionScreen.x,f=2*-this.positionScreen.y;for(b=0;b<d;b++)c=this.lensFlares[b],c.x=this.positionScreen.x+e*c.distance,c.y=this.positionScreen.y+f*c.distance,c.wantedRotation=0.25*c.x*Math.PI,c.rotation+=0.25*(c.wantedRotation-c.rotation)};
THREE.MorphBlendMesh=function(b,d){THREE.Mesh.call(this,b,d);this.animationsMap={};this.animationsList=[];var c=this.geometry.morphTargets.length;this.createAnimation("__default",0,c-1,c/1);this.setAnimationWeight("__default",1)};THREE.MorphBlendMesh.prototype=Object.create(THREE.Mesh.prototype);
THREE.MorphBlendMesh.prototype.createAnimation=function(b,d,c,e){d={startFrame:d,endFrame:c,length:c-d+1,fps:e,duration:(c-d)/e,lastFrame:0,currentFrame:0,active:!1,time:0,direction:1,weight:1,directionBackwards:!1,mirroredLoop:!1};this.animationsMap[b]=d;this.animationsList.push(d)};
THREE.MorphBlendMesh.prototype.autoCreateAnimations=function(b){for(var d=/([a-z]+)(\d+)/,c,e={},f=this.geometry,g=0,h=f.morphTargets.length;g<h;g++){var k=f.morphTargets[g].name.match(d);if(k&&1<k.length){var l=k[1];e[l]||(e[l]={start:Infinity,end:-Infinity});k=e[l];g<k.start&&(k.start=g);g>k.end&&(k.end=g);c||(c=l)}}for(l in e)k=e[l],this.createAnimation(l,k.start,k.end,b);this.firstAnimation=c};
THREE.MorphBlendMesh.prototype.setAnimationDirectionForward=function(b){if(b=this.animationsMap[b])b.direction=1,b.directionBackwards=!1};THREE.MorphBlendMesh.prototype.setAnimationDirectionBackward=function(b){if(b=this.animationsMap[b])b.direction=-1,b.directionBackwards=!0};THREE.MorphBlendMesh.prototype.setAnimationFPS=function(b,d){var c=this.animationsMap[b];c&&(c.fps=d,c.duration=(c.end-c.start)/c.fps)};
THREE.MorphBlendMesh.prototype.setAnimationDuration=function(b,d){var c=this.animationsMap[b];c&&(c.duration=d,c.fps=(c.end-c.start)/c.duration)};THREE.MorphBlendMesh.prototype.setAnimationWeight=function(b,d){var c=this.animationsMap[b];c&&(c.weight=d)};THREE.MorphBlendMesh.prototype.setAnimationTime=function(b,d){var c=this.animationsMap[b];c&&(c.time=d)};THREE.MorphBlendMesh.prototype.getAnimationTime=function(b){var d=0;if(b=this.animationsMap[b])d=b.time;return d};
THREE.MorphBlendMesh.prototype.getAnimationDuration=function(b){var d=-1;if(b=this.animationsMap[b])d=b.duration;return d};THREE.MorphBlendMesh.prototype.playAnimation=function(b){var d=this.animationsMap[b];d?(d.time=0,d.active=!0):console.warn("animation["+b+"] undefined")};THREE.MorphBlendMesh.prototype.stopAnimation=function(b){if(b=this.animationsMap[b])b.active=!1};
THREE.MorphBlendMesh.prototype.update=function(b){for(var d=0,c=this.animationsList.length;d<c;d++){var e=this.animationsList[d];if(e.active){var f=e.duration/e.length;e.time+=e.direction*b;if(e.mirroredLoop){if(e.time>e.duration||0>e.time)e.direction*=-1,e.time>e.duration&&(e.time=e.duration,e.directionBackwards=!0),0>e.time&&(e.time=0,e.directionBackwards=!1)}else e.time%=e.duration,0>e.time&&(e.time+=e.duration);var g=e.startFrame+THREE.Math.clamp(Math.floor(e.time/f),0,e.length-1),h=e.weight;
g!==e.currentFrame&&(this.morphTargetInfluences[e.lastFrame]=0,this.morphTargetInfluences[e.currentFrame]=1*h,this.morphTargetInfluences[g]=0,e.lastFrame=e.currentFrame,e.currentFrame=g);f=e.time%f/f;e.directionBackwards&&(f=1-f);this.morphTargetInfluences[e.currentFrame]=f*h;this.morphTargetInfluences[e.lastFrame]=(1-f)*h}}};
THREE.LensFlarePlugin=function(){function b(b,c){var e=d.createProgram(),f=d.createShader(d.FRAGMENT_SHADER),g=d.createShader(d.VERTEX_SHADER),h="precision "+c+" float;\n";d.shaderSource(f,h+b.fragmentShader);d.shaderSource(g,h+b.vertexShader);d.compileShader(f);d.compileShader(g);d.attachShader(e,f);d.attachShader(e,g);d.linkProgram(e);return e}var d,c,e,f,g,h,k,l,p,q,r,s,t;this.init=function(u){d=u.context;c=u;e=u.getPrecision();f=new Float32Array(16);g=new Uint16Array(6);u=0;f[u++]=-1;f[u++]=-1;
f[u++]=0;f[u++]=0;f[u++]=1;f[u++]=-1;f[u++]=1;f[u++]=0;f[u++]=1;f[u++]=1;f[u++]=1;f[u++]=1;f[u++]=-1;f[u++]=1;f[u++]=0;f[u++]=1;u=0;g[u++]=0;g[u++]=1;g[u++]=2;g[u++]=0;g[u++]=2;g[u++]=3;h=d.createBuffer();k=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,h);d.bufferData(d.ARRAY_BUFFER,f,d.STATIC_DRAW);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k);d.bufferData(d.ELEMENT_ARRAY_BUFFER,g,d.STATIC_DRAW);l=d.createTexture();p=d.createTexture();d.bindTexture(d.TEXTURE_2D,l);d.texImage2D(d.TEXTURE_2D,0,d.RGB,16,16,
0,d.RGB,d.UNSIGNED_BYTE,null);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST);d.bindTexture(d.TEXTURE_2D,p);d.texImage2D(d.TEXTURE_2D,0,d.RGBA,16,16,0,d.RGBA,d.UNSIGNED_BYTE,null);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE);
d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.NEAREST);d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.NEAREST);0>=d.getParameter(d.MAX_VERTEX_TEXTURE_IMAGE_UNITS)?(q=!1,r=b(THREE.ShaderFlares.lensFlare,e)):(q=!0,r=b(THREE.ShaderFlares.lensFlareVertexTexture,e));s={};t={};s.vertex=d.getAttribLocation(r,"position");s.uv=d.getAttribLocation(r,"uv");t.renderType=d.getUniformLocation(r,"renderType");t.map=d.getUniformLocation(r,"map");t.occlusionMap=d.getUniformLocation(r,"occlusionMap");t.opacity=
d.getUniformLocation(r,"opacity");t.color=d.getUniformLocation(r,"color");t.scale=d.getUniformLocation(r,"scale");t.rotation=d.getUniformLocation(r,"rotation");t.screenPosition=d.getUniformLocation(r,"screenPosition")};this.render=function(b,e,f,g){b=b.__webglFlares;var z=b.length;if(z){var B=new THREE.Vector3,A=g/f,K=0.5*f,O=0.5*g,E=16/g,F=new THREE.Vector2(E*A,E),U=new THREE.Vector3(1,1,0),H=new THREE.Vector2(1,1),G=t,E=s;d.useProgram(r);d.enableVertexAttribArray(s.vertex);d.enableVertexAttribArray(s.uv);
d.uniform1i(G.occlusionMap,0);d.uniform1i(G.map,1);d.bindBuffer(d.ARRAY_BUFFER,h);d.vertexAttribPointer(E.vertex,2,d.FLOAT,!1,16,0);d.vertexAttribPointer(E.uv,2,d.FLOAT,!1,16,8);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k);d.disable(d.CULL_FACE);d.depthMask(!1);var aa,D,M,I,Q;for(aa=0;aa<z;aa++)if(E=16/g,F.set(E*A,E),I=b[aa],B.set(I.matrixWorld.elements[12],I.matrixWorld.elements[13],I.matrixWorld.elements[14]),B.applyMatrix4(e.matrixWorldInverse),B.applyProjection(e.projectionMatrix),U.copy(B),H.x=U.x*
K+K,H.y=U.y*O+O,q||0<H.x&&H.x<f&&0<H.y&&H.y<g){d.activeTexture(d.TEXTURE1);d.bindTexture(d.TEXTURE_2D,l);d.copyTexImage2D(d.TEXTURE_2D,0,d.RGB,H.x-8,H.y-8,16,16,0);d.uniform1i(G.renderType,0);d.uniform2f(G.scale,F.x,F.y);d.uniform3f(G.screenPosition,U.x,U.y,U.z);d.disable(d.BLEND);d.enable(d.DEPTH_TEST);d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0);d.activeTexture(d.TEXTURE0);d.bindTexture(d.TEXTURE_2D,p);d.copyTexImage2D(d.TEXTURE_2D,0,d.RGBA,H.x-8,H.y-8,16,16,0);d.uniform1i(G.renderType,1);d.disable(d.DEPTH_TEST);
d.activeTexture(d.TEXTURE1);d.bindTexture(d.TEXTURE_2D,l);d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0);I.positionScreen.copy(U);I.customUpdateCallback?I.customUpdateCallback(I):I.updateLensFlares();d.uniform1i(G.renderType,2);d.enable(d.BLEND);D=0;for(M=I.lensFlares.length;D<M;D++)Q=I.lensFlares[D],0.001<Q.opacity&&0.001<Q.scale&&(U.x=Q.x,U.y=Q.y,U.z=Q.z,E=Q.size*Q.scale/g,F.x=E*A,F.y=E,d.uniform3f(G.screenPosition,U.x,U.y,U.z),d.uniform2f(G.scale,F.x,F.y),d.uniform1f(G.rotation,Q.rotation),d.uniform1f(G.opacity,
Q.opacity),d.uniform3f(G.color,Q.color.r,Q.color.g,Q.color.b),c.setBlending(Q.blending,Q.blendEquation,Q.blendSrc,Q.blendDst),c.setTexture(Q.texture,1),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0))}d.enable(d.CULL_FACE);d.enable(d.DEPTH_TEST);d.depthMask(!0)}}};
THREE.ShadowMapPlugin=function(){var b,d,c,e,f,g,h=new THREE.Frustum,k=new THREE.Matrix4,l=new THREE.Vector3,p=new THREE.Vector3,q=new THREE.Vector3;this.init=function(h){b=h.context;d=h;h=THREE.ShaderLib.depthRGBA;var k=THREE.UniformsUtils.clone(h.uniforms);c=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:k});e=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:k,morphTargets:!0});f=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,
vertexShader:h.vertexShader,uniforms:k,skinning:!0});g=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:k,morphTargets:!0,skinning:!0});c._shadowPass=!0;e._shadowPass=!0;f._shadowPass=!0;g._shadowPass=!0};this.render=function(b,c){d.shadowMapEnabled&&d.shadowMapAutoUpdate&&this.update(b,c)};this.update=function(r,s){var t,u,v,w,y,z,B,A,K,O=[];w=0;b.clearColor(1,1,1,1);b.disable(b.BLEND);b.enable(b.CULL_FACE);b.frontFace(b.CCW);d.shadowMapCullFace===THREE.CullFaceFront?
b.cullFace(b.FRONT):b.cullFace(b.BACK);d.setDepthTest(!0);t=0;for(u=r.__lights.length;t<u;t++)if(v=r.__lights[t],v.castShadow)if(v instanceof THREE.DirectionalLight&&v.shadowCascade)for(y=0;y<v.shadowCascadeCount;y++){var E;if(v.shadowCascadeArray[y])E=v.shadowCascadeArray[y];else{K=v;B=y;E=new THREE.DirectionalLight;E.isVirtual=!0;E.onlyShadow=!0;E.castShadow=!0;E.shadowCameraNear=K.shadowCameraNear;E.shadowCameraFar=K.shadowCameraFar;E.shadowCameraLeft=K.shadowCameraLeft;E.shadowCameraRight=K.shadowCameraRight;
E.shadowCameraBottom=K.shadowCameraBottom;E.shadowCameraTop=K.shadowCameraTop;E.shadowCameraVisible=K.shadowCameraVisible;E.shadowDarkness=K.shadowDarkness;E.shadowBias=K.shadowCascadeBias[B];E.shadowMapWidth=K.shadowCascadeWidth[B];E.shadowMapHeight=K.shadowCascadeHeight[B];E.pointsWorld=[];E.pointsFrustum=[];A=E.pointsWorld;z=E.pointsFrustum;for(var F=0;8>F;F++)A[F]=new THREE.Vector3,z[F]=new THREE.Vector3;A=K.shadowCascadeNearZ[B];K=K.shadowCascadeFarZ[B];z[0].set(-1,-1,A);z[1].set(1,-1,A);z[2].set(-1,
1,A);z[3].set(1,1,A);z[4].set(-1,-1,K);z[5].set(1,-1,K);z[6].set(-1,1,K);z[7].set(1,1,K);E.originalCamera=s;z=new THREE.Gyroscope;z.position=v.shadowCascadeOffset;z.add(E);z.add(E.target);s.add(z);v.shadowCascadeArray[y]=E;console.log("Created virtualLight",E)}B=v;A=y;K=B.shadowCascadeArray[A];K.position.copy(B.position);K.target.position.copy(B.target.position);K.lookAt(K.target);K.shadowCameraVisible=B.shadowCameraVisible;K.shadowDarkness=B.shadowDarkness;K.shadowBias=B.shadowCascadeBias[A];z=B.shadowCascadeNearZ[A];
B=B.shadowCascadeFarZ[A];K=K.pointsFrustum;K[0].z=z;K[1].z=z;K[2].z=z;K[3].z=z;K[4].z=B;K[5].z=B;K[6].z=B;K[7].z=B;O[w]=E;w++}else O[w]=v,w++;t=0;for(u=O.length;t<u;t++){v=O[t];v.shadowMap||(y=THREE.LinearFilter,d.shadowMapType===THREE.PCFSoftShadowMap&&(y=THREE.NearestFilter),v.shadowMap=new THREE.WebGLRenderTarget(v.shadowMapWidth,v.shadowMapHeight,{minFilter:y,magFilter:y,format:THREE.RGBAFormat}),v.shadowMapSize=new THREE.Vector2(v.shadowMapWidth,v.shadowMapHeight),v.shadowMatrix=new THREE.Matrix4);
if(!v.shadowCamera){if(v instanceof THREE.SpotLight)v.shadowCamera=new THREE.PerspectiveCamera(v.shadowCameraFov,v.shadowMapWidth/v.shadowMapHeight,v.shadowCameraNear,v.shadowCameraFar);else if(v instanceof THREE.DirectionalLight)v.shadowCamera=new THREE.OrthographicCamera(v.shadowCameraLeft,v.shadowCameraRight,v.shadowCameraTop,v.shadowCameraBottom,v.shadowCameraNear,v.shadowCameraFar);else{console.error("Unsupported light type for shadow");continue}r.add(v.shadowCamera);!0===r.autoUpdate&&r.updateMatrixWorld()}v.shadowCameraVisible&&
!v.cameraHelper&&(v.cameraHelper=new THREE.CameraHelper(v.shadowCamera),v.shadowCamera.add(v.cameraHelper));if(v.isVirtual&&E.originalCamera==s){y=s;w=v.shadowCamera;z=v.pointsFrustum;K=v.pointsWorld;l.set(Infinity,Infinity,Infinity);p.set(-Infinity,-Infinity,-Infinity);for(B=0;8>B;B++)A=K[B],A.copy(z[B]),THREE.ShadowMapPlugin.__projector.unprojectVector(A,y),A.applyMatrix4(w.matrixWorldInverse),A.x<l.x&&(l.x=A.x),A.x>p.x&&(p.x=A.x),A.y<l.y&&(l.y=A.y),A.y>p.y&&(p.y=A.y),A.z<l.z&&(l.z=A.z),A.z>p.z&&
(p.z=A.z);w.left=l.x;w.right=p.x;w.top=p.y;w.bottom=l.y;w.updateProjectionMatrix()}w=v.shadowMap;z=v.shadowMatrix;y=v.shadowCamera;y.position.getPositionFromMatrix(v.matrixWorld);q.getPositionFromMatrix(v.target.matrixWorld);y.lookAt(q);y.updateMatrixWorld();y.matrixWorldInverse.getInverse(y.matrixWorld);v.cameraHelper&&(v.cameraHelper.visible=v.shadowCameraVisible);v.shadowCameraVisible&&v.cameraHelper.update();z.set(0.5,0,0,0.5,0,0.5,0,0.5,0,0,0.5,0.5,0,0,0,1);z.multiply(y.projectionMatrix);z.multiply(y.matrixWorldInverse);
k.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse);h.setFromMatrix(k);d.setRenderTarget(w);d.clear();K=r.__webglObjects;v=0;for(w=K.length;v<w;v++)if(B=K[v],z=B.object,B.render=!1,z.visible&&z.castShadow&&(!(z instanceof THREE.Mesh||z instanceof THREE.ParticleSystem)||!z.frustumCulled||h.intersectsObject(z)))z._modelViewMatrix.multiplyMatrices(y.matrixWorldInverse,z.matrixWorld),B.render=!0;v=0;for(w=K.length;v<w;v++)B=K[v],B.render&&(z=B.object,B=B.buffer,F=z.material instanceof THREE.MeshFaceMaterial?
z.material.materials[0]:z.material,A=0<z.geometry.morphTargets.length&&F.morphTargets,F=z instanceof THREE.SkinnedMesh&&F.skinning,A=z.customDepthMaterial?z.customDepthMaterial:F?A?g:f:A?e:c,B instanceof THREE.BufferGeometry?d.renderBufferDirect(y,r.__lights,null,A,B,z):d.renderBuffer(y,r.__lights,null,A,B,z));K=r.__webglObjectsImmediate;v=0;for(w=K.length;v<w;v++)B=K[v],z=B.object,z.visible&&z.castShadow&&(z._modelViewMatrix.multiplyMatrices(y.matrixWorldInverse,z.matrixWorld),d.renderImmediateObject(y,
r.__lights,null,c,z))}t=d.getClearColor();u=d.getClearAlpha();b.clearColor(t.r,t.g,t.b,u);b.enable(b.BLEND);d.shadowMapCullFace===THREE.CullFaceFront&&b.cullFace(b.BACK)}};THREE.ShadowMapPlugin.__projector=new THREE.Projector;
THREE.SpritePlugin=function(){function b(b,c){return b.z!==c.z?c.z-b.z:c.id-b.id}var d,c,e,f,g,h,k,l,p,q;this.init=function(b){d=b.context;c=b;e=b.getPrecision();f=new Float32Array(16);g=new Uint16Array(6);b=0;f[b++]=-1;f[b++]=-1;f[b++]=0;f[b++]=0;f[b++]=1;f[b++]=-1;f[b++]=1;f[b++]=0;f[b++]=1;f[b++]=1;f[b++]=1;f[b++]=1;f[b++]=-1;f[b++]=1;f[b++]=0;f[b++]=1;b=0;g[b++]=0;g[b++]=1;g[b++]=2;g[b++]=0;g[b++]=2;g[b++]=3;h=d.createBuffer();k=d.createBuffer();d.bindBuffer(d.ARRAY_BUFFER,h);d.bufferData(d.ARRAY_BUFFER,
f,d.STATIC_DRAW);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k);d.bufferData(d.ELEMENT_ARRAY_BUFFER,g,d.STATIC_DRAW);b=THREE.ShaderSprite.sprite;var s=d.createProgram(),t=d.createShader(d.FRAGMENT_SHADER),u=d.createShader(d.VERTEX_SHADER),v="precision "+e+" float;\n";d.shaderSource(t,v+b.fragmentShader);d.shaderSource(u,v+b.vertexShader);d.compileShader(t);d.compileShader(u);d.attachShader(s,t);d.attachShader(s,u);d.linkProgram(s);l=s;p={};q={};p.position=d.getAttribLocation(l,"position");p.uv=d.getAttribLocation(l,
"uv");q.uvOffset=d.getUniformLocation(l,"uvOffset");q.uvScale=d.getUniformLocation(l,"uvScale");q.rotation=d.getUniformLocation(l,"rotation");q.scale=d.getUniformLocation(l,"scale");q.alignment=d.getUniformLocation(l,"alignment");q.color=d.getUniformLocation(l,"color");q.map=d.getUniformLocation(l,"map");q.opacity=d.getUniformLocation(l,"opacity");q.useScreenCoordinates=d.getUniformLocation(l,"useScreenCoordinates");q.sizeAttenuation=d.getUniformLocation(l,"sizeAttenuation");q.screenPosition=d.getUniformLocation(l,
"screenPosition");q.modelViewMatrix=d.getUniformLocation(l,"modelViewMatrix");q.projectionMatrix=d.getUniformLocation(l,"projectionMatrix");q.fogType=d.getUniformLocation(l,"fogType");q.fogDensity=d.getUniformLocation(l,"fogDensity");q.fogNear=d.getUniformLocation(l,"fogNear");q.fogFar=d.getUniformLocation(l,"fogFar");q.fogColor=d.getUniformLocation(l,"fogColor");q.alphaTest=d.getUniformLocation(l,"alphaTest")};this.render=function(e,f,g,u){var v=e.__webglSprites,w=v.length;if(w){var y=p,z=q,B=u/
g;g*=0.5;var A=0.5*u;d.useProgram(l);d.enableVertexAttribArray(y.position);d.enableVertexAttribArray(y.uv);d.disable(d.CULL_FACE);d.enable(d.BLEND);d.bindBuffer(d.ARRAY_BUFFER,h);d.vertexAttribPointer(y.position,2,d.FLOAT,!1,16,0);d.vertexAttribPointer(y.uv,2,d.FLOAT,!1,16,8);d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,k);d.uniformMatrix4fv(z.projectionMatrix,!1,f.projectionMatrix.elements);d.activeTexture(d.TEXTURE0);d.uniform1i(z.map,0);var K=y=0,O=e.fog;O?(d.uniform3f(z.fogColor,O.color.r,O.color.g,O.color.b),
O instanceof THREE.Fog?(d.uniform1f(z.fogNear,O.near),d.uniform1f(z.fogFar,O.far),d.uniform1i(z.fogType,1),K=y=1):O instanceof THREE.FogExp2&&(d.uniform1f(z.fogDensity,O.density),d.uniform1i(z.fogType,2),K=y=2)):(d.uniform1i(z.fogType,0),K=y=0);for(var E,F,U=[],O=0;O<w;O++)E=v[O],F=E.material,E.visible&&0!==F.opacity&&(F.useScreenCoordinates?E.z=-E.position.z:(E._modelViewMatrix.multiplyMatrices(f.matrixWorldInverse,E.matrixWorld),E.z=-E._modelViewMatrix.elements[14]));v.sort(b);for(O=0;O<w;O++)E=
v[O],F=E.material,E.visible&&0!==F.opacity&&F.map&&(F.map.image&&F.map.image.width)&&(d.uniform1f(z.alphaTest,F.alphaTest),!0===F.useScreenCoordinates?(d.uniform1i(z.useScreenCoordinates,1),d.uniform3f(z.screenPosition,(E.position.x*c.devicePixelRatio-g)/g,(A-E.position.y*c.devicePixelRatio)/A,Math.max(0,Math.min(1,E.position.z))),U[0]=c.devicePixelRatio,U[1]=c.devicePixelRatio):(d.uniform1i(z.useScreenCoordinates,0),d.uniform1i(z.sizeAttenuation,F.sizeAttenuation?1:0),d.uniformMatrix4fv(z.modelViewMatrix,
!1,E._modelViewMatrix.elements),U[0]=1,U[1]=1),f=e.fog&&F.fog?K:0,y!==f&&(d.uniform1i(z.fogType,f),y=f),f=1/(F.scaleByViewport?u:1),U[0]*=f*B*E.scale.x,U[1]*=f*E.scale.y,d.uniform2f(z.uvScale,F.uvScale.x,F.uvScale.y),d.uniform2f(z.uvOffset,F.uvOffset.x,F.uvOffset.y),d.uniform2f(z.alignment,F.alignment.x,F.alignment.y),d.uniform1f(z.opacity,F.opacity),d.uniform3f(z.color,F.color.r,F.color.g,F.color.b),d.uniform1f(z.rotation,E.rotation),d.uniform2fv(z.scale,U),c.setBlending(F.blending,F.blendEquation,
F.blendSrc,F.blendDst),c.setDepthTest(F.depthTest),c.setDepthWrite(F.depthWrite),c.setTexture(F.map,0),d.drawElements(d.TRIANGLES,6,d.UNSIGNED_SHORT,0));d.enable(d.CULL_FACE)}}};
THREE.DepthPassPlugin=function(){this.enabled=!1;this.renderTarget=null;var b,d,c,e,f,g,h=new THREE.Frustum,k=new THREE.Matrix4;this.init=function(h){b=h.context;d=h;h=THREE.ShaderLib.depthRGBA;var k=THREE.UniformsUtils.clone(h.uniforms);c=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:k});e=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:k,morphTargets:!0});f=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,
vertexShader:h.vertexShader,uniforms:k,skinning:!0});g=new THREE.ShaderMaterial({fragmentShader:h.fragmentShader,vertexShader:h.vertexShader,uniforms:k,morphTargets:!0,skinning:!0});c._shadowPass=!0;e._shadowPass=!0;f._shadowPass=!0;g._shadowPass=!0};this.render=function(b,c){this.enabled&&this.update(b,c)};this.update=function(l,p){var q,r,s,t,u,v;b.clearColor(1,1,1,1);b.disable(b.BLEND);d.setDepthTest(!0);!0===l.autoUpdate&&l.updateMatrixWorld();p.matrixWorldInverse.getInverse(p.matrixWorld);k.multiplyMatrices(p.projectionMatrix,
p.matrixWorldInverse);h.setFromMatrix(k);d.setRenderTarget(this.renderTarget);d.clear();v=l.__webglObjects;q=0;for(r=v.length;q<r;q++)if(s=v[q],u=s.object,s.render=!1,u.visible&&(!(u instanceof THREE.Mesh||u instanceof THREE.ParticleSystem)||!u.frustumCulled||h.intersectsObject(u)))u._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,u.matrixWorld),s.render=!0;var w;q=0;for(r=v.length;q<r;q++)if(s=v[q],s.render&&(u=s.object,s=s.buffer,!(u instanceof THREE.ParticleSystem)||u.customDepthMaterial))(w=
u.material instanceof THREE.MeshFaceMaterial?u.material.materials[0]:u.material)&&d.setMaterialFaces(u.material),t=0<u.geometry.morphTargets.length&&w.morphTargets,w=u instanceof THREE.SkinnedMesh&&w.skinning,t=u.customDepthMaterial?u.customDepthMaterial:w?t?g:f:t?e:c,s instanceof THREE.BufferGeometry?d.renderBufferDirect(p,l.__lights,null,t,s,u):d.renderBuffer(p,l.__lights,null,t,s,u);v=l.__webglObjectsImmediate;q=0;for(r=v.length;q<r;q++)s=v[q],u=s.object,u.visible&&(u._modelViewMatrix.multiplyMatrices(p.matrixWorldInverse,
u.matrixWorld),d.renderImmediateObject(p,l.__lights,null,c,u));q=d.getClearColor();r=d.getClearAlpha();b.clearColor(q.r,q.g,q.b,r);b.enable(b.BLEND)}};
THREE.ShaderFlares={lensFlareVertexTexture:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nuniform sampler2D occlusionMap;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\nvec4 visibility = texture2D( occlusionMap, vec2( 0.1, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.1 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.9, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.9 ) ) +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ) +\ntexture2D( occlusionMap, vec2( 0.5, 0.5 ) );\nvVisibility = (       visibility.r / 9.0 ) *\n( 1.0 - visibility.g / 9.0 ) *\n(       visibility.b / 9.0 ) *\n( 1.0 - visibility.a / 9.0 );\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",fragmentShader:"uniform lowp int renderType;\nuniform sampler2D map;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvarying float vVisibility;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( 1.0, 0.0, 1.0, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * vVisibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"},
lensFlare:{vertexShader:"uniform lowp int renderType;\nuniform vec3 screenPosition;\nuniform vec2 scale;\nuniform float rotation;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uv;\nvec2 pos = position;\nif( renderType == 2 ) {\npos.x = cos( rotation ) * position.x - sin( rotation ) * position.y;\npos.y = sin( rotation ) * position.x + cos( rotation ) * position.y;\n}\ngl_Position = vec4( ( pos * scale + screenPosition.xy ).xy, screenPosition.z, 1.0 );\n}",
fragmentShader:"precision mediump float;\nuniform lowp int renderType;\nuniform sampler2D map;\nuniform sampler2D occlusionMap;\nuniform float opacity;\nuniform vec3 color;\nvarying vec2 vUV;\nvoid main() {\nif( renderType == 0 ) {\ngl_FragColor = vec4( texture2D( map, vUV ).rgb, 0.0 );\n} else if( renderType == 1 ) {\ngl_FragColor = texture2D( map, vUV );\n} else {\nfloat visibility = texture2D( occlusionMap, vec2( 0.5, 0.1 ) ).a +\ntexture2D( occlusionMap, vec2( 0.9, 0.5 ) ).a +\ntexture2D( occlusionMap, vec2( 0.5, 0.9 ) ).a +\ntexture2D( occlusionMap, vec2( 0.1, 0.5 ) ).a;\nvisibility = ( 1.0 - visibility / 4.0 );\nvec4 texture = texture2D( map, vUV );\ntexture.a *= opacity * visibility;\ngl_FragColor = texture;\ngl_FragColor.rgb *= color;\n}\n}"}};
THREE.ShaderSprite={sprite:{vertexShader:"uniform int useScreenCoordinates;\nuniform int sizeAttenuation;\nuniform vec3 screenPosition;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform float rotation;\nuniform vec2 scale;\nuniform vec2 alignment;\nuniform vec2 uvOffset;\nuniform vec2 uvScale;\nattribute vec2 position;\nattribute vec2 uv;\nvarying vec2 vUV;\nvoid main() {\nvUV = uvOffset + uv * uvScale;\nvec2 alignedPosition = position + alignment;\nvec2 rotatedPosition;\nrotatedPosition.x = ( cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y ) * scale.x;\nrotatedPosition.y = ( sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y ) * scale.y;\nvec4 finalPosition;\nif( useScreenCoordinates != 0 ) {\nfinalPosition = vec4( screenPosition.xy + rotatedPosition, screenPosition.z, 1.0 );\n} else {\nfinalPosition = projectionMatrix * modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\nfinalPosition.xy += rotatedPosition * ( sizeAttenuation == 1 ? 1.0 : finalPosition.z );\n}\ngl_Position = finalPosition;\n}",
fragmentShader:"uniform vec3 color;\nuniform sampler2D map;\nuniform float opacity;\nuniform int fogType;\nuniform vec3 fogColor;\nuniform float fogDensity;\nuniform float fogNear;\nuniform float fogFar;\nuniform float alphaTest;\nvarying vec2 vUV;\nvoid main() {\nvec4 texture = texture2D( map, vUV );\nif ( texture.a < alphaTest ) discard;\ngl_FragColor = vec4( color * texture.xyz, texture.a * opacity );\nif ( fogType > 0 ) {\nfloat depth = gl_FragCoord.z / gl_FragCoord.w;\nfloat fogFactor = 0.0;\nif ( fogType == 1 ) {\nfogFactor = smoothstep( fogNear, fogFar, depth );\n} else {\nconst float LOG2 = 1.442695;\nfloat fogFactor = exp2( - fogDensity * fogDensity * depth * depth * LOG2 );\nfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );\n}\ngl_FragColor = mix( gl_FragColor, vec4( fogColor, gl_FragColor.w ), fogFactor );\n}\n}"}};
YUI.add("thirdparty-threejs",function(b){},"1.0");
YUI.add("squarespace-dialog-member-invite-list",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.MemberInviteList=b.Base.create("MemberInviteList",b.Squarespace.Widgets.DialogField2,[b.WidgetParent],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");b.append('<div class="title">Invites Sent</div>');this._invitesEl=b.appendChild('<div class="invites"></div>')},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("data");
this._registerEvent(b.after("add",this._addInvite,this));this._registerEvent(b.after("remove",this._removeInvite,this))},syncUI:function(){d.superclass.syncUI.call(this);this._destroyChildren();this._addChildren()},_addChildren:function(){var c=this._invitesEl;this.get("data").each(function(e){this.add(new b.Squarespace.Widgets.MemberInvite({render:c,invite:e}))},this)},_addInvite:function(c){this.add(new b.Squarespace.Widgets.MemberInvite({render:this._invitesEl,invite:c.model}))},_removeInvite:function(b){this.each(function(e){e.get("invite")===
b.model&&e.destroy()})}},{CSS_PREFIX:"sqs-member-invite-list",ATTRS:{data:{value:new b.Squarespace.Models.MemberInviteList,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberInviteList)},readOnly:{value:!0}}})},"1.0",{requires:"base widget-parent squarespace-dialog-field-2 squarespace-models-member-invite squarespace-member-invite squarespace-attr-validators".split(" ")});
YUI.add("squarespace-layout-insert-point-controller",function(b){b.namespace("Squarespace.Layout").InsertPointController=b.Base.create("insertPointController",b.Base,[],{initializer:function(){this._insertPointGroups=[];this._layoutNodesToAlign=[];this._resizeEmitter=new b.Squarespace.ResizeEmitter;this.after("visibleChange",this._afterVisibleChange,this);this.after("enabledChange",this._afterEnabledChange,this)},destructor:function(){this._mousemove&&this._mousemove.detach();this._resizeEmitter.destroy();
this.destroyAllInsertPoints()},registerInsertPoint:function(d,c){if(c){var e=this._findInsertPointGroup(c);b.Lang.isNull(e)&&(e=this._initNewInsertPointGroup(c));e.insertPoints.push(d);this._setInsertPointNodes();e.events.push(d.after("insertPointsChange",this._setInsertPointNodes,this))}else console.log("[IPC] No layout node found."),d.destroy()},deregisterInsertPoint:function(d,c){var e=this._findInsertPointGroup(c);b.Lang.isNull(e)||(e.insertPoints.remove(d),0===e.insertPoints.length&&this._deleteInsertPointGroup(e))},
_findInsertPointGroup:function(d){return b.Array.find(this._insertPointGroups,function(b){return b.layoutNode===d})},_initNewInsertPointGroup:function(b){var c={layoutNode:b,insertPoints:[],events:[]};b.LayoutBuilder&&c.events.push(b.LayoutBuilder.on("widget:contentUpdate",function(){this.alignInsertPoints(b)},this));b.LayoutEditor&&c.events.push(b.LayoutEditor.on("destroy",function(){this.destroyAllInsertPoints(b)},this));this._insertPointGroups.push(c);return c},_deleteInsertPointGroup:function(d){b.Array.each(d.events,
function(b){b.detach()});this._insertPointGroups.remove(d)},destroyAllInsertPoints:function(d){var c=this._insertPointGroups;1<c.length&&b.Lang.isValue(d)&&(c=b.Array.filter(c,function(b){return b.layoutNode===d}));b.Array.each(c,function(c){b.Array.each(c.insertPoints,function(b){b.destroy()});this._deleteInsertPointGroup(c)},this)},alignInsertPoints:function(d,c){b.Lang.isValue(d)&&-1===b.Array.indexOf(this._layoutNodesToAlign,d)&&this._layoutNodesToAlign.push(d);c?this._alignInsertPoints(!0):this._debounceAlignInsertPoints()},
_alignInsertPoints:function(d){if(d||this.get("enabled")){var c=this._insertPointGroups,e=this._layoutNodesToAlign;1<c.length&&e.length&&(c=b.Array.filter(c,function(c){return-1<b.Array.indexOf(e,c.layoutNode)}));b.Array.each(c,function(c){b.Array.each(c.insertPoints,function(b){b.align(d)})},this);this.set("visible",!0);this._layoutNodesToAlign=[]}},_debounceAlignInsertPoints:b.Squarespace.debounce(function(){this._alignInsertPoints()},50,!1,!0),_setInsertPointNodes:function(){this.set("insertPointNodes",
b.all(".sqs-layout-insert-point"))},hide:function(){this.set("visible",!1)},show:function(){this.set("visible",!0);this.alignInsertPoints()},_afterEnabledChange:function(b){b.newVal?this._enable():this._disable()},_afterVisibleChange:function(b){this.toggleVisible(b.newVal)},toggleVisible:function(d){b.one("html").toggleClass("sqs-hide-insert-points",!d)},toggleDisabled:b.Squarespace.debounce(function(b){this._toggleDisabled(b)},30),_toggleDisabled:function(d){d?this.disable():b.all(".sqs-block-editing:not(.sqs-block-html)").size()||
this.enable()},disable:function(){this.setAttrs({visible:!1,enabled:!1})},_disable:function(){this._mousemove&&this._mousemove.detach();this._resizeEmitter.detachAll()},enable:function(){this.set("enabled",!0)},_enable:function(){this.alignInsertPoints();this._mousemove=b.one(b.config.doc).on("mousemove",this._onMouseMove,this);this._resizeEmitter.on("resize:start",this.hide,this);this._resizeEmitter.on("resize:end",this.show,this)},_onMouseMove:function(d){var c=d.pageX,e=d.pageY;b.Lang.isValue(this.get("insertPointNodes"))&&
this.get("insertPointNodes").each(function(b){var d=b.getXY(),h=c-(d[0]+12),d=e-(d[1]+12),h=80>=Math.abs(d)&&"row"===b.getData("ipType")?1:Math.floor(1/(Math.pow(h,2)/Math.pow(80,2)+Math.pow(d,2)/Math.pow(80,2)));h!==b.lastScale&&(b.toggleClass("sqs-fullsize",1<=h),b.lastScale=h)})},openBlockMenu:function(d){var c=b.Squarespace.EditControllerWebApp.getInstance().getInsertMenu(d.editMode,d);c.hide();c.setAttrs(d);c.focus()}},{ATTRS:{enabled:{value:!1},visible:{value:!1},insertPointNodes:{}}});b.namespace("Squarespace.Singletons").InsertPointController=
new b.Squarespace.Layout.InsertPointController},"1.0",{requires:["base","node","event","squarespace-layout-insert-block-menu-web-app","squarespace-debounce"]});
YUI.add("squarespace-stats-area-graph",function(b){var d=b.namespace("Squarespace.Stats.Widgets").AreaGraph=b.Base.create("areaGraph",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){d.superclass.initializer.apply(this,arguments);var c=this.get("render"),e=this.get("height"),f=this.get("width");this.set("height",null===e&&c&&b.Lang.isFunction(c.height)?c.height():"auto");this.set("width",null===f&&c&&b.Lang.isFunction(c.width)?c.width():"auto")},renderUI:function(){d.superclass.renderUI.apply(this,
arguments);var b=this.get("height"),e=this.get("width"),f=this.get("contentBox"),g=this.get("interpolate"),h=f._node,k=d3.time.scale().range([0,e]),l=d3.scale.linear().range([b,0]),f=d3.svg.area().interpolate(g).x(function(b){return k(b.d)}).y0(b).y1(b),g=d3.svg.area().interpolate(g).x(function(b){return k(b.d)}).y0(b).y1(function(b){return l(1.05*b.count)}),h=d3.select(h).append("svg");h.attr("width",e).attr("height",b);h.append("g").attr("class","range").append("path").attr("class","stream");this.set("svg",
h);this.set("x",k);this.set("y",l);this.set("emptyArea",f);this.set("area",g)},syncUI:function(){var b=this.get("model"),e=this.get("svg"),d=this.get("x"),g=this.get("y"),h=this.get("cls"),k=this.get("data"),l=this.get("area"),p;d.domain(d3.extent(k.map(function(b){return b.d})));b&&(p=b.get("totalsByDate"));var q;q=p?1.05*d3.extent(p.map(function(b){return b.count}))[1]:1.05*d3.extent(k.map(function(b){return b.count}))[1];g.domain([0,q]);l.y1(function(b){return g(b.count+0.05*q)});e=e.selectAll("path");
e.datum(k);null!==h&&e.attr("class",h);b&&this._changeExtent(b.get("extent"),!0)},bindUI:function(){d.superclass.bindUI.apply(this,arguments);var b=this.get("model");if(b)b.on("extentChange",this._onExtentChange,this);this.after("dataChange",this.syncUI,this);this.on("clsChange",this._onClassChange,this)},_changeExtent:function(b,e){var d=this.get("x"),g=this.get("svg"),h=this.get("area"),k=this.get("emptyArea"),l=this.get("animate");d.domain(b);e&&l?g.selectAll("path").attr("d",k).transition().duration(750).attr("d",
h):g.selectAll("path").attr("d",h)},_onExtentChange:function(b){this._changeExtent(b.newVal)},_onClassChange:function(b){b=b.newVal;this.get("svg").selectAll("path").attr("class",b)}},{CSS_PREFIX:"sqs-d3-area-graph",ATTRS:{model:{value:null},data:{value:null},width:{value:null},height:{value:null},interpolate:{value:"linear"},animate:{value:!1},x:{value:null},y:{value:null},emptyArea:{value:null},area:{value:null},svg:{value:null},cls:{value:null}}})},"1.0",{requires:["base-base","squarespace-ss-widget",
"squarespace-attr-validators","thirdparty-d3"]});
YUI.add("squarespace-image-picker-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["image-picker.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="header">\n  <div class="instructions"></div>\n  <div class="controls">\n    <div class="cancel"></div>\n    <div class="confirm"></div>\n  </div>\n  <div class="information">\n    <div class="error"></div>\n    <div class="sqs-spin light extra-large"></div>\n  </div>\n  <div class="images"></div>\n  <div class="pagination">\n    <span class="prev"></span>\n    <span class="next"></span>\n  </div>\n  <div class="size-visualizer">\n      <div class="ruler height"></div>\n      <div class="ruler width"></div>\n      <div class="label height"></div>\n      <div class="label width"></div>\n  </div>\n</div>'})})();b.Handlebars.registerPartial("image-picker.html".replace("/",
"."),d.templates["image-picker.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-edit-controller-web-app",function(b){var d=b.namespace("Squarespace").EditControllerWebApp=b.Base.create("editcontroller",b.Squarespace.EditControllerBase,[],{initializer:function(){this._dragSelection=new b.Squarespace.DragSelection({node:"body",enabled:!1});b.on("key",this._onDeleteKeyHandler,b.config.doc,"down:backspace,46",this)},pluginLayoutEditor:function(c,e,f,g){this.disableInsertPoints();var h=d.superclass.pluginLayoutEditor.apply(this,arguments),k=this._getNewDragRegionConfig(c);
b.Lang.isValue(k)&&(this._destroyDragSelection(),this._initializeDragSelection(k));this._maintainDragSelectionRegion(c);this.enableDragSelection();this.enableInsertPoints();return h},enableDragSelection:function(){this._dragSelection.get("enabled")||this._dragSelection.set("enabled",!0)},disableDragSelection:function(){this._dragSelection.get("enabled")&&this._dragSelection.set("enabled",!1)},_getNewDragRegionConfig:function(c){var e=b.one("body"),d=c.ancestor(".sqs-content-manager-base");c=c.ancestor(".sqs-dialog-layout-wrapper-content");
var g=[".sqs-block",".standard-dialog-wrapper"];b.Lang.isValue(d)?e=d:b.Lang.isValue(c)&&(e=c,g=[".sqs-block","textarea","input"]);return e===this._dragSelectionRegionNode?null:{dragRegionNode:e,invalidRegions:g}},_initializeDragSelection:function(b){this._dragSelectionRegionNode=b.dragRegionNode;this._dragSelection.set("invalidRegions",b.invalidRegions);this._dragSelection.set("enabled",!0);this._dragSelectionChangedEvent=this._dragSelection.on(["selection-complete","selection-dragged"],this._dragSelectionChanged,
this)},_maintainDragSelectionRegion:function(c){b.Lang.isValue(this._contentChangedEvents)||(this._contentChangedEvents=[]);this._contentChangedEvents.push(c.LayoutBuilder.after("widget:contentUpdate",b.Squarespace.debounce(function(){this._dragSelection.set("boundingRegion",this._dragSelectionRegionNode.get("region"))},20),this))},_destroyDragSelection:function(){this._dragSelection.set("enabled",!1);b.Lang.isValue(this._dragSelectionChangedEvent)&&this._dragSelectionChangedEvent.detach();b.Lang.isValue(this._contentChangedEvents)&&
b.Array.each(this._contentChangedEvents,function(b){b.detach()})},_dragSelectionChanged:function(c){b.all(".sqs-layout.sqs-editing .sqs-block").each(function(e){var d=b.Widget.getByNode(e);d.get("lockedLayout")||(e.intersect(c.region).inRegion?d.set("selected",1):d.set("selected",0))})},layoutDragStart:function(c){d.superclass.layoutDragStart.apply(this,[c]);b.Squarespace.Singletons.InsertPointController.toggleDisabled(!0)},layoutDragEnd:function(){d.superclass.layoutDragEnd.call(this);b.Squarespace.Singletons.InsertPointController.toggleDisabled(!1)},
_disableEditing:function(){this._destroyBlockMenu();this._destroyInsertPointController();this._destroyDragSelection();d.superclass._disableEditing.call(this)},destroyLayoutEditor:function(){this.disableInsertPoints();d.superclass.destroyLayoutEditor.apply(this,arguments);this._destroyDragSelection();this.enableInsertPoints()},_destroyBlockMenu:function(){b.Squarespace.Singletons.BlockMenu&&b.Squarespace.Singletons.BlockMenu.destroy()},_onDeleteKeyHandler:function(c){function e(b){return".sqs-layout.sqs-editing ."+
b+":not(.sqs-block-locked-layout)"}c.target.ancestor("input, textarea, [contenteditable=true]",!0)||(c.halt(),c=b.all(e("sqs-block-focused")+", "+e("sqs-selected")),0<c.size()&&this._showRemoveBlocksDialog(c))},_showRemoveBlocksDialog:function(c){var e=1<c.size()?"s":"",d=1<c.size()?"these blocks":"this block",g=[];(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Block"+e,"strings.message":"Are you sure you wish to delete "+d+"?"})).on("confirm",function(){c.each(function(c){g.push(c.ancestor(".sqs-layout"));
b.Widget.getByNode(c).queueForDestruction()});g=b.Array.unique(g);b.Array.each(g,function(b){b.LayoutEditor.cleanGrid(!0)})})},_destroyInsertPointController:function(){b.Squarespace.Singletons.InsertPointController&&b.Squarespace.Singletons.InsertPointController.destroy()},enableInsertPoints:function(){b.Squarespace.Singletons.InsertPointController&&b.Squarespace.Singletons.InsertPointController.toggleDisabled(!1)},disableInsertPoints:function(){b.Squarespace.Singletons.InsertPointController&&b.Squarespace.Singletons.InsertPointController.toggleDisabled(!0);
this.hideInsertMarker()},alignInsertPoints:function(c,e){b.Squarespace.Singletons.InsertPointController&&b.Squarespace.Singletons.InsertPointController.alignInsertPoints(c,e)},destructor:function(){this._destroyDragSelection();this._dragSelection.destroy()}},{ATTRS:{defaultEditMode:{readOnly:!0,value:b.Squarespace.Layout.EditMode.WEB_APP},renderableBlockSet:{readOnly:!0,value:[{ctor:b.Squarespace.Layout.RenderableBlocksWebApp,editMode:b.Squarespace.Layout.EditMode.WEB_APP},{ctor:b.Squarespace.Layout.RenderableBlocksEmail,
editMode:b.Squarespace.Layout.EditMode.EMAIL}]},insertMenuSet:{readOnly:!0,value:[{ctor:b.Squarespace.Layout.InsertBlockMenuWebApp,editMode:b.Squarespace.Layout.EditMode.WEB_APP},{ctor:b.Squarespace.Layout.InsertBlockMenuEmail,editMode:b.Squarespace.Layout.EditMode.EMAIL}]}}});d.getInstance=function(){var c;return function(){b.Lang.isValue(c)||(c=new d);return c}}()},"1.0",{requires:"base event json-parse node parallel squarespace-edit-controller-base squarespace-layout-editor squarespace-layout-insert-point squarespace-layout-insert-block-menu-web-app squarespace-layout-insert-block-menu-email squarespace-layout-renderable-blocks-web-app squarespace-layout-renderable-blocks-email squarespace-models-content-collection squarespace-models-layout squarespace-models-template squarespace-ui-base squarespace-drag-selection squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-widgets-newsletters-subscribers-list-header",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.NewslettersSubscribersListHeader=b.Base.create("NewslettersSubscribersListHeader",b.Squarespace.Widgets.ModelListHeader,[],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-header-content");var c=this.get("models");this._paginator=new b.Squarespace.Widgets.ModelListPaginator({models:c});c.after("load",this._updateControlsVisibility,this)},
destructor:function(){this._paginator.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this._paginator;b.hide();b.render(this.get("contentBox").one(".header-controls"))},_syncCurrentTab:function(){d.superclass._syncCurrentTab.call(this);this.get("models").firstPage()},_updateControlsVisibility:function(){var b=this.get("models"),e=this._paginator;!b.get("hasPreviousPage")&&!b.get("hasNextPage")?e.hide():e.show()},showAddSubDialog:function(c){var e=new b.Squarespace.EditingDialog({loadingText:"Loading...",
style:"flyout",width:385,overlay:0.5,closeOthers:!1,flyoutPointerDirection:"centered",tabs:[{title:c?"Edit Subscriber":"Add Subscriber",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Enter the subscriber's info",padding:[10,10]}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{"strings.title":"First Name",name:"firstName",width:0.5,submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Text,config:{"strings.title":"Last Name",
name:"lastName",width:0.5,submitOnEnter:!0}}]},{ctor:b.Squarespace.DialogFields.Text,config:{"strings.title":"Email",name:"email",submitOnEnter:!0}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:c?"Save Subscriber":"Add Subscriber"}]});e.once("send-requested",function(){if(!c){var d={id:null,firstName:e.fields.firstName.getValue(),lastName:e.fields.lastName.getValue(),email:e.fields.email.getValue(),attributes:[3],subscriber:{source:2},isNew:!0};this.get("models").create(new b.Squarespace.Models.SiteUser(d),
b.bind(function(b,c){b?e.showErrors(c.errors):(e.close(),this.get("models").firstPage())},this))}},this);e.show();if(c){var d=this.model.getById(c);e.getField("firstName").setValue(d.get("firstName"));e.getField("lastName").setValue(d.get("lastName"));e.getField("email").setValue(d.get("email"))}}},{CSS_PREFIX:"sqs-newsletters-subscribers-list-header",ATTRS:{actionButtons:{valueFn:function(){return[{name:"addSub",label:"Add Subscribers",action:b.bind(this.showAddSubDialog,this)}]}},tabs:{value:[{name:"first",
title:"First Tab",description:'Squarespace Newsletters is a new beta feature that allows you to easily send newsletters to a mailing list from your website in a completely integrated way. We look forward to your feedback and suggestions. <a href="#">Watch Video</a>'}]},strings:{value:{title:"Subscribers"}}}})},"1.0",{requires:["base","squarespace-enum","squarespace-models-site-user-list","squarespace-widgets-model-list-header","squarespace-widgets-model-list-paginator"]});
YUI.add("squarespace-content-manager-navigation-bar-dd",function(b){function d(c,e,d,g,h){for(var k=c.get("parentNode").get("children"),l=k.indexOf(c),p=k.indexOf(e),q=Math.min(l,p),l=Math.max(l,p),p=new b.Squarespace.AsyncTaskSynchronizer({completionCallback:function(){g&&g.call(h)}}),r=q;r<=l;r++)k.item(r).plug(b.Squarespace.PositionAnimator),k.item(r).positionAnimator.hold(),p.add(k.item(r).positionAnimator,"released");c.insert(e,d);for(c=q;c<=l;c++)k.item(c).hasClass("dd-drag-group")||k.item(c).positionAnimator.release(!0)}
b.namespace("Squarespace.ContentManager").NavigationBarDD=b.Base.create("NavigationBarDD",b.Base,[],{initializer:function(){this._ddDelegate=new b.DD.Delegate({container:this.get("contentBox"),nodes:".sqs-navigation-item",dragConfig:{groups:["navigation"]}});this._ddDelegate.after("drag:start",this._dragStart,this);this._ddDelegate.on("drag:align",this._dragAlign,this);this._ddDelegate.on("drag:end",this._dragEnd,this);this._ddDelegate.dd.plug(b.Squarespace.Plugin.DDSuperProxy,{movingClass:"sqs-navigation-item-dragging",
cloneClass:"sqs-navigation-item-proxy"});this._ddDelegate.dd.plug(b.Plugin.DDConstrained,{stickY:!0});this._ddDelegate.dd.plug(b.Plugin.DDNodeScroll,{node:this.get("scrollableNode"),horizontal:!1,vertical:!0});this.publish("reordered",{emitFacade:!0})},destructor:function(){this._ddDelegate.destroy()},_dragStart:function(b){this._refreshPixelMap(b.target.get("node"));this._requiresNavigationSave=[];this._lastRegionAction=null;this._scrollListener=this.get("scrollableNode").on("scroll",function(){this._refreshPixelMap(b.target.get("node"))},
this)},_dragAlign:function(c){var e=c.pageY-b.one(b.config.doc).get("scrollTop"),d=b.Array.find(this.regions,function(b){return b.startY<e&&b.stopY>e?!0:!1});d&&this._doRegionAction(d,c.target.get("node"))},_doRegionAction:function(c,e){if(this._lastRegionAction!=c&&!this._animating){var f=c.action,g=e.get("parentNode"),h=b.bind(function(){this._updateModel(c,e);this._refreshPixelMap(e,c,g)},this);if("before"==f||"after"==f){var k=e.get("parentNode");if(c.insertNode.get("parentNode")==k){var l=k.get("children"),
k=l.indexOf(c.insertNode),l=l.indexOf(e);if("before"==f&&k<l||"after"==f&&k>l)100>this.regions.length?(this._animating=!0,d(c.insertNode,e,f,function(){h();this._animating=!1},this)):(c.insertNode.insert(e,f),h())}else c.insertNode.insert(e,f),h()}else"insert"==f&&(c.insertNode.insert(e),h());this._lastRegionAction=c}},_refreshPixelMap:function(c,e,d){var g=this._ddDelegate.get("container");if(b.Lang.isValue(c)&&b.Lang.isValue(e)&&b.Lang.isValue(d)){for(;(!d.contains(e.insertNode)||!d.contains(c))&&
!(d=d.get("parentNode"),d==b.config.win););g=d}else this.regions=[],this.regionsById={};var h=this._getDragItemType(c);this._getDropZoneNodes(g).each(function(b){this._generateRegions(b,h)},this);b.DD.DDM._debugRegionMap&&this._debugRegions()},_getDragItemType:function(c){c=b.Widget.getByNode(c);var e=c.get("item").get("collection");if(b.Lang.isValue(e))return e.get("typeName");if(c.get("item").get("externalLink"))return"link"},_getDropZoneNodes:function(b){return b.all(".sqs-navigation-item:not(.yui3-dd-dragging),.sqs-navigation-item-folder:not(.sqs-navigation-item-folder-empty) .folder-item-wrapper,.sqs-navigation-item-folder:not(.sqs-navigation-item-folder-empty) footer,.empty-message")},
_getRegion:function(b){return b.getDOMNode().getBoundingClientRect()},_generateRegions:function(c,e){this._removeAllRegionsForNode(c);this._currentTop||(this._currentTop=this.get("scrollableNode").get("scrollTop")+this.get("scrollableNode").get("offsetHeight"));var d=this._getRegion(c);if(!(0===d.height||0===d.width||d.top>this._currentTop)&&!c.ancestor(".sqs-navigation-item-proxy,.sqs-navigation-item-dragging",!0)){var g=["before","after"],h=c,k=c.ancestor(".sqs-navigation-item-folder",!0),l=c.hasClass("empty-message");
if(k){var p=b.Widget.getByNode(k),k=c.hasClass("sqs-navigation-item-folder"),q=!0;e&&(q=p.get("item").get("collection").getTemplateConfiguration().get("acceptTypes"),b.Lang.isArray(q)?q=-1!==q.indexOf(e):(q=p.get("item").get("collection"),b.Squarespace.Logger.log("_generateRegions",{collectionId:q.get("id"),typeName:q.get("typeName")}),q=!0));var r=p.get("item").get("children").isEmpty(),p=!p.get("expanded");if(!k&&!q)return;if(k&&!q)g=["before","after"];else if(r&&!p)g=["before","none","after"];
else if(k&&!p||l&&p||!k&&p)return;c.hasClass("folder-item-wrapper")?(h=c.ancestor(".sqs-navigation-item"),g=["before","none"]):c.test("footer")&&(h=c.ancestor(".sqs-navigation-item"),g=["none","after"])}l&&(g=["insert"],h=c.get("parentNode").one(".items"));l=g.length;for(k=0;k<l;k++)p=g[k],c.generateID(),"none"!=p&&(p={startX:100,stopX:350,startY:d.top+d.height/l*k,stopY:d.top+d.height/l*(k+1),action:p,node:c,insertNode:h,widget:b.Widget.getByNode(c)},this._addRegionForNode(c,p))}},_removeAllRegionsForNode:function(b){b=
b.generateID();var e=this.regionsById[b];if(e)for(var d in e)this.regions.remove(e[d]);this.regionsById[b]={}},_addRegionForNode:function(b,e){var d=b.generateID();this.regionsById[b.generateID()]=this.regionsById[b.generateID()]||{};var g=e.action,h=this.regionsById[d][g];h&&this.regions.remove(h);this.regionsById[d][g]=e;this.regions.unshift(e)},_debugRegions:function(){var c=b.one("#regions-debug")||b.one("body").appendChild(b.Node.create('<div id="regions-debug"></div>'));c.setStyles({position:"fixed",
top:0,left:0,zIndex:99999999,pointerEvents:"none",color:"white",fontSize:"10px",textAlign:"right"});c.empty();b.Array.each(this.regions,function(e){c.appendChild(b.Node.create('<div class="region-debug"></div>')).setStyles({position:"absolute",top:e.startY,height:e.stopY-e.startY,left:e.startX,width:e.stopX-e.startX,background:"rgba(255,0,0,0.1)"}).setContent(e.action+" &mdash; "+this._getDebugNodeIdentifier(e.node)+" &mdash; "+e.startY+" &mdash; "+e.stopY)},this)},_getDebugNodeIdentifier:function(c){var e=
b.Widget.getByNode(c);c=e.get("item");e=e.get("navigation");return c?c.get("title"):e.get("name")},_updateModel:function(c,e){var d=this._getDataFromDragAndDrop(e,c.node),g=0;"before"==c.action?g=d.dropItemList.indexOf(d.dropItem)-1:"after"==c.action?g=d.dropItemList.indexOf(d.dropItem)+1:"insert"==c.action&&(g=0);d.dragItemList.remove(d.dragItem,{source:"dd",node:d.dragNode});b.instanceOf(d.dropItemList,b.Squarespace.Models.NavigationFolderItemList)?(d.dragItem.setFolderItemList(d.dropItemList),
d.dropItem.getNavigationItemList()?d.dragItem.setNavigationItemList(d.dropItem.getNavigationItemList()):b.Squarespace.Logger.log("navigationDD-folder",{message:"Missing navigation item list? Should not have happened."})):(d.dragItem.setFolderItemList(null),d.dragItem.setNavigationItemList(d.dropItemList));d.dropItemList.add(d.dragItem,{source:"dd",index:g,node:d.dropNode});b.Array.each([d.dragItemList,d.dropItemList],function(c){b.instanceOf(c,b.Squarespace.Models.NavigationFolderItemList)&&(c=c.getTemplateNavigation().get("itemList"));
-1==this._requiresNavigationSave.indexOf(c)&&this._requiresNavigationSave.push(c)},this);d.dropItemList.indexOf(d.dragItem)!==g&&b.Squarespace.Logger.log("Mismatch in index",{action:"_updateModel",filename:"navgation-bar-dd"})},_getDataFromDragAndDrop:function(c,e){var d=b.Widget.getByNode(c).get("item"),g=d.getNavigationItemList(),h=d.getFolderItemList();b.Lang.isValue(h)&&(g=h);var k;e.hasClass("empty-message")?e.ancestor(".sqs-navigation-item-folder",!0)?(h=b.Widget.getByNode(e).get("item"),k=
b.Widget.getByNode(e).get("item").get("children")):(h=null,k=b.Widget.getByNode(e).get("navigation").get("itemList")):(h=b.Widget.getByNode(e).get("item"),k=h.getNavigationItemList());return{dragNode:c,dragItem:d,dragItemList:g,dropNode:e,dropItem:h,dropItemList:k}},_dragEnd:function(){function c(e,d){b.Array.forEach(d.toArray(),function(b){d.remove(b,{source:"dd"})},this);var g="> .items > .sqs-navigation-item";b.instanceOf(e,b.Squarespace.ContentManager.NavigationItemFolder)&&(g="> .items-wrapper > .items-inner > .items > .sqs-navigation-item");
e.get("contentBox").all(g).each(function(e){e=b.Widget.getByNode(e);b.instanceOf(e,b.Squarespace.ContentManager.NavigationItemFolder)&&c(e,e.get("item").get("children"));b.instanceOf(e,b.Squarespace.ContentManager.NavigationItem)&&d.add(e.get("item"),{source:"dd"})})}this._scrollListener.detach();this.fire("reordered",{navigations:this._requiresNavigationSave});b.Array.each(this._requiresNavigationSave,function(e){var d=!1;b.Widget.getByNode(this.get("contentBox")).each(function(g){if(b.instanceOf(g,
b.Squarespace.ContentManager.Navigation)){var h=g.get("navigation").get("itemList");h==e&&(c(g,h),d=!0)}},this);d?e.save():b.Squarespace.Logger.log("Could not match navigation",{navigationName:e.toJSON(!0)})},this)}},{ATTRS:{contentBox:{},scrollableNode:{}}});b.DD.DDM._debugRegionMap=!1},"1.0",{requires:["base","squarespace-dd-behaviors","dd"]});
YUI.add("squarespace-block-summary-v2",function(b){var d=b.namespace("Squarespace.Block").SummaryV2=b.Base.create("block-summary-v2",b.Squarespace.Block.ModelSyncBase,[],{syncUI:function(){d.superclass.syncUI.call(this);this._plugImageLoader()},bindUI:function(){this.get("model").after("change",this._renderBlock,this);this.after("resized",this._renderBlock,this)},_renderBlock:function(b){this.get("boundingBox").setData("block",this.get("model").getAttrs());this._shouldGetWidgetRendering(b)?d.superclass._renderBlock.call(this):
this._updateWhitelistedAttrs(b)},_renderSuccess:function(b){this.set("widgetContent",b.html);this._setWidgetContent()},_setWidgetContent:function(){var c=b.Node.create(this.get("widgetContent")),e=this.get("contentBox");e.setHTML(c);b.Squarespace.GalleryManager.initializeBlock(e)},_shouldGetWidgetRendering:function(c){return!b.Lang.isValue(c)||!b.Object.hasKey(c,"changed")?!0:!b.Squarespace.Block.Utils.checkWhitelist(this.get("modelWhiteList"),c.changed)},_updateWhitelistedAttrs:function(b){var e=
this.get("model"),d=this.get("contentBox");b.changed.headerText?d.one(".summary-heading").setHTML(e.get("headerText")):b.changed.textSize?this._updateClassThatStartsWith("summary-block-setting-text-size-",e.get("textSize"),d.get("children")):b.changed.textAlignment?this._updateClassThatStartsWith("summary-block-setting-text-align-",e.get("textAlignment"),d.get("children")):b.changed.listImageAlignment&&this._updateClassThatStartsWith("summary-block-setting-design-list-thumbnail-",e.get("listImageAlignment"),
d.get("children"))},_updateClassThatStartsWith:function(c,e,d){var g=d.getAttribute("class")[0].split(" ");b.Array.forEach(g,function(b){b=b.trim();b.startsWith(c)&&d.hasClass(b)&&d.replaceClass(b,c+e)},this)},_getDefaultContent:function(){return{collectionId:"",design:"autogrid",headerText:"Featured",textSize:"medium",pageSize:10,imageAspectRatio:1.5,columnWidth:270,gutter:60,listImageSize:30,listImageAlignment:"left",slidesPerRow:3,textAlignment:"left",showTitle:!0,showThumbnail:!0,showExcerpt:!0,
showReadMoreLink:!1,showPrice:!0,showPastOrUpcomingEvents:"upcoming",metadataPosition:"below-content",primaryMetadata:null,secondaryMetadata:null,filter:{},autoCrop:!0,lightbox:!1,mixedContent:!0}}},{CSS_PREFIX:"sqs-block-summary-v2",MODEL:b.Squarespace.ContentModel.SummaryV2Block,ATTRS:{modelWhiteList:{setter:function(c){return b.Lang.isArray(c)?c:b.Lang.isString(c)?[c]:[]},value:["headerText","textSize","listImageAlignment","textAlignment"]},defaultContentModel:{valueFn:"_getDefaultContent"},editor:{value:b.Squarespace.Block.Editor.SummaryV2},
type:{value:b.Squarespace.BlockType.SUMMARY_V2},widgetContent:{value:""},floatable:{value:!0}}})},"1.0",{requires:"base model squarespace-block-base-modelsync squarespace-block-summary-v2-editor squarespace-block-utils squarespace-enum squarespace-gallery-ng squarespace-image-loader squarespace-models-content-collection squarespace-video-loader".split(" ")});
YUI.add("squarespace-member-invite-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["member-invite.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression,p=d.helperMissing;b='<div class="image"></div>\n\n<div class="info">\n  <div class="name">\n    ';(h=d.name)?h=h.call(c,{hash:{},data:k}):(h=c.name,h="function"===typeof h?h.apply(c):h);b+=l(h)+'\n  </div>\n\n  <div class="time">Invited ';
k={hash:{},data:k};return b+=l((h=d["humanizedate-format"]||c["humanizedate-format"],h?h.call(c,c.lastSentOn,k):p.call(c,"humanizedate-format",c.lastSentOn,k)))+"</div>\n</div>\n"})})();b.Handlebars.registerPartial("member-invite.html".replace("/","."),d.templates["member-invite.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-domains-list",function(b){b.namespace("Squarespace.DialogFields");var d=function(b,e){return b.primary?-1:e.primary?1:0};b.Squarespace.DialogFields.DomainsList=b.Base.create("domainsList",b.Squarespace.DialogFields.List,[],{initializer:function(){this.set("strings.emptyText","You do not have any domains associated with your account. Use the plus in the upper right to add one.");this.set("strings.title","")},syncUI:function(){b.Squarespace.DialogFields.DomainsList.superclass.syncUI.apply(this,
arguments);var c=this.get("id")+"child-events";b.detachAll(c+"|*");b.Array.each(this._items,function(b){b.after(c+"|open",function(){this._closeAllOtherDomains(b)},this);b.after(c+"|primary-domain-set",function(){this._makePrimaryDomain(b);this._unsetOtherPrimaryDomains(b)},this);b.on(c+"|remove-domain",function(c){c.preventDefault();this._removeDomain(b)},this);b.on(c+"|rename-domain",function(c){c.preventDefault();this._renameBuiltinDomain(b)},this)},this)},checkDomainStatuses:function(){this.fire("domain-check-start");
b.Data.post({url:"/api/domains/CheckDomains",success:function(c){this.get("destroyed")||(this.fire("domain-check-success"),b.Object.each(c.domainStatuses,function(c,d){var g=b.Array.find(this._items,function(b){return b.get("data.name")===d});g&&g.set("data.status",c)},this))},failure:function(){this.get("destroyed")||this.fire("domain-check-failure")}},this)},_renameBuiltinDomain:function(c){var e=new b.Squarespace.EditingDialog({name:"renameDomain",style:"flyout",savingText:"Renaming Domain...",
overlay:0.5,width:470,top:200,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Change Site URL"}],tabs:[{title:"Rename Built-in Domain",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Account ID",text:"Your Account ID represents the name of your site in the URL bar if you are not using a custom domain (http://&lt;accountid&gt;.squarespace.com/).",padding:[15,
0]}},{ctor:b.Squarespace.DialogFields.Text,config:{required:!0,name:"squarespaceId","strings.placeholder":"sitename",keyFilter:"[a-zA-Z0-9\\-]",keyFilterExplanation:NaN,submitOnEnter:!0,className:"large"}}]}]});e.setInitialData({squarespaceId:b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"])});e.on("send-requested",function(){var c=e.getField("squarespaceId").getValue(),d=new b.Squarespace.Widgets.Confirmation({"strings.title":"Confirm Site URL Change","strings.message":"You are about to change your site primary URL. External links to your site will break. After making this change, you will need to log back into your site."});
d.on("cancel",function(){e.allowEditing()});d.on("confirm",function(){b.Data.post({url:"/api/domains/UpdateSiteIdentifier",data:{squarespaceId:c},success:function(b){document.location.href=b.redirectUrl},failure:function(c){b.Lang.isValue(c.errors)?e.showErrors(c.errors):(new b.Squarespace.Widgets.Alert({"strings.title":"Unable to rename domain","strings.message":c.error}),e.close())}})},this)},this);e.show()},_removeDomain:function(c){c&&(c.close(),c.set("dataState","loading"),b.Data.post({url:"/api/domains/RemoveDomain",
data:{domainId:c.get("data.id")},success:function(e){new b.Squarespace.Widgets.Information({"strings.title":"Domain Removed","strings.message":"<strong>"+name+"</strong> successfully removed"});c.destroy();this.syncUI();if(e.primaryDomain){var d=e.primaryDomain;e.primaryDomain.startsWith("www.")&&(d=d.substring(4));this._findDomainByName(d).setAttrs({"data.primary":!0,"data.wwwOn":!0})}this.fire("domain-removed",{domain:c})},failure:function(){new b.Squarespace.Widgets.Information({"strings.title":"Domain Removal Failed",
"strings.message":"<strong>"+name+"</strong> was not removed"});c.set("dataState","loaded")}},this))},_findDomainByName:function(b){var e;this.some(function(d){return d.get("data.name")===b?(e=d,!0):!1});return e},_makePrimaryDomain:function(c){c&&b.Data.put({url:"/api/rest/websites/primary-domain",data:{primaryDomain:c.getFullDomainName()},success:function(b){this._unsetOtherPrimaryDomains(c)},failure:function(){new b.Squarespace.Widgets.Information({"strings.title":"Primary Domain Change Fialed",
"strings.message":"<strong>"+c.get("data.name")+"</strong> was not set as the primary domain."});c.set("data.primary",!1)}},this)},_getTotalHeight:function(){return b.Array.reduce(this._items,0,function(b,e){return b+e.get("boundingBox").get("offsetHeight")})},_closeAllOtherDomains:function(c){b.Array.each(this._items,function(b){b!==c&&b.close()},this)},_unsetOtherPrimaryDomains:function(c){b.Array.each(this._items,function(b){b!==c&&b.makeNonPrimaryDomain()},this)}},{ATTRS:{showAddControl:{value:!1},
listItemConstructor:{value:b.Squarespace.DialogFields.Domain},apiURLs:{value:{readURL:{url:"/api/domains/GetDomains",responseDataProperty:"domains",responseDataSanitizer:function(c){if(c&&c.primaryDomain&&c.domains){var e=c.domains.map(function(e){var d=e.name,d=d===c.primaryDomain||"www."+d===c.primaryDomain;return b.merge(e,{wwwOn:d&&c.primaryDomain.startsWith("www."),primary:d})});c.domains=e.sort(d)}return c}}}}},CSS_PREFIX:"sqs-domains-list"})},"1.0",{requires:"base base-build squarespace-dialog-description squarespace-dialog-domain squarespace-dialog-field-2 squarespace-list squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-audio-player",function(b){var d=function(){},c=b.namespace("Squarespace.Widgets").AudioPlayer=b.Base.create("audioPlayer",b.Squarespace.Widgets.SSWidget,[],{initializer:function(c){c=this.get("render");b.Lang.isBoolean(c)?c=null:b.Lang.isString(c)&&(c=b.one(c));c&&(c._audioPlayer&&c._audioPlayer.destroy(),c._audioPlayer=this,b.Object.each(c.getData(),function(b,c){b&&this.set(c,b)},this));b.use("thirdparty-soundmanager2",d)},destructor:function(){this._sound&&(this.stop(),this._sound.destruct())},
render:function(){var e=arguments;b.use("thirdparty-soundmanager2",b.bind(function(b){this._soundManager=soundManager;c.superclass.render.apply(this,e)},this))},renderUI:function(){c.superclass.renderUI.apply(this,arguments);var e=this.get("boundingBox"),d=e.one(".placeholder"),g=this.get("title"),h=this.get("author");g&&h?d.setContent(b.Node.create('<div class="wrapper"><div class="audio-author">'+h+'</div><div class="audio-title">'+g+"</div></div>")):g?d.setContent(b.Node.create('<div class="wrapper"><div class="audio-title">'+
g+"</div></div>")):d.setContent(b.Node.create('<div class="wrapper">'+this.get("strings.placeholder")+"</div>"));b.Squarespace.Utils.isBetaFeatureEnabled()&&"true"===this.get("show-download")&&(d='<div class="download"><a href="'+b.Squarespace.UrlUtils.addQueryParam(this.get("url"),"download","true")+'" target="_blank">Download</a></div>',this.get("contentBox").append(d),e.addClass("download"));e.one(".progress-inner").setStyle("width","0px");d=this._volumeNode=e.one(".volume");if(!d)throw this.name+
": No div.volume in template.";for(g=this.get("volumeLevels");0<g;g--)d.prepend('<div class="bar level-"'+g+'" data-volume-level="'+g+'"></div>');e.one(".duration").setContent(this.get("strings.durationPlaceHolder"))},bindUI:function(){var c=this.get("id");this.get("boundingBox").on(c+"|click",this._onClick,this);this.after(c+"|volumeChange",function(b){this._setVolume(b.newVal)},this);this.after(c+"|playStateChange",this._uiUpdateWrapperClass,this);this.after(c+"|readyStateChange",this._afterReadyStateChange,
this);this.after(c+"|disabledChange",function(b){b.newVal&&this.stop()},this);b.on(c+"|audioPlayer:stopAll",function(c){var e=c?c.container:null;e&&b.Lang.isString(e)&&(e=b.one(e));(!c||!c.hasOwnProperty("container")||e instanceof b.Node&&e.contains(this.get("boundingBox")))&&this.stop()},this);this.get("boundingBox").plug(b.Squarespace.NodeDestroyNotifier,{onDestroy:this.destroy,context:this})},syncUI:function(){this._uiUpdateWrapperClass();this._uiUpdateVolumeLevel();var b=this.get("boundingBox");
b.toggleClass("tiny",300>b.get("offsetWidth"))},play:function(){this._sound||this._initSoundManagerSound();this._sound&&(this._sound.paused?this._sound.resume():this._sound.play())},pause:function(){this._sound&&this._sound.pause()},stop:function(){var b=this.get("playState"),c=this.getProperty("PLAY_STATES");b===c.PLAYING&&this._sound&&this._sound.stop()},seek:function(b){100<b||0>b?console.warn(this.name+": seek() - Percentage between 0-100 required."):(this._sound||this._initSoundManagerSound(),
this.pause(),this._sound.setPosition(this.get("trueDuration")*(b/100)),this.play())},setVolume:function(b){this.set("volume",b)},_checkSoundManagerStatus:function(){var b=this._soundManager,c=this.getProperty("READY_STATES");if(b.enabled)return this._set("readyState",c.INITIALIZED),!0;b.didFlashBlock?this._set("readyState",c.FLASH_BLOCKED):this._set("readyState",c.SECURITY_ERROR);return!1},_setVolume:function(b){this._sound&&this._sound.setVolume(b);this._set("volume",b);this._uiUpdateVolumeLevel()},
_setVolumeLevel:function(b){this._setVolume(Math.round(100*(b/this.get("volumeLevels"))))},_initSoundManagerSound:function(){if(!1===this._checkSoundManagerStatus())return!1;if(!this._sound){var c=this.get("boundingBox"),d=this.get("url");c.addClass("loading");if(!d){this._showError("No URL provided.");return}0<d.indexOf(Static.SQUARESPACE_CONTEXT.appDomain)&&(d=d.replace(/^(http:\/\/|https:\/\/|\/\/)/i,window.location.protocol+"//"));this._sound=this._soundManager.createSound({id:"squarespaceTrack-"+
this.get("id"),url:d,volume:this.get("volume"),autoPlay:!1,onplay:b.bind(this._onPlay,this),onpause:b.bind(this._onPause,this),onresume:b.bind(this._onPlay,this),onstop:b.bind(this._onStop,this),onfinish:b.bind(this._onStop,this),whileplaying:b.bind(this._onWhilePlaying,this),onload:b.bind(this._onLoad,this),ondataerror:b.bind(this._onDataError,this)});return!!this._sound}return!1},_uiUpdateVolumeLevel:function(){var b=this._volumeNode.get("children"),c=this.get("volumeLevels"),d=this.get("volume"),
h=Math.round(d/100*c);b.each(function(b){parseInt(b.getAttribute("data-volume-level"),10)<=h?b.addClass("active"):b.removeClass("active")},this)},_uiUpdateWrapperClass:function(){var b=this.getProperty("READY_STATES"),c=this.getProperty("PLAY_STATES"),d=this.get("boundingBox"),h=d.getAttribute("class").split(" "),k;for(k in c)h.remove("play-state-"+c[k]);for(k in b)h.remove("ready-state-"+b[k]);d.addClass("ready-state-"+this.get("readyState"));d.setAttribute("class",h.join(" ")).addClass("play-state-"+
this.get("playState")).addClass("ready-state-"+this.get("readyState"))},_onClick:function(c){if(b.UA.ios)window.location.href=this.get("url");else if(!c.target.ancestor().hasClass("download")&&(c.halt(),c.stopImmediatePropagation(),!this.get("disabled")&&!c.target.hasClass("duration")))if(c.target.ancestor(".volume"))this._setVolumeLevel(parseInt(c.target.getAttribute("data-volume-level"),10));else if(c.target.ancestor(".placeholder",!0))this.play();else{if(c.target.ancestor(".controls",!0)){c=this.get("playState");
var d=this.getProperty("PLAY_STATES");switch(c){case d.PLAYING:this.pause();return;case d.PAUSED:case d.STOPPED:this.play();return;default:console.warn(this.name+": Wait, what? How did you get here? Case was ",c);return}}d=this.get("boundingBox").one(".progress").get("region");c.pageX>=d.left&&c.pageX<=d.right&&this.seek(100*((c.pageX-d.left)/d.width))}},_afterReadyStateChange:function(b){b=this.getProperty("READY_STATES");var c=this.get("readyState"),d=this.get("strings"),h=!1;switch(c){case b.INITIALIZED:this.enable();
break;case b.FLASH_BLOCKED:h=d.soundManagerFlashFail;break;case b.SECURITY_ERROR:h=d.soundManagerSecurityFail;this._reportAudioError(b.SECURITY_ERROR);break;case b.SOUND_LOAD_FAILED:h=d.soundManagerURLFail;this._reportAudioError(b.SOUND_LOAD_FAILED);break;case b.SOUND_LOADED:break;default:console.warn(this.name+": Invalid ready state ("+c+").")}h&&(console.warn("AUDIO ERROR: "+h),this._showError(h),this.disable());this._uiUpdateWrapperClass()},_reportAudioError:function(c){try{var d=this.get("url");
0<d.indexOf("static.squarespace.com")&&b.Squarespace.Analytics.trackInternal("system_audio_play_error",{readyState:this.get("readyState"),url:d,durationEst:this._sound.durationEstimate,html5:this._sound.isHTML5,loaded:this._sound.loaded,position:this._sound.position})}catch(g){}},_getPlaytimeString:function(){if(!this._sound)return this.get("strings.durationPlaceHolder");var b="0:00",c="0:00",b=this._getMinSecString(this.get("trueDuration"));this._sound.position&&(c=this._getMinSecString(this._sound.position));
return c+" / "+b},_getMinSecString:function(c){return b.Squarespace.DateUtils.humanizeDuration(c)},_showError:function(b){this.get("boundingBox").addClass("error");this.get("boundingBox").one(".placeholder").setContent("Error: "+b)},_onWhilePlaying:function(){if(!this.get("destroyed")){var b=this.get("boundingBox");b.one(".duration").setContent(this._getPlaytimeString());if(this._sound.loaded&&this._sound.duration){var c=this.getProperty("READY_STATES");this.get("readyState")!==c.SOUND_LOADED&&this._set("readyState",
c.SOUND_LOADED);var c=b.one(".progress-inner"),d=100*(this._sound.position/this.get("trueDuration"));b.removeClass("loading");c&&c.setStyle("width",d+"%")}}},_onPlay:function(){this._loadFailTimer&&this._loadFailTimer.cancel();this._set("playState",b.Squarespace.Widgets.AudioPlayer.PLAY_STATES.PLAYING)},_onStop:function(){this._set("playState",this.getProperty("PLAY_STATES").STOPPED)},_onPause:function(){this._set("playState",this.getProperty("PLAY_STATES").PAUSED)},_onDataError:function(){this.stop();
this._set("playState",this.getProperty("PLAY_STATES").STOPPED)},_onLoad:function(c){c||(this._loadFailTimer=b.later(1E4,this,function(){this.stop();this._set("readyState",this.getProperty("READY_STATES").SOUND_LOAD_FAILED)}))}},{CSS_PREFIX:"sqs-audio-player",PLAY_STATES:{PLAYING:"playing",PAUSED:"paused",STOPPED:"stopped"},READY_STATES:{INITIALIZED:"initialized",FLASH_BLOCKED:"flash-blocked",SECURITY_ERROR:"security-error",SOUND_LOAD_FAILED:"sound-load-failed",SOUND_LOADED:"sound-loaded"},TEMPLATE:'<div class="controls"></div><div class="placeholder"></div><div class="progress"><div class="progress-inner"><div class="scrubber"></div></div></div><div class="duration"></div><div class="volume"></div>',
ATTRS:{strings:{value:{placeholder:"Click to play...",durationPlaceHolder:"0:00 / 0:00",loadFail:"Unable to load sound at the URL",soundManagerFlashFail:"Sorry, could not load because flash is blocked.",soundManagerSecurityFail:"Sorry, there was a JavaScript security error.",soundManagerURLFail:"Unable to access audio stream."}},trueDuration:{getter:function(){var c=this.get("duration-in-ms");return b.Lang.isString(c)&&""!==c?c:this._sound.duration}},playState:{lazyAdd:!1,valueFn:function(){return this.getProperty("PLAY_STATES").STOPPED},
readOnly:!0},readyState:{lazyAdd:!1,valueFn:function(){return this.getProperty("READY_STATES").INITIALIZED},readOnly:!0},url:{value:null},volume:{validator:function(b){(0>b||100<b)&&console.warn(this.name+": Volume must be between 0 and 100, volume remains unchanged.");return!0},value:66},volumeLevels:{value:6,writeOnce:"initOnly"},stopOthersOnPlay:{value:!0},render:{value:!0}}});b.config.win.Squarespace.onInitialize(b,function(){soundManager.enabled||soundManager.reboot();b.all(".sqs-audio-embed").each(function(c){if(!b.Widget.getByNode(c.one("."+
b.Squarespace.Widgets.AudioPlayer.CSS_PREFIX)))switch(b.Object.getValue(c.getData(),"design-style")||"classic"){case "minimal":new b.Squarespace.Widgets.AudioPlayerMinimal({render:c});break;default:new b.Squarespace.Widgets.AudioPlayer({render:c})}})})},"1.0",{requires:"node event squarespace-date-utils squarespace-dombuilder squarespace-ss-widget thirdparty-soundmanager2 squarespace-album-player squarespace-url-utils squarespace-widgets-audio-player".split(" ")});
YUI.add("squarespace-dialog-shipstation-connect-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-shipstation-connect.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};h=this.escapeExpression;b='<div class="title">\n  Connect ShipStation to Print Shipping Labels\n</div>\n\n<div class="text">\n  Squarespace has partnered with ShipStation to save you time shipping your orders. You can print shipping labels for all major carriers in batch and automatically send shipment notifications to your customers with tracking numbers. ShipStation is a subscription service with plans starting at $25 per month.\n</div>\n\n<div class="links">\n  \x3c!--\n  <a href="http://www.shipstation.com">Learn More about ShipStation &rarr;</a><br />\n--\x3e\n  <a target="_blank" href="http://www.shipstation.com/squarespace_pricing/?utm_source=SQSP&utm_medium=app&utm_campaign=app_link1&ref=SQSP">Create a ShipStation account &rarr;</a>\n</div>\n\n<div class="connection-info">\n  <div class="label-container username">\n    <div class="label">Username</div> \n    <div class="value">';
(d=d.siteIdentifier)?d=d.call(c,{hash:{},data:k}):(d=c.siteIdentifier,d="function"===typeof d?d.apply(c):d);return b+=h(d)+'</div>\n  </div>\n  <div class="label-container password">\n    <div class="label">Password</div> \n    <div class="value"></div>\n  </div>\n  <div class="label-container last-synced">\n    <div class="label">Last Synced</div> \n    <div class="value"></div>\n  </div>\n  <div class="label-container last-notified">\n    <div class="label">Last Shipment Notification</div> \n    <div class="value"></div>\n  </div>\n</div>\n\n<div class="configure-button">Connect ShipStation</div>\n<div class="disconnect-button">Disconnect</div>\n'})})();
b.Handlebars.registerPartial("dialog-shipstation-connect.html".replace("/","."),d.templates["dialog-shipstation-connect.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-button-editor-email",function(b){b.namespace("Squarespace.Block.Editor").ButtonEmail=b.Base.create("button-block-editor-dialog",b.Squarespace.Block.Editor.Button,[],{initializer:function(){this.get("host").set("floatable",!1)}},{NS:"blockEditor",ATTRS:{blockName:{value:"Button"},minHSize:{value:2}}})},"1.0",{requires:["squarespace-block-button-editor"]});
YUI.add("squarespace-widgets-commerce-coupon-list-header",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.CommerceCouponListHeader=b.Base.create("CommerceCouponListHeader",b.Squarespace.Widgets.ModelListHeader,[],{_isOrderLevel:function(d){return d===b.Squarespace.CommerceCouponType.ALL_ORDERS||d===b.Squarespace.CommerceCouponType.ORDERS_OVER},_addCouponDialogFlow:function(){(new b.Squarespace.DialogFlow({fieldName:"type",title:"Create a Coupon",description:"Coupons may have different restrictions on what purchases they apply to. Select a rule below.",
options:[{value:b.Squarespace.CommerceCouponType.ALL_ORDERS,title:"Any Order",description:this.get("couponDescriptions")[b.Squarespace.CommerceCouponType.ALL_ORDERS],icon:"commerce-coupon-any"},{value:b.Squarespace.CommerceCouponType.ORDERS_OVER,title:"Orders At Least ...",description:this.get("couponDescriptions")[b.Squarespace.CommerceCouponType.ORDERS_OVER],icon:"commerce-coupon-at-least"},{value:b.Squarespace.CommerceCouponType.CATEGORIES,title:"Products By Category",description:this.get("couponDescriptions")[b.Squarespace.CommerceCouponType.CATEGORIES],
icon:"commerce-coupon-category"},{value:b.Squarespace.CommerceCouponType.SINGLE_PRODUCT,title:"Single Product",description:this.get("couponDescriptions")[b.Squarespace.CommerceCouponType.SINGLE_PRODUCT],icon:"commerce-coupon-single"}],nextDialogGenerator:b.bind(function(d){var c=[{value:b.Squarespace.CommerceDiscountType.FLAT,title:this.get("discountTitles")[b.Squarespace.CommerceDiscountType.FLAT],description:"Discount a flat dollar amount.",icon:"commerce-coupon-discount-flat"},{value:b.Squarespace.CommerceDiscountType.PERCENTAGE,
title:this.get("discountTitles")[b.Squarespace.CommerceDiscountType.PERCENTAGE],description:"Discount a percentage off of the price.",icon:"commerce-coupon-discount-percentage"}];this._isOrderLevel(d.type)&&c.push({value:b.Squarespace.CommerceDiscountType.FREE_SHIPPING,title:this.get("discountTitles")[b.Squarespace.CommerceDiscountType.FREE_SHIPPING],description:"Provide free shipping for the customer's entire order.",icon:"commerce-coupon-discount-free-shipping"});return new b.Squarespace.DialogFlow({fieldName:"discountType",
title:"Select Discount Type",subtitle:this.get("couponTitles")[d.type],description:"You have chosen what your coupon applies to. Now, select what type of discount you want to offer.",options:c,nextDialogGenerator:b.bind(function(c){c=new b.Squarespace.Models.CommerceCoupon({discountAmt:0,startDate:(new Date).getTime(),endDate:b.DataType.Date.addDays(new Date,7).getTime(),type:c.type,discountType:c.discountType});c=new b.Squarespace.Editor.CommerceCoupon({model:c,validCouponCategories:this.get("validCouponCategories")});
c.get("model").after("save",function(b){this.get("models").add(b.target)},this);return c},this)})},this)})).showPrescreen()}},{CSS_PREFIX:"sqs-commerce-coupon-list-header",ATTRS:{tabs:{value:[{name:"coupons",description:"Create and manage promotions for your store. You can share promo codes with your customers, which they can apply at checkout. Squarespace allows you to create coupons for free shipping, flat rate shipping, and for orders within certain size ranges."}]},actionButtons:{valueFn:function(){return[{name:"addCoupon",
label:"Add Coupon",action:b.bind(this._addCouponDialogFlow,this)}]}},strings:{value:{title:"Coupons"}},couponDescriptions:{valueFn:function(){var d={};d[b.Squarespace.CommerceCouponType.ALL_ORDERS]="Apply a discount to any order. <br />(Example: a Friends and Family discount)";d[b.Squarespace.CommerceCouponType.ORDERS_OVER]="Apply a discount to orders over a specified subtotal. <br />(Example: Free Shipping on Orders over "+b.Squarespace.Commerce.currencySymbol()+"100)";d[b.Squarespace.CommerceCouponType.CATEGORIES]=
"Apply a discount to products in one or more collections based on their category. <br />(Example: 20% off All Summer Items)";d[b.Squarespace.CommerceCouponType.SINGLE_PRODUCT]="Apply a discount to a single product.";return d},readOnly:!0},couponTitles:{valueFn:function(){var d={};d[b.Squarespace.CommerceCouponType.ALL_ORDERS]="Apply a discount to any order";d[b.Squarespace.CommerceCouponType.ORDERS_OVER]="Apply a discount to orders over a minimum subtotal";d[b.Squarespace.CommerceCouponType.CATEGORIES]=
"Apply a discount to products in chosen categories";d[b.Squarespace.CommerceCouponType.SINGLE_PRODUCT]="Apply a discount to a single product";return d},readOnly:!0},discountTitles:{valueFn:function(){var d={};d[b.Squarespace.CommerceDiscountType.FLAT]="Flat Discount";d[b.Squarespace.CommerceDiscountType.PERCENTAGE]="Percentage Discount";d[b.Squarespace.CommerceDiscountType.FREE_SHIPPING]="Free Shipping";return d},readOnly:!0},validCouponCategories:{value:[],writeOnce:"initOnly"}}})},"1.0",{requires:["base",
"squarespace-widgets-model-list-header"]});YUI.add("squarespace-block-social-account-links-model",function(b){b.namespace("Squarespace.ContentModel").SocialAccountLinksBlock=b.Base.create("SocialAccountLinksBlock",b.Model,[],{},{ATTRS:{iconStyle:{value:"round"},iconSize:{value:"default"},iconAlignment:{value:"left"},iconColor:{value:"black"}}})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-plugin-money-formatter",function(b){b.namespace("Squarespace.Plugin");b.Squarespace.Plugin.MoneyFormatter=b.Base.create("moneyFormatter",b.Squarespace.Plugin.NumericFormatter,[],{_transformToData:function(d){return Number(b.Squarespace.Utils.convertToCents(d))}},{NS:"moneyFormatterPlugin",ATTRS:{prefixUnit:{valueFn:function(){return b.Squarespace.Commerce.currencySymbol()}},displayFormatter:{value:b.Squarespace.Commerce.moneyFormat}}})},"1.0",{requires:["plugin","squarespace-util",
"squarespace-commerce-utils","squarespace-plugin-numeric-formatter"]});
YUI.add("squarespace-settings-commerce-taxes",function(b){b.namespace("Squarespace.Settings.Commerce");var d=b.Base.create("TaxRules",b.ModelList,[],{model:b.Squarespace.Models.TaxRule,sync:function(c,d,g){if("read"!=c)throw'Only "read" is supported for TaxRules model list.';b.Data.get({url:"/api/commerce/admin/GetTaxRules",success:b.bind(function(c){var e=[];b.Array.each(c.taxRules,function(c){c=new b.Squarespace.Models.TaxRule(c);e.push(c)});e.sort(function(b,c){return b.get("scope")==c.get("scope")?
(b.get("scope"),b.get("name")<c.get("name")?-1:1):b.get("scope")-c.get("scope")});this.reset(e)},this)},this)},getParentsOf:function(b){return this.filter(function(c){return c.isParentOf(b)})}}),c=b.Base.create("taxRuleList",b.Squarespace.DialogField2,[],{initializer:function(b){this._rules=new d;this._rules.sync("read")},bindUI:function(){this._registerEvent(this._rules.on("add",this.syncUI,this));this._registerEvent(this._rules.after("reset",this.syncUI,this))},syncUI:function(){var c=this.get("contentBox");
c.empty();0===this._rules.size()&&this._showEmptyMessage();var d={},g=[];this._rules.each(b.bind(function(h){if(h.get("scope")==b.Squarespace.TaxScopes.COUNTRY){var k=new b.Squarespace.Widgets.TaxRuleView({ruleInstance:h,parents:this._rules.getParentsOf(h)});k.render(c);g.push(k);d[h.get("countryCode")]={ruleView:k,states:{}}}},this));this._rules.each(b.bind(function(c){if(c.get("scope")==b.Squarespace.TaxScopes.STATE){var e=new b.Squarespace.Widgets.TaxRuleView({ruleInstance:c,parents:this._rules.getParentsOf(c)});
d[c.get("countryCode")].ruleView.add(e);d[c.get("countryCode")].states[c.get("state")]={ruleView:e,localities:{}}}},this));this._rules.each(b.bind(function(c){if(c.get("scope")==b.Squarespace.TaxScopes.LOCAL){var e=new b.Squarespace.Widgets.TaxRuleView({ruleInstance:c,parents:this._rules.getParentsOf(c)});d[c.get("countryCode")].states[c.get("state")].ruleView.add(e)}},this));b.Array.each(g,b.bind(function(c){c.on("create-requested",function(c){c=c.parentModel;switch(c.get("scope")){case b.Squarespace.TaxScopes.COUNTRY:this.showAddState(c);
break;case b.Squarespace.TaxScopes.STATE:this.showAddLocal(c);break;case b.Squarespace.TaxScopes.LOCAL:throw"Can't add anything below Local";}},this);c.on("rule-removed",function(b){this._rules.sync("read")},this);c.on("rule-updated",function(b){this._rules.sync("read")},this)},this))},_showEmptyMessage:function(){this.get("contentBox").append("<div class='no-options'><img src='/universal/images-v6/configuration/no-taxes.png'/><div class='empty-text'>You haven't created any tax rules yet.</div></div>")},
_showAddDialog:function(c,d){var g=new b.Squarespace.EditingDialog({name:"addEditRule",style:"flyout",savingText:"Saving Tax Rule...",initialData:c,overlay:0.5,width:390,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Save"}],primaryTabs:d});g.on("send-requested",b.bind(function(){var c=g.getField("state");c&&""===c.getValue()?(c.showError("You need to pick a state."),g.allowEditing()):(c=g.getField("countryCode"))&&""===c.getValue()?
(c.showError("You need to pick a country."),g.allowEditing()):(new b.Squarespace.Models.TaxRule(g.getData())).sync("create",{},b.bind(function(c,e){c?(new b.Squarespace.Widgets.Alert({"strings.title":"Error","strings.message":c.error}),g.allowEditing()):(this._rules.sync("read"),g.close())},this))},this));return g},showAddLocal:function(c){var d=c.newChildRaw();(new b.Squarespace.DialogFlow({fieldName:"zipMatchType",title:"Create New Local Tax Rate",subtitle:"Match by Zip Code",width:400,description:"Create a local tax rule for customers from a certain zip code. You can specify the local rate for a single zip code or a range of codes.",
options:[{value:"single",title:"Single Zip Code",description:"An exact match on a single zip code."},{value:"range",title:"Range of Zip Codes",description:"Matches if a customer's zip code is within a range."}],nextDialogGenerator:b.bind(function(c){return"single"==c.zipMatchType?this._showAddDialog(d,{title:"Create New Local Rate",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"countryCode"}},{ctor:b.Squarespace.DialogFields.Hidden,
config:{name:"state"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"zipMatchType"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Local Rate",text:"Customers whose address is in this zip code will have this sales tax added to their purchase."}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"zipStart","strings.title":"Zip Code","strings.validationFailMessage":"This must be a valid Zip Code",className:"thin",
validator:b.Squarespace.Commerce.isValidUSZip}},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"rate",className:"thin","strings.title":"Tax Rate (%)"}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping","strings.description":"Apply this tax rate to shipping."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services","strings.description":"Apply sales tax to service products."}}]}):
this._showAddDialog(d,{title:"Create New Local Rate",icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"countryCode"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"state"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"zipMatchType"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Local Rate",text:"Customers whose zip code falls within this range will have this sales tax added to their purchase."}},
{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"zipStart","strings.title":"Starting Zip","strings.description":"Start of the range, inclusive.","strings.validationFailMessage":"This must be a valid Zip Code",className:"thin",validator:b.Squarespace.Commerce.isValidUSZip,width:0.5}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"zipEnd","strings.title":"Ending Zip","strings.description":"End of the range, inclusive.","strings.validationFailMessage":"This must be a valid Zip Code",
className:"thin",validator:b.Squarespace.Commerce.isValidUSZip,width:0.5}}]},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"rate",className:"thin","strings.title":"Tax Rate (%)",visible:!this.xeroOverride}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping","strings.description":"Apply this tax rate to shipping."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services",
"strings.description":"Apply sales tax to service products."}}]})},this)})).showPrescreen(d)},showAddState:function(c){var d=c.newChildRaw();"CA"==c.get("countryCode")?(c.get("rate"),c=this._showAddDialog(d,{title:"Create New Provincial Rate",icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"countryCode"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"state"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Provincial Tax Rate",text:"All customers from this province will have this sales tax added to their purchase."}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"state",defaultValue:"",options:c.getStateOptions(),"strings.title":"Province","strings.placeholder":"Select a Province",className:"thin dark",required:!0}},{type:"text",name:"taxName",title:"Tax Name",description:"E.g. HST, QST, PST"},{ctor:b.Squarespace.DialogFields.NumericText,
config:{name:"rate",className:"thin","strings.title":"Provincial Tax Rate (%)","strings.description":"This rate is added to the federal rate."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showCombinedRate","strings.title":"Show As Combined Rate","strings.description":"Typically for HST provinces, this displays the tax on invoices as a combined rate."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping","strings.description":"Apply sales tax to shipping charges."}},
{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services","strings.description":"Apply sales tax to service products."}}]})):c=this._showAddDialog(d,{title:"Create New State Rate",icon:"/universal/images-v6/icons/icon-plus-16-light.png?4",fields:[{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"countryCode"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"state"}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},{ctor:b.Squarespace.DialogFields.Description,
config:{title:"State/Provincial Tax Rate",text:"All customers from this state/province will have this sales tax added to their purchase."}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"state",defaultValue:"",options:c.getStateOptions(),"strings.title":"State/Province","strings.placeholder":"Select a State",className:"thin dark",required:!0}},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"rate",className:"thin","strings.title":"Tax Rate (%)"}},{ctor:b.Squarespace.DialogFields.Check,
config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping","strings.description":"Apply sales tax to shipping charges for customers from this state."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services","strings.description":"Apply sales tax to service products for customers from this state."}}]});c.show()},showAddCountry:function(c){var d=this._showAddDialog(c,{title:"Create Country Tax Rate",icon:"/universal/images-v6/icons/icon-plus-16-light.png",
fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Country Rate",text:"All customers from this country will have this sales tax added to their purchase."}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"countryCode",defaultValue:"",options:b.Squarespace.Localities.getNewCountryOptions(),"strings.title":"Country",className:"thin dark",required:!0}},{ctor:b.Squarespace.DialogFields.Hidden,config:{name:"scope"}},{ctor:b.Squarespace.DialogFields.HTML,config:{name:"usTaxMessage",
content:"The United States does not have a federal sales tax. This tax rule will charge 0% to your customers for products, services, and shipping.",visible:!1}},{ctor:b.Squarespace.DialogFields.NumericText,config:{name:"rate",className:"thin","strings.title":"Tax Rate (%)",visible:!this.xeroOverride}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnShipping","strings.title":"Charge Tax on Shipping","strings.description":"Apply sales tax to shipping charges for customers from this country."}},
{ctor:b.Squarespace.DialogFields.Check,config:{name:"chargeTaxOnServices","strings.title":"Charge Tax on Services","strings.description":"Apply sales tax to service products for customers from this country."}}]});d.show();d.getField("countryCode").after("dataChange",function(b){"US"===b.newVal?(d.getField("rate").set("data",0).hide(),d.getField("chargeTaxOnShipping").hide(),d.getField("chargeTaxOnServices").hide(),d.getField("usTaxMessage").show()):(d.getField("rate").show(),d.getField("chargeTaxOnShipping").show(),
d.getField("chargeTaxOnServices").show(),d.getField("usTaxMessage").hide())})}},{CSS_PREFIX:"sqs-tax-rule-list"});b.Squarespace.Settings.Commerce.Taxes=b.Base.create("taxSettings",b.Squarespace.Widgets.SettingsPanel,[],{addItem:function(){this.getField("taxRules").showAddCountry({chargeTaxOnServices:!0,scope:b.Squarespace.TaxScopes.COUNTRY})}},{CSS_PREFIX:"sqs-tax-settings",ATTRS:{initialDataUrl:{},buttons:{value:[{type:"add",label:"Add Country"}]},"strings.title":{value:"Taxes"},"strings.description":{value:"Define the localities where sales taxes are applicable to your business. Customers whose shipping addresses match these locations will be charged the sales tax you have specified. For purchases of only digital goods, the billing address will be used."},
fields:{value:[{ctor:c,config:{name:"taxRules"}}]}}})},"1.0",{requires:"node oop anim json squarespace-commerce-utils squarespace-models-tax-rule squarespace-tax-rule-view squarespace-settings-panel squarespace-tray squarespace-dialog-description squarespace-dialog-numeric-text squarespace-markdown squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-stats-block-error-view",function(b){b.namespace("Squarespace.Views.Stats").BlockError=b.Base.create("statsBlockErrorView",b.Squarespace.View,[],{render:function(d){var c=this.get("container");c.appendChild(b.Node.create('<div class="error-message">Error Loading Data</div>'));c.appendTo(d)}})},"1.0",{requires:["base-base","node","squarespace-view"]});
YUI.add("squarespace-settings-activity-search-queries",function(b){b.namespace("Squarespace.Settings.Activity");b.Squarespace.Settings.Activity.SearchQueries=b.Base.create("ActivityManagerSearchQueries",b.Squarespace.Settings.Activity.BaseManager,[b.Squarespace.Settings.Activity.MixinSpinnerfied,b.Squarespace.Settings.Activity.MixinAccordion],{_isDataEmpty:function(d){return!b.Lang.isArray(d.summaries)||0===d.summaries.length},_renderSuccess:function(b){this.renderChartAccordionPanel(b,{panelTitle:"Search Engine Queries",
countTitle:"Count",countAttr:"count",descriptionTitle:"Search Query",descriptionAttr:"searchQuery",subCountAttr:"count",subDescriptionAttr:"searchEngine",chartFn:this.renderSearchEngineChart})},renderSearchEngineChart:function(d,c){this.renderStandardPieChart(d.summaries,c,b.bind(function(b){return b.searchQuery+(b.searchEngine?" ("+b.searchEngine+")":"")},this))}},{CSS_PREFIX:"sqs-activity-manager-search-queries",ATTRS:{activeTab:{value:"week"},strings:{value:{title:"Search Engine Queries"}},requestParams:{getter:function(){return{name:"searchEngine",
numberOfDays:this._periodToDays(this.get("activeTab")),verbose:!1}}},tabs:{value:[{key:"1day",label:"1 Day"},{key:"2days",label:"2 Days"},{key:"3days",label:"3 Days"},{key:"week",label:"Week"},{key:"month",label:"Month"}]}}})},"1.0",{requires:["base","squarespace-settings-activity-base-manager","squarespace-settings-activity-mixin-accordion","squarespace-settings-activity-mixin-spinnerfied"]});
YUI.add("squarespace-invoice-list-table-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["invoice-list-table.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n          <td><a href="';(f=d.link)?f=f.call(b,{hash:{},data:c}):(f=b.link,f=typeof f===p?f.apply(b):f);return e+=q(f)+'">Invoice</a></td>\n        '}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p="function",q=this.escapeExpression,r=this;b="<table>\n  <thead>\n    <tr>\n      ";
if((h=d.each.call(c,c.headings,{hash:{},inverse:r.noop,fn:r.program(1,function(b,c){var e;return e=""+('\n        <th scope="col">'+q(typeof b===p?b.apply(b):b)+"</th>\n      ")},k),data:k}))||0===h)b+=h;b+="\n      ";if((h=d["if"].call(c,c.linkInvoices,{hash:{},inverse:r.noop,fn:r.program(3,function(b,c){return'\n        <th scope="col">Invoice</th>\n      '},k),data:k}))||0===h)b+=h;b+="\n    </tr>\n  </thead>\n\n  <tbody>\n    ";if((h=d.each.call(c,c.invoices,{hash:{},inverse:r.noop,fn:r.programWithDepth(5,
function(b,c,e){var f,h;f="\n      <tr>\n        <td>";(h=d.formattedDate)?h=h.call(b,{hash:{},data:c}):(h=b.formattedDate,h=typeof h===p?h.apply(b):h);f+=q(h)+"</td>\n        <td>";(h=d.amount)?h=h.call(b,{hash:{},data:c}):(h=b.amount,h=typeof h===p?h.apply(b):h);f+=q(h)+"</td>\n        ";if((h=d["if"].call(b,e.linkInvoices,{hash:{},inverse:r.noop,fn:r.program(6,l,c),data:c}))||0===h)f+=h;return f+"\n      </tr>\n    "},k,c),data:k}))||0===h)b+=h;return b+"\n  </tbody>\n</table>\n"})})();b.Handlebars.registerPartial("invoice-list-table.html".replace("/",
"."),d.templates["invoice-list-table.html"])},"1.0",{requires:["handlebars-base"]});YUI.add("squarespace-layout-drop",function(b){b.namespace("Squarespace.Layout").Drop=b.Base.create("LayoutDrop",b.DD.Drop,[],{initializer:function(){b.DD.DDM.activeDrag&&this._activateShim()}},{ATTRS:{lockScroll:{value:!1}}})},"1.0",{requires:["base","dd-drop"]});
YUI.add("squarespace-stats-dashboard-view",function(b){var d=b.namespace("Squarespace.Views.Stats").Dashboard=b.Base.create("statsModularDashboardView",b.Squarespace.View,[],{render:function(c){d.superclass.render.apply(this,arguments);var e=this.get("container"),f=[{label:"Dashboard Settings",action:this._showSettings},{className:"add primary",label:"Add Stats Block",action:b.bind(this._addStatsBlock,this)}];b.Array.each(f,function(b){b.context=this});this._headerTray=new b.Squarespace.Widgets.HeaderTray({loading:!1,
render:e,buttons:f});this._headerTray.set("strings.title","Dashboard");this._layoutBB=b.Node.create("<div></div>");e.appendChild(this._layoutBB);this._layoutBB.setHTML('<div class="page-wrapper"><div class="sqs-dashboard"></div></div>');this._layoutBB.setStyles({paddingTop:"140px",paddingLeft:"40px",paddingRight:"40px"});e=this.get("blockTypes");this._addBlockDialog=new b.Squarespace.EditingDialog({style:"minimal",width:500,height:135,overlay:0.4,zIndex:30150,disableTips:!1,flyoutPointerDirection:"hidden",
closeOthers:!1,tabs:[{title:"Add a Stats Block",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"add-stats-block",titleStyle:"top",width:440,hideDisabled:!0,className:"round square muted",columns:4,options:[{icon:"numbit",title:"Numbit",value:e.NUMBIT},{icon:"sparkline",title:"Sparkline",value:e.SPARKLINE},{icon:"gauge",title:"Gauge",value:e.GAUGE},{icon:"pie",title:"Pie",value:e.PIE}]}}]}]});this._addBlockDialog.on("show",
function(){this._preventDuplicateBlocks=!1},this);this._addBlockDialog.on("datachange",function(c,e){if(!this._preventDuplicateBlocks){this._preventDuplicateBlocks=!0;c.dialog&&b.Lang.isFunction(c.dialog.close)?c.dialog.close():c.get("dialog")&&b.Lang.isFunction(c.get("dialog").close)&&c.get("dialog").close();var d=c.getValue();this._addBlock(d)}},this);this._ddDelegate=new b.DD.Delegate({container:this._layoutBB,nodes:".col",target:!0});this._ddReorder=this._ddDelegate.dd.plug(b.Squarespace.DDReorder,
{container:this._layoutBB,nodes:".col"}).ddreorder;this._addBlock(this.get("blockTypes").NUMBIT)},_addStatsBlock:function(){this._addBlockDialog.show()},_showSettings:function(){},_addBlock:function(c){var e=this.get("blockTypes");if(c===e.NUMBIT)c=b.Squarespace.Views.Stats.Numbit;else if(c===e.SPARKLINE)c=b.Squarespace.Views.Stats.Sparkline;else if(c===e.GAUGE)c=b.Squarespace.Views.Stats.Gauge;else if(c===e.PIE)c=b.Squarespace.Views.Stats.Pie;else return;e=this._getColumn();c=new b.Squarespace.Widgets.StatsBlock({render:e.col,
colSpan:e.span,dataMetric:b.Squarespace.CensusDataMetric.VIEWS,timeFrame:b.Squarespace.StatsTimeFrames.LAST_24_HOURS,dataView:c});this._ddDelegate.syncTargets();return c},_getColumn:function(){return{col:this._layoutBB.one(".sqs-dashboard").appendChild('<div class="col sqs-col-6"></div>'),span:6}}},{CSS_PREFIX:"sqs-stats-dashboard",ATTRS:{blockTypes:{value:{NUMBIT:"numbit",SPARKLINE:"sparkline",GAUGE:"gauge",PIE:"pie"}}}})},"1.0",{requires:"base-build squarespace-view squarespace-dd-behaviors squarespace-dialog-multi-option squarespace-stats-block squarespace-stats-block-numbit squarespace-stats-block-sparkline squarespace-stats-block-gauge squarespace-stats-block-pie".split(" ")});
YUI.add("squarespace-dialog-toggle",function(b){var d=b.namespace("Squarespace.DialogFields").Toggle=b.Base.create("toggleFieldDialog",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(c){this.get("data");this._toggleButton=this.add({childType:b.Squarespace.Widgets.ToggleButton,active:this.get("data")}).item(0);this._toggleButton.plug(b.Squarespace.ToggleDrag)},bindUI:function(){d.superclass.bindUI.call(this);this._toggleButton.after("activeChange",this._syncData,this)},syncUI:function(){this._toggleButton.set("active",
this.get("data"))},_syncData:function(b){this.set("data",b.newVal)}},{CSS_PREFIX:"sqs-toggle",TEMPLATE:'<div class="toggle"> </div>',ATTRS:{active:{},data:{}}})},"1.0.0",{requires:["base","node","squarespace-toggle","squarespace-dialog-field-2"]});
YUI.add("squarespace-block-button-editor",function(b){b.namespace("Squarespace.Block.Editor").Button=b.Base.create("button-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Button")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Button"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Button=b.Base.create("block-button-editor",b.Squarespace.ModelEditorDialog,[],{getDialogData:function(){var c=
this.get("model").toJSON(),e=c.buttonLink;b.Lang.isString(e)&&(c.clickThrough={url:e,newWindow:c.newWindow});return c},sanitizeDialogData:function(b){b.clickThrough&&b.clickThrough.url?(b.buttonLink=b.clickThrough.url,b.newWindow=b.clickThrough.newWindow):(b.buttonLink="",b.newWindow=!1);return{buttonText:b.buttonText,buttonLink:b.buttonLink,newWindow:b.newWindow,buttonAlignment:b.buttonAlignment,buttonSize:b.buttonSize}}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={name:"editButtonBlock",
width:335,height:400,discardChangesConfirmation:!1,closeOthers:!1,draggable:!0,flyoutPointerDirection:"hidden",style:"flyout",initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Button",icon:"/universal/images-v6/icons/icon-button-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{className:"description",content:"The size and layout of your button can be configured here. Additional style options, including color and shape, are available within the Style Editor."}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"buttonText","strings.title":"Text",className:"thin dark"}},{ctor:b.Squarespace.DialogFields.CreateLink,config:{name:"clickThrough","strings.title":"Clickthrough URL",condensed:!0}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"buttonSize","strings.title":"Size",className:"thin dark",defaultValue:"medium",options:[{value:"small",label:"Small"},{value:"medium",label:"Medium"},{value:"large",label:"Large"}]}},{ctor:b.Squarespace.DialogFields.Select,
config:{name:"buttonAlignment","strings.title":"Alignment",className:"thin dark",defaultValue:"center",options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]}}]}]}},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-damask-context-globals squarespace-dialog-create-link squarespace-dialog-html squarespace-dialog-select squarespace-dialog-text squarespace-model-editor".split(" ")});
YUI.add("squarespace-dialog-file",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.File=b.Base.create("file",b.Squarespace.DialogField2,[],{initializer:function(){this.LANG=d.LANG;b.Squarespace.Uploader&&(this.uploader=this._createUploader());this.set("width",this.get("height"));this._plugTitleAndBindResizing();this.after("dataChange",function(){this.refreshItemPostData();this._bindDataEvents()},this);this._initializeAndLoadData()},renderUI:function(){d.superclass.renderUI.call(this);
if(this.uploader){var c=this.get("contentBox");this._progressPlugin=c.plug(b.Squarespace.Plugin.ProgressSpinner)[b.Squarespace.Plugin.ProgressSpinner.NS];"none"!==b.Uploader.TYPE&&("flash"===b.Uploader.TYPE?b.later(300,this,function(){this.uploader.render(c)}):this.uploader.render(c))}},_uiSetWidth:function(b){this._uiSetDim("minWidth",b);this._uiSetDim("width",b)},bindUI:function(){d.superclass.bindUI.call(this);var b=this.uploader;b&&(this._registerEvent(b.on("uploadstart",this._uploadStart,this)),
this._registerEvent(b.on("upload-complete",this._directUploadComplete,this)),this._registerEvent(b.on("upload-failure",this._directUploadFailure,this)))},syncUI:function(){d.superclass.syncUI.call(this);this._dataLoaded?this._renderDataLoadedState():this._renderDataLoadingState()},didDataChange:function(){var b=this._initialData,e=this.get("data");if(!b&&!e||b&&0===Object.keys(b).length&&null===e)return!1;if(!b||!e)return!0;var d=b.mediaFocalPoint,g=e.get("mediaFocalPoint");return b.id!==e.get("id")?
!0:!d&&!g?!1:!d||!g?!0:d.x&&g.x!==d.x||d.y&&g.y!==d.y},show:function(){this.syncUI();this.set("visible",!0)},refreshItemPostData:function(){var c=this.get("data");if(c)switch(this.get("mode")){case b.Squarespace.UploadModes.ITEM:this._itemPostData={collectionId:c.get("collectionId"),recordType:c.get("recordType")};if(c=c.get("id"))this._itemPostData.replaceItemId=c;break;case b.Squarespace.UploadModes.CHILD:this._itemPostData={collectionId:c.get("collectionId"),recordType:c.get("recordType"),parentItemId:c.get("parentId")};
break;default:this._itemPostData={}}},saveFromUrl:function(c,e){if(this.uploader){this.set("data",null);this.get("boundingBox").addClass("has-preview");var d=this._progressPlugin;d.set("show",!0);var g=b.merge(this._getFilePostData(),{fileUrl:c});e&&(g.replaceItemId=e);if(g.replaceItemId)b.Data.post({url:"/api/commondata/"+(this.get("mode")===b.Squarespace.UploadModes.GLOBAL?"SaveGlobalMedia":"SaveMedia"),data:g,success:function(c){d.set("show",!1);if(c&&c.job){d.set("show",!0);var e={placeholder:this.get("contentBox")},
g=this.uploader.get("createJob")(e,c);g&&(g.get("id")||g.set("id",c.job.id),c=this.uploader,g.once("complete",b.bind(c._onJobHandler,c,"Complete",e)),g.once("failure",b.bind(c._onJobHandler,c,"Failure",e)),g.once("complete",function(c){var e=new b.Squarespace.Models.ContentItem({id:c.target.get("data.contentItemId")});e.load(b.bind(function(c,d){b.Lang.isValue(c)||this.set("data",e)},this))},this),Static.JOB_MANAGER.addJob(g))}(e=this.get("data"))&&!e.get("mediaProcessingState")&&e.set("mediaProcessingState",
b.Squarespace.MediaProcessingState.QUEUED)}},this);else{var h=g.collectionId;if(b.Lang.isValue(h)){var k=new b.Squarespace.Models.ContentItem({collectionId:h,recordType:g.recordType});k.save(b.bind(function(){this.saveFromUrl(c,k.get("id"))},this))}else this.uploader.preflightTransient(this.get("mode")===b.Squarespace.UploadModes.GLOBAL,b.bind(function(b){this.saveFromUrl(c,b.id)},this))}}},_createUploader:function(){var c={uploadURL:"/api/commondata/"+(this.get("mode")===b.Squarespace.UploadModes.GLOBAL?
"SaveGlobalMedia":"SaveMedia"),multipleFiles:!1,appendNewFiles:!1,isTransient:this.get("mode")===b.Squarespace.UploadModes.TRANSIENT||this.get("mode")===b.Squarespace.UploadModes.GLOBAL,isGlobal:this.get("mode")===b.Squarespace.UploadModes.GLOBAL,autoUpload:!0,selectButtonLabel:b.substitute("flash"===b.Uploader.TYPE?this.LANG.HINT_FILE_UPLOAD_CLICK_ONLY:this.LANG.HINT_FILE_UPLOAD,{type:this.get("contentLabel")}),dragAndDropArea:this.get("contentBox"),maxSize:this.get("maxSize"),processFile:b.bind(this._processFile,
this),addPlaceholder:b.bind(this._addPlaceholder,this),preflight:this.get("preflight")};"audio"===this.get("contentType")&&(c.fileFilters=[{description:"Audio",extensions:"*.mp3;*.mp4;*.ogg;*.m4a"}]);var e=b.Squarespace.Uploader;b.Squarespace.Utils.isInDamaskFrame()&&(e=b.config.win.top.Y.Squarespace.Uploader);return new e(c)},_plugTitleAndBindResizing:function(){var c=this.get("contentBox"),e=this.get("strings.title");e&&(this.plug(b.Squarespace.Plugin.DialogFieldLabel,{forNode:c,strings:{text:e}}),
this.after("render",function(){if(this.get("height")){var b=this.get("boundingBox").get("offsetHeight"),e=c.get("clientHeight");c.setStyle("height",e-(b-e));this.get("boundingBox").setStyle("height",null)}},this));this.after("render",function(){this.get("square")&&(c.setStyles({minWidth:this.get("width"),height:this.get("width")}),this.get("boundingBox").setStyles({height:null,width:null}))},this)},_initializeAndLoadData:function(){var c=this.get("data");this.refreshItemPostData();this._bindDataEvents();
c?(this._initialData={id:c.get("id"),mediaFocalPoint:c.get("mediaFocalPoint")},!c.isNew()&&this.get("mode")!==b.Squarespace.UploadModes.GLOBAL?c.load(b.bind(function(e){e&&new b.Squarespace.Widgets.Alert({"strings.title":"Missing Item","strings.message":"We could not locate the item."});this._initialData.mediaFocalPoint=c.get("mediaFocalPoint");this._dataLoaded=!0;this.get("rendered")&&this.syncUI()},this)):this._dataLoaded=!0):(this._initialData={},this._dataLoaded=!0)},_bindDataEvents:function(){var c=
this.get("data");c&&this.get("mode")===b.Squarespace.UploadModes.ITEM&&this._registerEvent(c.after("idChange",function(b){this._itemPostData.replaceItemId=b.newVal},this))},_cleanupResidualElements:function(){this.get("contentBox").all("."+d.CSS_PREFIX+"-preview").remove();var b=this._actionOverlay;b&&b.get("host").unplug(b.constructor);(b=this._spinner)&&b.destroy()},_renderDataLoadedState:function(){this._cleanupResidualElements();var b=this.get("boundingBox"),e=this.get("data");this.get("contentBox").removeClass("data-loading");
e&&e.get("hasFileData")?(b.addClass("has-file"),this._renderFilePreview()):(b.removeClass("has-preview"),b.removeClass("has-file"),this._progressPlugin.set("show",!1))},_renderDataLoadingState:function(){this._cleanupResidualElements();var c=this.get("boundingBox"),e=this.get("contentBox");c.removeClass("has-preview");c.addClass("has-file");e.addClass("data-loading");this._spinner=new b.Squarespace.Spinner({size:"extra-large",render:e,color:this.get("spinnerColor")});this._spinner.get("boundingBox").setStyles({top:"50%",
left:"50%",position:"absolute",marginLeft:"-20px",marginTop:"-20px"})},_renderFilePreview:function(){var c=b.Node.create('<div class="'+d.CSS_PREFIX+'-preview"></div>'),e=this.get("data"),f=e.get("filename"),e=e.get("dataSize");c.append('<span class="file-meta file-meta-icon file-meta-icon-'+this.get("contentType")+'"></span>');f&&c.append('<span class="file-meta file-meta-name">'+f+"</div>");e&&c.append('<span class="file-meta file-meta-size">'+b.Squarespace.Utils.humanizeBinarySize(e)+"</span>");
this.get("contentBox").append(c);this._plugActionOverlay()},_plugActionOverlay:function(){this._actionOverlay=this.get("contentBox").plug(b.Squarespace.Plugin.ActionOverlay,{buttons:["remove"]}).actionOverlay;this._actionOverlay.on("button-remove",function(){this.set("data",null)},this)},_processFile:function(c){if(c.invalid){var e=c.invalid[0];c=e.title;e=e.message;this.get("strings.invalidDrop")&&(c=this.get("strings.invalidDrop.title"),e=this.get("strings.invalidDrop.message"));new b.Squarespace.Widgets.Alert({"strings.title":c,
"strings.message":e})}else c.postData=this._getFilePostData()},_getFilePostData:function(){var c=this.get("contentType"),c={process:-1!==["image","audio"].indexOf(c.slice(0,5))?"true":"false",contentType:c,isWordpressXmlFile:this.get("isWordpressXmlFile")};this.get("recordType")&&(c.recordType=this.get("recordType"));switch(this.get("mode")){case b.Squarespace.UploadModes.CHILD:this._itemPostData&&(c=b.merge(c,this._itemPostData,{childType:this.get("childType")}),b.Lang.isUndefined(c.parentItemId)&&
console.warn("Parent Item ID is null."));break;case b.Squarespace.UploadModes.ITEM:this._itemPostData&&(c=b.merge(c,this._itemPostData))}return c},_addPlaceholder:function(b){return this.get("contentBox")},_uploadStart:function(b){this._cleanupResidualElements();this.get("boundingBox").addClass("has-preview");this.get("contentBox").all('<div class="'+d.CSS_PREFIX+'-file-preview"></div>').remove();b.target.get("fileList")[0].get("file")},_directUploadComplete:function(c){this.get("contentBox").all('<div class="'+
d.CSS_PREFIX+'-file-preview"></div>').remove();c.media?this.set("data",new b.Squarespace.Models.ContentItem(c.media[0])):(this.get("boundingBox").removeClass("has-preview"),new b.Squarespace.Widgets.Alert({"strings.title":"Bad File","strings.message":"Unable to determine proper type information from uploaded file."}))},_directUploadFailure:function(b){this.set("data",null)}},{LANG:{TITLE_CLEAR_ASSET:"Clear Asset",CONFIRM_FILE_REMOVAL:"Are you sure you want to remove this uploaded file?",ERR_FILE_UPLOAD:"Upload failed, please retry",
ERR_SINGLE_FILE_TITLE:"Single File Only",ERR_SINGLE_FILE:"This field only accepts a single file.",HINT_FILE_UPLOAD:"Click here or drag and drop to add {type}.",HINT_FILE_UPLOAD_CLICK_ONLY:"Click here to add {type}.",MSG_FILE_UPLOAD_OK:"File Uploaded Successfully",INVALID_IMAGE_TITLE:"Invalid Image",INVALID_IMAGE:"The image does not have enough information to render.",ERR_INVALID_URL:"That doesn't appear to be a valid URL.",TITLE_DOWNLOAD_IMAGES:"Download Images from Page",TITLE_PROCESSING_FAIL:"Image Processing Failed",
ERR_PROCESSING_FAIL:"We were unable to process your image.  Please try again.",DESC_DOWNLOAD_IMAGES:"Paste the URL of a webpage with images and Squarespace will allow you to select one."},CSS_PREFIX:"sqs-file",ATTRS:{cloneInitialData:{value:!1},data:{value:null,setter:function(c){return c?c instanceof b.Squarespace.Models.ContentItem?c:b.Lang.isObject(c)?(console.warn("DialodFields.File data attribute was JSON. Should have been ContentItem model."),new b.Squarespace.Models.ContentItem(c)):b.Attribute.INVALID_VALUE:
null}},strings:{value:{title:""}},contentType:{value:"file"},contentLabel:{value:"a file"},mode:{value:b.Squarespace.UploadModes.TRANSIENT},square:{value:!1},spinnerColor:{value:"light"},recordType:{value:null},childType:{value:null},maxSize:{value:20},preflight:{value:null},isWordpressXmlFile:{value:!1}}})},"1.0",{requires:"base node json attribute squarespace-util squarespace-enum squarespace-dialog-field-2 squarespace-uploader squarespace-plugin-actionoverlay squarespace-plugin-progress-spinner squarespace-models-content-item squarespace-ui-base squarespace-dialog-label squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-settings-comments",function(b){var d=function(){};b.namespace("Squarespace.Settings.Site");b.namespace("Squarespace.Widgets");var c=b.namespace("Squarespace.Settings.Site").CommentModeration=b.Squarespace.Widgets.CommentModeration=b.Base.create("CommentModeration",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this.hideReplyForm=this.replyFormAnimGenerator("out");this.showReplyForm=this.replyFormAnimGenerator("in");this.itemId=Static.SQUARESPACE_CONTEXT.commentTargetId;
this.eventMap={};this.destroyed=!1;this.responseDelayThreshold=200;this.extending=!1;this.firstLoad=!0;this.deleting=!1;this.sortType=b.Squarespace.CommentSortTypes.NEWEST_FIRST;this.numDisplayed=0;this.threadedViewActive=!1;this.targettedCommentId="";this.lastThreadViewed=null;this._status=b.Squarespace.CommentStatuses.AWAITING_MODERATION;this.flagged=!1;this.targetRoot="";this.currentPage=1;this.commentIdToTargetData={};this.commentIdToCommentData={};this._noApproveActionTrayButtons=[{label:"Delete",
action:this.onBatchDeleteClick,context:this},{label:"Deselect",action:this.deselectAll,context:this},{label:"Select All",action:this.selectAll,context:this}];this._fullActionTrayButtons=[{label:"Approve",action:this.approveSelectedComments,context:this},{label:"Delete",action:this.onBatchDeleteClick,context:this},{label:"Deselect",action:this.deselectAll,context:this},{label:"Select All",action:this.selectAll,context:this}];this._actionTray=new b.Squarespace.Widgets.ActionTray;this.statusToClassNameMap=
{};this.statusToClassNameMap[b.Squarespace.CommentStatuses.AWAITING_MODERATION.toString()]="unmoderated";this.statusToClassNameMap[b.Squarespace.CommentStatuses.APPROVED.toString()]="approved";this.statusToClassNameMap[b.Squarespace.CommentStatuses.DELETED.toString()]="deleted";this.numSelected=0;this.targetNameMap={}},statusToClassName:function(c){return b.Object.getValue(this.statusToClassNameMap,c)||""},bindUI:function(){c.superclass.bindUI.call(this);this.eventMap={"hide-threaded":b.delegate("click",
this.hideThreaded,".panel-top-container",".threaded-exit-btn",this),"clear-flags":b.delegate("click",this.clearFlags,".panel-top-container",".clear-btn",this),"select-filter":b.delegate("click",this.selectFilter,".panel-top-container",".settings-filters div",this),"view-target":b.delegate("click",this.targetLinkOnClick,".squarespace-comment-moderation",".target-link",this),"toggle-selected":b.delegate("click",this.toggleSelected,".squarespace-comment-moderation",".comment",this),"sort-toggle":b.delegate("click",
this.sortToggle,".squarespace-comment-moderation",".sort-toggle",this),"approve-inline":b.delegate("click",this.approveSingleComment,".squarespace-comment-moderation",".approve-inline",this),"show-threaded":b.delegate("click",this.showThreaded,".squarespace-comment-moderation",".in-reply",this),"show-reply-area":b.delegate("click",this.showReplyForm,".squarespace-comment-moderation",".reply-inline",this),reply:b.delegate("click",this.onPostReplyBtnClick,".squarespace-comment-moderation",".post-reply-btn",
this),"delete-inline":b.delegate("click",this.onInlineDeleteClick,".squarespace-comment-moderation",".delete-inline",this),"deselect-all":b.delegate("click",this.deselectAll,".comment-moderation-footer",".deselect-all",this),"select-all":b.delegate("click",this.selectAll,".comment-moderation-footer",".select-all",this),"approve-selected":b.delegate("click",this.approveSelectedComments,".settings",".approve",this),"delete-selected":b.delegate("click",this.onBatchDeleteClick,".settings",".delete",this),
"check-scroll":b.one("window").on("scroll",this.checkScroll,this)}},renderUI:function(){c.superclass.renderUI.call(this);var e=this.get("contentBox");this.get("boundingBox").addClass("sqs-settings-panel");e.addClass("sqs-settings-panel-content");this.footer=b.Node.create('<div class="comment-moderation-footer"></div>');e.append('<div class="squarespace-comment-moderation"><div class="panel-top-container clear"><div class="title-container"><div class="title">Comments</div></div><div class="settings-filters tabs"><div class="unmoderated filter">Unmoderated</div><div class="comment-count unmoderated-count"></div><div class="approved filter">Approved</div><div class="flagged filter">Flagged</div><div class="comment-count flagged-count"></div></div></div><div class="moderation-body"></div></div>');
e.append(this.footer);this._actionTray.render(this.footer);this.refreshCommentData()},syncUI:function(){c.superclass.syncUI.call(this)},confirmViewTarget:function(c,d){(new b.Squarespace.Widgets.Confirmation({"strings.title":"View Post","strings.message":'Are you sure you want to leave this page and view "'+d+'"?'})).on("confirm",function(){window.location=c},this)},targetLinkOnClick:function(b){this.confirmViewTarget(b.target.getAttribute("href"),b.target.get("text"));b.stopImmediatePropagation()},
getAvatarUrl:function(b){return!b||!b.avatarAssetUrl?"/universal/images-v6/default-avatar.png?format=36w":b.avatarAssetUrl},replyFormAnimGenerator:function(c){var d=!1;return function(c){switch(c){case "in":return function(c){if(!d){var e=c.target.ancestor(".comment");if(e.hasClass("replyOpen"))this.hideReplyForm(c);else{e.addClass("replyOpen");c=b.Node.create('<div class="inline-reply-area-container"></div>');var g=b.Node.create('<textarea class="inline-reply-area"></textarea>'),p=this.getAvatarUrl(Static.SQUARESPACE_CONTEXT.account),
p=b.Node.create('<div class="inline-reply-avatar"><img src="'+p+'"></div>');g.setStyles({height:200});c.append(g);c.append('<input type="button" value="Post Reply" class="post-reply-btn"></input>');b.Node.create("<input>").append(c);var q=b.Node.create('<div class="reply-form-container"></div>');q.append(p);q.append(c);c=q.cloneNode(!0);c.setStyles({visibility:"hidden",display:"block",position:"absolute"});e.append(c);g=parseInt(c.getComputedStyle("height"),10)+5;c.remove(!0);q.setStyle("height",
0);e.append(q);e=new b.Anim({node:q,to:{height:g},duration:0.3,easing:b.Easing.easeOutStrong});d=!0;e.on("end",function(){d=!1;var c=b.one("body"),c=q.getY()+q.get("offsetHeight")-(c.get("docScrollY")+c.get("winHeight")-parseInt(this.footer.getComputedStyle("height"),10));if(0<=c){var e=q.ancestor(".main-content").get("scrollTop");(new b.Anim({node:q.ancestor(".main-content"),to:{scrollTop:e+c+parseInt(q.ancestor(".comment").getComputedStyle("paddingBottom"),10)+3*parseInt(this.footer.getComputedStyle("height"),
10)},duration:0.3,easing:b.Easing.easeOutStrong})).run()}},this);e.run()}}};case "out":return function(c){if(!d){var e=c.target.ancestor(".comment");e.one(".inline-reply-area");var g=e.one(".reply-form-container");c=new b.Anim({node:g,to:{height:0},duration:0.2,easing:b.Easing.easeOutStrong});d=!0;c.on("end",function(){d=!1;g.remove(!0);e.removeClass("replyOpen")});c.run()}};default:return function(){}}}(c)},onPostReplyBtnClick:function(c){var d=c.target.ancestor(".comment"),g=d.getAttribute("data-commentid"),
h=d.one(".inline-reply-area").get("value"),k=b.Squarespace.Lang.markdownToHTML(b.Squarespace.Utils.preFormatMarkdown(h)),l=null;if(""===h)this.showEmptyText();else(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Post Comment","strings.title":"Post Comment","strings.message":"Are you sure you want to post this comment?"})).on("confirm",function(){l=this.showReply(k,d).addClass("pending");this.hideReplyForm(c);this.sendReply({text:h,parentId:g,success:function(b){l.setAttribute("data-commentId",
b.comment.id);l.setAttribute("data-parentId",g);l.removeClass("pending")}},this)},this)},showReply:function(c,d){var g={comments:[{memberAccount:Static.SQUARESPACE_CONTEXT.authenticatedAccount,parentId:d.get("data-commentId"),status:b.Squarespace.CommentStatuses.APPROVED,parentAuthorName:d.one(".user-info .author").get("text"),addedOn:new Date,body:c,targetName:d.one(".target-link").get("text")}]},g=this.dataToNodes(g).shift();g.setStyle("paddingLeft",parseInt(d.getStyle("paddingLeft"),10)+40);d.insert(g,
"after");return g},sendReply:function(c,d){var g=Static.SQUARESPACE_CONTEXT.authenticatedAccount||{displayName:"",email:"",websiteUrl:""};b.Data.post({url:"/api/comment/CreateComment",data:{targetId:this.targetNameMap[c.parentId].id,body:c.text,replyToId:c.parentId,authorName:g.displayName,authorEmail:g.email,websiteUrl:g.websiteUrl,targetType:this.commentIdToTargetData[c.parentId].type},success:function(g){this.destroyed||(this.targetNameMap[g.comment.id]=this.targetNameMap[c.parentId],this.commentIdToCommentData[g.comment.id]=
g.comment,this.commentIdToTargetData[g.comment.id]=this.commentIdToTargetData[c.parentId],g.comment.parentAuthorName=this.commentIdToCommentData[c.parentId].parentAuthorName,b.Lang.isFunction(c.success)&&c.success.call(d||this,g))},failure:function(g){this.destroyed||b.Lang.isFunction(c.failure)&&c.failure.call(d||this,g)}},this)},getThreadNodes:function(b){var c=[];this.getThreadNodesRec(b,c);return c},getThreadNodesRec:function(c,d){d.push(c);var g=c.getAttribute("data-commentId");b.all('.comment[data-parentId="'+
g+'"]').each(function(b){this.getThreadNodesRec(b,d)},this)},onInlineDeleteClick:function(b){b=this.getThreadNodes(b.target.ancestor(".comment"));this.deleteConfirm(b)},onBatchDeleteClick:function(c){var d=[],g={};b.all(".comment.selected").each(function(b){d.push(b);g[b.getAttribute("data-commentId")]=!0});d=d.filter(function(c){return!c.hasAttribute("data-parentId")||b.Lang.isUndefined(g[c.getAttribute("data-parentId")])}).map(function(b){return this.getThreadNodes(b)},this);this.batchDeleteConfirm(d)},
batchDeleteConfirm:function(c){var d=c.map(function(b){return b[0].getAttribute("data-commentId")}),g=c.reduce(function(b,c){return b+c.length},0);c.forEach(function(b){this.setPreDelete(b)},this);this.deleting=!0;var h=new b.Squarespace.Widgets.Confirmation({style:b.Squarespace.Widgets.Confirmation.TYPE.CONFIRM_OR_REJECT,width:370,"strings.reject":"Delete","strings.confirm":"Delete & Report Spam","strings.title":1===g?"Delete Comment":"Delete "+g+" Comments","strings.message":1<g?"Are you sure you wish to delete these comments?":
"Are you sure you wish to delete this comment?"});h.on("cancel",function(){this.deleting=!1;c.forEach(function(b){this.unsetPreDelete(b)},this)},this);h.on("reject",function(){this.deleting=!1;c.forEach(function(b){this.unsetPreDelete(b);this.deselect(b);this.setDeleted(b)},this);this.deleteComments(d,!1,g);this.numSelected=0;this._actionTray.set("count",0)},this);h.on("confirm",function(){this.deleting=!1;c.forEach(function(b){this.unsetPreDelete(b);this.deselect(b);this.setDeleted(b)},this);this.deleteComments(d,
!0,g);this.numSelected=0;this._actionTray.set("count",0)},this)},deleteConfirm:function(c){var d=c[0];this.deleting=!0;this.setPreDelete(c);var g=new b.Squarespace.Widgets.Confirmation({style:b.Squarespace.Widgets.Confirmation.TYPE.CONFIRM_OR_REJECT,width:370,"strings.reject":"Delete","strings.confirm":"Delete & Report Spam","strings.title":1===c.length?"Delete Comment":"Delete "+c.length+" Comments","strings.message":1<c.length?"Are you sure you wish to delete these comments?":"Are you sure you wish to delete this comment?"});
g.on("cancel",function(){this.deleting=!1;this.unsetPreDelete(c)},this);g.on("reject",function(){this.deleting=!1;this.unsetPreDelete(c);this.deselect(c);this.setDeleted(c);this.deleteComments([d.getAttribute("data-commentId")],!1,c.length)},this);g.on("confirm",function(){this.deleting=!1;this.unsetPreDelete(c);this.deselect(c);this.setDeleted(c);this.deleteComments([d.getAttribute("data-commentId")],!0,c.length)},this)},unsetPreDelete:function(b){b.forEach(function(b){b.removeClass("pending-delete")})},
setPreDelete:function(b){b.forEach(function(b){b.addClass("pending-delete")})},setDeleted:function(c){var d=b.Node.create('<div class="delete-anim-wrapper"></div>');c[0].insert(d,"after");c.forEach(function(b){d.append(b)});this.numDisplayed-=c.length;c=new b.Anim({node:d,duration:0.3,easing:b.Easing.easeOutStrong,to:{height:0}});c.on("end",function(){d.remove(!0);this.numDisplayed||this.showNoCommentAlert()},this);c.run()},deleteComments:function(c,d,g){b.Data.post({url:"/api/comment/admin/DeleteComments",
data:{comments:c,markAsSpam:d},success:function(c){this.refreshCommentCounts();new b.Squarespace.Widgets.Information({"strings.title":1===g?"Comment Deleted":"Comments Deleted","strings.message":1===g?g+" comment has been deleted.":g+" comments have been deleted."})}},this)},showEmptyText:function(){new b.Squarespace.Widgets.Alert({"strings.title":"Enter Comment Text","strings.message":"Enter text in the field above to post a comment."})},clearFlags:function(c){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Clear Flags",
"strings.message":"Are you sure you wish to clear flags on these comments?"})).on("confirm",function(){b.Data.post({url:"/api/comment/admin/ClearFlagCounts",success:function(){this.destroyed||(b.one(".settings-filters").one(".flagged-count"),c.target.remove(!0),this.refreshCommentCounts())}},this)},this)},toggleSelected:function(b){if(!this.deleting&&!b.target.hasClass("approve-inline")&&!b.target.hasClass("delete-inline")&&!b.target.hasClass("reply-inline")&&!b.target.hasClass("inline-reply-area")&&
!b.target.hasClass("inline-reply-area")&&!b.target.hasClass("post-reply-btn")&&!b.target.hasClass("context-inline")&&!b.target.hasClass("in-reply")){var c=b.target.ancestor(".comment");c||(c=b.target);c.hasClass("selected")?(this.decNumSelected(),this.animToUnselected(c)):(this.incNumSelected(),this.animToSelected(c))}},selectAll:function(c){b.all(".comment").each(function(b){b.hasClass("selected")||(this.animToSelected(b),this.incNumSelected())},this)},deselectAll:function(c){b.all(".comment").each(function(b){b.hasClass("selected")&&
(this.animToUnselected(b),this.decNumSelected())},this)},deselect:function(b){b.forEach(function(b){b.hasClass("selected")&&(this.animToUnselected(b),this.decNumSelected())},this)},select:function(b){b.forEach(function(b){b.hasClass("selected")||(this.animToSelected(b),this.incNumSelected())},this)},selectFilter:function(c){this._actionTray.set("count",0);if(!this.deleting)if(this.threadedViewActive)this.hideThreaded(),this.selectFilter(c);else{var d=this._status,g=this.flagged,h=c.target.ancestor(".settings-filters");
this.flagged=!1;c.target.hasClass("approved")?this._status=b.Squarespace.CommentStatuses.APPROVED:c.target.hasClass("unmoderated")?this._status=b.Squarespace.CommentStatuses.AWAITING_MODERATION:c.target.hasClass("flagged")&&(this.flagged=!0);var k=b.one(".clear-btn");k&&k.remove(!0);d=this._status!==d||this.flagged!==g;if(this.itemId||d)this.itemId=null,h.all(".active").each(function(b){b.removeClass("active")}),c.target.addClass("active"),this.refreshCommentData()}},sortToggle:function(c){c=b.one(".sort-toggle");
this.sortType===b.Squarespace.CommentSortTypes.OLDEST_FIRST?(this.sortType=b.Squarespace.CommentSortTypes.NEWEST_FIRST,c.set("innerHTML","Newest first")):(this.sortType=b.Squarespace.CommentSortTypes.OLDEST_FIRST,c.set("innerHTML","Oldest first"));this.refreshCommentData()},toApproved:function(b){b.removeClass("unmoderated");b.removeClass("deleted");b.addClass("approved");this.animToUnselected(b);b.all(".avatar, .user-info, .comment-body").each(function(b){b.removeClass("unmoderated");b.removeClass("deleted");
b.setStyle("textDecoration","none")},this)},approveSelectedComments:function(c){c.target.hasClass("inactive")||(c=this.getSelectedIds(),c.length&&b.Data.post({url:"/api/comment/admin/ApproveComments",data:{comments:c},success:function(c){this.destroyed||(b.all(".squarespace-comment-moderation .selected").each(function(c){if(this._status===b.Squarespace.CommentStatuses.APPROVED||this.threadedViewActive)this.toApproved(c),this.threadedViewActive&&this.toApproved(b.one(".moderation-body .comment[data-commentid="+
c.getAttribute("data-commentid")+"]"));else{this.numDisplayed-=1;var e=new b.Anim({node:c,duration:0.3,to:{opacity:0},easing:b.Easing.easeOutStrong});e.on("end",function(){c.remove(!0);this.numDisplayed||this.showNoCommentAlert()},this);e.run()}},this),this.numSelected=0,this._actionTray.set("count",this._numSelected),new b.Squarespace.Widgets.Information({"strings.title":"Comments Approved","strings.message":"The selected comments have been approved."}),this.refreshCommentCounts())}},this))},toDeleted:function(b){b.removeClass("unmoderated");
b.removeClass("approved");b.addClass("deleted");this.animToUnselected(b);b.all(".avatar, .user-info, .comment-body").each(function(b){b.removeClass("unmoderated");b.removeClass("approved");b.addClass("deleted")})},reset:function(){for(;0<this.numSelected;)this.decNumSelected();b.all(".moderation-body .selected").each(function(b){this.animToUnselected(b)},this)},showThreaded:function(c){var d=c.target,g=b.one(".moderation-body"),h,k,l=Number.MAX_VALUE,p={},q,r;this.reset();c.target.hasClass("comment")||
(d=c.target.ancestor(".comment"));h=d.getAttribute("data-commentid");this.targettedCommentId!==h&&this.targetRoot!==h&&(this.targettedCommentId=h,this.lastThreadViewed=d,b.Data.get({url:"/api/comment/GetThread",data:{commentId:h,sortBy:b.Squarespace.CommentSortTypes.NEWEST_FIRST},success:function(d){if(!this.destroyed){this.reset();this.threadedViewActive=!0;b.one(".threaded-view")&&this.hideThreaded(c);b.one(".threaded-exit-button")||b.one(".panel-top-container").append('<input class="threaded-exit-btn" type="button" value="Exit Thread"></input>');
for(k=0;k<d.comments.length;k++)d.comments[k].comment.depth<l&&(l=d.comments[k].comment.depth),0===d.comments[k].comment.depth&&(this.targetRoot=d.comments[k].comment.id),p[d.comments[k].comment.id]=d.comments[k].comment.depth,this.targetNameMap[d.comments[k].comment.id]={name:d.comments[k].targetName,id:d.comments[k].targetId};q=this.dataToNodes(this.dataToRenderable(d));r=b.Node.create('<div class="moderation-body threaded-view"></div>');for(k=0;k<q.length;k++)r.append(q[k]);q=r;q.setStyle("zIndex",
11E3);q.all(".comment").each(function(b){b.setStyle("marginLeft",40*(p[b.getAttribute("data-commentid")]-l)+"px")},this);g.setStyle("display","none");this.get("contentBox").one(".squarespace-comment-moderation").append(q);b.one(".panel-top-container").scrollIntoView();this.animToSelected(q.one(".comment[data-commentid="+h+"]"))}},failure:function(b){}},this))},hideThreaded:function(c){c=b.one(".threaded-view");var d=b.one(".moderation-body"),g=b.one(".threaded-exit-btn");this.reset();this.threadedViewActive=
!1;c.remove(!0);g.remove();this.targetRoot=this.targettedCommentId="";d.setStyle("display","block");this.lastThreadViewed.scrollIntoView(!0)},checkScroll:function(c){!b.one(".moderation-body.threaded-view")&&this.numDisplayed&&(this.currentPage<this.numPages&&!this.extending)&&(c=b.one("body"),c=(c.get("scrollTop")+b.DOM.viewportRegion().height)/c.get("scrollHeight"),this.lastScrollRatio<c&&0.8<=c&&this.extendComments(),this.lastScrollRatio=c)},onLoading:function(){var c=b.one(".moderation-body");
null!==c&&c.empty()},postLoading:d,onExtendLoading:d,extendPostLoading:d,extendComments:function(){this.extending=!0;var c=b.one(".main-content").get("scrollTop");this.extending=!0;b.Data.get({url:"/api/comment/admin/GetAllComments",data:{sortType:this.sortType,page:this.currentPage+1,commentStatus:this._status,flagged:this.flagged,itemId:this.itemId},success:function(d){this.destroyed||(this.currentPage+=1,this.populateDataMaps(d),this.data.comments=this.data.comments.concat(d.comments),this.renderExtend(d),
b.one(".main-content").set("scrollTop",c),this.extending=!1)},failure:function(b){this.extending=!1}},this)},incNumSelected:function(){this.numSelected+=1;this._actionTray.set("count",this.numSelected)},decNumSelected:function(){this.numSelected-=1;this._actionTray.set("count",this.numSelected)},fadeOutComment:function(c,d){c.wrap('<div class="temporary-wrapper"></div>');var g=c.ancestor(".temporary-wrapper"),h=c.get("offsetHeight"),k=new b.Anim({node:c,duration:0.3,to:{opacity:0},easing:b.Easing.easeOutStrong}),
l=new b.Anim({node:g,duration:0.3,to:{height:0},easing:b.Easing.easeOutStrong});g.setStyle("height",h);k.on("end",function(){b.later(80,this,function(){c.remove(!0);l.on("end",function(){g.remove(!0);this.fire(d+"-animation-complete");b.one(".moderation-body").get("children").size()||this.refreshCommentData()},this);l.run()})},this);k.run()},animToDeleted:function(b){this.fadeOutComment(b,"delete")},animToApproved:function(b){this.fadeOutComment(b,"approve")},approveSingleComment:function(c){var d=
c.target;d.hasClass("comment")||(d=d.ancestor(".comment"));b.Data.post({url:"/api/comment/admin/ApproveComments",data:{comments:[d.getAttribute("data-commentid")]},success:function(c){this.destroyed||(this._status===b.Squarespace.CommentStatuses.APPROVED||this.threadedViewActive||this.flagged&&this.commentIdToCommentData[d.getAttribute("data-commentid")].flagCount>this.flagThreshold?(this.toApproved(d),this.threadedViewActive&&this.toApproved(b.one(".moderation-body .comment[data-commentid="+d.getAttribute("data-commentid")+
"]"))):(this.eventMap["approve-inline"].detach(),this.once("approve-animation-complete",function(){this.eventMap["approve-inline"]=b.delegate("click",this.approveSingleComment,".squarespace-comment-moderation",".approve-inline",this);(this.numDisplayed-=1)||this.showNoCommentAlert()},this),this.animToApproved(d)),this.refreshCommentCounts())},failure:function(b){}},this)},destructor:function(){this.destroyed=!0;b.Object.each(this.eventMap,function(b){b.detach()},this);this.eventMap=null},animToSelected:function(b){b.addClass("selected")},
animToUnselected:function(b){b.removeClass("selected")},refreshCommentData:function(){this.onLoading();var c=b.one(".settings-filters");b.Data.get({url:"/api/comment/admin/GetAllComments",data:{sortType:this.sortType,itemId:this.itemId,page:1,commentStatus:this._status,flagged:this.flagged},success:function(d){if(!this.destroyed&&(this.itemId||this.flagged||!(0<d.comments.length&&d.comments[0].comment.status!==this._status))){this.get("contentBox").toggleClass("viewing-item",!!this.itemId);d.comments=
d.comments.filter(function(c){return b.Lang.isUndefined(c.targetId)?(console.warn("WARNING: Comment "+c.comment.id+" refers to collection/item "+c.comment.targetId+" but has no name or URL information. It's likely that this item / collection was deleted manually (and improperly) in the database. Please delete this comment data."),!1):c});b.one(".comment-moderation-footer");this.numPages=Math.max(Math.ceil(d.totalComments/25),1);this.data=d;this.currentPage=1;this.numDisplayed=this.data.comments.length;
this.numSelected=0;this.flagThreshold=this.data.flagThreshold;if(d.comments.length)this.populateDataMaps(d),this.flagged||b.one("."+this.statusToClassName(this._status)).addClass("active"),this._actionTray.set("buttons",this._noApproveActionTrayButtons),this._status!==b.Squarespace.CommentStatuses.APPROVED&&this._actionTray.set("buttons",this._fullActionTrayButtons);else{if(this.firstLoad){this._status=b.Squarespace.CommentStatuses.APPROVED;c.one(".approved ").addClass("active");c.one(".unmoderated").removeClass("active");
this.firstLoad=!1;this.refreshCommentData();return}this.flagged?b.one(".flagged").addClass("active"):b.one("."+this.statusToClassName(this._status)).addClass("active");b.all(".comment-moderation-footer [type=button]").each(function(b){b.remove(!0)},this)}this.firstLoad=!1;this.postLoading();this._renderManager(d);b.one("window").set("scrollTop",0);this.refreshCommentCounts()}}},this)},populateDataMaps:function(b){for(var c=0,d=b.comments.length;c<d;c++)this.targetNameMap[b.comments[c].comment.id]=
{name:b.comments[c].targetName,id:b.comments[c].targetId},this.commentIdToTargetData[b.comments[c].comment.id]={name:b.comments[c].targetName,id:b.comments[c].targetId,urlId:b.comments[c].targetUrlId,type:b.comments[c].targetType},this.commentIdToTargetData[b.comments[c].comment.id].collectionUrlId=b.comments[c].targetCollectionUrlId||void 0,this.commentIdToCommentData[b.comments[c].comment.id]=b.comments[c].comment},refreshCommentCounts:function(){b.Data.get({url:"/api/comment/admin/GetModerationCounts",
success:function(c){if(!this.destroyed||!this.get("destroyed")){var d=b.one(".settings-filters"),g=d.one(".flagged-count"),h=d.one(".unmoderated-count"),g=parseInt(g.get("text"),10),k=parseInt(h.get("text"),10),h=c.unmoderatedCount;c=c.flagCount;d.one(".unmoderated");d.one(".flagged");var l=b.one(".clear-btn");0<c?!l&&this.flagged&&b.one(".panel-top-container").append('<div class="clear-btn">Clear Flags</div>'):l&&l.remove(!0);g!==c&&(g=d.one(".flagged-count"),g.set("innerHTML",0<c?c:""),0<c?g.addClass("visible"):
g.removeClass("visible"));k!==h&&(Static.SQUARESPACE_CONTEXT.website.unmoderatedCommentCount=h,d=d.one(".unmoderated-count"),d.set("innerHTML",0<h?h:""),0<h?d.addClass("visible"):d.removeClass("visible"));b.Global.fire("sqsContextChange")}}},this)},dataToRenderable:function(b){for(var c={comments:[]},d=0;d<b.comments.length;d++)c.comments.push(b.comments[d].comment),b.comments[d].parentAuthorName&&(c.comments[d].parentAuthorName=b.comments[d].parentAuthorName);return c},renderExtend:function(c){var d,
g;this.data.comments.length&&(d=this.get("contentBox").one(".moderation-body"),c=this.dataToRenderable(c),c.comments.length&&(g=d.cloneNode(!0),b.Array.each(this.dataToNodes(c),function(b){g.append(b)},this),d.replace(g)))},showNoCommentAlert:function(){var c;this.flagged?c="There are no comments currently flagged.":this._status===b.Squarespace.CommentStatuses.APPROVED?c="There are no comments to display.":this._status===b.Squarespace.CommentStatuses.AWAITING_MODERATION&&(c="There are no comments awaiting moderation.");
var d=b.one(".moderation-body");c='<div class="no-comments"><img class="icon large" src="/universal/images-v6/configuration/no-comments.png"><div class="empty-text">'+c+"</div></div>";d.empty();d.append(c)},_renderManager:function(c){var d=b.one(".moderation-body"),g=d.cloneNode(!0).empty();c=this.dataToRenderable(c);if(c.comments.length){c=this.dataToNodes(c);for(var h=0;h<c.length;h++)g.append(c[h]);d.replace(g)}else this.showNoCommentAlert()},escapeComment:function(c){c.authorName=b.Squarespace.Escaping.escapeForHtml(c.authorName);
c.memberAccount&&(c.memberAccount.displayName=b.Squarespace.Escaping.escapeForHtml(c.memberAccount.displayName),c.memberAccount.email=b.Squarespace.Escaping.escapeForHtml(c.memberAccount.email),c.memberAccount.bio=b.Squarespace.Escaping.escapeForHtml(c.memberAccount.bio))},getTargetUrlForComment:function(c){c=this.commentIdToTargetData[c.id||c.parentId];return b.Lang.isUndefined(c)?"":"/"+(c.collectionUrlId?c.collectionUrlId+"/":"")+c.urlId},_getAuthorString:function(c){var d="";c.memberAccount?d=
c.memberAccount.displayName:(d=c.authorName,c.authorEmail?d+=" "+("("+c.authorEmail+")"):c.authorUrl&&(d='<a target="_blank" href="'+b.Escape.html(c.authorUrl)+'">'+c.authorName+"</a>"));return d},_getTargetName:function(c){c=c.targetName||b.Squarespace.Escaping.escapeForHtml(this.targetNameMap[c.id].name)||"---";30<c.length&&(c=c.trim().substr(0,30)+"...");return c},dataToNodes:function(c){var d=this._status!==b.Squarespace.CommentStatuses.AWAITING_MODERATION;return b.Array.map(c.comments,function(c,
e){var k=this._getTargetName(c);this.escapeComment(c);var l=this.getAvatarUrl(c.memberAccount),k=(d?'<span class="target-link" href="'+this.getTargetUrlForComment(c)+'">'+k+"</span>":k)+'<span class="in-reply">'+(c.parentAuthorName?" in reply to "+c.parentAuthorName:"")+"</span></span>",l='<div data-commentid="'+c.id+'" class="comment '+(this.statusToClassName(c.status.toString())||"")+'"><div class="comment-header"><div class="avatar"><img src="'+l+'"></div><div class="user-info"><span class="author">'+
this._getAuthorString(c)+'</span><span class="date"> '+b.Squarespace.DateUtils.humanizeDate(c.addedOn)+'</span><span class="target"> on '+k+'</span></span><div class="inline-btn-container"><div class="inline-btn delete-inline"></div><div class="inline-btn approve-inline"></div><div class="inline-btn reply-inline"></div></div></div><div class="comment-body"></div></div>',l=b.Node.create(l);l.one(".comment-body").set("innerHTML",c.body);return l},this)},getSelectedIds:function(){var c=[];b.all(".squarespace-comment-moderation .selected").each(function(b){c.push(b.getAttribute("data-commentid"))});
return c}},{CSS_PREFIX:"sqs-comment-moderation"})},"1.0",{requires:"oop node anim escape squarespace-util squarespace-date-utils squarespace-tray squarespace-dombuilder squarespace-markdown squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-template-install",function(b){b.namespace("Squarespace").TemplateInstallRPC={createProvider:function(d){var c=new easyXDM.Rpc({},{local:{configure:d.configureFn},remote:{onLoad:{},installTemplate:{}}});b.Squarespace.Signup.show=function(){c.installTemplate.apply(c,arguments)};c.onLoad();return c},createConsumer:function(b){return new easyXDM.Rpc({remote:"https://www."+Static.SQUARESPACE_CONTEXT.appDomain+"/templates/?mode=template-install&nochrome=true&t="+(new Date).getTime(),
container:b.container},{local:{onLoad:b.onLoad,installTemplate:b.installTemplate},remote:{configure:{}}})}}},"1.0",{requires:["thirdparty-easyxdm"]});
YUI.add("text-accentfold",function(b,d){var c=b.Array,e=b.Text,f=e.Data.AccentFold,g={canFold:function(b){for(var c in f)if(f.hasOwnProperty(c)&&-1!==b.search(f[c]))return!0;return!1},compare:function(b,c,e){b=g.fold(b);c=g.fold(c);return e?!!e(b,c):b===c},filter:function(b,e){return c.filter(b,function(b){return e(g.fold(b))})},fold:function(e){if(b.Lang.isArray(e))return c.map(e,g.fold);e=e.toLowerCase();b.Object.each(f,function(b,c){e=e.replace(b,c)});return e}};e.AccentFold=g},"3.17.2",{requires:["array-extras",
"text-data-accentfold"]});
YUI.add("squarespace-models-connected-account",function(b){b.namespace("Squarespace.Models");var d=b.Base.create("ConnectedAccount",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.REST_API_ROOT+"social-accounts/{id}",root:b.Squarespace.REST_API_ROOT+"social-accounts",resetSubscription:function(){b.Data.post({url:"/api/config/ResetSocialAccountSubscription",data:{connectedAccountId:this.get("id")}},this)}},{ATTRS:{unauthorized:{getter:function(){return this.get("accountState")===b.Squarespace.AccountStates.UNAUTHORIZED}},
hash:{readOnly:!0,getter:function(){return this.get("serviceName").toLowerCase()+"-"+this.get("userId")}},userName:{validator:b.Lang.isString,value:null},accountState:{value:b.Squarespace.AccountStates.ACTIVE},websiteId:{value:null},profileUrl:{validator:b.Lang.isString,value:null},serviceId:{validator:b.Lang.isNumber},serviceName:{validator:b.Lang.isString},pullEnabled:{validator:b.Lang.isBoolean,value:!1},pushEnabled:{validator:b.Lang.isBoolean,value:!0},autoPushEnabled:{validator:b.Lang.isBoolean,
value:!1},iconEnabled:{validator:b.Lang.isBoolean},userId:{validator:b.Lang.isString},iconURL:{validator:b.Lang.isString},defaultPushMessage:{validator:b.Lang.isString},screenName:{validator:b.Lang.isString},collectionId:{validator:b.Lang.isString},metaData:{validator:b.Lang.isObject,value:null}}});b.Squarespace.Models.ConnectedAccount=d},"1.0",{requires:["base","model","squarespace-model-sync-rest","squarespace-util","squarespace-enum"]});
YUI.add("squarespace-text-editor",function(b){b.namespace("Squarespace");b.Squarespace.TextEditor=b.Base.create("textEditor",b.Base,[],{initializer:function(d){this.el=d.el;this.el.setStyles({width:"100%",height:"100%"});this.el.get("parentNode").setStyle("overflow","hidden");d.tabIndex&&this.el.setAttribute("tabIndex",d.tabIndex);this.editor=CodeMirror.fromTextArea(this.el._node,{lineWrapping:!0,mode:this.get("mode")});this._setOptionsForMode(this.get("mode"));b.later(300,this,function(){this.editor.setSelection({line:0,
ch:0},{line:0,ch:1});this.editor.setSelection({line:0,ch:0},{line:0,ch:0})});this.on("modeChange",this._loadMode,this);this.on("heightChange",this._setHeight,this);this.set("height",this.el.get("parentNode").getStyle("height"))},setHeight:function(b){this.set("height",b)},getContent:function(){return this.editor.getValue()},setContent:function(b){return this.editor.setValue(b||"")},getContentHeight:function(){return parseInt(this.el.get("parentNode").one(".CodeMirror-scroll").getStyle("height"),10)},
focus:function(){this.editor.refresh();return this.editor.focus()},execCommand:function(){},_clearOptions:function(){this.editor.setOption("matchBrackets",!1);this.editor.setOption("autoCloseBrackets",!1);this.editor.setOption("matchTags",!1);this.editor.setOption("autoCloseTags",!1)},_setOptionsForMode:function(b){switch(b){case "css":case "javascript":this.editor.setOption("matchBrackets",!0);this.editor.setOption("autoCloseBrackets",!0);break;case "htmlmixed":this.editor.setOption("matchTags",
!0),this.editor.setOption("autoCloseTags",!0)}},_loadMode:function(b){this._clearOptions();this.editor.setOption("mode",b.newVal);this._setOptionsForMode(b.newVal)},_setHeight:function(b){this.el.get("parentNode").one(".CodeMirror-scroll").setStyle("height",b.newVal)}},{ATTRS:{mode:{value:"htmlmixed"},height:{value:-1}}})},"1.0",{requires:["node","base","thirdparty-codemirror"]});
YUI.add("squarespace-tab-view",function(b){var d=b.namespace("Squarespace.Widgets").TabView=b.Base.create("tabView",b.Squarespace.Widgets.SSWidget,[],{initializer:function(b){this._saveChildWidgetDeclarations();this._childWidgets={};this._tabContentWrapperNodes=[];this._activeChildId=this._activeChildWidget=null;this.publish("tab-switch-requested",{defaultFn:this._switchTabsDefFn,preventable:!0,context:this,emitFacade:!0})},destructor:function(){this._tabContentWrapperNodes=this._parent=this._activeChildId=
this._activeChildWidget=this._childWidgetIndexes=this._childWidgetOrder=this._childWidgets=this._childWidgetDeclarations=null;b.Object.each(this._childWidgets,function(b){b&&b.destroy({remove:!0})},this)},renderUI:function(){d.superclass.renderUI.call(this);var b=this.getProperty("CSS_PREFIX"),e=this.get("contentBox"),f="."+b+"-self",g=e.one(f);if(g)this._set("tabBox",g);else throw this.name+": No element found matching tabBox selector ("+f+").";f=this.get("tabContentBox");f.inDoc()||e.appendChild(f);
f.addClass(b+"-children");this._selectInitialTab()},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("id");this.get("tabBox").on(b+"|click",function(b){b.preventDefault();b.stopPropagation();(b=b.target.ancestor(function(b){return!!b.getData("tabId")},!0))&&this.switchTabs(b.getData("tabId"))},this);var e=this.get("parent")||this._parent;if(e)e.on(b+"|tab-switch-requested",function(b){this.fire("tab-switch-requested",{tabId:null,originalTabSwitchEvent:b.originalTabSwitchEvent||b})},
this)},_saveChildWidgetDeclarations:function(){this._childWidgetDeclarations={};this._childWidgetIndexes={};this._childWidgetOrder=[];this._recurseThroughDeclarations();b.Array.each(this._childWidgetOrder,function(b,e){this._childWidgetIndexes[b]=e},this)},_recurseThroughDeclarations:function(c){b.Lang.isUndefined(c)&&(c=this.get("widgets"));b.Array.each(c,function(c){if(!b.Lang.isNull(c))if(c.widgets)this._saveChildWidgetDeclarations(c.widgets);else if(c.ctor)this._childWidgetDeclarations[c.id]=
c,this._childWidgetOrder.push(c.id);else throw this.name+": No ctor or widgets array found in declaration";},this)},_selectInitialTab:function(){var b=this.get("initialTabId");if(!b){var e=null;this.get("tabBox").all("*").some(function(b){return b.getData("tabId")?(e=b,!0):!1},this);if(!e){console.warn(this.name+': No first tab found. Is "data-tabId"="some-id" set?');return}b=e.getData("tabId")}this.switchTabs(b)},refreshCurrentTab:function(){this._switchTabs(this._activeChildId)},switchTabs:function(c){if(!b.Lang.isNull(c)&&
!this._childWidgetDeclarations[c])throw this.name+": Tab id '"+c+"' does not exist";c!=this._activeChild&&this.fire("tab-switch-requested",{tabId:c})},getActiveChildId:function(){return this._activeChildId},getChildWidgets:function(){return this._childWidgets},_switchTabsDefFn:function(b){this._switchTabs(b.tabId)},_switchTabs:function(c){var e=this.get("tabBox"),d=this._activeChildId,g=this._childWidgetIndexes[d],h=this._childWidgets[d],k=this._childWidgetIndexes[c],l=this._childWidgets[c];if(!b.Lang.isNull(c)){e.all(".active").removeClass("active");
var p,q;h&&(p=this._tabContentWrapperNodes[g]);l?q=this._tabContentWrapperNodes[k]:(q=b.Node.create("<div/>"),q.addClass("tab-wrapper"),q.setAttribute("data-tabId",c),this.get("tabContentBox").insert(q,k+1),l=this._childWidgetDeclarations[c],l=new l.ctor(b.merge(l.config||{},{parent:this,container:q})),l.render(q),this._childWidgets[c]=l,this._tabContentWrapperNodes[k]=q);k=b.bind(function(){this.get("destroyOnSwitch")?(p.remove(!0),h.destroy({remove:!0}),this._childWidgets[d]=null,this._tabContentWrapperNodes[g]=
null):p.hide()},this);p&&q&&k();q.show();e.all("*").some(function(b){return b.getData("tabId")===c?(b.addClass("active"),!0):!1},this);this._activeChildId=c;this._activeChildWidget=l}},toJSON:function(){var b=this.getAttrs();return{widgets:this._convertForTemplateContext(b.widgets),id:b.id,className:b.className,strings:b.strings}},_convertForTemplateContext:function(c){var e=[];b.Array.each(c,function(c){if(!b.Lang.isNull(c))if(c.widgets)e.push({label:c.label||"",widgets:this._convertForTemplateContext(c.widgets)});
else if(c.ctor)e.push({label:c.label||"",id:c.id});else throw this.name+": No ctor or widgets array found in declaration";},this);return e},_validateWidgets:function(c){return!b.Lang.isArray(c)?(console.warn(this.name+": An array of tab item declarations is required."),!1):b.Array.some(c,function(c){return b.Lang.isUndefined(c.ctor)?b.Lang.isUndefined(c.widgets)?(console.warn(this.name+": Declaration did not include a ctor or widgets property. Was:",c),!0):!this._validateWidgetGroupDeclaration(c):
!this._validateWidgetDeclaration(c)},this)},_validateWidgetDeclaration:function(c){if(!b.Lang.isString(c.id))return console.warn(this.name+": Each widget requires an id."),!1;if(!c.ctor||!b.Lang.isFunction(c.ctor))return console.warn(this.name+": Each widget requires a 'ctor' (constructor function)"),!1},_validateWidgetGroupDeclaration:function(c){c=c.widgets;return!c?(console.warn(this.name+": Each group declaration needs a 'widgets' property"),!1):b.Array.some(c,function(b){return!this._validateWidgetDeclaration},
this)}},{CSS_PREFIX:"sqs-tab-view",HANDLEBARS_TEMPLATE:"tab-view.html",ATTRS:{strings:{value:{title:"",description:""}},tabBox:{value:null,readOnly:!0},tabContentBox:{valueFn:function(){return b.Node.create("<div/>")},writeOnce:"initOnly"},initialTabId:{value:null},destroyOnSwitch:{value:!1,validator:b.Lang.isBoolean},widgets:{value:[],validator:"_validateWidgets",initOnly:!0},switchAnimation:{value:null}}})},"1.0",{requires:["base-build","squarespace-ss-widget","squarespace-tab-view-template","squarespace-tab-view-tab-template",
"squarespace-tab-view-tab-group-template"]});YUI.add("squarespace-block-social-account-links-legacy-model",function(b){b.namespace("Squarespace.ContentModel").SocialAccountLinksLegacyBlock=b.Base.create("SocialAccountLinksLegacyBlockModel",b.Squarespace.ContentModel.SocialAccountLinksBlock,[],{},{ATTRS:{accountIds:{valueFn:function(){return b.Array.map(b.Squarespace.Block.SocialAccountLinksUtils.getAccountsWithProfileUrl(),function(b){return b.id})}}}})},"1.0",{requires:["squarespace-block-social-account-links-model"]});
YUI.add("squarespace-widgets-sorter",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.Sorter=b.Base.create("Sorter",b.Squarespace.Widgets.SSWidget,[],{renderUI:function(){d.superclass.renderUI.call(this);b.Array.each(this.get("sortFieldConfigs"),this._renderSortField,this)},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").delegate("click",function(b){this._updateSortedBy(b.currentTarget.getData("sortType"))},".sort-field",this);this.after("sortedByChange",
function(b){this.syncUI();this._sortSortable()},this)},syncUI:function(){d.superclass.syncUI.call(this);this._updateSortedByNode()},_renderSortField:function(b){var e=b.name,d=e.replace(" ","-").toLowerCase();this.get("contentBox").appendChild('<div class="sort-field '+d+'"><div class="field-name">'+e+'</div><div class="sort-direction"></div></div>').setData("sortType",b.type)},_updateSortedBy:function(c){var e=this.get("sortedBy"),d={type:c};d.direction=e.type===c&&e.direction===b.Squarespace.OrderDirection.DESCENDING?
b.Squarespace.OrderDirection.ASCENDING:b.Squarespace.OrderDirection.DESCENDING;this._set("sortedBy",d)},_updateSortedByNode:function(){var c=this.get("contentBox").all(".sort-field"),e=this.get("sortedBy");c.removeClass("ascending").removeClass("descending");c.each(function(c){c.getData("sortType")===e.type&&(e.direction===b.Squarespace.OrderDirection.ASCENDING?c.addClass("ascending"):c.addClass("descending"))},this)},_sortSortable:function(){var c=this.get("sortable"),e=this.get("sortedBy"),d=e.direction===
b.Squarespace.OrderDirection.DESCENDING;c.set("sortType",e.type);c.sort({descending:d})}},{CSS_PREFIX:"sqs-sorter",ATTRS:{sortable:{value:null,validator:function(c){if(b.Squarespace.AttrValidators.isNullOrObject(c)){if(b.Lang.isUndefined(c.get("sortType")))return console.error("Squarespace.Widgets.Sortable: sortable attribute has no sortType attribute."),!1;if(!b.Lang.isFunction(c.sort))return console.error("Squarespace.Widgets.Sortable: sortable attribute has no sort method."),!1}else return console.error("Squarespace.Widgets.Sortable: Invalid sortable type."),
!1;return!0},writeOnce:"initOnly"},sortFieldConfigs:{value:[],validator:b.Squarespace.AttrValidators.isArray,writeOnce:"initOnly"},sortedBy:{valueFn:function(){return{type:this.get("sortFieldConfigs")[0].type,direction:b.Squarespace.OrderDirection.ASCENDING}}}}})},"1.0",{requires:["base","squarespace-attr-validators","squarespace-enum","squarespace-ss-widget"]});
YUI.add("squarespace-block-label",function(b){b.namespace("Squarespace.Block").Label=b.Base.create("blockLabel",b.Squarespace.SSWidget,[b.WidgetChild],{renderUI:function(){this.get("contentBox").setHTML(this.get("label"))}},{CSS_PREFIX:"sqs-blocklabel",NS:"blockLabel",ATTRS:{label:{value:null}}})},"1.0",{requires:["base","widget-child","squarespace-ss-widget"]});
YUI.add("squarespace-connected-accounts-list",function(b){var d={smugmug:[b.Squarespace.Plugins.SmugMugSync],dropbox:[b.Squarespace.Plugins.DropboxSync]};b.namespace("Squarespace.Widgets").ConnectedAccountsList=b.Base.create("ConnectedAccountsList",b.Widget,[b.WidgetParent],{initializer:function(b){this._widgets=[];this.publish("connectedAccountWidget:reauthenticate",{emitFacade:!0})},destructor:function(){b.Lang.isValue(this._dragDelegate)&&this._dragDelegate.destroy()},renderUI:function(){var c=
this.get("contentBox");this._dragDelegate=new b.DD.Delegate({container:c,nodes:".sqs-connected-account",target:!0});this._reorderPlugin=this._dragDelegate.dd.plug(b.Squarespace.DDReorder,{container:c,nodes:".sqs-connected-account"}).ddreorder;this._dragDelegate.dd.plug(b.Plugin.DDConstrained,{constrain2node:".sqs-connected-account-list"})},bindUI:function(){this.get("models").after(["load","remove"],this.syncUI,this);this.after("orderLockedChange",this._toggleOrderLock,this);this._reorderPlugin.after("reordered",
this._updateDisplayOrder,this)},syncUI:function(){var c=this.get("models").toArray(),e=this.get("displayOrder");b.Lang.isValue(e)&&(c=this._sort(c,e));e=this.get("contentBox");0>=c.length?e.setContent('<div class="large-notice">You do not have any connected accounts.</div>'):(this.removeAll().each(function(b){b.destroy()}),e.empty(),b.Array.each(c,this._createAndRender,this));this._dragDelegate.syncTargets()},_sort:function(c,e){var d=b.Array.reduce(c,{},function(b,c){b[c.get("id")]=c;return b}),
g=b.Array.reduce(e,[],function(c,e){var g=d[e];b.Lang.isValue(g)&&(c.push(g),delete d[e]);return c}),h=b.Object.values(d);return g.concat(h)},_toggleOrderLock:function(b){b.newVal?this._lockOrder():this._unlockOrder()},_lockOrder:function(){!b.Lang.isValue(this._dragBlockHandle)&&b.Lang.isValue(this._sorter)&&(this._dragBlockHandle=this._sorter.delegate.before("drag:mouseDown",function(b){b.preventDefault()}))},_unlockOrder:function(){b.Lang.isValue(this._dragBlockHandle)&&this._dragBlockHandle.detach()},
_createAndRender:function(c){var e=c.get("serviceName");c=new b.Squarespace.Widgets.ConnectedAccount({model:c,plugins:d[e]||[]});this.add(c)},_updateDisplayOrder:function(){var c=this.get("contentBox").get("children"),c=b.Array.reduce(c.getDOMNodes(),[],function(c,d){b.one(d).hasClass("yui3-dd-super-proxy-clone")||c.push(b.Widget.getByNode(d).get("model").get("id"));return c});this.set("displayOrder",c)}},{CSS_PREFIX:"sqs-connected-account-list",ATTRS:{models:{valueFn:function(){return new b.Squarespace.Models.ConnectedAccounts},
validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.ConnectedAccounts)},orderLocked:{value:!1},displayOrder:{validator:b.Lang.isArray,value:null}}})},"1.0",{requires:"base dd-constrain event-custom handlebars squarespace-connected-account-widget squarespace-dd-behaviors squarespace-dropbox-sync-plugin squarespace-models-connected-accounts squarespace-smugmug-sync-plugin squarespace-attr-validators widget widget-parent".split(" ")});
YUI.add("squarespace-plugin-actionoverlay",function(b){b.namespace("Squarespace");b.Squarespace.ActionOverlayButtons={EDIT_IMAGE:"edit-image",IMAGE_INFO:"image-info",REMOVE_IMAGE:"remove-image"};b.namespace("Squarespace.Plugin").ActionOverlay=b.Base.create("ActionOverlay",b.Plugin.Base,[],{initializer:function(){this._buttonEls={};this.render();this.after("positionChange",function(){this.el&&this.el.set("className",this.constructor.CSS_NAMESPACE+" "+this.get("position"))});(this.get("anchor")||this.get("host")).on("mouseenter",
this._alignEl,this)},getButtonEl:function(b){return this._buttonEls[b]},setLoadingState:function(d,c){var e=this.getButtonEl(d);e?(e.empty(!0),c?(this.el.addClass("loading"),e.addClass("loading"),new b.Squarespace.Spinner({render:e})):(this.el.removeClass("loading"),e.removeClass("loading"))):console.warn("Could not set loading state, button with name: "+d+" not found.")},render:function(){this.el&&this.el.remove();for(var d=b.Node.create('<div class="'+this.constructor.CSS_NAMESPACE+" "+this.get("position")+
'"></div>'),c=0;c<this.get("buttons").length;c++){var e=this.get("buttons")[c],f=b.Node.create('<div class="button '+e+'"></div>');f.setAttribute("data-button-name",e);d.append(f);this._buttonEls[e]=f}this.clickEvt=d.on("click",function(b){b.halt();if((b=b.target.ancestor(".button",!0))&&!b.hasClass("loading")){var c=b.getAttribute("data-button-name");this.fire("button-"+c,{buttonNode:b,buttonName:c})}},this);this.el=d;this._alignEl();this.get("host").addClass(this.constructor.CSS_NAMESPACE+"-container");
this.get("host").append(d)},_alignEl:function(){if(this.get("anchor")&&"relative"!=this.get("anchor").getComputedStyle("position")){var b=this.get("anchor").get("region");this.el.setStyles({top:b.top,right:b.right-b.width})}},destructor:function(){this.get("host").removeClass(this.constructor.CSS_NAMESPACE+"-container");this.clickEvt.detach();this.el.remove()},getProperty:function(b){return this.constructor[b]}},{NS:"actionOverlay",CSS_NAMESPACE:"sqs-action-overlay",ATTRS:{buttons:{value:[]},position:{value:"top"},
anchor:{value:null}}})},"1.0",{requires:["base","node","plugin","squarespace-spinner"]});YUI.add("squarespace-charts",function(b){},"1.0",{requires:["squarespace-pie-chart","squarespace-weighted-list","squarespace-bar-table","squarespace-line-graph"]});
YUI.add("squarespace-recycle-bin-item-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["recycle-bin-item.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression,p=d.helperMissing;b='<div class="recycle-bin-item">\n  <h1><span class="icon collection-icon ';(h=d.icon)?h=h.call(c,{hash:{},data:k}):(h=c.icon,h="function"===typeof h?h.apply(c):h);b+=l(h)+'"></span>';(h=d.title)?h=h.call(c,
{hash:{},data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</h1>\n  <span class="meta">Deleted on ';k={hash:{format:"%B %e, %Y"},data:k};return b+=l((h=d["date-format"]||c["date-format"],h?h.call(c,c.updatedOn,k):p.call(c,"date-format",c.updatedOn,k)))+'</span>\n\n  <div class="controls">\n    <span class="button button-restore"><a href="#">Restore</a></span>\n  </div>\n</div>'})})();b.Handlebars.registerPartial("recycle-bin-item.html".replace("/","."),d.templates["recycle-bin-item.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-data-confirmation",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.DataConfirmation=b.Base.create("dataConfirmation",b.Squarespace.Widgets.Confirmation,[b.WidgetParent],{initializer:function(){b.Array.each(this.get("fields"),function(c){b.Object.hasKey(c,"name")?this.add(c):console.warn("[DataConfirmation] Dialog field missing name. Skipping.")},this)},renderUI:function(){d.superclass.renderUI.call(this);this._childrenContainer=this.get("contentBox").one(".fields")},
syncUI:function(){this._updatePosition()},_handleResponse:function(c){this.fire(c,{data:b.Squarespace.FormUtils.getData(this._items)})}},{CSS_PREFIX:"sqs-widgets-confirmation",TEMPLATE:'<div class="title"></div><div class="message"></div><div class="fields"></div><div class="buttons"></div>',TYPE:b.Squarespace.Widgets.Confirmation.TYPE,ANCHOR:b.Squarespace.Widgets.Confirmation.ANCHOR,ATTRS:{fields:{value:[],validator:b.Lang.isArray}}})},"1.0",{requires:["base","squarespace-dialog-field-2","squarespace-form-utils",
"squarespace-widgets-confirmation"]});
YUI.add("squarespace-plugin-slider-value-tooltip",function(b){var d=b.Base.create("tooltipWidget",b.Widget,[b.WidgetPosition,b.WidgetPositionAlign],{initializer:function(b){this.get("slider")&&this._bindSliderEvents()},bindUI:function(){this.after("sliderChange",this._bindSliderEvents,this)},syncUI:function(){var c=this.get("slider"),e=this.get("contentBox");if(c){var d=this.get("templateFn");e.setContent(d(c.getAttrs()));c=c.get("contentBox").one(".yui3-slider-thumb");this.align(c,[b.WidgetPositionAlign.BC,
b.WidgetPositionAlign.TL])}else e.empty()},_bindSliderEvents:function(){var b=this.get("slider");b&&b.after("valueChange",this.syncUI,this)}},{CSS_PREFIX:"sqs-slider-tooltip",ATTRS:{templateFn:{validator:b.Lang.isFunction,value:function(b){return b}},slider:{value:null}}});b.namespace("Squarespace.Plugin").SliderTooltip=b.Base.create("sliderTooltip",b.Plugin.Base,[],{initializer:function(c){if(this.get("host").get("rendered"))this._initTooltip(c);else this.get("host").onceAfter("renderedChange",b.bind(this._initTooltip,
this,c))},hide:function(){this._tooltip&&this._tooltip.hide()},show:function(){this._tooltip&&this._tooltip.show()},_initTooltip:function(b){this._tooltip=new d({slider:this.get("host"),render:!0,visible:!1,templateFn:b.templateFn})},destructor:function(){this._tooltip&&this._tooltip.destroy()}},{NS:"tooltip"})},"1.0",{requires:["base","plugin","widget"]});
YUI.add("squarespace-billing-fields",function(b){var d="January February March April May June July August September October November December".split(" ");b.namespace("Squarespace.DialogFields").BillingStatus=b.Base.create("billingStatus",b.Squarespace.DialogField2,[],{initializer:function(){var c=this.get("data");c&&c.updateBanner&&(c=b.one(".sqs-alert-banner"))&&c.remove(!0)},_getHBTemplateContext:function(){var c=this.get("data");if(b.Lang.isNull(c))return{billingSystemDown:!0};var e=(new Date).getTime(),
d=Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.StatusConstants.PASTDUE;return{plan:c,websiteWillExpire:!c.autorenew||d,pastDue:d,billAmount:Math.abs(c.amountPrice+c.amountDiscount),planDiscountRate:Math.floor(100*((c.amountPrice+c.amountDiscount)/c.amountPrice)),daysRemaining:Math.abs(Math.floor((c.renewalDate-e)/1E3/60/60/24))}}},{CSS_PREFIX:"sqs-billing-status",HANDLEBARS_TEMPLATE:"dialog-billing-status.html",ATTRS:{readOnly:{value:!0}}});b.namespace("Squarespace.DialogFields").InvoiceList=
b.Base.create("invoiceList",b.Squarespace.DialogField2,[],{initializer:function(){this.set("dataState",this.getProperty("DATA_STATES").LOADING);Static.SQUARESPACE_CONTEXT.billingStatus===b.Squarespace.BillingStatus.SUBSCRIBED&&b.Data.get({url:"/api/billing/GetInvoices",success:function(b){this.set("data",b.invoices);this.set("stripe",b.stripe);this.set("dataState",this.getProperty("DATA_STATES").LOADED)}},this)},renderUI:function(){b.Squarespace.DialogFields.InvoiceList.superclass.renderUI.call(this);
this.get("contentBox").append('<div class="settings-help loading">'+this.get("strings.loading")+"</div>")},bindUI:function(){b.Squarespace.DialogFields.InvoiceList.superclass.bindUI.call(this);this.after(this.get("id")+"|dataStateChange",this.syncUI,this)},syncUI:function(){this.get("dataState")===this.getProperty("DATA_STATES").LOADED&&this.get("contentBox").empty().setContent(b.Squarespace.UITemplates.render("invoice-list-table.html",this._getInvoiceTableTemplateContext()))},_getInvoiceTableTemplateContext:function(){var c=
{headings:["Date","Amount"],invoices:[],linkInvoices:this.get("linkInvoices")};b.Array.each(this.get("data"),function(e){var f=new Date(e.postedDate),g=parseFloat(e.amount,10),g=b.Lang.isValue(g)?e.currencySymbol+g.formatMoney()+e.currencySuffix:"";c.invoices.push({formattedDate:d[f.getMonth()]+" "+f.getDate()+", "+f.getFullYear(),amount:g,link:"/config/invoices/"+e.invoiceProvider.toLowerCase()+"/"+e.invoiceId+"?crumb="+b.Cookie.get("crumb")})},this);return c}},{CSS_PREFIX:"sqs-invoice-list",ATTRS:{linkInvoices:{value:!1,
validator:b.Lang.isBoolean}}})},"1.0",{requires:"squarespace-dialog-field-2 squarespace-ui-templates squarespace-invoice-list-table-template squarespace-dialog-billing-status-template squarespace-hb-trim-cents squarespace-hb-pluralize squarespace-hb-date-format squarespace-hb-compare".split(" ")});
YUI.add("squarespace-content-manager-utils",function(b){b.namespace("Squarespace.ContentManager");b.Squarespace.ContentManager.Utils={getEditingWidgetForCollection:function(d,c){var e={},f=d.get("typeName");!f&&d.get("type")===b.Squarespace.CollectionTypes.PAGE&&(d.set("typeName","page"),f="page");var f=c.get("collectionConfigs."+f)||c.get("pageConfigs."+f),g=d.get("type"),h=d.get("ordering");b.Lang.isValue(h)||(h=f.get("ordering"));switch(g){case b.Squarespace.CollectionTypes.GENERIC:if(b.Squarespace.ContentCollectionUtils.isIndex(d)){e.childType=
b.Squarespace.ContentManagerWidgets.TemplatePage;e.strings={title:"Index Page",description:"This page has a fixed design set by your current template.  Use the controls in the upper right to view this page."};break}switch(h){case b.Squarespace.CollectionOrdering.USER:f||(f=new b.Model({acceptTypes:["image"],addText:"Add Image"}));e.childType=b.Squarespace.ContentManagerWidgets.Gallery;break;case b.Squarespace.CollectionOrdering.CHRONOLOGICAL:e.childType=b.Squarespace.ContentManagerWidgets.Blog;break;
case b.Squarespace.CollectionOrdering.CALENDAR:e.childType=b.Squarespace.ContentManagerWidgets.Calendar;break;case b.Squarespace.CollectionOrdering.MUSIC_ALBUM:f||(f=new b.Model({acceptTypes:["audio"],addText:"Add Track"}));e.childType=b.Squarespace.ContentManagerWidgets.MusicAlbum;break;case b.Squarespace.CollectionOrdering.KNOWLEDGE_BASE:e.childType=b.Squarespace.ContentManagerWidgets.Blog;break;default:console.warn("Could not evaluate collection widget type from collection type. (collectionId: "+
d.get("id")+") (ordering: "+h+")")}break;case b.Squarespace.CollectionTypes.PAGE:e.childType=b.Squarespace.ContentManagerWidgets.Page;break;case b.Squarespace.CollectionTypes.PRODUCT:e.childType=b.Squarespace.ContentManagerWidgets.Products;break;case b.Squarespace.CollectionTypes.SPLASH_PAGE:e.childType=b.Squarespace.ContentManagerWidgets.SplashPage;e.strings={title:"Splash Page",description:"In Development"};break;case b.Squarespace.CollectionTypes.TEMPLATE_PAGE:f||(f=new b.Model({title:"Template Page",
description:"This is a template page.",supported:!0}));e.childType=b.Squarespace.ContentManagerWidgets.TemplatePage;e.strings={title:f.get("title")||"Template Page",description:f.get("description")||"This page has a fixed design set by your current template.  Use the controls in the upper right to view this page."};break;default:console.warn("Could not evaluate collection widget type from collection type. (collectionId: "+d.get("id")+") (type: "+d.get("type")+")")}e.collectionConfiguration=f;e.collection=
d;return e}}},"1.0",{requires:"squarespace-content-manager-widgets-blog squarespace-content-manager-widgets-calendar squarespace-content-manager-widgets-gallery squarespace-content-manager-widgets-page squarespace-content-manager-widgets-products squarespace-content-manager-widgets-template-page squarespace-content-manager-widgets-knowledge-base squarespace-content-manager-widgets-splash-page squarespace-content-manager-widgets-music-album".split(" ")});
YUI.add("squarespace-dialog-pricing-placeholder-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-pricing-placeholder.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l;h=this.escapeExpression;b=""+('<div class="field-lhs">\n  '+h((l=(l=c.strings,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'\n</div>\n\n  <div class="placeholder">\n\n    <div class="pricing"></div>\n\n    ');
if((d=d["if"].call(c,c.hasVariants,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){return'\n      <div class="variant-count"></div>\n    '},k),data:k}))||0===d)b+=d;return b+='\n\n    <div class="prompt">\n      '+h((l=(l=c.strings,null==l||!1===l?l:l.prompt),"function"===typeof l?l.apply(c):l))+"&nbsp;&rarr;\n    </div>\n  </div>\n"})})();b.Handlebars.registerPartial("dialog-pricing-placeholder.html".replace("/","."),d.templates["dialog-pricing-placeholder.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-gallery-options",function(b){b.namespace("Squarespace.DialogFields").GalleryOptions=b.Base.create("galleryOptions",b.Squarespace.DialogField2,[],{initializer:function(b){this._originalSettings={};this._widgetsByName={};this.publish("options-changed",{emitFacade:!1})},renderUI:function(){var d=this.get("options"),c=[];b.Object.each(d,function(b,d){this._originalSettings[d]=b;c.push(this._optToWidget(b,d))},this);b.Array.forEach(c,function(b){b.after("dataChange",function(c){this.fire("options-changed",
b,c.attrName)},this);this.add(b)},this);b.Squarespace.DialogFields.GalleryOptions.superclass.renderUI.call(this)},syncUI:function(){this._updateVisibleWidgets()},didDataChange:function(){var d=!1;b.Object.each(this.get("data"),function(c,e){b.Object.hasKey(this._initialData,e)&&(d=this._initialData[e]!==c)});return d},_optToWidget:function(b,c){switch(b.type){case "select":return this._selectWidget(b,c);case "boolean":return this._checkWidget(b,c);case "slider":return this._sliderWidget(b,c)}},add:function(d){this._widgetsByName[d.get("name")]=
d;b.Squarespace.DialogFields.GalleryOptions.superclass.add.call(this,d)},_getOriginalSettings:function(b){return this._originalSettings[b.get("name")]},_updateVisibleWidgets:function(){this.each(function(d){var c=this._getOriginalSettings(d);c.onlyFor?b.Array.some(c.onlyFor,this._validateSettings,this)?d.show():d.hide():d.show()},this)},_validateSettings:function(b){b=this._parseFieldCondition(b);var c=this._widgetsByName[b.name];return c.get("visible")&&String(c.get("data"))===String(b.value)},_parseFieldCondition:function(b){b=
b.split(":");return{name:b[0],value:b[1]}},_resetValuesToDefaults:function(d){var c=this._getOriginalSettings(d);b.Lang.isUndefined(c.defaultValue)||d.set("data",c.defaultValue)},_selectWidget:function(d,c){var e=b.Squarespace.DialogFields.Select.convertToOptionsArray(d.options),f=new b.Squarespace.DialogFields.Select({"strings.title":d.title,"strings.description":d.description,options:e,data:d.defaultValue,className:"thin dark",name:c,visible:"design"!==c,prefix:""});f.unplug(b.Plugin.WidgetAnim);
f.after("dataChange",function(){"design"===f.get("name")&&(this.each(function(b){"design"!==b.get("name")&&this._resetValuesToDefaults(b)},this),this._applyValuesFromSelect(f));this._updateVisibleWidgets()},this);return f},_applyValuesFromSelect:function(d){var c=this._getOriginalSettings(d);c.options&&(d=c.options[d.get("data")],b.Object.each(d.values,function(b,c){this._widgetsByName[c].set("data",b)},this))},_sliderWidget:function(d,c){return new b.Squarespace.DialogFields.Slider({name:c,"strings.description":d.description,
"strings.suffix":d.numericSuffix||"",range:[d.min,d.max],data:d.defaultValue,labelWidth:d.labelWidth,visible:!1})},_checkWidget:function(d,c){var e=new b.Squarespace.DialogFields.Check({name:c,"strings.title":d.title,"strings.description":d.description,data:d.defaultValue,visible:!1});e.after("dataChange",this._updateVisibleWidgets,this);return e}},{CSS_PREFIX:"sqs-gallery-options",ATTRS:{data:{getter:function(){return b.Array.reduce(b.Array.filter(this._items,function(b){return b.get("visible")}),
{},function(b,c){b[c.get("name")]=c.get("data");return b})},setter:function(d){b.Array.each(this._items,function(b){b.set("data",d[b.get("name")])},this)},lazyAdd:!1},options:{},currentDesign:{readOnly:!0,getter:function(){return this._widgetsByName.design.get("data")}}}})},"1.0",{requires:"base base-build squarespace-dialog-field-2 squarespace-dialog-slider squarespace-dialog-check squarespace-dialog-select".split(" ")});
YUI.add("squarespace-dialog-summary-filter",function(b){b.namespace("Squarespace.DialogFields").SummaryFilter=b.Base.create("summaryFilters",b.Squarespace.DialogField2,[],{initializer:function(d){d=d.data||this.get("data")||{};this._tagField=new b.Squarespace.DialogFields.AutoComplete({"strings.title":"Tag Filter","strings.placeholder":"Enter a tag to filter by","strings.description":"Only show items with this tag.",data:d.tag,acConfig:{source:[],resultFilters:"phraseMatch",zIndex:1E6}});this.set("tagField",
this._tagField);this._categoryField=new b.Squarespace.DialogFields.AutoComplete({"strings.title":"Category Filter","strings.placeholder":"Enter a category to filter by","strings.description":"Only show items with this category.",data:d.category,acConfig:{source:[],resultFilters:"phraseMatch",zIndex:1}});this.set("categoryField",this._categoryField);this._featuredField=new b.Squarespace.DialogFields.Check({"strings.title":"Featured Filter","strings.description":"Only show featured posts.",data:d.featured||
!1})},renderUI:function(){b.Squarespace.DialogFields.SummaryFilter.superclass.renderUI.call(this);var d=this.get("contentBox");this._categoryField.render(d);this._tagField.render(d);this._featuredField.render(d)},bindUI:function(){b.Squarespace.DialogFields.SummaryFilter.superclass.bindUI.call(this);this._tagField.after("dataChange",this._updateData,this,"tag");this._categoryField.after("dataChange",this._updateData,this,"category");this._featuredField.after("dataChange",this._updateData,this,"featured");
this.after("dataChange",this._handleRevertRequest,this)},destructor:function(){this._categoryField.destroy();this._tagField.destroy();this._featuredField.destroy()},didDataChange:function(){var b=this._initialData||{},c=this.get("data");return b.tag!==c.tag||b.featured!==c.featured||b.category!==c.category},_updateData:function(d,c){var e=d.newVal,f=this.get("data");b.Lang.isString(e)&&0===e.length&&(e=null);f[c]=e;this.set("data",f)},_handleRevertRequest:function(b){b.revert&&this._revertFields()},
_revertFields:function(){this._tagField.set("data","");this._categoryField.set("data","");this._featuredField.set("data",!1)}},{CSS_PREFIX:"sqs-summary-filter",ATTRS:{tags:{},data:{value:{}},categories:{},tagField:{readOnly:!0},categoryField:{readOnly:!0}}})},"1.0",{requires:"squarespace-dialog-auto-complete squarespace-dialog-field-2 autocomplete-sources autocomplete-filters base base-build".split(" ")});
YUI.add("squarespace-panel-manager",function(b){b.namespace("Squarespace");b.Squarespace.PanelManager=Class.extend(b.Squarespace.Gizmo,{_name:"PanelManager",initialize:function(d){this._super(d);b.Squarespace.ACTIVE_MANAGER=this;this.configurationManager=d.configurationManager;this.activeMenuItem=null;this.panelEvents=[];this.currentPanel=null;this.hasBetaAccess=b.Squarespace.Utils.isSquarespaceAdmin();this.configurationManager.hideSite();this.menuPanel=this.configurationManager.showPanel({style:"settings",
className:"configuration",title:this.getTitle()});this.menuContainerEl=this.menuPanel.getContentEl();this._subscribe([[b,"history:change",this.onStateChange],[b,"click",this.onMenuClick,this.menuContainerEl,this]]);this.renderEl=d.renderEl;this.renderEl.set("innerHTML","");this.el=b.DB.DIV("settings clear");this.renderEl.append(this.el);this.renderMenu();d=this.getHistory().get(this.getName()+"-subpanelName");var c=!1,e=this.getAvailableMenuItems();if(d)for(var f=0;f<this.getMenuItems().length;++f)if(e[d]){c=
!0;break}c||(d=e["default"]);this.viewMenuItem(d);this.ready&&this.ready()},isItemShowable:function(d){return d.hidden||d.requiredPermission&&!b.Squarespace.Utils.userHasAccessPermission(d.requiredPermission)||d.hideWhenWebsiteStatusIs&&!(0>d.hideWhenWebsiteStatusIs.indexOf(Static.SQUARESPACE_CONTEXT.website.siteStatus.value))||this._disableByPlan(Static.SQUARESPACE_CONTEXT.plan,d)?!1:!0},_disableByPlan:function(b,c){return-1!==(c.prohibitedForPlans||[]).indexOf(b)},getAvailableMenuItems:function(){for(var d=
this.getMenuItems(),c=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","siteStatus","value"]),e={},f=0,g=d.length;f<g;f++){var h=d[f];this.isItemShowable(h)&&(e[h.name]=!0,e["default"]||(e["default"]=h.name),b.Squarespace.StatusConstants.EXPIRED===c&&(h&&"billing-settings"===h.name)&&(e["default"]=h.name))}return e},getManager:function(){return this.params.configurationManager},getHistory:function(){return this.configurationManager.getHistory()},clearPanel:function(){this.el.set("innerHTML",
"");this.panelEvents.forEach(function(b){b.detach()});this.panelEvents=[]},onMenuClick:function(d){var c=d.target.data();if(c&&c.config&&c.config.name!=this.lastPanel){var e=b.bind(function(b){if(b.config.linkTo)window.open(b.config.linkTo);else{var c={};c[this.getName()+"-subpanelName"]=""+b.config.name;this.getHistory().replace(c)}},this);this.currentManager&&b.Lang.isFunction(this.currentManager.hasUnsavedChanges)&&this.currentManager.hasUnsavedChanges()?this.currentManager.ensureSavedChanges().then(function(){e(c)}):
e(c)}},hasUnsavedChanges:function(){return this.currentManager&&"function"===typeof this.currentManager.hasUnsavedChanges?this.currentManager.hasUnsavedChanges():!1},ensureSavedChanges:function(d,c){return new b.Promise(b.bind(function(b,c){this.currentManager?this.currentManager.ensureSavedChanges().then(b):b()},this))},permissionDenied:function(){console.log("permission denied")},onStateChange:function(b){(b=b.changed[this.getName()+"-subpanelName"])&&this.viewMenuItem(b.newVal)},_postViewMenuItem:function(d){var c=
this.menuContainerEl.one("#menu-"+d);c.addClass("active");this.activeMenuItem=c;c=c.data().config;this.clearPanel();this.currentPanel=c;if(this.isItemShowable(c)){this.configurationManager.updateBodyClass();if(c&&c.get)c.get.apply(this);else if(c.ctor)this.currentManager=new c.ctor(b.merge({render:this.renderEl},c.config||{}));else if(c.manager)this.currentManager=new c.manager(this);else throw"Panel is missing a manager or contructor (ctor).";b.Squarespace.Analytics.trackInternal("engagement_configuration_navigate",
{section:this.getName(),item:d})}else this.currentManager=new b.Squarespace.Widgets.AccessDenied({manager:this})},viewMenuItem:function(d){if(this.menuContainerEl.one("#menu-"+d))if(this.lastPanel=d,this.activeMenuItem)if(this.activeMenuItem.removeClass("active"),this.currentManager)if("TemplateSettingsManager"===this.currentManager.name||"CommentModeration"===this.currentManager.name)this.currentManager.destroy(),this._postViewMenuItem(d);else{if(this.currentManager instanceof b.Squarespace.Widgets.SettingsPanel)this.currentManager.after("destroyedChange",
function(b){this.currentManager=null;this._postViewMenuItem(d)},this);else if(this.currentManager instanceof b.Widget)this.currentManager.on("destroy",function(){this.currentManager=null;this._postViewMenuItem(d)},this);else this.currentManager.on("destroyed",function(b){this.currentManager=null;this._postViewMenuItem(d)},this);this.currentManager.destroy()}else this._postViewMenuItem(d);else this._postViewMenuItem(d)},renderMenu:function(){var d=this.getMenuItems();this.menuContainerEl.set("innerHTML",
"");this.menuContainerEl.append(b.DB.DIV("navigation-title",{html:this.getTitle()}));this.menuContainerEl.append(b.DB.DIV("navigation-description",{html:this.getDescription()}));for(var c=0;c<d.length;++c){var e=d[c],f;"divider"==e.type?(f=b.DB.DIV("divider"),this.menuContainerEl.append(f)):"link"==e.type?(f=b.Node.create('<div class="panel-menu-item '+e.name+'"><div class="contents"><div class="type-icon"></div><a href="'+e.href+'" target="_blank">'+e.title+"</a></div></div>"),this.menuContainerEl.append(f)):
(f=b.DB.DIV("panel-menu-item "+e.name,{id:"menu-"+e.name,data:{config:e,manager:this}},b.DB.DIV("contents",b.DB.DIV("type-icon"),b.DB.DIV("title",{html:e.title}))),this.isItemShowable(e)||f.addClass("hide"),this.menuContainerEl.append(f),e.menuEl=f)}this.panelFooter=new b.Squarespace.ConfigurationPanelFooter({scrollingNode:b.one(".config-panel-wrapper .config-panel.depth-1"),render:b.one("body")})},refreshPanel:function(){this.viewMenuItem(this.lastPanel)},renderPanelTitle:function(d){return b.DB.DIV("title-container",
{id:"title-container"},b.DB.DIV("title",{html:d}))},renderLoadingNotice:function(){return b.DB.DIV("loading-notice",b.DB.DIV("placeholder load-pending"),b.DB.DIV("main",{html:"Loading "+this.getTitle()+" Data"}))},fadeOutPanel:function(){this._anim({node:this.el,to:{opacity:0.5},duration:0.3,easing:b.Easing.easeOutStrong}).run()},fadeInPanel:function(){this._anim({node:this.el,to:{opacity:1},duration:0.3,easing:b.Easing.easeInStrong}).run()},_destroy:function(){this.clearPanel();this.configurationManager.popPanel();
this.panelFooter.destroy();this.currentManager&&this.currentManager.destroy();this.currentManager=null;this.searchButton&&this.searchButton.destroy()}});b.namespace("Squarespace.Widgets").AccessDenied=b.Base.create("accessDenied",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(b){this.set("strings.title","Access Denied");this.set("description","Your account does not have access to this area.")}},{CSS_PREFIX:"sqs-access-denied",ATTRS:{buttons:{value:[]}}})},"1.0",{requires:"node oop anim json datatype-number squarespace-dombuilder squarespace-graphing squarespace-settings-panel squarespace-configuration-panel-footer".split(" ")});
YUI.add("squarespace-newsletters-tutorial-panel",function(b){b.namespace("Squarespace.Settings.Newsletters");b.namespace("Squarespace.Widgets").NewslettersTutorialPanel=b.Base.create("NewslettersTutorialPanel",b.Squarespace.Widgets.SettingsPanel,[],{_dismissTutorial:function(){(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Dismiss this Guide","strings.title":"Dismiss this guide?","strings.message":'This will remove "Getting Started with Newsletters" from your Newsletters area in the future.'})).on("confirm",
function(){b.Data.post({url:"/api/config/MarkWebsiteTutorialCompleted",data:{tutorial:"newsletters-tutorial-checklist"}},this);Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["newsletters-tutorial-checklist"]=!0;new b.Squarespace.Widgets.Information({"strings.title":"Dismissed","strings.message":"This guide will no longer appear in your Newsletters panel."})},this)}},{CSS_PREFIX:"sqs-settings-newsletters-tutorial",ATTRS:{initialDataUrl:{value:"/api/newsletters/admin/GetNewslettersLaunchProgress"},
saveUrl:{},"strings.title":{value:"Getting Started"},"strings.description":{value:"Squarespace Newsletters lets you send newsletters."},buttons:{valueFn:function(){return[{type:"dismiss",label:"Dismiss",action:b.bind(function(){this._dismissTutorial()},this)}]}},fields:{value:[]}}})},"1.0",{requires:["base","squarespace-dialog-checklist","squarespace-settings-panel","squarespace-widgets-confirmation","squarespace-widgets-information"]});
YUI.add("squarespace-dialog-facebook-meta-data",function(b){b.namespace("Squarespace.DialogFields").FacebookMetaData=b.Base.create("fbMetaData",b.Squarespace.DialogField2,[],{initializer:function(d){var c=[{label:"This Account",value:""}],c=c.concat(this.get("pages"));this._pageSelect=new b.Squarespace.DialogFields.Select({"strings.title":"Push Target","strings.placeholder":"This Account","strings.description":"Select the page to which posts will be pushed. If no page is selected, posts will be pushed to this account's timeline.",
name:"pages",options:c,data:d.data.isPageAccount?"":d.data.selectedPageId,className:"thin dark"});this.add(this._pageSelect);this._impersonateCheckbox=new b.Squarespace.DialogFields.Check({"strings.title":"Impersonate Page","strings.description":"Post to this page's timeline as the page itself.",data:d.data.impersonatePage});this.add(this._impersonateCheckbox)},bindUI:function(){this.on("dataChange",this.syncUI,this);var b=this.get("id");this._pageSelect.after(b+"|dataChange",function(b){var e=this.get("data");
b.newVal?(this._impersonateCheckbox.set("data",!0),e.selectedPageId=b.newVal):delete e.selectedPageId;this.set("data",e)},this);this._impersonateCheckbox.after(b+"|dataChange",function(b){var e=this.get("data");e.impersonatePage=b.newVal;this.set("data",e)},this)},syncUI:function(){var b=this.get("data");b.isPageAccount||!b.selectedPageId?this._impersonateCheckbox.hide():this._impersonateCheckbox.show()},didDataChange:function(){var b=this._initialData,c=this.get("data");return b.impersonatePage!==
c.impersonatePage||b.selectedPageId!==c.selectedPageId}},{CSS_PREFIX:"sqs-facebook-metadata",ATTRS:{data:{value:{},setter:function(d){b.Array.each(d.managedPages,function(b){b.selected=d.selectedPageId&&b.id===d.selectedPageId?!0:!1})}},pages:{}}})},"1.0",{requires:["base","squarespace-dialog-field-2","squarespace-dialog-check","squarespace-dialog-select"]});
YUI.add("autocomplete-sources",function(b,d){var c=b.AutoCompleteBase,e=b.Lang,f="_sourceSuccess",g="maxResults";b.mix(c.prototype,{_YQL_SOURCE_REGEX:/^(?:select|set|use)\s+/i,_beforeCreateObjectSource:function(c){return c instanceof b.Node&&"select"===c.get("nodeName").toLowerCase()?this._createSelectSource(c):b.JSONPRequest&&c instanceof b.JSONPRequest?this._createJSONPSource(c):this._createObjectSource(c)},_createIOSource:function(c){function e(d){var k=d.request;if(g._cache&&k in g._cache)g[f](g._cache[k],
d);else q&&q.isInProgress()&&q.abort(),q=b.io(g._getXHRUrl(c,d),{on:{success:function(c,e){var h;try{h=b.JSON.parse(e.responseText)}catch(l){b.error("JSON parse error",l)}h&&(g._cache&&(g._cache[k]=h),g[f](h,d))}}})}var d={type:"io"},g=this,q,r,s;d.sendRequest=function(c){r=c;s||(s=!0,b.use("io-base","json-parse",function(){d.sendRequest=e;e(r)}))};return d},_createJSONPSource:function(c){function e(b){var d=b.request,k=b.query;if(g._cache&&d in g._cache)g[f](g._cache[d],b);else c._config.on.success=
function(c){g._cache&&(g._cache[d]=c);g[f](c,b)},c.send(k)}var d={type:"jsonp"},g=this,q,r;d.sendRequest=function(f){q=f;r||(r=!0,b.use("jsonp",function(){c instanceof b.JSONPRequest||(c=new b.JSONPRequest(c,{format:b.bind(g._jsonpFormatter,g)}));d.sendRequest=e;e(q)}))};return d},_createSelectSource:function(b){var c=this;return{type:"select",sendRequest:function(e){var d=[];b.get("options").each(function(b){d.push({html:b.get("innerHTML"),index:b.get("index"),node:b,selected:b.get("selected"),text:b.get("text"),
value:b.get("value")})});c[f](d,e)}}},_createStringSource:function(b){return this._YQL_SOURCE_REGEX.test(b)?this._createYQLSource(b):-1!==b.indexOf("{callback}")?this._createJSONPSource(b):this._createIOSource(b)},_createYQLSource:function(c){function d(k){var p=k.query,q=l.get("yqlEnv"),r=l.get(g),y;y=e.sub(c,{maxResults:0<r?r:1E3,request:k.request,query:p});if(l._cache&&y in l._cache)l[f](l._cache[y],k);else p=function(b){l._cache&&(l._cache[y]=b);l[f](b,k)},r={proto:l.get("yqlProtocol")},s?(s._callback=
p,s._opts=r,s._params.q=y,q&&(s._params.env=q)):s=new b.YQLRequest(y,{on:{success:p},allowCache:!1},q?{env:q}:null,r),s.send()}var l=this,p={type:"yql"},q,r,s;l.get("resultListLocator")||l.set("resultListLocator",l._defaultYQLLocator);p.sendRequest=function(c){q=c;r||(r=!0,b.use("yql",function(){p.sendRequest=d;d(q)}))};return p},_defaultYQLLocator:function(c){(c=c&&c.query&&c.query.results)&&e.isObject(c)?(c=b.Object.values(c)||[],c=1===c.length?c[0]:c,e.isArray(c)||(c=[c])):c=[];return c},_getXHRUrl:function(b,
c){var d=this.get(g);c.query!==c.request&&(b+=c.request);return e.sub(b,{maxResults:0<d?d:1E3,query:encodeURIComponent(c.query)})},_jsonpFormatter:function(b,c,d){var f=this.get(g),q=this.get("requestTemplate");q&&(b+=q(d));return e.sub(b,{callback:c,maxResults:0<f?f:1E3,query:encodeURIComponent(d)})}});b.mix(c.ATTRS,{yqlEnv:{value:null},yqlProtocol:{value:"http"}});b.mix(c.SOURCE_TYPES,{io:"_createIOSource",jsonp:"_createJSONPSource",object:"_beforeCreateObjectSource",select:"_createSelectSource",
string:"_createStringSource",yql:"_createYQLSource"},!0)},"3.17.2",{optional:["io-base","json-parse","jsonp","yql"],requires:["autocomplete-base"]});
YUI.add("squarespace-job-manager",function(b){b.namespace("Squarespace");b.Squarespace.JobManager=Class.create({jobCheckTimeout:2E3,initialize:function(){this.recentJobs={};this.currentJobs={};this.completedJobs={};this.failedJobs={};this.startedIds=[];this.completedIds=[];this.failedIds=[];this.publish("opened");this.publish("started");this.publish("started-jobs");this.publish("completed");this.publish("completed-jobs");this.publish("failed");this.publish("failed-jobs");this.jobCheckerTimer=new b.Squarespace.Timers.LinearIncreaseInterval({fn:b.bind(this._checkJobs,
this),untilFn:b.bind(this.isEmpty,this),initialDelay:2E3,delayIncrement:400,maxDelay:12E4,maxIterations:1E3})},isEmpty:function(){return 0===this.getSize()},getSize:function(){return b.Object.keys(this.currentJobs).length},completedJobsCount:function(){return b.Object.keys(this.completedJobs).length},failedJobsCount:function(){return b.Object.keys(this.failedJobs).length},runChecks:function(){this.jobCheckerTimer.reset();this.jobCheckerTimer.run()},_checkJobs:function(){var d=b.Object.keys(this.currentJobs);
0!==d.length&&(d="/api/rest/jobs/?id="+d.join(","),b.Data.get({url:d,success:function(b){for(var e=0;e<b.length;++e){var d=b[e],g=this.findInQueue(d.id);g&&(g.update(d),g.get("childJobs").length&&this._getChildJobs(g))}0<this.startedIds.length&&(this.fire("started-jobs",this.resolveIds(this.startedIds)),this.startedIds=[]);0<this.completedIds.length&&(this.fire("completed-jobs",this.resolveIds(this.completedIds)),this.completedIds=[]);0<this.failedIds.length&&(this.fire("failed-jobs",this.resolveIds(this.failedIds)),
this.failedIds=[])},failure:noop},this))},_getChildJobs:function(d){d="/api/rest/jobs/"+d.get("id")+"/children";b.Data.get({url:d,success:function(b){this.loadExistingJobs(b.jobs)},failure:noop},this)},onJobStart:function(b){b=b.target;var c=b.get("id");this.startedIds.push(c);this.fire("started",b)},onJobSuccess:function(b){this._processSucessfulJob(b.target)},_processSucessfulJob:function(b){var c=b.get("id");this.completedJobs[c]=b;this.completedIds.push(c);this.removeFromQueue(c);this.fire("completed",
b)},onJobFailure:function(b){b=b.target;var c=b.get("id");this.failedJobs[c]=b;this.failedIds.push(c);this.removeFromQueue(c);this.fire("failed",b)},onJobOpen:function(b){b=b.target;var c=b.get("id");this.currentJobs[c]=b;this.fire("opened",b)},removeFromQueue:function(d){b.Object.hasKey(this.currentJobs,d)&&delete this.currentJobs[d]},findJob:function(b){for(var c=[this.findInQueue,this.findCompletedJob,this.findFailedJob],e=0;e<c.length;++e){var f=c[e].call(this,b);if(f)return f}return null},findInQueue:function(b){return this.currentJobs[b]},
findCompletedJob:function(b){return this.completedJobs[b]},findFailedJob:function(b){return this.failedJobs[b]},resolveIds:function(b){for(var c=[],e=0;e<b.length;++e){var f=this.findJob(b[e]);f&&c.push(f)}return c},addJob:function(b){this._subscribeToJob(b);this.currentJobs[b.get("id")]=b;this.runChecks()},_subscribeToJob:function(b){b.after("start",this.onJobStart,this,b);b.after("complete",this.onJobSuccess,this,b);b.after("failure",this.onJobFailure,this,b);b.after("open",this.onJobOpen,this,
b)},totalJobs:function(){return[this.completedJobs,this.failedJobs,this.currentJobs].map(function(d){return b.Object.keys(d).length}).reduce(function(b,c){return b+c})},allJobs:function(){return b.Object.values(b.merge(this.completedJobs,this.failedJobs,this.currentJobs,this.recentJobs))},removeJobById:function(b){delete this.completedJobs[b];delete this.failedJobs[b];delete this.currentJobs[b];delete this.recentJobs[b]},loadExistingJobs:function(d){d.forEach(function(c){c=this._jobDataToJob(c);this.currentJobs[c.get("id")]=
c;this._subscribeToJob(c);c.get("status")==b.Squarespace.JobStatuses.SUCCESS&&this._processSucessfulJob(c)},this);this.runChecks()},loadRecentJobs:function(b){b.forEach(function(b){b=this._jobDataToJob(b);this.recentJobs[b.get("id")]=b},this)},_jobDataToJob:function(d){return new b.Squarespace.Job(b.merge(d,{messages:d.messages?d.messages.map(function(c){return new b.Squarespace.JobMessage(c)}):[]}))},getExistingJobs:function(){var d="/api/rest/jobs/?status="+[b.Squarespace.JobStatuses.WAITING,b.Squarespace.JobStatuses.PROCESSING].join();
b.Data.get({url:d,success:this.loadExistingJobs},this)}});b.augment(b.Squarespace.JobManager,b.EventTarget);Static.JOB_MANAGER||(Static.JOB_MANAGER=new b.Squarespace.JobManager)},"1.0",{requires:["event","json","squarespace-jobs","squarespace-timers","squarespace-util"]});
YUI.add("widget-modality",function(b,d){function c(b){}var e=b.Lang.isBoolean,f=b.ClassNameManager.getClassName,g=function(){var c=b.config.doc,e=null,d;if(c.createElement&&(d=c.createElement("div"))&&d.style)if(d.style.position="fixed",d.style.top="10px",(c=c.body)&&c.appendChild&&c.removeChild)c.appendChild(d),e=10===d.offsetTop,c.removeChild(d);return e}(),h={modal:f("widget","modal"),mask:f("widget","mask")};c.ATTRS={maskNode:{getter:"_getMaskNode",readOnly:!0},modal:{value:!1,validator:e},focusOn:{valueFn:function(){return[{eventName:"clickoutside"},
{eventName:"focusoutside"}]},validator:b.Lang.isArray}};c.CLASSES=h;c._MASK=null;c._GET_MASK=function(){var e=c._MASK,d=b.one("win");if(e&&null!==e.getDOMNode()&&e.inDoc())return e;e=b.Node.create("<div></div>").addClass(h.mask);c._MASK=e;g?e.setStyles({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",display:"block"}):e.setStyles({position:"absolute",width:d.get("winWidth")+"px",height:d.get("winHeight")+"px",top:"0",left:"0",display:"block"});return e};c.STACK=[];c.prototype={initializer:function(){b.after(this._renderUIModal,
this,"renderUI");b.after(this._syncUIModal,this,"syncUI");b.after(this._bindUIModal,this,"bindUI")},destructor:function(){this._uiSetHostVisibleModal(!1)},_uiHandlesModal:null,_renderUIModal:function(){var b=this.get("boundingBox");this._repositionMask(this);b.addClass(h.modal)},_bindUIModal:function(){this.after("visibleChange",this._afterHostVisibleChangeModal);this.after("zIndexChange",this._afterHostZIndexChangeModal);this.after("focusOnChange",this._afterFocusOnChange);if(!g||b.UA.ios&&5>b.UA.ios||
b.UA.android&&3>b.UA.android)b.one("win").on("scroll",this._resyncMask,this)},_syncUIModal:function(){this._uiSetHostVisibleModal(this.get("visible"))},_focus:function(){var b=this.get("boundingBox"),c=b.get("tabIndex");b.set("tabIndex",0<=c?c:0);this.focus()},_blur:function(){this.blur()},_getMaskNode:function(){return c._GET_MASK()},_uiSetHostVisibleModal:function(e){var d=c.STACK,f=this.get("maskNode"),g=this.get("modal");e?(b.Array.each(d,function(b){b._detachUIHandlesModal();b._blur()}),d.unshift(this),
this._repositionMask(this),this._uiSetHostZIndexModal(this.get("zIndex")),g&&(f.show(),b.later(1,this,"_attachUIHandlesModal"),this._focus())):(e=b.Array.indexOf(d,this),0<=e&&d.splice(e,1),this._detachUIHandlesModal(),this._blur(),d.length?(d=d[0],this._repositionMask(d),d._uiSetHostZIndexModal(d.get("zIndex")),d.get("modal")&&(b.later(1,d,"_attachUIHandlesModal"),d._focus())):"block"===f.getStyle("display")&&f.hide())},_uiSetHostZIndexModal:function(b){this.get("modal")&&this.get("maskNode").setStyle("zIndex",
b||0)},_attachUIHandlesModal:function(){var e,d,f;if(!(this._uiHandlesModal||c.STACK[0]!==this)){var h=this.get("boundingBox"),r=this.get("maskNode"),s=this.get("focusOn"),t=b.bind(this._focus,this),u=[],v,w;v=0;for(w=s.length;v<w;v++)f=d=e=void 0,e=s[v].node,d=s[v].eventName,f=s[v].keyCode,!e&&!f&&d?u.push(h.on(d,t)):e&&!f&&d?u.push(e.on(d,t)):e&&f&&d?u.push(e.on(d,t,f)):b.Log('focusOn ATTR Error: The event with name "'+d+'" could not be attached.');g||u.push(b.one("win").on("scroll",b.bind(function(){r.setStyle("top",
r.get("docScrollY"))},this)));this._uiHandlesModal=u}},_detachUIHandlesModal:function(){b.each(this._uiHandlesModal,function(b){b.detach()});this._uiHandlesModal=null},_afterHostVisibleChangeModal:function(b){this._uiSetHostVisibleModal(b.newVal)},_afterHostZIndexChangeModal:function(b){this._uiSetHostZIndexModal(b.newVal)},isNested:function(){return 1<c.STACK.length?!0:!1},_repositionMask:function(c){var e=this.get("modal"),d=c.get("modal"),f=this.get("maskNode");if(e&&!d)f.remove(),this.fire("maskHide");
else if(!e&&d||e&&d)f.remove(),this.fire("maskHide"),c=c.get("boundingBox"),c=c.get("parentNode")||b.one("body"),c.insert(f,c.get("firstChild")),this.fire("maskShow")},_resyncMask:function(b){var c=b.currentTarget;b=c.get("docScrollX");var e=c.get("docScrollY"),d=c.get("innerWidth")||c.get("winWidth"),c=c.get("innerHeight")||c.get("winHeight");this.get("maskNode").setStyles({top:e+"px",left:b+"px",width:d+"px",height:c+"px"})},_afterFocusOnChange:function(){this._detachUIHandlesModal();this.get("visible")&&
this._attachUIHandlesModal()}};b.WidgetModality=c},"3.17.2",{requires:["base-build","event-outside","widget"],skinnable:!0});
YUI.add("squarespace-widgets-notifications",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.Notifications=b.Base.create("notifications",b.Squarespace.Widgets.SSWidget,[],{initializer:function(c){this._posHelper=new b.Squarespace.Widgets.PositionHelper(this.get("position"),15)},renderUI:function(){this.get("contentBox").setContent(d.TEMPLATE);this._zIndex=b.Squarespace.DIALOG_ZINDEX_BASE;this.get("boundingBox").setStyle("zIndex",this._zIndex);this._alignToNavButton()},bindUI:function(){b.Squarespace.NotificationsService.after("notificationsChange",
this.syncUI,this);this.after("visibleChange",this._onVisibleChange,this);var c=this.get("contentBox");c.delegate("click",this._onNotificationClearClick,".item-clear-button",this);c.delegate("click",this._onClearClick,".clear-all",this);c.delegate("click",this._onNotificationItemClick,".notification-item",this)},syncUI:function(){d.superclass.syncUI.apply(this,arguments);var c=this.get("contentBox");c.one(".notifications-list").empty();c.removeClass("hidden");this._renderItems();c.toggleClass("active",
this.get("visible"));this.get("overlay")&&!b.Lang.isValue(this._overlayEl)&&this._renderOverlay();c.all(".notification-item").isEmpty()&&b.Squarespace.NotificationsService.get("loaded")&&this.hide()},_onVisibleChange:function(c){c=c.newVal;this.get("buttonNode").toggleClass("active",c);c?(this.get("contentBox").one(".notifications-list").plug(b.Squarespace.ScrollLock),this._alignToNavButton(),this.syncUI()):(b.Lang.isValue(this._overlayEl)&&this._overlayEl.removeClass("active"),this.get("contentBox").removeClass("active"),
b.later(250,this,this._finishClose))},_onNotificationClearClick:function(c){c.halt();c=c.target.ancestor(".notification-item").getAttribute("data-id");b.Squarespace.NotificationsService.markAsRead(c);b.Squarespace.Analytics.trackInternal("engagement_notifications_item_clear")},_onClearClick:function(){this.get("contentBox").all(".notification-item").each(function(c){c=c.getAttribute("data-id");b.Squarespace.NotificationsService.markAsRead(c)},this);b.Squarespace.Analytics.trackInternal("engagement_notifications_clear_all")},
_onNotificationItemClick:function(c){c.halt();var e=c.target.ancestor(".notification-item",!0);c=e.getAttribute("data-id");e="//blog.squarespace.com"+e.getAttribute("data-url");b.Squarespace.NotificationsService.markAsRead(c);b.Squarespace.Analytics.trackInternal("engagement_notifications_item_open");window.open(e,"_blank")},_renderOverlay:function(){this._overlayEl=b.Node.create("<div>");this._overlayEl.addClass("sqs-notifications-widget dialog-screen-overlay");this._overlayEl.plug(b.Squarespace.ScrollLock);
b.one(document.body).append(this._overlayEl);this._overlayEl.addClass("active");this._overlayEl.on("click",this.onOverlayClick,this)},onOverlayClick:function(b){b.halt();this.hide();this.get("buttonNode").removeClass("active")},toggleVisibility:function(){this.set("visible",!this.get("visible"))},_finishClose:function(){this.fire("close");this.get("overlay")&&b.Lang.isValue(this._overlayEl)&&(this._overlayEl.unplug(b.Squarespace.ScrollLock),this._overlayEl.remove(),this._overlayEl=null);this.get("contentBox").addClass("hidden");
this.get("contentBox").one(".notifications-list").unplug(b.Squarespace.ScrollLock)},_renderItems:function(){this.get("contentBox").one(".notifications-list").append(b.Squarespace.UITemplates.render(d.TEMPLATE_NOTIFICATION_NAME,this._getNotificationDataModel()))},_alignToNavButton:function(){var b=this.get("boundingBox"),e=this.get("buttonNode"),e=e.ancestor(".nav-chunk.folder")||e,d=this._posHelper.fetch(b,e);b.one(".notifications-wrapper").toggleClass("notch-enabled",!this._isTooLongForWindow(b,
e));this._isTooLongForWindow(b,e)||(d.top=e.get("offsetTop"));b.setStyles(d)},_isTooLongForWindow:function(c,e){var d;try{d=b.Squarespace.Damask.ContextGlobals.relative(node,"Y")}catch(g){d=b}d=d.DOM.winHeight();return e.get("offsetTop")+c.get("offsetHeight")>=d},_getNotificationDataModel:function(){var c={items:[]};b.Array.each(b.Squarespace.NotificationsService.get("notifications"),function(e){var d={id:e.id,title:e.title,body:e.excerpt,fullUrl:e.fullUrl};b.Lang.isValue(e.categories)?d.category=
e.categories[0]:d.category="Notification";c.items.push(d)},this);return c}},{CSS_PREFIX:"sqs-notifications-widget",TEMPLATE_NOTIFICATION_NAME:"notification-item.html",TEMPLATE:'<div class="notifications-wrapper"><div class="notifications-control-bar">Squarespace Updates<span class="clear-all">Clear All</span></div><div class="notifications-list"></div></div>',ATTRS:{overlay:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},buttonNode:{validator:b.Squarespace.AttrValidators.isNode},overlayOpacity:{value:0.5,
validator:b.Squarespace.AttrValidators.isNumber},position:{value:b.Squarespace.Widgets.PositionHelper.ANCHOR.ELEMENT,writeOnce:!0,validator:b.Lang.isFunction}}})},"1.0",{requires:"anim base event-valuechange squarespace-attr-validators squarespace-autocomplete-types squarespace-damask-context-globals squarespace-dialog-field-2 squarespace-dialog-label squarespace-dialog-text-template squarespace-mailcheck squarespace-notifications-service squarespace-notification-item-template squarespace-widgets-position-helper".split(" ")});
YUI.add("squarespace-xero-configuration-mixin",function(b){b.namespace("Squarespace.Mixins").XeroConfigurationDialogs=b.Base.create("xeroConfigurationDialogs",b.Base,[],{initializer:function(){this.publish("load-requested")},_showSetupTaxesDialog:function(d,c){var e=[{type:"cancel",title:"Close"},{type:"createAll",title:"Create Missing Tax Rates"},{type:"refresh",title:"Refresh Tax Rates"},{type:"verify",title:"Finish",className:"save",disabled:!0}],f=[{type:"cancel",title:"Close"},{type:"refresh",
title:"Refresh Tax Rates"},{type:"verify",title:"Finish",className:"save",disabled:!0}],g=[{type:"cancel",title:"Close"},{type:"refresh",title:"Refresh Tax Rates"},{type:"verify",title:"Finish",className:"save"}],h=new b.Squarespace.EditingDialog({width:600,height:550,overlay:0.5,closeOthers:!1,style:"minimal",primaryTabs:[{fields:[{ctor:b.Squarespace.DialogFields.HTML,content:d},{ctor:b.Squarespace.DialogFields.XeroTaxSetup,name:"taxSetup"}],title:c}],buttons:[{type:"cancel",title:"Close"},{type:"refresh",
title:"Refresh Tax Rates"},{type:"verify",title:"Finish",className:"save",disabled:!0}]});h.on("button-verify",function(){h.getField("taxSetup").verify({onEqual:function(){b.later(500,h,h.close)},onDifferent:function(){new b.Squarespace.Widgets.Alert({"strings.title":"Taxes Out Of Sync","strings.message":"Your Tax Rates in Xero are out of sync with Squarespace Commerce."})}})});h.on("button-createAll",function(){var c=h.getField("taxSetup"),e=c.get("numMissing");(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Create",
"strings.title":"Create Tax Rates?","strings.message":e+" new Tax Rate"+(1===e?"":"s")+" will be created in Xero."})).on("confirm",function(){c.createAll()},this)});h.on("button-refresh",function(){h.getField("taxSetup").verify()});h.on("shown",function(){var c=h.getField("taxSetup");c.after("syncStatusChange",function(d){d=c.get("syncStatus");this._connectedAccount.get("metaData");d===b.Squarespace.XeroTaxSyncStatuses.MISSING_RATES||d===b.Squarespace.XeroTaxSyncStatuses.MISSING_AND_OUT_OF_SYNC?h.setButtons(e):
d===b.Squarespace.XeroTaxSyncStatuses.OUT_OF_SYNC?h.setButtons(f):h.setButtons(g)},this);b.later(200,c,c.loadDiff)},this);h.on("close",this._connectedAccount.load,this._connectedAccount);h.show()},_showChartOfAccountsDialog:function(d,c,e){var f=this._connectedAccount.get("metaData"),g=b.Lang.isObject(f),h=new b.Squarespace.Models.XeroAccountList,k=[{type:"cancel",title:"Cancel"},{type:"refreshAccounts",title:"Refresh Accounts"},{type:"save",title:d?"Finish":"Save",disabled:!0}],l=[{type:"cancel",
title:"Cancel"},{type:"refreshAccounts",title:"Refresh Accounts"},{type:"save",title:d?"Finish":"Save"}],p=[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"accountCreateCopy",content:'<div class="sqs-xero-setup-copy"><h2>Step 1: Add Accounts to Xero</h2>Every day, Squarespace will export a Daily Sales Summary with a detailed breakdown of the previous day\'s sales. Each component of every sale (i.e. subtotal, discounts, shipping, sales tax) will be mapped to its related account in Xero so that you can easily keep track of your revenue, expenses, and tax liabilities. To get started, you need to add the following accounts to your Chart of Accounts in Xero:</div>'}},
{ctor:b.Squarespace.DialogFields.XeroDefaultAccountCreator,config:{name:"defaultAccountCreator",xeroAccounts:h}}];c=[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"accountSelectCopy",content:c}},{ctor:b.Squarespace.DialogFields.XeroAccountsConfig,config:{name:"accountConfig",required:!0,xeroAccounts:h,data:g?f.accountConfig:{}}}];p={fields:d?p.concat(c):c,scroll:d};e={width:580,height:d?1050:425,overlay:0.5,closeOthers:!1,style:"minimal",primaryTabs:[p],title:e,buttons:d?k:l};d&&(e.verticalHeight=
"fit");var q=new b.Squarespace.EditingDialog(e),r=!1;q.on("button-refreshAccounts",function(){r=!0;q.getField("accountConfig").refresh()});q.on("send-requested",function(){var c=q.getField("accountConfig"),e=this._connectedAccount.get("metaData");e.accountConfig=c.get("data");e.chartOfAccountsComplete=!0;this._connectedAccount.set("metaData",e);this._connectedAccount.save(b.bind(q.close,q))},this);q.on("shown",function(){var c=q.getField("accountConfig");c.set("data",f.accountConfig);var e=q.getField("accountSelectCopy");
q.getField("accountModifyCopy");if(d){var g=q.getField("defaultAccountCreator");g.on("allAccountsPresent",function(){c.set("enabled",!0);e.get("contentBox").one(".sqs-xero-setup-copy").removeClass("setup-copy-disabled");q.setButtons(l);r||(b.later(500,this,function(){var c=q.bodyEl,e=c.get("scrollHeight")-c.get("offsetHeight");(new b.Anim({node:c,duration:0.5,from:{scrollTop:0},to:{scrollTop:e},easing:b.Easing.easeBothStrong})).run()}),r=!1)});g.on("accountsMissing",function(){q.setButtons(k)})}else c.set("enabled",
!0),e.get("contentBox").one(".sqs-xero-setup-copy").removeClass("setup-copy-disabled")});q.show();h.load()}})},"1.0",{requires:"base squarespace-xero-accounts-config squarespace-xero-tax-setup-dialog squarespace-models-xero-connected-account squarespace-dialog-xero-default-account-creator squarespace-models-xero-account squarespace-dialog anim-scroll anim-easing squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-layout-editor",function(b){var d=b.Squarespace.Block.Utils.getValFromClass;b.namespace("Squarespace.Layout");b.Squarespace.Layout.Editor=b.Base.create("LayoutEditor",b.Plugin.Base,[],{initializer:function(b){this._host=this.get("host");this._builder=this._host.LayoutBuilder;this.setBlocksEditable(!0);this.cleanGrid();this._initDD(b);this._initColumnResize();this._initFloatResizer();this._host.addClass("sqs-editing")},destructor:function(){this._host.removeClass("sqs-editing");
this.setBlocksEditable(!1);this._host=null;this.resizers.detach();this.resizers.destroy();this.dragDelegate.destroy();this.destroyFloatResizer()},_isBlogApp:function(){return this.get("editController").isMobileApp()},_initDD:function(c){c=this._isBlogApp();var e=this.dragDelegate=new b.Squarespace.Layout.DragDelegate({container:this._host,nodes:".sqs-block",invalid:".sqs-dd-invalid, .sqs-edit-dialog-open, .sqs-helper, .sqs-block-locked-layout",invalidHandles:".sqs-dd-invalid-handle, .sqs-block-focused .sqs-dd-invalid-handle-on-focus, .sqs-selected .sqs-dd-invalid-handle-on-focus",
dragConfig:{groups:["blocks"],clickTimeThresh:c?600:200,haltDown:c?!1:null},extraSyncShims:!c,useDragScroll:!0,scrollNode:this.get("scrollNode"),editController:this.get("editController")});e.dd.removeInvalid("textarea");e.before("drag:start",this._beforeDragStart,this);e.on("drag:start",this._onDragStart,this);e.after("drag:end",this._afterDragEnd,this);this.on("lockChange",function(c){e.set("lockTarget",c.newVal);b.Array.each(b.DD.DDM.targets,function(b){this._host.contains(b.get("node"))&&(c.newVal?
(b.set("lock",!0),b._deactivateShim()):(b.set("lock",!1),b._activateShim()))},this);this.get("editController").toggleInsertMarkerLock(c.newVal)},this)},_initColumnResize:function(){this.resizers=new b.DD.Delegate({container:this._host,nodes:".sqs-helper",invalid:".no-editing .sqs-helper, .sqs-float-right .sqs-helper, .sqs-float-left .sqs-helper",dragConfig:{groups:["resizers"],move:!1}});this.resizers.on("drag:mouseDown",this._onResizerDragMousedown,this);this.resizers.on("drag:start",this._onResizerDragStart,
this);this.resizers.on("drag:drag",this._onResizerDragDrag,this);this.resizers.on("drag:end",this._onResizerDragEnd,this)},_onResizerDragMousedown:function(b){b=b.target.get("node").ancestor(".sqs-row",!0);this.calcGridStops(b)},calcGridStops:function(b){var e=parseInt(b.getStyle("width"),10),d=parseInt(b.getStyle("paddingLeft"),10),g=b.ancestor(".sqs-col"),h=this.get("columns"),g=g?this.getElSize(g):h,e=e/g;b=b.getXY()[0];this.gridStops=[];for(g=0;g<h-1;g++)this.gridStops.push(b+d+Math.round(e*(g+
1)))},_onResizerDragStart:function(c){var e=c.target.get("node");c=c.target.nodeXY[0];var d=this.get("gutterSize");b.one("html").addClass("sqs-resizing-column");this.leftColumn=e.ancestor(".sqs-col");this.rightColumn=this.leftColumn.next();this.leftOrigSize=this.getElSize(this.leftColumn);this.rightOrigSize=this.getElSize(this.rightColumn);this.origResizerPos=this.xToColumn(c+d/2);this._host.addClass("sqs-resizing");this.leftColumn.addClass("sqs-resizing sqs-resizing-left");this.rightColumn.addClass("sqs-resizing sqs-resizing-right");
this.saveOriginalSizes(e.ancestor(".sqs-row"));this.get("editController").disableInsertPoints();this.get("editController").disableDragSelection()},xToColumn:function(b){var e=(this.gridStops[1]-this.gridStops[0])/2;if(b<this.gridStops[0])return 0;if(b>this.gridStops[this.gridStops.length])return this.get("columns")-1;for(var d=0;d<this.gridStops.length;d++){var g=this.gridStops[d];if(b>g-e&&b<g+e)return d}},_onResizerDragDrag:function(b){var e,d,g,h,k,l;g=b.target.mouseXY[0];h=this.gridStops[1]-this.gridStops[0];
b=this.get("columns");k=0;for(l=this.gridStops.length;k<l;k++)if(e=this.gridStops[k],g<this.gridStops[0]-h)e=this.getMinColSize(this.leftColumn),d=this.rightOrigSize+this.leftOrigSize-e,this.setElSize(this.leftColumn,e),this.setElSize(this.rightColumn,d);else if(g>this.gridStops[this.gridStops.length-1]+h)d=this.getMinColSize(this.rightColumn),e=this.leftOrigSize+this.rightOrigSize-d,this.setElSize(this.leftColumn,e),this.setElSize(this.rightColumn,d);else if(g>e-h/2&&g<e+h/2){d=k-this.origResizerPos;
e=this.leftOrigSize+d;d=this.rightOrigSize-d;g=this.getMinColSize(this.leftColumn);h=this.getMinColSize(this.rightColumn);k=this.getMaxColSize(this.leftColumn);l=this.getMaxColSize(this.rightColumn);if(e<g||e>k||d<h||d>l)break;if(e===this.getElSize(this.leftColumn))break;e=Math.min(Math.max(1,e),b);d=Math.min(Math.max(1,d),b);this.setElSize(this.leftColumn,e);this.setElSize(this.rightColumn,d);break}},_onResizerDragEnd:function(){var c=this._host.all(".sqs-col");b.one("html").removeClass("sqs-resizing-column");
this._host.all(".sqs-col.sqs-resizing").each(function(c){var d=this.getElSize(c);c.get("children").filter(".sqs-float-left, .sqs-float-right").each(function(c){this.getElSize(c)>d+1&&(c=b.Widget.getByNode(c))&&c.get("model").set("floatDir",null)},this);c.all(".sqs-block").each(function(c){b.Widget.getByNode(c).fire("resized")})},this);this._host.removeClass("sqs-resizing");c.removeClass("sqs-resizing-left");c.removeClass("sqs-resizing-right");c.removeClass("sqs-resizing");this.cleanGrid();this.get("editController").enableInsertPoints();
this.get("editController").enableDragSelection()},getBlockNodes:function(b){var e=this._host.all(".sqs-block:not(.sqs-destroyme)");return b?e.filter(b):e},getBlocks:function(){var c=[];this.getBlockNodes().each(function(e){c.push(b.Widget.getByNode(e))},this);return c},beforeDrag:function(){this.getBlocks().forEach(function(b){b.blockEditor&&b.blockEditor.beforeLayoutDrag()},this)},afterDrag:function(){this.getBlocks().forEach(function(b){b.blockEditor&&b.blockEditor.afterLayoutDrag()},this)},setBlocksEditable:function(b){this.getBlocks().forEach(function(e){e.set("editable",
b)},this)},_beforeDragStart:function(b){this.get("editController").layoutBeforeDragStart()},_onDragStart:function(){var c=b.DD.DDM.activeDrag.get("node"),e=b.Widget.getByNode(c),d=b.all(".sqs-selected"),g=this.get("editController");e.blockEditor&&e.blockEditor.set("dropZoneLocked",!0);g.set("selection",c);d.each(function(c){c=b.Widget.getByNode(c);b.Lang.isValue(c)&&c!==e&&c.set("selected",0)});g.layoutDragStart(this.get("host"))},_afterDragEnd:function(){var c=this.dragDelegate.get("lastNode");(c=
b.Widget.getByNode(c))&&c.blockEditor&&c.blockEditor.set("dropZoneLocked",!1);this.get("editController").layoutDragEnd()},_initFloatResizer:function(){this.floatResizers=new b.DD.Delegate({container:this.get("host"),nodes:".sqs-float-right .sqs-helper, .sqs-float-left .sqs-helper",invalid:".no-editing .sqs-helper",dragConfig:{move:!1}});this.floatResizers.dd.addToGroup("floaters");this.floatResizers.on("drag:mouseDown",this._onFloatResizerDragMousedown,this);this.floatResizers.on("drag:start",this._onFloatResizerDragStart,
this);this.floatResizers.on("drag:drag",this._onFloatResizerDragDrag,this);this.floatResizers.on("drag:end",this._onFloatResizerDragEnd,this)},_onFloatResizerDragMousedown:function(b){this.get("editController").layoutBeforeDragStart()},_onFloatResizerDragStart:function(c){b.one("html").addClass("sqs-dragging-block");var e=c.target.get("node").ancestor(".sqs-col");c=b.Widget.getByNode(c.target.get("node"));this._currentWidth=c.get("model").get("hSize");this._minWidth=Math.max(c.blockEditor.get("minHSize"),
1);this._maxWidth=parseInt(d(e,"sqs-col-"),10);this._steps=parseInt(e.get("region").width/this._maxWidth,10);this.get("editController").disableInsertPoints();this.get("editController").disableDragSelection()},_onFloatResizerDragDrag:function(c){var e=b.Widget.getByNode(c.target.get("node"));c=Math.floor((c.target.mouseXY[0]-c.target.startXY[0])/this._steps);this._isFloatingRight(e)&&(c*=-1);c+=this._currentWidth;c>=this._minWidth&&c<=this._maxWidth&&(this._newHSize=c,this._removeHSizeClasses(e),e.get("boundingBox").addClass("sqs-col-"+
c))},_isFloatingRight:function(b){return"right"===b.get("model").get("floatDir")},_removeHSizeClasses:function(b){b=b.get("boundingBox");b.set("className",b.get("className").replace(/(?:\s|^)(sqs-col-\d+?)(?=\s|$)/g,""))},_onFloatResizerDragEnd:function(c){c=b.Widget.getByNode(c.target.get("node"));var e={hSize:this._newHSize};this._newHSize===this._maxWidth&&(e.floatDir=null);c.get("model").setAttrs(e);c.get("boundingBox").removeClass("yui3-dd-dragging");b.one("html").removeClass("sqs-dragging-block");
this.afterDrag();this.get("editController").enableInsertPoints();this.get("editController").enableDragSelection();this._builder.syncDOMToContent();this._newHSize=null},destroyFloatResizer:function(){this.floatResizers&&(this.floatResizers.destroy(),this.floatResizers=null)},getBlockByNode:function(c){return b.Widget.getByNode(c.ancestor(".sqs-block",!0))},_handleColumnInsertBlock:function(b,e){"left"===b.direction||"right"===b.direction?this.insertColumn(b.node,e,b.direction):"bottom"===b.direction?
b.node.append(e):"top"===b.direction&&(e.filter?b.node.prepend(e.filter(function(e){return!b.node.get("children").item("0").compareTo(e)})):b.node.prepend(e))},_unfloatBlockByNode:function(c){this._blockIsFloating(c)&&(c=b.Widget.getByNode(c))&&c.get("model").set("floatDir",null)},_handleFloatingBlockEdgeCases:function(b,e){var d=b.node.previous();d===e&&(this._blockIsFloating(d)||this._unfloatBlockByNode(d.previous()));this._blockIsFloating(d)&&(b.node=this._getTopFloatingBlock(d))},_handleBlockInsertBlock:function(b,
e){if("top"===b.direction)this._handleFloatingBlockEdgeCases(b,e),b.node.insert(e,"before");else if("bottom"===b.direction)b.node.insert(e,"after");else if("left"===b.direction||"right"===b.direction)0===b.node.siblings("*:not(.sqs-helper)").size()?this.insertColumn(b.node.ancestor(".sqs-col",!0),e,b.direction):this.splitBlock(b.node,e,b.direction)},_handleContentInsertBlock:function(c,e){var d=c.node.getData("alignNode")||c.node,g=this.getBlockByNode(d),h=g.get("boundingBox"),k=h.previous();if("bottom"===
c.direction)d.next()?g.blockEditor.split(d,e):h.insert(e,"after");else if(d.previous()?g.blockEditor.split(d.previous(),e):k&&k.test("[class*=sqs-float-]")?(k=k.previous(".sqs-block:not(.sqs-float-left):not(.sqs-float-right)")||k,k.insert(e,"after")):h.insert(e,"before"),"left"===c.direction||"right"===c.direction)d=Math.floor(this.getParentSize(h)/2),0<d&&b.Widget.getByNode(e).get("model").setAttrs({hSize:d,floatDir:c.direction})},_handleRowBlockInsert:function(b,e){"left"===b.direction?this.insertColumn(b.node.one(".sqs-col:first-child"),
e,b.direction):"right"===b.direction?this.insertColumn(b.node.one(".sqs-col:last-child"),e,b.direction):("top"===b.direction||"bottom"===b.direction)&&this.insertRow(b.node,e,b.direction)},_blockShouldFloatInContent:function(b){if("left"===b.direction||"right"===b.direction){b=b.node.getData("alignNode")||b.node;var e=this.getBlockByNode(b);b=e?e.get("boundingBox"):b;return 0<Math.floor(this.getParentSize(b)/2)}return!1},_getTopFloatingBlock:function(c){return!c||!c.previous()||this._blockIsFloating(c)&&
!this._blockIsFloating(c.previous())?b.Lang.isValue(c)?c:null:this._getTopFloatingBlock(c.previous())},_blockIsFloating:function(c){c=b.Widget.getByNode(c);return b.Lang.isValue(c)&&!(!c.get("model")||!c.get("model").get("floatDir"))},insertBlock:function(c,e){var d=!1,g=b.Widget.getByNode(c);this._builder.registerBlock(g);b.Object.getValue(e,"type")||(e.type=this.getType(e.node));if(e&&e.type&&g){var h=b.Squarespace.Block.Utils.getColumnWidth(g.get("contentBox"));"content"===e.type?(this._handleContentInsertBlock(e,
c),d=this._blockShouldFloatInContent(e)):"block"===e.type?this._handleBlockInsertBlock(e,c):"column"===e.type?this._handleColumnInsertBlock(e,c):"row"===e.type&&this._handleRowBlockInsert(e,c);d||g.get("model").setAttrs({hSize:null,floatDir:null});c.scrollIntoView();this._builder.syncDOMToContent();g.fire("dropped",{dropInfo:e,floating:!!d,oldCol:h});g.set("visible",!0)}},insertRow:function(b,e,d){var g=this._builder,h=g.get("columns");e=g.createColumn(e,h);g=g.createRow(e);b.insert(g,"top"===d?"before":
"after")},insertColumn:function(b,e,d){var g;g=b.ancestor(".sqs-row").get("children").filter(".sqs-col").size();g=this.getParentSize(b)/(g+1);0===Math.floor(g)?"left"===d?b.prepend(e):"right"===d&&b.append(e):(e=this._builder.createColumn(e,0),b.insert(e,"left"===d?"before":"after"),this.saveOriginalSizes(b.ancestor(".sqs-row")),this.resizeColumn(e,Math.round(g)))},getParentSize:function(b){b=b.ancestor(".sqs-col");return null!==b?this.getElSize(b):this._builder.get("columns")},getElSize:function(b){return d(b,
"sqs-col-")},_foldColumnsSize:function(b,e){var d=0;b.each(function(b){d+=parseInt(e.call(this,b),10)},this);return d},_getMinColumnsWidth:function(b){return this._foldColumnsSize(b,this.getMinColSize)},_getColumnsWidth:function(b){return this._foldColumnsSize(b,this.getElSize)},resizeColumn:function(c,e,d){var g=this.getParentSize(c),h=c.ancestor(".sqs-row").get("children").filter(".sqs-col").filter(function(b){return b!==c.getDOMNode()}),k=g-this._getMinColumnsWidth(h);if(!d&&(0===e||0===h.size()||
1>k))return!1;this.saveOriginalSizes(c.ancestor(".sqs-row"));for(var l=this.getElSize(c)+e,k=Math.min(k,l),l=this._getResizeInfo(h),p,q=e,r=0<e?-1:1;q!==p&&0!==q;)p=q,b.Array.each(l,function(b,c){var e=b.node,k=this.getElSize(e),l=this.getMinColSize(e),p=this._getColumnsWidth(h);if(0!==q&&k+r>=l&&g>=p+r)this.setElSize(e,k+r,d),q+=r;else for(;0!==q&&k+r<l&&0<r&&g>=p+r;)k+=r,this.setElSize(e,k,d),q+=r,p=this._getColumnsWidth(h)},this);0!==q&&console.error("Column resizing has leftovers");this.setElSize(c,
k,d)},_getResizeInfo:function(b){var e=[];b.each(function(b,c){e.push({node:b,idx:c,min:this.getMinColSize(b),size:this.getElSize(b)})},this);1<e.length&&e.sort(function(b,c){return b.size-b.min-(c.size-c.min)});return e},getMinColSize:function(c){var e=c.get("children").filter(".sqs-row");c.all("> .sqs-row > .sqs-col");e.size();var d=1;0<e&&0!==d?e.each(function(b,c){var e=b.get("children").filter(".sqs-col"),l=e.size();e.each(function(b){l+=this.getMinColSize(b)-1},this);d=Math.max(d,l)},this):
c.all(".sqs-block").each(function(c){c=b.Widget.getByNode(c);c.blockEditor&&(d=Math.max(d,this.getMinBlockSize(c)))},this);return parseInt(d,10)},getMinBlockSize:function(b){return parseInt(b.blockEditor.get("minHSize")||1,10)},getMaxColSize:function(b){var e=b.ancestor(".sqs-col"),d=e?this.getElSize(e):this.get("columns");b.siblings(".sqs-col").each(function(b){d-=this.getMinColSize(b)},this);return d},saveOriginalSizes:function(b){b.all(".sqs-col").each(function(b){this.cleanOriginalSizes(b);b.addClass("origsize-"+
this.getElSize(b))},this);b.all(".sqs-block").each(function(b){this.getElSize(b)&&(this.cleanOriginalSizes(b),b.addClass("origsize-"+this.getElSize(b)))},this)},getElOrigSize:function(b){return d(b,"origsize-")},setElSize:function(b,e,d){var g=this.getElSize(b),h=this.getElOrigSize(b)||g,k=this.getMinColSize(b);e=!d&&e<k?k:e;b.all(".sqs-block").each(function(b){var c=this.getElOrigSize(b);c&&this.setElSize(b,Math.max(1,Math.floor(e/h*c)))},this);this.updateColumnSize(b,e,g);(d=b.ancestor(".sqs-col"))?
this.getElSize(d):this._builder.get("columns");b.get("children").filter(".sqs-row").each(function(b){var c=e-h,d=c;b.get("children").filter(".sqs-col").each(function(b,e){var f=this.getElOrigSize(b)||this.getElSize(b),g=this.getMinColSize(b),k=f/h,k=0<c?Math.min(d,Math.ceil(k*c)):Math.max(d,Math.floor(k*c)),g=Math.max(g,f+k),k=g-f;d-=k;this.setElSize(b,f+k)},this)},this)},updateColumnSize:function(c,e,d){c&&e!==d&&(b.Lang.isValue(d)&&c.removeClass("sqs-col-"+d),c.addClass("sqs-col-"+e),this._builder.syncDOMToContent())},
getColSpace:function(b){return this.getElSize(b)-this.getMinColSize(b)},splitBlock:function(b,e,d){var g=this.getParentSize(b);d="left"===d?"before":"after";if(0===Math.floor(g/2))b.insert(e,d);else{var h=this._builder.createRow();b.insert(h,"before");b=this._builder.createColumn(b,g);e=this._builder.createColumn(e,0);h.append(b);b.insert(e,d);this.resizeColumn(e,Math.round(g/2))}},getClassName:function(c){return b.ClassNameManager.getClassName(c)},getType:function(b){if(b.hasClass("sqs-block")||
b.hasClass("free-block"))return"block";if(b.hasClass("sqs-col"))return"column";if(b.hasClass("sqs-row"))return"row";if(b.ancestor(this.get("editController").get("contentParentBlockSelector"),!0))return"content";if(b.hasClass("sqs-layout"))return"layout";b.hasClass("sqs-layout-insert-point")||console.log("Unknown node type")},cleanGrid:function(c){this.get("forceSingleColumn")&&this.collapseGrid();this.cleanBlocks();this.cleanColumns();this.cleanRows();b.Squarespace.ImageLoadManager.refreshAll()},
collapseGrid:function(){var b=this._host.all(".sqs-row > .sqs-col");if(!(2>b.size())){this._host.LayoutBuilder.get("columns");var e=this._host.one(".sqs-row").one("> .sqs-col");this.getElSize(e);this._host.all(".sqs-row > .sqs-col > *").each(function(b){e.appendChild(b)},this);b.each(function(b){b!==e&&b.remove()},this);this.resizeColumn(e,12,!0)}},cleanBlocks:function(){var c=this.getBlockNodes(),e=c.filter(":not(.sqs-float-left)").filter(":not(.sqs-float-right)"),d=0===c.size();this._host.toggleClass("sqs-empty",
d);this._host.toggleClass("empty",d);if(!this.get("host").hasClass("sqs-locked-layout")&&(d||0===e.size())){e=Static.SQUARESPACE_CONTEXT.websiteSettings.markdownMode?b.Squarespace.Block.Markdown:b.Squarespace.Block.Html;d=this._host.one(".sqs-row .sqs-col");if(!d)throw"No rows or columns found.";e=new e({editable:!0,render:d,visible:!0,editMode:this.get("editMode"),editController:this.get("editController")});this._builder.registerBlock(e)}c.each(function(c){var e=b.Widget.getByNode(c);if(!e)throw"block(s) hasn't been initialized, this indicates an error";
if(!e.get("destroyed")){c.hasClass("sqs-col-Infinity")&&(c.removeClass("sqs-col-Infinity"),this.cleanOriginalSizes(c));e.blockEditor&&e.blockEditor.cleanBlock();e.get("model").get("floatDir")&&!this._isBlockFloatValid(c)&&e.get("model").set("floatDir",null);var d=c.get("children").filter(".sqs-helper").item(0);e.get("model").get("floatDir")?b.Lang.isNull(d)&&this._appendResizerNodeTo(c):d&&d.remove()}},this);this.deleteQueuedBlocks()},_isBlockFloatValid:function(c){c=c.next();if(!c)return!1;var e=
b.Widget.getByNode(c);return!e?!1:(e=e.get("model"))&&e.get("floatDir")?this._isBlockFloatValid(c):c.test(this.get("editController").get("contentParentBlockSelector"))},deleteQueuedBlocks:function(){var c=this.get("host"),e=c.all(".sqs-destroyme"),d=!1;0!==e.size()&&(e.each(function(c){var e=b.Widget.getByNode(c);!d&&!c.next(".sqs-block, .sqs-row")&&(d=!0);e&&!e.get("destroyed")&&(e.destroy(),this._builder.deregisterBlock(e))},this),d&&this.get("editController").alignInsertPoints(c,!0))},_insertTextBlockAtEnd:function(c){var e=
b.Widget.getByNode(c.all(".sqs-block").pop()),d=null;e&&(d=parseInt(e.get("type"),10));d&&(d!==b.Squarespace.BlockType.HTML&&d!==b.Squarespace.BlockType.MARKDOWN)&&(e=this.get("markdownMode")?"Markdown":"Html",c=new b.Squarespace.Block[e]({editable:!0,render:c,editMode:this.get("editMode"),editController:this.get("editController")}),this._builder.registerBlock(c))},_appendResizerNodeTo:function(b){b.appendChild('<div class="sqs-helper"><div class="sqs-resizer"><div class="sqs-line"></div></div></div>')},
cleanColumns:function(){this._host.all(".sqs-row > .sqs-col").each(function(c,e){var d=0===c.all("> *:not(.sqs-helper)").size(),g=1<this._host.all(".sqs-col").size();d&&g?(this.resizeColumn(c,-1*this.getElSize(c),!0),d=c.siblings(".sqs-col"),c.remove(),d.each(function(c){c.all(".sqs-block").each(function(c){(c=b.Widget.getByNode(c))&&c.fire("resized",{source:"columnChanged"})})})):(this.cleanOriginalSizes(c),this._isBlogApp()&&this._insertTextBlockAtEnd(c),c.one("> .sqs-helper")||this._appendResizerNodeTo(c))},
this)},cleanOriginalSizes:function(c){var e=c.get("className").split(" ");b.Array.each(e,function(b){"origsize"===b.substring(0,8)&&c.removeClass(b)},this)},cleanRows:function(){this._host.all(".sqs-row").each(function(b){var e=b.get("parentNode"),d=b.get("children").filter(".sqs-col"),g=b.next()&&"row"===this.getType(b.next())?b.next():null,h=g?g.get("children").filter(".sqs-col"):null;0===b.all(".sqs-block").size()&&1<this._host.all(".sqs-row").size()?b.remove():("column"===this.getType(e)&&1===
d.size()&&(d.each(function(e){e.get("children").filter(".sqs-helper").remove();b.insert(e.get("children"),"after")},this),b.remove()),1===d.size()&&(g&&1===h.size())&&(g.one(".sqs-col").prepend(b.one(".sqs-col").get("children")),b.remove()))},this)}},{NS:"LayoutEditor",ATTRS:{scrollNode:{valueFn:function(){return b.one(b.UA.gecko||b.UA.ie?"html":"body")},lazyAdd:!1},columns:{value:12},gutterSize:{value:24},lock:{value:!1},id:{valueFn:function(){return"layout-"+b.Squarespace.Utils.getGuid()}},forceSingleColumn:{value:!1},
markdownMode:{value:!1},editController:{writeOnce:!0,validator:function(c){return b.instanceOf(c,b.Squarespace.EditControllerBase)}},editMode:{writeOnce:!0,validator:function(c){return b.Squarespace.Layout.EditMode.isValid(c)}}}})},"2.0",{requires:"base plugin dd-delegate dd-scroll event-custom-base squarespace-image-loader squarespace-ui-base squarespace-util squarespace-layout-drag squarespace-layout-builder squarespace-layout-insert-marker squarespace-block-utils squarespace-dd-behaviors squarespace-block-focus-handler squarespace-scrollintoview".split(" ")});
YUI.add("squarespace-hb-product-types",function(b){b.Handlebars.registerHelper("product-physical",function(d){return this.structuredContent.productType===b.Squarespace.ProductTypes.PHYSICAL?d.fn(this):d.inverse(this)});b.Handlebars.registerHelper("product-digital",function(d){return this.structuredContent.productType===b.Squarespace.ProductTypes.DIGITAL?d.fn(this):d.inverse(this)});b.Handlebars.registerHelper("product-service",function(d){return this.structuredContent.productType===b.Squarespace.ProductTypes.SERVICE?
d.fn(this):d.inverse(this)});b.Handlebars.registerHelper("product-variants",function(d){var c=this.structuredContent.productType;return c===b.Squarespace.ProductTypes.PHYSICAL||c===b.Squarespace.ProductTypes.SERVICE?d.fn(this):d.inverse(this)})},"1.0",{requires:["handlebars-base","squarespace-util"]});
YUI.add("squarespace-settings-commerce-accounting",function(b){var d=b.Base.create("lockOverlay",b.Squarespace.DialogField2,[],{renderUI:function(){new b.Squarespace.ToolTip({target:this.get("contentBox"),title:"Upgrade to Connect",body:"You must be on the Business Plan to connect Xero.",showTimeout:250})},bindUI:function(){this.get("contentBox").on("click",function(){(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Do you want to upgrade?",
"strings.message":"Upgrading to the Business Plan will enable this feature."})).on("confirm",CONFIG_PANEL.goToUpgrade)})}},{CSS_PREFIX:"sqs-xero-lock-overlay"}),c=b.namespace("Squarespace.Settings.Commerce").Accounting=b.Base.create("accountingSettings",b.Squarespace.Widgets.SettingsPanel,[b.Squarespace.Mixins.XeroConfigurationDialogs],{initializer:function(e){this._setupFinished=Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.xeroSetupComplete;this.set("strings.title","Accounting");this._setupFinished?
this.set("strings.description","Squarespace has partnered with Xero to offer detailed financial accounting for your online store. Your store is currently connected to Xero. Use the Accounting area to view your next daily export, manually export Daily Sales Summaries, edit your Account Mappings, and keep your taxes in sync."):this.set("strings.description","Squarespace has partnered with Xero to offer detailed financial accounting for your online store (currently US only). You can now automatically export your orders, refunds, donations, and taxes to Xero, letting you easily keep track of your finances and how much sales tax you owe. Xero is a subscription service with plans starting at $9/mo. Follow the checklist below to get started. <strong>Currently, this integration is only officially supported in the United States.</strong>");
e=b.clone(c.FIELDS);Static.SQUARESPACE_CONTEXT.website.canUseAdvancedCommerce||e.push({ctor:d});b.Squarespace.Utils.isDamaskEnabled()&&e.unshift({ctor:b.Squarespace.DialogFields.Description,config:{text:this.get("strings.description")}});this._setupFinished||e.push({ctor:b.Squarespace.DialogFields.XeroSetupCheckList,config:{$dontRecurse:!0,name:"setupCheckList",timezoneAbbr:Static.SQUARESPACE_CONTEXT.website.timeZoneAbbr,websiteSettings:Static.SQUARESPACE_CONTEXT.websiteSettings,width:800,disableConnect:!Static.SQUARESPACE_CONTEXT.website.canUseAdvancedCommerce}});
b.Squarespace.XeroUtils.shouldSeeAdminControls()&&(e.push({ctor:b.Squarespace.DialogFields.Description,config:{name:"exportAllCopy",title:"Export Live and Test Orders (Admin Only)",text:'By default, only live orders are exported to Xero. Enable "Export Live and Test Orders" to include Test orders as well.'}}),e.push({ctor:b.Squarespace.DialogFields.Check,config:{name:"exportTestOrders","strings.title":"Export Live and Test Orders","strings.description":"This should only be used by Squarespace admins",
className:"dark"}}));this.set("fields",e);this._connectedAccount=new b.Squarespace.Models.XeroConnectedAccount;this._setupFinished&&(this.set("dataState",this.getProperty("DATA_STATES").LOADING),this._connectedAccount.once("load",function(){this.set("dataState",this.getProperty("DATA_STATES").LOADED);this.syncUI()},this),this._connectedAccount.load());this._xeroAuthenticator=new b.Squarespace.ExternalAuthentication({authenticationType:"website",reloadAfterLogin:!1})},renderUI:function(){c.superclass.renderUI.call(this);
this._headerTray.set("buttons",[])},bindUI:function(){c.superclass.bindUI.call(this);var b=this._connectedAccount;this._xeroAuthenticator.on("completed",b.load,b);b.after(["load","error","save"],this.syncUI,this)},hasUnsavedChanges:function(){return!1},_syncRenderedFields:function(){this._fieldsRendered||(this._fieldsRendered=!0,c.superclass._syncRenderedFields.call(this),this._bindButtonsAndLinks(),this._setupFinished||this._bindSetupChecklist(),b.Squarespace.XeroUtils.shouldSeeAdminControls()&&
this._bindTestOrderCheck())},syncUI:function(){c.superclass.syncUI.call(this);var e=this._connectedAccount,d=e.get("metaData");if(this.loadedSuccessfully()&&this._setupFinished){var g=this.getField("taxesInvalid"),h=this.getField("chartOfAccountsInvalid"),k=this.getField("invoiceLimitExceeded"),l=this.getField("oauthDisconnected");b.Lang.isObject(d)&&(g.set("data",!d.taxesComplete&&!d.oauthDisconnected),h.set("data",!d.chartOfAccountsComplete&&!d.oauthDisconnected),k.set("data",d.invoiceLimitExceeded&&
!d.oauthDisconnected),l.set("data",d.oauthDisconnected));g=this.getField("manualExport");h=this.getField("checkTaxRates");k=this.getField("editChartOfAccounts");g.toggleDisabled(d.oauthDisconnected);h.toggleDisabled(d.oauthDisconnected);k.toggleDisabled(d.oauthDisconnected);g.toggleDisabled(!d.taxesComplete||!d.chartOfAccountsComplete||d.invoiceLimitExceeded||d.oauthDisconnected);this.getField("exportStatus").setAttrs({organizationName:e.get("userName"),organizationShortCode:d.organisationShortCode,
lastExportFmt:e.get("lastExportFmt"),nextExportFmt:e.get("nextExportFmt")})}},_bindButtonsAndLinks:function(){Static.SQUARESPACE_CONTEXT.website.canUseAdvancedCommerce&&(this.getField("manualExport").setOnClick(this._showManualExport,this),this.getField("disconnect").setOnClick(this._doDisconnect,this),this.getField("editChartOfAccounts").setOnClick(this._setupChartOfAccounts,this),this.getField("checkTaxRates").setOnClick(this._setupTaxes,this),this.getField("chartOfAccountsInvalid").set("linkAction",
b.bind(this._setupChartOfAccounts,this)),this.getField("taxesInvalid").set("linkAction",b.bind(this._setupTaxes,this)),this.getField("oauthDisconnected").set("linkAction",b.bind(this._doConnect,this)),this.getField("invoiceLimitExceeded").set("linkAction",b.bind(this._resetInvoiceLimit,this)))},_bindSetupChecklist:function(){var c=this.getField("setupCheckList");c&&c.after("setupFinishedChange",function(){c.get("setupFinished")&&(this._setupFinished=!0,this._connectedAccount.load(b.bind(function(){this.set("strings.description",
"Squarespace has partnered with Xero to offer detailed financial accounting for your online store. Your store is currently connected to Xero. Use the Accounting area to view your next daily export, manually export Daily Sales Summaries, edit your Account Mappings, and keep your taxes in sync.",{noSyncUI:!0});b.Squarespace.XeroUtils.shouldSeeAdminControls()&&this._bindTestOrderCheck()},this)))},this)},_bindTestOrderCheck:function(){var c=this.getField("exportTestOrders");if(c){var d=this._connectedAccount.get("metaData");
d&&c.set("data",d.exportTestOrders);c.after("dataChange",function(){var d=this._connectedAccount.get("metaData"),f=c.get("data");d.exportTestOrders=f;this._connectedAccount.set("metaData",d);var k=f?"Live and Test orders will be exported to Xero.":"Only Live orders will be exported to Xero.";this._connectedAccount.save(function(){new b.Squarespace.Widgets.Information({"strings.title":"Setting Saved","strings.message":k})})},this)}},_doConnect:function(){this._xeroAuthenticator.openPopupWindow(b.Squarespace.ExternalServiceProviders.XERO)},
_doDisconnect:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Disconnect?","strings.message":"Are you sure you want to disconnect Xero?"})).on("confirm",function(){this._connectedAccount.destroy({remove:!0},function(){window.location.reload()})},this)},_resetInvoiceLimit:function(){var c=this._connectedAccount.get("metaData");c.invoiceLimitExceeded=!1;this._connectedAccount.set("metaData",c);this._connectedAccount.save(b.bind(function(){this.showSuccessConfirmation("Exporting Enabled",
"Invoice exporting has been re-enabled.")},this))},_setupChartOfAccounts:function(){this._showChartOfAccountsDialog(!1,'<p class="sqs-xero-setup-copy setup-copy-disabled">Choose which account each line item of your Daily Sales Summary  is mapped to. Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more about setting up account mappings.</div>',"Edit Account Mappings")},_setupTaxes:function(){this._showSetupTaxesDialog('<div class="sqs-xero-setup-copy"><p>Squarespace\'s Daily Sales Summary includes detailed information about your store\'s sales tax liabilities. To export to Xero, you need to have Tax Rates in Xero that match your Taxes in  Squarespace. Use this tool to make sure that all of your Tax Rates are in sync with Squarespace Commerce. Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more about Tax Rates in Xero and Squarespace.</div>',
"Check Tax Rates")},_showManualExport:function(){var c=this._getExportDialogConfig(),d=new b.Squarespace.EditingDialog(c);d.on("send-requested",function(){this._showExportLoadingState(d);b.Squarespace.Analytics.trackInternal("merchant_manual_xero_export");b.Data.post({url:b.Squarespace.REST_API_ROOT+"xero-sync/invoice-export",headers:{"Content-Type":"application/json"},data:b.JSON.stringify(d.getData()),success:b.bind(function(c){c=b.merge(c,{started:!0});c=new b.Squarespace.XeroExportJob(c);this._bindExportJob(c,
d);Static.JOB_MANAGER.addJob(c)},this)})},this);d.show()},_showExportLoadingState:function(c){var d=b.Node.create('<div class="title-text"><div class="sqs-manual-export-spinner"></div> Exporting...</div>'),g=new b.Squarespace.Spinner({boundingBox:d.one(".sqs-manual-export-spinner"),size:"default"});c.setTitleHtml(d);g.render().spin()},_bindExportJob:function(c,d){c.once("complete",function(){d.once("canceled",function(){new b.Squarespace.Widgets.Information({"strings.title":c.get("strings.successTitle"),
"strings.message":c.get("strings.successMessage")})},this);d.cancel();this._connectedAccount.load()},this);c.once("failure",function(){d.once("canceled",function(){new b.Squarespace.Widgets.Information({"strings.title":c.get("strings.failureTitle"),"strings.message":c.get("strings.failureMessage")})},this);d.cancel();this._connectedAccount.load()},this)},_getExportDialogConfig:function(){var e=b.DataType.Date.addDays(new Date,-8),d=b.DataType.Date.addDays(new Date,-1),g=b.DataType.Date.addDays(new Date,
-1),e={name:"manualExport",width:500,overlay:0.5,closeOthers:!1,title:"Manually Export To Xero",style:"minimal",discardChangesConfirmation:!1,initialData:{startDate:e.getTime(),endDate:g.getTime()},primaryTabs:[{fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Manually export Daily Sales Summaries to Xero for a range of dates."}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.TextDateTimePicker,config:{title:"Start Date",width:0.5,style:"minor",className:"event-datetime-picker thin",
name:"startDate",maximumDate:d}},{ctor:b.Squarespace.DialogFields.TextDateTimePicker,config:{title:"End Date",width:0.5,style:"minor",className:"event-datetime-picker thin",name:"endDate",maximumDate:d}}]}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Export"}]};b.Squarespace.XeroUtils.shouldSeeAdminControls()&&(e.primaryTabs[0].fields=e.primaryTabs[0].fields.concat(c.EXPORT_ADMIN_CONTROLS));return e}},{CSS_PREFIX:"sqs-settings-commerce-accounting",ATTRS:{dirty:{readOnly:!0,
value:!1}},EXPORT_ADMIN_CONTROLS:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Export as Draft (Admin Only)",text:"Export these invoices as Drafts without Payments applied."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"exportAsDraft","strings.title":"Export as Draft","strings.description":"This should only be used by Squarespace admins"}}],FIELDS:[{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"oauthDisconnected","strings.warningMessage":'Squarespace was disconnected from Xero. <a class="link-action" href="#">Click here to reconnect</a>.'}},
{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"taxesInvalid","strings.warningMessage":'Your Tax Rates in Xero fell out of sync with Squarespace Commerce. Your store\'s Daily Export to Xero will not occur until they are in sync. <a class="link-action" href="#">Click here</a>  to bring your Tax Rates back in sync.'}},{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"chartOfAccountsInvalid","strings.warningMessage":'Your Account Mappings are not valid. Your store\'s Daily Export to Xero will not occur until they are updated. <a class="link-action" href="#">Click here</a> to update your Account Mappings.'}},
{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"invoiceLimitExceeded","strings.warningMessage":'You have reached the invoice limit in Xero. If you are on a trial, you may need to convert to a paying account. If you have a paying account, you may need to upgrade to a higher volume plan. Once you have converted or upgraded, <a class="link-action" href="#">click here</a> to re-enable exporting.'}},{ctor:b.Squarespace.DialogFields.XeroExportStatus,config:{name:"exportStatus",width:720}},
{ctor:b.Squarespace.DialogFields.Description,config:{name:"manually-export-to-xero-description",title:"Manually Export To Xero",text:'Manually export Daily Sales Summaries to Xero for past dates. Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more about Manual Exporting.'}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Manually Export To Xero",name:"manualExport"}},{ctor:b.Squarespace.DialogFields.Description,
config:{name:"edit-account-mappings-description",title:"Edit Account Mappings",text:'Change which accounts the line items of your Daily Sales Summary are mapped to. Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more setting up account  mappings.'}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Edit Account Mappings",name:"editChartOfAccounts"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"check-tax-rates-description",
title:"Check Tax Rates",text:'View the Tax Rates you need to have in Xero, and make sure they are in sync with Squarespace Commerce. Read our <a target="_blank" href="https://help.squarespace.com/guides/using-xero-with-squarespace">knowledge base article</a> to learn more about taxes in Xero and Squarespace.'}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Check Tax Rates",name:"checkTaxRates"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"disconnect-xero-description",
title:"Disconnect Xero",text:"Disconnect Squarespace from Xero. Squarespace will no longer export Daily Sales Summaries to Xero."}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Disconnect Xero",name:"disconnect"}}]})},"1.0",{requires:"node squarespace-dialog squarespace-dialog-button squarespace-dialog-check squarespace-dialog-description squarespace-dialog-fields squarespace-dialog-html squarespace-dialog-select squarespace-dialog-text-datetime-picker squarespace-dialog-warning-banner squarespace-dialog-xero-export-status squarespace-dialog-xero-setup-checklist squarespace-external-authentication squarespace-jobs squarespace-models-connected-account squarespace-models-connected-accounts squarespace-models-xero-account squarespace-settings-accounting-css squarespace-spinner squarespace-spinner squarespace-util squarespace-widgets-confirmation squarespace-widgets-information squarespace-xero-accounts-config squarespace-xero-configuration-mixin squarespace-xero-tax-setup-dialog squarespace-xero-utils squarespace-xero-utils".split(" ")});
YUI.add("squarespace-settings-site-google-apps",function(b){var d=b.Squarespace.Promises;b.namespace("Squarespace.Widgets").GoogleAppsEmailSettings=b.Base.create("googleAppsEmailSettings",b.Squarespace.Widgets.SettingsPanel,[b.WidgetParent],{initializer:function(){this._currentSubscriptionWidget=null},bindUI:function(){b.Squarespace.Widgets.GoogleAppsEmailSettings.superclass.bindUI.call(this);this.after("dataStateChange",this._syncHeaderTrayLoading,this)},syncUI:function(){b.Squarespace.Widgets.GoogleAppsEmailSettings.superclass.syncUI.call(this);
this.each(function(b){b!==this._headerTray&&b.destroy()},this);this._removeMessages();var c=b.bind(this._showDomainsLink,this),e=b.bind(this._loadAndShowSubForDomain,this),c=this._getManagedDomain().then(e,c);this._execLoadingPromise(c)},_syncHeaderTrayLoading:function(){this._headerTray.set("loading",this.isLoading())},_getManagedDomain:function(){return new b.Promise(b.bind(function(c,e){var d=new b.Squarespace.Models.DomainList({managed:!0});d.load(b.bind(function(g){g?new b.Squarespace.Widgets.Alert({"strings.title":"Error",
"strings.message":"Failed to load google apps subscriptions."}):0>=d.size()?e():(1<d.size()&&this._showDomainSelector(d),c(d.item(0)))},this))},this))},_showDomainSelector:function(c){var e=c.item(0).get("id"),d=c.map(function(b){return{label:b.get("name"),value:b.get("id")}}),e=new b.Squarespace.DialogFields.Select({options:d,data:e}),g=this._buildDomainIndex(c);e.after("dataChange",function(b){b=this._loadAndShowSubForDomain(g[b.newVal]);this._execLoadingPromise(b)},this);this.add(e)},_loadAndShowSubForDomain:function(c){return this._getSubscription(c).then(b.bind(this._showManager,
this),b.bind(this._onSubGetFailure,this))},_execLoadingPromise:function(c){this.set("dataState","loading");d.finish(c,b.bind(this.set,this,"dataState","loaded"))},_buildDomainIndex:function(c){return b.Array.reduce(c.toArray(),{},function(b,c){b[c.get("id")]=c;return b})},_getSubscription:function(c){return new b.Promise(function(e,d){var g=new b.Squarespace.Models.GoogleAppsSubscription({customerId:c.get("name")});g.load(function(b){b?d({error:b.responseJSON,domain:c}):e(g)})})},_onSubGetFailure:function(b){b.error.ownedByOther?
console.warn("owned by other reseller"):this._showActivator(b.domain)},_showActivator:function(c){b.Data.get({url:"/api/google-apps/"+c.get("name")+"/pending-subscriptions",success:function(){this._destroyCurrentSubscriptionWidget();this.get("contentBox").append('<div class="message"><p>A Google Apps registration is pending for this domain. This may take a few minutes. Please check your email.</div>')},failure:function(){var e=new b.Squarespace.Widgets.GoogleApps.InactiveSubscription({model:c,user:CONFIG_PANEL.get("memberAccount"),
website:new b.Squarespace.Models.Website(Static.SQUARESPACE_CONTEXT.website),websiteSettings:new b.Squarespace.Models.WebsiteSettings(Static.SQUARESPACE_CONTEXT.websiteSettings)});e.after("activated",function(){this._showActivator(c)},this);this._destroyCurrentSubscriptionWidget();this._currentSubscriptionWidget=e;this.add(e)}},this)},_showManager:function(c){var e;e=c.get("suspended")?b.Squarespace.Widgets.GoogleApps.SuspendedSubscription:b.Squarespace.Widgets.GoogleApps.ActiveSubscription;this._showSubscriptionWidget(e,
c)},_showSubscriptionWidget:function(b,e){var d=new b({model:e});this._setupSubscribedButtons(e);this._destroyCurrentSubscriptionWidget();this._currentSubscriptionWidget=d;this.add(d)},_setupSubscribedButtons:function(b){var e=[{type:"add",label:"Manage Email",action:function(){this._openManagementWindow(b)},context:this},{type:"add",label:"Add User",action:this._addUser,context:this}];b.get("suspended")||e.push({label:"Cancel Email",className:"secondary",action:this._unsubscribe,context:this});this.set("buttons",
e)},_openManagementWindow:function(b){b="https://www.google.com/a/"+b.get("customerId");window.open(b,"_blank")},_addUser:function(){this._currentSubscriptionWidget.addUser()},_unsubscribe:function(){this._currentSubscriptionWidget.unsubscribe()},_destroyCurrentSubscriptionWidget:function(){b.Lang.isValue(this._currentSubscriptionWidget)&&this._currentSubscriptionWidget.destroy()},_showDomainsLink:function(){var c=this.get("contentBox");c.append('<div class="no-domain-message"><p>Get your free Squarespace managed domain in order to get email.</p></div>');
if(0<Static.SQUARESPACE_CONTEXT.domainCredits)c.appendChild('<div class="register-btn">Register Free Domain</div>').on("click",function(){b.Squarespace.Singletons.DomainRegistrar.register().then(b.bind(this.syncUI,this))},this)},_removeMessages:function(){var c=this.get("contentBox"),e=c.one(".register-btn");b.Lang.isValue(e)&&e.remove();c=c.one(".no-domian-message");b.Lang.isValue(c)&&c.remove()}},{CSS_PREFIX:"sqs-settings-google-apps",ATTRS:{"strings.title":{value:"Email"},"strings.description":{value:""},
buttons:{value:[]}}})},"1.0",{requires:"base widget-parent squarespace-domain-registrar squarespace-enum squarespace-models-website squarespace-models-website-settings squarespace-models-domain-list squarespace-promises squarespace-fluent-confirmation squarespace-widgets-alert squarespace-widgets-google-apps-active-subscription squarespace-widgets-google-apps-suspended-subscription squarespace-widgets-google-apps-inactive-subscription".split(" ")});
YUI.add("squarespace-async-task-synchronizer",function(b){b.namespace("Squarespace").AsyncTaskSynchronizer=b.Base.create("asyncTaskSynchronizer",b.Base,[],{initializer:function(){this._idsToCompleted={};this.before(this.get("id")+"|completedChange",function(b){b.newVal||(b.preventDefault(),b.stopPropagation(),b.stopImmediatePropagation())},this);this.after(this.get("id")+"|completedChange",function(b){var c=this.get("completionCallback"),e=this.get("callbackContext");b.newVal&&c&&(e?c.call(e):c());
this.destroy()},this)},destructor:function(){this.detach(this.get("id")+"|*");this._idsToCompleted=null},add:function(d,c,e,f){if(this.get("destroyed"))throw this.name+": This synchonizer has been used and destroyed";if(!d)throw this.name+": No eventTarget(s) provided.";1===arguments.length&&b.Lang.isArray(d)?d.forEach(function(b){this.add.apply(this,b)},this):b.Lang.isArray(d)?d.forEach(function(b){this._waitForEvent(b,c,e,f)},this):this._waitForEvent(d,c,e,f)},_allTasksCompleted:function(){return b.Array.every(b.Object.values(this._idsToCompleted),
function(b){return b})},_markCompleted:function(b){this.get("destroyed")||(this._idsToCompleted[b]=!0,this._allTasksCompleted()&&this._set("completed",!0))},_waitForEvent:function(d,c,e,f){var g=b.guid("task-"),h=!1;this._idsToCompleted[g]=!1;b.Lang.isFunction(e)&&(f&&b.bind(e,f),h=e(d,c));if(h)this._markCompleted(g);else{var k=b.bind(function(b){d.on(this.get("id")+"|"+b,function(b){this._markCompleted(g)},this)},this);b.Lang.isArray(c)?b.Array.each(c,function(b){k(b)},this):k(c)}return g}},{ATTRS:{completed:{value:!1,
readOnly:!0},completionCallback:{value:null,validator:b.Lang.isFunction},callbackContext:{value:null}}})},"1.0",{requires:["base","base-build"]});
YUI.add("squarespace-block-mixin-coalesceable",function(b){b.namespace("Squarespace.Block.Mixin").Coalesceable=b.Base.create("block-coalesceable",b.Base,[],{initializer:function(){this._host.get("editController").set("contentParentBlockSelector","."+this._host.getClassName());b.Do.after(this._attemptToCoalesce,this,"cleanBlock")},insertContentIntoModel:function(b){throw Error("Coalesceable requires insertContentIntoModel method implementation");},_attemptToCoalesce:function(d){this._host.get("isNewBlock")||
(d=this._getCoalescableSiblingGroup(),1<d.length&&b.Widget.getByNode(d[0]).blockEditor.coalesceFollowingBlocks())},_getCoalescableSiblingGroup:function(b){var c=b||this._bb;b=c.ancestor().get("children");var e=b.size(),f=b.indexOf(c),g="."+this._host.getClassName()+":not(.sqs-destroyme)",c=c.test(g)?[c]:[],h;if(0===e)return c;if(0<f)for(h=f-1;0<=h&&b.item(h).test(g)&&this._isCoalesceable(b.item(h));h--)c.unshift(b.item(h));if(f<e-1)for(h=f+1;h<e&&b.item(h).test(g)&&this._isCoalesceable(b.item(h));h++)c.push(b.item(h));
return c},_isCoalesceable:function(b){return 0<b.one(".sqs-block-content").get("text").length},coalesceFollowingBlocks:function(){var d=this._getCoalescableSiblingGroup();0===d.indexOf(this._bb)&&(d=b.Array.reduce(d,"",function(c,e){var d=b.Widget.getByNode(e);e!==this._bb&&d.queueForDestruction();return c+"\n"+d.get("model").get("html").trim()},this),this.insertContentIntoModel(d),this._host.syncUI())}})},"1.0",{requires:["base","node","widget"]});
YUI.add("squarespace-models-donate-page",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.DonatePage=b.Base.create("DonatePage",b.Model,[b.Squarespace.ModelSync.REST],{root:"/api/rest/commerce/donate-pages",toJSON:function(){var c=d.superclass.toJSON.call(this);b.Lang.isObject(c.customForm)&&(c.customForm={fields:b.Array.map(c.customForm,JSON.stringify)});return c}},{ATTRS:{title:{},suggestedContributions:{},customForm:{},buttonLabel:{}}})},"1.0",{requires:["base","model",
"squarespace-model-sync-rest"]});
YUI.add("squarespace-dialog-multi-select",function(b){b.namespace("Squarespace.DialogFields").MultiSelect=b.Base.create("multiSelect",b.Squarespace.DialogField2,[],{initializer:function(b){this._childrenById={};b=this.get("id");this.on(b+"|addChild",function(b){this._registerChild(b.child)},this);this.on(b+"|removeChild",function(b){this._unregisterChild(b.child)},this)},renderUI:function(){b.Squarespace.DialogFields.MultiSelect.superclass.renderUI.call(this);this.get("contentBox").addClass("clear")},bindUI:function(){if(this.get("draggable")){this._ddDel=
new b.DD.Delegate({container:this.get("contentBox"),nodes:"> *",groups:"multi-select-"+this.get("id"),target:!0});var d=this._ddDel.dd.plug(b.Squarespace.DDReorder,{container:this.get("contentBox"),nodes:"> *"}).ddreorder;this._ddDel.dd.plug(b.Plugin.DDConstrained,{stickY:!0});d.on(this.get("id")+"|reordered",function(){this.set("data",this.get("data"))},this)}},syncUI:function(){b.Squarespace.DialogFields.MultiSelect.superclass.syncUI.call(this);this.get("draggable")&&(this._ddDel.syncTargets(),
this.get("boundingBox").addClass("draggable"))},_registerChild:function(b){b.attrAdded("active")||console.warn("Field passed to MultiSelect dialog field named: "+this.get("name")+'does not have an "active" attribute. It will not be included in the result set.');var c=b.get("id");this._childrenById[c]=b;c=-1!==(this._initialData||[]).indexOf(b.get("data"));b.set("active",c);this._bindChild(b)},_unregisterChild:function(b){b=b.get("id");delete this._childrenById[b]},_bindChild:function(b){var c=this.get("id");
b.after(c+"|activeChange",function(){var b=this.get("dialog");b&&b.fire("datachange",this);this.fire("dataChange")},this)},_getData:function(){activeChildren=[];this.get("rendered")&&this.get("contentBox").all(".sqs-dialog-field").each(function(d){(d=b.Widget.getByNode(d))&&d.get("active")&&activeChildren.push(d)});return b.Array.map(activeChildren,function(b){return b.get("data")})},_reorderDataFromDOM:function(){}},{CSS_PREFIX:"sqs-multi-select",ATTRS:{data:{value:[],getter:"_getData"},children:{value:[]},
draggable:{value:!1}}})},"1.0",{requires:["base","base-build","squarespace-dialog-field-2"]});
YUI.add("squarespace-block-image",function(b){var d=["caption-hidden","caption-below","caption-overlay","caption-overlay-hover"];b.namespace("Squarespace.ContentModel").ImageBlock=b.Base.create("ImageBlockModel",b.Model,[],{sync:function(c,e,d){("create"===c||"update"===c)&&(new b.Squarespace.Models.ContentItem({id:this.get("imageId"),filename:this.get("filename")})).save({fields:["filename"]});d()},toJSON:function(){return{imageId:this.get("imageId"),linkTo:this.get("linkTo"),newwindow:this.get("newwindow"),
lightbox:this.get("lightbox"),vSize:this.get("vSize"),aspectRatio:this.get("aspectRatio"),layout:this.get("layout"),stretch:this.get("stretch"),description:this.get("description"),floatDir:this.get("floatDir"),hSize:this.get("hSize")}}},{ATTRS:{layout:{value:"caption-below",validator:b.Squarespace.AttrValidators.isValueIn(d)},linkTo:{value:""},newwindow:{value:!1},lightbox:{value:!1},stretch:{value:!1},filename:{value:null},description:{setter:function(c){return b.Lang.isString(c)?{engine:"wysiwyg",
source:"",html:c}:c},value:{engine:"wysiwyg",source:"",html:""}}}});b.namespace("Squarespace.Block").Image=b.Base.create("block-image",b.Squarespace.Block.ParentBase,[],{initializer:function(){this.LOG=new b.Squarespace.Debugger({output:!1,name:"BlockImage",uid:!0})},renderUI:function(c){c=this.get("model");c.toJSON();b.Lang.isValue(c.layout)&&c.layout.get("collectionId");this.contentImage=this.add({childType:b.Squarespace.Content.Image,editable:this.get("editable"),model:this._getImageContentModelJSON()}).item(0);
this.contentImage.set("editing",!0);this.contentImage.addTarget(this);this.contentCaption=this.add({childType:b.Squarespace.Content.Html,editable:this.get("editable"),model:this._getHTMLContentModelJSON(),placeholderText:"Enter a caption&hellip;",type:"small"}).item(0);this.contentCaption.get("boundingBox").addClass("sqs-image-caption");this._renderCaptionOrientation()},_renderCaptionOrientation:function(){var c=this.get("boundingBox"),e=this.get("editController").isMobileApp()?"caption-below":this.get("model").get("layout");
b.Array.each(d,function(b){c.removeClass("layout-"+b)},this);c.addClass("layout-"+e)},_getImageContentModelJSON:function(){var c=this.get("model"),e={imageId:c.get("imageId"),aspectRatio:c.get("aspectRatio"),scale:c.get("scale"),collectionId:b.Lang.isValue(c.layout)?c.layout.get("collectionId"):null,stretch:c.get("stretch")},d=c.get("vSize");b.Lang.isValue(d)&&(e.vSize=d);this.get("editController").isMobileApp()&&c.get("image")&&(e.baseAssetUrl=c.get("image.assetUrl"),e.dimensions=c.get("image.originalSize"),
e.focalPoint=c.get("image.mediaFocalPoint"));return e},_getHTMLContentModelJSON:function(){return{html:this.get("model").get("description.html")||""}},bindUI:function(){var c=this.get("model"),e=this.contentImage.get("model"),d=this.contentCaption.get("model");b.Array.each(["imageId","scale"],function(b){e.after(b+"Change",function(e){e.silent||(this.LOG.log("syncing to image block model "+b+"Change (prevVal: "+e.prevVal+") (newVal: "+e.newVal+")"),c.set(b,e.newVal))},this)},this);e.on("aspectRatioChange",
function(b){b.silent||(this.LOG.log("syncing `aspectRatio` to image block model (prevVal: "+b.prevVal+") (newVal: "+b.newVal+")"),c.set("aspectRatio",b.newVal))},this);d.on("htmlChange",function(b){c.set("description.html",b.newVal)});c.after("lightboxChange",this._syncLightbox,this);this.after("editableChange",this.syncUI,this);d=c.get("vSize");if(b.Lang.isValue(d))c.on("vSizeChange",function(b){e.set("vSize",b.newVal)});c.after("stretchChange",function(){e.set("stretch",c.get("stretch"))});c.after("layoutChange",
function(){this._renderCaptionOrientation()},this);c.after("filenameChange",function(b){e.setItemData({filename:b.newVal})})},syncUI:function(){var b=this.get("model").get("layout"),e=this.contentCaption;this.get("editable")?e.show():"caption-hidden"===b||!e.get("model").get("html")?e.hide():e.show();this._syncLightbox()},_syncLightbox:function(){var c=this.get("model");this.get("contentBox").unplug(b.Squarespace.Lightbox2Plug.NS);if(!this.get("editable")&&c.get("lightbox")){var e=this.contentImage.get("model"),
d=e.get("dimensions"),c=c.get("description.html"),g=b.Node.create("<img/>");g.setAttribute("data-src",e.get("baseAssetUrl"));g.setAttribute("data-image-focal-point",e.get("focalPoint"));b.Lang.isObject(d)&&g.setAttribute("data-image-dimensions",d.width+"x"+d.height);this.get("contentBox").plug(b.Squarespace.Lightbox2Plug,{lightboxOptions:{content:g,meta:c||""}})}}},{CSS_PREFIX:"sqs-block-image",MODEL:b.Squarespace.ContentModel.ImageBlock,ATTRS:{stack:{},type:{value:5},editor:{valueFn:function(){return b.Squarespace.Block.Editor.Image}},
mobileEditor:{valueFn:function(){return b.Squarespace.Block.Editor.ImageMobile}},emailEditor:{valueFn:function(){return b.Squarespace.Block.Editor.ImageEmail}}}})},"1.0",{requires:"base model squarespace-ss-widget squarespace-block-base squarespace-block-content-image squarespace-gallery-ng widget-parent".split(" ")});
YUI.add("text-data-accentfold",function(b,d){b.namespace("Text.Data").AccentFold={0:/[\u2070\u2080\u24EA\uFF10]/gi,1:/[\u00B9\u2081\u2460\uFF11]/gi,2:/[\u00B2\u2082\u2461\uFF12]/gi,3:/[\u00B3\u2083\u2462\uFF13]/gi,4:/[\u2074\u2084\u2463\uFF14]/gi,5:/[\u2075\u2085\u2464\uFF15]/gi,6:/[\u2076\u2086\u2465\uFF16]/gi,7:/[\u2077\u2087\u2466\uFF17]/gi,8:/[\u2078\u2088\u2467\uFF18]/gi,9:/[\u2079\u2089\u2468\uFF19]/gi,a:/[\u00AA\u00E0-\u00E5\u0101\u0103\u0105\u01CE\u01DF\u01E1\u01FB\u0201\u0203\u0227\u1D43\u1E01\u1E9A\u1EA1\u1EA3\u1EA5\u1EA7\u1EA9\u1EAB\u1EAD\u1EAF\u1EB1\u1EB3\u1EB5\u1EB7\u24D0\uFF41]/gi,
b:/[\u1D47\u1E03\u1E05\u1E07\u24D1\uFF42]/gi,c:/[\u00E7\u0107\u0109\u010B\u010D\u1D9C\u1E09\u24D2\uFF43]/gi,d:/[\u010F\u1D48\u1E0B\u1E0D\u1E0F\u1E11\u1E13\u217E\u24D3\uFF44]/gi,e:/[\u00E8-\u00EB\u0113\u0115\u0117\u0119\u011B\u0205\u0207\u0229\u1D49\u1E15\u1E17\u1E19\u1E1B\u1E1D\u1EB9\u1EBB\u1EBD\u1EBF\u1EC1\u1EC3\u1EC5\u1EC7\u2091\u212F\u24D4\uFF45]/gi,f:/[\u1DA0\u1E1F\u24D5\uFF46]/gi,g:/[\u011D\u011F\u0121\u0123\u01E7\u01F5\u1D4D\u1E21\u210A\u24D6\uFF47]/gi,h:/[\u0125\u021F\u02B0\u1E23\u1E25\u1E27\u1E29\u1E2B\u1E96\u210E\u24D7\uFF48]/gi,
i:/[\u00EC-\u00EF\u0129\u012B\u012D\u012F\u0133\u01D0\u0209\u020B\u1D62\u1E2D\u1E2F\u1EC9\u1ECB\u2071\u2139\u2170\u24D8\uFF49]/gi,j:/[\u0135\u01F0\u02B2\u24D9\u2C7C\uFF4A]/gi,k:/[\u0137\u01E9\u1D4F\u1E31\u1E33\u1E35\u24DA\uFF4B]/gi,l:/[\u013A\u013C\u013E\u0140\u01C9\u02E1\u1E37\u1E39\u1E3B\u1E3D\u2113\u217C\u24DB\uFF4C]/gi,m:/[\u1D50\u1E3F\u1E41\u1E43\u217F\u24DC\uFF4D]/gi,n:/[\u00F1\u0144\u0146\u0148\u01F9\u1E45\u1E47\u1E49\u1E4B\u207F\u24DD\uFF4E]/gi,o:/[\u00BA\u00F2-\u00F6\u014D\u014F\u0151\u01A1\u01D2\u01EB\u01ED\u020D\u020F\u022B\u022D\u022F\u0231\u1D52\u1E4D\u1E4F\u1E51\u1E53\u1ECD\u1ECF\u1ED1\u1ED3\u1ED5\u1ED7\u1ED9\u1EDB\u1EDD\u1EDF\u1EE1\u1EE3\u2092\u2134\u24DE\uFF4F]/gi,
p:/[\u1D56\u1E55\u1E57\u24DF\uFF50]/gi,q:/[\u02A0\u24E0\uFF51]/gi,r:/[\u0155\u0157\u0159\u0211\u0213\u02B3\u1D63\u1E59\u1E5B\u1E5D\u1E5F\u24E1\uFF52]/gi,s:/[\u015B\u015D\u015F\u0161\u017F\u0219\u02E2\u1E61\u1E63\u1E65\u1E67\u1E69\u1E9B\u24E2\uFF53]/gi,t:/[\u0163\u0165\u021B\u1D57\u1E6B\u1E6D\u1E6F\u1E71\u1E97\u24E3\uFF54]/gi,u:/[\u00F9-\u00FC\u0169\u016B\u016D\u016F\u0171\u0173\u01B0\u01D4\u01D6\u01D8\u01DA\u01DC\u0215\u0217\u1D58\u1D64\u1E73\u1E75\u1E77\u1E79\u1E7B\u1EE5\u1EE7\u1EE9\u1EEB\u1EED\u1EEF\u1EF1\u24E4\uFF55]/gi,
v:/[\u1D5B\u1D65\u1E7D\u1E7F\u2174\u24E5\uFF56]/gi,w:/[\u0175\u02B7\u1E81\u1E83\u1E85\u1E87\u1E89\u1E98\u24E6\uFF57]/gi,x:/[\u02E3\u1E8B\u1E8D\u2093\u2179\u24E7\uFF58]/gi,y:/[\u00FD\u00FF\u0177\u0233\u02B8\u1E8F\u1E99\u1EF3\u1EF5\u1EF7\u1EF9\u24E8\uFF59]/gi,z:/[\u017A\u017C\u017E\u1DBB\u1E91\u1E93\u1E95\u24E9\uFF5A]/gi}},"3.17.2",{requires:["yui-base"]});
YUI.add("uploader-html5",function(b,d){function c(){c.superclass.constructor.apply(this,arguments)}var e=b.Lang.sub,f=b.Uploader.Queue;b.UploaderHTML5=b.extend(c,b.Widget,{_fileInputField:null,_buttonBinding:null,queue:null,initializer:function(){this._buttonBinding=this.queue=this._fileInputField=null;this._fileList=[];this.publish("fileselect");this.publish("uploadstart");this.publish("fileuploadstart");this.publish("uploadprogress");this.publish("totaluploadprogress");this.publish("uploadcomplete");
this.publish("alluploadscomplete");this.publish("uploaderror");this.publish("dragenter");this.publish("dragover");this.publish("dragleave");this.publish("drop")},renderUI:function(){var e=this.get("contentBox"),d=this.get("selectFilesButton");d.setStyles({width:"100%",height:"100%"});e.append(d);this._fileInputField=b.Node.create(c.HTML5FILEFIELD_TEMPLATE);e.append(this._fileInputField)},bindUI:function(){this._bindSelectButton();this._setMultipleFiles();this._setFileFilters();this._bindDropArea();
this._triggerEnabled();this.after("multipleFilesChange",this._setMultipleFiles,this);this.after("fileFiltersChange",this._setFileFilters,this);this.after("enabledChange",this._triggerEnabled,this);this.after("selectFilesButtonChange",this._bindSelectButton,this);this.after("dragAndDropAreaChange",this._bindDropArea,this);this.after("tabIndexChange",function(){this.get("selectFilesButton").set("tabIndex",this.get("tabIndex"))},this);this._fileInputField.on("change",this._updateFileList,this);this._fileInputField.on("click",
function(b){b.stopPropagation()},this);this.get("selectFilesButton").set("tabIndex",this.get("tabIndex"))},_rebindFileField:function(){this._fileInputField.remove(!0);this._fileInputField=b.Node.create(c.HTML5FILEFIELD_TEMPLATE);this.get("contentBox").append(this._fileInputField);this._fileInputField.on("change",this._updateFileList,this);this._setMultipleFiles();this._setFileFilters()},_bindDropArea:function(b){b=b||{prevVal:null};var c=this.get("dragAndDropArea");null!==b.prevVal&&(b.prevVal.detach("drop",
this._ddEventHandler),b.prevVal.detach("dragenter",this._ddEventHandler),b.prevVal.detach("dragover",this._ddEventHandler),b.prevVal.detach("dragleave",this._ddEventHandler));null!==c&&(c.on("drop",this._ddEventHandler,this),c.on("dragenter",this._ddEventHandler,this),c.on("dragover",this._ddEventHandler,this),c.on("dragleave",this._ddEventHandler,this))},_bindSelectButton:function(){this._buttonBinding=this.get("selectFilesButton").on("click",this.openFileSelectDialog,this)},_ddEventHandler:function(c){c.stopPropagation();
c.preventDefault();if(-1<b.Array.indexOf(c._event.dataTransfer.types,"Files"))switch(c.type){case "dragenter":this.fire("dragenter");break;case "dragover":this.fire("dragover");break;case "dragleave":this.fire("dragleave");break;case "drop":c=c._event.dataTransfer.files;var e=[],d=this.get("fileFilterFunction");d?b.each(c,function(c){c=new b.FileHTML5(c);d(c)&&e.push(c)}):b.each(c,function(c){e.push(new b.FileHTML5(c))});0<e.length&&(c=this.get("fileList"),this.set("fileList",this.get("appendNewFiles")?
c.concat(e):e),this.fire("fileselect",{fileList:e}));this.fire("drop",{fileList:e})}},_setButtonClass:function(b,c){c?this.get("selectFilesButton").addClass(this.get("buttonClassNames")[b]):this.get("selectFilesButton").removeClass(this.get("buttonClassNames")[b])},_setMultipleFiles:function(){!0===this.get("multipleFiles")?this._fileInputField.set("multiple","multiple"):this._fileInputField.set("multiple","")},_setFileFilters:function(){0<this.get("fileFilters").length?this._fileInputField.set("accept",
this.get("fileFilters").join(",")):this._fileInputField.set("accept","")},_triggerEnabled:function(){this.get("enabled")&&null===this._buttonBinding?(this._bindSelectButton(),this._setButtonClass("disabled",!1),this.get("selectFilesButton").setAttribute("aria-disabled","false")):!this.get("enabled")&&this._buttonBinding&&(this._buttonBinding.detach(),this._buttonBinding=null,this._setButtonClass("disabled",!0),this.get("selectFilesButton").setAttribute("aria-disabled","true"))},_getFileList:function(){return this._fileList.concat()},
_setFileList:function(b){this._fileList=b.concat();return this._fileList.concat()},_updateFileList:function(c){c=c.target.getDOMNode().files;var e=[],d=this.get("fileFilterFunction");d?b.each(c,function(c){c=new b.FileHTML5(c);d(c)&&e.push(c)}):b.each(c,function(c){e.push(new b.FileHTML5(c))});0<e.length&&(c=this.get("fileList"),this.set("fileList",this.get("appendNewFiles")?c.concat(e):e),this.fire("fileselect",{fileList:e}));this._rebindFileField()},_uploadEventHandler:function(b){switch(b.type){case "file:uploadstart":this.fire("fileuploadstart",
b);break;case "file:uploadprogress":this.fire("uploadprogress",b);break;case "uploaderqueue:totaluploadprogress":this.fire("totaluploadprogress",b);break;case "file:uploadcomplete":this.fire("uploadcomplete",b);break;case "uploaderqueue:alluploadscomplete":this.queue=null;this.fire("alluploadscomplete",b);break;case "file:uploaderror":case "uploaderqueue:uploaderror":this.fire("uploaderror",b);break;case "file:uploadcancel":case "uploaderqueue:uploadcancel":this.fire("uploadcancel",b)}},openFileSelectDialog:function(){var b=
this._fileInputField.getDOMNode();b.click&&b.click()},upload:function(c,e,d){e=e||this.get("uploadURL");d=d||this.get("postVarsPerFile");var f=c.get("id");d=d.hasOwnProperty(f)?d[f]:d;c instanceof b.FileHTML5&&(c.on("uploadstart",this._uploadEventHandler,this),c.on("uploadprogress",this._uploadEventHandler,this),c.on("uploadcomplete",this._uploadEventHandler,this),c.on("uploaderror",this._uploadEventHandler,this),c.on("uploadcancel",this._uploadEventHandler,this),c.startUpload(e,d,this.get("fileFieldName")))},
uploadAll:function(b,c){this.uploadThese(this.get("fileList"),b,c)},uploadThese:function(c,e,d){this.queue?this.queue._currentState===f.UPLOADING&&(this.queue.set("perFileParameters",this.get("postVarsPerFile")),b.each(c,function(b){this.queue.addToQueueBottom(b)},this)):(e=e||this.get("uploadURL"),d=d||this.get("postVarsPerFile"),this.queue=new f({simUploads:this.get("simLimit"),errorAction:this.get("errorAction"),fileFieldName:this.get("fileFieldName"),fileList:c,uploadURL:e,perFileParameters:d,
retryCount:this.get("retryCount"),uploadHeaders:this.get("uploadHeaders"),withCredentials:this.get("withCredentials")}),this.queue.on("uploadstart",this._uploadEventHandler,this),this.queue.on("uploadprogress",this._uploadEventHandler,this),this.queue.on("totaluploadprogress",this._uploadEventHandler,this),this.queue.on("uploadcomplete",this._uploadEventHandler,this),this.queue.on("alluploadscomplete",this._uploadEventHandler,this),this.queue.on("uploadcancel",this._uploadEventHandler,this),this.queue.on("uploaderror",
this._uploadEventHandler,this),this.queue.startUpload(),this.fire("uploadstart"))}},{HTML5FILEFIELD_TEMPLATE:"<input type='file' style='visibility:hidden; width:0px; height: 0px;'>",SELECT_FILES_BUTTON:'<button type="button" class="yui3-button" role="button" aria-label="{selectButtonLabel}" tabindex="{tabIndex}">{selectButtonLabel}</button>',TYPE:"html5",NAME:"uploader",ATTRS:{appendNewFiles:{value:!0},buttonClassNames:{value:{hover:"yui3-button-hover",active:"yui3-button-active",disabled:"yui3-button-disabled",
focus:"yui3-button-selected"}},dragAndDropArea:{value:null,setter:function(c){return b.one(c)}},enabled:{value:!0},errorAction:{value:"continue",validator:function(b){return b===f.CONTINUE||b===f.STOP||b===f.RESTART_ASAP||b===f.RESTART_AFTER}},fileFilters:{value:[]},fileFilterFunction:{value:null},fileFieldName:{value:"Filedata"},fileList:{value:[],getter:"_getFileList",setter:"_setFileList"},multipleFiles:{value:!1},postVarsPerFile:{value:{}},selectButtonLabel:{value:"Select Files"},selectFilesButton:{valueFn:function(){return b.Node.create(e(b.UploaderHTML5.SELECT_FILES_BUTTON,
{selectButtonLabel:this.get("selectButtonLabel"),tabIndex:this.get("tabIndex")}))}},simLimit:{value:2,validator:function(b){return 1<=b&&5>=b}},uploadURL:{value:""},uploadHeaders:{value:{}},withCredentials:{value:!0},retryCount:{value:3}}});b.UploaderHTML5.Queue=f},"3.17.2",{requires:["widget","node-event-simulate","file-html5","uploader-queue"]});
YUI.add("squarespace-models-member-permission",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.MemberPermission=b.Base.create("MemberPermission",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.REST_API_ROOT+"member-permissions",url:b.Squarespace.REST_API_ROOT+"member-permissions/{id}",toJSON:function(c){c=d.superclass.toJSON.call(this);c.memberAccount=c.memberAccount.toJSON();c.permissions=b.Object.keys(c.permissions);return c},serialize:function(){var c=this.toJSON();
delete c.memberAccount;return b.JSON.stringify(c)},isMe:function(){return this.get("memberAccountId")===b.Squarespace.Context.getInstance().get("authenticatedAccount").get("id")},isOwner:function(){return this.get("memberAccountId")===b.Squarespace.Context.getInstance().get("websiteSettings").get("ownerId")}},{ATTRS:{id:{value:null,validator:b.Lang.isString},memberAccountId:{value:null,validator:b.Lang.iString},memberAccount:{value:null,setter:function(c){return c instanceof b.Squarespace.Models.MemberAccount?
c:new b.Squarespace.Models.MemberAccount(c)}},permissions:{value:{},validator:b.Lang.isObject},subscribed:{value:null,validator:b.Lang.isBoolean},createdOn:{value:null,validator:b.Lang.isNumber},lastActiveOn:{value:null,validator:b.Lang.isNumber},lastLoginOn:{value:null,validator:b.Lang.isNumber}}});b.Squarespace.Models.MemberPermissionList=b.Base.create("MemberPermissionList",b.ModelList,[b.Squarespace.ModelSync.REST],{model:b.Squarespace.Models.MemberPermission,getActive:function(){return this.filter(function(c){return!c.get("memberAccount").get("pseudonymAccount")&&
!b.Object.isEmpty(c.get("permissions"))})},getPassive:function(){return this.filter(function(c){return!c.get("memberAccount").get("pseudonymAccount")&&b.Object.isEmpty(c.get("permissions"))})},getPseudonym:function(){return this.filter(function(b){return b.get("memberAccount").get("pseudonymAccount")})}})},"1.0",{requires:"base model json model-list squarespace-model-sync-rest squarespace-models-member-account squarespace-util squarespace-context".split(" ")});
YUI.add("squarespace-content-item-types-video",function(b){var d=b.Base.create("VideoPostEditorBehavior",b.Base,[],{initializer:function(){var c=this.get("model");if(c.get("recordType")===b.Squarespace.Enums.RecordType.VIDEO){var d=this.get("dialog"),g;d.on("ready",function(){var h=d.getField("oembed"),k=d.getField("mainImage"),l=d.getField("title");d.getField("body");var p=d.getField("sourceUrl");h.focus();h.on("dataChange",function(h){p&&p.set("data",h.newVal.url);l.set("data",h.newVal.title);g&&
g.cancel();g=b.later(1E3,this,function(){var b=h.newVal;b.thumbnailUrl&&(c.get("id")?b.thumbnailUrl&&this._applyDefaultThumbnailImage():(c.autoSave(),d.getField("mainImage").get("data").after("idChange",function(){this._applyDefaultThumbnailImage()},this)))})},this);k.after("dataChange",this._syncThumbnailRestore,this);this._syncThumbnailRestore()},this)}},_applyDefaultThumbnailImage:function(){var b=this.get("dialog"),c=b.getField("oembed").getValue().thumbnailUrl;b.getField("mainImage").saveFromUrl(c);
b.getField("overlay").set("data",!0)},_syncThumbnailRestore:function(){this._thumbnailRestoreEv&&this._thumbnailRestoreEv.detach();var b=this.get("dialog"),c=b.getField("oembed"),d=b.getField("mainImage"),b=b.getField("automaticThumbDescription");c.getValue()&&c.getValue().thumbnailUrl&&(!d.get("data")||d.get("data")&&!d.get("data").get("hasFileData"))?(b.setText('<a href="#" class="restore-thumbnail">Restore video provider\'s thumbnail.</a>'),this._thumbnailRestoreEv=b.get("boundingBox").one(".restore-thumbnail").on("click",
function(b){b&&b.halt();this._applyDefaultThumbnailImage()},this)):b.setText("")}}),c=b.namespace("Squarespace.ContentItemEditor").Video=b.Base.create("VideoContentItemEditor",b.Squarespace.ContentItemEditor.Base,[d],{getDialogData:function(){var b=c.superclass.getDialogData.call(this),d=b.structuredContent;b.oembed=d.oembed;b.overlay=d.overlay;return b},sanitizeDialogData:function(e){e=c.superclass.sanitizeDialogData.call(this,e);e.structuredContent=b.merge(e.structuredContent,{oembed:e.oembed,overlay:e.overlay});
delete e.oembed;delete e.overlay;return e}},{ATTRS:{editorConfiguration:{value:{name:"video-editor",title:"Edit {presentationName}",width:800,height:500,overlay:0.5,tabs:[{$include:["tabs.primary.base","tabs.primary.video"]},{$include:"tabs.options.video"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"},initialDataByReference:!0}}}}),d={title:"Edit {presentationName}",name:"minimal-video-editor",width:800,height:400,overlay:0.5,closeOthers:!1,style:"flyout",flyoutPointerDirection:"hidden",
tabs:[{$include:["tabs.primary.video",{icon:b.Squarespace.Rendering.getIconUrl("video",16,"light-solid")}],$update:{".body":{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"body",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.FULL,editorHeight:147,classNames:"major",title:"Description",description:""}}}}],buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:{$valueFn:function(b){return b.id?"Remove":"Discard"}}},{$value:{type:"duplicate",title:"Duplicate"},$when:function(c){return c.recordType==
b.Squarespace.Enums.RecordType.STORE_ITEM}},{type:"saveAndClose",title:"Save"}]};b.namespace("Squarespace.ContentItemEditor").VideoMinimal=b.Base.create("VideoContentItemEditorMinimal",c,[],{},{ATTRS:{editorConfiguration:{value:d},anchorNode:{getter:function(){return null}}}})},"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-stats-block-numbit",function(b){b.Handlebars.registerHelper("4CharFit",function(d,c){if(b.Lang.isUndefined(d))return console.warn("Attempt to 4CharFit undefined."),"Err";var e=0,f="";1E9<=d?(d/=1E9,e=2,f="B"):1E8<=d?(d/=1E6,e=0,f="M"):1E7<=d?(d/=1E6,e=1,f="M"):1E6<=d?(d/=1E6,e=2,f="M"):1E5<=d?(d/=1E3,f="K",e=0):1E4<=d&&(d/=1E3,f="K",e=1);return b.DataType.Number.format(d,{prefix:"",decimalSeparator:".",thousandsSeparator:",",decimalPlaces:e,suffix:f})});b.Handlebars.registerHelper("pctChange",
function(d,c){return b.Lang.isUndefined(d)?"0%":b.DataType.Number.format(100*Math.abs(d),{prefix:"",decimalSeparator:".",decimalPlaces:0,suffix:"%"})});b.namespace("Squarespace.Views.Stats").Numbit=b.Base.create("numbit",b.Squarespace.Views.Stats.Summary,[],{template:"stats-block-numbit.html"})},"1.0",{requires:"node base-base datatype-number-format handlebars-base squarespace-stats-block-summary-view squarespace-stats-block-numbit-template squarespace-hb-number-format".split(" ")});
YUI.add("squarespace-block-product-editor",function(b){b.namespace("Squarespace.Block.Editor").Product=b.Base.create("product-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Product")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Product"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Product=b.Base.create("blockProductEditor",b.Squarespace.ModelEditorDialog,[],{},
{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:420,height:370,name:"editProductBlock",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],primaryTabs:[{title:"Edit Product",icon:"/universal/images-v6/icons/icon-products-18-light-solid.png",scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.ProductChooser,name:"productId",mode:"squarespace",maxResults:15},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showImage","strings.title":"Show Image",
"strings.description":"Show a thumbnail image of this product."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showTitle","strings.title":"Show Title","strings.description":"Show the name of this product"}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showPrice","strings.title":"Show Price","strings.description":"Display the current price of this product."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showExcerpt","strings.title":"Show Description","strings.description":"Show the brief description of this product."}},
{ctor:b.Squarespace.DialogFields.Check,config:{name:"showBuyButton","strings.title":"Show Add To Cart Button","strings.description":"Show a button that lets customers add this to their cart."}}]}]}},"1.0",{requires:["base","squarespace-block-editor-dialog","squarespace-damask-context-globals","squarespace-dialog-product-chooser","squarespace-model-editor"]});
YUI.add("squarespace-stats-block-summary-view",function(b){var d=b.namespace("Squarespace.Views.Stats").Summary=b.Base.create("statsBlockView",b.Squarespace.Views.Stats.Block,[],{_loadData:function(){var c=b.Squarespace.StatsTimeFrameUtils.getDateRange(this.get("timeFrame"));b.Data.get({url:"/api/census/GetSummaryData",data:{start:c.start.getTime(),end:c.end.getTime(),dataType:1,dataMetric:this.get("dataMetric"),granularity:this.get("granularity")},success:function(b){this.fire("dataLoaded",{data:b})},
failure:function(b){this.fire("dataLoaded",{error:b.error||"Failed to load data."})}},this)},_renderDefaultState:function(b){d.superclass._renderDefaultState.apply(this,arguments);this._setTrendClass(b.summary&&b.summary.percentChange?100*b.summary.percentChange:0)},_setTrendClass:function(b){var e=this.get("container"),d=0<=b;b=d?"positive-trend":"negative-trend";d=d?"negative-trend":"positive-trend";e.hasClass(b)||(e.removeClass(d),e.addClass(b))},_getTemplateContext:function(c){var e=d.superclass._getTemplateContext.apply(this,
arguments);if(c&&c.summary)return b.merge(e,c.summary);console.warn("Census disabled on the server.");return e},_getDatasetTotal:function(c){return b.Array.reduce(c,0,function(b,c){return b+c.count},this)}})},"1.0",{requires:["base-base","squarespace-stats-block-view"]});
YUI.add("squarespace-edit-controller-base",function(b){var d=d||function(){};b.namespace("Squarespace.Layout").EditMode=b.Squarespace.enumFactory({WEB_APP:1,MOBILE_APP:2,EMAIL:3});b.namespace("Squarespace").EditControllerBase=b.Base.create("editcontroller",b.Base,[],{initializer:function(){this._scrollNodes=[];this.changedLayouts=[];this.after("editingChange",this._syncEditing,this);this.after("dropInfoChange",this._afterDropInfoChange,this);this.addBrowserClassnames()},addBrowserClassnames:function(){b.UA.gecko&&
16>b.UA.gecko&&b.one("html").addClass("ua-gecko-old")},_syncEditing:function(b){b.silent||(b.newVal?this._enableEditing():this._disableEditing())},_afterDropInfoChange:function(b){b.newVal?this.alignInsertMarker(b.newVal):this.hideInsertMarker()},getLayoutNodes:function(){return b.all(".sqs-layout")},pluginLayoutBuilder:function(c,e,d){var g=b.Squarespace.Layout.Builder.NS;c.hasPlugin(g)||(b.Lang.isValue(d)||(d=this.get("defaultEditMode")),c.plug(b.Squarespace.Layout.Builder,{editController:this,
layout:e,editMode:d}));return c[g]},destroyLayoutBuilder:function(c){c.unplug(b.Squarespace.Layout.Builder.NS)},pluginLayoutEditor:function(c,e,d,g){this.get("editing")||this.set("editing",!0,{silent:!0});b.Lang.isValue(g)||(g=this.get("defaultEditMode"));c.hasPlugin(b.Squarespace.Layout.Builder.NS)||this.pluginLayoutBuilder(c,e,g);c=c.plug(b.Squarespace.Layout.Editor,{editMode:g,editController:this,scrollNode:d||this.get("scrollNode"),forceSingleColumn:this.get("forceSingleColumn"),markdownMode:this.get("markdownMode"),
columns:b.Squarespace.Block.Utils.getValFromClass(c,"sqs-grid-")})[b.Squarespace.Layout.Editor.NS];this.getBlockTrashInstance();return c},getBlockTrashInstance:function(){this._blockTrashInstance||(this._blockTrashInstance=new b.Squarespace.Layout.BlockTrash(b.merge(this.get("passableConfig"),{editController:this})));return this._blockTrashInstance},destroyBlockTrashInstance:function(){this._blockTrashInstance&&(this._blockTrashInstance.destroy(),this._blockTrashInstance=null)},destroyLayoutEditor:function(c){this.destroyLayoutBuilder(c);
c.unplug(b.Squarespace.Layout.Editor.NS)},layoutBeforeDragStart:function(){this.getLayoutNodes().each(function(c){b.Lang.isObject(c.LayoutEditor)&&c.LayoutEditor.beforeDrag()},this)},layoutDragStart:function(c){b.one("html").addClass("sqs-dragging-block");this.changedLayouts.push(c);this.setInsertMarkerLayout(c)},processEdgeInfo:function(c){c=c.newVal;var e=this.get("dropBlockInfo"),d=c.node,g=e.ancestors,h=e.parentLayout,k=d.getData("isAdjacentToBlockEdge"),l=c.direction,p=c.region;d.hasClass("sqs-content-overlay")&&
(d=d.getData("alignNode"));var q=this.getType(d),r="content"===q?d.ancestor(".sqs-block"):d;if(!e.blockNode||e.blockNode!==r)g=r.ancestors(".sqs-block, .sqs-col, .sqs-row, .sqs-layout",!0,".sqs-layout"),h=g.shift(),this.set("dropBlockInfo",{blockNode:r,parentLayout:h,ancestors:g});e=b.DD.DDM.activeDrag.get("dragWidget").get("floatable")&&"content"===q&&this._isHorizontalDirection(l);if(!e&&(this.get("forceSingleColumn")||1===h.LayoutEditor.get("columns")))l=c.quad.y;this._isTraversableDirection(l,
k)&&(d=this._getTraversedDropNode(d,l,c),q=this.getType(d),e&&(e="content"===q));"content"===q?!e&&this._isHorizontalDirection(l)&&(d=d.ancestor(this.get("contentParentBlockSelector")),q=this.getType(d)):"block"===q&&(this._isHorizontalDirection(l)&&this._isOnlyBlockInColumn(d))&&(d=d.ancestor(".sqs-col"),q=this.getType(d));d!==c.node&&(p=d.get("region"));this.set("dropInfo",{node:d,direction:l,shouldFloat:e,type:q,region:p})},_isTraversableDirection:function(b,e){var d=!0;e&&void 0!==e[b]&&(d=e[b]);
return d},_getTraversableDepth:function(b,e,d){for(var g=d.size(),h=0;b&&this._canTraverseToParent(b,e);)h++,b=d.item(--g);return h},_canTraverseToParent:function(b,e){var d=b.hasClass("sqs-col"),g=!this.get("forceSingleColumn");return d&&this._isVerticalDirection(e)||g&&this._canTraverseHorizontallyFromColumn(e,b)||!d&&g&&this._isHorizontalDirection(e)||this._canTraverseVerticallyFromBlockOrRow(e,b)},_getTraversedDropNode:function(b,e,d){var g=this.get("dropBlockInfo.ancestors");g.item(g.size()-
1)===b&&g.pop();this.get("forceSingleColumn")&&(g=g.filter(".sqs-block"));var h=this._getTraversableDepth(b,e,g);if(h){e=g.size();var h=e-h,k=Math.min(d.region.width,d.region.height)/4;d=Math.floor(e*d.distance/k);d=Math.max(h,Math.min(e,d));b=g.item(d)||b}return b},_isHorizontalDirection:function(b){return"left"===b||"right"===b},_isVerticalDirection:function(b){return"top"===b||"bottom"===b},_canTraverseHorizontallyFromColumn:function(b,e){return"left"===b&&!e.previous(".sqs-col")||"right"===b&&
!e.next(".sqs-col")},_canTraverseVerticallyFromBlockOrRow:function(b,e){return"top"===b&&!e.previous(".sqs-block, .sqs-row")||"bottom"===b&&!e.next(".sqs-block, .sqs-row")},_isOnlyBlockInColumn:function(b){return 0===b.siblings(".sqs-block:not(.sqs-float), .sqs-row").size()},getType:function(b){if(!b)return"unknown";if(b.hasClass("sqs-block")||b.hasClass("free-block"))return"block";if(b.hasClass("sqs-col"))return"column";if(b.hasClass("sqs-row"))return"row";if(b.ancestor(this.get("contentParentBlockSelector")))return"content"},
layoutDragEnd:function(){b.one("html").removeClass("sqs-dragging-block");this.insertBlockToLayout();this.getLayoutNodes().each(function(c){c.hasPlugin(b.Squarespace.Layout.Editor.NS)&&c.LayoutEditor.afterDrag();c.hasPlugin(b.Squarespace.Layout.Builder.NS)&&c.LayoutBuilder.fire("widget:contentUpdate")},this);this.changedLayouts.length&&this.cleanGrids()},insertBlockToLayout:function(){var c=this.get("dropInfo"),e=this.get("selection");if(b.Lang.isValue(c)&&(b.Lang.isValue(c.node)&&e)&&(e=this._getBlockNodeListFromSelection(e,
c),e.size())){var d=c.node.ancestor(".sqs-layout"),g=[],h=!1;e.each(function(e){d.LayoutEditor.insertBlock(e,c);g.push(b.Widget.getByNode(e))});b.Array.each(this.changedLayouts,function(b){b===d?h=!0:b.LayoutBuilder.deregisterBlocks(g)});h||this.changedLayouts.push(d);this.cleanGrids();b.Array.each(g,function(b){b&&!b.get("destroyed")&&(d.LayoutBuilder.registerBlock(b),b.show())});this.setAttrs({dropInfo:null,dropBlockInfo:{},selection:null})}},_getBlockNodeListFromSelection:function(c,e){return c&&
(b.Squarespace.Block.Utils.isBlock(c)&&!c.hasClass("sqs-destroyme")||!b.Lang.isValue(e))?new b.NodeList(c):new b.NodeList},cleanGrids:function(c){c?b.Lang.isArray(c)||(c=[c]):(c=this.changedLayouts||[],this.changedLayouts=[]);c.forEach(function(b){b.LayoutEditor.cleanGrid()},this)},_enableEditing:function(){b.one("html").addClass("sqs-page-editing")},_disableEditing:function(){b.one("html").removeClass("sqs-page-editing");b.detach("editCtrl|*");this.getLayoutNodes().each(function(c){if(c.hasPlugin(b.Squarespace.Layout.Editor.NS)){var e=
c.LayoutEditor.dragDelegate;e.detach("editCtrl|*");e.dd.detach("editCtrl|*");c.unplug(b.Squarespace.Layout.Editor)}},this)},enableInsertPoints:d,disableInsertPoints:d,alignInsertPoints:d,isMobileApp:function(){return!1},getRenderableBlocks:function(c){c=c.enumName;b.Lang.isValue(this._renderableBlockMap)||this._initRenderableBlocksMap();var e=this._renderableBlockMap[c];if(!b.Lang.isValue(e)){e=this._renderableBlockCtorMap[c];if(!b.Lang.isValue(e))return null;e=this._renderableBlockMap[c]=new e(this.get("childCtorOptions"))}return e},
getInsertMenu:function(c,e){b.Lang.isValue(this._insertMenuMap)||this._initInsertMenuCtorMap();return b.Lang.isValue(e)?this._upsertInsertMenu(c,e):this._insertMenuMap[c.enumName]},_upsertInsertMenu:function(c,e){var d=this._insertMenuMap[c.enumName];if(b.Lang.isValue(d))d.setAttrs(e);else{d=this._insertMenuCtorMap[c.enumName];if(!b.Lang.isValue(d))return null;d=this._insertMenuMap[c.enumName]=new d(b.merge(this.get("childCtorOptions"),e))}return d},_initRenderableBlocksMap:function(){this._renderableBlockCtorMap=
{};this._renderableBlockMap={};b.Array.each(this.get("renderableBlockSet"),function(c){b.Lang.isValue(c.ctor)&&(this._renderableBlockCtorMap[c.editMode.enumName]=c.ctor)},this)},_initInsertMenuCtorMap:function(){this._insertMenuCtorMap={};this._insertMenuMap={};b.Array.each(this.get("insertMenuSet"),function(c){b.Lang.isValue(c.ctor)&&(this._insertMenuCtorMap[c.editMode.enumName]=c.ctor)},this)},_createInsertMarkerInstance:function(c){this._insertMarkerInstance=new b.Squarespace.Layout.InsertMarker(b.merge(this.get("childCtorOptions"),
{render:c}));c.plug(b.Squarespace.NodeDestroyNotifier,{onDestroy:this._destroyInsertMarkerInstance,context:this})},setInsertMarkerLayout:function(b){var e=this._insertMarkerInstance;!e||e&&e.get("destroyed")?this._createInsertMarkerInstance(b):b!==e.get("render")&&(this._destroyInsertMarkerInstance(),this._createInsertMarkerInstance(b))},_destroyInsertMarkerInstance:function(){this._insertMarkerInstance&&(this._insertMarkerInstance.destroy(),delete this._insertMarkerInstance)},alignInsertMarker:function(c){var e=
this._insertMarkerInstance;b.Lang.isObject(c)&&e&&!e.get("locked")&&(e.set("info",c),e.show())},hideInsertMarker:function(){this._insertMarkerInstance&&this._insertMarkerInstance.hide()},toggleInsertMarkerLock:function(b){this._insertMarkerInstance&&this._insertMarkerInstance.set("locked",b)},updateInsertMarkerConstrainNode:function(c){var e=this._insertMarkerInstance;e&&(b.Lang.isValue(c)&&e.set("constrainZIndex",c),e.positionConstrainNode())},destructor:function(){b.one(b.config.doc).detach("editCtrl|*");
this.set("editing",!1);this.destroyLayoutEditor();this._destroyInsertMarkerInstance()}},{ATTRS:{contentParentBlockSelector:{getter:function(c){return!b.Lang.isValue(c)?"":c},setter:function(b,e){var d=this.get(e);return 0===d.length?b:-1<d.indexOf(b)?d:d+", "+b}},editing:{value:!1},scrollNode:{valueFn:function(){return b.one(b.UA.gecko||b.UA.ie?"html":"body")},lazyAdd:!1},dropInfo:{value:{node:null,direction:"",distance:0,quad:null,region:null}},dropBlockInfo:{value:{blockNode:null,ancestors:null,
parentLayout:null}},selection:{},markdownMode:{value:!1},childCtorOptions:{value:{}},forceSingleColumn:{value:!1}}})},"1.0",{requires:"base event json-parse node parallel squarespace-block-utils squarespace-enum-factory squarespace-layout-editor squarespace-models-content-collection squarespace-models-layout squarespace-models-template squarespace-layout-trash squarespace-ui-base".split(" ")});
YUI.add("squarespace-widgets-model-list-search",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.ModelListSearch=b.Base.create("ModelListSearch",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this._textField=new b.Squarespace.DialogFields.Text({name:"searchQuery",className:"thin","strings.placeholder":this.get("strings.placeholder")})},destructor:function(){this._textField.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");
this._textField.render(b);b.append('<div class="search-icon"></div>');this._clearButton=b.appendChild('<div class="clear-button">&times;</div>')},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("models"),e=this._textField,f;e.after("dataChange",function(e){"searchQueryChange"!==e.source&&(f&&f.cancel(),f=b.later(200,this,function(){c.set("searchQuery",e.newVal)}));this.syncUI()},this);c.after("searchQueryChange",function(b){e.set("data",b.newVal,{source:"searchQueryChange"})},this);
this.after("stringsChange",function(){this._textField.set("strings.placeholder",this.get("strings.placeholder"))},this);this._clearButton.on("click",function(){e.set("data",null)})},syncUI:function(){d.superclass.syncUI.call(this);var c=this._textField.get("data"),c=b.Lang.isValue(c)&&""!==c;this.get("contentBox").toggleClass("has-data",c)}},{CSS_PREFIX:"sqs-model-list-search",ATTRS:{models:{valueFn:function(){return new b.Squarespace.Models.ModelList},validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.ModelList),
writeOnce:"initOnly"},strings:{value:{placeholder:"Search"},validator:function(c){return!b.Lang.isObject(c)?(console.error('ModelListHeader: Invalid "strings" attribute. Must be an object.'),!1):!b.Object.hasKey(c,"placeholder")?(console.error('ModelListHeader: Invalid "strings" attribute. Must have key "placeholder".'),!1):!0}}}})},"1.0",{requires:["base","squarespace-attr-validators","squarespace-dialog-text","squarespace-models-model-list","squarespace-ss-widget"]});
YUI.add("squarespace-settings-recycle-bin",function(b){var d=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]),c=b.namespace("Squarespace.Widgets").RecycleBin=b.Base.create("RecycleBin",b.Squarespace.Widgets.SettingsPanel,[b.WidgetParent],{initializer:function(){this._deletedDemoCollectionRecycleBin=this.add({childType:e,data:this.get("data"),itemConfig:{restoreFn:b.Squarespace.RecycleBinUtils.restoreDemoCollection,className:"hide-date"},"strings.header":"Example Pages","strings.emptyMessage":"You do not have any deleted example pages."}).item(0);
this._recycleBin=this.add({childType:e,data:this.get("data"),itemConfig:{restoreFn:b.Squarespace.RecycleBinUtils.restoreCollection},"strings.header":"Deleted Pages","strings.emptyMessage":"You do not have any deleted pages."}).item(0);this.get("menuItemNode").addClass("selected")},destructor:function(){this.get("menuItemNode").removeClass("selected")},renderUI:function(){c.superclass.renderUI.call(this);this.pagination=this._headerTray.add({childType:b.Squarespace.Widgets.Pagination,pageSize:this.get("pageSize"),
filter:this.get("filter"),totalPages:0,currentPage:0}).item(0)},bindUI:function(){c.superclass.bindUI.call(this);this.on("responseDataChange",function(c){b.Lang.isValue(c.newVal.pagination)&&this.pagination.update(c.newVal.pagination)});this.pagination.on("pageRequested",function(b){"previous"==b.direction?this.set("initialSendData.page",this.get("initialSendData.page")-1):"next"==b.direction&&this.set("initialSendData.page",this.get("initialSendData.page")+1);this.scrollToTop();this._loadInitialPanelData(this.get("initialDataUrl"))},
this)},syncUI:function(){c.superclass.syncUI.call(this);this._recycleBin.set("collections",this.get("data.collections"));var e=this.get("data.deletedDemoCollections");this._deletedDemoCollectionRecycleBin.set("collections",e);(!b.Lang.isArray(e)||0<e.length)&&1<this.get("initialSendData.page")?this._deletedDemoCollectionRecycleBin.hide():this._deletedDemoCollectionRecycleBin.show()},scrollToTop:function(){for(var b=this.get("contentBox");b.get("parentNode");){if(0<b.get("scrollTop")){b.anim({scroll:[0,
0]}).run();break}b=b.get("parentNode")}}},{CSS_PREFIX:"sqs-recycle-bin-settings",ATTRS:{strings:{value:{title:"Recycle Bin",description:"Your Recycle Bin lets you restore collections you have deleted in the past.  Collections will stay in the Recycle Bin for 7 days before they are removed by the system."}},menuItemNode:{},buttons:{value:[]},data:{setter:"_setData"},initialDataUrl:{value:"/api/commondata/GetRecentlyDeletedCollections"},initialSendData:{value:{websiteId:d,page:1}}}}),e=b.Base.create("RecycleBinList",
b.Squarespace.SSWidget,[b.WidgetParent,b.WidgetChild],{renderUI:function(){var c=this.get("strings.header");b.Lang.isString(c)&&this.get("contentBox").append('<div class="title">'+c+"</div>");c=this.get("strings.emptyMessage");b.Lang.isString(c)&&this.get("contentBox").append('<div class="empty-message">'+c+"</div>")},bindUI:function(){this.after("collectionsChange",this.syncUI,this)},syncUI:function(){this.removeAll();var c=this.get("itemConfig"),e=this.get("collections");this.get("boundingBox").toggleClass("empty",
!e||0===e.length);b.Array.each(e,function(e){this.add(b.merge({childType:f,collection:e},c))},this)}},{CSS_PREFIX:"sqs-recycle-bin-list",ATTRS:{collections:{},itemConfig:{}}}),f=b.Base.create("RecycleBinItem",b.Squarespace.SSWidget,[b.WidgetChild],{bindUI:function(){f.superclass.bindUI.call(this);this.get("contentBox").delegate("click",function(c){c.halt();(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Restore","strings.title":"Restore Collection","strings.message":"Are you sure you wish to restore this collection?"})).on("confirm",
function(){this.get("contentBox").one(".controls").empty();this.get("contentBox").one(".controls").appendChild(b.Node.create('<div class="status">Restoring...</div>'));this.get("restoreFn")(this.get("collection.id"),function(){var c=b.Squarespace.ContentCollectionCache.getCollectionFromData(this.get("collection")),e=c.get("folder");this.get("contentBox").one(".controls").empty();this.get("contentBox").one(".controls").appendChild(b.Node.create('<div class="status"><span class="restore-msg">Restore successful.</span><span class="button button-edit-page"><a href="#">View</a></span></div>'));
var d={collectionId:c.get("id"),enabled:!0,title:c.get("navigationTitle"),typeName:c.get("typeName"),urlId:c.get("urlId"),collectionType:c.get("type")},c=b.Squarespace.Singletons.Template.get("navigations").getHiddenNavigation(),f=c.get("itemList"),d=f.create(d);d.setNavigationItemList(f);e&&d.get("children").setTemplateNavigation(c)},this)},this)},".button-restore",this);this.get("contentBox").delegate("click",function(c){c.halt();this.get("root").set("selectedCollection",b.Squarespace.ContentCollectionCache.getById(this.get("collection.id")))},
".button-edit-page",this)},_getHBTemplateContext:function(){var c=new b.Squarespace.Models.ContentCollection(this.get("collection")),e=b.Squarespace.Singletons.Template.get("collectionConfigs"),d=c.get("ordering"),f=c.get("type"),p=c.get("folder"),q=c.get("index"),r;for(r in e){var s=e[r];if(f==b.Squarespace.CollectionTypes.PRODUCT&&s.get("collectionType")==b.Squarespace.CollectionTypes.PRODUCT){this.set("collection.typeName",r);c.set("typeName",r);break}if(p&&s.get("folder")){this.set("collection.typeName",
r);c.set("typeName",r);break}if(q&&s.get("index")){this.set("collection.typeName",r);c.set("typeName",r);break}if(d==s.get("ordering")&&f==s.get("collectionType")&&p==s.get("folder")){this.set("collection.typeName",r);c.set("typeName",r);break}}return b.merge(this.get("collection"),{icon:b.Squarespace.ContentCollectionUtils.getIconClassNames(c)})}},{CSS_PREFIX:"sqs-recycle-bin-item",HANDLEBARS_TEMPLATE:"recycle-bin-item.html",ATTRS:{collection:{},restoreFn:{validator:b.Lang.isFunction}}});b.Squarespace.RecycleBinUtils=
{restoreCollection:function(c,e,f){b.Data.post({url:"/api/commondata/RestoreDeletedCollection",data:{websiteId:d,collectionId:c},success:e},f)},restoreDemoCollection:function(c,e,d){b.Data.post({url:"/api/commondata/RestoreDeletedCollectionPointer",data:{collectionId:c},success:e},d)}}},"1.0",{requires:["squarespace-settings-panel","squarespace-recycle-bin-item-template","squarespace-pagination","squarespace-widgets-confirmation"]});
YUI.add("squarespace-stats-block-loading-view",function(b){b.namespace("Squarespace.Views.Stats").BlockLoading=b.Base.create("statsBlockLoadingView",b.Squarespace.View,[],{initializer:function(){},destructor:function(){},render:function(d){var c=this.get("container");c.appendChild(b.Node.create('<div class="spinner"></div><div class="loading-text">Loading</div>'));c.appendTo(d);this._spinner=new b.Squarespace.Spinner({render:c.one(".spinner"),color:"dark"})}})},"1.0",{requires:["base-base","node",
"squarespace-view","squarespace-spinner"]});
YUI.add("squarespace-models-order-list",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.OrderList=b.Base.create("OrderList",b.Squarespace.Models.ModelList,[b.Squarespace.Mixins.PaginatedModelList,b.Squarespace.Mixins.SearchableModelList],{model:b.Squarespace.Models.Order,root:b.Squarespace.API_ROOT+"commerce/orders",url:b.Squarespace.API_ROOT+"commerce/orders?state={state}&resolved={resolved}",print:function(){window.open(b.Lang.sub("{urlBase}?ids={ids}&crumb={crumb}",{urlBase:this.root+
"/print",ids:this._getIds().join(","),crumb:b.Cookie.get("crumb")}))},markShipped:function(d,c){b.Data.put({headers:{"Content-Type":"application/json"},url:this.root+"/mark-shipped",data:b.JSON.stringify({ids:this._getIds(),sendNotification:d}),success:function(){this.each(function(c){c.set("state",b.Squarespace.OrderStates.SHIPPED)});c&&c.call(this)},failure:function(b){c&&c.call(this,b)}},this)},markPending:function(d){b.Data.put({headers:{"Content-Type":"application/json"},url:this.root+"/mark-pending",
data:b.JSON.stringify({ids:this._getIds()}),success:function(){this.each(function(c){c.set("state",b.Squarespace.OrderStates.PENDING)});d&&d.call(this)},failure:function(b){d&&d.call(this,b)}},this)},_getIds:function(){return this.map(function(b){return b.get("id")})}},{deleteAllTestOrders:function(d){b.Data.del({url:b.Squarespace.API_ROOT+"commerce/orders/test",success:function(){d&&d.call(this)},failure:function(b){d&&d.call(this,b)}},this)},ATTRS:{state:{value:b.Squarespace.OrderStates.PENDING,
validator:function(d){if(b.Object.hasValue(b.Squarespace.OrderStates,d))return!0;console.error("OrderList: Invalid state.");return!1}},resolved:{value:"false",validator:b.Squarespace.AttrValidators.isString},rangePaginator:{valueFn:function(){return new b.Squarespace.Models.RangePaginator({models:this,orderBy:"submittedOn"})},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.RangePaginator)},offsetPaginator:{valueFn:function(){return new b.Squarespace.Models.OffsetPaginator({models:this,
orderBy:"submittedOn"})},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.OffsetPaginator)},paginator:{getter:function(){var d=this.get("searchQuery");return b.Lang.isValue(d)&&""!==d?this.get("offsetPaginator"):this.get("rangePaginator")}}}})},"1.0",{requires:"base cookie json squarespace-attr-validators squarespace-enum squarespace-mixins-paginated-model-list squarespace-mixins-searchable-model-list squarespace-model-sync-rest squarespace-models-model-list squarespace-models-offset-paginator squarespace-models-order squarespace-models-range-paginator squarespace-util".split(" ")});
YUI.add("squarespace-models-site-user-group-list",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.SiteUserGroupList=b.Base.create("SiteUserGroupList",b.Squarespace.Models.ModelList,[b.Squarespace.Mixins.PaginatedModelList],{model:b.Squarespace.Models.SiteUserGroup,url:"/api/site-user-groups/"},{ATTRS:{paginator:{valueFn:function(){return new b.Squarespace.Models.RangePaginator({models:this,orderBy:"name"})}}}})},"1.0",{requires:["base","squarespace-mixins-paginated-model-list",
"squarespace-models-model-list","squarespace-models-range-paginator","squarespace-models-site-user-group"]});
YUI.add("squarespace-models-google-apps-user-list",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.GoogleAppsUserList=b.Base.create("GoogleAppsUserList",b.Squarespace.Models.ModelList,[b.Squarespace.Mixins.PaginatedModelList],{url:"/api/google-apps/{domain}/users?email={email}",model:b.Squarespace.Models.GoogleAppsUser,initializer:function(){this.on("reset",function(c){b.Array.each(c.models,this._syncToDomain,this)},this);this.on("add",function(b){this._syncToDomain(b.model)},
this)},create:function(c,e,f){c instanceof b.Model||(c.domain=this.get("domain"));return d.superclass.create.call(this,c,e,f)},_syncToDomain:function(b){b.set("domain",this.get("domain"))},parse:function(){var c=d.superclass.parse.apply(this,arguments);return b.Array.map(c,function(c){b.Lang.isNumber(c.lastLogin)&&(c.lastLogin=new Date(c.lastLogin));return c})}},{ATTRS:{domain:{validator:b.Squarespace.AttrValidators.isString},email:{value:"",validator:b.Squarespace.AttrValidators.isNullOrString},
paginator:{valueFn:function(){return new b.Squarespace.Models.TokenPaginator({models:this,limit:20})}}}})},"1.0",{requires:"base model-list squarespace-attr-validators squarespace-models-google-apps-user squarespace-models-model-list squarespace-model-list-parse squarespace-model-sync-rest squarespace-models-token-paginator".split(" ")});
YUI.add("squarespace-settings-activity-detailed-activity",function(b){b.namespace("Squarespace.Settings.Activity");var d=b.Squarespace.Settings.Activity.DetailedActivity=b.Base.create("ActivityManagerDetailedActivity",b.Squarespace.Settings.Activity.BaseManager,[b.Squarespace.Settings.Activity.MixinSpinnerfied],{renderUI:function(){d.superclass.renderUI.call(this);this._addSearchLink()},_isDataEmpty:function(c){return!b.Lang.isArray(c.hits)||0===c.hits.length},_renderSuccess:function(c){b.Object.hasKey(c,
"lastId")&&this.set("detailedActivityLastId",c.lastId);var e=this.get("contentBody"),d=b.Node.create('<div class="detail allactivity">'),g=b.Node.create('<div class="table"><div class="head"><div class="row clear"><div class="detail cell first-column data">Time</div><div class="detail cell">Visitor</div><div class="detail cell">Page Title</div></div></div></div>');d.append(g);e.append(d);this.visitors=[];e=b.bind(this._formatForAccordion,this);this.accordion=new b.Squarespace.Accordion;this.accordion.add(c.hits.map(e));
this.accordion.render(g);c.hasMoreRecords&&this._initMoreRecordsLoading(c)},_addSearchLink:function(){var c=b.Node.create('<div class="view-period-container">'),e=b.Node.create('<a class="view-period clean"><img src="/universal/images-v6/configuration/stats-search-queries.png"></a>'),d=this._headerTray.get("contentBox");e.on("click",function(){this.showActivitySearchDialog(e)},this);c.append(e);d.append(c)},_initMoreRecordsLoading:function(c){c=b.Node.create('<div class="load-more">');var e=b.Node.create('<div class="statistics-load-more-btn">Load More</div>');
e.on("click",this._loadMoreRecords,this);c.append(e);this.get("contentBody").append(c)},_formatForAccordion:function(c,e){var d=this.formatTargetName(c.targetName),g=c.accessOnShort.split("at"),h=g[0].trim(),k=g[1].trim(),g=b.Node.create('<div class="accordion-container">'),l=b.Node.create('<div class="accordion-header">'),p=b.Node.create('<div class="accordion-body">'),q=this.get("contentBox").one(".table"),r=b.Node.create('<div class="body"></div>'),s=b.Node.create('<div style="cursor: pointer;" class="row clear"></div>'),
h=b.Node.create('<div class="first-column cell detail">'+h+'<span class="small-time">'+k+"</span></div>"),k=b.Node.create('<div class="cell detail"></div>'),d=b.Node.create('<div class="cell detail">'+d+"</div>"),t=b.Node.create('<span class="statistics-visitor-info">'+c.ipAddress+"</span>");t.setData({hit:c});this.visitors.push(t);k.append(t);s.append(h).append(k).append(d);r.append(s).append('<div class="clear">');q.append(r);q=this._addSubRow(c,e);p.append(q);l.append(r);g.append(l);g.append(p);
return g},_addSubRow:function(c,e){var d=b.Node.create('<div class="detail-sub-body" id="visitBody-'+e+'"></div>'),g=this.getDetailEl("Hostname:",c.hostname),g=b.Node.create('<div class="cell first-column">'+g+"</div>"),h=b.Node.create('<div class="cell">'+this.getDetailEl("Tags:",c.tag)+"</div>"),k=b.Node.create('<div class="cell"></div>');k.append(this.getHitEl(c));var l=b.Node.create('<div class="row pad clear"></div>');l.append(g).append(h).append(k);g.append(this.getDetailEl("Country:",c.country));
h.append(this.getDetailEl("Referrer:",this.trimEnd(c.referrer)));d.append(l);return d},_loadMoreRecords:function(c){b.bind(this._formatForAccordion,this);this.get("contentLoading")||(this.set("page",this.get("page")+1),this.set("contentLoading",!0),b.Data.get({url:this.get("url"),data:this.get("requestParams"),success:this._renderMoreRecords},this))},_renderMoreRecords:function(c){b.Object.hasKey(c,"lastId")&&this.set("detailedActivityLastId",c.lastId);this.set("contentLoading",!1);if(!c.hasMoreRecords){var e=
b.one(".statistics-load-more-btn"),d=e.getXY(),g=e.cloneNode(!0),h=b.one(".load-more"),k=this.get("boundingBox").one(".detail .table");k.setStyles({"z-index":200,position:"absolute"});b.one("body").append(g);g.setStyles({"z-index":1,left:d[0],top:d[1],position:"absolute"});d=new b.Anim({node:g,duration:0.3,easing:b.Easing.easeOutStrong,to:{opacity:0}});d.on("end",function(){k.setStyles({"z-index":null,position:null});g.remove(!0)});d.run();h.remove(!0);e.remove(!0)}e=b.bind(this._formatForAccordion,
this);this.accordion.add(c.hits.map(e))},formatTargetName:function(b){b=this.parseTargetName(b);return b.title+(""!==b.collectionType?" ("+b.collectionType+")":"")},showActivitySearchDialog:function(c){this.get("dialog")||(c=new b.Squarespace.EditingDialog({sitleTitle:"Search",savingText:"Searching...",width:340,style:"flyout",anchor:c,overlay:0.5,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Reset"},{type:"saveAndClose",title:"Search"}],initialData:this.get("searchDialogData"),primaryTabs:[{title:"Search Activity Log",
icon:"/universal/images-v6/configuration/stats-search-queries-white.png",scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"visitor","strings.title":"Visitor Filter"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"activity","strings.title":"Activity Filter"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"referrer","strings.title":"Referrer Filter"}},{ctor:b.Squarespace.DialogFields.Stateflow,config:{width:0.5,direction:"up",style:"major",name:"startDate",defaultValue:"",
states:{any:{title:"Any Start Date",optionDesc:"",stateDesc:"Any start date."},after:{title:"After Date",optionDesc:"Begin date.",stateDesc:"After [DATE]."}},stateOrder:["any","after"]}},{ctor:b.Squarespace.DialogFields.Stateflow,width:0.5,direction:"up",style:"major",name:"endDate",defaultValue:"",states:{now:{title:"Now",optionDesc:"Before now.",stateDesc:"Before now."},before:{title:"Before Date",optionDesc:"End Date.",stateDesc:"Before [DATE]."}},stateOrder:["now","before"]}]}]}),this.set("dialog",
c),this._bindDialogEvents(c),c.show())},_bindDialogEvents:function(b){b.on("send-requested",function(){var e=b.getData(),d={visitorFilter:e.visitor,activityFilter:e.activity,referrerFilter:e.referrer};this.set("searchDialogData",e);"after"===e.startDate.state&&(d.startDate=e.startDate.date);"before"===e.endDate.state&&(d.endDate=e.endDate.date);this.set("searchParams",d);this.set("page",1);this.get("dialog").close();this.requestData();this.syncUI()},this);b.on("remove-requested",function(){this.set("searchDialogData",
{});this.get("dialog").setData({});this.requestData()},this);b.on("cancel",function(){b.destroy();this.set("dialog",null)},this);b.on("close",function(){this.set("dialog",null)},this)},getBrowserIcon:function(c){var e={chrome:b.Node.create('<img src="/universal/images-v6/configuration/stats-chrome.png">'),firefox:b.Node.create('<img src="/universal/images-v6/configuration/stats-firefox.png">'),explorer:b.Node.create('<img src="/universal/images-v6/configuration/stats-explorer.png">'),safari:b.Node.create('<img src="/universal/images-v6/configuration/stats-safari.png">')};
return this._getIcon(c.toLowerCase(),e)},getOSIcon:function(c){var e={windows:b.Node.create('<img src="/universal/images-v6/configuration/stats-windows.png">'),macosx:b.Node.create('<img src="/universal/images-v6/configuration/stats-apple.png">'),linux:b.Node.create('<img src="/universal/images-v6/configuration/stats-linux.png">')};return this._getIcon(c.toLowerCase(),e)},_getIcon:function(c,e){var d=b.Array.find(b.Object.keys(e),function(b){return-1!==c.indexOf(b)});return d?e[d].cloneNode():null},
getHitEl:function(c){var e=this.getBrowserIcon(c.browser),d=this.getOSIcon(c.os),g=b.Node.create('<div class="detail-small"><div>');g.append(d).append(e).append("<div>"+c.userAgent+"</div>");return g},getDetailEl:function(c,e){return b.Lang.sub('<div class="item-box"><div>{title}</div><div class="detail">{detail}</div></div>',{title:c,detail:""===e||!e?"-":e})}},{CSS_PREFIX:"sqs-activity-manager-detailed-activity",ATTRS:{activeTab:{value:"week"},detailedActivityLastId:{value:null},page:{value:0},
searchDialogData:{value:{}},searchParams:{value:{}},strings:{value:{title:"Detailed Activity"}},requestParams:{getter:function(){var b=this.get("searchParams");this.get("activeTab");b={name:"details",page:this.get("page"),visitFilter:b.visitorFilter,activityFilter:b.activityFilter,referrerFilter:b.referrerFilter,startDate:b.startDate,verbose:!1,endDate:b.endDate};this.get("detailedActivityLastId")&&(b.lastId=this.get("detailedActivityLastId"));return b}},tabs:{value:[]}}})},"1.0",{requires:["base",
"squarespace-settings-activity-base-manager","squarespace-settings-activity-mixin-spinnerfied"]});
YUI.add("squarespace-dd-behaviors",function(b){function d(c,e,d){for(var f=c.get("parentNode").get("children"),g=f.indexOf(c),r=f.indexOf(e),s=Math.min(g,r),g=Math.max(g,r),r=function(){b.DD.DDM.syncActiveShims(!0)},t=s;t<=g;t++)f.item(t).plug(b.Squarespace.PositionAnimator,{releasedFn:r}),f.item(t).positionAnimator.hold();c.insert(e,d);for(c=s;c<=g;c++)f.item(c).hasClass("dd-drag-group")||f.item(c).positionAnimator.release(!0)}function c(c,e,f){e.each(function(b){b.setStyles({position:null,top:null,
left:null})});e=e._nodes;d(c,b.one(e[0]),f);for(c=1;c<e.length;c++)d(b.one(e[c-1]),b.one(e[c]),f)}b.namespace("Squarespace");b.mix(b.DD.DDM,{_pg_size:function(){if(this.activeDrag){var c=b.one(document.documentElement),e=Math.max(c.get("scrollHeight"),c.get("docHeight")),c=Math.max(c.get("scrollWidth"),c.get("docWidth"));this._pg.setStyles({position:"fixed",height:e+"px",width:c+"px"})}},_move:function(b){this.activeDrag&&!1===this.activeDrag.get("lock")&&(this.activeDrag._move.call(this.activeDrag,
b),this._dropMove())}},!0);var e=b.clone(b.DD.Drop.prototype._createShim);b.DD.Drop.prototype._createShim=function(){null!==this.get("node")._node&&b.Env&&e.call(this)};var f=b.clone(b.DD.Drag.prototype._unprep);b.mix(b.DD.Drag.prototype,{_prep:function(){this._dragThreshMet=!1;var c=this.get("node");c.addClass(b.DD.DDM.CSS_PREFIX+"-draggable");if(!this.get("dragDelegate"))c.on(b.DD.Drag.START_EVENT,b.bind(this._handleMouseDownEvent,this));c.on("mouseup",b.bind(this._handleMouseUp,this));c.on("dragstart",
b.bind(this._fixDragStart,this))},_unprep:function(){null!==this.get("node")._node&&f.call(this)},start:function(){var c=b.DD.DDM;if(!this.get("lock")&&!this.get("dragging")){var e=this.get("node"),d;this._startTime=(new Date).getTime();c._start();e.addClass(c.CSS_PREFIX+"-dragging");this.fire("drag:start",{pageX:this.nodeXY[0],pageY:this.nodeXY[1],startTime:this._startTime});e=this.get("dragNode");this.proxy&&(this.get("node").removeClass(c.CSS_PREFIX+"-dragging"),e.addClass(c.CSS_PREFIX+"-dragging"));
d=this.nodeXY;c=e.get("offsetWidth");e=e.get("offsetHeight");this.get("startCentered")&&this._setStartPosition([d[0]+c/2,d[1]+e/2]);this.region={0:d[0],1:d[1],area:0,top:d[1],right:d[0]+c,bottom:d[1]+e,left:d[0]};this.set("dragging",!0)}return this},_defMouseDownFn:function(c){c=c.ev;this._dragThreshMet=!1;this._ev_md=c;if(this.get("primaryButtonOnly")&&1<c.button)return!1;if(this.validClick(c)&&(this._fixIEMouseDown(c),0!==b.DD.Drag.START_EVENT.indexOf("gesture")&&(this.get("haltDown")?c.halt():
c.preventDefault()),this._setStartPosition([c.pageX,c.pageY]),b.DD.DDM.activeDrag=this,this.get("clickTimeThresh")||!this.get("clickPixelThresh")))this._clickTimeout=b.later(this.get("clickTimeThresh"),this,this._timeoutCheck);this.fire("drag:afterMouseDown",{ev:c})}},!0);var g=b.clone(b.DD.Delegate.prototype.initializer);b.mix(b.DD.Delegate.prototype,{initializer:function(){var c=this.get("container");!(c instanceof b.Node)&&b.Lang.isFunction(c.getDOMNode)&&this.set("container",b.Node(c.getDOMNode()));
g.apply(this,arguments);this.get("clickTimeThresh")&&this.dd.set("clickTimeThresh",this.get("clickTimeThresh"));this.get("clickPixelThresh")&&this.dd.set("clickPixelThresh",this.get("clickPixelThresh"));this.dd.set("dragDelegate",this)}},!0);b.Squarespace.DDBaseBehavior=b.Base.create("DDBaseBehavior",b.Plugin.Base,[],{initializer:function(){var b=this.get("host");b.on("drag:start",this.start,this);b.on("drag:drag",this.drag,this);b.on("drag:end",this.end,this);b.on("drag:enter",this.enter,this)},
start:function(){},drag:function(){},end:function(){},enter:function(){}});b.Squarespace.DDDragGrouping=b.Base.create("DDDragGrouping",b.Squarespace.DDBaseBehavior,[],{initializer:function(){this.get("host").plug(b.Squarespace.Plugin.DDSuperProxy,{movingClass:this.get("movingClass")})},start:function(b){var c=this._getNodesSelected();1<=c.size()&&(this._nodesSelectedCache=c,this._initialGrouping(b.target.get("dragNode")))},_initialGrouping:function(c){c.get("region");this._nodesSelectedCache.each(function(c,
e){c.addClass("dd-drag-group");b.DD.DDM.syncActiveShims(!0)},this);c.appendChild('<div class="sqs-multidrag-count">'+(this._nodesSelectedCache.size()+1)+"</div>")},end:function(e){if(this._nodesSelectedCache){this._nodesSelectedCache.each(function(b){b.removeClass("dd-drag-group")});c(e.target.get("node"),this._nodesSelectedCache,"after");this._nodesSelectedCache=null;var d=b.one(this.get("container")).all(this.get("nodes")).indexOf(e.target.get("node"));this._startIndex!==d&&this.fire("group-reordered",
{node:e.target.get("node"),oldIndex:this._startIndex,newIndex:d})}},_getNodesSelected:function(){return this.get("container").all(this.get("multiSelectNodes")).filter(":not(.yui3-dd-dragging)").filter(":not(."+this.get("cloneClass")+")")}},{NS:"dragGrouping",ATTRS:{container:{},nodes:{},multiSelectNodes:{},movingClass:{value:"yui3-dd-super-proxy-moving"},cloneClass:{value:"yui3-dd-super-proxy-clone"}}});b.Squarespace.DDReorder=b.Base.create("DDReorder",b.Squarespace.DDBaseBehavior,[],{initializer:function(){this.get("host").plug(b.Squarespace.Plugin.DDSuperProxy,
{movingClass:this.get("movingClass"),cloneClass:this.get("cloneClass")})},start:function(c){this._startIndex=b.one(this.get("container")).all(this.get("nodes")).indexOf(c.target.get("node"))},enter:function(c){var e=c.drag.get("node");c=c.drop.get("node");var f=this.get("container");!c.hasClass("selected")&&(f.contains(e)&&f.contains(c))&&(f=b.one(f).all(this.get("nodes")),f=f.indexOf(e)>f.indexOf(c)?"before":"after",d(c,e,f))},end:function(c){var e=b.one(this.get("container")).all(this.get("nodes")).indexOf(c.target.get("node"));
this._startIndex!==e&&this.fire("reordered",{node:c.target.get("node"),oldIndex:this._startIndex,newIndex:e});delete this._nodes;delete this._startIndex}},{NS:"ddreorder",ATTRS:{container:{},nodes:{},movingClass:{value:"yui3-dd-super-proxy-moving"},cloneClass:{value:"yui3-dd-super-proxy-clone"},multiSelectNodes:{}}})},"1.0",{requires:["oop","dd","dd-scroll","plugin","squarespace-dd-superproxy"]});
YUI.add("squarespace-block-code-editor",function(b){b.namespace("Squarespace.Block.Editor").Code=b.Base.create("code-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(){this.afterHostMethod("_setWidgetContent",this._afterSetContent,this)},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Code")},_afterSetContent:function(){this._cb.all('img,frame,iframe,object,video,audio,embed,svg,input[type="image"],map').each(function(b){this._handles.push(b.on("load",
this._fireContentUpdate,this))},this)},_fireContentUpdate:function(){this._host.fire("widget:contentUpdate")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Code"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Code=b.Base.create("block-code-editor",b.Squarespace.ModelEditorDialog,[],{sanitizeDialogData:function(c){if(c.wysiwyg&&c.wysiwyg.wysiwyg){var e=c.text||"";c=c.wysiwyg;c.text=e;delete c.id;return c}!c.wysiwyg.isSource&&("htmlmixed"===c.wysiwyg.mode||"html"===c.wysiwyg.mode)?(c.html=c.wysiwyg.source,
c.wysiwyg.source=""):b.Lang.isUndefined(c.wysiwyg.rendered)||(c.html=c.wysiwyg.rendered);delete c.wysiwyg.rendered;return c},getDialogData:function(){var b=this.get("model").toJSON();return{text:b.source,wysiwyg:b}}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:575,height:318,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Code",icon:"/universal/images-v6/icons/icon-code-16-light.png",fields:[{type:"wysiwyg",
height:250,width:525,countHeight:!0,name:"wysiwyg",title:"HACK THE PLANET",titleStyle:"inline",engine:"code",menuConfig:"code"}]}]}},"1.0",{requires:["squarespace-block-editor-dialog","squarespace-damask-context-globals","squarespace-wysiwyg"]});
YUI.add("squarespace-dialog-suffix-text",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.SuffixText=b.Base.create("dialogSuffixText",b.Squarespace.DialogFields.AffixText,[],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox").one(".fields");this._textField.render(b);this._selectField.render(b)},_affix:function(b,e){return b+e},_chompAffix:function(b,e){return b.slice(0,b.length-e.length)},_getMatchingAffix:function(c){return b.Array.find(this.get("affixes"),
String.prototype.endsWith,c)}},{CSS_PREFIX:"sqs-dialog-suffix-text"})},"1.0",{requires:["base","squarespace-dialog-affix-text"]});
YUI.add("squarespace-block-donation-editor",function(b){b.namespace("Squarespace.Block.Editor").Donation=b.Base.create("donation-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Donation")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Donation"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Donation=b.Base.create("blockDonationEditor",b.Squarespace.ModelEditorDialog,
[],{initializer:function(){this.plug(b.Squarespace.ModelEditorPlugins.LoadBeforeShowing)}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={name:"editDonationBlock",width:440,height:440,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],primaryTabs:[{title:"Edit Donation",tabTitle:"Description",icon:"/universal/images-v6/icons/icon-donation-18-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{className:"description",
content:'<div class="description-label">Donations</div>This donation button will take visitors to a page where they can make a contribution to your cause. You can view and manage donations in the Commerce section of your site manager.'}},{ctor:b.Squarespace.DialogFields.Text,name:"title",config:{className:"thin","strings.title":"Title","strings.placeholder":'e.g. "The Squarespace Education Fund"',"strings.description":"The title of the cause or program appears on the Donate page as well as in the in the Thank You email to donors."}},
{ctor:b.Squarespace.DialogFields.TextArea,name:"description",config:{"strings.title":"Short Description","strings.placeholder":"e.g. 100% of every donation goes directly to programming. We deeply appreciate your support!","strings.description":"This text appears on the Donate page beneath the title and can be used to give context to donors."}},{ctor:b.Squarespace.DialogFields.Text,name:"buttonLabel",config:{className:"thin",defaultValue:"Donate","strings.title":"Custom Button Label","strings.placeholder":'The label on the button, e.g. "Donate"',
"strings.description":"You can customize the call to action of the button."}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Button Alignment",name:"buttonAlignment",defaultValue:"left",className:"thin dark",options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]}}]},{tabTitle:"Amounts",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.LabelledValueTable,name:"suggestedContributions",config:{"strings.title":"Suggested Contribution Amounts",
"strings.description":"Squarespace recommends the below suggested amounts. You have the option to label these amounts: e.g. \u201cGold Sponsor\u201d or \u201cFeeds 10 cats\u201d. Donors will also be able to enter their own amount.","strings.valueLabel":"Amount","strings.labelLabel":"Label (optional)","strings.emptyMessage":"No suggested contributions. Visitors can enter any amount.",valueKey:"amountCents",labelKey:"label",valueInputPlugin:b.Squarespace.Plugin.MoneyFormatter}}]},{tabTitle:"Additional",
scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"formBuilderTitle",className:"description",content:'<div class="description-label">Additional Information</div> Prompt your donors to submit additional information as they make a contribution. (e.g. you can provide the option to make a donation in honor of someone or choose a gift as a thank you for their donation)'}},{ctor:b.Squarespace.DialogFields.FormBuilder,config:{name:"customForm"}}]}]}},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-damask-context-globals squarespace-dialog-html squarespace-dialog-text squarespace-dialog-text-area squarespace-dialog-labelled-value-table squarespace-dialog-form-builder".split(" ")});
YUI.add("squarespace-widgets-google-apps-user",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.GoogleAppsUser=b.Base.create("googleAppsUser",b.Squarespace.Widgets.Model,[],{initializer:function(c){if(!b.Lang.isValue(c.model))throw"A model must be provided to render a GoogleAppsUser.";},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox");b.delegate("click",this._doPasswordResetFlow,".reset-password",this);b.delegate("click",this._doInvitationResendFlow,
".re-send-invitation",this)},renderUI:function(){},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("className"),e=this.get("boundingBox");e.addClass(c);this.get("contentBox").setContent(this.renderTemplate());var c=this.get("model").get("iconUrl"),e=e.one(".icon"),f=null;b.Lang.isString(c)&&(f='url("'+c+'")');e.setStyle("background-image",f)},_doPasswordResetFlow:function(){var c=this._getPasswordResetDialogConfig();b.Squarespace.Promises.submitDialog(c,function(b){return this._resetPassword(b.recipient)},
this).then(b.Squarespace.Fluent.Information({"strings.title":"Password Reset","strings.message":"This user's password has been reset. They will be notified at the email address you provided."}))},_doInvitationResendFlow:function(){var c=this._getResendInvitationDialogConfig();b.Squarespace.Promises.submitDialog(c,function(b){return this._resendInvitation(b.recipient)},this).then(b.Squarespace.Fluent.Information({"strings.title":"Invitation Sent","strings.message":"This user has been sent an invitation to Google Apps."}))},
_getRecipientDialogConfig:function(c){return{name:"googleAppsResetRecipient",closeOthers:!1,overlay:0,style:"flyout",width:400,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:c.submitLabel}],tabs:[{title:c.title,icon:"/universal/images-v6/icons/icon-domains-18-light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"recipient","strings.placeholder":"name@example.com","strings.description":"Who should receive the email with the temporary password?",submitOnEnter:!0}}]}]}},
_getPasswordResetDialogConfig:function(){return this._getRecipientDialogConfig({title:"Reset Password",submitLabel:"Reset Password"})},_getResendInvitationDialogConfig:function(){return this._getRecipientDialogConfig({title:"Send Invitation",submitLabel:"Send Invitation"})},_resetPassword:function(b){return this.get("model").resetPassword(b)},_resendInvitation:function(b){return this.get("model").resendInvitation(b)}},{CSS_PREFIX:"sqs-google-apps-user",HANDLEBARS_TEMPLATE:"widgets-google-apps-user.html",
ATTRS:{model:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.GoogleAppsUser)}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-models-google-apps-user squarespace-dialog-promises squarespace-promises squarespace-widgets-google-apps-user-template squarespace-widgets-model".split(" ")});
YUI.add("squarespace-member-select-dialog",function(b){b.namespace("Squarespace").MemberSelectDialog=b.Base.create("MemberSelectDialog",b.Base,[],{initializer:function(d){var c={style:"flyout",name:"changeAuthor",closeOthers:!1,overlay:0.5,width:400,top:100,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:this.get("saveButtonText")}],tabs:[{title:this.get("title"),icon:this.get("icon"),fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:this.get("description")}},
{ctor:b.Squarespace.DialogFields.Select,config:{"strings.placeholder":this.get("selectPlaceholder"),name:"member",className:"thin"}}]}]};this._dialog=new b.Squarespace.EditingDialog(b.merge(c,d));this._dialog.on("send-requested",this._onSendRequested,this)},show:function(){this._dialog.show();this._dialog.showSaveOverlay();this._loadMemberData()},_onSendRequested:function(){var d=this._dialog.getField("member"),c=d.get("data");!b.Lang.isString(c)||0>=c.length?(d.showError(this.get("didntSelectError")),
this.allowEditing()):(this.get("memberPermissionsList").some(function(b){b.get("memberAccountId")===c&&(this.set("selectedMemberPermission",b),this.set("selectedMember",b.get("memberAccount")))},this),this.get("showConfirmation")?this._showConfirmation():this._fireMemberChosen())},_showConfirmation:function(){var d=new b.Squarespace.Widgets.Confirmation({"strings.title":this.get("confirmationText.title"),"strings.message":this.get("confirmationText.body")});d.on("confirm",this._fireMemberChosen,this);
d.on("cancel",this.allowEditing,this)},_loadMemberData:function(){this._dialog.updateTitle(b.Squarespace.DialogStates.LOADING);if(b.Lang.isValue(this.get("memberPermissionsList")))this._processMemberData(),this._dialog.hideSaveOverlay();else var d=(new b.Squarespace.Models.MemberPermissionList).load(b.bind(function(){this.set("memberPermissionsList",d);this._processMemberData();this._dialog.hideSaveOverlay()},this))},_processMemberData:function(){var d=this.get("memberPermissionsList").filter(this.get("filter"));
0===d.length?(new b.Squarespace.Widgets.Alert({"strings.title":this.get("noOptionsErrorText.title"),"strings.message":this.get("noOptionsErrorText.body")}),this.close()):(d=b.Array.map(d,function(c){var e=c.get("memberAccount"),d=e.get("email"),d=c.get("memberAccount").get("pseudonymAccount")?"":d?"("+d+")":"( - )";return{value:c.get("memberAccountId"),label:b.Lang.sub("{displayName} {displayEmail}",{displayName:b.Escape.html(e.get("displayName")),displayEmail:d})}}),this._dialog.getField("member").set("options",
d))},close:function(){this._dialog.close()},allowEditing:function(){this._dialog.allowEditing()},_fireMemberChosen:function(){this.fire("member-chosen",{memberAccount:this.get("selectedMember"),memberPermission:this.get("selectedMemberPermission")})}},{ATTRS:{title:{validator:b.Lang.isString,writeOnce:"initOnly"},description:{validator:b.Lang.isString,writeOnce:"initOnly"},didntSelectError:{validator:b.Lang.isString,value:"You must make a selection."},saveButtonText:{validator:b.Lang.isString,writeOnce:"initOnly",
value:"Select"},noOptionsErrorText:{validator:function(d){return b.Array.every(b.Object.values(d),b.Lang.isString)},value:{title:"Error",body:"There are no members from which to choose."}},icon:{validator:b.Lang.isString,writeOnce:"initOnly"},selectPlaceholder:{validator:b.Lang.isString,writeOnce:"initOnly",value:"Choose a Member"},confirmationText:{validator:function(d){return b.Array.every(b.Object.values(d),b.Lang.isString)},value:{title:"Are you sure?",body:""}},showConfirmation:{value:!0},memberPermissionsList:{value:null},
selectedMember:{},selectedMemberPermission:{},filter:{validator:b.Lang.isFunction,value:function(){return!0}}}})},"1.0",{requires:"base squarespace-dialog squarespace-dialog-description squarespace-dialog-select squarespace-models-member-permission squarespace-ui-base squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-tumblr-connected-account-editor",function(b){b.namespace("Squarespace").TumblrAccountEditor=b.Base.create("tumblrAccountEditor",b.Squarespace.ModelEditorDialog,[],{sanitizeDialogData:function(d){d.metaData.primaryBlog=d.primaryBlog;b.Array.each(d.metaData.blogs,function(b){b.primary=d.primaryBlog===b.name});return d},getDialogData:function(){var d=b.Squarespace.TumblrAccountEditor.superclass.getDialogData.call(this);d.primaryBlog=d.metaData.primaryBlog;return d}})},"1.0",{requires:["base",
"squarespace-model-editor"]});
YUI.add("squarespace-dialog-pre-submit-builder",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.PreSubmitBuilder=b.Base.create("PreSubmitBuilder",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(){this._edited=!1},destructor:function(){this._ddDelegate&&this._ddDelegate.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox"),e=this.get("isSubTopics")?"Add Subtopic":"Add Topic";this._topicWrapper=b.appendChild('<div class="topics-wrapper"></div>');
this._topicContainer=this._topicWrapper.appendChild('<div class="topics"></div>');this._addTopicButton=b.appendChild('<div class="add-topic"><div class="add-icon"></div><div class="add-text">'+e+"</div></div>");this._setupDragAndDrop()},bindUI:function(){d.superclass.bindUI.call(this);var b=["add","remove","*:change"];this.after("dataChange",function(e){var d=this.get("data");e.noSyncUI||(this._registerEvent(d.on(b,function(){this.fire("dataChange",{noSyncUI:!0});this._edited=!0},this)),this._registerEvent(d.after("add",
function(b){b.onReorder||this._addTopicWidget(b.model)},this)))});this._addTopicButton.on("click",this._addTopicModel,this);this.on("*:titleFieldEnter",function(b){this._editOrAddNextTopic(b.target)},this);this.on("*:editingChange",function(b){b.newVal&&this.closeChildren(b.target)},this);this.on("*:removeClicked",function(b){this._confirmAndRemoveTopic(b.target.get("topic"))},this);this.on("*:destroy",function(){this._ddDelegate.syncTargets()},this);this._ddReorder.after("reordered",function(b){this._reorderTopic(b.oldIndex,
b.newIndex)},this)},syncUI:function(){d.superclass.syncUI.call(this);this.removeAll().each(function(b){b.destroy()});var c=this._topicContainer,e=this.get("isSubTopics");this.get("data").each(function(d){this.add(new b.Squarespace.FormPreSubmitTopic({render:c,topic:d,isSubTopic:e}))},this)},didDataChange:function(){return this._edited},closeChildren:function(c){var e=b.Lang.isValue(c);this.each(function(b){b.get("editing")&&(!e||b!==c)&&b.closeEdit()})},_addTopicModel:function(){this.get("data").add(new b.Squarespace.Models.FormPreSubmitTopic({title:this.get("isSubTopics")?
"New Subtopic":"New Topic"}))},_addTopicWidget:function(c){this.add(new b.Squarespace.FormPreSubmitTopic({render:this._topicContainer,topic:c,isSubTopic:this.get("isSubTopics")})).item(0).focusAndSelect();this._ddDelegate.syncTargets()},_confirmAndRemoveTopic:function(c){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Topic","strings.message":"Are you sure you wish to remove this topic?"})).on("confirm",function(){c.destroy()},this)},_editOrAddNextTopic:function(b){b=b.next();this.closeChildren();
b?b.focusAndSelect():this._addTopicModel()},_setupDragAndDrop:function(){var c=this._topicWrapper,e="#"+this._topicContainer.generateID()+" > .sqs-form-pre-submit-topic:not(.yui3-dd-super-proxy-clone)",d=(this._ddDelegate=new b.DD.Delegate({container:c,nodes:e,handles:[e+" > .sqs-form-pre-submit-topic-content > .topic-control-bar > .topic-drag-handle-wrapper"],target:!0})).dd;d.set("groups",[this.get("id")]);this._ddReorder=d.plug(b.Squarespace.DDReorder,{container:c,nodes:e}).ddreorder;d.plug(b.Plugin.DDConstrained,
{constrain:c,stickY:!0});d.plug(b.Plugin.DDNodeScroll,{node:c,horizontal:!1,scrollDelay:100})},_reorderTopic:function(b,e){var d=this.get("data");d.add(d.remove(b,{silent:!0}),{index:e,silent:!0});this.add(this.remove(b),e)}},{CSS_PREFIX:"sqs-pre-submit-builder",ATTRS:{data:{valueFn:function(){return new b.Squarespace.Models.FormPreSubmitTopicList},validator:b.Squarespace.AttrValidators.isInstanceOf("Y.Squarespace.Models.FormPreSubmitTopicList")},isSubTopics:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,
writeOnce:"initOnly"}}})},"1.0",{requires:"base widget-parent squarespace-dd-behaviors squarespace-dialog-field-2 squarespace-models-form-pre-submit-topic squarespace-attr-validators squarespace-form-pre-submit-topic squarespace-ui-base squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-editor-collection",function(b){var d="iTunesDescription iTunesAuthor iTunesSubtitle iTunesSummary iTunesKeywords iTunesCategories iTunesOwner iTunesOwnerEmail iTunesImage iTunesImageDescription iTunesExplicit iTunesNewFeedUrl".split(" "),c=b.namespace("Squarespace.Editor").Collection=b.Base.create("CollectionEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var b=this.get("dialog");b.on("ready",function(){var c=b.getField("iTunesEnabled");c&&!c.getValue()&&this._hideITunesFields();
this._bindEnabledFieldConfirmation();this._bindDuplicatePageButton();this._bindSetAsHomepageButton()},this);b.on("tab-focused",function(c){if("syndication"===c.tabName&&(c=b.getField("iTunesEnabled")))this[c.getValue()?"_showITunesFields":"_hideITunesFields"]()},this);b.on("datachange",function(c){var d=c.getName();c=c.getValue();var h=this.get("model");if("iTunesEnabled"===d)this[c?"_showITunesFields":"_hideITunesFields"]();else"navigationTitle"===d?(h.set("navigationTitle",c),b.getField("title").set("data",
c)):"title"===d&&h.set("title",c)},this);b.on("cancel",function(){this.get("model").resetToLastRead()},this);b.on("button-setFront",this._changeHomepageCollectionId,this);b.on("button-duplicate",this._duplicatePage,this);b.on("button-toggleEnabled",this._toggleEnabled,this);b.on("remove-requested",this._removeCollection,this)},_showITunesFields:function(){var c=this.get("dialog");b.Array.each(d,function(b){(b=c.getField(b))&&b.temporaryShow()},this)},_bindEnabledFieldConfirmation:function(){var c=
this.get("dialog").getField("enabled");if(c)c.on("dataChange",function(d){"_bindEnabledFieldConfirmation"!==d.source&&(d.halt(),this._toggleEnabled().then(b.bind(function(){c.set("data",d.newVal,{source:"_bindEnabledFieldConfirmation"})},this)))},this)},_bindDuplicatePageButton:function(){var b=this.get("dialog").getField("duplicate");b&&b.setAttrs({onClick:this._duplicatePage,context:this})},_bindSetAsHomepageButton:function(){var c=this.get("dialog").getField("setAsHomepage");if(c){var d=this.get("template"),
g=this.get("model"),h=function(){d.get("homepageCollectionId")==g.get("id")?(c.set("disabled",!0),new b.Squarespace.ToolTip({target:c.get("boundingBox"),title:"Already Set as Homepage",body:"This page is already set as the homepage of your site.",dialogTooltip:!0,showTimeout:200,clickToShow:!0})):c.set("disabled",!1)};d.after("homepageCollectionIdChange",h,this);h();c.setAttrs({onClick:this._changeHomepageCollectionId,context:this})}},_hideITunesFields:function(){var c=this.get("dialog");b.Array.each(d,
function(b){(b=c.getField(b))&&b.temporaryHide()},this)},_showDialog:function(){c.superclass._showDialog.call(this);var e=b.Squarespace.LayoutManager;e&&(e=e._dragSelection)&&e.disable()},_hideDialog:function(){c.superclass._hideDialog.call(this);var e=b.Squarespace.LayoutManager;e&&(e=e._dragSelection)&&e.enable()},getDialogData:function(){var e=c.superclass.getDialogData.call(this);e.passwordProtected&&(e.password=b.Squarespace.PasswordMask);b.Lang.isValue(e.mainImage)&&!b.instanceOf(e.mainImage,
b.Squarespace.Models.ContentItem)&&(e.mainImage=new b.Squarespace.Models.ContentItem(e.mainImage));delete e.items;return e},sanitizeDialogData:function(b){b=c.superclass.sanitizeDialogData(b);b.mainImageId=b.mainImage?b.mainImage.get("id"):null;b.mainImage&&(b.mainImage=b.mainImage.toJSON());return b},_changeHomepageCollectionId:function(){var c=this.get("model"),d=this.get("dialog"),g=this.get("template");if(g.get("homepageCollectionId")==c.get("id"))new b.Squarespace.Widgets.Information({"strings.title":"Already Set as Homepage",
"strings.message":"This page is already set as the homepage of your site!",position:b.Squarespace.Widgets.PositionHelper.ANCHOR.MOUSE});else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Set Homepage","strings.message":"Are you sure you want to make this collection the front page of your site?  It will be the first thing visitors to your site see."})).on("confirm",function(){d.updateTitle(b.Squarespace.DialogStates.SAVING);d.showSaveOverlay();g.set("homepageCollectionId",c.get("id"));g.saveHomepageCollectionId(function(c,
e){c?(new b.Squarespace.SystemError("Something Went Wrong",c,"json")).show():(d._removeButton("setFront"),d.hideSaveOverlay())})})},_duplicatePage:function(){var c=this.get("model");(new b.Squarespace.Widgets.Confirmation({"strings.title":"Duplicate Page","strings.message":"Are you sure you want to create a copy of <strong>"+b.Escape.html(c.get("navigationTitle"))+"</strong>?"})).on("confirm",function(){b.Data.post({url:"/api/commondata/CopyCollection",data:{collectionId:c.get("id")},success:function(c){var e=
b.Squarespace.ContentCollectionCache.add(c),d=this.get("template").get("navigations").getHiddenNavigation().get("itemList").create({collectionId:e.get("id"),enabled:!0,title:e.get("navigationTitle"),typeName:e.get("typeName"),urlId:e.get("urlId")},b.bind(function(){this.fire("page-duplicated",{collection:e,navigationItem:d})},this))}},this);this.hide()},this)},_removeCollection:function(c){var d=this.get("model");c=d.get("title");if(d.get("id")==this.get("template").get("homepageCollectionId"))new b.Squarespace.Widgets.Alert({"strings.title":"Cannot Delete Homepage",
"strings.message":"This page cannot be deleted because it is your homepage. Please assign a new homepage before deleting this page."});else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Delete "+b.Escape.html(c),"strings.message":"Are you sure you want to delete <strong>"+b.Escape.html(c)+"</strong>?"})).on("confirm",function(){this.get("dialog").close();d.destroy({remove:!0})},this)},_toggleEnabled:function(c){return new b.Squarespace.Promises.create(function(c,e){var d=this.get("model"),
k=!d.get("enabled"),l=b.bind(function(){k&&!d.get("enabled")?((new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Upgrade","strings.title":"Page Limit Reached","strings.message":"This collection cannot be enabled because you have exceeded the maximum number of pages allowed by your current plan (20). Upgrade to the <strong>Unlimited</strong> plan to enable more pages."})).on("confirm",function(){CONFIG_PANEL.getHistory().replace({module:"settings","settings-subPanelName":"billing-settings"})},
this),e()):c()},this);if(k)d.set("enabled",!0),d.save(l);else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Disable Collection","strings.message":"Are you sure you wish to disable this collection?"})).on("confirm",function(){d.set("enabled",!1);d.save(l)},this)},this)}},{ATTRS:{dialogConfigContext:{value:b.Squarespace.CollectionEditorSettings},dialogConfig:{value:{name:"collection-configuration",waitForServerOnClose:!0,initialDataByReference:!0,loadingText:"Loading Configuration...",style:"standard major",
position:"right",verticalHeight:"full",width:550,overlay:0.5,tabs:[{$include:"tabs.primary"},{$include:"tabs.advanced",$when:function(c){c=c.get("ordering")!=b.Squarespace.CollectionOrdering.CUSTOM&&c.get("type")==b.Squarespace.CollectionTypes.GENERIC||c.get("type")==b.Squarespace.CollectionTypes.PRODUCT;var d=b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE);return c||d}},{$include:"tabs.syndication",$when:function(c){return b.Squarespace.ContentCollectionUtils.hasSupportForSyndication(c)}}],
buttons:{$include:"buttons"}}},template:{valueFn:function(){return b.Squarespace.Singletons.Template}}}})},"1.0",{requires:["squarespace-editor-collection-settings","squarespace-models-content-collection","squarespace-model-editor","squarespace-widgets-alert","squarespace-widgets-confirmation"]});
YUI.add("squarespace-models-google-apps-user",function(b){var d=b.Squarespace.AttrValidators;b.namespace("Squarespace.Models");b.Squarespace.Models.GoogleAppsUser=b.Base.create("GoogleAppsUser",b.Model,[b.Squarespace.ModelSync.REST],{url:"/api/google-apps/{domain}/users/{id}",initializer:function(){this.root="/api/google-apps/"+this.get("domain")+"/users/"},resetPassword:function(c){return new b.Promise(b.bind(function(e,d){b.Data.put({url:this.getURL("update")+"/password-reset?recipient="+c,success:function(b){this.setAttrs(b);
e(this)},failure:d},this)},this))},resendInvitation:function(c){if(b.Lang.isDate(this.get("lastLogin")))throw"Cannot re-send an invitation to a user who has already accepted.";return new b.Promise(b.bind(function(e,d){b.Data.post({url:this.getURL("update")+"/invitations?recipient="+c,success:function(b){this.setAttrs(b);e(this)},failure:d},this)},this))},toJSON:function(){var c=b.Squarespace.Models.GoogleAppsUser.superclass.toJSON.call(this);b.Lang.isDate(c.lastLogin)&&(c.lastLogin=c.lastLogin.getTime());
return c}},{ATTRS:{domain:{validator:d.isString},name:{getter:function(){return this.get("firstName")+" "+this.get("lastName")}},firstName:{validator:d.isString},lastName:{validator:d.isString},email:{validator:d.isString},iconUrl:{getter:function(){var c=this.get("photoBase64");return b.Lang.isString(c)?"data:image/jpeg;base64,"+c:"/universal/images-v6/default-avatar-white.png"}},welcomeEmailRecipient:{validator:d.isNullOrString},photoBase64:{validator:d.isNullOrString},temporaryPassword:{validator:d.isNullOrString},
lastLogin:{validator:d.isNullOrDate}}})},"1.0",{requires:["base","model","squarespace-attr-validators","squarespace-model-sync-rest"]});
YUI.add("squarespace-block-image-editor-email",function(b){var d=b.namespace("Squarespace.Block.Editor").ImageEmail=b.Base.create("image-block-editor-dialog-email",b.Squarespace.Block.Editor.ImageBase,[],{initializer:function(){this.get("host").set("floatable",!1)},_initConfigDialog:function(){var b=d.superclass._initConfigDialog.call(this);b.set("imageContentModel",this._host.contentImage.get("model"));b.set("imageContentWidget",this._host.contentImage);return b},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.ImageEmail")}},
{NS:"blockEditor",ATTRS:{blockName:{value:"Image"},minHSize:{value:2}}});b.namespace("Squarespace.Block.ModelEditorDialog").ImageEmail=b.Base.create("blockImageEditorDialog",b.Squarespace.Block.ModelEditorDialog.Image,[],{_getDialogConfig:function(){return{name:"imageBlockConfig",initialDataByReference:!0,width:600,height:610,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Image",icon:"/universal/images-v6/icons/icon-image-16-light.png",
fields:[{type:"splitter",countHeight:!0,fields:[{ctor:b.Squarespace.DialogFields.FileImage,width:0.33,transientStore:!0,height:168,contentType:"image",name:"image",autoSaveFocalPoint:!0},{type:"stack",width:0.67,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"filename",strings:{title:"Filename",description:"Optional. Set the file name that will appear in image URLs.",placeholder:"something.jpg"},className:"thin dark"}},{ctor:b.Squarespace.DialogFields.CreateLink,config:{name:"clickThrough",
"strings.title":"Clickthrough URL",condensed:!0}}]}]}]}]}}})},"1.0",{requires:"base squarespace-block-image-editor-base squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-create-link squarespace-dialog-file-image squarespace-dialog-select squarespace-dialog-text squarespace-model-editor".split(" ")});
YUI.add("squarespace-mixins-sortable-model-list",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.SortableModelList=b.Base.create("SortableModelList",b.Base,[],{},{SORT_TYPES:{},ATTRS:{comparators:{value:{},validator:b.Squarespace.AttrValidators.isObject,writeOnce:"initOnlly"},sortType:{value:null,validator:b.Squarespace.AttrValidators.isNullOrNumber,setter:function(d){if(b.Lang.isValue(d)){var c=this.get("comparators")[d];if(!b.Lang.isValue(c))return console.error("Squarespace.Mixins.SortableModelList: Invalid sortType. There is no comparator for that sortType."),
this.comparator=null;this.comparator=c;return d}return this.comparator=null}}}})},"1.0",{requires:["base","squarespace-attr-validators"]});
YUI.add("squarespace-block-logo",function(b){b.namespace("Squarespace.Block").Logo=b.Base.create("block-logo",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-logo",ATTRS:{type:{readOnly:!0,valueFn:function(){return b.Squarespace.BlockType.LOGO}},emailEditor:{readOnly:!0,valueFn:function(){return b.Squarespace.Block.Editor.Logo}}}})},"1.0",{requires:["base","model","squarespace-block-base-modelsync","squarespace-block-logo-editor","squarespace-enum"]});
YUI.add("squarespace-models-external-google-domain-list",function(b){var d=b.namespace("Squarespace.Models"),c=b.Base.create("externalGoogleDomain",b.Model,[],{},{name:{validator:b.Squarespace.AttrValidators.isString}});d.ExternalGoogleDomainList=b.Base.create("extGoogleDomainList",d.ModelList,[b.Squarespace.ModelSync.REST],{url:"/api/google-web-hosting/domains?authRequestId={authRequestId}",model:c},{ATTRS:{authRequestId:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base",
"squarespace-models-model-list","squarespace-attr-validators"]});
YUI.add("squarespace-model-editor-panel",function(b){b.Squarespace.ModelEditorPanel=b.Base.create("modelEditorPanel",b.Squarespace.Widgets.SSWidget,[b.Squarespace.Mixins.SaveChanges],{initializer:function(){this.on("modelChange",function(b){b.prevVal&&b.prevVal.detachAll(this.get("id")+"|*")},this);var b=this.get("panel");b&&b.addTarget(this)},renderUI:function(){b.Squarespace.ModelEditorPanel.superclass.renderUI.call(this);this._syncRenderedFields()},bindUI:function(){b.Squarespace.ModelEditorPanel.superclass.bindUI.call(this);
this.get("model");var d=this.get("panel");this.after("visibleChange",this._toggleVisibility,this);this.after("*:action-button-click",this._handleActionButtonClick,this);d.after("dataChange",function(b){null!==b.prevVal&&this.markAsDirty()},this)},_toggleVisibility:function(b){b.newVal?this._showPanel():this._hidePanel()},_handleActionButtonClick:function(d){b.Lang.isValue(d)&&b.Lang.isString(d.action)&&this._routeAction(d.action)},_routeAction:function(d){switch(d){case "askBeforeSavingChangesAndClose":this._askBeforeSavingChangesAndClose();
break;case "saveAndClose":this._saveAndClose();break;case "save":this.saving||this.requestSave().then(b.bind(this._saveResponseHandler,this),b.bind(this._errorResponseHandler,this));break;case "cancel":this.ensureSavedChanges().then(b.bind(this._closePanel,this),b.bind(this._cancelClose,this));break;case "remove":this.requestDelete().then(b.bind(this._closePanel,this),b.bind(this._cancelClose,this));break;default:console.log("[Model Editor Panel] No action given.")}},_saveAndClose:function(){this.saving||
this.requestSave().then(b.bind(this._saveResponseHandler,this),b.bind(this._errorResponseHandler,this)).then(b.bind(this._closePanel,this))},_askBeforeSavingChangesAndClose:function(){this.hasUnsavedChanges()?b.Squarespace.Fluent.Confirm({"strings.title":"Review Changes","strings.message":"You have made changes. Do you want to save or discard them?","strings.confirm":"Save","strings.reject":"Discard",style:b.Squarespace.Fluent.TYPE.CONFIRM_OR_REJECT,showOverlay:!0}).then(b.bind(this._saveAndClose,
this),b.bind(function(b){b.cancel||this._closePanel()},this)):this._saveAndClose()},_cancelClose:function(){console.log("Clean up any shenanigans.")},_lockSaving:function(){this.saving=!0},_unlockSaving:function(){this.saving=!1},_deleteItem:function(){return b.Squarespace.Promises.create(function(d,c){this.get("model").destroy({remove:!0},function(e){b.Lang.isValue(e)?c(e):d()})},this)},_closePanel:function(){this._hidePanel(b.bind(function(){this._destroyPanel();this.destroy()},this))},validateFields:function(){var d=
this.get("panel").checkErrors();return b.Object.isEmpty(d)?null:d.errorSet},sanitizeFieldData:function(b){return b},_errorResponseHandler:function(d){var c=d.options;d=d.err;var e=this.get("panel"),f=this.get("model");b.Object.isEmpty(d.errors)?"4"===String(d.code).charAt(0)&&d.message?new b.Squarespace.Widgets.Alert({"strings.title":"Error Saving","strings.message":d.message}):(new b.Squarespace.SystemError("Something Went Wrong",d,"json")).show():e.showErrors(d.errors);f.setAttrs(c.initialData)},
_saveResponseHandler:function(d){d=d.options;d=b.Lang.isObject(d)?d:{haltClose:!1};b.Lang.isFunction(d.successFn)&&d.successFn();d.haltClose||this.closePanel()},closePanel:function(){this._closePanel()},requestSave:function(d,c){this._lockSaving();return b.Squarespace.Promises.create(function(e,f){var g=d||{},h=this.get("panel"),k=this.get("model"),l=h.checkErrors();b.Object.isEmpty(l)?(k.getAttrs(),k.setAttrs(this.sanitizeFieldData(h.getData())),k.save(g,b.bind(function(d,g){d&&g instanceof XMLHttpRequest&&
(d=b.merge(d,JSON.parse(g.response)));var h={response:g,options:c};b.Object.isEmpty(d)?e(h):(h.err=d,f(h));this._unlockSaving()},this))):f({err:l})},this)},syncUI:function(){b.Squarespace.ModelEditorPanel.superclass.syncUI.call(this)},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)},_renderFields:function(){this._syncRenderedFields()},_showPanel:function(){this.get("panel").show()},_hidePanel:function(b){var c=this.get("panel");c.once("visibleChange",b,this);c.hide()},
_syncRenderedFields:function(){var d=this.get("editorConfiguration"),c=this.get("makeContext"),e=this.get("panel"),d=b.clone(d,!0),c=b.Squarespace.ObjectBuilder.make(d,c,this.getTemplateContext());c._initialData=this.getFieldData();e.setAttrs({panelConfig:c,model:this.get("model")});e.render(this.get("targetNode"))},getFieldData:function(){return this.get("model").toJSON()},getTemplateContext:function(){return this.get("model").toJSON()},_destroyPanel:function(){var d=this.get("panel");b.Lang.isValue(d)&&
d.destroy()},destructor:function(){this._destroyPanel()}},{ATTRS:{editorConfiguration:{value:{}},fields:{value:[],validator:b.Squarespace.AttrValidators.isArray},model:{value:null,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Model)},makeContext:{value:{}},panel:{valueFn:function(){return new b.Squarespace.Widgets.TabbedPanel}},targetNode:{valueFn:function(){return this.get("contentBox")},validator:b.Squarespace.AttrValidators.isNode},visible:{value:!1}},CSS_PREFIX:"sqs-model-editor-panel"})},
"1.0",{requires:"plugin squarespace-attr-validators squarespace-dialog squarespace-mixin-save-changes squarespace-object-builder squarespace-settings-tabbed-panel squarespace-ss-widget squarespace-ui-base squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-settings-site-locale",function(b){var d=[{ctor:b.Squarespace.DialogFields.Description,config:{name:"time-zone-description",title:"Time Zone",text:"Select your local time zone from the map below.",padding:[0,0]}},{ctor:b.Squarespace.DialogFields.TimeZone,config:{name:"timeZone"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"language-description",title:"Language",text:"Select your native language.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"language",
className:"thin",defaultValue:"en-US",options:[]}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"geography-description",title:"Geography",text:"Select your country and state.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.CountrySelect,config:{name:"locale"}}],c=b.namespace("Squarespace.Settings.Site").Locale=b.Base.create("localeSettings",b.Squarespace.Widgets.SettingsPanel,[],{bindUI:function(){c.superclass.bindUI.call(this);this.on("saved-changes",function(b){Static.SQUARESPACE_CONTEXT.website=
b.responseData.website;Static.SQUARESPACE_CONTEXT.tzData=b.responseData.tzData})},loadDataSet:function(){this.setLoadingState();b.Data.get({url:"/universal/json/localedata.json",success:function(b){this.get("destroyed")||(this.setLoadedState(),this.getField("timeZone").set("locationData",b.timezoneOptions),this.getField("language").set("options",b.languageOptions))}},this)},_syncRenderedFields:function(){c.superclass._syncRenderedFields.call(this);this.loadDataSet()},_getSanitizedPanelData:function(){var b=
c.superclass._getSanitizedPanelData.call(this);b.state=b.locale.state;b.country=b.locale.country;delete b.locale;return b},_processResponseData:function(b){b.settings.locale={country:b.settings.country,state:b.settings.state};return b}},{CSS_PREFIX:"sqs-settings-panel-locale",HANDLEBARS_TEMPLATE:"settings-locale.html",TEMPLATED:!0,ATTRS:{initialDataUrl:{value:"/api/config/GetGeneralSettings"},initialDataPropertyName:{value:"settings"},saveUrl:{value:"/api/config/SaveLocaleSettings"},"strings.title":{value:"Time / Geography"},
"strings.description":{value:"Squarespace's locale settings allows you to pick a time zone, language, and geography for your website.  These settings will affect date presentation across the system."},fields:{value:d}}})},"1.0",{requires:"node oop anim json datatype-number squarespace-dombuilder squarespace-graphing squarespace-dialog-timezone squarespace-settings-panel squarespace-dialog-country-select squarespace-dialog-map squarespace-settings-locale-template".split(" ")});
YUI.add("squarespace-content-manager-widgets-music-album",function(b){b.namespace("Squarespace.ContentManagerWidgets");var d=b.Squarespace.ContentManagerWidgets.MusicAlbum=b.Base.create("ContentManagerMusicAlbum",b.Squarespace.ContentManagerWidgets.Base,[b.Squarespace.ContentManagerWidgets.SaveChangesTray,b.Squarespace.Mixins.AddContentItemHandlerMixin],{initializer:function(){var c=this.get("collection"),e=c.items;this._detailsEditorWidget=new b.Squarespace.MusicAlbum.DetailsEditor({collection:c});
this._trackListWidget=new b.Squarespace.MusicAlbum.TrackList({collection:c,items:e});this._itemsLoaded=!1;e.load({limit:60},b.bind(function(){this._itemsLoaded=!0;this.syncUI()},this))},destructor:function(){b.one("body").removeClass("sqs-content-manager-music-album-active");this._detailsEditorWidget.destroy();this._trackListWidget.destroy()},renderUI:function(){d.superclass.renderUI.call(this);b.one("body").addClass("sqs-content-manager-music-album-active");var c=b.Node.create('<div class="loading-state"></div>');
(new b.Squarespace.Spinner({size:100,color:"dark",render:c})).spin();this.get("contentBox").append(c)},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("collection");this._detailsEditorWidget.on("change",this.markAsDirty,this);this._registerEvent(b.on("save",this._updateSavedMessage,this))},syncUI:function(){d.superclass.syncUI.call(this);this._itemsLoaded?this._setLoadedState():this._setLoadingState()},_setLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this.get("boundingBox").removeClass("content-loading");
var b=this.get("contentBox"),e=this._detailsEditorWidget,d=this._trackListWidget;e.get("rendered")?e.syncUI():e.render(b);d.get("rendered")?d.syncUI():d.render(this.get("contentBox"))},_setLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=b.later(500,this,function(){this.get("boundingBox").addClass("content-loading")})},_updateSavedMessage:function(){var c=this.headerTray.get("contentBox").one(".subtitle");c.empty(!0);c.setHTML('Last saved <span class="time"></span>.');
c.one(".time").plug(b.Squarespace.RelativeTimeDisplay)},_revertChanges:function(c){return b.Squarespace.Promises.create(function(b,c){this.get("collection").load(function(d){d?c(d):b()})},this)},_saveChanges:function(c){return b.Squarespace.Promises.create(function(b,c){this.get("collection").save(function(d){d?c(d):b()})},this)}},{CSS_PREFIX:"sqs-content-manager-music-album"})},"1.0",{requires:"base squarespace-content-manager-widgets-base squarespace-content-manager-widgets-save-changes-tray squarespace-content-manager-widgets-music-album-details-editor squarespace-content-manager-widgets-music-album-track-list squarespace-content-manager-widgets-save-changes-tray".split(" ")});
YUI.add("squarespace-layout-drag",function(b){var d=b.Node.create("<div>Temp Node</div>");b.namespace("Squarespace.Layout").DragDelegate=b.Base.create("LayoutDragDelegate",b.DD.Delegate,[],{initializer:function(){this.get("useDragProxy")&&this.dd.plug(b.Squarespace.Plugin.DDSuperProxy,this.get("dragProxyConfig"));this.on("drag:mouseDown",this._dragMouseDown,this);this.before("drag:start",this._beforeDragStart,this);this.after("drag:start",this._afterDragStart,this);this.on("drag:over",this._dragOver,
this);this.on("drag:end",this._dragEnd,this);this._handles.push(b.DD.DDM.on("ddm:end",this._ddmEnd,this));if(this.get("useDragScroll")){var c=b.Squarespace.Layout.DragScroll;this.plug(c);this.on("dragScrollLockChange",function(b){this[c.NS].set("scrollLock",b.newVal)},this)}b.UA.mobile&&(this.dd.set("lock",!0),this.get("preventScrollOnTouch")&&this._preventScrollOnTouch());this.after("edgeInfoChange",this.get("editController").processEdgeInfo,this.get("editController"))},destructor:function(){this._scrollEvent&&
this._scrollEvent.detach();this.dd.unplug();this.unplug()},_preventScrollOnTouch:function(){this.on("drag:mouseDown",function(b){b.ev.preventDefault()},this);this.get("container").on("touchmove",function(b){this.dd.get("lock")||b.preventDefault()},this)},_preventDragStartOnScroll:function(){var c=b.Squarespace.Layout.DragScroll.NS,c=this.hasPlugin(c)?this[c].get("scrollableNode"):b.one(b.config.doc);this._scrollEvent&&this._scrollEvent.detach();this._scrollEvent=c.on(["scroll","overScroll"],function(){this._scrollEvent.detach();
this._dragTimer&&this._dragTimer.cancel()},this)},_dragMouseUp:function(){this.detach(this._eventPrefix+"|drag:mouseup");this._dragTimer&&this._dragTimer.cancel()},_dragMouseDown:function(){if(b.UA.mobile){var c=this.dd,e=this._eventPrefix;this._dragTimer&&this._dragTimer.cancel();b.UA.ios||this._preventDragStartOnScroll();c.set("lock",!0);this._dragTimer=b.later(c.get("clickTimeThresh"),this,function(){c.set("lock",!1)});this.detach(e+"|drag:mouseup");this.on(e+"|drag:mouseup",this._dragMouseUp,
this)}},_beforeDragStart:function(){b.DD.DDM.syncActiveShims();this.get("blockFocusHandler").preventBlockFocus();this.get("blockFocusHandler").blurAllBlocks();var c=b.DD.DDM.activeDrag.get("node"),e=b.Widget.getByNode(c);this.dd.setAttrs({dragWidget:e,dragNodeRegion:c.get("region")})},_afterDragStart:function(){this.get("extraSyncShims")&&b.later(250,this,function(){b.DD.DDM.syncActiveShims()})},_dragOver:function(b){b.drop.get("lock")||(b=this.getNearestEdge())&&this.set("edgeInfo",b)},_dragEnd:function(){var c=
b.DD.DDM.activeDrag.get("node");b.Object.getValue(c,"_node")&&c.setStyles({position:null,top:null,left:null});this.dd.setAttrs({dragWidget:null,dragNodeRegion:null})},_ddmEnd:function(){this._dragTimer&&this._dragTimer.cancel()},getNearestEdge:function(){var c=null,e=b.DD.DDM.activeDrop.get("node");if(!e.ancestor(".sqs-block:not(.sqs-destroyme)",!0,".sqs-layout"))return c;var d=e.get("region"),g=d.left,h=d.top,k=d.width+parseInt(e.getComputedStyle("marginLeft"),10)+parseInt(e.getComputedStyle("marginRight"),
10),l=d.height+parseInt(e.getComputedStyle("marginTop"),10)+parseInt(e.getComputedStyle("marginBottom"),10),p=b.DD.DDM.activeDrag.mouseXY,q={x:p[0]<g+k/2?"left":"right",y:p[1]<h+l/2?"top":"bottom"},g="left"===q.x?p[0]-g:g+k-p[0],h="top"===q.y?p[1]-h:h+l-p[1],l=Math.min(k,l),k=100*(g/k),p=100*(h/l),l=k<p?q.x:q.y,g=k<p?g:h;isNaN(g)||(c={node:e,direction:l,distance:g,quad:q,region:d});return c},_afterDragEnd:function(){b.DD.DDM._noShim=this._shimState;var c=this.dd.get("node");this.set("lastNode",c);
c&&b.Lang.isValue(c._node)&&c.removeClass(b.DD.DDM.CSS_PREFIX+"-dragging");this.dd._unprep();this.dd.set("node",d)},_delMouseDown:function(c){var e=c.currentTarget,d=this.dd,g=e,h=this.get("dragConfig"),k=this.get("nodes"),l=this.get("invalidHandles");if(e.test(k)&&!e.test(this.get("invalid"))&&(!l||!c.target.ancestor(l,!0,k)))this._shimState=b.DD.DDM._noShim,b.DD.DDM._noShim=!0,this.set("currentNode",e),d.set("node",e),h&&h.dragNode?g=h.dragNode:d.proxy&&(g=b.DD.DDM._proxy),d.set("dragNode",g),d._prep(),
d.fire("drag:mouseDown",{ev:c})}},{ATTRS:{container:{valueFn:function(){return b.one(b.config.doc.body)},lazyAdd:!1},nodes:{value:".sqs-block"},groups:{value:null,lazyAdd:!1},invalid:{value:".sqs-dd-invalid",validator:b.Lang.isString},invalidHandles:{value:"",validator:b.Lang.isString},scrollNode:{value:{},lazyAdd:!1,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Node)},editController:{value:null},edgeInfo:{value:{node:null,direction:"",distance:0,quad:null,region:null}},extraSyncShims:{value:!1,
validator:b.Squarespace.AttrValidators.isBoolean},preventScrollOnTouch:{value:!1},useDragProxy:{value:!1},dragProxyConfig:{value:{}},useDragScroll:{value:!0},dragScrollLock:{value:!1},blockFocusHandler:{valueFn:function(){return b.Squarespace.Singletons.BlockFocusHandler}}}})},"1.0",{requires:"base dd-delegate dd-drag squarespace-dd-superproxy anim squarespace-ui-base squarespace-util squarespace-dd-behaviors squarespace-layout-drag-scroll squarespace-scrollintoview squarespace-attr-validators".split(" ")});
YUI.add("squarespace-visual-editor",function(b){var d=/^\s{0,20}(?:(?:&nbsp;)|(?:<br\s?\/>)|(?:<p[^>]*>[\s\u200b]{0,20}(?:(?:&nbsp;)|(?:<br\s?\/?>)|)[\s\u200b]{0,20}<\/p>)|)\s{0,20}$/i;b.namespace("Squarespace");var c=b.Squarespace.Range,e=b.Squarespace.EditorBase,f=Class.create({commands:{init:function(){},bold:function(){this.el.editor.wrapFromHtml("<strong>")},italic:function(){this.el.editor.wrapFromHtml("<em>")},underline:function(){this.el.editor.wrapFromHtml("<u>")},insertimageblock:function(b){this.el.editor.wrapFromHtml('<img src="'+
b+'">')},undo:function(){this.el.editor.undo()},redo:function(){this.el.editor.redo()},removeformat:function(){this.el.editor.clear()},heading:function(b){this.el.editor.wrapFromHtml("<h"+b+">")},createLink:function(b){var c=this.el.editor.wrapFromHtml('<a href="'+(b||"#")+'"></a>');!b&&this._linkEdit&&(c._node.parentNode?this._linkEdit.openEdit(c):this._linkEdit.close(!0))},unlink:function(){this._linkEdit&&this._linkEdit.close(!0);this.saveSelection();var b=this.el.editor.get("containers");b&&b.link&&
this.el.editor.unwrap(b.link);this.restoreSelection()},removeformatblocks:function(){this.saveSelection();this.el.editor.unwrapBlocks();this.restoreSelection()},blockquote:function(){var b=this.el.editor,e=c.fromSelection({root:b._root}).get("startContainer").ancestor(b.get("blockElements"));e.get("parentNode");e.test("blockquote")?b.wrapFromHtml("<p>"):b.wrapFromHtml("<blockquote>")},align:function(b){var e=this.el.editor,d=c.fromSelection({root:e._root}).shrink().toSelection(),f=d.get("container").all(e.get("blockElementsWithHeadings"));
1<f.size()?f.each(function(c){c.replaceClass("text-align-.*","text-align-"+b)}):(d=d.get("startContainer"),e=d.ancestor(e.get("blockElementsWithHeadings")),e.replaceClass("text-align-.*","text-align-"+b))},insertunorderedlist:function(){var b=this.el.editor;c.fromSelection({root:b._root}).shrink().toSelection().get("startContainer").ancestor(b.get("blockElementsWithHeadings")).test("ul > li")?b.unwrapBlock("ul"):b.wrapFromHtml("<ul><li></li></ul>")},insertorderedlist:function(){var b=this.el.editor;
c.fromSelection({root:b._root}).shrink().toSelection().get("startContainer").ancestor(b.get("blockElementsWithHeadings")).test("ol > li")?b.unwrapBlock("ol"):b.wrapFromHtml("<ol><li></li></ol>")},indent:function(){var b=this.el.editor,e=c.fromSelection({root:b._root}).shrink().toSelection(),e=e.get("startContainer"),e=e.ancestor(b.get("blockElementsWithHeadings"));e.test("ul > li")?b.wrapFromHtml("<ul><li></li></ul>"):e.test("ol > li")?b.wrapFromHtml("<ol><li></li></ol>"):b.wrapFromHtml("<blockquote>")},
outdent:function(){var b=this.el.editor,d=c.fromSelection({root:b._root}).shrink().toSelection(),d=d.get("startContainer"),b=d.ancestor(b.get("blockElements")),d=b.get("parentNode");this.saveSelection();b.test("ul > li, ol > li")?d.get("parentNode")._node!==this.el._node?this.el.editor.unwrap(d,null):(this.el.editor.wrapFromHtml("<p>"),e.unwrap(d,null,!1,!0)):b.test("blockquote")&&b.get("parentNode")._node!==this.el._node?this.el.editor.unwrap(b):this.el.editor.wrapFromHtml("<p>");this.restoreSelection()}},
changed:!1,initialize:function(c){this.params=c;this.el=c.el;this.mode=c.mode;b.one(this.el).plug(b.Squarespace.EditorBase,c);var e=this.el.editor;e.set("keyMap",b.merge(e.get("keyMap"),{"66+CMD":function(b){b.halt();e.wrapFromHtml("<strong>")},"73+CMD":function(b){b.halt();e.wrapFromHtml("<em>")},"83+CMD":function(b){b.halt()}}));e.on("change",this._onContentChange,this);this.commands.init&&this.commands.init.apply(this);this.el.on("keyup",this._onKeyUp,this);this.el.on("keypress",this._onKeyEvent,
this);this.el.on("keydown",this._onKeyEvent,this);this.el.on("contextmenu",this._onContentChange,this);e.registerContainer({bold:"strong",italic:"em",link:"a[href]",align_left:".text-align-left",align_center:".text-align-center",align_right:".text-align-right",h1:"h1",h2:"h2",h3:"h3",blockquote:"blockquote",unorderedlist:"ul",orderedlist:"ol"});c.tabIndex&&this.el.setAttribute("tabIndex",c.tabIndex)},setHeight:function(b){this.el.setStyle("height",b+"px")},destroy:function(){this.el.unplug(b.Squarespace.EditorBase)},
getContent:function(){this.changed=!1;var b=this.el.editor.getValue();return d.test(b)?"":b},setContent:function(b){void 0===b&&(b="");return this.el.setContent(b)},setWidth:function(){},getContentHeight:function(){return parseInt(this.el.get("scrollHeight"),10)},focus:function(){return this.el.focus()},saveSelection:function(){var b=c.fromSelection({root:this.el.editor._root}).shrink().get("offsets");0===b.start&&0===b.end||(this._sel=b)},restoreSelection:function(){if(this._sel&&this.el._node){var b=
c.fromOffsets(this.el,this._sel).toSelection();this._sel=void 0;return b}},execCommand:function(b){this.commands[b]&&(this.restoreSelection(),this.commands[b].apply(this,Array.prototype.slice.call(arguments,1)),this._onContentChange())},_onContentChange:function(){this.changed=!0;this.fire("change")},_onKeyEvent:function(b){16===b.keyCode||(17===b.keyCode||18===b.keyCode||20===b.keyCode||91===b.keyCode||27===b.keyCode)||b.stopPropagation()},_onKeyUp:function(b){16===b.keyCode||(17===b.keyCode||18===
b.keyCode||20===b.keyCode||91===b.keyCode||27===b.keyCode)||b.stopPropagation();(8===b.keyCode||46===b.keyCode||48<b.keyCode)&&this._onContentChange()}});b.augment(f,b.EventTarget);b.Squarespace.VisualEditor=f},"1.0",{requires:["node","event","squarespace-editor-base"]});
YUI.add("squarespace-existing-content-link-tab-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["existing-content-link-tab.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="existing-content-link-tab">\n  <div class="content-options"></div>\n</div>\n'})})();b.Handlebars.registerPartial("existing-content-link-tab.html".replace("/","."),d.templates["existing-content-link-tab.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-settings-tabbed-panel",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.TabbedPanel=b.Base.create("settingsTabbedPanel",b.Squarespace.Widgets.DataWidget,[b.WidgetParent],{initializer:function(c){this._headerTray=this._initHeaderTray();this._buttonTray=this._initButtonTray();this._renderedPanels={};this._initialData=c.initialData?b.clone(c.initialData,!0):{}},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._headerTray.setAttrs({"strings.title":this.get("panelConfig.title")||
this.get("strings.title"),buttons:this._getTabConfigurationForTabbedHeaderTray()});this._buttonTray.setAttrs({buttons:this._getButtonConfigurationForButtonTray()});this._headerTray.render(b);this._buttonTray.render(b);b.prepend(this._headerTray.get("boundingBox"));b.append('<div class="panel-description">');this._syncPanelConfig()},bindUI:function(){d.superclass.bindUI.call(this);this.after("tabsChange",function(b){this._headerTray.set("buttons",this._getTabConfigurationForTabbedHeaderTray());this._headerTray.set("strings.title",
this.get("panelConfig.title"))},this);this.after("buttonsChange",function(b){this._buttonTray.set("buttons",this._getButtonConfigurationForButtonTray())},this);this.after("panelConfigChange",this._syncPanelConfig,this);this.after("panelTab:dataChange",this._updateData,this)},syncUI:function(){d.superclass.syncUI.call(this);this._buttonTray.set("loading",this.isLoading());var c=this.get("contentBox").one(".panel-description"),e=this.get("strings.description");b.Lang.isValue(c)&&b.Lang.isValue(e)&&
c.setContent(this.get("strings.description"))},destructor:function(){this._headerTray&&this._headerTray.destroy();this._buttonTray&&this._buttonTray.destroy();b.Array.invoke(this._renderedPanels,"destroy")},_updateData:function(b){this.set("data",this.getData())},getData:function(){return b.merge(this._initialData,this._getAggregatedData())},_getAggregatedData:function(){var c=b.Object.keys(this._renderedPanels);return b.Array.reduce(c,{},function(c,d){var g=this._renderedPanels[d].getData();return b.merge(c,
g)},this)},showErrors:function(c){b.Lang.isValue(c)||(c=this.checkErrors());console.log("[Show Errors]",c)},_initHeaderTray:function(){return this.add(new b.Squarespace.Widgets.TabbedHeaderTray({loading:this.get("dataState")===this.getProperty("DATA_STATES").LOADING,"strings.title":this.get("strings.title"),buttons:this._getTabConfigurationForTabbedHeaderTray()})).item(0)},_initButtonTray:function(){this.publish("action-button-click",{emitFacade:!0});return this.add(new b.Squarespace.Widgets.HeaderTray({buttons:this._getButtonConfigurationForButtonTray(),
className:"sqs-footer-tray sqs-button-tray"})).item(0)},_getButtonConfigurationForButtonTray:function(){var c=b.clone(this.get("panelConfig.buttons"));b.Array.each(c,function(c){c.label||(c.label=c.title||c.type);!b.Lang.isValue(c.action)&&b.Lang.isString(c.type)&&(c.action=b.bind(this._handleActionButtonClick,this,c.type));c.context=c.context||this},this);return c},_handleActionButtonClick:function(b){b||console.warn("[handleButtonClick] Missing button type");this.fire("action-button-click",{action:b})},
_getTabConfigurationForTabbedHeaderTray:function(){var c=b.clone(this.get("panelConfig.tabs"))||[];return b.Array.map(c,function(c,d){b.Lang.isString(c.name)?c.name=c.name.toLowerCase():c.name="tab"+d;return{name:c.name,label:c.tabTitle||this.get("strings.defaultTab"),context:this,action:b.bind(this._activateTab,this,c.name)}},this)},getField:function(c){var e=null;b.Object.some(this._renderedPanels,function(d){d=d.getField(c);var g=b.Lang.isValue(d);g&&(e=d);return g},this);return e},_activateTab:function(c){this._renderedPanels[c].get("visible")||
b.Object.each(this._renderedPanels,function(b,d){b.toggleView(c===d)},this)},_syncPanelConfig:function(){this._destroyTabs();this._renderTabs();this.set("buttons",this._getButtonConfigurationForButtonTray());this.set("tabs",this._getTabConfigurationForTabbedHeaderTray());this.get("contentBox").append(this._buttonTray.get("boundingBox"))},_destroyTabs:function(){b.Array.invoke(this._renderedPanels,"destroy")},_renderTabs:function(){var c=this.get("panelConfig"),e=c.tabs,d=b.merge(this.get("model").toJSON(),
c._initialData||{});b.Array.each(e,function(b,c){this._renderTab(b,c,d)},this);this._renderedPanels[c.tabs[0].name].show()},_renderTab:function(c,e,d){e=c.name||"tab-"+e;this._renderedPanels[e]=new b.Squarespace.Widgets.PanelTab({fields:c.fields,data:d,visible:!1,"strings.title":c.tabTitle,tabName:e,render:this.get("contentBox")});this._renderedPanels[e].addTarget(this)},checkErrors:function(){var c={};b.Object.each(this._renderedPanels,function(e){c=b.merge(c,e._checkErrors())},this);return c},_getSanitizedPanelData:function(){return b.merge(this.get("data"),
b.Squarespace.FormUtils.getData(this._renderedPanels))}},{ASYNC_DATA:!1,CSS_PREFIX:"sqs-settings-tabbed-panel",ATTRS:{buttons:{value:[]},data:{value:null},tabs:{value:[]},panelConfig:{value:{},setter:function(c){b.Array.each(c.tabs,function(c,d){b.Lang.isString(c.name)?c.name=c.name.toLowerCase():c.name="tab-"+d},this)}},siteContext:{value:{}},strings:{value:{title:"Default Panel",defaultTab:"Item"}}}})},"1.0",{requires:"base-build squarespace-dialog squarespace-form-utils squarespace-mixin-save-changes squarespace-settings-tabbed-panel-tab squarespace-ss-widget squarespace-tray widget-anim".split(" ")});
YUI.add("squarespace-block-email-footer",function(b){b.namespace("Squarespace.Block").EmailFooter=b.Base.create("block-email-footer",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-email-footer",ATTRS:{type:{value:b.Squarespace.BlockType.EMAIL_FOOTER},emailEditor:{value:b.Squarespace.Block.Editor.EmailFooter}}})},"1.0",{requires:["base","model","squarespace-block-base-modelsync","squarespace-block-email-footer-editor","squarespace-enum"]});
YUI.add("squarespace-block-button",function(b){b.namespace("Squarespace.Block").Button=b.Base.create("block-button",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-button",ATTRS:{editor:{value:b.Squarespace.Block.Editor.Button},emailEditor:{valueFn:function(){return b.Squarespace.Block.Editor.ButtonEmail}},type:{value:b.Squarespace.BlockType.BUTTON},defaultContentModel:{value:{buttonText:"Learn More",buttonLink:"",newWindow:!1,buttonAlignment:"center",buttonSize:"medium"}}}})},"1.0",
{requires:["squarespace-block-base-modelsync","squarespace-block-button-editor","squarespace-enum"]});
YUI.add("squarespace-editor-member-permission",function(b){b.namespace("Squarespace.Editor");var d=b.Squarespace.Editor.MemberPermission=b.Base.create("MemberPermission",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var c=this.get("model");this.get("dialog").on("remove-requested",function(){this._memberPermissionHasPermissions()?this._removeAllPermissions():b.Squarespace.MemberPermissionUtils.createReplaceAndRemoveDialog(c,c.get("memberAccount"),this)},this)},save:function(c,e){d.superclass.save.call(this,
c,b.bind(e||function(){new b.Squarespace.Widgets.Information({"strings.title":"Contributor Saved","strings.message":"The specified contributor has been saved."})},this))},sanitizeDialogData:function(c){c=d.superclass.sanitizeDialogData.call(this,c);var e={};b.Array.each(c.permissions,function(b){e[b]=!0});c.permissions=e;return c},_memberPermissionHasPermissions:function(){return!b.Object.isEmpty(this.get("model").get("permissions"))},_removeAllPermissions:function(){this.get("dialog").getField("permissions").set("data",
[]);this.save(null,function(){new b.Squarespace.Widgets.Information({"strings.title":"Contributor Access Removed","strings.message":"All permissions for the specified contributor have been removed."})})}},{ATTRS:{model:{value:null,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberPermission)},dialogConfig:{getter:function(){var c=this.get("model").get("memberAccount");return{name:"editMemberPermission",closeOthers:!1,overlay:0.5,width:600,verticalHeight:"fit",buttons:[{type:"cancel",
title:"Cancel"},{type:"remove",title:this._memberPermissionHasPermissions()?"Remove Access":"Remove Contributor"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Modify Permissions "+b.Escape.html(c.get("displayName"))+" ("+c.get("email")+")",icon:"/universal/images-v6/content/member.png?2",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Permissions",text:"Select permissions for this user. Permissions control what this contributor can do on your site."}},{ctor:b.Squarespace.DialogFields.Permissions,
config:{name:"permissions",columns:2}}]}]}}}}})},"1.0",{requires:"base squarespace-model-editor squarespace-models-member-permission squarespace-dialog-description squarespace-dialog-permissions squarespace-attr-validators squarespace-ui-base squarespace-member-permission-utils squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dialog-billing-status-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-billing-status.html"]=b(function(b,c,d,h,k){function l(b,c){return"expiring"}function p(b,c){var e,f;e="\n      ";if((f=d["if"].call(b,b.pastDue,{hash:{},inverse:z.program(10,t,c),fn:z.program(5,q,c),data:c}))||0===f)e+=f;return e+"\n    "}function q(b,c){var e,f,h;e='\n        <div class="big-text">\n          Your bill of '+w((f=(f=b.plan,null==f||
!1===f?f:f.currencySymbol),typeof f===v?f.apply(b):f));h={hash:{},data:c};e+=w((f=d["trim-cents"]||b["trim-cents"],f?f.call(b,b.billAmount,h):y.call(b,"trim-cents",b.billAmount,h)))+w((f=(f=b.plan,null==f||!1===f?f:f.currencySuffix),typeof f===v?f.apply(b):f))+" was due "+w((f=(f=b.plan,null==f||!1===f?f:f.pastDueDayCount),typeof f===v?f.apply(b):f))+" ";h={hash:{},data:c};e+=w((f=d.pluralize||b.pluralize,f?f.call(b,"day",(f=b.plan,null==f||!1===f?f:f.pastDueDayCount),h):y.call(b,"pluralize","day",
(f=b.plan,null==f||!1===f?f:f.pastDueDayCount),h)))+'  ago.\n        </div>\n        <div class="more-info">\n          <strong>'+w((f=(f=b.plan,null==f||!1===f?f:f.productType),typeof f===v?f.apply(b):f))+" Plan</strong> renewal date was ";h={hash:{format:"%B %e, %Y"},data:c};e+=w((f=d["date-format"]||b["date-format"],f?f.call(b,(f=b.plan,null==f||!1===f?f:f.renewalDate),h):y.call(b,"date-format",(f=b.plan,null==f||!1===f?f:f.renewalDate),h)))+". ";h={hash:{compare:0},inverse:z.noop,fn:z.program(6,
r,c),data:c};if((h=(f=d.if_lt||b.if_lt,f?f.call(b,(f=b.plan,null==f||!1===f?f:f.amountDiscount),h):y.call(b,"if_lt",(f=b.plan,null==f||!1===f?f:f.amountDiscount),h)))||0===h)e+=h;e+=" ";if((h=d["if"].call(b,(f=b.plan,null==f||!1===f?f:f.error),{hash:{},inverse:z.noop,fn:z.program(8,s,c),data:c}))||0===h)e+=h;return e+"\n        </div>\n      "}function r(b,c){var e,f;e="<strong>Your rate is ";(f=d.planDiscountRate)?f=f.call(b,{hash:{},data:c}):(f=b.planDiscountRate,f=typeof f===v?f.apply(b):f);return e+=
w(f)+"% Off.</strong>"}function s(b,c){var e,d;return e="Error: "+w((d=(d=b.plan,null==d||!1===d?d:d.error),typeof d===v?d.apply(b):d))}function t(b,c){var e,f,h;e='\n        <div class="big-text">\n          Your next bill of '+w((f=(f=b.plan,null==f||!1===f?f:f.currencySymbol),typeof f===v?f.apply(b):f));h={hash:{},data:c};e+=w((f=d["trim-cents"]||b["trim-cents"],f?f.call(b,b.billAmount,h):y.call(b,"trim-cents",b.billAmount,h)))+w((f=(f=b.plan,null==f||!1===f?f:f.currencySuffix),typeof f===v?f.apply(b):
f))+" is due in ";(h=d.daysRemaining)?h=h.call(b,{hash:{},data:c}):(h=b.daysRemaining,h=typeof h===v?h.apply(b):h);e+=w(h)+" ";h={hash:{},data:c};e+=w((f=d.pluralize||b.pluralize,f?f.call(b,"day",b.daysRemaining,h):y.call(b,"pluralize","day",b.daysRemaining,h)))+'.\n        </div>\n        <div class="more-info">\n          <strong>'+w((f=(f=b.plan,null==f||!1===f?f:f.productType),typeof f===v?f.apply(b):f))+" Plan</strong> renewal date is ";h={hash:{format:"%B %e, %Y"},data:c};e+=w((f=d["date-format"]||
b["date-format"],f?f.call(b,(f=b.plan,null==f||!1===f?f:f.renewalDate),h):y.call(b,"date-format",(f=b.plan,null==f||!1===f?f:f.renewalDate),h)))+". ";h={hash:{compare:0},inverse:z.noop,fn:z.program(6,r,c),data:c};if((h=(f=d.if_lt||b.if_lt,f?f.call(b,(f=b.plan,null==f||!1===f?f:f.amountDiscount),h):y.call(b,"if_lt",(f=b.plan,null==f||!1===f?f:f.amountDiscount),h)))||0===h)e+=h;return e+"\n        </div>\n      "}function u(b,c){var e,f,h;e=""+('\n      <div class="big-text">\n        Your '+w((f=(f=
b.plan,null==f||!1===f?f:f.productType),typeof f===v?f.apply(b):f))+" account will expire in ");(h=d.daysRemaining)?h=h.call(b,{hash:{},data:c}):(h=b.daysRemaining,h=typeof h===v?h.apply(b):h);e+=w(h)+" ";h={hash:{},data:c};e+=w((f=d.pluralize||b.pluralize,f?f.call(b,"day",b.daysRemaining,h):y.call(b,"pluralize","day",b.daysRemaining,h)))+'.\n      </div>\n      <div class="more-info">\n        Plan expiration on ';h={hash:{format:"%B %e, %Y"},data:c};return e+=w((f=d["date-format"]||b["date-format"],
f?f.call(b,(f=b.plan,null==f||!1===f?f:f.renewalDate),h):y.call(b,"date-format",(f=b.plan,null==f||!1===f?f:f.renewalDate),h)))+".\n      </div>\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var v="function",w=this.escapeExpression,y=d.helperMissing,z=this;if((c=d.unless.call(c,c.billingSystemDown,{hash:{},inverse:z.noop,fn:z.program(1,function(b,c){var e,f,h;e='\n  <div class="outer ';if((f=d["if"].call(b,b.websiteWillExpire,{hash:{},inverse:z.noop,fn:z.program(2,
l,c),data:c}))||0===f)e+=f;e+='">\n    ';if((h=d["if"].call(b,(f=b.plan,null==f||!1===f?f:f.autorenew),{hash:{},inverse:z.program(12,u,c),fn:z.program(4,p,c),data:c}))||0===h)e+=h;return e+"\n  </div>\n"},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("dialog-billing-status.html".replace("/","."),d.templates["dialog-billing-status.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("thirdparty-d3",function(b){(function(){function b(c){return c.target}function c(b){return b.source}function e(b){for(var c=-1,e=b.length,d=[];e>++c;)d.push(b[c]);return d}function f(){}function g(b){return b}function h(){return!0}function k(b){return"function"==typeof b?b:function(){return b}}function l(b,c,e){return function(){var d=e.apply(c,arguments);return arguments.length?b:d}}function p(b){return null!=b&&!isNaN(b)}function q(b){return b.length}function r(b){return 1===b.length?function(c,
e){b(null==c?e:null)}:b}function s(b){return b.responseText}function t(b){return JSON.parse(b.responseText)}function u(b){var c=document.createRange();return c.selectNode(document.body),c.createContextualFragment(b.responseText)}function v(b){return b.responseXML}function w(){}function y(b){function c(){for(var d,f=e,g=-1,h=f.length;h>++g;)(d=f[g].on)&&d.apply(this,arguments);return b}var e=[],d=new f;return c.on=function(c,f){var g,h=d.get(c);return 2>arguments.length?h&&h.on:(h&&(h.on=null,e=e.slice(0,
g=e.indexOf(h)).concat(e.slice(g+1)),d.remove(c)),f&&e.push(d.set(c,{on:f})),b)},c}function z(b,c){return c-(b?1+Math.floor(Math.log(b+Math.pow(10,1+Math.floor(Math.log(b)/Math.LN10)-c))/Math.LN10):1)}function B(b){return b+""}function A(b){return function(c){return 0>=c?0:1<=c?1:b(c)}}function K(b){return function(c){return 1-b(1-c)}}function O(b){return function(c){return 0.5*(0.5>c?b(2*c):2-b(2-2*c))}}function E(b){return b*b}function F(b){return b*b*b}function U(b){return 1-Math.cos(b*Ga/2)}function H(b){return Math.pow(2,
10*(b-1))}function G(b){return 1-Math.sqrt(1-b*b)}function aa(b){return 1/2.75>b?7.5625*b*b:2/2.75>b?7.5625*(b-=1.5/2.75)*b+0.75:2.5/2.75>b?7.5625*(b-=2.25/2.75)*b+0.9375:7.5625*(b-=2.625/2.75)*b+0.984375}function D(){d3.event.stopPropagation();d3.event.preventDefault()}function M(){for(var b,c=d3.event;b=c.sourceEvent;)c=b;return c}function I(b){for(var c=new w,e=0,d=arguments.length;d>++e;)c[arguments[e]]=y(c);return c.of=function(e,d){return function(f){try{var g=f.sourceEvent=d3.event;f.target=
b;d3.event=f;c[f.type].apply(e,d)}finally{d3.event=g}}},c}function Q(b){var c=[b.a,b.b],e=[b.c,b.d],d=V(c),f=c[0]*e[0]+c[1]*e[1],g=V((e[0]+=-f*c[0],e[1]+=-f*c[1],e))||0;c[0]*e[1]<e[0]*c[1]&&(c[0]*=-1,c[1]*=-1,d*=-1,f*=-1);this.rotate=(d?Math.atan2(c[1],c[0]):Math.atan2(-e[0],e[1]))*Tb;this.translate=[b.e,b.f];this.scale=[d,g];this.skew=g?Math.atan2(f,g)*Tb:0}function V(b){var c=Math.sqrt(b[0]*b[0]+b[1]*b[1]);return c&&(b[0]/=c,b[1]/=c),c}function C(b){return"transform"==b?d3.interpolateTransform:
d3.interpolate}function Z(b,c){return c=c-(b=+b)?1/(c-b):0,function(e){return(e-b)*c}}function N(b,c){return c=c-(b=+b)?1/(c-b):0,function(e){return Math.max(0,Math.min(1,(e-b)*c))}}function ca(){}function R(b,c,e){return new X(b,c,e)}function X(b,c,e){this.r=b;this.g=c;this.b=e}function ba(b){return 16>b?"0"+Math.max(0,b).toString(16):Math.min(255,b).toString(16)}function na(b,c,e){var d,f,g,h=0,k=0,l=0;if(d=/([a-z]+)\((.*)\)/i.exec(b))switch(f=d[2].split(","),d[1]){case "hsl":return e(parseFloat(f[0]),
parseFloat(f[1])/100,parseFloat(f[2])/100);case "rgb":return c(Y(f[0]),Y(f[1]),Y(f[2]))}return(g=qc.get(b))?c(g.r,g.g,g.b):(null!=b&&"#"===b.charAt(0)&&(4===b.length?(h=b.charAt(1),h+=h,k=b.charAt(2),k+=k,l=b.charAt(3),l+=l):7===b.length&&(h=b.substring(1,3),k=b.substring(3,5),l=b.substring(5,7)),h=parseInt(h,16),k=parseInt(k,16),l=parseInt(l,16)),c(h,k,l))}function S(b,c,e){var d,f,g=Math.min(b/=255,c/=255,e/=255),h=Math.max(b,c,e),k=h-g,l=(h+g)/2;return k?(f=0.5>l?k/(h+g):k/(2-h-g),d=b==h?(c-e)/
k+(e>c?6:0):c==h?(e-b)/k+2:(b-c)/k+4,d*=60):f=d=0,ta(d,f,l)}function $(b,c,e){b=ra(b);c=ra(c);e=ra(e);var d=Ba((0.4124564*b+0.3575761*c+0.1804375*e)/he),f=Ba((0.2126729*b+0.7151522*c+0.072175*e)/Qc);b=Ba((0.0193339*b+0.119192*c+0.9503041*e)/Rc);return ia(116*f-16,500*(d-f),200*(f-b))}function ra(b){return 0.04045>=(b/=255)?b/12.92:Math.pow((b+0.055)/1.055,2.4)}function Y(b){var c=parseFloat(b);return"%"===b.charAt(b.length-1)?Math.round(2.55*c):c}function ta(b,c,e){return new Na(b,c,e)}function Na(b,
c,e){this.h=b;this.s=c;this.l=e}function Qa(b,c,e){function d(b){return 360<b?b-=360:0>b&&(b+=360),60>b?f+(g-f)*b/60:180>b?g:240>b?f+(g-f)*(240-b)/60:f}var f,g;return b%=360,0>b&&(b+=360),c=0>c?0:1<c?1:c,e=0>e?0:1<e?1:e,g=0.5>=e?e*(1+c):e+c-e*c,f=2*e-g,R(Math.round(255*d(b+120)),Math.round(255*d(b)),Math.round(255*d(b-120)))}function Oa(b,c,e){return new fa(b,c,e)}function fa(b,c,e){this.h=b;this.c=c;this.l=e}function T(b,c,e){return ia(e,Math.cos(b*=Wa)*c,Math.sin(b)*c)}function ia(b,c,e){return new ea(b,
c,e)}function ea(b,c,e){this.l=b;this.a=c;this.b=e}function xa(b,c,e){b=(b+16)/116;c=b+c/500;e=b-e/200;return c=ya(c)*he,b=ya(b)*Qc,e=ya(e)*Rc,R(Ua(3.2404542*c-1.5371385*b-0.4985314*e),Ua(-0.969266*c+1.8760108*b+0.041556*e),Ua(0.0556434*c-0.2040259*b+1.0572252*e))}function Aa(b,c,e){return Oa(180*(Math.atan2(e,c)/Ga),Math.sqrt(c*c+e*e),b)}function ya(b){return 0.206893034<b?b*b*b:(b-4/29)/7.787037}function Ba(b){return 0.008856<b?Math.pow(b,1/3):7.787037*b+4/29}function Ua(b){return Math.round(255*
(0.00304>=b?12.92*b:1.055*Math.pow(b,1/2.4)-0.055))}function ha(b){return bd(b,ua),b}function Ra(b){return function(){return Wc(b,this)}}function Ha(b){return function(){return xd(b,this)}}function sa(b,c){function e(){this.removeAttribute(b)}function d(){this.removeAttributeNS(b.space,b.local)}function f(){this.setAttribute(b,c)}function g(){this.setAttributeNS(b.space,b.local,c)}function h(){var e=c.apply(this,arguments);null==e?this.removeAttribute(b):this.setAttribute(b,e)}function k(){var e=
c.apply(this,arguments);null==e?this.removeAttributeNS(b.space,b.local):this.setAttributeNS(b.space,b.local,e)}return b=d3.ns.qualify(b),null==c?b.local?d:e:"function"==typeof c?b.local?k:h:b.local?g:f}function eb(b){return RegExp("(?:^|\\s+)"+d3.requote(b)+"(?:\\s+|$)","g")}function Xa(b,c){function e(){for(var d=-1;f>++d;)b[d](this,c)}function d(){for(var e=-1,g=c.apply(this,arguments);f>++e;)b[e](this,g)}b=b.trim().split(/\s+/).map(zb);var f=b.length;return"function"==typeof c?d:e}function zb(b){var c=
eb(b);return function(e,d){if(f=e.classList)return d?f.add(b):f.remove(b);var f=e.className,g=null!=f.baseVal,h=g?f.baseVal:f;d?(c.lastIndex=0,c.test(h)||(h=(h+" "+b).trim().replace(/\s+/g," "),g?f.baseVal=h:e.className=h)):h&&(h=h.replace(c," ").trim().replace(/\s+/g," "),g?f.baseVal=h:e.className=h)}}function Pa(b,c,e){function d(){this.style.removeProperty(b)}function f(){this.style.setProperty(b,c,e)}function g(){var d=c.apply(this,arguments);null==d?this.style.removeProperty(b):this.style.setProperty(b,
d,e)}return null==c?d:"function"==typeof c?g:f}function va(b,c){function e(){delete this[b]}function d(){this[b]=c}function f(){var e=c.apply(this,arguments);null==e?delete this[b]:this[b]=e}return null==c?e:"function"==typeof c?f:d}function db(b){return function(){return Ac(this,b)}}function Ib(b){return arguments.length||(b=d3.ascending),function(c,e){return b(c&&c.__data__,e&&e.__data__)}}function Va(b,c,e){function d(){var c=this[g];c&&(this.removeEventListener(b,c,c.$),delete this[g])}function f(){function h(b){var e=
d3.event;d3.event=b;l[0]=k.__data__;try{c.apply(k,l)}finally{d3.event=e}}var k=this,l=kc(arguments);d.call(this);this.addEventListener(b,this[g]=h,h.$=e);h._=c}var g="__on"+b,h=b.indexOf(".");return 0<h&&(b=b.substring(0,h)),c?f:d}function Ta(b,c){for(var e=0,d=b.length;d>e;e++)for(var f,g=b[e],h=0,k=g.length;k>h;h++)(f=g[h])&&c(f,h,e);return b}function Ka(b){return bd(b,lb),b}function bb(b,c){return bd(b,Ob),b.id=c,b}function fb(b,c,e,d){var g=b.__transition__||(b.__transition__={active:0,count:0}),
h=g[e];if(!h){var k=d.time;return h=g[e]={tween:new f,event:d3.dispatch("start","end"),time:k,ease:d.ease,delay:d.delay,duration:d.duration},++g.count,d3.timer(function(d){function f(d){return g.active>e?p():(g.active=e,P.start.call(b,q,c),h.tween.forEach(function(e,d){(d=d.call(b,q,c))&&u.push(d)}),l(d)||d3.timer(l,0,k),1)}function l(d){if(g.active!==e)return p();d=(d-s)/t;for(var f=r(d),h=u.length;0<h;)u[--h].call(b,f);return 1<=d?(p(),P.end.call(b,q,c),1):void 0}function p(){return--g.count?delete g[e]:
delete b.__transition__,1}var q=b.__data__,r=h.ease,P=h.event,s=h.delay,t=h.duration,u=[];return d>=s?f(d):d3.timer(f,s,k),1},0,k),h}}function wa(b){return null==b&&(b=""),function(){this.textContent=b}}function oa(b,c,e,d){var f=b.id;return Ta(b,"function"==typeof e?function(b,g,h){b.__transition__[f].tween.set(c,d(e.call(b,b.__data__,g,h)))}:(e=d(e),function(b){b.__transition__[f].tween.set(c,e)}))}function Ia(){for(var b,c=Date.now(),e=ie;e;)b=c-e.then,b>=e.delay&&(e.flush=e.callback(b)),e=e.next;
b=x()-c;24<b?(isFinite(b)&&(clearTimeout(jd),jd=setTimeout(Ia,b)),Td=0):(Td=1,Lc(Ia))}function x(){for(var b=null,c=ie,e=1/0;c;)c.flush?(delete hf[c.callback.id],c=b?b.next=c.next:ie=c.next):(e=Math.min(e,c.then+c.delay),c=(b=c).next);return e}function cb(b,c){var e=b.ownerSVGElement||b;if(e.createSVGPoint){var d=e.createSVGPoint();if(0>jf&&(window.scrollX||window.scrollY)){var e=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0),f=e[0][0].getScreenCTM();
jf=!(f.f||f.e);e.remove()}return jf?(d.x=c.pageX,d.y=c.pageY):(d.x=c.clientX,d.y=c.clientY),d=d.matrixTransform(b.getScreenCTM().inverse()),[d.x,d.y]}e=b.getBoundingClientRect();return[c.clientX-e.left-b.clientLeft,c.clientY-e.top-b.clientTop]}function La(){}function jb(b){var c=b[0];b=b[b.length-1];return b>c?[c,b]:[b,c]}function Ab(b){return b.rangeExtent?b.rangeExtent():jb(b.range())}function ja(b,c){var e,d=0,f=b.length-1,g=b[d],h=b[f];return g>h&&(e=d,d=f,f=e,e=g,g=h,h=e),(c=c(h-g))&&(b[d]=c.floor(g),
b[f]=c.ceil(h)),b}function Vb(){return Math}function $a(b,c,e,d){function f(){var l=2<Math.min(b.length,c.length)?la:rc,p=d?N:Z;return h=l(b,c,p,e),k=l(c,b,p,d3.interpolate),g}function g(b){return h(b)}var h,k;return g.invert=function(b){return k(b)},g.domain=function(c){return arguments.length?(b=c.map(Number),f()):b},g.range=function(b){return arguments.length?(c=b,f()):c},g.rangeRound=function(b){return g.range(b).interpolate(d3.interpolateRound)},g.clamp=function(b){return arguments.length?(d=
b,f()):d},g.interpolate=function(b){return arguments.length?(e=b,f()):e},g.ticks=function(c){return Jb(b,c)},g.tickFormat=function(c){return Fb(b,c)},g.nice=function(){return ja(b,yb),f()},g.copy=function(){return $a(b,c,e,d)},f()}function za(b,c){return d3.rebind(b,c,"range","rangeRound","interpolate","clamp")}function yb(b){return b=Math.pow(10,Math.round(Math.log(b)/Math.LN10)-1),b&&{floor:function(c){return Math.floor(c/b)*b},ceil:function(c){return Math.ceil(c/b)*b}}}function gc(b,c){var e=jb(b),
d=e[1]-e[0],f=Math.pow(10,Math.floor(Math.log(d/c)/Math.LN10)),d=c/d*f;return 0.15>=d?f*=10:0.35>=d?f*=5:0.75>=d&&(f*=2),e[0]=Math.ceil(e[0]/f)*f,e[1]=Math.floor(e[1]/f)*f+0.5*f,e[2]=f,e}function Jb(b,c){return d3.range.apply(d3,gc(b,c))}function Fb(b,c){return d3.format(",."+Math.max(0,-Math.floor(Math.log(gc(b,c)[2])/Math.LN10+0.01))+"f")}function rc(b,c,e,d){var f=e(b[0],b[1]),g=d(c[0],c[1]);return function(b){return g(f(b))}}function la(b,c,e,d){var f=[],g=[],h=0,k=Math.min(b.length,c.length)-
1;for(b[k]<b[0]&&(b=b.slice().reverse(),c=c.slice().reverse());k>=++h;)f.push(e(b[h-1],b[h])),g.push(d(c[h-1],c[h]));return function(c){var e=d3.bisect(b,c,1,k)-1;return g[e](f[e](c))}}function ob(b,c){function e(d){return b(c(d))}var d=c.pow;return e.invert=function(c){return d(b.invert(c))},e.domain=function(f){return arguments.length?(c=0>f[0]?hc:Bc,d=c.pow,b.domain(f.map(c)),e):b.domain().map(d)},e.nice=function(){return b.domain(ja(b.domain(),Vb)),e},e.ticks=function(){var e=jb(b.domain()),f=
[];if(e.every(isFinite)){var g=Math.floor(e[0]),h=Math.ceil(e[1]),k=d(e[0]),e=d(e[1]);if(c===hc)for(f.push(d(g));h>g++;)for(var l=9;0<l;l--)f.push(d(g)*l);else{for(;h>g;g++)for(l=1;10>l;l++)f.push(d(g)*l);f.push(d(g))}for(g=0;k>f[g];g++);for(h=f.length;f[h-1]>e;h--);f=f.slice(g,h)}return f},e.tickFormat=function(b,f){if(2>arguments.length&&(f=ze),!arguments.length)return f;var g,h=Math.max(0.1,b/e.ticks().length),k=c===hc?(g=-1E-12,Math.floor):(g=1E-12,Math.ceil);return function(b){return h>=b/d(k(c(b)+
g))?f(b):""}},e.copy=function(){return ob(b.copy(),c)},za(e,b)}function Bc(b){return Math.log(0>b?0:b)/Math.LN10}function hc(b){return-Math.log(0<b?0:-b)/Math.LN10}function Gc(b,c){function e(c){return b(d(c))}var d=sc(c),f=sc(1/c);return e.invert=function(c){return f(b.invert(c))},e.domain=function(c){return arguments.length?(b.domain(c.map(d)),e):b.domain().map(f)},e.ticks=function(b){return Jb(e.domain(),b)},e.tickFormat=function(b){return Fb(e.domain(),b)},e.nice=function(){return e.domain(ja(e.domain(),
yb))},e.exponent=function(b){if(!arguments.length)return c;var g=e.domain();return d=sc(c=b),f=sc(1/c),e.domain(g)},e.copy=function(){return Gc(b.copy(),c)},za(e,b)}function sc(b){return function(c){return 0>c?-Math.pow(-c,b):Math.pow(c,b)}}function oc(b,c){function e(c){return h[((g.get(c)||g.set(c,b.push(c)))-1)%h.length]}function d(c,e){return d3.range(b.length).map(function(b){return c+e*b})}var g,h,k;return e.domain=function(d){if(!arguments.length)return b;b=[];g=new f;for(var h,k=-1,l=d.length;l>
++k;)g.has(h=d[k])||g.set(h,b.push(h));return e[c.t].apply(e,c.a)},e.range=function(b){return arguments.length?(h=b,k=0,c={t:"range",a:arguments},e):h},e.rangePoints=function(f,g){2>arguments.length&&(g=0);var l=f[0],p=f[1],q=(p-l)/(Math.max(1,b.length-1)+g);return h=d(2>b.length?(l+p)/2:l+q*g/2,q),k=0,c={t:"rangePoints",a:arguments},e},e.rangeBands=function(f,g,l){2>arguments.length&&(g=0);3>arguments.length&&(l=g);var p=f[1]<f[0],q=f[p-0],r=(f[1-p]-q)/(b.length-g+2*l);return h=d(q+r*l,r),p&&h.reverse(),
k=r*(1-g),c={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(f,g,l){2>arguments.length&&(g=0);3>arguments.length&&(l=g);var p=f[1]<f[0],q=f[p-0],r=f[1-p],P=Math.floor((r-q)/(b.length-g+2*l));return h=d(q+Math.round((r-q-(b.length-g)*P)/2),P),p&&h.reverse(),k=Math.round(P*(1-g)),c={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return k},e.rangeExtent=function(){return jb(c.a[0])},e.copy=function(){return oc(b,c)},e.domain(b)}function ga(b,c){function e(){var g=0,h=c.length;for(f=
[];h>++g;)f[g-1]=d3.quantile(b,g/h);return d}function d(b){return isNaN(b=+b)?0/0:c[d3.bisect(f,b)]}var f;return d.domain=function(c){return arguments.length?(b=c.filter(function(b){return!isNaN(b)}).sort(d3.ascending),e()):b},d.range=function(b){return arguments.length?(c=b,e()):c},d.quantiles=function(){return f},d.copy=function(){return ga(b,c)},e()}function Hc(b,c,e){function d(c){return e[Math.max(0,Math.min(h,Math.floor(g*(c-b))))]}function f(){return g=e.length/(c-b),h=e.length-1,d}var g,h;
return d.domain=function(e){return arguments.length?(b=+e[0],c=+e[e.length-1],f()):[b,c]},d.range=function(b){return arguments.length?(e=b,f()):e},d.copy=function(){return Hc(b,c,e)},f()}function Gb(b,c){function e(d){return c[d3.bisect(b,d)]}return e.domain=function(c){return arguments.length?(b=c,e):b},e.range=function(b){return arguments.length?(c=b,e):c},e.copy=function(){return Gb(b,c)},e}function Kb(b){function c(b){return+b}return c.invert=c,c.domain=c.range=function(e){return arguments.length?
(b=e.map(c),c):b},c.ticks=function(c){return Jb(b,c)},c.tickFormat=function(c){return Fb(b,c)},c.copy=function(){return Kb(b)},c}function Qb(b){return b.innerRadius}function Lb(b){return b.outerRadius}function xc(b){return b.startAngle}function tc(b){return b.endAngle}function uc(b){function c(h){function l(){r.push("M",g(b(P),p))}for(var q,r=[],P=[],s=-1,t=h.length,u=k(e),ma=k(d);t>++s;)f.call(this,q=h[s],s)?P.push([+u.call(this,q,s),+ma.call(this,q,s)]):P.length&&(l(),P=[]);return P.length&&l(),
r.length?r.join(""):null}var e=Bb,d=hd,f=h,g=mc,l=g.key,p=0.7;return c.x=function(b){return arguments.length?(e=b,c):e},c.y=function(b){return arguments.length?(d=b,c):d},c.defined=function(b){return arguments.length?(f=b,c):f},c.interpolate=function(b){return arguments.length?(l="function"==typeof b?g=b:(g=lc.get(b)||mc).key,c):l},c.tension=function(b){return arguments.length?(p=b,c):p},c}function Bb(b){return b[0]}function hd(b){return b[1]}function mc(b){return b.join("L")}function Rb(b){for(var c=
0,e=b.length,d=b[0],f=[d[0],",",d[1]];e>++c;)f.push("V",(d=b[c])[1],"H",d[0]);return f.join("")}function ld(b){for(var c=0,e=b.length,d=b[0],f=[d[0],",",d[1]];e>++c;)f.push("H",(d=b[c])[0],"V",d[1]);return f.join("")}function ed(b,c){if(1>c.length||b.length!=c.length&&b.length!=c.length+2)return mc(b);var e=b.length!=c.length,d="",f=b[0],g=b[1],h=c[0],k=h,l=1;if(e&&(d+="Q"+(g[0]-2*h[0]/3)+","+(g[1]-2*h[1]/3)+","+g[0]+","+g[1],f=b[1],l=2),1<c.length){k=c[1];g=b[l];l++;d+="C"+(f[0]+h[0])+","+(f[1]+
h[1])+","+(g[0]-k[0])+","+(g[1]-k[1])+","+g[0]+","+g[1];for(f=2;c.length>f;f++,l++)g=b[l],k=c[f],d+="S"+(g[0]-k[0])+","+(g[1]-k[1])+","+g[0]+","+g[1]}e&&(e=b[l],d+="Q"+(g[0]+2*k[0]/3)+","+(g[1]+2*k[1]/3)+","+e[0]+","+e[1]);return d}function md(b,c){for(var e,d=[],f=(1-c)/2,g=b[0],h=b[1],k=1,l=b.length;l>++k;)e=g,g=h,h=b[k],d.push([f*(h[0]-e[0]),f*(h[1]-e[1])]);return d}function fd(b){if(3>b.length)return mc(b);var c=1,e=b.length,d=b[0],f=d[0],g=d[1],h=[f,f,f,(d=b[1])[0]],k=[g,g,g,d[1]],f=[f,",",g];
for(Pb(f,h,k);e>++c;)d=b[c],h.shift(),h.push(d[0]),k.shift(),k.push(d[1]),Pb(f,h,k);for(c=-1;2>++c;)h.shift(),h.push(d[0]),k.shift(),k.push(d[1]),Pb(f,h,k);return f.join("")}function nc(b,c){return b[0]*c[0]+b[1]*c[1]+b[2]*c[2]+b[3]*c[3]}function Pb(b,c,e){b.push("C",nc(Ae,c),",",nc(Ae,e),",",nc(kd,c),",",nc(kd,e),",",nc(Ud,c),",",nc(Ud,e))}function gd(b,c){return(c[1]-b[1])/(c[0]-b[0])}function oe(b){for(var c,e,d,f=-1,g=b.length;g>++f;)c=b[f],e=c[0],d=c[1]+Za,c[0]=e*Math.cos(d),c[1]=e*Math.sin(d);
return b}function qa(b){function c(h){function q(){v.push("M",p(b(da),s),P,r(b(w.reverse()),s),"Z")}for(var t,u,ma,v=[],w=[],da=[],Ja=-1,y=h.length,qa=k(e),gf=k(f),z=e===d?function(){return u}:k(d),mb=f===g?function(){return ma}:k(g);y>++Ja;)l.call(this,t=h[Ja],Ja)?(w.push([u=+qa.call(this,t,Ja),ma=+gf.call(this,t,Ja)]),da.push([+z.call(this,t,Ja),+mb.call(this,t,Ja)])):w.length&&(q(),w=[],da=[]);return w.length&&q(),v.length?v.join(""):null}var e=Bb,d=Bb,f=0,g=hd,l=h,p=mc,q=p.key,r=p,P="L",s=0.7;
return c.x=function(b){return arguments.length?(e=d=b,c):d},c.x0=function(b){return arguments.length?(e=b,c):e},c.x1=function(b){return arguments.length?(d=b,c):d},c.y=function(b){return arguments.length?(f=g=b,c):g},c.y0=function(b){return arguments.length?(f=b,c):f},c.y1=function(b){return arguments.length?(g=b,c):g},c.defined=function(b){return arguments.length?(l=b,c):l},c.interpolate=function(b){return arguments.length?(q="function"==typeof b?p=b:(p=lc.get(b)||mc).key,r=p.reverse||p,P=p.closed?
"M":"L",c):q},c.tension=function(b){return arguments.length?(s=b,c):s},c}function da(b){return b.radius}function Yd(b){return[b.x,b.y]}function mf(b){return function(){var c=b.apply(this,arguments),e=c[0],c=c[1]+Za;return[e*Math.cos(c),e*Math.sin(c)]}}function Zd(){return 64}function Od(){return"circle"}function W(b){b=Math.sqrt(b/Ga);return"M0,"+b+"A"+b+","+b+" 0 1,1 0,"+-b+"A"+b+","+b+" 0 1,1 0,"+b+"Z"}function Te(b,c){b.attr("transform",function(b){return"translate("+c(b)+",0)"})}function $d(b,
c){b.attr("transform",function(b){return"translate(0,"+c(b)+")"})}function Gf(b,c,e){if(d=[],e&&1<c.length){for(var d,f,g=jb(b.domain()),h=-1,k=c.length,l=(c[1]-c[0])/++e;k>++h;)for(b=e;0<--b;)(f=+c[h]-b*l)>=g[0]&&d.push(f);--h;for(b=0;e>++b&&(f=+c[h]+b*l)<g[1];)d.push(f)}return d}function Be(){yd||(yd=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);
var b,c=d3.event;try{yd.scrollTop=1E3,yd.dispatchEvent(c),b=1E3-yd.scrollTop}catch(e){b=c.wheelDelta||5*-c.detail}return b}function Ce(b){var c=b.source;b=b.target;var e;var d=b;if(c===d)e=c;else{e=pe(c);for(var d=pe(d),f=e.pop(),g=d.pop(),h=null;f===g;)h=f,f=e.pop(),g=d.pop();e=h}for(d=[c];c!==e;)c=c.parent,d.push(c);for(c=d.length;b!==e;)d.splice(c,0,b),b=b.parent;return d}function pe(b){for(var c=[],e=b.parent;null!=e;)c.push(b),b=e,e=e.parent;return c.push(b),c}function ae(b){b.fixed|=2}function De(b){b.fixed&=
1}function qe(b){b.fixed|=4;b.px=b.x;b.py=b.y}function Ee(b){b.fixed&=3}function re(b,c,e){var d=0,f=0;if(b.charge=0,!b.leaf)for(var g,h=b.nodes,k=h.length,l=-1;k>++l;)g=h[l],null!=g&&(re(g,c,e),b.charge+=g.charge,d+=g.charge*g.cx,f+=g.charge*g.cy);b.point&&(b.leaf||(b.point.x+=Math.random()-0.5,b.point.y+=Math.random()-0.5),c*=e[b.point.index],b.charge+=b.pointCharge=c,d+=c*b.point.x,f+=c*b.point.y);b.cx=d/b.charge;b.cy=f/b.charge}function Ue(){return 20}function nf(){return 1}function Ve(b){return b.x}
function hb(b){return b.y}function We(b,c,e){b.y0=c;b.y=e}function Bd(b){return d3.range(b.length)}function Xe(b){var c=-1;b=b[0].length;for(var e=[];b>++c;)e[c]=0;return e}function of(b){for(var c,e=1,d=0,f=b[0][1],g=b.length;g>e;++e)(c=b[e][1])>f&&(d=e,f=c);return d}function Hf(b){return b.reduce(Fe,0)}function Fe(b,c){return b+c[1]}function se(b,c){return Ge(b,Math.ceil(Math.log(c.length)/Math.LN2+1))}function Ge(b,c){for(var e=-1,d=+b[0],f=(b[1]-d)/c,g=[];c>=++e;)g[e]=f*e+d;return g}function pf(b){return[d3.min(b),
d3.max(b)]}function be(b,c){return d3.rebind(b,c,"sort","children","value"),b.nodes=b,b.links=sf,b}function If(b){return b.children}function qf(b){return b.value}function rf(b,c){return c.value-b.value}function sf(b){return d3.merge(b.map(function(b){return(b.children||[]).map(function(c){return{source:b,target:c}})}))}function Pd(b,c){return b.value-c.value}function He(b,c){var e=b._pack_next;b._pack_next=c;c._pack_prev=b;c._pack_next=e;e._pack_prev=c}function Zc(b,c){b._pack_next=c;c._pack_prev=
b}function Ie(b,c){var e=c.x-b.x,d=c.y-b.y,f=b.r+c.r;return 0.001<f*f-e*e-d*d}function Ye(b){function c(b){q=Math.min(b.x-b.r,q);r=Math.max(b.x+b.r,r);P=Math.min(b.y-b.r,P);s=Math.max(b.y+b.r,s)}if((e=b.children)&&(p=e.length)){var e,d,f,g,h,k,l,p,q=1/0,r=-1/0,P=1/0,s=-1/0;if(e.forEach(Qd),d=e[0],d.x=-d.r,d.y=0,c(d),1<p&&(f=e[1],f.x=f.r,f.y=0,c(f),2<p)){g=e[2];tf(d,f,g);c(g);He(d,g);d._pack_prev=g;He(g,f);f=d._pack_next;for(h=3;p>h;h++){tf(d,f,g=e[h]);var t=0,u=1,ma=1;for(k=f._pack_next;k!==f;k=k._pack_next,
u++)if(Ie(k,g)){t=1;break}if(1==t)for(l=d._pack_prev;l!==k._pack_prev&&!Ie(l,g);l=l._pack_prev,ma++);t?(ma>u||u==ma&&f.r<d.r?Zc(d,f=k):Zc(d=l,f),h--):(He(d,g),f=g,c(g))}}d=(q+r)/2;f=(P+s)/2;for(h=k=0;p>h;h++)g=e[h],g.x-=d,g.y-=f,k=Math.max(k,g.r+Math.sqrt(g.x*g.x+g.y*g.y));b.r=k;e.forEach(Ze)}}function Qd(b){b._pack_next=b._pack_prev=b}function Ze(b){delete b._pack_next;delete b._pack_prev}function ce(b,c,e,d){var f=b.children;if(b.x=c+=d*b.x,b.y=e+=d*b.y,b.r*=d,f){b=-1;for(var g=f.length;g>++b;)ce(f[b],
c,e,d)}}function tf(b,c,e){var d=b.r+e.r,f=c.x-b.x,g=c.y-b.y;if(d&&(f||g)){var h=c.r+e.r,k=f*f+g*g,h=h*h,d=d*d;c=0.5+(d-h)/(2*k);h=Math.sqrt(Math.max(0,2*h*(d+k)-(d-=k)*d-h*h))/(2*k);e.x=b.x+c*f+h*g;e.y=b.y+c*g-h*f}else e.x=b.x+d,e.y=b.y}function uf(b){return 1+d3.max(b,function(b){return b.y})}function vf(b){return b.reduce(function(b,c){return b+c.x},0)/b.length}function Je(b){var c=b.children;return c&&c.length?Je(c[0]):b}function $e(b){var c,e=b.children;return e&&(c=e.length)?$e(e[c-1]):b}function af(b,
c){return b.parent==c.parent?1:2}function Ke(b){var c=b.children;return c&&c.length?c[0]:b._tree.thread}function te(b){var c,e=b.children;return e&&(c=e.length)?e[c-1]:b._tree.thread}function ue(b,c){var e=b.children;if(e&&(f=e.length))for(var d,f,g=-1;f>++g;)0<c(d=ue(e[g],c),b)&&(b=d);return b}function wf(b,c){return b.x-c.x}function Jf(b,c){return c.x-b.x}function Kf(b,c){return b.depth-c.depth}function nd(b,c){function e(b,d){var f=b.children;if(f&&(h=f.length))for(var g,h,k=null,l=-1;h>++l;)g=
f[l],e(g,k),k=g;c(b,d)}e(b,null)}function Le(b){return{x:b.x,y:b.y,dx:b.dx,dy:b.dy}}function sb(b,c){var e=b.x+c[3],d=b.y+c[0],f=b.dx-c[1]-c[3],g=b.dy-c[0]-c[2];return 0>f&&(e+=f/2,f=0),0>g&&(d+=g/2,g=0),{x:e,y:d,dx:f,dy:g}}function Me(b,c){function e(b,f){return d3.xhr(b,c,f).response(d)}function d(b){return e.parse(b.responseText)}function f(c){return c.map(g).join(b)}function g(b){return h.test(b)?'"'+b.replace(/\"/g,'""')+'"':b}var h=RegExp('["'+b+"\n]"),k=b.charCodeAt(0);return e.parse=function(b){var c;
return e.parseRows(b,function(b){return c?c(b):(c=Function("d","return {"+b.map(function(b,c){return JSON.stringify(b)+": d["+c+"]"}).join(",")+"}"),void 0)})},e.parseRows=function(b,c){function e(){if(q>=p)return h;if(f)return f=!1,g;var c=q;if(34===b.charCodeAt(c)){for(var d=c;p>d++;)if(34===b.charCodeAt(d)){if(34!==b.charCodeAt(d+1))break;++d}q=d+2;var l=b.charCodeAt(d+1);return 13===l?(f=!0,10===b.charCodeAt(d+2)&&++q):10===l&&(f=!0),b.substring(c+1,d).replace(/""/g,'"')}for(;p>q;){l=b.charCodeAt(q++);
d=1;if(10===l)f=!0;else if(13===l)f=!0,10===b.charCodeAt(q)&&(++q,++d);else if(l!==k)continue;return b.substring(c,q-d)}return b.substring(c)}for(var d,f,g={},h={},l=[],p=b.length,q=0,r=0;(d=e())!==h;){for(var P=[];d!==g&&d!==h;)P.push(d),d=e();(!c||(P=c(P,r++)))&&l.push(P)}return l},e.format=function(b){return b.map(f).join("\n")},e}function tb(b,c){Pe.hasOwnProperty(b.type)&&Pe[b.type](b,c)}function Ca(b,c,e){var d=-1,f=b.length-e;for(c.lineStart();f>++d;)e=b[d],c.point(e[0],e[1]);c.lineEnd()}function Sa(b,
c){var e=-1,d=b.length;for(c.polygonStart();d>++e;)Ca(b[e],c,1);c.polygonEnd()}function L(b){return[Math.atan2(b[1],b[0]),Math.asin(Math.max(-1,Math.min(1,b[2])))]}function pa(b,c){return nb>Math.abs(b[0]-c[0])&&nb>Math.abs(b[1]-c[1])}function Cb(b){var c=b[0];b=b[1];var e=Math.cos(b);return[e*Math.cos(c),e*Math.sin(c),Math.sin(b)]}function de(b,c){return b[0]*c[0]+b[1]*c[1]+b[2]*c[2]}function $c(b,c){return[b[1]*c[2]-b[2]*c[1],b[2]*c[0]-b[0]*c[2],b[0]*c[1]-b[1]*c[0]]}function qb(b){function c(d){function g(c,
e){c=b(c,e);d.point(c[0],c[1])}function h(){r=0/0;ma.point=k;d.lineStart()}function k(c,g){var h=Cb([c,g]),l=b(c,g);e(r,P,q,s,t,u,r=l[0],P=l[1],q=c,s=h[0],t=h[1],u=h[2],f,d);d.point(r,P)}function l(){ma.point=g;d.lineEnd()}function p(){var b,c,g,v,w,Tf;h();ma.point=function(e,d){k(b=e,d);c=r;g=P;v=s;w=t;Tf=u;ma.point=k};ma.lineEnd=function(){e(r,P,q,s,t,u,c,g,b,v,w,Tf,f,d);ma.lineEnd=l;l()}}var q,r,P,s,t,u,ma={point:g,lineStart:h,lineEnd:l,polygonStart:function(){d.polygonStart();ma.lineStart=p},
polygonEnd:function(){d.polygonEnd();ma.lineStart=h}};return ma}function e(c,f,g,h,k,l,p,q,r,P,s,t,u,ma){var v=p-c,w=q-f,da=v*v+w*w;if(da>4*d&&u--){var Ja=h+P,y=k+s,qa=l+t,z=Math.sqrt(Ja*Ja+y*y+qa*qa),mb=Math.asin(qa/=z),gf=nb>Math.abs(Math.abs(qa)-1)?(g+r)/2:Math.atan2(y,Ja),fc=b(gf,mb),mb=fc[0],fc=fc[1],x=mb-c,A=fc-f,B=w*x-v*A;(B*B/da>d||0.3<Math.abs((v*x+w*A)/da-0.5))&&(e(c,f,g,h,k,l,mb,fc,gf,Ja/=z,y/=z,qa,u,ma),ma.point(mb,fc),e(mb,fc,gf,Ja,y,qa,p,q,r,P,s,t,u,ma))}}var d=0.5,f=16;return c.precision=
function(b){return arguments.length?(f=0<(d=b*b)&&16,c):Math.sqrt(d)},c}function pb(b,c){function e(b,c){var d=Math.sqrt(g-2*f*Math.sin(c))/f;return[d*Math.sin(b*=f),h-d*Math.cos(b)]}var d=Math.sin(b),f=(d+Math.sin(c))/2,g=1+d*(2*f-d),h=Math.sqrt(g)/f;return e.invert=function(b,c){var e=h-c;return[Math.atan2(b,e)/f,Math.asin((g-(b*b+e*e)*f*f)/(2*f))]},e}function vb(b){function c(b,e){d>b&&(d=b);b>g&&(g=b);f>e&&(f=e);e>h&&(h=e)}function e(){k.point=k.lineEnd=La}var d,f,g,h,k={point:c,lineStart:La,
lineEnd:La,polygonStart:function(){k.lineEnd=e},polygonEnd:function(){k.point=c}};return function(c){return h=g=-(d=f=1/0),d3.geo.stream(c,b(k)),[[d,f],[g,h]]}}function ib(b,c){if(!wc){++Fc;b*=Wa;var e=Math.cos(c*=Wa);cc+=(e*Math.cos(b)-cc)/Fc;Yb+=(e*Math.sin(b)-Yb)/Fc;Eb+=(Math.sin(c)-Eb)/Fc}}function wb(){var b,c;wc=1;ve();wc=2;var e=Mc.point;Mc.point=function(d,f){e(b=d,c=f)};Mc.lineEnd=function(){Mc.point(b,c);Ne();Mc.lineEnd=Ne}}function ve(){function b(f,g){f*=Wa;var h=Math.cos(g*=Wa),k=h*Math.cos(f),
h=h*Math.sin(f),l=Math.sin(g),p=Math.atan2(Math.sqrt((p=e*l-d*h)*p+(p=d*k-c*l)*p+(p=c*h-e*k)*p),c*k+e*h+d*l);Fc+=p;cc+=p*(c+(c=k));Yb+=p*(e+(e=h));Eb+=p*(d+(d=l))}var c,e,d;1<wc||(1>wc&&(wc=1,Fc=cc=Yb=Eb=0),Mc.point=function(f,g){f*=Wa;var h=Math.cos(g*=Wa);c=h*Math.cos(f);e=h*Math.sin(f);d=Math.sin(g);Mc.point=b})}function Ne(){Mc.point=ib}function Oe(b,c){var e=Math.cos(b),d=Math.sin(b);return function(f,g,h,k){null!=f?(f=J(e,f),g=J(e,g),(0<h?g>f:f>g)&&(f+=2*h*Ga)):(f=b+2*h*Ga,g=b);for(var l,p=
h*c;0<h?f>g:g>f;f-=p)k.point((l=L([e,-d*Math.cos(f),-d*Math.sin(f)]))[0],l[1])}}function J(b,c){var e=Cb(c);e[0]-=b;var d=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=d;e[1]/=d;e[2]/=d;d=Math.acos(Math.max(-1,Math.min(1,-e[1])));return((0>-e[2]?-d:d)+2*Math.PI-nb)%(2*Math.PI)}function bf(b,c,e){return function(d){function f(c,e){b(c,e)&&d.point(c,e)}function g(b,c){ma.point(b,c)}function h(){v.point=g;ma.lineStart()}function k(){v.point=f;ma.lineEnd()}function l(b,c){da.point(b,c);u.push([b,c])}
function p(){da.lineStart();u=[]}function q(){l(u[0][0],u[0][1]);da.lineEnd();var b;b=da.clean();var c=w.buffer(),e=c.length;if(!e)return t=!0,s+=df(u,-1),u=null,void 0;if(u=null,1&b){b=c[0];P+=df(b,1);var f,e=b.length-1,c=-1;for(d.lineStart();e>++c;)d.point((f=b[c])[0],f[1]);return d.lineEnd(),void 0}1<e&&2&b&&c.push(c.pop().concat(c.shift()));r.push(c.filter(yf))}var r,P,s,t,u,ma=c(d),v={point:f,lineStart:h,lineEnd:k,polygonStart:function(){v.point=l;v.lineStart=p;v.lineEnd=q;t=!1;s=P=0;r=[];d.polygonStart()},
polygonEnd:function(){v.point=f;v.lineStart=h;v.lineEnd=k;r=d3.merge(r);r.length?Lf(r,e,d):(-nb>P||t&&-nb>s)&&(d.lineStart(),e(null,null,1,d),d.lineEnd());d.polygonEnd();r=null},sphere:function(){d.polygonStart();d.lineStart();e(null,null,1,d);d.lineEnd();d.polygonEnd()}},w=cf(),da=c(w);return v}}function Lf(b,c,e){var d=[],f=[];if(b.forEach(function(b){var c=b.length;if(!(1>=c)){var e=b[0],c=b[c-1];b={point:e,points:b,other:null,visited:!1,entry:!0,subject:!0};e={point:e,points:[e],other:b,visited:!1,
entry:!1,subject:!1};b.other=e;d.push(b);f.push(e);b={point:c,points:[c],other:null,visited:!1,entry:!1,subject:!0};e={point:c,points:[c],other:b,visited:!1,entry:!0,subject:!1};b.other=e;d.push(b);f.push(e)}}),f.sort(xf),Sb(d),Sb(f),d.length)for(var g,h,k=d[0];;){for(b=k;b.visited;)if((b=b.next)===k)return;g=b.points;e.lineStart();do{if(b.visited=b.other.visited=!0,b.entry){if(b.subject)for(var l=0;g.length>l;l++)e.point((h=g[l])[0],h[1]);else c(b.point,b.next.point,1,e);b=b.next}else{if(b.subject){g=
b.prev.points;for(l=g.length;0<=--l;)e.point((h=g[l])[0],h[1])}else c(b.point,b.prev.point,-1,e);b=b.prev}b=b.other;g=b.points}while(!b.visited);e.lineEnd()}}function Sb(b){if(c=b.length){for(var c,e,d=0,f=b[0];c>++d;)f.next=e=b[d],e.prev=f,f=e;f.next=e=b[0];e.prev=f}}function xf(b,c){return(0>(b=b.point)[0]?b[1]-Ga/2-nb:Ga/2-b[1])-(0>(c=c.point)[0]?c[1]-Ga/2-nb:Ga/2-c[1])}function yf(b){return 1<b.length}function cf(){var b,c=[];return{lineStart:function(){c.push(b=[])},point:function(c,e){b.push([c,
e])},lineEnd:La,buffer:function(){var e=c;return c=[],b=null,e}}}function df(b,c){if(!(e=b.length))return 0;var e,d,f,g=0,h=0;d=b[0];f=d[0];for(var k=d[1],l=Math.cos(k),p=Math.atan2(c*Math.sin(f)*l,Math.sin(k)),q=1-c*Math.cos(f)*l,r=p;e>++g;)d=b[g],l=Math.cos(k=d[1]),d=Math.atan2(c*Math.sin(f=d[0])*l,Math.sin(k)),f=1-c*Math.cos(f)*l,nb>Math.abs(q-2)&&nb>Math.abs(f-2)||(nb>Math.abs(f)||nb>Math.abs(q)||(nb>Math.abs(Math.abs(d-p)-Ga)?2<f+q&&(h+=4*(d-p)):h+=nb>Math.abs(q-2)?4*(d-r):((3*Ga+d-p)%(2*Ga)-
Ga)*(q+f)),r=p,p=d,q=f);return h}function ic(b){function c(b,e){return Math.cos(b)*Math.cos(e)>d}function e(b,c){var f=Cb(b,0),g=Cb(c,0),h=[1,0,0],g=$c(f,g),k=de(g,g),f=g[0],l=k-f*f;if(!l)return b;k=d*k/l;l=-d*f/l;f=$c(h,g);h=[h[0]*k,h[1]*k,h[2]*k];g=[g[0]*l,g[1]*l,g[2]*l];h[0]+=g[0];h[1]+=g[1];h[2]+=g[2];g=de(h,f);k=de(f,f);l=Math.sqrt(g*g-k*(de(h,h)-1));f=[f[0]*((-g-l)/k),f[1]*((-g-l)/k),f[2]*((-g-l)/k)];f[0]+=h[0];f[1]+=h[1];f[2]+=h[2];return L(f)}b*=Wa;var d=Math.cos(b);b=Oe(b,6*Wa);return bf(c,
function(b){var d,f,g,h;return{lineStart:function(){g=f=!1;h=1},point:function(k,l){var p,q=[k,l],r=c(k,l);!d&&(g=f=r)&&b.lineStart();r!==f&&(p=e(d,q),(pa(d,p)||pa(q,p))&&(q[0]+=nb,q[1]+=nb,r=c(q[0],q[1])));r!==f&&(h=0,(f=r)?(b.lineStart(),p=e(q,d),b.point(p[0],p[1])):(p=e(d,q),b.point(p[0],p[1]),b.lineEnd()),d=p);!r||d&&pa(d,q)||b.point(q[0],q[1]);d=q},lineEnd:function(){f&&b.lineEnd();d=null},clean:function(){return h|(g&&f)<<1}}},b)}function zf(b,c){function e(d,f){return d=b(d,f),c(d[0],d[1])}
return b.invert&&c.invert&&(e.invert=function(e,d){return e=c.invert(e,d),e&&b.invert(e[0],e[1])}),e}function dc(b,c){return[b,c]}function kb(b,c,e){var d=d3.range(b,c-nb,e).concat(c);return function(b){return d.map(function(c){return[b,c]})}}function Ya(b,c,e){var d=d3.range(b,c-nb,e).concat(c);return function(b){return d.map(function(c){return[c,b]})}}function Mb(b,c,e,d){function f(b){var c=Math.sin(b*=P)*s,e=Math.sin(P-b)*s;b=e*l+c*q;var d=e*p+c*r,c=e*h+c*k;return[Math.atan2(d,b)/Wa,Math.atan2(c,
Math.sqrt(b*b+d*d))/Wa]}var g=Math.cos(c),h=Math.sin(c);c=Math.cos(d);var k=Math.sin(d),l=g*Math.cos(b),p=g*Math.sin(b),q=c*Math.cos(e),r=c*Math.sin(e),P=Math.acos(Math.max(-1,Math.min(1,h*k+g*c*Math.cos(e-b)))),s=1/Math.sin(P);return f.distance=P,f}function we(b,c){return[b/(2*Ga),Math.max(-0.5,Math.min(0.5,Math.log(Math.tan(Ga/4+c/2))/(2*Ga)))]}function ef(b){return"m0,"+b+"a"+b+","+b+" 0 1,1 0,"+-2*b+"a"+b+","+b+" 0 1,1 0,"+2*b+"z"}function Af(b){var c=qb(function(c,e){return b([c*Tb,e*Tb])});
return function(b){return b=c(b),{point:function(c,e){b.point(c*Wa,e*Wa)},sphere:function(){b.sphere()},lineStart:function(){b.lineStart()},lineEnd:function(){b.lineEnd()},polygonStart:function(){b.polygonStart()},polygonEnd:function(){b.polygonEnd()}}}}function ub(){function b(c,e){h.push("M",c,",",e,g)}function c(b,d){h.push("M",b,",",d);k.point=e}function e(b,c){h.push("L",b,",",c)}function d(){k.point=b}function f(){h.push("Z")}var g=ef(4.5),h=[],k={point:b,lineStart:function(){k.point=c},lineEnd:d,
polygonStart:function(){k.lineEnd=f},polygonEnd:function(){k.lineEnd=d;k.point=b},pointRadius:function(b){return g=ef(b),k},result:function(){if(h.length){var b=h.join("");return h=[],b}}};return k}function Nb(b){function c(e,d){b.moveTo(e,d);b.arc(e,d,h,0,2*Ga)}function e(c,f){b.moveTo(c,f);k.point=d}function d(c,e){b.lineTo(c,e)}function f(){k.point=c}function g(){b.closePath()}var h=4.5,k={point:c,lineStart:function(){k.point=e},lineEnd:f,polygonStart:function(){k.lineEnd=g},polygonEnd:function(){k.lineEnd=
f;k.point=c},pointRadius:function(b){return h=b,k},result:La};return k}function Cd(){function b(c,e){mb+=f*c-d*e;d=c;f=e}var c,e,d,f;fc.point=function(g,h){fc.point=b;c=d=g;e=f=h};fc.lineEnd=function(){b(c,e)}}function Da(b,c){wc||(cc+=b,Yb+=c,++Eb)}function jc(){function b(d,f){var g=d-c,h=f-e,g=Math.sqrt(g*g+h*h);cc+=g*(c+d)/2;Yb+=g*(e+f)/2;Eb+=g;c=d;e=f}var c,e;if(1!==wc){if(!(1>wc))return;wc=1;cc=Yb=Eb=0}zd.point=function(d,f){zd.point=b;c=d;e=f}}function Cc(){zd.point=Da}function Dd(){function b(c,
e){var g=f*c-d*e;cc+=g*(d+c);Yb+=g*(f+e);Eb+=3*g;d=c;f=e}var c,e,d,f;2>wc&&(wc=2,cc=Yb=Eb=0);zd.point=function(g,h){zd.point=b;c=d=g;e=f=h};zd.lineEnd=function(){b(c,e)}}function ad(){function b(c,e){if(c*=Wa,e*=Wa,!(nb>Math.abs(Math.abs(g)-Ga/2)&&nb>Math.abs(Math.abs(e)-Ga/2))){var l=Math.cos(e),p=Math.sin(e);if(nb>Math.abs(g-Ga/2))je+=2*(c-d);else{var q=c-f,r=Math.cos(q),P=Math.atan2(Math.sqrt((P=l*Math.sin(q))*P+(P=h*p-k*l*r)*P),k*p+h*l*r),r=(P+Ga+g+e)/4;je+=(0>q&&q>-Ga||q>Ga?-4:4)*Math.atan(Math.sqrt(Math.abs(Math.tan(r)*
Math.tan(r-P/2)*Math.tan(r-Ga/4-g/2)*Math.tan(r-Ga/4-e/2))))}d=f;f=c;g=e;h=l;k=p}}var c,e,d,f,g,h,k;ke.point=function(l,p){ke.point=b;d=f=(c=l)*Wa;g=(e=p)*Wa;h=Math.cos(g);k=Math.sin(g)};ke.lineEnd=function(){b(c,e)}}function Ea(b){return Oc(function(){return b})()}function Oc(b){function c(b){return b=h(b[0]*Wa,b[1]*Wa),[b[0]*q+k,l-b[1]*q]}function e(b){return b=h.invert((b[0]-k)/q,(l-b[1])/q),b&&[b[0]*Tb,b[1]*Tb]}function d(){h=zf(g=Pc(u,ma,v),f);var b=f(s,t);return k=r-b[0]*q,l=P+b[1]*q,c}var f,
g,h,k,l,p=qb(function(b,c){return b=f(b,c),[b[0]*q+k,l-b[1]*q]}),q=150,r=480,P=250,s=0,t=0,u=0,ma=0,v=0,w=Bf,da=null;return c.stream=function(b){return gb(g,w(p(b)))},c.clipAngle=function(b){return arguments.length?(w=null==b?(da=b,Bf):ic(da=+b),c):da},c.scale=function(b){return arguments.length?(q=+b,d()):q},c.translate=function(b){return arguments.length?(r=+b[0],P=+b[1],d()):[r,P]},c.center=function(b){return arguments.length?(s=b[0]%360*Wa,t=b[1]%360*Wa,d()):[s*Tb,t*Tb]},c.rotate=function(b){return arguments.length?
(u=b[0]%360*Wa,ma=b[1]%360*Wa,v=2<b.length?b[2]%360*Wa:0,d()):[u*Tb,ma*Tb,v*Tb]},d3.rebind(c,p,"precision"),function(){return f=b.apply(this,arguments),c.invert=f.invert&&e,d()}}function gb(b,c){return{point:function(e,d){d=b(e*Wa,d*Wa);e=d[0];c.point(e>Ga?e-2*Ga:-Ga>e?e+2*Ga:e,d[1])},sphere:function(){c.sphere()},lineStart:function(){c.lineStart()},lineEnd:function(){c.lineEnd()},polygonStart:function(){c.polygonStart()},polygonEnd:function(){c.polygonEnd()}}}function Pc(b,c,e){return b?c||e?zf(id(b),
Ed(c,e)):id(b):c||e?Ed(c,e):dc}function od(b){return function(c,e){return c+=b,[c>Ga?c-2*Ga:-Ga>c?c+2*Ga:c,e]}}function id(b){var c=od(b);return c.invert=od(-b),c}function Ed(b,c){function e(b,c){var k=Math.cos(c),l=Math.cos(b)*k,k=Math.sin(b)*k,p=Math.sin(c),q=p*d+l*f;return[Math.atan2(k*g-q*h,l*d-p*f),Math.asin(Math.max(-1,Math.min(1,q*g+k*h)))]}var d=Math.cos(b),f=Math.sin(b),g=Math.cos(c),h=Math.sin(c);return e.invert=function(b,c){var e=Math.cos(c),k=Math.cos(b)*e,e=Math.sin(b)*e,l=Math.sin(c),
p=l*g-e*h;return[Math.atan2(e*g+l*h,k*d+p*f),Math.asin(Math.max(-1,Math.min(1,p*d-k*f)))]},e}function Hb(b,c){function e(c,d){var f=Math.cos(c),g=Math.cos(d),f=b(f*g);return[f*g*Math.sin(c),f*Math.sin(d)]}return e.invert=function(b,e){var d=Math.sqrt(b*b+e*e),f=c(d),g=Math.sin(f),f=Math.cos(f);return[Math.atan2(b*g,d*f),Math.asin(d&&e*g/d)]},e}function pd(b,c,e,d){var f,g,h,k,l,p,q;return f=d[b],g=f[0],h=f[1],f=d[c],k=f[0],l=f[1],f=d[e],p=f[0],q=f[1],0<(q-h)*(k-g)-(l-h)*(p-g)}function xb(b,c,e){return(e[0]-
c[0])*(b[1]-c[1])<(e[1]-c[1])*(b[0]-c[0])}function Wb(b,c,e,d){var f=b[0],g=e[0],h=c[0]-f,k=d[0]-g;b=b[1];e=e[1];c=c[1]-b;d=d[1]-e;g=(k*(b-e)-d*(f-g))/(d*h-k*c);return[f+g*h,b+g*c]}function xe(b,c){var e=b.map(function(b,c){return{index:c,x:b[0],y:b[1]}}).sort(function(b,c){return b.y<c.y?-1:b.y>c.y?1:b.x<c.x?-1:b.x>c.x?1:0}),d=null,f={list:[],leftEnd:null,rightEnd:null,init:function(){f.leftEnd=f.createHalfEdge(null,"l");f.rightEnd=f.createHalfEdge(null,"l");f.leftEnd.r=f.rightEnd;f.rightEnd.l=f.leftEnd;
f.list.unshift(f.leftEnd,f.rightEnd)},createHalfEdge:function(b,c){return{edge:b,side:c,vertex:null,l:null,r:null}},insert:function(b,c){c.l=b;c.r=b.r;b.r.l=c;b.r=c},leftBound:function(b){var c=f.leftEnd;do c=c.r;while(c!=f.rightEnd&&g.rightOf(c,b));return c.l},del:function(b){b.l.r=b.r;b.r.l=b.l;b.edge=null},right:function(b){return b.r},left:function(b){return b.l},leftRegion:function(b){return null==b.edge?d:b.edge.region[b.side]},rightRegion:function(b){return null==b.edge?d:b.edge.region[Mf[b.side]]}},
g={bisect:function(b,c){var e={region:{l:b,r:c},ep:{l:null,r:null}},d=c.x-b.x,f=c.y-b.y;return e.c=b.x*d+b.y*f+0.5*(d*d+f*f),(0<d?d:-d)>(0<f?f:-f)?(e.a=1,e.b=f/d,e.c/=d):(e.b=1,e.a=d/f,e.c/=f),e},intersect:function(b,c){var e=b.edge,d=c.edge;if(!e||!d||e.region.r==d.region.r)return null;var f=e.a*d.b-e.b*d.a;if(1E-10>Math.abs(f))return null;var g,h,k=(e.c*d.b-d.c*e.b)/f,f=(d.c*e.a-e.c*d.a)/f,l=e.region.r,p=d.region.r;l.y<p.y||l.y==p.y&&l.x<p.x?(g=b,h=e):(g=c,h=d);return(e=k>=h.region.r.x)&&"l"===
g.side||!e&&"r"===g.side?null:{x:k,y:f}},rightOf:function(b,c){var e=b.edge,d=e.region.r,f=c.x>d.x;if(f&&"l"===b.side)return 1;if(!f&&"r"===b.side)return 0;if(1===e.a){var g=c.y-d.y,h=c.x-d.x,k=0;!f&&0>e.b||f&&0<=e.b?k=g>=e.b*h:(k=c.x+c.y*e.b>e.c,0>e.b&&(k=!k));d=d.x-e.region.l.x;k=e.b*(h*h-g*g)<d*g*(1+2*h/d+e.b*e.b);0>e.b&&(k=!k)}else h=e.c-e.a*c.x,e=c.y-h,g=c.x-d.x,d=h-d.y,k=e*e>g*g+d*d;return"l"===b.side?k:!k},endPoint:function(b,e,d){b.ep[e]=d;b.ep[Mf[e]]&&c(b)},distance:function(b,c){var e=b.x-
c.x,d=b.y-c.y;return Math.sqrt(e*e+d*d)}},h={list:[],insert:function(b,c,e){b.vertex=c;b.ystar=c.y+e;e=0;for(var d=h.list,f=d.length;f>e;e++){var g=d[e];if(!(b.ystar>g.ystar||b.ystar==g.ystar&&c.x>g.vertex.x))break}d.splice(e,0,b)},del:function(b){for(var c=0,e=h.list,d=e.length;d>c&&e[c]!=b;++c);e.splice(c,1)},empty:function(){return 0===h.list.length},nextEvent:function(b){for(var c=0,e=h.list,d=e.length;d>c;++c)if(e[c]==b)return e[c+1];return null},min:function(){var b=h.list[0];return{x:b.vertex.x,
y:b.ystar}},extractMin:function(){return h.list.shift()}};f.init();for(var d=e.shift(),k,l,p,q,r,P,s,t,u,ma,v=e.shift();;)if(h.empty()||(k=h.min()),v&&(h.empty()||v.y<k.y||v.y==k.y&&v.x<k.x))l=f.leftBound(v),p=f.right(l),s=f.rightRegion(l),ma=g.bisect(s,v),P=f.createHalfEdge(ma,"l"),f.insert(l,P),(u=g.intersect(l,P))&&(h.del(l),h.insert(l,u,g.distance(u,v))),l=P,P=f.createHalfEdge(ma,"r"),f.insert(l,P),(u=g.intersect(P,p))&&h.insert(P,u,g.distance(u,v)),v=e.shift();else{if(h.empty())break;l=h.extractMin();
q=f.left(l);p=f.right(l);r=f.right(p);s=f.leftRegion(l);P=f.rightRegion(p);u=l.vertex;g.endPoint(l.edge,l.side,u);g.endPoint(p.edge,p.side,u);f.del(l);h.del(p);f.del(p);l="l";s.y>P.y&&(t=s,s=P,P=t,l="r");ma=g.bisect(s,P);P=f.createHalfEdge(ma,l);f.insert(q,P);g.endPoint(ma,Mf[l],u);(u=g.intersect(q,P))&&(h.del(q),h.insert(q,u,g.distance(u,s)));(u=g.intersect(P,r))&&h.insert(P,u,g.distance(u,s))}for(l=f.right(f.leftEnd);l!=f.rightEnd;l=f.right(l))c(l.edge)}function Fd(b,c,e,d,f,g){if(!b(c,e,d,f,g)){var h=
0.5*(e+f),k=0.5*(d+g);c=c.nodes;c[0]&&Fd(b,c[0],e,d,h,k);c[1]&&Fd(b,c[1],h,d,f,k);c[2]&&Fd(b,c[2],e,k,h,g);c[3]&&Fd(b,c[3],h,k,f,g)}}function Xc(){this._=new Date(1<arguments.length?Date.UTC.apply(this,arguments):arguments[0])}function qd(b,c,e,d){for(var f,g,h=0,k=c.length,l=e.length;k>h;){if(d>=l)return-1;if(f=c.charCodeAt(h++),37===f){if(g=dg[c.charAt(h++)],!g||0>(d=g(b,e,d)))return-1}else if(f!=e.charCodeAt(d++))return-1}return d}function rd(b){return RegExp("^(?:"+b.map(d3.requote).join("|")+
")","i")}function ye(b){for(var c=new f,e=-1,d=b.length;d>++e;)c.set(b[e].toLowerCase(),e);return c}function Zb(b,c,e){b+="";var d=b.length;return e>d?Array(e-d+1).join(c)+b:b}function sd(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+2)))?(b.d=+c[0],e+c[0].length):-1}function td(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+2)))?(b.H=+c[0],e+c[0].length):-1}function ee(b){return b.toISOString()}function Uc(b,c,e){function d(c){var e=b(c),f=g(e,1);return f-c>c-e?e:f}function f(e){return c(e=
b(new Tc(e-1)),1),e}function g(b,e){return c(b=new Tc(+b),e),b}function h(b,d,g){b=f(b);var k=[];if(1<g)for(;d>b;)e(b)%g||k.push(new Date(+b)),c(b,1);else for(;d>b;)k.push(new Date(+b)),c(b,1);return k}b.floor=b;b.round=d;b.ceil=f;b.offset=g;b.range=h;var k=b.utc=Dc(b);return k.floor=k,k.round=Dc(d),k.ceil=Dc(f),k.offset=Dc(g),k.range=function(b,c,e){try{Tc=Xc;var d=new Xc;return d._=b,h(d,c,e)}finally{Tc=Date}},b}function Dc(b){return function(c,e){try{Tc=Xc;var d=new Xc;return d._=c,b(d,e)._}finally{Tc=
Date}}}function ec(b,c,e){function d(c){return b(c)}return d.invert=function(c){return Xb(b.invert(c))},d.domain=function(c){return arguments.length?(b.domain(c),d):b.domain().map(Xb)},d.nice=function(b){return d.domain(ja(d.domain(),function(){return b}))},d.ticks=function(e,f){var g,h=d.domain();g=h[0];h=h[h.length-1];g=h>g?[g,h]:[h,g];if("function"!=typeof e){var h=(g[1]-g[0])/e,k=d3.bisect(Cf,h);if(k==Cf.length)return c.year(g,e);if(!k)return b.ticks(e).map(Xb);Math.log(h/Cf[k-1])<Math.log(Cf[k]/
h)&&--k;e=c[k];f=e[1];e=e[0].range}return e(g[0],new Date(+g[1]+1),f)},d.tickFormat=function(){return e},d.copy=function(){return ec(b.copy(),c,e)},d3.rebind(d,b,"range","rangeRound","interpolate","clamp")}function Xb(b){return new Date(b)}function Gd(b){return function(c){for(var e=b.length-1,d=b[e];!d[1](c);)d=b[--e];return d[0](c)}}function ud(b){var c=new Date(b,0,1);return c.setFullYear(b),c}function $b(b){var c=b.getFullYear(),e=ud(c),d=ud(c+1);return c+(b-e)/(d-e)}function ac(b){var c=new Date(Date.UTC(b,
0,1));return c.setUTCFullYear(b),c}function Db(b){var c=b.getUTCFullYear(),e=ac(c),d=ac(c+1);return c+(b-e)/(d-e)}var vd=[3,3];Date.now||(Date.now=function(){return+new Date});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Vc){var fe=CSSStyleDeclaration.prototype,ge=fe.setProperty;fe.setProperty=function(b,c,e){ge.call(this,b,c+"",e)}}d3={version:"3.0.4"};var Ga=Math.PI,nb=1E-6,Wa=Ga/180,Tb=180/Ga,kc=function(b){return Array.prototype.slice.call(b)};try{kc(document.documentElement.childNodes)[0].nodeType}catch(ff){kc=
e}var bd=[].__proto__?function(b,c){b.__proto__=c}:function(b,c){for(var e in c)b[e]=c[e]};d3.map=function(b){var c=new f,e;for(e in b)c.set(e,b[e]);return c};(function(b,c){try{for(var e in c)Object.defineProperty(b.prototype,e,{value:c[e],enumerable:!1})}catch(d){b.prototype=c}})(f,{has:function(b){return Hd+b in this},get:function(b){return this[Hd+b]},set:function(b,c){return this[Hd+b]=c},remove:function(b){return b=Hd+b,b in this&&delete this[b]},keys:function(){var b=[];return this.forEach(function(c){b.push(c)}),
b},values:function(){var b=[];return this.forEach(function(c,e){b.push(e)}),b},entries:function(){var b=[];return this.forEach(function(c,e){b.push({key:c,value:e})}),b},forEach:function(b){for(var c in this)c.charCodeAt(0)===Rd&&b.call(this,c.substring(1),this[c])}});var Hd="\x00",Rd=Hd.charCodeAt(0);d3.functor=k;d3.rebind=function(b,c){for(var e,d=1,f=arguments.length;f>++d;)b[e=arguments[d]]=l(b,c,c[e]);return b};d3.ascending=function(b,c){return c>b?-1:b>c?1:b>=c?0:0/0};d3.descending=function(b,
c){return b>c?-1:c>b?1:c>=b?0:0/0};d3.mean=function(b,c){var e,d=b.length,f=0,g=-1,h=0;if(1===arguments.length)for(;d>++g;)p(e=b[g])&&(f+=(e-f)/++h);else for(;d>++g;)p(e=c.call(b,b[g],g))&&(f+=(e-f)/++h);return h?f:void 0};d3.median=function(b,c){return 1<arguments.length&&(b=b.map(c)),b=b.filter(p),b.length?d3.quantile(b.sort(d3.ascending),0.5):void 0};d3.min=function(b,c){var e,d,f=-1,g=b.length;if(1===arguments.length){for(;g>++f&&(null==(e=b[f])||e!=e);)e=void 0;for(;g>++f;)null!=(d=b[f])&&e>
d&&(e=d)}else{for(;g>++f&&(null==(e=c.call(b,b[f],f))||e!=e);)e=void 0;for(;g>++f;)null!=(d=c.call(b,b[f],f))&&e>d&&(e=d)}return e};d3.max=function(b,c){var e,d,f=-1,g=b.length;if(1===arguments.length){for(;g>++f&&(null==(e=b[f])||e!=e);)e=void 0;for(;g>++f;)null!=(d=b[f])&&d>e&&(e=d)}else{for(;g>++f&&(null==(e=c.call(b,b[f],f))||e!=e);)e=void 0;for(;g>++f;)null!=(d=c.call(b,b[f],f))&&d>e&&(e=d)}return e};d3.extent=function(b,c){var e,d,f,g=-1,h=b.length;if(1===arguments.length){for(;h>++g&&(null==
(e=f=b[g])||e!=e);)e=f=void 0;for(;h>++g;)null!=(d=b[g])&&(e>d&&(e=d),d>f&&(f=d))}else{for(;h>++g&&(null==(e=f=c.call(b,b[g],g))||e!=e);)e=void 0;for(;h>++g;)null!=(d=c.call(b,b[g],g))&&(e>d&&(e=d),d>f&&(f=d))}return[e,f]};d3.random={normal:function(b,c){var e=arguments.length;return 2>e&&(c=1),1>e&&(b=0),function(){var e,d;do e=2*Math.random()-1,d=2*Math.random()-1,d=e*e+d*d;while(!d||1<d);return b+c*e*Math.sqrt(-2*Math.log(d)/d)}},logNormal:function(b,c){var e=arguments.length;2>e&&(c=1);1>e&&(b=
0);var d=d3.random.normal();return function(){return Math.exp(b+c*d())}},irwinHall:function(b){return function(){for(var c=0,e=0;b>e;e++)c+=Math.random();return c/b}}};d3.sum=function(b,c){var e,d=0,f=b.length,g=-1;if(1===arguments.length)for(;f>++g;)isNaN(e=+b[g])||(d+=e);else for(;f>++g;)isNaN(e=+c.call(b,b[g],g))||(d+=e);return d};d3.quantile=function(b,c){var e=(b.length-1)*c+1,d=Math.floor(e),f=+b[d-1];return(e-=d)?f+e*(b[d]-f):f};d3.shuffle=function(b){for(var c,e,d=b.length;d;)e=0|Math.random()*
d--,c=b[d],b[d]=b[e],b[e]=c;return b};d3.transpose=function(b){return d3.zip.apply(d3,b)};d3.zip=function(){if(!(d=arguments.length))return[];for(var b=-1,c=d3.min(arguments,q),e=Array(c);c>++b;)for(var d,f=-1,g=e[b]=Array(d);d>++f;)g[f]=arguments[f][b];return e};d3.bisector=function(b){return{left:function(c,e,d,f){3>arguments.length&&(d=0);for(4>arguments.length&&(f=c.length);f>d;){var g=d+f>>>1;e>b.call(c,c[g],g)?d=g+1:f=g}return d},right:function(c,e,d,f){3>arguments.length&&(d=0);for(4>arguments.length&&
(f=c.length);f>d;){var g=d+f>>>1;b.call(c,c[g],g)>e?f=g:d=g+1}return d}}};var Id=d3.bisector(function(b){return b});d3.bisectLeft=Id.left;d3.bisect=d3.bisectRight=Id.right;d3.nest=function(){function b(c,k){if(k>=h.length)return d?d.call(g,c):e?c.sort(e):c;for(var l,p,q,r=-1,P=c.length,s=h[k++],t=new f,u={};P>++r;)(q=t.get(l=s(p=c[r])))?q.push(p):t.set(l,[p]);return t.forEach(function(c,e){u[c]=b(e,k)}),u}function c(b,e){if(e>=h.length)return b;var d,f=[],g=k[e++];for(d in b)f.push({key:d,values:c(b[d],
e)});return g&&f.sort(function(b,c){return g(b.key,c.key)}),f}var e,d,g={},h=[],k=[];return g.map=function(c){return b(c,0)},g.entries=function(e){return c(b(e,0),0)},g.key=function(b){return h.push(b),g},g.sortKeys=function(b){return k[h.length-1]=b,g},g.sortValues=function(b){return e=b,g},g.rollup=function(b){return d=b,g},g};d3.keys=function(b){var c=[],e;for(e in b)c.push(e);return c};d3.values=function(b){var c=[],e;for(e in b)c.push(b[e]);return c};d3.entries=function(b){var c=[],e;for(e in b)c.push({key:e,
value:b[e]});return c};d3.permute=function(b,c){for(var e=[],d=-1,f=c.length;f>++d;)e[d]=b[c[d]];return e};d3.merge=function(b){return Array.prototype.concat.apply([],b)};d3.range=function(b,c,e){if(3>arguments.length&&(e=1,2>arguments.length&&(c=b,b=0)),1/0===(c-b)/e)throw Error("infinite range");var d,f=[],g;d=Math.abs(e);for(g=1;d*g%1;)g*=10;var h=-1;if(b*=g,c*=g,e*=g,0>e)for(;(d=b+e*++h)>c;)f.push(d/g);else for(;c>(d=b+e*++h);)f.push(d/g);return f};d3.requote=function(b){return b.replace(cd,"\\$&")};
var cd=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(b,c){return c?Math.round(b*(c=Math.pow(10,c)))/c:Math.round(b)};d3.xhr=function(b,c,e){function d(){var b=p.status;!b&&p.responseText||200<=b&&300>b||304===b?h.load.call(f,l.call(f,p)):h.error.call(f,p)}var f={},h=d3.dispatch("progress","load","error"),k={},l=g,p=new (window.XDomainRequest&&/^(http(s)?:)?\/\//.test(b)?XDomainRequest:XMLHttpRequest);return"onload"in p?p.onload=p.onerror=d:p.onreadystatechange=function(){3<p.readyState&&d()},
p.onprogress=function(b){var c=d3.event;d3.event=b;try{h.progress.call(f,p)}finally{d3.event=c}},f.header=function(b,c){return b=(b+"").toLowerCase(),2>arguments.length?k[b]:(null==c?delete k[b]:k[b]=c+"",f)},f.mimeType=function(b){return arguments.length?(c=null==b?null:b+"",f):c},f.response=function(b){return l=b,f},["get","post"].forEach(function(b){f[b]=function(){return f.send.apply(f,[b].concat(kc(arguments)))}}),f.send=function(e,d,g){if(2===arguments.length&&"function"==typeof d&&(g=d,d=null),
p.open(e,b,!0),null==c||"accept"in k||(k.accept=c+",*/*"),p.setRequestHeader)for(var h in k)p.setRequestHeader(h,k[h]);return null!=c&&p.overrideMimeType&&p.overrideMimeType(c),null!=g&&f.on("error",g).on("load",function(b){g(null,b)}),p.send(null==d?null:d),f},f.abort=function(){return p.abort(),f},d3.rebind(f,h,"on"),2===arguments.length&&"function"==typeof c&&(e=c,c=null),null==e?f:f.get(r(e))};d3.text=function(){return d3.xhr.apply(d3,arguments).response(s)};d3.json=function(b,c){return d3.xhr(b,
"application/json",c).response(t)};d3.html=function(b,c){return d3.xhr(b,"text/html",c).response(u)};d3.xml=function(){return d3.xhr.apply(d3,arguments).response(v)};var ka={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:ka,qualify:function(b){var c=b.indexOf(":"),e=b;return 0<=c&&(e=b.substring(0,c),b=b.substring(c+1)),ka.hasOwnProperty(e)?{space:ka[e],
local:b}:b}};d3.dispatch=function(){for(var b=new w,c=-1,e=arguments.length;e>++c;)b[arguments[c]]=y(b);return b};w.prototype.on=function(b,c){var e=b.indexOf("."),d="";return 0<e&&(d=b.substring(e+1),b=b.substring(0,e)),2>arguments.length?this[b].on(d):this[b].on(d,c)};d3.format=function(b){b=ab.exec(b);var c=b[1]||" ",e=b[2]||">",d=b[3]||"",f=b[4]||"",g=b[5],h=+b[6],k=b[7],l=b[8],p=b[9],q=1,r="",P=!1;switch(l&&(l=+l.substring(1)),(g||"0"===c&&"="===e)&&(g=c="0",e="=",k&&(h-=Math.floor((h-1)/4))),
p){case "n":k=!0;p="g";break;case "%":q=100;r="%";p="f";break;case "p":q=100;r="%";p="r";break;case "b":case "o":case "x":case "X":f&&(f="0"+p.toLowerCase());case "c":case "d":P=!0;l=0;break;case "s":q=-1,p="r"}"#"===f&&(f="");"r"!=p||l||(p="g");var p=Ub.get(p)||B,s=g&&k;return function(b){if(P&&b%1)return"";var t=0>b||0===b&&0>1/b?(b=-b,"-"):d;if(0>q){var u=d3.formatPrefix(b,l);b=u.scale(b);r=u.symbol}else b*=q;b=p(b,l);!g&&k&&(b=rb(b));var u=f.length+b.length+(s?0:t.length),ma=h>u?Array(u=h-u+1).join(c):
"";return s&&(b=rb(ma+b)),b.replace(".","."),t+=f,("<"===e?t+b+ma:">"===e?ma+t+b:"^"===e?ma.substring(0,u>>=1)+t+b+ma.substring(u):t+(s?b:ma+b))+r}};var ab=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,Ub=d3.map({b:function(b){return b.toString(2)},c:function(b){return String.fromCharCode(b)},o:function(b){return b.toString(8)},x:function(b){return b.toString(16)},X:function(b){return b.toString(16).toUpperCase()},g:function(b,c){return b.toPrecision(c)},e:function(b,
c){return b.toExponential(c)},f:function(b,c){return b.toFixed(c)},r:function(b,c){return d3.round(b,c=z(b,c)).toFixed(Math.max(0,Math.min(20,c)))}}),rb=g;if(vd)var Ic=vd.length,rb=function(b){for(var c=b.lastIndexOf("."),e=0<=c?"."+b.substring(c+1):(c=b.length,""),d=[],f=0,g=vd[0];0<c&&0<g;)d.push(b.substring(c-=g,c+g)),g=vd[f=(f+1)%Ic];return d.reverse().join(",")+e};var Sd="y z a f p n \u00ce\u00bc m  k M G T P E Z Y".split(" ").map(function(b,c){var e=Math.pow(10,3*Math.abs(8-c));return{scale:8<
c?function(b){return b/e}:function(b){return b*e},symbol:b}});d3.formatPrefix=function(b,c){var e=0;return b&&(0>b&&(b*=-1),c&&(b=d3.round(b,z(b,c))),e=1+Math.floor(1E-12+Math.log(b)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((0>=e?e+1:e-1)/3)))),Sd[8+e/3]};var Jd=function(){return g},pc=d3.map({linear:Jd,poly:function(b){return function(c){return Math.pow(c,b)}},quad:function(){return E},cubic:function(){return F},sin:function(){return U},exp:function(){return H},circle:function(){return G},
elastic:function(b,c){var e;return 2>arguments.length&&(c=0.45),arguments.length?e=c/(2*Ga)*Math.asin(1/b):(b=1,e=c/4),function(d){return 1+b*Math.pow(2,10*-d)*Math.sin(2*(d-e)*Ga/c)}},back:function(b){return b||(b=1.70158),function(c){return c*c*((b+1)*c-b)}},bounce:function(){return aa}}),Jc=d3.map({"in":g,out:K,"in-out":O,"out-in":function(b){return O(K(b))}});d3.ease=function(b){var c=b.indexOf("-"),e=0<=c?b.substring(0,c):b,c=0<=c?b.substring(c+1):"in";return e=pc.get(e)||Jd,c=Jc.get(c)||g,A(c(e.apply(null,
Array.prototype.slice.call(arguments,1))))};d3.event=null;d3.transform=function(b){var c=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(b){c.setAttribute("transform",b);b=c.transform.baseVal.consolidate();return new Q(b?b.matrix:bc)})(b)};Q.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var bc={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(b,c){for(var e,d=d3.interpolators.length;0<=
--d&&!(e=d3.interpolators[d](b,c)););return e};d3.interpolateNumber=function(b,c){return c-=b,function(e){return b+c*e}};d3.interpolateRound=function(b,c){return c-=b,function(e){return Math.round(b+c*e)}};d3.interpolateString=function(b,c){var e,d,f,g,h=0,k=[],l=[];for(d=Ma.lastIndex=0;e=Ma.exec(c);++d)e.index&&k.push(c.substring(h,e.index)),l.push({i:k.length,x:e[0]}),k.push(null),h=Ma.lastIndex;c.length>h&&k.push(c.substring(h));d=0;for(f=l.length;(e=Ma.exec(b))&&f>d;++d)if(g=l[d],g.x==e[0]){if(g.i)if(null==
k[g.i+1]){k[g.i-1]+=g.x;k.splice(g.i,1);for(e=d+1;f>e;++e)l[e].i--}else{k[g.i-1]+=g.x+k[g.i+1];k.splice(g.i,2);for(e=d+1;f>e;++e)l[e].i-=2}else if(null==k[g.i+1])k[g.i]=g.x;else{k[g.i]=g.x+k[g.i+1];k.splice(g.i+1,1);for(e=d+1;f>e;++e)l[e].i--}l.splice(d,1);f--;d--}else g.x=d3.interpolateNumber(parseFloat(e[0]),parseFloat(g.x));for(;f>d;)g=l.pop(),null==k[g.i+1]?k[g.i]=g.x:(k[g.i]=g.x+k[g.i+1],k.splice(g.i+1,1)),f--;return 1===k.length?null==k[0]?l[0].x:function(){return c}:function(b){for(d=0;f>d;++d)k[(g=
l[d]).i]=g.x(b);return k.join("")}};d3.interpolateTransform=function(b,c){var e,d=[],f=[],g=d3.transform(b),h=d3.transform(c),k=g.translate,l=h.translate,p=g.rotate,q=h.rotate,r=g.skew,P=h.skew,g=g.scale,h=h.scale;return k[0]!=l[0]||k[1]!=l[1]?(d.push("translate(",null,",",null,")"),f.push({i:1,x:d3.interpolateNumber(k[0],l[0])},{i:3,x:d3.interpolateNumber(k[1],l[1])})):l[0]||l[1]?d.push("translate("+l+")"):d.push(""),p!=q?(180<p-q?q+=360:180<q-p&&(p+=360),f.push({i:d.push(d.pop()+"rotate(",null,
")")-2,x:d3.interpolateNumber(p,q)})):q&&d.push(d.pop()+"rotate("+q+")"),r!=P?f.push({i:d.push(d.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(r,P)}):P&&d.push(d.pop()+"skewX("+P+")"),g[0]!=h[0]||g[1]!=h[1]?(e=d.push(d.pop()+"scale(",null,",",null,")"),f.push({i:e-4,x:d3.interpolateNumber(g[0],h[0])},{i:e-2,x:d3.interpolateNumber(g[1],h[1])})):(1!=h[0]||1!=h[1])&&d.push(d.pop()+"scale("+h+")"),e=f.length,function(b){for(var c,g=-1;e>++g;)d[(c=f[g]).i]=c.x(b);return d.join("")}};d3.interpolateRgb=
function(b,c){b=d3.rgb(b);c=d3.rgb(c);var e=b.r,d=b.g,f=b.b,g=c.r-e,h=c.g-d,k=c.b-f;return function(b){return"#"+ba(Math.round(e+g*b))+ba(Math.round(d+h*b))+ba(Math.round(f+k*b))}};d3.interpolateHsl=function(b,c){b=d3.hsl(b);c=d3.hsl(c);var e=b.h,d=b.s,f=b.l,g=c.h-e,h=c.s-d,k=c.l-f;return 180<g?g-=360:-180>g&&(g+=360),function(b){return Qa(e+g*b,d+h*b,f+k*b)+""}};d3.interpolateLab=function(b,c){b=d3.lab(b);c=d3.lab(c);var e=b.l,d=b.a,f=b.b,g=c.l-e,h=c.a-d,k=c.b-f;return function(b){return xa(e+g*
b,d+h*b,f+k*b)+""}};d3.interpolateHcl=function(b,c){b=d3.hcl(b);c=d3.hcl(c);var e=b.h,d=b.c,f=b.l,g=c.h-e,h=c.c-d,k=c.l-f;return 180<g?g-=360:-180>g&&(g+=360),function(b){return T(e+g*b,d+h*b,f+k*b)+""}};d3.interpolateArray=function(b,c){var e,d=[],f=[],g=b.length,h=c.length,k=Math.min(b.length,c.length);for(e=0;k>e;++e)d.push(d3.interpolate(b[e],c[e]));for(;g>e;++e)f[e]=b[e];for(;h>e;++e)f[e]=c[e];return function(b){for(e=0;k>e;++e)f[e]=d[e](b);return f}};d3.interpolateObject=function(b,c){var e,
d={},f={};for(e in b)e in c?d[e]=C(e)(b[e],c[e]):f[e]=b[e];for(e in c)e in b||(f[e]=c[e]);return function(b){for(e in d)f[e]=d[e](b);return f}};var Ma=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(b,c){return c instanceof Array&&d3.interpolateArray(b,c)},function(b,c){return("string"==typeof b||"string"==typeof c)&&d3.interpolateString(b+"",c+"")},function(b,c){return("string"==typeof c?qc.has(c)||/^(#|rgb\(|hsl\()/.test(c):c instanceof ca)&&d3.interpolateRgb(b,
c)},function(b,c){return!isNaN(b=+b)&&!isNaN(c=+c)&&d3.interpolateNumber(b,c)}];ca.prototype.toString=function(){return this.rgb()+""};d3.rgb=function(b,c,e){return 1===arguments.length?b instanceof X?R(b.r,b.g,b.b):na(""+b,R,Qa):R(~~b,~~c,~~e)};var yc=X.prototype=new ca;yc.brighter=function(b){b=Math.pow(0.7,arguments.length?b:1);var c=this.r,e=this.g,d=this.b;return c||e||d?(c&&30>c&&(c=30),e&&30>e&&(e=30),d&&30>d&&(d=30),R(Math.min(255,Math.floor(c/b)),Math.min(255,Math.floor(e/b)),Math.min(255,
Math.floor(d/b)))):R(30,30,30)};yc.darker=function(b){return b=Math.pow(0.7,arguments.length?b:1),R(Math.floor(b*this.r),Math.floor(b*this.g),Math.floor(b*this.b))};yc.hsl=function(){return S(this.r,this.g,this.b)};yc.toString=function(){return"#"+ba(this.r)+ba(this.g)+ba(this.b)};var qc=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",
brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",
darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",
khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",
maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",
paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",
teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});qc.forEach(function(b,c){qc.set(b,na(c,R,Qa))});d3.hsl=function(b,c,e){return 1===arguments.length?b instanceof Na?ta(b.h,b.s,b.l):na(""+b,S,ta):ta(+b,+c,+e)};var Kd=Na.prototype=new ca;Kd.brighter=function(b){return b=Math.pow(0.7,arguments.length?b:1),ta(this.h,this.s,this.l/b)};Kd.darker=function(b){return b=Math.pow(0.7,
arguments.length?b:1),ta(this.h,this.s,b*this.l)};Kd.rgb=function(){return Qa(this.h,this.s,this.l)};d3.hcl=function(b,c,e){return 1===arguments.length?b instanceof fa?Oa(b.h,b.c,b.l):b instanceof ea?Aa(b.l,b.a,b.b):Aa((b=$((b=d3.rgb(b)).r,b.g,b.b)).l,b.a,b.b):Oa(+b,+c,+e)};var Yc=fa.prototype=new ca;Yc.brighter=function(b){return Oa(this.h,this.c,Math.min(100,this.l+wd*(arguments.length?b:1)))};Yc.darker=function(b){return Oa(this.h,this.c,Math.max(0,this.l-wd*(arguments.length?b:1)))};Yc.rgb=function(){return T(this.h,
this.c,this.l).rgb()};d3.lab=function(b,c,e){return 1===arguments.length?b instanceof ea?ia(b.l,b.a,b.b):b instanceof fa?T(b.l,b.c,b.h):$((b=d3.rgb(b)).r,b.g,b.b):ia(+b,+c,+e)};var wd=18,he=0.95047,Qc=1,Rc=1.08883,Kc=ea.prototype=new ca;Kc.brighter=function(b){return ia(Math.min(100,this.l+wd*(arguments.length?b:1)),this.a,this.b)};Kc.darker=function(b){return ia(Math.max(0,this.l-wd*(arguments.length?b:1)),this.a,this.b)};Kc.rgb=function(){return xa(this.l,this.a,this.b)};var Wc=function(b,c){return c.querySelector(b)},
xd=function(b,c){return c.querySelectorAll(b)},Ec=document.documentElement,zc=Ec.matchesSelector||Ec.webkitMatchesSelector||Ec.mozMatchesSelector||Ec.msMatchesSelector||Ec.oMatchesSelector,Ac=function(b,c){return zc.call(b,c)};"function"==typeof Sizzle&&(Wc=function(b,c){return Sizzle(b,c)[0]||null},xd=function(b,c){return Sizzle.uniqueSort(Sizzle(b,c))},Ac=Sizzle.matchesSelector);var ua=[];d3.selection=function(){return vc};d3.selection.prototype=ua;ua.select=function(b){var c,e,d,f,g=[];"function"!=
typeof b&&(b=Ra(b));for(var h=-1,k=this.length;k>++h;){g.push(c=[]);c.parentNode=(d=this[h]).parentNode;for(var l=-1,p=d.length;p>++l;)(f=d[l])?(c.push(e=b.call(f,f.__data__,l)),e&&"__data__"in f&&(e.__data__=f.__data__)):c.push(null)}return ha(g)};ua.selectAll=function(b){var c,e,d=[];"function"!=typeof b&&(b=Ha(b));for(var f=-1,g=this.length;g>++f;)for(var h=this[f],k=-1,l=h.length;l>++k;)(e=h[k])&&(d.push(c=kc(b.call(e,e.__data__,k))),c.parentNode=e);return ha(d)};ua.attr=function(b,c){if(2>arguments.length){if("string"==
typeof b){var e=this.node();return b=d3.ns.qualify(b),b.local?e.getAttributeNS(b.space,b.local):e.getAttribute(b)}for(c in b)this.each(sa(c,b[c]));return this}return this.each(sa(b,c))};ua.classed=function(b,c){if(2>arguments.length){if("string"==typeof b){var e=this.node(),d=(b=b.trim().split(/^|\s+/g)).length,f=-1;if(c=e.classList)for(;d>++f;){if(!c.contains(b[f]))return!1}else{c=e.className;for(null!=c.baseVal&&(c=c.baseVal);d>++f;)if(!eb(b[f]).test(c))return!1}return!0}for(c in b)this.each(Xa(c,
b[c]));return this}return this.each(Xa(b,c))};ua.style=function(b,c,e){var d=arguments.length;if(3>d){if("string"!=typeof b){2>d&&(c="");for(e in b)this.each(Pa(e,b[e],c));return this}if(2>d)return getComputedStyle(this.node(),null).getPropertyValue(b);e=""}return this.each(Pa(b,c,e))};ua.property=function(b,c){if(2>arguments.length){if("string"==typeof b)return this.node()[b];for(c in b)this.each(va(c,b[c]));return this}return this.each(va(b,c))};ua.text=function(b){return arguments.length?this.each("function"==
typeof b?function(){var c=b.apply(this,arguments);this.textContent=null==c?"":c}:null==b?function(){this.textContent=""}:function(){this.textContent=b}):this.node().textContent};ua.html=function(b){return arguments.length?this.each("function"==typeof b?function(){var c=b.apply(this,arguments);this.innerHTML=null==c?"":c}:null==b?function(){this.innerHTML=""}:function(){this.innerHTML=b}):this.node().innerHTML};ua.append=function(b){function c(){return this.appendChild(document.createElementNS(this.namespaceURI,
b))}function e(){return this.appendChild(document.createElementNS(b.space,b.local))}return b=d3.ns.qualify(b),this.select(b.local?e:c)};ua.insert=function(b,c){function e(){return this.insertBefore(document.createElementNS(this.namespaceURI,b),Wc(c,this))}function d(){return this.insertBefore(document.createElementNS(b.space,b.local),Wc(c,this))}return b=d3.ns.qualify(b),this.select(b.local?d:e)};ua.remove=function(){return this.each(function(){var b=this.parentNode;b&&b.removeChild(this)})};ua.data=
function(b,c){function e(b,d){var g,h,k,r=b.length,P=d.length,s=Math.min(r,P),t=Array(P),u=Array(P),ma=Array(r);if(c){var v=new f,w=new f,da=[];for(g=-1;r>++g;)s=c.call(h=b[g],h.__data__,g),v.has(s)?ma[g]=h:v.set(s,h),da.push(s);for(g=-1;P>++g;)s=c.call(d,k=d[g],g),(h=v.get(s))?(t[g]=h,h.__data__=k):w.has(s)||(u[g]={__data__:k}),w.set(s,k),v.remove(s);for(g=-1;r>++g;)v.has(da[g])&&(ma[g]=b[g])}else{for(g=-1;s>++g;)h=b[g],k=d[g],h?(h.__data__=k,t[g]=h):u[g]={__data__:k};for(;P>g;++g)u[g]={__data__:d[g]};
for(;r>g;++g)ma[g]=b[g]}u.update=t;u.parentNode=t.parentNode=ma.parentNode=b.parentNode;l.push(u);p.push(t);q.push(ma)}var d,g,h=-1,k=this.length;if(!arguments.length){for(b=Array(k=(d=this[0]).length);k>++h;)(g=d[h])&&(b[h]=g.__data__);return b}var l=Ka([]),p=ha([]),q=ha([]);if("function"==typeof b)for(;k>++h;)e(d=this[h],b.call(d,d.parentNode.__data__,h));else for(;k>++h;)e(d=this[h],b);return p.enter=function(){return l},p.exit=function(){return q},p};ua.datum=function(b){return arguments.length?
this.property("__data__",b):this.property("__data__")};ua.filter=function(b){var c,e,d,f=[];"function"!=typeof b&&(b=db(b));for(var g=0,h=this.length;h>g;g++){f.push(c=[]);c.parentNode=(e=this[g]).parentNode;for(var k=0,l=e.length;l>k;k++)(d=e[k])&&b.call(d,d.__data__,k)&&c.push(d)}return ha(f)};ua.order=function(){for(var b=-1,c=this.length;c>++b;)for(var e,d=this[b],f=d.length-1,g=d[f];0<=--f;)(e=d[f])&&(g&&g!==e.nextSibling&&g.parentNode.insertBefore(e,g),g=e);return this};ua.sort=function(b){b=
Ib.apply(this,arguments);for(var c=-1,e=this.length;e>++c;)this[c].sort(b);return this.order()};ua.on=function(b,c,e){var d=arguments.length;if(3>d){if("string"!=typeof b){2>d&&(c=!1);for(e in b)this.each(Va(e,b[e],c));return this}if(2>d)return(d=this.node()["__on"+b])&&d._;e=!1}return this.each(Va(b,c,e))};ua.each=function(b){return Ta(this,function(c,e,d){b.call(c,c.__data__,e,d)})};ua.call=function(b){var c=kc(arguments);return b.apply(c[0]=this,c),this};ua.empty=function(){return!this.node()};
ua.node=function(){for(var b=0,c=this.length;c>b;b++)for(var e=this[b],d=0,f=e.length;f>d;d++){var g=e[d];if(g)return g}return null};ua.transition=function(){var b,c,e=Fa||++Df,d=[],f=Object.create(Vd);f.time=Date.now();for(var g=-1,h=this.length;h>++g;){d.push(b=[]);for(var k=this[g],l=-1,p=k.length;p>++l;)(c=k[l])&&fb(c,l,e,f),b.push(c)}return bb(d,e)};var vc=ha([[document]]);vc[0].parentNode=Ec;d3.select=function(b){return"string"==typeof b?vc.select(b):ha([[b]])};d3.selectAll=function(b){return"string"==
typeof b?vc.selectAll(b):ha([kc(b)])};var lb=[];d3.selection.enter=Ka;d3.selection.enter.prototype=lb;lb.append=ua.append;lb.insert=ua.insert;lb.empty=ua.empty;lb.node=ua.node;lb.select=function(b){for(var c,e,d,f,g,h=[],k=-1,l=this.length;l>++k;){d=(f=this[k]).update;h.push(c=[]);c.parentNode=f.parentNode;for(var p=-1,q=f.length;q>++p;)(g=f[p])?(c.push(d[p]=e=b.call(f.parentNode,g.__data__,p)),e.__data__=g.__data__):c.push(null)}return ha(h)};var Fa,Ob=[],Df=0,Vd={ease:function(b){if(0>=b)return 0;
if(1<=b)return 1;var c=b*b,e=c*b;return 4*(0.5>b?e:3*(b-c)+e-0.75)},delay:0,duration:250};Ob.call=ua.call;Ob.empty=ua.empty;Ob.node=ua.node;d3.transition=function(b){return arguments.length?Fa?b.transition():b:vc.transition()};d3.transition.prototype=Ob;Ob.select=function(b){var c,e,d,f=this.id,g=[];"function"!=typeof b&&(b=Ra(b));for(var h=-1,k=this.length;k>++h;){g.push(c=[]);for(var l=this[h],p=-1,q=l.length;q>++p;)(d=l[p])&&(e=b.call(d,d.__data__,p))?("__data__"in d&&(e.__data__=d.__data__),fb(e,
p,f,d.__transition__[f]),c.push(e)):c.push(null)}return bb(g,f)};Ob.selectAll=function(b){var c,e,d,f,g=this.id,h=[];"function"!=typeof b&&(b=Ha(b));for(var k=-1,l=this.length;l>++k;)for(var p=this[k],q=-1,r=p.length;r>++q;)if(c=p[q]){f=c.__transition__[g];e=b.call(c,c.__data__,q);h.push(c=[]);for(var P=-1,s=e.length;s>++P;)fb(d=e[P],P,g,f),c.push(d)}return bb(h,g)};Ob.filter=function(b){var c,e,d,f=[];"function"!=typeof b&&(b=db(b));for(var g=0,h=this.length;h>g;g++){f.push(c=[]);e=this[g];for(var k=
0,l=e.length;l>k;k++)(d=e[k])&&b.call(d,d.__data__,k)&&c.push(d)}return bb(f,this.id,this.time).ease(this.ease())};Ob.attr=function(b,c){function e(){this.removeAttribute(g)}function d(){this.removeAttributeNS(g.space,g.local)}if(2>arguments.length){for(c in b)this.attr(c,b[c]);return this}var f=C(b),g=d3.ns.qualify(b);return oa(this,"attr."+b,c,function(b){function c(){var e,d=this.getAttribute(g);return d!==b&&(e=f(d,b),function(b){this.setAttribute(g,e(b))})}function h(){var c,e=this.getAttributeNS(g.space,
g.local);return e!==b&&(c=f(e,b),function(b){this.setAttributeNS(g.space,g.local,c(b))})}return null==b?g.local?d:e:(b+="",g.local?h:c)})};Ob.attrTween=function(b,c){function e(b,d){var g=c.call(this,b,d,this.getAttribute(f));return g&&function(b){this.setAttribute(f,g(b))}}function d(b,e){var g=c.call(this,b,e,this.getAttributeNS(f.space,f.local));return g&&function(b){this.setAttributeNS(f.space,f.local,g(b))}}var f=d3.ns.qualify(b);return this.tween("attr."+b,f.local?d:e)};Ob.style=function(b,
c,e){function d(){this.style.removeProperty(b)}var f=arguments.length;if(3>f){if("string"!=typeof b){2>f&&(c="");for(e in b)this.style(e,b[e],c);return this}e=""}var g=C(b);return oa(this,"style."+b,c,function(c){function f(){var d,h=getComputedStyle(this,null).getPropertyValue(b);return h!==c&&(d=g(h,c),function(c){this.style.setProperty(b,d(c),e)})}return null==c?d:(c+="",f)})};Ob.styleTween=function(b,c,e){return 3>arguments.length&&(e=""),this.tween("style."+b,function(d,f){var g=c.call(this,
d,f,getComputedStyle(this,null).getPropertyValue(b));return g&&function(c){this.style.setProperty(b,g(c),e)}})};Ob.text=function(b){return oa(this,"text",b,wa)};Ob.remove=function(){return this.each("end.transition",function(){var b;!this.__transition__&&(b=this.parentNode)&&b.removeChild(this)})};Ob.ease=function(b){var c=this.id;return 1>arguments.length?this.node().__transition__[c].ease:("function"!=typeof b&&(b=d3.ease.apply(d3,arguments)),Ta(this,function(e){e.__transition__[c].ease=b}))};Ob.delay=
function(b){var c=this.id;return Ta(this,"function"==typeof b?function(e,d,f){e.__transition__[c].delay=0|b.call(e,e.__data__,d,f)}:(b|=0,function(e){e.__transition__[c].delay=b}))};Ob.duration=function(b){var c=this.id;return Ta(this,"function"==typeof b?function(e,d,f){e.__transition__[c].duration=Math.max(1,0|b.call(e,e.__data__,d,f))}:(b=Math.max(1,0|b),function(e){e.__transition__[c].duration=b}))};Ob.each=function(b,c){var e=this.id;if(2>arguments.length){var d=Vd,f=Fa;Fa=e;Ta(this,function(c,
d,f){Vd=c.__transition__[e];b.call(c,c.__data__,d,f)});Vd=d;Fa=f}else Ta(this,function(d){d.__transition__[e].event.on(b,c)});return this};Ob.transition=function(){for(var b,c,e,d,f=this.id,g=++Df,h=[],k=0,l=this.length;l>k;k++){h.push(b=[]);c=this[k];for(var p=0,q=c.length;q>p;p++)(e=c[p])&&(d=Object.create(e.__transition__[f]),d.delay+=d.duration,fb(e,p,g,d)),b.push(e)}return bb(h,g)};Ob.tween=function(b,c){var e=this.id;return 2>arguments.length?this.node().__transition__[e].tween.get(b):Ta(this,
null==c?function(c){c.__transition__[e].tween.remove(b)}:function(d){d.__transition__[e].tween.set(b,c)})};var Td,jd,Nf=0,hf={},ie=null;d3.timer=function(b,c,e){if(3>arguments.length){if(2>arguments.length)c=0;else if(!isFinite(c))return;e=Date.now()}var d=hf[b.id];d&&d.callback===b?(d.then=e,d.delay=c):hf[b.id=++Nf]=ie={callback:b,then:e,delay:c,next:ie};Td||(jd=clearTimeout(jd),Td=1,Lc(Ia))};d3.timer.flush=function(){for(var b,c=Date.now(),e=ie;e;)b=c-e.then,e.delay||(e.flush=e.callback(b)),e=e.next;
x()};var Lc=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(b){setTimeout(b,17)};d3.mouse=function(b){return cb(b,M())};var jf=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(b,c){return 2>arguments.length&&(c=M().touches),c?kc(c).map(function(c){var e=cb(b,c);return e.identifier=c.identifier,e}):[]};d3.scale={};d3.scale.linear=function(){return $a([0,1],[0,1],d3.interpolate,
!1)};d3.scale.log=function(){return ob(d3.scale.linear(),Bc)};var ze=d3.format(".0e");Bc.pow=function(b){return Math.pow(10,b)};hc.pow=function(b){return-Math.pow(10,-b)};d3.scale.pow=function(){return Gc(d3.scale.linear(),1)};d3.scale.sqrt=function(){return d3.scale.pow().exponent(0.5)};d3.scale.ordinal=function(){return oc([],{t:"range",a:[[]]})};d3.scale.category10=function(){return d3.scale.ordinal().range(Ld)};d3.scale.category20=function(){return d3.scale.ordinal().range(Nc)};d3.scale.category20b=
function(){return d3.scale.ordinal().range(Of)};d3.scale.category20c=function(){return d3.scale.ordinal().range(kf)};var Ld="#1f77b4 #ff7f0e #2ca02c #d62728 #9467bd #8c564b #e377c2 #7f7f7f #bcbd22 #17becf".split(" "),Nc="#1f77b4 #aec7e8 #ff7f0e #ffbb78 #2ca02c #98df8a #d62728 #ff9896 #9467bd #c5b0d5 #8c564b #c49c94 #e377c2 #f7b6d2 #7f7f7f #c7c7c7 #bcbd22 #dbdb8d #17becf #9edae5".split(" "),Of="#393b79 #5254a3 #6b6ecf #9c9ede #637939 #8ca252 #b5cf6b #cedb9c #8c6d31 #bd9e39 #e7ba52 #e7cb94 #843c39 #ad494a #d6616b #e7969c #7b4173 #a55194 #ce6dbd #de9ed6".split(" "),
kf="#3182bd #6baed6 #9ecae1 #c6dbef #e6550d #fd8d3c #fdae6b #fdd0a2 #31a354 #74c476 #a1d99b #c7e9c0 #756bb1 #9e9ac8 #bcbddc #dadaeb #636363 #969696 #bdbdbd #d9d9d9".split(" ");d3.scale.quantile=function(){return ga([],[])};d3.scale.quantize=function(){return Hc(0,1,[0,1])};d3.scale.threshold=function(){return Gb([0.5],[0,1])};d3.scale.identity=function(){return Kb([0,1])};d3.svg={};d3.svg.arc=function(){function b(){var g=c.apply(this,arguments),h=e.apply(this,arguments),k=d.apply(this,arguments)+
Za,l=f.apply(this,arguments)+Za,p=(k>l&&(p=k,k=l,l=p),l-k),q=Ga>p?"0":"1",r=Math.cos(k),k=Math.sin(k),P=Math.cos(l),l=Math.sin(l);return p>=Ad?g?"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"M0,"+g+"A"+g+","+g+" 0 1,0 0,"+-g+"A"+g+","+g+" 0 1,0 0,"+g+"Z":"M0,"+h+"A"+h+","+h+" 0 1,1 0,"+-h+"A"+h+","+h+" 0 1,1 0,"+h+"Z":g?"M"+h*r+","+h*k+"A"+h+","+h+" 0 "+q+",1 "+h*P+","+h*l+"L"+g*P+","+g*l+"A"+g+","+g+" 0 "+q+",0 "+g*r+","+g*k+"Z":"M"+h*r+","+h*k+"A"+h+","+h+" 0 "+q+",1 "+h*P+","+h*
l+"L0,0Z"}var c=Qb,e=Lb,d=xc,f=tc;return b.innerRadius=function(e){return arguments.length?(c=k(e),b):c},b.outerRadius=function(c){return arguments.length?(e=k(c),b):e},b.startAngle=function(c){return arguments.length?(d=k(c),b):d},b.endAngle=function(c){return arguments.length?(f=k(c),b):f},b.centroid=function(){var b=(c.apply(this,arguments)+e.apply(this,arguments))/2,g=(d.apply(this,arguments)+f.apply(this,arguments))/2+Za;return[Math.cos(g)*b,Math.sin(g)*b]},b};var Za=-Ga/2,Ad=2*Ga-1E-6;d3.svg.line=
function(){return uc(g)};var lc=d3.map({linear:mc,"linear-closed":function(b){return mc(b)+"Z"},"step-before":Rb,"step-after":ld,basis:fd,"basis-open":function(b){if(4>b.length)return mc(b);for(var c,e=[],d=-1,f=b.length,g=[0],h=[0];3>++d;)c=b[d],g.push(c[0]),h.push(c[1]);e.push(nc(Ud,g)+","+nc(Ud,h));for(--d;f>++d;)c=b[d],g.shift(),g.push(c[0]),h.shift(),h.push(c[1]),Pb(e,g,h);return e.join("")},"basis-closed":function(b){for(var c,e,d=-1,f=b.length,g=f+4,h=[],k=[];4>++d;)e=b[d%f],h.push(e[0]),k.push(e[1]);
c=[nc(Ud,h),",",nc(Ud,k)];for(--d;g>++d;)e=b[d%f],h.shift(),h.push(e[0]),k.shift(),k.push(e[1]),Pb(c,h,k);return c.join("")},bundle:function(b,c){var e=b.length-1;if(e)for(var d,f,g=b[0][0],h=b[0][1],k=b[e][0]-g,l=b[e][1]-h,p=-1;e>=++p;)d=b[p],f=p/e,d[0]=c*d[0]+(1-c)*(g+f*k),d[1]=c*d[1]+(1-c)*(h+f*l);return fd(b)},cardinal:function(b,c){return 3>b.length?mc(b):b[0]+ed(b,md(b,c))},"cardinal-open":function(b,c){return 4>b.length?mc(b):b[1]+ed(b.slice(1,b.length-1),md(b,c))},"cardinal-closed":function(b,
c){return 3>b.length?mc(b):b[0]+ed((b.push(b[0]),b),md([b[b.length-2]].concat(b,[b[1]]),c))},monotone:function(b){if(3>b.length)b=mc(b);else{var c=b[0],e,d,f,g,h=[],k;e=0;k=b.length-1;for(var l=[],p=b[1],q=l[0]=gd(b[0],p);k>++e;)l[e]=(q+(q=gd(p,p=b[e+1])))/2;k=(l[e]=q,l);l=-1;for(p=b.length-1;p>++l;)e=gd(b[l],b[l+1]),1E-6>Math.abs(e)?k[l]=k[l+1]=0:(d=k[l]/e,f=k[l+1]/e,g=d*d+f*f,9<g&&(g=3*e/Math.sqrt(g),k[l]=g*d,k[l+1]=g*f));for(l=-1;p>=++l;)g=(b[Math.min(p,l+1)][0]-b[Math.max(0,l-1)][0])/(6*(1+k[l]*
k[l])),h.push([g||0,k[l]*g||0]);b=c+ed(b,h)}return b}});lc.forEach(function(b,c){c.key=b;c.closed=/-closed$/.test(b)});var Ae=[0,2/3,1/3,0],kd=[0,1/3,2/3,0],Ud=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var b=uc(oe);return b.radius=b.x,delete b.x,b.angle=b.y,delete b.y,b};Rb.reverse=ld;ld.reverse=Rb;d3.svg.area=function(){return qa(g)};d3.svg.area.radial=function(){var b=qa(oe);return b.radius=b.x,delete b.x,b.innerRadius=b.x0,delete b.x0,b.outerRadius=b.x1,delete b.x1,b.angle=b.y,delete b.y,b.startAngle=
b.y0,delete b.y0,b.endAngle=b.y1,delete b.y1,b};d3.svg.chord=function(){function e(b,c){var d=f(this,g,b,c),k=f(this,h,b,c);return"M"+d.p0+("A"+d.r+","+d.r+" 0 "+ +(d.a1-d.a0>Ga)+",1 "+d.p1)+(d.a0==k.a0&&d.a1==k.a1?"Q 0,0 "+d.p0:"Q 0,0 "+k.p0+("A"+k.r+","+k.r+" 0 "+ +(k.a1-k.a0>Ga)+",1 "+k.p1)+("Q 0,0 "+d.p0))+"Z"}function f(b,c,e,d){var g=c.call(b,e,d);c=l.call(b,g,d);e=p.call(b,g,d)+Za;b=q.call(b,g,d)+Za;return{r:c,a0:e,a1:b,p0:[c*Math.cos(e),c*Math.sin(e)],p1:[c*Math.cos(b),c*Math.sin(b)]}}var g=
c,h=b,l=da,p=xc,q=tc;return e.radius=function(b){return arguments.length?(l=k(b),e):l},e.source=function(b){return arguments.length?(g=k(b),e):g},e.target=function(b){return arguments.length?(h=k(b),e):h},e.startAngle=function(b){return arguments.length?(p=k(b),e):p},e.endAngle=function(b){return arguments.length?(q=k(b),e):q},e};d3.svg.diagonal=function(){function e(b,c){var d=f.call(this,b,c),k=g.call(this,b,c),l=(d.y+k.y)/2,d=[d,{x:d.x,y:l},{x:k.x,y:l},k];return d=d.map(h),"M"+d[0]+"C"+d[1]+" "+
d[2]+" "+d[3]}var f=c,g=b,h=Yd;return e.source=function(b){return arguments.length?(f=k(b),e):f},e.target=function(b){return arguments.length?(g=k(b),e):g},e.projection=function(b){return arguments.length?(h=b,e):h},e};d3.svg.diagonal.radial=function(){var b=d3.svg.diagonal(),c=Yd,e=b.projection;return b.projection=function(b){return arguments.length?e(mf(c=b)):c},b};d3.svg.symbol=function(){function b(d,f){return(Md.get(c.call(this,d,f))||W)(e.call(this,d,f))}var c=Od,e=Zd;return b.type=function(e){return arguments.length?
(c=k(e),b):c},b.size=function(c){return arguments.length?(e=k(c),b):e},b};var Md=d3.map({circle:W,cross:function(b){b=Math.sqrt(b/5)/2;return"M"+-3*b+","+-b+"H"+-b+"V"+-3*b+"H"+b+"V"+-b+"H"+3*b+"V"+b+"H"+b+"V"+3*b+"H"+-b+"V"+b+"H"+-3*b+"Z"},diamond:function(b){b=Math.sqrt(b/(2*Nd));var c=b*Nd;return"M0,"+-b+"L"+c+",0 0,"+b+" "+-c+",0Z"},square:function(b){b=Math.sqrt(b)/2;return"M"+-b+","+-b+"L"+b+","+-b+" "+b+","+b+" "+-b+","+b+"Z"},"triangle-down":function(b){b=Math.sqrt(b/Wd);var c=b*Wd/2;return"M0,"+
c+"L"+b+","+-c+" "+-b+","+-c+"Z"},"triangle-up":function(b){b=Math.sqrt(b/Wd);var c=b*Wd/2;return"M0,"+-c+"L"+b+","+c+" "+-b+","+c+"Z"}});d3.svg.symbolTypes=Md.keys();var Wd=Math.sqrt(3),Nd=Math.tan(30*Wa);d3.svg.axis=function(){function b(r){r.each(function(){var b,r=d3.select(this),P=null==p?e.ticks?e.ticks.apply(e,l):e.domain():p,s=null==c?e.tickFormat?e.tickFormat.apply(e,l):String:c,t=Gf(e,P,q),u=r.selectAll(".minor").data(t,String),t=u.enter().insert("line","g").attr("class","tick minor").style("opacity",
1E-6),ma=d3.transition(u.exit()).style("opacity",1E-6).remove(),u=d3.transition(u).style("opacity",1),v=r.selectAll("g").data(P,String),P=v.enter().insert("g","path").style("opacity",1E-6),w=d3.transition(v.exit()).style("opacity",1E-6).remove(),da=d3.transition(v).style("opacity",1),Ja=Ab(e),y=r.selectAll(".domain").data([0]),r=d3.transition(y),qa=e.copy(),z=this.__chart__||qa;this.__chart__=qa;y.enter().append("path").attr("class","domain");P.append("line").attr("class","tick");P.append("text");
var y=P.select("line"),mb=da.select("line"),s=v.select("text").text(s),v=P.select("text"),fc=da.select("text");switch(d){case "bottom":b=Te;t.attr("y2",g);u.attr("x2",0).attr("y2",g);y.attr("y2",f);v.attr("y",Math.max(f,0)+k);mb.attr("x2",0).attr("y2",f);fc.attr("x",0).attr("y",Math.max(f,0)+k);s.attr("dy",".71em").style("text-anchor","middle");r.attr("d","M"+Ja[0]+","+h+"V0H"+Ja[1]+"V"+h);break;case "top":b=Te;t.attr("y2",-g);u.attr("x2",0).attr("y2",-g);y.attr("y2",-f);v.attr("y",-(Math.max(f,0)+
k));mb.attr("x2",0).attr("y2",-f);fc.attr("x",0).attr("y",-(Math.max(f,0)+k));s.attr("dy","0em").style("text-anchor","middle");r.attr("d","M"+Ja[0]+","+-h+"V0H"+Ja[1]+"V"+-h);break;case "left":b=$d;t.attr("x2",-g);u.attr("x2",-g).attr("y2",0);y.attr("x2",-f);v.attr("x",-(Math.max(f,0)+k));mb.attr("x2",-f).attr("y2",0);fc.attr("x",-(Math.max(f,0)+k)).attr("y",0);s.attr("dy",".32em").style("text-anchor","end");r.attr("d","M"+-h+","+Ja[0]+"H0V"+Ja[1]+"H"+-h);break;case "right":b=$d,t.attr("x2",g),u.attr("x2",
g).attr("y2",0),y.attr("x2",f),v.attr("x",Math.max(f,0)+k),mb.attr("x2",f).attr("y2",0),fc.attr("x",Math.max(f,0)+k).attr("y",0),s.attr("dy",".32em").style("text-anchor","start"),r.attr("d","M"+h+","+Ja[0]+"H0V"+Ja[1]+"H"+h)}if(e.ticks)P.call(b,z),da.call(b,qa),w.call(b,qa),t.call(b,z),u.call(b,qa),ma.call(b,qa);else{var x=qa.rangeBand()/2,t=function(b){return qa(b)+x};P.call(b,t);da.call(b,t)}})}var c,e=d3.scale.linear(),d="bottom",f=6,g=6,h=6,k=3,l=[10],p=null,q=0;return b.scale=function(c){return arguments.length?
(e=c,b):e},b.orient=function(c){return arguments.length?(d=c,b):d},b.ticks=function(){return arguments.length?(l=arguments,b):l},b.tickValues=function(c){return arguments.length?(p=c,b):p},b.tickFormat=function(e){return arguments.length?(c=e,b):c},b.tickSize=function(c,e){if(!arguments.length)return f;var d=arguments.length-1;return f=+c,g=1<d?+e:f,h=0<d?+arguments[d]:f,b},b.tickPadding=function(c){return arguments.length?(k=+c,b):k},b.tickSubdivide=function(c){return arguments.length?(q=+c,b):q},
b};d3.svg.brush=function(){function b(g){g.each(function(){var g,h=d3.select(this),q=h.selectAll(".background").data([0]),r=h.selectAll(".extent").data([0]),P=h.selectAll(".resize").data(p,String);h.style("pointer-events","all").on("mousedown.brush",f).on("touchstart.brush",f);q.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");r.enter().append("rect").attr("class","extent").style("cursor","move");P.enter().append("g").attr("class",function(b){return"resize "+
b}).style("cursor",function(b){return dd[b]}).append("rect").attr("x",function(b){return/[ew]$/.test(b)?-3:null}).attr("y",function(b){return/^[ns]/.test(b)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden");P.style("display",b.empty()?"none":null);P.exit().remove();k&&(g=Ab(k),q.attr("x",g[0]).attr("width",g[1]-g[0]),e(h));l&&(g=Ab(l),q.attr("y",g[0]).attr("height",g[1]-g[0]),d(h));c(h)})}function c(b){b.selectAll(".resize").attr("transform",function(b){return"translate("+q[+/e$/.test(b)][0]+
","+q[+/^s/.test(b)][1]+")"})}function e(b){b.select(".extent").attr("x",q[0][0]);b.selectAll(".extent,.n>rect,.s>rect").attr("width",q[1][0]-q[0][0])}function d(b){b.select(".extent").attr("y",q[0][1]);b.selectAll(".extent,.e>rect,.w>rect").attr("height",q[1][1]-q[0][1])}function f(){function p(){var b=d3.event.changedTouches;return b?d3.touches(ma,b)[0]:d3.mouse(ma)}function r(){var b=p(),f=!1;u&&(b[0]+=u[0],b[1]+=u[1]);z||(d3.event.altKey?(t||(t=[(q[0][0]+q[1][0])/2,(q[0][1]+q[1][1])/2]),mb[0]=
q[+(b[0]<t[0])][0],mb[1]=q[+(b[1]<t[1])][1]):t=null);y&&P(b,k,0)&&(e(da),f=!0);qa&&P(b,l,1)&&(d(da),f=!0);f&&(c(da),w({type:"brush",mode:z?"move":"resize"}))}function P(b,c,e){var d,f,h=Ab(c);c=h[0];var h=h[1],k=mb[e],l=q[1][e]-q[0][e];return z&&(c-=k,h-=l+k),d=Math.max(c,Math.min(h,b[e])),z?f=(d+=k)+l:(t&&(k=Math.max(c,Math.min(h,2*t[e]-d))),d>k?(f=d,d=k):f=k),q[0][e]!==d||q[1][e]!==f?(g=null,q[0][e]=d,q[1][e]=f,!0):void 0}function s(){r();da.style("pointer-events","all").selectAll(".resize").style("display",
b.empty()?"none":null);d3.select("body").style("cursor",null);fc.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);w({type:"brushend"});D()}var t,u,ma=this,v=d3.select(d3.event.target),w=h.of(ma,arguments),da=d3.select(ma),Ja=v.datum(),y=!/^(n|s)$/.test(Ja)&&k,qa=!/^(e|w)$/.test(Ja)&&l,z=v.classed("extent"),mb=p(),fc=d3.select(window).on("mousemove.brush",r).on("mouseup.brush",s).on("touchmove.brush",
r).on("touchend.brush",s).on("keydown.brush",function(){32==d3.event.keyCode&&(z||(t=null,mb[0]-=q[1][0],mb[1]-=q[1][1],z=2),D())}).on("keyup.brush",function(){32==d3.event.keyCode&&2==z&&(mb[0]+=q[1][0],mb[1]+=q[1][1],z=0,D())});if(z)mb[0]=q[0][0]-mb[0],mb[1]=q[0][1]-mb[1];else if(Ja){var x=+/w$/.test(Ja),Ja=+/^n/.test(Ja);u=[q[1-x][0]-mb[0],q[1-Ja][1]-mb[1]];mb[0]=q[x][0];mb[1]=q[Ja][1]}else d3.event.altKey&&(t=mb.slice());da.style("pointer-events","none").selectAll(".resize").style("display",null);
d3.select("body").style("cursor",v.style("cursor"));w({type:"brushstart"});r();D()}var g,h=I(b,"brushstart","brush","brushend"),k=null,l=null,p=le[0],q=[[0,0],[0,0]];return b.x=function(c){return arguments.length?(k=c,p=le[!k<<1|!l],b):k},b.y=function(c){return arguments.length?(l=c,p=le[!k<<1|!l],b):l},b.extent=function(c){var e,d,f,h,p;return arguments.length?(g=[[0,0],[0,0]],k&&(e=c[0],d=c[1],l&&(e=e[0],d=d[0]),g[0][0]=e,g[1][0]=d,k.invert&&(e=k(e),d=k(d)),e>d&&(p=e,e=d,d=p),q[0][0]=0|e,q[1][0]=
0|d),l&&(f=c[0],h=c[1],k&&(f=f[1],h=h[1]),g[0][1]=f,g[1][1]=h,l.invert&&(f=l(f),h=l(h)),f>h&&(p=f,f=h,h=p),q[0][1]=0|f,q[1][1]=0|h),b):(c=g||q,k&&(e=c[0][0],d=c[1][0],g||(e=q[0][0],d=q[1][0],k.invert&&(e=k.invert(e),d=k.invert(d)),e>d&&(p=e,e=d,d=p))),l&&(f=c[0][1],h=c[1][1],g||(f=q[0][1],h=q[1][1],l.invert&&(f=l.invert(f),h=l.invert(h)),f>h&&(p=f,f=h,h=p))),k&&l?[[e,f],[d,h]]:k?[e,d]:l&&[f,h])},b.clear=function(){return g=null,q[0][0]=q[0][1]=q[1][0]=q[1][1]=0,b},b.empty=function(){return k&&q[0][0]===
q[1][0]||l&&q[0][1]===q[1][1]},d3.rebind(b,h,"on")};var dd={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},le=["n e s w nw ne se sw".split(" "),["e","w"],["n","s"],[]];d3.behavior={};d3.behavior.drag=function(){function b(){this.on("mousedown.drag",c).on("touchstart.drag",c)}function c(){function b(){var c=k.parentNode;return null!=q?d3.touches(c).filter(function(b){return b.identifier===q})[0]:d3.mouse(c)}function f(){l({type:"dragend"});
P&&(D(),d3.event.target===p&&s.on("click.drag",g,!0));s.on(null!=q?"touchmove.drag-"+q:"mousemove.drag",null).on(null!=q?"touchend.drag-"+q:"mouseup.drag",null)}function g(){D();s.on("click.drag",null)}var h,k=this,l=e.of(k,arguments),p=d3.event.target,q=d3.event.touches?d3.event.changedTouches[0].identifier:null,r=b(),P=0,s=d3.select(window).on(null!=q?"touchmove.drag-"+q:"mousemove.drag",function(){if(!k.parentNode)return f();var c=b(),e=c[0]-r[0],d=c[1]-r[1];P|=e|d;r=c;D();l({type:"drag",x:c[0]+
h[0],y:c[1]+h[1],dx:e,dy:d})}).on(null!=q?"touchend.drag-"+q:"mouseup.drag",f,!0);d?(h=d.apply(k,arguments),h=[h.x-r[0],h.y-r[1]]):h=[0,0];null==q&&D();l({type:"dragstart"})}var e=I(b,"drag","dragstart","dragend"),d=null;return b.origin=function(c){return arguments.length?(d=c,b):d},d3.rebind(b,e,"on")};d3.behavior.zoom=function(){function b(){this.on("mousedown.zoom",h).on("mousewheel.zoom",k).on("mousemove.zoom",l).on("DOMMouseScroll.zoom",k).on("dblclick.zoom",p).on("touchstart.zoom",q).on("touchmove.zoom",
r).on("touchend.zoom",q)}function c(b){return[(b[0]-da[0])/Ja,(b[1]-da[1])/Ja]}function e(b){Ja=Math.max(y[0],Math.min(y[1],b))}function d(b,c){c=[c[0]*Ja+da[0],c[1]*Ja+da[1]];da[0]+=b[0]-c[0];da[1]+=b[1]-c[1]}function f(){u&&u.domain(t.range().map(function(b){return(b-da[0])/Ja}).map(t.invert));v&&v.domain(ma.range().map(function(b){return(b-da[1])/Ja}).map(ma.invert))}function g(b){f();d3.event.preventDefault();b({type:"zoom",scale:Ja,translate:da})}function h(){function b(){D();p.on("click.zoom",
null)}var e=this,f=qa.of(e,arguments),k=d3.event.target,l=0,p=d3.select(window).on("mousemove.zoom",function(){l=1;d(d3.mouse(e),q);g(f)}).on("mouseup.zoom",function(){l&&D();p.on("mousemove.zoom",null).on("mouseup.zoom",null);l&&d3.event.target===k&&p.on("click.zoom",b,!0)}),q=c(d3.mouse(e));window.focus();D()}function k(){P||(P=c(d3.mouse(this)));e(Math.pow(2,0.002*Be())*Ja);d(d3.mouse(this),P);g(qa.of(this,arguments))}function l(){P=null}function p(){var b=d3.mouse(this),f=c(b),h=Math.log(Ja)/
Math.LN2;e(Math.pow(2,d3.event.shiftKey?Math.ceil(h)-1:Math.floor(h)+1));d(b,f);g(qa.of(this,arguments))}function q(){var b=d3.touches(this),f=Date.now();if(s=Ja,P={},b.forEach(function(b){P[b.identifier]=c(b)}),D(),1===b.length){if(500>f-w){var h=b[0],b=c(b[0]);e(2*Ja);d(h,b);g(qa.of(this,arguments))}w=f}}function r(){var b=d3.touches(this),c=b[0],f=P[c.identifier];if(b=b[1]){var h=P[b.identifier],c=[(c[0]+b[0])/2,(c[1]+b[1])/2],f=[(f[0]+h[0])/2,(f[1]+h[1])/2];e(d3.event.scale*s)}d(c,f);w=null;g(qa.of(this,
arguments))}var P,s,t,u,ma,v,w,da=[0,0],Ja=1,y=me,qa=I(b,"zoom");return b.translate=function(c){return arguments.length?(da=c.map(Number),f(),b):da},b.scale=function(c){return arguments.length?(Ja=+c,f(),b):Ja},b.scaleExtent=function(c){return arguments.length?(y=null==c?me:c.map(Number),b):y},b.x=function(c){return arguments.length?(u=c,t=c.copy(),da=[0,0],Ja=1,b):u},b.y=function(c){return arguments.length?(v=c,ma=c.copy(),da=[0,0],Ja=1,b):v},d3.rebind(b,qa,"on")};var yd,me=[0,1/0];d3.layout={};
d3.layout.bundle=function(){return function(b){for(var c=[],e=-1,d=b.length;d>++e;)c.push(Ce(b[e]));return c}};d3.layout.chord=function(){function b(){var p,r,P,s,t,u={},ma=[],v=d3.range(g),w=[];e=[];d=[];p=0;for(s=-1;g>++s;){r=0;for(t=-1;g>++t;)r+=f[s][t];ma.push(r);w.push(d3.range(g));p+=r}h&&v.sort(function(b,c){return h(ma[b],ma[c])});k&&w.forEach(function(b,c){b.sort(function(b,e){return k(f[c][b],f[c][e])})});p=(2*Ga-q*g)/p;r=0;for(s=-1;g>++s;){P=r;for(t=-1;g>++t;){var da=v[s],Ja=w[da][t],y=
f[da][Ja],qa=r,z=r+=y*p;u[da+"-"+Ja]={index:da,subindex:Ja,startAngle:qa,endAngle:z,value:y}}d[da]={index:da,startAngle:P,endAngle:r,value:(r-P)/p};r+=q}for(s=-1;g>++s;)for(t=s-1;g>++t;)p=u[s+"-"+t],r=u[t+"-"+s],(p.value||r.value)&&e.push(p.value<r.value?{source:r,target:p}:{source:p,target:r});l&&c()}function c(){e.sort(function(b,c){return l((b.source.value+b.target.value)/2,(c.source.value+c.target.value)/2)})}var e,d,f,g,h,k,l,p={},q=0;return p.matrix=function(b){return arguments.length?(g=(f=
b)&&f.length,e=d=null,p):f},p.padding=function(b){return arguments.length?(q=b,e=d=null,p):q},p.sortGroups=function(b){return arguments.length?(h=b,e=d=null,p):h},p.sortSubgroups=function(b){return arguments.length?(k=b,e=null,p):k},p.sortChords=function(b){return arguments.length?(l=b,e&&c(),p):l},p.chords=function(){return e||b(),e},p.groups=function(){return d||b(),d},p};d3.layout.force=function(){function b(c){return function(b,e,d,f){if(b.point!==c){d=b.cx-c.x;var g=b.cy-c.y,h=1/Math.sqrt(d*
d+g*g);if(v>(f-e)*h)return e=b.charge*h*h,c.px-=d*e,c.py-=g*e,!0;b.point&&isFinite(h)&&(e=b.pointCharge*h*h,c.px-=d*e,c.py-=g*e)}return!b.charge}}function c(b){b.px=d3.event.x;b.py=d3.event.y;p.resume()}var e,d,f,h,l,p={},q=d3.dispatch("start","tick","end"),r=[1,1],P=0.9,s=Ue,t=nf,u=-30,ma=0.1,v=0.8,w=[],da=[];return p.tick=function(){if(0.005>(d*=0.99))return q.end({type:"end",alpha:d=0}),!0;var c,e,g,k,p,s,t,v,Ja=w.length,y=da.length;for(e=0;y>e;++e)g=da[e],c=g.source,k=g.target,t=k.x-c.x,v=k.y-
c.y,(p=t*t+v*v)&&(p=d*h[e]*((p=Math.sqrt(p))-f[e])/p,t*=p,v*=p,k.x-=t*(s=c.weight/(k.weight+c.weight)),k.y-=v*s,c.x+=t*(s=1-s),c.y+=v*s);if((s=d*ma)&&(t=r[0]/2,v=r[1]/2,e=-1,s))for(;Ja>++e;)g=w[e],g.x+=(t-g.x)*s,g.y+=(v-g.y)*s;if(u){re(c=d3.geom.quadtree(w),d,l);for(e=-1;Ja>++e;)(g=w[e]).fixed||c.visit(b(g))}for(e=-1;Ja>++e;)g=w[e],g.fixed?(g.x=g.px,g.y=g.py):(g.x-=(g.px-(g.px=g.x))*P,g.y-=(g.py-(g.py=g.y))*P);q.tick({type:"tick",alpha:d})},p.nodes=function(b){return arguments.length?(w=b,p):w},p.links=
function(b){return arguments.length?(da=b,p):da},p.size=function(b){return arguments.length?(r=b,p):r},p.linkDistance=function(b){return arguments.length?(s=k(b),p):s},p.distance=p.linkDistance,p.linkStrength=function(b){return arguments.length?(t=k(b),p):t},p.friction=function(b){return arguments.length?(P=b,p):P},p.charge=function(b){return arguments.length?(u="function"==typeof b?b:+b,p):u},p.gravity=function(b){return arguments.length?(ma=b,p):ma},p.theta=function(b){return arguments.length?(v=
b,p):v},p.alpha=function(b){return arguments.length?(d?d=0<b?b:0:0<b&&(q.start({type:"start",alpha:d=b}),d3.timer(p.tick)),p):d},p.start=function(){function b(f,g){var h,l;if(!d){d=[];for(e=0;k>e;++e)d[e]=[];for(e=0;q>e;++e)h=da[e],d[h.source.index].push(h.target),d[h.target.index].push(h.source)}l=d[c];for(var p=-1,r=l.length;r>++p;)if(!isNaN(h=l[p][f]))return h;return Math.random()*g}var c,e,d,g,k=w.length,q=da.length,P=r[0],ma=r[1];for(c=0;k>c;++c)(g=w[c]).index=c,g.weight=0;f=[];h=[];for(c=0;q>
c;++c)g=da[c],"number"==typeof g.source&&(g.source=w[g.source]),"number"==typeof g.target&&(g.target=w[g.target]),f[c]=s.call(this,g,c),h[c]=t.call(this,g,c),++g.source.weight,++g.target.weight;for(c=0;k>c;++c)g=w[c],isNaN(g.x)&&(g.x=b("x",P)),isNaN(g.y)&&(g.y=b("y",ma)),isNaN(g.px)&&(g.px=g.x),isNaN(g.py)&&(g.py=g.y);if(l=[],"function"==typeof u)for(c=0;k>c;++c)l[c]=+u.call(this,w[c],c);else for(c=0;k>c;++c)l[c]=u;return p.resume()},p.resume=function(){return p.alpha(0.1)},p.stop=function(){return p.alpha(0)},
p.drag=function(){e||(e=d3.behavior.drag().origin(g).on("dragstart",ae).on("drag",c).on("dragend",De));this.on("mouseover.force",qe).on("mouseout.force",Ee).call(e)},d3.rebind(p,q,"on")};d3.layout.partition=function(){function b(c,e,d,f){var g=c.children;if(c.x=e,c.y=c.depth*f,c.dx=d,c.dy=f,g&&(h=g.length)){var h,k,l=-1;for(d=c.value?d/c.value:0;h>++l;)b(k=g[l],e,c=k.value*d,f),e+=c}}function c(b){b=b.children;var e=0;if(b&&(d=b.length))for(var d,f=-1;d>++f;)e=Math.max(e,c(b[f]));return 1+e}function e(g,
h){var k=d.call(this,g,h);return b(k[0],0,f[0],f[1]/c(k[0])),k}var d=d3.layout.hierarchy(),f=[1,1];return e.size=function(b){return arguments.length?(f=b,e):f},be(e,d)};d3.layout.pie=function(){function b(g){var h=g.map(function(e,d){return+c.call(b,e,d)}),k=+("function"==typeof d?d.apply(this,arguments):d),l=(("function"==typeof f?f.apply(this,arguments):f)-d)/d3.sum(h),p=d3.range(g.length);null!=e&&p.sort(e===Ef?function(b,c){return h[c]-h[b]}:function(b,c){return e(g[b],g[c])});var q=[];return p.forEach(function(b){var c;
q[b]={data:g[b],value:c=h[b],startAngle:k,endAngle:k+=c*l}}),q}var c=Number,e=Ef,d=0,f=2*Ga;return b.value=function(e){return arguments.length?(c=e,b):c},b.sort=function(c){return arguments.length?(e=c,b):e},b.startAngle=function(c){return arguments.length?(d=c,b):d},b.endAngle=function(c){return arguments.length?(f=c,b):f},b};var Ef={};d3.layout.stack=function(){function b(g,l){var p=g.map(function(e,d){return c.call(b,e,d)}),q=p.map(function(c){return c.map(function(c,e){return[h.call(b,c,e),k.call(b,
c,e)]})}),r=e.call(b,q,l),p=d3.permute(p,r),q=d3.permute(q,r),P,s,t=d.call(b,q,l),u=p.length,ma=p[0].length;for(P=0;ma>P;++P){f.call(b,p[0][P],s=t[P],q[0][P][1]);for(r=1;u>r;++r)f.call(b,p[r][P],s+=q[r-1][P][1],q[r][P][1])}return g}var c=g,e=Bd,d=Xe,f=We,h=Ve,k=hb;return b.values=function(e){return arguments.length?(c=e,b):c},b.order=function(c){return arguments.length?(e="function"==typeof c?c:Qe.get(c)||Bd,b):e},b.offset=function(c){return arguments.length?(d="function"==typeof c?c:Pf.get(c)||Xe,
b):d},b.x=function(c){return arguments.length?(h=c,b):h},b.y=function(c){return arguments.length?(k=c,b):k},b.out=function(c){return arguments.length?(f=c,b):f},b};var Qe=d3.map({"inside-out":function(b){var c,e=b.length,d=b.map(of),f=b.map(Hf),g=d3.range(e).sort(function(b,c){return d[b]-d[c]}),h=0,k=0,l=[],p=[];for(b=0;e>b;++b)c=g[b],k>h?(h+=f[c],l.push(c)):(k+=f[c],p.push(c));return p.reverse().concat(l)},reverse:function(b){return d3.range(b.length).reverse()},"default":Bd}),Pf=d3.map({silhouette:function(b){var c,
e,d,f=b.length,g=b[0].length,h=[],k=0,l=[];for(e=0;g>e;++e){for(d=c=0;f>c;c++)d+=b[c][e][1];d>k&&(k=d);h.push(d)}for(e=0;g>e;++e)l[e]=(k-h[e])/2;return l},wiggle:function(b){var c,e,d,f,g,h,k,l,p,q=b.length,r=b[0],P=r.length,s=[];s[0]=l=p=0;for(e=1;P>e;++e){for(f=c=0;q>c;++c)f+=b[c][e][1];g=c=0;for(k=r[e][0]-r[e-1][0];q>c;++c){d=0;for(h=(b[c][e][1]-b[c][e-1][1])/(2*k);c>d;++d)h+=(b[d][e][1]-b[d][e-1][1])/k;g+=h*b[c][e][1]}s[e]=l-=f?g/f*k:0;p>l&&(p=l)}for(e=0;P>e;++e)s[e]-=p;return s},expand:function(b){var c,
e,d,f=b.length,g=b[0].length,h=1/f,k=[];for(e=0;g>e;++e){for(d=c=0;f>c;c++)d+=b[c][e][1];if(d)for(c=0;f>c;c++)b[c][e][1]/=d;else for(c=0;f>c;c++)b[c][e][1]=h}for(e=0;g>e;++e)k[e]=0;return k},zero:Xe});d3.layout.histogram=function(){function b(g,h){var k,l,p=[],q=g.map(e,this),r=d.call(this,q,h),P=f.call(this,r,q,h);h=-1;for(var s=q.length,t=P.length-1,u=c?1:1/s;t>++h;)k=p[h]=[],k.dx=P[h+1]-(k.x=P[h]),k.y=0;if(0<t)for(h=-1;s>++h;)l=q[h],l>=r[0]&&r[1]>=l&&(k=p[d3.bisect(P,l,1,t)-1],k.y+=u,k.push(g[h]));
return p}var c=!0,e=Number,d=pf,f=se;return b.value=function(c){return arguments.length?(e=c,b):e},b.range=function(c){return arguments.length?(d=k(c),b):d},b.bins=function(c){return arguments.length?(f="number"==typeof c?function(b){return Ge(b,c)}:k(c),b):f},b.frequency=function(e){return arguments.length?(c=!!e,b):c},b};d3.layout.hierarchy=function(){function b(c,h,k){var l=f.call(e,c,h);if(c.depth=h,k.push(c),l&&(p=l.length)){for(var p,q=-1,r=c.children=[],P=0,s=h+1;p>++q;)h=b(l[q],s,k),h.parent=
c,r.push(h),P+=h.value;d&&r.sort(d);g&&(c.value=P)}else g&&(c.value=+g.call(e,c,h)||0);return c}function c(b,d){var f=b.children,h=0;if(f&&(k=f.length))for(var k,l=-1,p=d+1;k>++l;)h+=c(f[l],p);else g&&(h=+g.call(e,b,d)||0);return g&&(b.value=h),h}function e(c){var d=[];return b(c,0,d),d}var d=rf,f=If,g=qf;return e.sort=function(b){return arguments.length?(d=b,e):d},e.children=function(b){return arguments.length?(f=b,e):f},e.value=function(b){return arguments.length?(g=b,e):g},e.revalue=function(b){return c(b,
0),b},e};d3.layout.pack=function(){function b(f,g){var h=c.call(this,f,g),k=h[0];k.x=0;k.y=0;nd(k,function(b){b.r=Math.sqrt(b.value)});nd(k,Ye);var l=d[0],p=d[1],q=Math.max(2*k.r/l,2*k.r/p);if(0<e){var r=e*q/2;nd(k,function(b){b.r+=r});nd(k,Ye);nd(k,function(b){b.r-=r});q=Math.max(2*k.r/l,2*k.r/p)}return ce(k,l/2,p/2,1/q),h}var c=d3.layout.hierarchy().sort(Pd),e=0,d=[1,1];return b.size=function(c){return arguments.length?(d=c,b):d},b.padding=function(c){return arguments.length?(e=+c,b):e},be(b,c)};
d3.layout.cluster=function(){function b(f,g){var h,k=c.call(this,f,g),l=k[0],p=0;nd(l,function(b){var c=b.children;c&&c.length?(b.x=vf(c),b.y=uf(c)):(b.x=h?p+=e(b,h):0,b.y=0,h=b)});var q=Je(l),r=$e(l),P=q.x-e(q,r)/2,s=r.x+e(r,q)/2;return nd(l,function(b){b.x=(b.x-P)/(s-P)*d[0];b.y=(1-(l.y?b.y/l.y:1))*d[1]}),k}var c=d3.layout.hierarchy().sort(null).value(null),e=af,d=[1,1];return b.separation=function(c){return arguments.length?(e=c,b):e},b.size=function(c){return arguments.length?(d=c,b):d},be(b,
c)};d3.layout.tree=function(){function b(f,g){function h(b,c){var d=b.children,f=b._tree;if(d&&(g=d.length)){for(var g,k,l,p=d[0],q=p,r=-1;g>++r;){l=d[r];h(l,k);var P=l;if(k){for(var s=void 0,t=P,u=P,ma=P.parent.children[0],v=t._tree.mod,w=u._tree.mod,da=k._tree.mod,Ja=ma._tree.mod;k=te(k),t=Ke(t),k&&t;){ma=Ke(ma);u=te(u);u._tree.ancestor=P;s=k._tree.prelim+da-t._tree.prelim-v+e(k,t);if(0<s){var y=k._tree.ancestor.parent==P.parent?k._tree.ancestor:q,qa=P,z=s,y=y._tree,qa=qa._tree,mb=z/(qa.number-
y.number);y.change+=mb;qa.change-=mb;qa.shift+=z;qa.prelim+=z;qa.mod+=z;v+=s;w+=s}da+=k._tree.mod;v+=t._tree.mod;Ja+=ma._tree.mod;w+=u._tree.mod}k&&!te(u)&&(u._tree.thread=k,u._tree.mod+=da-w);t&&!Ke(ma)&&(ma._tree.thread=t,ma._tree.mod+=v-Ja,q=P)}k=l}r=g=0;P=b.children;for(q=P.length;0<=--q;)d=P[q]._tree,d.prelim+=g,d.mod+=g,g+=d.shift+(r+=d.change);l=0.5*(p._tree.prelim+l._tree.prelim);c?(f.prelim=c._tree.prelim+e(b,c),f.mod=f.prelim-l):f.prelim=l}else c&&(f.prelim=c._tree.prelim+e(b,c))}function k(b,
c){b.x=b._tree.prelim+c;var e=b.children;if(e&&(d=e.length)){var d,f=-1;for(c+=b._tree.mod;d>++f;)k(e[f],c)}}var l=c.call(this,f,g),p=l[0];nd(p,function(b,c){b._tree={ancestor:b,prelim:0,mod:0,change:0,shift:0,number:c?c._tree.number+1:0}});h(p);k(p,-p._tree.prelim);var q=ue(p,Jf),r=ue(p,wf),P=ue(p,Kf),s=q.x-e(q,r)/2,t=r.x+e(r,q)/2,u=P.depth||1;return nd(p,function(b){b.x=(b.x-s)/(t-s)*d[0];b.y=b.depth/u*d[1];delete b._tree}),l}var c=d3.layout.hierarchy().sort(null).value(null),e=af,d=[1,1];return b.separation=
function(c){return arguments.length?(e=c,b):e},b.size=function(c){return arguments.length?(d=c,b):d},be(b,c)};d3.layout.treemap=function(){function b(c,e){for(var d,f,g=-1,h=c.length;h>++g;)f=(d=c[g]).value*(0>e?0:e),d.area=isNaN(f)||0>=f?0:f}function c(e){var f=e.children;if(f&&f.length){var g,h,k=q(e),l=[],p=f.slice(),r=1/0,t="slice"===P?k.dx:"dice"===P?k.dy:"slice-dice"===P?1&e.depth?k.dy:k.dx:Math.min(k.dx,k.dy);b(p,k.dx*k.dy/e.value);for(l.area=0;0<(e=p.length);){l.push(g=p[e-1]);l.area+=g.area;
if(!(e="squarify"!==P)){h=r;var u;e=t;u=void 0;for(var ma=l.area,v=0,w=1/0,da=-1,Ja=l.length;Ja>++da;)(u=l[da].area)&&(w>u&&(w=u),u>v&&(v=u));u=(ma*=ma,e*=e,ma?Math.max(e*v*s/ma,ma/(e*w*s)):1/0);e=h>=(h=u)}e?(p.pop(),r=h):(l.area-=l.pop().area,d(l,t,k,!1),t=Math.min(k.dx,k.dy),l.length=l.area=0,r=1/0)}l.length&&(d(l,t,k,!0),l.length=l.area=0);f.forEach(c)}}function e(c){var f=c.children;if(f&&f.length){var g=q(c),h=f.slice(),k=[];b(h,g.dx*g.dy/c.value);for(k.area=0;c=h.pop();)k.push(c),k.area+=c.area,
null!=c.z&&(d(k,c.z?g.dx:g.dy,g,!h.length),k.length=k.area=0);f.forEach(e)}}function d(b,c,e,f){var g,h=-1,l=b.length,p=e.x,q=e.y,r=c?k(b.area/c):0;if(c==e.dx){for((f||r>e.dy)&&(r=e.dy);l>++h;)g=b[h],g.x=p,g.y=q,g.dy=r,p+=g.dx=Math.min(e.x+e.dx-p,r?k(g.area/r):0);g.z=!0;g.dx+=e.x+e.dx-p;e.y+=r;e.dy-=r}else{for((f||r>e.dx)&&(r=e.dx);l>++h;)g=b[h],g.x=p,g.y=q,g.dx=r,q+=g.dy=Math.min(e.y+e.dy-q,r?k(g.area/r):0);g.z=!1;g.dy+=e.y+e.dy-q;e.x+=r;e.dx-=r}}function f(d){d=g||h(d);var k=d[0];return k.x=0,k.y=
0,k.dx=l[0],k.dy=l[1],g&&h.revalue(k),b([k],k.dx*k.dy/k.value),(g?e:c)(k),r&&(g=d),d}var g,h=d3.layout.hierarchy(),k=Math.round,l=[1,1],p=null,q=Le,r=!1,P="squarify",s=0.5*(1+Math.sqrt(5));return f.size=function(b){return arguments.length?(l=b,f):l},f.padding=function(b){function c(e){var d=b.call(f,e,e.depth);return null==d?Le(e):sb(e,"number"==typeof d?[d,d,d,d]:d)}function e(c){return sb(c,b)}if(!arguments.length)return p;var d;return q=null==(p=b)?Le:"function"==(d=typeof b)?c:"number"===d?(b=
[b,b,b,b],e):e,f},f.round=function(b){return arguments.length?(k=b?Math.round:Number,f):k!=Number},f.sticky=function(b){return arguments.length?(r=b,g=null,f):r},f.ratio=function(b){return arguments.length?(s=b,f):s},f.mode=function(b){return arguments.length?(P=b+"",f):P},be(f,h)};d3.csv=Me(",","text/csv");d3.tsv=Me(" ","text/tab-separated-values");d3.geo={};d3.geo.stream=function(b,c){ne.hasOwnProperty(b.type)?ne[b.type](b,c):tb(b,c)};var ne={Feature:function(b,c){tb(b.geometry,c)},FeatureCollection:function(b,
c){for(var e=b.features,d=-1,f=e.length;f>++d;)tb(e[d].geometry,c)}},Pe={Sphere:function(b,c){c.sphere()},Point:function(b,c){var e=b.coordinates;c.point(e[0],e[1])},MultiPoint:function(b,c){for(var e,d=b.coordinates,f=-1,g=d.length;g>++f;)e=d[f],c.point(e[0],e[1])},LineString:function(b,c){Ca(b.coordinates,c,0)},MultiLineString:function(b,c){for(var e=b.coordinates,d=-1,f=e.length;f>++d;)Ca(e[d],c,0)},Polygon:function(b,c){Sa(b.coordinates,c)},MultiPolygon:function(b,c){for(var e=b.coordinates,d=
-1,f=e.length;f>++d;)Sa(e[d],c)},GeometryCollection:function(b,c){for(var e=b.geometries,d=-1,f=e.length;f>++d;)tb(e[d],c)}};d3.geo.albersUsa=function(){function b(g){var h=g[0],k=g[1];return(50<k?e:-140>h?d:21>k?f:c)(g)}var c=d3.geo.albers(),e=d3.geo.albers().rotate([160,0]).center([0,60]).parallels([55,65]),d=d3.geo.albers().rotate([160,0]).center([0,20]).parallels([8,18]),f=d3.geo.albers().rotate([60,0]).center([0,10]).parallels([8,18]);return b.scale=function(g){return arguments.length?(c.scale(g),
e.scale(0.6*g),d.scale(g),f.scale(1.5*g),b.translate(c.translate())):c.scale()},b.translate=function(g){if(!arguments.length)return c.translate();var h=c.scale(),k=g[0],l=g[1];return c.translate(g),e.translate([k-0.4*h,l+0.17*h]),d.translate([k-0.19*h,l+0.2*h]),f.translate([k+0.58*h,l+0.43*h]),b},b.scale(c.scale())};(d3.geo.albers=function(){var b=29.5*Wa,c=45.5*Wa,e=Oc(pb),d=e(b,c);return d.parallels=function(d){return arguments.length?e(b=d[0]*Wa,c=d[1]*Wa):[b*Tb,c*Tb]},d.rotate([98,0]).center([0,
38]).scale(1E3)}).raw=pb;var Re=Hb(function(b){return Math.sqrt(2/(1+b))},function(b){return 2*Math.asin(b/2)});(d3.geo.azimuthalEqualArea=function(){return Ea(Re)}).raw=Re;var lf=Hb(function(b){return(b=Math.acos(b))&&b/Math.sin(b)},g);(d3.geo.azimuthalEquidistant=function(){return Ea(lf)}).raw=lf;d3.geo.bounds=vb(g);d3.geo.centroid=function(b){wc=Fc=cc=Yb=Eb=0;d3.geo.stream(b,Mc);var c;return Fc&&Math.abs(c=Math.sqrt(cc*cc+Yb*Yb+Eb*Eb))>nb?[Math.atan2(Yb,cc)*Tb,Math.asin(Math.max(-1,Math.min(1,
Eb/c)))*Tb]:void 0};var wc,Fc,cc,Yb,Eb,Mc={sphere:function(){2>wc&&(wc=2,Fc=cc=Yb=Eb=0)},point:ib,lineStart:ve,lineEnd:Ne,polygonStart:function(){2>wc&&(wc=2,Fc=cc=Yb=Eb=0);Mc.lineStart=wb},polygonEnd:function(){Mc.lineStart=ve}};d3.geo.circle=function(){function b(){var c="function"==typeof d?d.apply(this,arguments):d,f=Pc(-c[0]*Wa,-c[1]*Wa,0).invert,g=[];return e(null,null,1,{point:function(b,c){g.push(b=f(b,c));b[0]*=Tb;b[1]*=Tb}}),{type:"Polygon",coordinates:[g]}}var c,e,d=[0,0],f=6;return b.origin=
function(c){return arguments.length?(d=c,b):d},b.angle=function(d){return arguments.length?(e=Oe((c=+d)*Wa,f*Wa),b):c},b.precision=function(d){return arguments.length?(e=Oe(c*Wa,(f=+d)*Wa),b):f},b.angle(90)};var Bf=bf(h,function(b){var c,e=0/0,d=0/0,f=0/0;return{lineStart:function(){b.lineStart();c=1},point:function(g,h){var k=0<g?Ga:-Ga,l=Math.abs(g-e);if(nb>Math.abs(l-Ga))b.point(e,d=0<(d+h)/2?Ga/2:-Ga/2),b.point(f,d),b.lineEnd(),b.lineStart(),b.point(k,d),b.point(g,d),c=0;else if(f!==k&&l>=Ga){nb>
Math.abs(e-f)&&(e-=f*nb);nb>Math.abs(g-k)&&(g-=k*nb);var l=e,p=d,q=g,r,P,s=Math.sin(l-q);d=Math.abs(s)>nb?Math.atan((Math.sin(p)*(P=Math.cos(h))*Math.sin(q)-Math.sin(h)*(r=Math.cos(p))*Math.sin(l))/(r*P*s)):(p+h)/2;b.point(f,d);b.lineEnd();b.lineStart();b.point(k,d);c=0}b.point(e=g,d=h);f=k},lineEnd:function(){b.lineEnd();e=d=0/0},clean:function(){return 2-c}}},function(b,c,e,d){null==b?(e=e*Ga/2,d.point(-Ga,e),d.point(0,e),d.point(Ga,e),d.point(Ga,0),d.point(Ga,-e),d.point(0,-e),d.point(-Ga,-e),
d.point(-Ga,0),d.point(-Ga,e)):Math.abs(b[0]-c[0])>nb?(b=(b[0]<c[0]?1:-1)*Ga,e=e*b/2,d.point(-b,e),d.point(0,e),d.point(b,e)):d.point(c[0],c[1])});(d3.geo.equirectangular=function(){return Ea(dc).scale(250/Ga)}).raw=dc.invert=dc;var P=Hb(function(b){return 1/b},Math.atan);(d3.geo.gnomonic=function(){return Ea(P)}).raw=P;d3.geo.graticule=function(){function b(){return{type:"MultiLineString",coordinates:c()}}function c(){return d3.range(Math.ceil(d/l)*l,e,l).map(h).concat(d3.range(Math.ceil(g/p)*p,
f,p).map(k))}var e,d,f,g,h,k,l=22.5,p=l,q=2.5;return b.lines=function(){return c().map(function(b){return{type:"LineString",coordinates:b}})},b.outline=function(){return{type:"Polygon",coordinates:[h(d).concat(k(f).slice(1),h(e).reverse().slice(1),k(g).reverse().slice(1))]}},b.extent=function(c){return arguments.length?(d=+c[0][0],e=+c[1][0],g=+c[0][1],f=+c[1][1],d>e&&(c=d,d=e,e=c),g>f&&(c=g,g=f,f=c),b.precision(q)):[[d,g],[e,f]]},b.step=function(c){return arguments.length?(l=+c[0],p=+c[1],b):[l,
p]},b.precision=function(c){return arguments.length?(q=+c,h=kb(g,f,q),k=Ya(d,e,q),b):q},b.extent([[-180+nb,-90+nb],[180-nb,90-nb]])};d3.geo.interpolate=function(b,c){return Mb(b[0]*Wa,b[1]*Wa,c[0]*Wa,c[1]*Wa)};d3.geo.greatArc=function(){function e(){for(var b=f||k.apply(this,arguments),c=g||l.apply(this,arguments),d=h||d3.geo.interpolate(b,c),q=0,r=p/d.distance,b=[b];1>(q+=r);)b.push(d(q));return b.push(c),{type:"LineString",coordinates:b}}var f,g,h,k=c,l=b,p=6*Wa;return e.distance=function(){return(h||
d3.geo.interpolate(f||k.apply(this,arguments),g||l.apply(this,arguments))).distance},e.source=function(b){return arguments.length?(k=b,f="function"==typeof b?null:b,h=f&&g?d3.geo.interpolate(f,g):null,e):k},e.target=function(b){return arguments.length?(l=b,g="function"==typeof b?null:b,h=f&&g?d3.geo.interpolate(f,g):null,e):l},e.precision=function(b){return arguments.length?(p=b*Wa,e):p/Wa},e};we.invert=function(b,c){return[2*Ga*b,2*Math.atan(Math.exp(2*Ga*c))-Ga/2]};(d3.geo.mercator=function(){return Ea(we).scale(500)}).raw=
we;var ma=Hb(function(){return 1},Math.asin);(d3.geo.orthographic=function(){return Ea(ma)}).raw=ma;d3.geo.path=function(){function b(c){return c&&d3.geo.stream(c,d(f.pointRadius("function"==typeof h?+h.apply(this,arguments):h))),f.result()}var c,e,d,f,h=4.5;return b.area=function(b){return Ja=0,d3.geo.stream(b,d(fc)),Ja},b.centroid=function(b){return wc=cc=Yb=Eb=0,d3.geo.stream(b,d(zd)),Eb?[cc/Eb,Yb/Eb]:void 0},b.bounds=function(b){return vb(d)(b)},b.projection=function(e){return arguments.length?
(d=(c=e)?e.stream||Af(e):g,b):c},b.context=function(c){return arguments.length?(f=null==(e=c)?new ub:new Nb(c),b):e},b.pointRadius=function(c){return arguments.length?(h="function"==typeof c?c:+c,b):h},b.projection(d3.geo.albersUsa()).context(null)};var Ja,mb,fc={point:La,lineStart:La,lineEnd:La,polygonStart:function(){mb=0;fc.lineStart=Cd},polygonEnd:function(){fc.lineStart=fc.lineEnd=fc.point=La;Ja+=Math.abs(mb/2)}},zd={point:Da,lineStart:jc,lineEnd:Cc,polygonStart:function(){zd.lineStart=Dd},polygonEnd:function(){zd.point=
Da;zd.lineStart=jc;zd.lineEnd=Cc}};d3.geo.area=function(b){return Se=0,d3.geo.stream(b,ke),Se};var Se,je,ke={sphere:function(){Se+=4*Ga},point:La,lineStart:La,lineEnd:La,polygonStart:function(){je=0;ke.lineStart=ad},polygonEnd:function(){Se+=0>je?4*Ga+je:je;ke.lineStart=ke.lineEnd=ke.point=La}};d3.geo.projection=Ea;d3.geo.projectionMutator=Oc;var Uf=Hb(function(b){return 1/(1+b)},function(b){return 2*Math.atan(b)});(d3.geo.stereographic=function(){return Ea(Uf)}).raw=Uf;d3.geom={};d3.geom.hull=function(b){if(3>
b.length)return[];var c,e,d,f,g,h,k,l,p;e=b.length;var q=e-1,r=[],P=[],s=0;for(c=1;e>c;++c)b[c][1]<b[s][1]?s=c:b[c][1]==b[s][1]&&(s=b[c][0]<b[s][0]?c:s);for(c=0;e>c;++c)c!==s&&(f=b[c][1]-b[s][1],d=b[c][0]-b[s][0],r.push({angle:Math.atan2(f,d),index:c}));r.sort(function(b,c){return b.angle-c.angle});p=r[0].angle;l=r[0].index;k=0;for(c=1;q>c;++c)e=r[c].index,p==r[c].angle?(d=b[l][0]-b[s][0],f=b[l][1]-b[s][1],g=b[e][0]-b[s][0],h=b[e][1]-b[s][1],d*d+f*f>=g*g+h*h?r[c].index=-1:(r[k].index=-1,p=r[c].angle,
k=c,l=e)):(p=r[c].angle,k=c,l=e);P.push(s);for(e=c=0;2>c;++e)-1!==r[e].index&&(P.push(r[e].index),c++);for(d=P.length;q>e;++e)if(-1!==r[e].index){for(;!pd(P[d-2],P[d-1],r[e].index,b);)--d;P[d++]=r[e].index}q=[];for(c=0;d>c;++c)q.push(b[P[c]]);return q};d3.geom.polygon=function(b){return b.area=function(){for(var c=0,e=b.length,d=b[e-1][1]*b[0][0]-b[e-1][0]*b[0][1];e>++c;)d+=b[c-1][1]*b[c][0]-b[c-1][0]*b[c][1];return 0.5*d},b.centroid=function(c){var e,d,f=-1,g=b.length,h=0,k=0,l=b[g-1];for(arguments.length||
(c=-1/(6*b.area()));g>++f;)e=l,l=b[f],d=e[0]*l[1]-l[0]*e[1],h+=(e[0]+l[0])*d,k+=(e[1]+l[1])*d;return[h*c,k*c]},b.clip=function(c){for(var e,d,f,g,h,k,l=-1,p=b.length,q=b[p-1];p>++l;){e=c.slice();c.length=0;g=b[l];h=e[(f=e.length)-1];for(d=-1;f>++d;)k=e[d],xb(k,q,g)?(xb(h,q,g)||c.push(Wb(h,k,q,g)),c.push(k)):xb(h,q,g)&&c.push(Wb(h,k,q,g)),h=k;q=g}return c},b};d3.geom.voronoi=function(b){var c=b.map(function(){return[]});return xe(b,function(b){var e,d,f,g,h,k;1===b.a&&0<=b.b?(e=b.ep.r,d=b.ep.l):(e=
b.ep.l,d=b.ep.r);1===b.a?(h=e?e.y:-1E6,f=b.c-b.b*h,k=d?d.y:1E6,g=b.c-b.b*k):(f=e?e.x:-1E6,h=b.c-b.a*f,g=d?d.x:1E6,k=b.c-b.a*g);e=[f,h];g=[g,k];c[b.region.l.index].push(e,g);c[b.region.r.index].push(e,g)}),c=c.map(function(c,e){var d=b[e][0],f=b[e][1],g=c.map(function(b){return Math.atan2(b[0]-d,b[1]-f)});return d3.range(c.length).sort(function(b,c){return g[b]-g[c]}).filter(function(b,c,e){return!c||g[b]-g[e[c-1]]>nb}).map(function(b){return c[b]})}),c.forEach(function(c,e){var d=c.length;if(!d)return c.push([-1E6,
-1E6],[-1E6,1E6],[1E6,1E6],[1E6,-1E6]);if(!(2<d)){var f=b[e],g=c[0],h=c[1],d=f[0],f=f[1],k=g[0],g=g[1],l=h[0],p=h[1],q=Math.abs(l-k),h=p-g;nb>Math.abs(h)?(d=g>f?-1E6:1E6,c.push([-1E6,d],[1E6,d])):nb>q?(d=k>d?-1E6:1E6,c.push([d,-1E6],[d,1E6])):(d=(k-d)*(p-g)>(l-k)*(g-f)?1E6:-1E6,f=Math.abs(h)-q,nb>Math.abs(f)?c.push([0>h?d:-d,d]):(0<f&&(d*=-1),c.push([-1E6,d],[1E6,d])))}}),c};var Mf={l:"r",r:"l"};d3.geom.delaunay=function(b){var c=b.map(function(){return[]}),e=[];return xe(b,function(e){c[e.region.l.index].push(b[e.region.r.index])}),
c.forEach(function(c,d){var f=b[d],g=f[0],h=f[1];c.forEach(function(b){b.angle=Math.atan2(b[0]-g,b[1]-h)});c.sort(function(b,c){return b.angle-c.angle});for(var k=0,l=c.length-1;l>k;k++)e.push([f,c[k],c[k+1]])}),e};d3.geom.quadtree=function(b,c,e,d,f){function g(b,c,e,d,f,k){if(!isNaN(c.x)&&!isNaN(c.y))if(b.leaf){var l=b.point;l?0.01>Math.abs(l.x-c.x)+Math.abs(l.y-c.y)?h(b,c,e,d,f,k):(b.point=null,h(b,l,e,d,f,k),h(b,c,e,d,f,k)):b.point=c}else h(b,c,e,d,f,k)}function h(b,c,e,d,f,k){var l=0.5*(e+f),
p=0.5*(d+k),q=c.x>=l,r=c.y>=p,P=(r<<1)+q;b.leaf=!1;b=b.nodes[P]||(b.nodes[P]={leaf:!0,nodes:[],point:null});q?e=l:f=l;r?d=p:k=p;g(b,c,e,d,f,k)}var k,l=-1,p=b.length;if(5>arguments.length)if(3===arguments.length)f=e,d=c,e=c=0;else{c=e=1/0;for(d=f=-1/0;p>++l;)k=b[l],c>k.x&&(c=k.x),e>k.y&&(e=k.y),k.x>d&&(d=k.x),k.y>f&&(f=k.y)}k=d-c;l=f-e;k>l?f=e+k:d=c+l;var q={leaf:!0,nodes:[],point:null};return q.add=function(b){g(q,b,c,e,d,f)},q.visit=function(b){Fd(b,q,c,e,d,f)},b.forEach(q.add),q};d3.time={};var Tc=
Date;Xc.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},
valueOf:function(){return this._.valueOf()},setDate:function(){Xd.setUTCDate.apply(this._,arguments)},setDay:function(){Xd.setUTCDay.apply(this._,arguments)},setFullYear:function(){Xd.setUTCFullYear.apply(this._,arguments)},setHours:function(){Xd.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Xd.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Xd.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Xd.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Xd.setUTCSeconds.apply(this._,
arguments)},setTime:function(){Xd.setTime.apply(this._,arguments)}};var Xd=Date.prototype,Vf="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Wf="Sun Mon Tue Wed Thu Fri Sat".split(" "),Qf="January February March April May June July August September October November December".split(" "),Rf="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ");d3.time.format=function(b){function c(d){for(var f,g,h,k=[],l=-1,p=0;e>++l;)37===b.charCodeAt(l)&&(k.push(b.substring(p,l)),null!=
(g=eg[f=b.charAt(++l)])&&(f=b.charAt(++l)),(h=Ff[f])&&(f=h(d,null==g?"e"===f?" ":"0":g)),k.push(f),p=l+1);return k.push(b.substring(p,l)),k.join("")}var e=b.length;return c.parse=function(c){var e={y:1900,m:0,d:1,H:0,M:0,S:0,L:0};if(qd(e,b,c,0)!=c.length)return null;"p"in e&&(e.H=e.H%12+12*e.p);c=new Tc;return c.setFullYear(e.y,e.m,e.d),c.setHours(e.H,e.M,e.S,e.L),c},c.toString=function(){return b},c};var Xf=rd(Vf),Yf=rd(Wf),Zf=rd(Qf),fg=ye(Qf),$f=rd(Rf),gg=ye(Rf),eg={"-":"",_:" ",0:"0"},Ff={a:function(b){return Wf[b.getDay()]},
A:function(b){return Vf[b.getDay()]},b:function(b){return Rf[b.getMonth()]},B:function(b){return Qf[b.getMonth()]},c:d3.time.format("%a %b %e %X %Y"),d:function(b,c){return Zb(b.getDate(),c,2)},e:function(b,c){return Zb(b.getDate(),c,2)},H:function(b,c){return Zb(b.getHours(),c,2)},I:function(b,c){return Zb(b.getHours()%12||12,c,2)},j:function(b,c){return Zb(1+d3.time.dayOfYear(b),c,3)},L:function(b,c){return Zb(b.getMilliseconds(),c,3)},m:function(b,c){return Zb(b.getMonth()+1,c,2)},M:function(b,
c){return Zb(b.getMinutes(),c,2)},p:function(b){return 12<=b.getHours()?"PM":"AM"},S:function(b,c){return Zb(b.getSeconds(),c,2)},U:function(b,c){return Zb(d3.time.sundayOfYear(b),c,2)},w:function(b){return b.getDay()},W:function(b,c){return Zb(d3.time.mondayOfYear(b),c,2)},x:d3.time.format("%m/%d/%Y"),X:d3.time.format("%H:%M:%S"),y:function(b,c){return Zb(b.getFullYear()%100,c,2)},Y:function(b,c){return Zb(b.getFullYear()%1E4,c,4)},Z:function(b){var c=b.getTimezoneOffset();b=0<c?"-":"+";var e=~~(Math.abs(c)/
60),c=Math.abs(c)%60;return b+Zb(e,"0",2)+Zb(c,"0",2)},"%":function(){return"%"}},dg={a:function(b,c,e){Yf.lastIndex=0;return(b=Yf.exec(c.substring(e)))?e+b[0].length:-1},A:function(b,c,e){Xf.lastIndex=0;return(b=Xf.exec(c.substring(e)))?e+b[0].length:-1},b:function(b,c,e){$f.lastIndex=0;return(c=$f.exec(c.substring(e)))?(b.m=gg.get(c[0].toLowerCase()),e+c[0].length):-1},B:function(b,c,e){Zf.lastIndex=0;return(c=Zf.exec(c.substring(e)))?(b.m=fg.get(c[0].toLowerCase()),e+c[0].length):-1},c:function(b,
c,e){return qd(b,""+Ff.c,c,e)},d:sd,e:sd,H:td,I:td,L:function(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+3)))?(b.L=+c[0],e+c[0].length):-1},m:function(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+2)))?(b.m=c[0]-1,e+c[0].length):-1},M:function(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+2)))?(b.M=+c[0],e+c[0].length):-1},p:function(b,c,e){c=hg.get(c.substring(e,e+=2).toLowerCase());return null==c?-1:(b.p=c,e)},S:function(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,
e+2)))?(b.S=+c[0],e+c[0].length):-1},x:function(b,c,e){return qd(b,""+Ff.x,c,e)},X:function(b,c,e){return qd(b,""+Ff.X,c,e)},y:function(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+2)))?(b.y=+c[0]+(68<+c[0]?1900:2E3),e+c[0].length):-1},Y:function(b,c,e){Sc.lastIndex=0;return(c=Sc.exec(c.substring(e,e+4)))?(b.y=+c[0],e+c[0].length):-1}},Sc=/^\s*\d+/,hg=d3.map({am:0,pm:1});d3.time.format.utc=function(b){function c(b){try{Tc=Xc;var d=new Tc;return d._=b,e(d)}finally{Tc=Date}}var e=d3.time.format(b);
return c.parse=function(b){try{Tc=Xc;var c=e.parse(b);return c&&c._}finally{Tc=Date}},c.toString=e.toString,c};var ag=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?ee:ag;ee.parse=function(b){b=new Date(b);return isNaN(b)?null:b};ee.toString=ag.toString;d3.time.second=Uc(function(b){return new Tc(1E3*Math.floor(b/1E3))},function(b,c){b.setTime(b.getTime()+1E3*Math.floor(c))},function(b){return b.getSeconds()});d3.time.seconds=d3.time.second.range;d3.time.seconds.utc=
d3.time.second.utc.range;d3.time.minute=Uc(function(b){return new Tc(6E4*Math.floor(b/6E4))},function(b,c){b.setTime(b.getTime()+6E4*Math.floor(c))},function(b){return b.getMinutes()});d3.time.minutes=d3.time.minute.range;d3.time.minutes.utc=d3.time.minute.utc.range;d3.time.hour=Uc(function(b){var c=b.getTimezoneOffset()/60;return new Tc(36E5*(Math.floor(b/36E5-c)+c))},function(b,c){b.setTime(b.getTime()+36E5*Math.floor(c))},function(b){return b.getHours()});d3.time.hours=d3.time.hour.range;d3.time.hours.utc=
d3.time.hour.utc.range;d3.time.day=Uc(function(b){var c=new Tc(1970,0);return c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),c},function(b,c){b.setDate(b.getDate()+c)},function(b){return b.getDate()-1});d3.time.days=d3.time.day.range;d3.time.days.utc=d3.time.day.utc.range;d3.time.dayOfYear=function(b){var c=d3.time.year(b);return Math.floor((b-c-6E4*(b.getTimezoneOffset()-c.getTimezoneOffset()))/864E5)};"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" ").forEach(function(b,
c){b=b.toLowerCase();c=7-c;var e=d3.time[b]=Uc(function(b){return(b=d3.time.day(b)).setDate(b.getDate()-(b.getDay()+c)%7),b},function(b,c){b.setDate(b.getDate()+7*Math.floor(c))},function(b){var e=d3.time.year(b).getDay();return Math.floor((d3.time.dayOfYear(b)+(e+c)%7)/7)-(e!==c)});d3.time[b+"s"]=e.range;d3.time[b+"s"].utc=e.utc.range;d3.time[b+"OfYear"]=function(b){var e=d3.time.year(b).getDay();return Math.floor((d3.time.dayOfYear(b)+(e+c)%7)/7)}});d3.time.week=d3.time.sunday;d3.time.weeks=d3.time.sunday.range;
d3.time.weeks.utc=d3.time.sunday.utc.range;d3.time.weekOfYear=d3.time.sundayOfYear;d3.time.month=Uc(function(b){return b=d3.time.day(b),b.setDate(1),b},function(b,c){b.setMonth(b.getMonth()+c)},function(b){return b.getMonth()});d3.time.months=d3.time.month.range;d3.time.months.utc=d3.time.month.utc.range;d3.time.year=Uc(function(b){return b=d3.time.day(b),b.setMonth(0,1),b},function(b,c){b.setFullYear(b.getFullYear()+c)},function(b){return b.getFullYear()});d3.time.years=d3.time.year.range;d3.time.years.utc=
d3.time.year.utc.range;var Cf=[1E3,5E3,15E3,3E4,6E4,3E5,9E5,18E5,36E5,108E5,216E5,432E5,864E5,1728E5,6048E5,2592E6,7776E6,31536E6],Sf=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],ig=[[d3.time.format("%Y"),h],[d3.time.format("%B"),
function(b){return b.getMonth()}],[d3.time.format("%b %d"),function(b){return 1!=b.getDate()}],[d3.time.format("%a %d"),function(b){return b.getDay()&&1!=b.getDate()}],[d3.time.format("%I %p"),function(b){return b.getHours()}],[d3.time.format("%I:%M"),function(b){return b.getMinutes()}],[d3.time.format(":%S"),function(b){return b.getSeconds()}],[d3.time.format(".%L"),function(b){return b.getMilliseconds()}]],bg=d3.scale.linear(),jg=Gd(ig);Sf.year=function(b,c){return bg.domain(b.map($b)).ticks(c).map(ud)};
d3.time.scale=function(){return ec(d3.scale.linear(),Sf,jg)};var cg=Sf.map(function(b){return[b[0].utc,b[1]]}),kg=[[d3.time.format.utc("%Y"),h],[d3.time.format.utc("%B"),function(b){return b.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(b){return 1!=b.getUTCDate()}],[d3.time.format.utc("%a %d"),function(b){return b.getUTCDay()&&1!=b.getUTCDate()}],[d3.time.format.utc("%I %p"),function(b){return b.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(b){return b.getUTCMinutes()}],[d3.time.format.utc(":%S"),
function(b){return b.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(b){return b.getUTCMilliseconds()}]],lg=Gd(kg);cg.year=function(b,c){return bg.domain(b.map(Db)).ticks(c).map(ac)};d3.time.scale.utc=function(){return ec(d3.scale.linear(),cg,lg)}})()},"1.0");
YUI.add("squarespace-multi-loader",function(b){b.namespace("Squarespace");b.Squarespace.MultiLoader=b.Base.create("MultiLoader",b.Base,[],{initializer:function(){this.publish("load")},load:function(){var d=new b.Parallel;b.Array.each(this.get("loadables"),function(b){b.load(d.add())});d.done(b.bind(function(){this.fire("load")},this))}},{ATTRS:{loadables:{value:[],validator:function(d){return b.Array.some(d,function(c){return!b.Lang.isFunction(c.load)})?(console.error("Squarespace.MultiLoader: One or more loadables do not have a load function."),
!1):!0},writeOnce:"initOnly"}}})},"1.0",{requires:["base","parallel"]});
YUI.add("squarespace-dialog-checklist-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-checklist.html"]=b(function(b,c,d,h,k){function l(b,c){return'\n             <div class="markComplete">Skip this Task</div>\n            '}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p=this.escapeExpression,q=this;if((h=d["with"].call(c,c.strings,{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e='\n\n  <div class="checklist-status">\n\n    <div class="bullet"><div class="num"></div></div>\n    <div class="congrats">\n      <div class="body">\n        <div class="title">';
(f=d.congratsTitle)?f=f.call(b,{hash:{},data:c}):(f=b.congratsTitle,f="function"===typeof f?f.apply(b):f);e+=p(f)+'</div>\n        <div class="desc">';(f=d.congratsDescription)?f=f.call(b,{hash:{},data:c}):(f=b.congratsDescription,f="function"===typeof f?f.apply(b):f);return e+=p(f)+"</div>\n      </div>\n    </div>\n  </div>\n\n"},k),data:k}))||0===h)b+=h;b+='\n\n  <div class="checklist">\n\n  ';if((h=d.each.call(c,c.tasks,{hash:{},inverse:q.noop,fn:q.program(3,function(b,c){var e,f;e='\n       <div class="task" data-task="';
(f=d.task)?f=f.call(b,{hash:{},data:c}):(f=b.task,f="function"===typeof f?f.apply(b):f);e+=p(f)+'">\n         <div class="bullet"><div class="num">';(f=d.number)?f=f.call(b,{hash:{},data:c}):(f=b.number,f="function"===typeof f?f.apply(b):f);e+=p(f)+'</div></div>\n         <div class="taskbody">\n           <div class="name">';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f="function"===typeof f?f.apply(b):f);e+=p(f)+"</div>\n            ";if((f=d["if"].call(b,b.skippable,{hash:{},inverse:q.noop,
fn:q.program(4,l,c),data:c}))||0===f)e+=f;e+='\n             <div class="desc">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f="function"===typeof f?f.apply(b):f);return e+=p(f)+"</div>\n         </div>\n       </div>\n  "},k),data:k}))||0===h)b+=h;return b+"\n\n  </div>\n"})})();b.Handlebars.registerPartial("dialog-checklist.html".replace("/","."),d.templates["dialog-checklist.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-input-utils",function(b){b.namespace("Squarespace");b.Squarespace.InputUtils={correctNumericField:function(d){b.Lang.isNumber(Number(d.get("value")))?d.set("value",Number(d.get("value")).toFixed(2)):d.set("value","0.00")},getValueForOption:function(b,c){return"numeric"==c?Number(b.get("value")):"money"==c?100*Number(b.get("value")).toFixed(2):b.get("value")||""}}},"1.0",{requires:["event","node","base"]});
YUI.add("squarespace-content-manager-widgets-save-changes-tray",function(b){b.namespace("Squarespace.ContentManagerWidgets");b.Squarespace.ContentManagerWidgets.SaveChangesTray=b.Base.create("saveChangesTray",b.Base,[b.Squarespace.Mixins.SaveChanges],{initializer:function(){this._saveChangesTray=this.add(new b.Squarespace.Widgets.ActionTray({"strings.title":"Unsaved Changes","strings.subtitle":"The changes will not be saved until you click Publish, Cancel will revert the changes.",visible:!1,buttons:[{label:"Save & Publish",
action:this._initSaveChanges,context:this,className:"dark"},{label:"Cancel",action:this.revertChanges,context:this,className:"light"}]})).item(0);this.publish("show-save-changes-tray",{emitFacade:!0,defaultFn:function(){this._saveChangesTray.show()}});this.publish("hide-save-changes-tray",{emitFacade:!0,defaultFn:function(){this._saveChangesTray.hide()}});this.after("dirtyChange",function(b){b.newVal?this.fire("show-save-changes-tray"):this.fire("hide-save-changes-tray")},this)}});b.Squarespace.ContentManagerWidgets.SaveChangesInHeaderTray=
b.Base.create("SaveChangesInHeaderTray",b.Base,[b.Squarespace.Mixins.SaveChanges],{initializer:function(){this.after("dirtyChange",function(){var b=this._getHeaderTrayOptions().buttons;this.get("dirty")&&(b=[].concat(this._getHeaderTrayOptions().buttons,[{label:"Cancel",className:"cancel primary",action:this.revertChanges,context:this},{label:"Save",className:"save primary",action:this._initSaveChanges,context:this}]));this.headerTray.set("buttons",b,{animate:!0})},this)}})},"1.0",{requires:["base",
"squarespace-tray","squarespace-ui-base","squarespace-mixin-save-changes"]});
YUI.add("squarespace-layout-help",function(b){b.namespace("Squarespace.Layout").Help={_hasCompletedMemberTutorial:function(d){if(b.Squarespace.Utils.isDamaskEnabled())return!0;var c=b.merge(Static.SQUARESPACE_CONTEXT.authenticatedAccount.tutorialsCompleted,Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted);return!(!c||!c.welcome||!c[d])},_markTutorialCompleted:function(d){b.Data.post({url:"/api/config/MarkMemberTutorialCompleted",data:{tutorial:d}},this);b.Lang.isObject(Static.SQUARESPACE_CONTEXT.authenticatedAccount.tutorialsCompleted)||
(Static.SQUARESPACE_CONTEXT.authenticatedAccount.tutorialsCompleted={});Static.SQUARESPACE_CONTEXT.authenticatedAccount.tutorialsCompleted[d]=!0},showIfNeeded:function(){this._hasCompletedMemberTutorial("le2-welcome")||(this._markTutorialCompleted("le2-welcome"),b.Squarespace.Help.showLayoutEngine2Welcome())}}});
YUI.add("squarespace-form-field-configs",function(b){b.Squarespace.FormFieldConfigs={TEXT:{type:"text",id:null,locked:!1,title:"Text",description:"",placeholder:"",required:!1,text:!0},TEXT_AREA:{type:"textarea",id:null,locked:!1,title:"Text Area",description:"",placeholder:"",required:!1,textarea:!0},EMAIL:{type:"email",id:null,locked:!1,title:"Email",description:"",placeholder:"",required:!1,email:!0},CURRENCY:{type:"currency",id:null,locked:!1,title:"Currency",description:"",currencySymbol:"$",
required:!1,currency:!0},NUMBER:{type:"number",id:null,locked:!1,title:"Number",description:"",placeholder:"",required:!1,number:!0},WEBSITE:{type:"website",id:null,locked:!1,title:"Website",description:"",placeholder:"",required:!1,website:!0},PASSWORD:{type:"password",id:null,locked:!1,title:"Password",description:"",required:!1,password:!0},TWITTER:{type:"twitter",id:null,locked:!1,title:"Twitter",description:"",required:!1,twitter:!0},DATE:{type:"date",id:null,locked:!1,title:"Date",description:"",
required:!1,date:!0},TIME:{type:"time",id:null,locked:!1,title:"Time",description:"",required:!1,time:!0},NAME:{type:"name",id:null,locked:!1,title:"Name",description:"",required:!1,name:!0},ADDRESS:{type:"address",id:null,locked:!1,title:"Address",description:"",required:!1,address:!0},PHONE:{type:"phone",id:null,locked:!1,title:"Phone",description:"",showCountryCode:!1,required:!1,phone:!0},SECTION:{type:"section",id:null,locked:!1,title:"Section",description:"",underline:!0,section:!0},RADIO:{type:"radio",
id:null,locked:!1,title:"Radio",description:"",options:["Option One","Option Two"],required:!1,radio:!0},CHECKBOX:{type:"checkbox",id:null,locked:!1,title:"Checkbox",description:"",options:["Option One","Option Two"],required:!1,checkbox:!0},SELECT:{type:"select",id:null,locked:!1,title:"Select",description:"",options:["Option One","Option Two"],required:!1,select:!0},LIKERT:{type:"likert",id:null,locked:!1,title:"Survey",description:"",options:["Option One","Option Two"],required:!1,likert:!0},HIDDEN:{type:"hidden",
id:null,locked:!1,title:"Hidden",description:"",required:!1,hidden:!0}}},"1.0",{requires:[]});
YUI.add("squarespace-content-item-types-product-digital",function(b){var d=b.namespace("Squarespace.ContentItemEditor").ProductDigital=b.Base.create("ProductDigitalContentItemEditor",b.Squarespace.ContentItemEditor.Product,[],{initializer:function(){var c=this.get("dialog");c.on("ready",function(){c.getField("digitalPricing");var e=c.getField("pricingPlaceholder"),d=this.get("model");c.getField("digitalGoods").on("dataChange",function(c){null===c.newVal&&d.clearChildGroup("digitalGoods",b.bind(function(){d.set("digitalGoods",
null)},this))},this);var g=function(){e.set("data",b.merge(e.get("data"),{priceCents:c.getField("priceCents").getValue(),salePriceCents:c.getField("salePriceCents").getValue(),onSale:c.getField("onSale").getValue()}))};c.getField("priceCents").after("dataChange",g);c.getField("salePriceCents").after("dataChange",g);c.getField("onSale").after("dataChange",g)},this)},validateFields:function(){var c=this.get("dialog"),e=c.getField("digitalGoods").get("data"),d=c.getField("priceCents").get("data"),c=
c.getField("salePriceCents").get("data");return!b.Lang.isValue(e)||b.Lang.isValue(e)&&!b.Lang.isValue(e.get("id"))?{digitalGoods:"You must upload a file for this digital product."}:d<c?{salePriceCents:"Sale price must be less than standard price"}:null},getDialogData:function(){var c=d.superclass.getDialogData.call(this),e=c.structuredContent,f=this.get("model"),g=f.get("digitalGoods");g&&0<g.length?(1<g.length&&console.warn("Multiple digital goods stored."),f=new b.Squarespace.Models.ContentItem(g[0])):
f=new b.Squarespace.Models.ContentItem({collectionId:f.get("collectionId"),parentId:f.get("id"),recordType:b.Squarespace.RecordType.DIGITALGOOD});return b.merge(c,{priceCents:e.priceCents,salePriceCents:e.salePriceCents,onSale:e.onSale,pricingPlaceholder:{productType:b.Squarespace.ProductTypes.DIGITAL,priceCents:e.priceCents,salePriceCents:e.salePriceCents,onSale:e.onSale},digitalGoods:f})},sanitizeDialogData:function(c){c=d.superclass.sanitizeDialogData.call(this,c);c.structuredContent=b.merge(c.structuredContent,
{productType:b.Squarespace.ProductTypes.DIGITAL,priceCents:c.priceCents,salePriceCents:c.salePriceCents,onSale:c.onSale});return c},getPresentationName:function(){return"Digital Product"}},{ATTRS:{editorConfiguration:{value:{name:"editProduct",title:"Edit {presentationName}",width:850,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?550:420}},overlay:0.5,closeOthers:!1,initialDataByReference:!0,tabs:[{$include:"tabs.primary.product.base",$update:{".pricingPlaceholder":{$include:"fields.productDigitalPricingPlaceholder"}}},
{$include:"tabs.product.upload"},{$include:"tabs.product.additionalInfo"},{$include:"tabs.product.workflow"},{$include:"tabs.options.product"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["base","squarespace-content-item-types-product","squarespace-util"]});
YUI.add("squarespace-dialog-content-item-grid",function(b){b.namespace("Squarespace");var d=b.Squarespace.DialogFields.ContentItemGrid=b.Base.create("contentItemGridField",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(b){this._initializeDataAndGrid();this.after("dataChange",this._initializeDataAndGrid,this);this._edited=!1},destructor:function(){var b=this._contentItemGrid;b&&b.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var c=this._loadingEl=b.Node.create('<div class="loading-state"></div>');
(this._loadingSpinner=new b.Squarespace.Spinner({size:50,color:"dark",render:c})).spin();this.get("contentBox").append(c)},bindUI:function(){d.superclass.bindUI.call(this);this.after("dataLoadedChange",this.syncUI,this);this.on("dataChange",function(b){this._contentItemGrid.set("model",b.newVal)},this);this.on("uploadPreflightChange",function(b){this._contentItemGrid.set("uploadPreflight",b.newVal)})},syncUI:function(){d.superclass.syncUI.call(this);this.get("dataLoaded")?this._setLoadedState():this._setLoadingState()},
didDataChange:function(){return this._edited},show:function(){d.superclass.show.call(this);this.syncUI()},enableDragSelection:function(){var b=this._contentItemGrid;b&&b.enableDragSelection()},disableDragSelection:function(){var b=this._contentItemGrid;b&&b.disableDragSelection()},_initializeDataAndGrid:function(){this.set("dataLoaded",!1);var c=this.get("data"),e={},d=this.get("pageSize");b.Lang.isValue(d)&&(e.limit=d);c.isNew()?(this._buildContentItemGrid(),this.set("dataLoaded",!0)):c instanceof
b.Squarespace.Models.ContentItem?(this.get("acceptTypes")||this.set("acceptTypes",["image"]),this._buildContentItemGrid(),this.set("dataLoaded",!0)):c.items.load(e,b.bind(function(e){e&&new b.Squarespace.Widgets.Alert({"strings.title":"Missing Content","strings.message":"We could not locate this content."});this.get("acceptTypes")||this.set("acceptTypes",c.getTemplateConfiguration().get("acceptTypes"));this._buildContentItemGrid();this.set("dataLoaded",!0)},this))},_buildContentItemGrid:function(){var c=
this._contentItemGrid;c&&c.destroy();this._contentItemGrid=new b.Squarespace.ContentItemGrid({model:this.get("data"),collectionConfiguration:this.get("collectionConfiguration")||new b.Model({acceptTypes:this.get("acceptTypes")}),itemEditorOptions:{variant:b.Squarespace.ContentItemEditorVariants.MINIMAL,parentDialog:this.get("dialog"),anchorToImageWidget:!0,defaultWorkflowState:b.Squarespace.WorkflowStates.PUBLISHED},selectorAnchorNode:this.get("selectorAnchorNode"),imageSize:105,minMargin:10,showActionTray:!1,
showEmptyState:!1,dragRegion:this.get("contentBox"),uploadPreflight:this.get("uploadPreflight"),contentItemImageOptions:this.get("contentItemImageOptions"),showAddIcon:this.get("showAddIcon"),loadByViewport:!1})},_setLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this.get("boundingBox").removeClass("content-loading");var b=this._contentItemGrid;b.get("rendered")?b.syncUI():b.render(this.get("contentBox"))},_setLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();
this._loadingTimer=b.later(500,this,function(){this._loadingEl.setStyle("marginTop",this.get("contentBox").get("offsetHeight")/2-this._loadingSpinner.get("size")/2);this.get("boundingBox").addClass("content-loading")})}},{CSS_PREFIX:"sqs-content-item-grid-field",ASYNC_DATA:!0,ATTRS:{data:{getter:function(c){return!(c instanceof b.Squarespace.Models.ContentCollection||c instanceof b.Squarespace.Models.ContentItem)?(c="Transient Gallery "+b.Squarespace.Utils.getGuid(),new b.Squarespace.Models.ContentCollection({typeName:"transient-gallery",
type:b.Squarespace.CollectionTypes.GALLERY_BLOCK,ordering:b.Squarespace.CollectionOrdering.USER,title:c,navigationTitle:c,enabled:!0,urlId:b.Squarespace.Utils.getGuid()})):c},validator:function(c){return c instanceof b.Squarespace.Models.ContentCollection||c instanceof b.Squarespace.Models.ContentItem}},dataLoaded:{value:!1},acceptTypes:{},collectionConfiguration:{},contentItemImageOptions:{value:{showActionOverlay:!0,actionOverlayButtons:[b.Squarespace.ActionOverlayButtons.EDIT_IMAGE,b.Squarespace.ActionOverlayButtons.REMOVE_IMAGE]}},
selectorAnchorNode:{valueFn:function(){return this.get("contentBox")}},cloneInitialData:{value:!1},uploadPreflight:{},showAddIcon:{value:!1},pageSize:{value:null}}})},"1.0",{requires:"base widget-parent squarespace-util squarespace-dialog-field-2 squarespace-content-item-grid squarespace-models-content-collection squarespace-models-content-item squarespace-plugin-actionoverlay squarespace-spinner squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-settings-billing-free",function(b){b.namespace("Squarespace.Widgets").BillingSettingsFree=b.Base.create("billingSettingsFree",b.Squarespace.Widgets.SettingsPanel,[b.Squarespace.Widgets.BillingSettingsBase],{initializer:function(d){switch(Static.SQUARESPACE_CONTEXT.website.siteStatus.value){case b.Squarespace.StatusConstants.COMPED:d="Someone at Squarespace must really like you.  This account is on the house.";var c=Static.SQUARESPACE_CONTEXT.website.siteStatus.expiration;c&&(d=
"Your free account will expire on "+b.DataType.Date.format(new Date(c),{format:"%A, %B %d at %l:%M %p"}));d=[{ctor:b.Squarespace.DialogFields.Description,config:{padding:[0,10],className:"removed billing-subpanel-unavailable",title:"Well look at you and your free account.",text:d}}];break;case b.Squarespace.StatusConstants.INTERNAL:d=[{ctor:b.Squarespace.DialogFields.Description,config:{padding:[0,10],className:"removed billing-subpanel-unavailable",title:"This is a Squarespace internal account.",
text:"Hopefully you work at Squarespace."}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"removeAccount","strings.text":"Remove Account"}}];this.after("fields-rendered",function(){this.getField("removeAccount").setOnClick(this._removeAccount,this)},this);break;case b.Squarespace.StatusConstants.REMOVED:d=[{ctor:b.Squarespace.DialogFields.Description,config:{padding:[0,0],className:"removed billing-subpanel-unavailable",title:"Account Removed",text:"This was disabled by Squarespace.  Please contact Customer Care for more information."}}];
break;default:throw this.name+": Invalid status.";}this.set("fields",d)},_removeAccount:function(){var d=this.getField("removeAccount");(new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.ELEMENT,anchor:d.getNode(),showOverlay:!0,"strings.confirm":"Remove Account","strings.title":"Remove Account","strings.message":"Your account will be taken down immediately and no longer be accessible."})).on("confirm",function(){b.Data.post({url:"/api/billing/RemoveAccount",
data:{autorenew:!1},success:function(){window.location="/"}},this)},this)}},{CSS_PREFIX:"sqs-billing-settings-free",ATTRS:{buttons:{value:[]}}})},"1.0",{requires:["squarespace-settings-panel","squarespace-dialog-button","squarespace-dialog-description","squarespace-settings-billing-base","squarespace-widgets-confirmation"]});
YUI.add("squarespace-settings-site-facebook",function(b){var d=[{ctor:b.Squarespace.DialogFields.HTML,config:{hidden:!0,name:"upgrade-message",content:'<div class="settings-help">In order to connect a facebook page, you must upgrade your account to the <strong>Professional</strong> plan.</div>'}},{ctor:b.Squarespace.DialogFields.Button,hidden:!0,config:{name:"upgrade-button",hidden:!0,"strings.text":"Upgrade Account",onClick:function(){CONFIG_PANEL.getHistory().replace({module:"settings","settings-subpanelName":"billing-settings"})}}}],
c=[{ctor:b.Squarespace.DialogFields.Description,config:{text:'Squarespace allows you to specify a gallery and page on your site to embed within one of your Facebook Brand Pages.  Select a page and gallery you wish to connect below.  After connecting, Squarespace will ask you which of your pages within Facebook you wish to install these pages on. <a target="new" href="'+b.Squarespace.HelpLinks.FACEBOOK_PAGE+'">Click here for more help regarding Facebook Pages.</a> <br/><br/> If you have not yet setup a Facebook page for your brand, you can do so <a target="new" href="http://www.facebook.com/about/pages">here</a>.',
className:"damask-only"},$when:function(){return b.Squarespace.Utils.isDamaskEnabled()}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"facebookPageDescription",title:"Linked Facebook Page",className:"control",text:"Select which Facebook Brand Page to link with Squarespace.",padding:[0,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"facebookPageId",description:"&nbsp;<a href='http://www.facebook.com'>go to page</a>",className:"control thin",defaultValue:"0",options:[]}},{ctor:b.Squarespace.DialogFields.Description,
config:{name:"galleryDescription",className:"gallery-tab-description tabField",title:"Squarespace Gallery Tab",text:"Loading...",width:400,padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"facebookTabGalleryId",description:"&nbsp;",className:"tabField thin",width:200,options:{$valueFn:function(){var c=[];b.Squarespace.ContentCollectionCache.each(function(e){var d=e.getTemplateConfiguration();if(d){var k=d.get("collectionType"),d=d.get("ordering");k==b.Squarespace.CollectionTypes.GENERIC&&
d==b.Squarespace.CollectionOrdering.USER&&c.push({value:e.get("id"),label:e.get("navigationTitle")})}});return c}}}},{ctor:b.Squarespace.DialogFields.Text,config:{width:350,className:"thin",name:"tabGalleryCustomName","strings.placeholder":"Custom Tab Name"}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"installGallery","strings.text":"Install Gallery Tab",className:"normal-button installTabBtn tabField",waiting:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"pageDescription",
title:"Squarespace Page Tab",className:"gallery-tab-description tabField",text:"Loading...",width:400,padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"facebookTabPageId",description:"&nbsp;",className:"normal-button tabField thin",width:200,options:{$valueFn:function(){var c=[];b.Squarespace.ContentCollectionCache.each(function(e){var d=e.getTemplateConfiguration();if(d){var k=d.get("collectionType");d.get("ordering");k==b.Squarespace.CollectionTypes.PAGE&&c.push({value:e.get("id"),
label:e.get("navigationTitle")})}});return c}}}},{ctor:b.Squarespace.DialogFields.Text,config:{width:350,className:"thin",name:"tabPageCustomName","strings.placeholder":"Custom Tab Name"}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"installPage","strings.text":"Install Page Tab",className:"normal-button installTabBtn tabField",waiting:!0}}];b.namespace("Squarespace");b.Squarespace._AsyncTaskSynchronizer=Class.create({tasks:[],initialize:function(b,c){this.tasks=b;this.completionCallback=
c},markDone:function(b){this.tasks.forEach(function(c){c.name===b&&(c.done=!0)});var c=!0;this.tasks.forEach(function(b){!1===b.done&&(c=!1)});c&&this.completionFn()},completionFn:function(){this.completionCallback&&this.completionCallback()}});b.namespace("Squarespace.Settings.Site");var e=b.Squarespace.Settings.Site.Facebook=b.Base.create("facebookSettings",b.Squarespace.Widgets.SettingsPanel,[],{tabFields:"galleryDescription installGallery facebookTabGalleryId tabGalleryCustomName pageDescription installPage facebookTabPageId tabPageCustomName".split(" "),
galleryFields:["galleryDescription","installGallery","facebookTabGalleryId","tabGalleryCustomName"],controlFields:["facebookPageDescription","facebookPageId"],initializer:function(b){this._installedTabs={};this._pages=[];this.initFacebookApi()},_syncRenderedFields:function(){e.superclass._syncRenderedFields.call(this);this.hideAll();this.set("dataState",this.getProperty("DATA_STATES").LOADING);this.populateFacebookPagesManaged(b.bind(function(){this._bindFields();this.showFieldsByNames(this.controlFields)},
this));this.handleTabChange("facebookTabGalleryId");this.handleTabChange("facebookTabPageId")},hasUnsavedChanges:function(){return!1},hideAll:function(){this.hideFieldsByNames(this.controlFields);this.hideFieldsByNames(this.tabFields)},showFieldsByNames:function(c){c.forEach(b.bind(function(b){this.getField(b).temporaryShow()},this))},hideFieldsByNames:function(c){c.forEach(b.bind(function(b){this.getField(b).temporaryHide(!0)},this))},_bindFields:function(){this._bindFieldsFields()},_bindFieldsFields:function(){var b=
this.get("id");this.getField("facebookPageId").after(b+"|dataChange",this.handlePageChange,this);this.getField("facebookTabGalleryId").after(b+"|dataChange",function(){this.handleTabChange("facebookTabGalleryId");this._saveChanges()},this);this.getField("facebookTabPageId").after(b+"|dataChange",function(){this.handleTabChange("facebookTabPageId");this._saveChanges()},this)},facebookLoggedIn:function(c,e,d){this.set("dataState",this.getProperty("DATA_STATES").LOADING);this.get("contentBox");FB.getLoginStatus(b.bind(function(k){this.set("dataState",
this.getProperty("DATA_STATES").LOADED);"connected"===k.status?FB.api("/me/permissions",b.bind(function(b){b.data[0].manage_pages?e(d):c(d)},this)):c(d)},this))},handleTabChange:function(b){var c=this.getField(b);if("0"===c.get("data")||""===c.get("data"))c.set("strings.description","");else if(c.set("strings.description","<a class='clean'>view content</a>"),b=c.get("contentBox").one(".field-description"))b.detach("click"),b.on(this.get("id")+"|click",function(){CONFIG_PANEL.getHistory().replace({module:"content",
collectionId:c.get("data")})})},handlePageChange:function(c){var e=this.getField("facebookPageId"),d=c.prevVal,k=function(b){return function(){this.set("data",b,{revert:!0})}}(d),l=this.getCurrentPageId();b.Data.get({url:"/api/config/GetFacebookPageAvailability",data:{facebookPageId:l},success:function(p){"0"===e.get("data")||""===e.get("data")?e.set("strings.description",""):e.set("strings.description","<a target='_blank' class='clean' href='"+this.getPageUrl(l)+"'>view page</a>");p.availability.isAvailable?
this.hasAnyInstalledTabs()&&!c.rollback?(p=new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Uninstall All","strings.title":"Switch Page","strings.message":"If you change the Facebook Page linked to Squarespace, you will uninstall all tabs linked to the current page. Are you sure?"}),p.on("cancel",k,e),p.on("confirm",function(){this.uninstallAllTabsForPage(d);this._saveChanges()},this)):(this.refreshInstallButtonStates(this._pages),this._saveChanges()):(this.uninstallAllTabsForPage(e.get("data")),
this._saveChanges())}},this)},hasAnyInstalledTabs:function(){return this._installedTabs[Static.SQUARESPACE_CONTEXT.facebookApiKeys.galleryTabApiKey]||this._installedTabs[Static.SQUARESPACE_CONTEXT.facebookApiKeys.pageTabApiKey]},uninstallAllTabsForPage:function(c){for(var e=[Static.SQUARESPACE_CONTEXT.facebookApiKeys.galleryTabApiKey,Static.SQUARESPACE_CONTEXT.facebookApiKeys.pageTabApiKey],d=b.bind(function(e){this.uninstallTab(c,e,b.bind(function(){this.refreshInstallButtonStates(this._pages)},
this))},this),k=0;k<e.length;k++)this.getTabIdAndRun(e[k],c,d)},initFacebookApi:function(){b.one("#fb-root")||b.one(document.body).append(b.Node.create('<div id="fb-root"></div>'));FB.init({appId:Static.SQUARESPACE_CONTEXT.facebookApiKeys.squarespaceApiKey,channelUrl:"//facebook.dev.squarespace.net/channel.html",status:!0,cookie:!0})},showLoginPrompt:function(c){var e=this.get("id"),d=b.Node.create('<div class="body-block"><div class="auth-required-notice"><div class="settings-help">Squarespace allows you to specify a gallery and page on your site to embed within one of your Facebook pages. After connecting, Squarespace will ask you which of your pages within Facebook you wish to install these pages on.</div><div class="sign-in-prompt settings-help">To enable page management, you must authenticate with Facebook.</div><div class="connect-facebook"><a href=\'#\'>Connect to Facebook</a></div></div></div>'),
k=new b.Squarespace.ExternalAuthentication({authenticationType:"website"}),l=d.one(".connect-facebook");k.on(e+"|completed",function(){b.Data.get({url:"/api/auth/CheckAuthentication",secure:!0,success:function(b){window.location.reload()}},this)},this);l.on(e+"|click",function(c){c.halt();c.preventDefault();k.openPopupWindow(b.Squarespace.ExternalServiceProviders.FACEBOOK)});b.one(".main-container").setContent("");b.one(".main-container").append(d);c()},handleFacebookError:function(c){new b.Squarespace.Widgets.Alert({"strings.title":"Error Connecting to Facebook",
"strings.message":c})},populateFacebookPagesManaged:function(c){var e=this.getField("facebookPageId");b.Data.get({url:"/api/config/GetFacebookPagesManaged",failure:function(c){new b.Squarespace.Widgets.Alert({"strings.title":"Error Getting Managed Facebook Pages","strings.message":"We were unable to access your Facebook pages. Please verify your account information. If you have changed your password recently, please disconnect and reconnect your Facebook account in Squarespace."});this.set("dataState",
this.getProperty("DATA_STATES").LOAD_FAILED)},success:function(d){this.set("dataState",this.getProperty("DATA_STATES").LOADED);if(d.networkError)return this.handleFacebookError(d.networkError);var k={0:{access_token:0,title:"None"}};d.data.forEach(function(c){if("Application"!==c.category){var d=e.get("numeric")?c.id:c.id+"";k[d]={access_token:c.access_token,title:c.name,url:"http://www.facebook.com/"+d};b.Lang.isUndefined(c.writing_access_token)||(k[d].writing_access_token=c.writing_access_token)}});
this._pages=k;var l=[];b.Object.each(k,function(b,c){l.push({value:c,label:b.title})});e.setAttrs({data:this.get("data").facebookPageId,options:l});this.refreshInstallButtonStates(k,c);if(0===this._pages.length)(new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.CENTER,"strings.confirm":"Create","strings.title":"No Facebook Pages","strings.message":"You don't have any Facebook Pages yet. Would you like to create one on Facebook?"})).on("confirm",function(){window.open("http://www.facebook.com/pages/create.php")});
"0"===e.get("data")||""===e.get("data")?e.set("strings.description",""):e.set("strings.description","<a target='_blank' class='clean' href='"+this.getPageUrl(e.get("data"))+"'>view page</a>")}},this)},refreshInstallButtonStates:function(c,e){this.getCurrentPageId();var d=new b.Squarespace._AsyncTaskSynchronizer([{name:"installGallery",done:!1},{name:"installPage",done:!1}],e);this.showFieldsByNames(this.tabFields);var k=!1;b.Object.each(b.Squarespace.Singletons.Template.get("collectionConfigs"),function(c,
e){c.get("collectionType")==b.Squarespace.CollectionTypes.GENERIC&&c.get("ordering")==b.Squarespace.CollectionTypes.USER&&(k=!0)});k?this._refreshGalleryButtons(d):this.hideFieldsByNames(this.galleryFields);this._refreshPageButtons(d)},_refreshPageButtons:function(c){var e=Static.SQUARESPACE_CONTEXT.facebookApiKeys.pageTabApiKey,d=b.bind(function(){c.markDone("installPage");this.getField("installPage").set("waiting",!1)},this);this.refreshButtonState({buttonFieldName:"installPage",selectFieldName:"facebookTabPageId",
descriptionFieldName:"pageDescription",customNameFieldName:"tabPageCustomName"},"Page",e,d)},_refreshGalleryButtons:function(c){var e=Static.SQUARESPACE_CONTEXT.facebookApiKeys.galleryTabApiKey,d=b.bind(function(){c.markDone("installGallery");this.getField("installGallery").set("waiting",!1)},this);this.refreshButtonState({buttonFieldName:"installGallery",selectFieldName:"facebookTabGalleryId",descriptionFieldName:"galleryDescription",customNameFieldName:"tabGalleryCustomName"},"Gallery",e,d)},getCurrentPageId:function(){return this.getField("facebookPageId").get("data")},
refreshButtonState:function(c,e,d,k){var l=this.getField(c.buttonFieldName),p=this.getField(c.selectFieldName),q=this.getField(c.descriptionFieldName),r=this.getField(c.customNameFieldName);p.temporaryHide(!0);r.temporaryHide(!0);this.getCurrentPageId();var s=this.getAccessToken(this.getCurrentPageId()),t=this.getCurrentPageId();"0"===t?(this._installedTabs[d]=!1,this.hideFieldsByNames(this.tabFields),k&&k()):FB.api("/"+t+"/tabs/"+d,"get",{access_token:s},b.bind(function(s){k&&k();if(s.error)return this.handleFacebookError(s.error.message);
var v=0<s.data.length;this._installedTabs[d]=v;l.detach("click");r.detach("change");var w=this.get("id");if(v){var y=s.data[0].id;r.setValue(s.data[0].name);r.on(w+"|change",b.bind(function(){this.saveCustomName(y,r.getValue())},this));l.setOnClick(b.bind(function(){l.showWaiting();this.uninstallTab(t,y,b.bind(function(){l.hideWaiting();this.refreshButtonState(c,e,d)},this))},this));l.setText("Uninstall Tab");q.setText("You have installed a "+e+" tab on your Facebook Page.  Select the "+e+" on Squarespace you'd like to link to this tab below and give it a name.");
p.temporaryShow();r.temporaryShow()}else l.setText("Install Tab"),p.temporaryHide(!0),r.temporaryHide(!0),l.setOnClick(b.bind(function(){l.showWaiting();this.installTab(t,d,b.bind(function(){l.hideWaiting();this.refreshButtonState(c,e,d)},this))},this)),q.setText("Press the button to the right to add the "+e+" tab to your Facebook Page.")},this))},getTabIdAndRun:function(b,c,e){var d=this.getAccessToken(c);FB.api("/"+c+"/tabs/"+b,"get",{access_token:d},function(b){b.data&&0<b.data.length&&e(b.data[0].id)})},
uninstallTab:function(c,e,d){var k=this.getAccessToken(c);b.Lang.isUndefined(this._pages[c].writing_access_token)||(k=this._pages[c].writing_access_token);FB.api("/"+e+"?method=delete","delete",{method:"delete",access_token:k},function(b){!0===b?d():(console.log("Unknown Facebook error"),console.log(b))})},installTab:function(c,e,d){var k=this.getAccessToken(c);b.Lang.isUndefined(this._pages[c].writing_access_token)||(k=this._pages[c].writing_access_token);FB.api("/"+c+"/tabs/","post",{access_token:k,
app_id:e},function(b){!0===b?d():console.log("Unknown Installation Error!")})},getAccessToken:function(c){b.Lang.isValue(this._pages)?b.Object.hasKey(this._pages,c)||console.warn("Key does not exist."):console.warn("Pages does not exist.");return b.Object.getValue(this._pages,[c,"access_token"])||"0"},getPageUrl:function(c){return b.Object.getValue(this._pages,[c,"url"])||""},saveCustomName:function(c,e,d){var k=this._pages[this.getCurrentPageId()];token=b.Lang.isValue(k.writing_access_token)?k.writing_access_token:
k.access_token;FB.api("/"+c,"post",{access_token:token,custom_name:e},b.bind(function(b){!0===b&&(this._saveChanges(),d&&d())},this))}},{CSS_PREFIX:"sqs-facebook-settings",ATTRS:{initialDataUrl:{value:"/api/config/GetFacebookPageSettings"},initialDataPropertyName:{value:"settings"},saveUrl:{value:"/api/config/SaveFacebookPageSettings"},buttons:{value:[]},"strings.title":{value:"Facebook Page"},"strings.description":{value:'Squarespace allows you to specify a gallery and page on your site to embed within one of your Facebook Brand Pages.  Select a page and gallery you wish to connect below.  After connecting, Squarespace will ask you which of your pages within Facebook you wish to install these pages on. <a target="new" href="'+
b.Squarespace.HelpLinks.FACEBOOK_PAGE+'">Click here for more help regarding Facebook Pages.</a> <br/><br/> If you have not yet setup a Facebook page for your brand, you can do so <a target="new" href="http://www.facebook.com/about/pages">here</a>.'},fields:{valueFn:function(){return!Static.SQUARESPACE_CONTEXT.website.canConnectFacebookPage?d:c}}}})},"1.0",{requires:"anim json node squarespace-dialog-button squarespace-dialog-description squarespace-dialog-html squarespace-dialog-select squarespace-dombuilder squarespace-external-authentication squarespace-settings-panel squarespace-widgets-alert squarespace-widgets-confirmation thirdparty-facebook".split(" ")});
YUI.add("squarespace-dialog-file-audio",function(b){b.namespace("Squarespace.DialogFields");b.Squarespace.DialogFields.FileAudio=b.Base.create("fileAudio",b.Squarespace.DialogFields.FileRequiresProcessing,[],{},{CSS_PREFIX:"sqs-file-audio-processing",FILE_FILTER:{description:"Audio",extensions:"*.mp3;*.mp4;*.ogg;*.m4a"},PROCESSING_JOB:b.Squarespace.AudioProcessingJob,PROCESSING_COPY:"Processing and identifying",ATTRS:{contentType:{value:"audio"},contentLabel:{value:"an audio file"}}})},"1.0",{requires:["base",
"squarespace-dialog-file-requires-processing","squarespace-job-manager"]});
YUI.add("highlight-accentfold",function(b,d){var c=b.Text.AccentFold,e=b.Escape,f={},g=b.mix(b.Highlight,{allFold:function(d,k,l){var p=g._TEMPLATE,q=[],r=0,s,t;l=b.merge({escapeHTML:!1,replacer:function(b,c,e,f){if(c&&!/\s/.test(e))return b;b=e.length;q.push([d.substring(r,f),d.substr(f,b)]);r=f+b}},l||f);g.all(c.fold(d),c.fold(k),l);r<d.length&&q.push([d.substr(r)]);l=0;for(s=q.length;l<s;++l){k=e.html(q[l][0]);if(t=q[l][1])k+=p.replace(/\{s\}/g,e.html(t));q[l]=k}return q.join("")},startFold:function(b,
c){return g.allFold(b,c,{startsWith:!0})},wordsFold:function(b,d){var f=g._TEMPLATE;return g.words(b,c.fold(d),{mapper:function(b,d){return d.hasOwnProperty(c.fold(b))?f.replace(/\{s\}/g,e.html(b)):e.html(b)}})}})},"3.17.2",{requires:["highlight-base","text-accentfold"]});
YUI.add("squarespace-models-google-apps-customer",function(b){b.namespace("Squarespace.Models").GoogleAppsCustomer=b.Base.create("googleAppsCustomer",b.Model,[b.Squarespace.ModelSync.REST],{root:"/api/google-apps-customers"},{ATTRS:{id:{},domain:{},poneNumber:{},alternateEmail:{},postalAddress:{},existsInGoogle:{},ownedByOtherReseller:{}}})},"1.0",{requires:["base","model","squarespace-model-sync-rest"]});
YUI.add("gallery-dimensions",function(b){var d=null,c="marginLeft borderLeftWidth paddingLeft paddingRight borderRightWidth marginRight".split(" "),e="marginTop borderTopWidth paddingTop paddingBottom borderBottomWidth marginBottom".split(" ");b.Node.emToPx=function(c){d||(d=b.config.doc.createElement("div"),d.style.position="absolute",d.style.top="-10000px",d.style.left="-10000px",d.style.visibility="hidden",d.style.width="10em",d.style.height="10em",b.config.doc.body.appendChild(d));return(c||1)*
(d.offsetWidth/10)};b.Node.prototype.totalWidth=function(){return this._node.offsetWidth+this.parseDimensionStyle("marginLeft")+this.parseDimensionStyle("marginRight")};b.Node.prototype.totalHeight=function(){return this._node.offsetHeight+this.parseDimensionStyle("marginTop")+this.parseDimensionStyle("marginBottom")};b.Node.prototype.insideWidth=function(){return this._node.clientWidth-this.parseDimensionStyle("paddingLeft")-this.parseDimensionStyle("paddingRight")};b.Node.prototype.insideHeight=
function(){return this._node.clientHeight-this.parseDimensionStyle("paddingTop")-this.parseDimensionStyle("paddingBottom")};b.Node.prototype.horizMarginBorderPadding=function(){return b.Array.reduce(c,0,function(b,c){return b+this.parseDimensionStyle(c)},this)};b.Node.prototype.vertMarginBorderPadding=function(){return b.Array.reduce(e,0,function(b,c){return b+this.parseDimensionStyle(c)},this)};b.Node.prototype.parseDimensionStyle=function(c){c=this.getComputedStyle(c);if(!c||!/^[0-9]/.test(c))return 0;
var e=parseFloat(c,10);/em$/.test(c)&&(e*=b.Node.emToPx(1));return Math.round(e)}},"@VERSION@",{requires:["node-style","array-extras"]});
YUI.add("squarespace-block-map-editor",function(b){b.namespace("Squarespace.Block.Editor").Map=b.Base.create("block-map-editor",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(){this.after("editingChange",this._onMapEditingChange,this);this.afterHostEvent("markerChange",this._sendMarkerEvent,this)},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Map")},_sendMarkerEvent:function(){b.one(this.get("mapNode")).fire("marker-created")},
_onMapEditingChange:function(b){b.newVal?this._startEditing():this._stopEditing()},afterLayoutDrag:function(){this._host.fire("resized")},_startEditing:function(){var c=this.get("mapNode");if(!this.get("map")||!c.startEditing)b.one(c).once("maps-loaded",function(){c.startEditing()},this);else c.startEditing()},_stopEditing:function(){var b=this.get("mapNode");b.stopEditing&&b.stopEditing()}},{NS:"blockEditor",ATTRS:{resizable:{value:!0},resizeNode:{valueFn:function(){return this.get("host").get("boundingBox")}},
dialogEditorAnchorNode:{valueFn:function(){return b.one(this.get("host").get("mapNode"))}},map:{getter:function(b){return this.get("mapNode").__map}},mapNode:{valueFn:function(){return this.get("host").get("mapNode")}}}});b.namespace("Squarespace.Block.ModelEditorDialog").Map=b.Base.create("block-map-model-editor",b.Squarespace.ModelEditorDialog,[],{sanitizeDialogData:function(b){delete b.aspectRatio;this.get("model").get("aspectRatio")&&delete b.vSize;return b}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});
var d={width:275,name:"map-block-editor-dialog",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Map",icon:"/universal/images-v6/icons/icon-map-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Enter an address for this map and press the <strong>return key</strong> to drop a pin. You can also drag the viewport of the map by <strong>clicking and dragging</strong> while in editing mode.",padding:[0,
10]}},{ctor:b.Squarespace.DialogFields.Map,config:{anchorMap:!0,height:150,countHeight:!0,name:"location",title:"Location",titleStyle:"inline"}}]}]}},"1.0",{requires:"squarespace-block-editor-dialog squarespace-damask-context-globals squarespace-dialog-description squarespace-dialog-map squarespace-model-editor squarespace-util".split(" ")});
YUI.add("squarespace-widgets-newsletters-subscribers-list",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.NewslettersSubscribersList=b.Base.create("NewslettersSubscribersList",b.Squarespace.Widgets.ModelList,[b.Squarespace.Mixins.SelectedActionTray],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-content")},removeSelected:function(){var d=this.get("models"),c=this.get("selectedModels"),e=c.size(),e=b.Lang.sub("This will remove {numSubscribers} {subscriberString} from the list.",
{numSubscribers:e,subscriberString:"subscriber"+(1===e?"":"s")});(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Selected Subscribers","strings.message":e})).on("confirm",function(){d.remove(c,{silent:!0});c.each(function(b){b.destroy({remove:!0})});this._subscriberStateChangeCallback()},this)},_subscriberStateChangeCallback:function(){var b=this.get("models");this.get("selectedModels").size()===b.size()&&b.get("hasPreviousPage")?b.previousPage():b.currentPage()}},{CSS_PREFIX:"sqs-newsletters-subscribers-list",
ATTRS:{defaultChildType:{value:b.Squarespace.Widgets.NewslettersSubscriber}}})},"1.0",{requires:["base","squarespace-mixins-selected-action-tray","squarespace-widgets-newsletters-subscriber","squarespace-widgets-model-list","squarespace-widgets-confirmation"]});
YUI.add("squarespace-block-audio-editor",function(b){b.namespace("Squarespace.Block.Editor").Audio=b.Base.create("audio-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Audio")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Audio"}}});var d=b.namespace("Squarespace.Block.ModelEditorDialog").Audio=b.Base.create("blockAudioEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var c=
this.get("dialog");c.on("ready",function(){c.getField("file-location").setAttrs({optionClickCb:function(b){c.getField("file-location-frame").switchFrames(b)}});var d=c.getField("designStyle");b.Lang.isValue(d)&&(d.after("dataChange",function(b){this._toggleColorTheme(b.newVal)},this),this._toggleColorTheme(d.get("data")));this._externalFileFields=b.Array.map(["audioAssetExternalUrl","audioAssetLength","audioAssetMimeType"],function(b){return c.getField(b)});d=c.getField("file-location-frame");"external"!==
d.get("data")&&b.Array.each(this._externalFileFields,function(b){b.disable()});d.after("dataChange",function(c){var e="external"===c.newVal?"enable":"disable";b.Array.each(this._externalFileFields,function(b){b[e]()})},this)},this)},_toggleColorTheme:function(b){"minimal"===b?this.get("dialog").getField("colorTheme").show():this.get("dialog").getField("colorTheme").hide()},getDialogData:function(){var c=d.superclass.getDialogData.call(this),f="embedded",g=c.audioAssetExternalUrl;b.Lang.isString(g)&&
0<g.length&&(f="external");c["file-location"]=f;c["file-location-frame"]=f;b.Lang.isString(c.audioAssetId)&&0<c.audioAssetId.length&&(c.audioAsset=new b.Squarespace.Models.ContentItem({id:c.audioAssetId}));return c},sanitizeDialogData:function(b){delete b["file-location"];delete b["file-location-frame"];b.audioAsset?(b.audioAssetId=b.audioAsset.get("id"),delete b.audioAsset):b.audioAssetId="";return b}},{ATTRS:{dialogConfig:{valueFn:function(){return c}}}}),c={initialDataByReference:!0,name:"audio-block-configuration",
width:420,height:550,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],title:"Audio",tabs:[{tabTitle:"Embed",icon:"/universal/images-v6/icons/icon-audio-16-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"title",maxLength:100,className:"thin",strings:{title:"Track Title",description:"The title of this media to display on the player."}}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesAuthor",maxLength:100,
className:"thin",strings:{title:"Track Author",description:"The author of this media."}}},{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"file-location",className:"round icon20",ignoreChanges:!0,titleStyle:"top",options:[{icon:"importing",title:"Upload File",value:"embedded"},{icon:"gallery",title:"External File",value:"external"}]}},{ctor:b.Squarespace.DialogFields.MultiFrame,config:{name:"file-location-frame",width:352,height:170,frames:[{name:"embedded",fields:[{ctor:b.Squarespace.DialogFields.FileAudio,
config:{width:352,height:200,max:200,transientStore:!0,recordType:b.Squarespace.RecordType.AUDIO,contentLabel:"an audio track",maxSize:160,assetConstrainMethod:"contain",contentType:"audio",name:"audioAsset"}}]},{name:"external",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"audioAssetExternalUrl",width:352,maxlength:100,className:"thin",strings:{title:"URL",placeholder:"http://...",description:"The URL to your podcast file."}}},{ctor:b.Squarespace.DialogFields.Text,config:{width:199.2,
name:"audioAssetLength",className:"thin",maxlength:100,strings:{title:"Size (Bytes)",description:"The size (in bytes) of this audio file."}}},{ctor:b.Squarespace.DialogFields.Text,config:{width:132.8,name:"audioAssetMimeType",className:"thin",maxlength:100,strings:{title:"Mime Type",description:"The mime type of this audio file."}}}]}]}}]},{tabTitle:"Podcasting",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Squarespace provides support for iTunes podcasting attributes, which will be inserted automatically into your RSS feed when this is present.",
padding:[0,10]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesSubtitle",maxLength:300,strings:{title:"iTunes Subtitle",description:"A brief description of this episode."},className:"thin"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesSummary",maxLength:4E3,strings:{title:"iTunes Summary",description:"More detailed information about this episode shown when the 'i' information icon is clicked."},className:"thin"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesKeywords",
maxLength:100,strings:{title:"iTunes Search Keywords",description:"A comma delimited list of keywords describing this episode.  Not visible in the iTunes interface, but assists when this episode is searched for."},className:"thin"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesDuration",maxLength:20,strings:{title:"iTunes Episode Duration (hh:mm:ss)",description:"The duration of this episode."},className:"thin"}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"iTunesExplicit",strings:{title:"Explicit Content",
description:"This episode contains explicit content."}}}]},{tabTitle:"Design",scroll:!0,$when:b.Squarespace.Utils.isBetaFeatureEnabled,fields:[{ctor:b.Squarespace.DialogFields.Check,$when:b.Squarespace.Utils.isBetaFeatureEnabled,config:{name:"showDownload",strings:{title:"Show Download Link",description:"Allow the user to download a copy of this track."}}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"designStyle",className:"thin dark",options:[{value:"classic",label:"Classic"},{value:"minimal",
label:"Minimal"}],strings:{title:"Player Style"}}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"colorTheme",defaultValue:"light",className:"thin dark",options:[{value:"light",label:"Light"},{value:"dark",label:"Dark"}],strings:{title:"Player Color"}}}]}]}},"1.0",{requires:"base squarespace-audio-player squarespace-block-editor-dialog squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-description squarespace-dialog-file squarespace-dialog-file-audio squarespace-dialog-multi-option squarespace-dialog-multi-frame squarespace-dialog-text squarespace-models-content-item".split(" ")});
YUI.add("squarespace-dialog-content-stat-manager-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-content-stat-manager.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n      <li class="field-tag-list-item tag-cloud-item" tag="';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===p?f.apply(b):f);e+=q(f)+'" title="';(f=d.count)?f=f.call(b,{hash:{},data:c}):(f=b.count,f=typeof f===p?f.apply(b):f);e+=q(f)+'">\n        <span class="field-tag-name tag">';
(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===p?f.apply(b):f);return e+=q(f)+"</span>\n      </li>\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p="function",q=this.escapeExpression,r=this;b='  <div class="field-tag-title-box">\n    <div class="field-tag-title-text">';(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h=typeof h===p?h.apply(c):h);b+=q(h)+'</div>\n    <div class="field-tag-header">\n      <div class="field-tag-filter-box field-tag-inline">\n        <input class="field-input field-tag-inline field-tag-filter-input" type="text" spellcheck="false" placeholder="Filter">\n      </div>\n      <div class="field-tag-sort-box field-tag-inline">\n        <div class="field-tag-sort-text field-tag-inline"></div>\n        <div class="field-tag-sort-select field-tag-inline" style="position:relative">\n          <div class="field-tag-sort-inner">Weight</div>\n          <select class="select field-tag-inline">\n            <option value="A-Z">A-Z</option>\n            <option value="Activity">Activity</option>\n            <option value="Weight" selected="true">Weight</option>\n          </select>\n        </div>\n      </div>\n    </div>\n  </div>\n  \x3c!-- tag cloud --\x3e\n  ';
if((h=d["if"].call(c,c.data,{hash:{},inverse:r.program(4,function(b,c){var e,f;e='\n  <div class="field-tag-no-items field-tag-cloud">\n    This collection does not contain any ';(f=d.modePlural)?f=f.call(b,{hash:{},data:c}):(f=b.modePlural,f=typeof f===p?f.apply(b):f);return e+=q(f)+".\n  </div>\n  "},k),fn:r.program(1,function(b,c){var e,f;e="\n  <div class=\"field-tag-cloud\">\n    <ul class='field-tag-list'>\n    ";if((f=d.each.call(b,b.data,{hash:{},inverse:r.noop,fn:r.program(2,l,c),data:c}))||
0===f)e+=f;return e+"\n    </ul>\n  </div>\n  "},k),data:k}))||0===h)b+=h;b+='\n  \x3c!-- footer --\x3e\n  <div class="tag-cloud-footer-wrapper">\n    <div class="field-tag-footer">\n      <input type="text" ';if((h=d["if"].call(c,c.maxLength,{hash:{},inverse:r.noop,fn:r.program(6,function(b,c){var e,f;e='maxlength="';(f=d.maxLength)?f=f.call(b,{hash:{},data:c}):(f=b.maxLength,f=typeof f===p?f.apply(b):f);return e+=q(f)+'"'},k),data:k}))||0===h)b+=h;return b+' spellcheck="false" placeholder="New Name" class="field-input field-tag-input field-tag-inline">\n      <div class="button-block field-tag-inline button-rename">\n        <input class="button-title" type="button" value="Rename">\n      </div>\n      <div class="button-block field-tag-inline button-remove-sel" style="float:right">\n        <input type="button" value="Remove Selected">\n      </div>\n    </div>\n  </div>\n'})})();
b.Handlebars.registerPartial("dialog-content-stat-manager.html".replace("/","."),d.templates["dialog-content-stat-manager.html"])},"1.0",{requires:["handlebars-base"]});YUI.add("squarespace-hb-humanizedate-format",function(b){b.Handlebars.registerHelper("humanizedate-format",function(d,c){return b.Squarespace.DateUtils.humanizeDate(d)})},"1.0",{requires:["handlebars-base","squarespace-date-utils"]});
YUI.add("squarespace-dialog-labelled-value-table-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-labelled-value-table.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;return(b=d["with"].call(c,c.strings,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n\n  <div class="field-lhs top">\n    ';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,
f="function"===typeof f?f.apply(b):f);e+=l(f)+'\n  </div>\n  <div class="field-rhs">\n    <div class="field-description-wrapper">\n      <div class="field-description">\n        ';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f="function"===typeof f?f.apply(b):f);e+=l(f)+"\n      </div>\n    </div>\n\n    <table>\n      <thead>\n        <tr>\n          <th>\n            ";(f=d.valueLabel)?f=f.call(b,{hash:{},data:c}):(f=b.valueLabel,f="function"===typeof f?f.apply(b):f);e+=l(f)+
"\n          </th>\n          <th>\n            ";(f=d.labelLabel)?f=f.call(b,{hash:{},data:c}):(f=b.labelLabel,f="function"===typeof f?f.apply(b):f);e+=l(f)+'\n          </th>\n        </tr>\n      </thead>\n      <tbody class="table-body">\n        <tr class="empty-message"><td colspan="2">';(f=d.emptyMessage)?f=f.call(b,{hash:{},data:c}):(f=b.emptyMessage,f="function"===typeof f?f.apply(b):f);return e+=l(f)+'</td></tr>\n      </tbody> \n    </table>\n\n    <div class="add-row">\n      <img src="/universal/images-v6/standard/icon_add_11_light.png" />\n    </div>\n\n  </div>\n'},
k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("dialog-labelled-value-table.html".replace("/","."),d.templates["dialog-labelled-value-table.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-tagcloud",function(b){b.namespace("Squarespace.Block").Tagcloud=b.Base.create("block-tagcloud",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-tagcloud",ATTRS:{editor:{value:b.Squarespace.Block.Editor.Tagcloud},type:{value:b.Squarespace.BlockType.TAGCLOUD},defaultContentModel:{value:{linkTitle:"",linkTarget:"",newWindow:!1}}}})},"1.0",{requires:["squarespace-enum","squarespace-block-base-modelsync","squarespace-block-tagcloud-editor"]});
YUI.add("querystring-parse-simple",function(b,d){var c=b.namespace("QueryString");c.parse=function(b,d,g){g=g||"=";var h={},k=0;b=b.split(d||"&");d=b.length;for(var l;k<d;k++)l=b[k].split(g),0<l.length&&(h[c.unescape(l.shift())]=c.unescape(l.join(g)));return h};c.unescape=function(b){return decodeURIComponent(b.replace(/\+/g," "))}},"3.17.2",{requires:["yui-base"]});
YUI.add("squarespace-block-embed-editor",function(b){b.namespace("Squarespace.Block.Editor").Embed=b.Base.create("embed-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Embed")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Embed"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Embed=b.Base.create("blockEmbedEditor",b.Squarespace.ModelEditorDialog,[],{getDialogData:function(){return{embed:this.get("model").toJSON()}},
sanitizeDialogData:function(b){return b.embed}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:470,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Embed",icon:"/universal/images-v6/icons/icon-embed-16-light.png",scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.Oembed,name:"embed",config:{"strings.description":"<strong>Paste the URL</strong> of an item (Tweet, SoundCloud song, etc) you'd like to embed, and Squarespace will attempt to locate content at this URL and format it for your site."}}]}]}},
"1.0",{requires:["base","squarespace-block-editor-dialog","squarespace-damask-context-globals","squarespace-dialog-oembed","squarespace-model-editor"]});
YUI.add("squarespace-settings-tabbed-panel-tab",function(b){b.namespace("Squarespace.Widgets");var d=function(c){return b.Lang.isNumber(c)?c:b.Lang.isString(c)?Number(c.replace("px",""))||0:0},c=b.Squarespace.Widgets.PanelTab=b.Base.create("panelTab",b.Squarespace.Widgets.DataWidget,[b.WidgetParent],{initializer:function(b){this.publish("ready")},destructor:function(){this._destroyFlyouts();b.Array.each(this._renderedFields,function(b){b.destroy()},this)},bindUI:function(){c.superclass.bindUI.call(this);
this.onceAfter("visibleChange",this._sizeVerticalSpan,this);this.on("*:dataChange",b.Squarespace.debounce(b.bind(function(b){b.target!==this&&this._updateData()},this),50),this)},renderUI:function(){c.superclass.renderUI.call(this);this._renderFields()},syncUI:function(){c.superclass.syncUI.call(this)},setEdited:function(){this._updateData()},_updateData:function(b){this.set("data",this.getData())},_renderFields:function(){var c=this.get("fields");b.Array.each(c,this._initField,this)},_sizeVerticalSpan:function(){var c=
this.get("fields");if(c=b.Array.find(c,function(b){return b.verticalSpan},this)){var c=this.getField(c.name),f=this.get("boundingBox").get("offsetHeight");if(c){this.each(function(b){b=b.get("boundingBox");f-=d(b.getStyle("marginTop").replace("px",""));f-=b.get("offsetHeight")||0},this);var g=c.get("boundingBox"),g=g.get("offsetHeight")-d(g.getStyle("marginTop"))-d(g.getStyle("marginBottom"));c.set("height",f+g)}}this.fire("ready")},mapDfOneToDfFun:function(c){var d=c.split("-").map(function(b){return b.capitalize()}).join(""),
d=b.Object.getValue(b.Squarespace.DialogFields,d);if(b.Lang.isValue(d))return d;console.log("Could not map old type: ["+c+"] to DF2");return null},_initField:function(c){var d,g=this.get("data"),h=c.name||c.config.name,k=b.clone(c),l=b.clone(c.config);b.Lang.isValue(c.ctor)?d=c.ctor:b.Lang.isString(c.type)&&(d=this.mapDfOneToDfFun(c.type),l=k);b.Lang.isValue(d)?(delete k.ctor,delete k.config,c=b.merge(k,l),c.panel=this,c.childType=d,b.Lang.isValue(g[h])&&(c.data=g[h]),this.add(c)):console.warn("[_initField] Could not find a constructor")},
_destroyFlyouts:function(){b.Lang.isValue(this._activeFlyoutHandler)&&this._activeFlyoutHandler.detach();b.Lang.isValue(this._activeFlyout)&&(this._activeFlyout.closeFlyout(),this._activeFlyout=null)},setActiveFlyout:function(c){this._destroyFlyouts();b.Lang.isValue(c.field)&&b.later(0,this,function(){this._activeFlyout=c.field;this._activeFlyoutHandler=this.get("boundingBox").once("click",function(b){b.target.ancestor(c.constraintClasses,!0)||this._destroyFlyouts()},this)})},toggleView:function(b){b?
this.show():this.hide()},_toggleChildView:function(b){this.each(function(c){b?c.show():c.hide()},this)},show:function(){this.set("visible",!0);this._toggleChildView(!0)},hide:function(){this._destroyFlyouts();this.set("visible",!1);this._toggleChildView(!1)},_checkErrors:function(){var c=this._items,d=b.Squarespace.FormUtils.validate(c);0<b.Object.keys(d).length&&b.Squarespace.FormUtils.showErrors(c,d);return d},getField:function(b){var c;this.some(function(d,h){c=d;return b===d.get("name")},this);
return c||null},getData:function(){var c={};this.each(function(d,g){var h=d.get("name");b.Lang.isString(h)&&(c[h]=d.get("data"))},this);return c},getErrors:function(){var b={};this.each(function(c,d){c.get("required")&&c.isEmpty()&&(b[c.getName()]="This is a required field")},this);return b}},{CSS_PREFIX:"sqs-settings-panel-tab",ATTRS:{fields:{value:[],setter:function(c){function d(c){b.Object.hasKey(c,"fields")&&("splitter"===c.type||"stack"===c.type)?d(c.fields):b.Lang.isArray(c)?b.Array.each(c,
d,this):g.push(c)}var g=[];d(c);return g}},data:{value:null},visible:{value:!1},"strings.title":{value:"Item"},tabName:{value:null}}})},"1.0",{requires:"base-build squarespace-debounce squarespace-dialog squarespace-form-utils squarespace-mixin-save-changes squarespace-ss-widget squarespace-tray widget-anim".split(" ")});
YUI.add("squarespace-widgets-model-list-header",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.ModelListHeader=b.Base.create("ModelListHeader",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this.get("models").after("load",this._updateControlsVisibility,this)},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._renderInlineSelect();this._tabDescriptionNode=b.one(".tab-description");this._syncCurrentTab()},bindUI:function(){d.superclass.bindUI.call(this);
this._tabSelect&&this._tabSelect.after("dataChange",function(b){this._set("currentTab",this._getTabByName(b.newVal))},this);this.get("contentBox").delegate("click",this._onActionButtonClick,".action-button",this);this.after("currentTabChange",this._syncCurrentTab,this)},_renderInlineSelect:function(){var c=this.get("tabs");1!==c.length&&(this._tabSelect=new b.Squarespace.Widgets.InlineSelect({render:this.get("contentBox").one(".tab-select-container"),options:b.Array.map(c,function(b){return{label:b.title,
value:b.name}})}))},_syncCurrentTab:function(){var b=this.get("currentTab"),e=b.name;this._tabSelect&&this._tabSelect.set("data",e);this._tabDescriptionNode.setHTML(b.description)},_onTabSelectorClick:function(b){b=b.target.getAttribute("data-name");this.get("currentTab").name!==b&&this._set("currentTab",this._getTabByName(b))},_onActionButtonClick:function(b){b=b.target.getAttribute("data-name");this._getActionButtonByName(b).action.call()},_getTabByName:function(c){return b.Array.filter(this.get("tabs"),
function(b){return b.name===c},this)[0]},_getActionButtonByName:function(c){return b.Array.filter(this.get("actionButtons"),function(b){return b.name===c},this)[0]},_updateControlsVisibility:function(){},_getHBTemplateContext:function(){var b=d.superclass._getHBTemplateContext.call(this);b.isSingleTab=1===b.tabs.length;b.hasActionButtons=0<b.actionButtons.length;return b}},{CSS_PREFIX:"sqs-model-list-header",HANDLEBARS_TEMPLATE:"widgets-model-list-header.html",ATTRS:{models:{valueFn:function(){return new b.Squarespace.Models.ModelList},
validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ModelList),writeOnce:"initOnly"},tabs:{value:[{name:"first",title:"First Tab",description:""}],validator:function(c){return!b.Lang.isArray(c)||0===c.length?(console.error('ModelListHeader: Invalid "tabs" attribute. Must be a non-empty array.'),!1):!0},writeOnce:"initOnly"},currentTab:{valueFn:function(){return this.get("tabs")[0]},validator:b.Squarespace.AttrValidators.isObject,readOnly:!0},actionButtons:{value:[],validator:b.Squarespace.AttrValidators.isArray,
writeOnce:"initOnly"},strings:{value:{title:"Models"},validator:function(c){return!b.Lang.isObject(c)?(console.error('ModelListHeader: Invalid "strings" attribute. Must be an object.'),!1):!b.Object.hasKey(c,"title")?(console.error('ModelListHeader: Invalid "strings" attribute. Must have key "title".'),!1):!0},writeOnce:"initOnly"}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-models-model-list squarespace-ss-widget squarespace-widgets-inline-select squarespace-widgets-model-list-header-template".split(" ")});
YUI.add("squarespace-widgets-newsletter-message-editor-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-newsletter-message-editor.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="newsletters-edit-toolbar">\n    <div class="leftbutton savedraft">\n        <span class="savedraftlabel">Save Draft</span>\n        </div>\n    <div class="leftbutton deletedraft hidden">\n        <span class="deletelabel">Delete</span>\n        </div>\n    <div class="rightbutton sendtest">\n        <span class="testlabel">';
(h=d.testLabel)?h=h.call(c,{hash:{},data:k}):(h=c.testLabel,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</span>\n    </div>\n</div>\n\n<div class="newsletters-edit-main">\n    <div class="center">\n        <div class="header toline">\n            <div class="label tolabel">\n                <span class="tolabelspan">To:</span>\n            </div>\n            <div class="field tofield">All Subscribers</div>\n        </div>\n        <div class="header subjectline">\n            <div class="label subjectlabel">\n                <span class="subjectlabelspan">Subject:</span>\n            </div>\n            <div class="field subjectfield"><input type="text" class="subjectInput" placeholder="Enter your subject" spellcheck="true" value="';
(h=d.emailSubject)?h=h.call(c,{hash:{},data:k}):(h=c.emailSubject,h="function"===typeof h?h.apply(c):h);return b+=l(h)+'" /></div>\n        </div>\n        <div class="emailContentContainer">\n            <div class="headerContainer">\n                <div class="sqs-layout sqs-locked-layout" data-type="newsletter"></div>\n            </div>\n            <div class="bodycontainer">\n                <div class="sqs-layout" data-type="newsletter"></div>\n            </div>\n            <div class="footerContainer">\n                <div class="sqs-layout sqs-locked-layout" data-type="newsletter"></div>\n            </div>\n        </div>\n        <div class="recipientSuggestions hidden"></div>\n    </div>\n</div>\n'})})();
b.Handlebars.registerPartial("widgets-newsletter-message-editor.html".replace("/","."),d.templates["widgets-newsletter-message-editor.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-inventory-product",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.InventoryProduct=b.Base.create("InventoryProduct",b.Squarespace.Widgets.Model,[b.Squarespace.Mixins.EditableModel],{bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",function(){this.get("model").load(b.bind(function(){this._edit()},this))},this)},_getHBTemplateContext:function(){var b=d.superclass._getHBTemplateContext.call(this),e=b.model,f=e.items;
b.imageSrc=0<f.length?f[0].assetUrl:e.assetUrl;b.notListed=!this._isListed();b.soldOut=!this._hasStock();b.missingDigitalAsset=!this._hasNecessaryDigitalAsset();b.unsaved=e.unsaved;b.variantNames=this._getVariantNames();b.variantPrices=this._getVariantPrices();b.variantStocks=this._getVariantStocks();return b},_isListed:function(){return this.get("model").get("workflowState")===b.Squarespace.WorkflowStates.PUBLISHED},_hasStock:function(){var c=this.get("model").get("structuredContent");if(c.get("productType")===
b.Squarespace.ProductTypes.DIGITAL)return!0;var e=0;b.Array.some(c.get("variants"),function(b){if(b.unlimited)return e=-1,!0;e+=b.qtyInStock});return 0!==e},_hasNecessaryDigitalAsset:function(){var c=this.get("model");if(c.get("structuredContent").get("productType")!==b.Squarespace.ProductTypes.DIGITAL)return!0;c=c.get("digitalGoods");return b.Lang.isValue(c)&&0!==c.length},_getVariantNames:function(){var c;c=this.get("model").get("structuredContent");c.get("productType")===b.Squarespace.ProductTypes.DIGITAL?
c=["Digital Download"]:(c=c.get("variants")||[{}],c=b.Array.map(c,function(c){c=b.Squarespace.Commerce.variantFormat(c);return""===c?"Unique":c}));return c},_getVariantPrices:function(){var c,e=this.get("model");c=e.get("structuredContent");if(c.get("productType")===b.Squarespace.ProductTypes.DIGITAL){var e=c.get("priceCents"),d=c.get("salePriceCents");c=[{onSale:c.get("onSale"),price:e,salePrice:d}]}else c=c.get("variants")||[{}],e=e.toJSON(),b.Squarespace.Commerce.variedPrices(e),b.Squarespace.Commerce.variedPrices(e)?
c=b.Array.map(c,function(b){return{onSale:b.onSale,price:b.price,salePrice:b.salePrice}}):(c=c[0],c=[{onSale:c.onSale,price:c.price,salePrice:c.salePrice}]);return c},_getVariantStocks:function(){var c;c=this.get("model").get("structuredContent");c.get("productType")===b.Squarespace.ProductTypes.DIGITAL?c=["\u221e"]:(c=c.get("variants")||[{}],c=b.Array.map(c,function(b){return b.unlimited?"\u221e":b.qtyInStock}));return c}},{CSS_PREFIX:"sqs-inventory-product",HANDLEBARS_TEMPLATE:"widgets-inventory-product.html",
ATTRS:{editorCtor:{valueFn:function(){var c=this.get("model");return b.Squarespace.ContentItemEditorFactory.getEditor(c)}}}})},"1.0",{requires:"base squarespace-content-item-types-editor squarespace-commerce-utils squarespace-enum squarespace-hb-money-string squarespace-mixins-editable-model squarespace-widgets-inventory-product-template squarespace-widgets-model".split(" ")});
YUI.add("squarespace-models-recovery-buffer",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.RecoveryBuffer=b.Base.create("RecoveryBuffer",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.API_ROOT+"recovery-buffers",parse:function(b){b=d.superclass.parse.call(this,b);delete b.editableBlock;return b}},{ATTRS:{id:{value:null},type:{value:b.Squarespace.RecoveryBufferType.PAGE_COLLECTION_DATA,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.RecoveryBufferType),
writeOnce:"initOnly"},sourceId:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString,writeOnce:"initOnly"},fieldName:{value:"",validator:b.Squarespace.AttrValidators.isString,writeOnce:"initOnly"},editableBlock:{value:null,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.EditableContentBlock)},contentToDelete:{value:{},validator:b.Squarespace.AttrValidators.isNonArrayObject}}})},"1.0",{requires:"base model squarespace-attr-validators squarespace-enum squarespace-model-sync-rest squarespace-models-layout".split(" ")});
YUI.add("squarespace-settings-site-billing-subscribed-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-site-billing-subscribed.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n    <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===r?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n    "}function p(b,c){return'\n\n          <div class="auto-renew-off-row">\n            <div class="re-enable-auto-renewal-wrapper">\n              <div data-field-name="re-enable-autorun-description"></div>\n              <div data-field-name="reactivateAccount"></div>\n            </div>\n\n            <div class="remove-website-wrapper">\n              <div data-field-name="remove-website-description"></div>\n              <div data-field-name="turnOffWebsiteButton"></div>\n            </div>\n          </div>\n\n        '}
function q(b,c){return'\n          <div class="plan-actions-row">\n            <div class="plan-level-wrapper">\n              <div data-field-name="plan-description"></div>\n              <div data-field-name="planId"></div>\n            </div>\n\n            <div class="period-wrapper">\n              <div data-field-name="billing-period-description"></div>\n              <div data-field-name="billingPeriod"></div>\n            </div>\n\n            <div class="disable-autorenewal-wrapper">\n              <div data-field-name="disable-autorenewal-description"></div>\n              <div data-field-name="cancelAccount"></div>\n            </div>\n\n          </div>\n\n          <div data-field-name="creditCardInformationDescription"></div>\n          <div data-field-name="nameOnCard"></div>\n\n          <div class="credit-card-row">\n            <div class="ccNumber-wrapper" data-field-name="ccNumber"></div>\n            <div class="cvv-wrapper" data-field-name="cvv"></div>\n            <div class="expirationMonth-wrapper" data-field-name="expirationMonth"></div>\n            <div class="expirationYear-wrapper" data-field-name="expirationYear"></div>\n          </div>\n\n          <div class="credit-card-address-row">\n            <div class="country-wrapper" data-field-name="country"></div>\n            <div class="zipcode-wrapper" data-field-name="zipCode"></div>\n          </div>\n\n          <div data-field-name="updatePaymentInformationButton"></div>\n        '}
this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var r="function",s=this;b='<div class="billing-subscribed-panel">\n  ';if((h=d["with"].call(c,c.strings,{hash:{},inverse:s.noop,fn:s.program(1,function(b,c){var e,f;e="\n    ";if((f=d["if"].call(b,b.description,{hash:{},inverse:s.noop,fn:s.program(2,l,c),data:c}))||0===f)e+=f;e+='\n    <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===r?f.apply(b):f);if(f||0===f)e+=f;
return e+"</div>\n  "},k),data:k}))||0===h)b+=h;b+='\n\n  <div class="settings-panel-fields">\n\n    <div class="payment-information-tab-wrapper">\n      ';if((h=d["if"].call(c,c.expired,{hash:{},inverse:s.noop,fn:s.program(4,function(b,c){return'\n        <div class="expired-wrapper">\n          <div data-field-name="expired-reactivate-description"></div>\n          <div data-field-name="reactivateAccount"></div>\n\n          <div data-field-name="linkv5-description"></div>\n          <div data-field-name="linkv5"></div>\n        </div>\n\n      '},
k),data:k}))||0===h)b+=h;b+="\n\n      ";if((h=d.unless.call(c,c.expired,{hash:{},inverse:s.noop,fn:s.program(6,function(b,c){var e,f;e='\n\n        <div data-field-name="plan"></div>\n\n        ';if((f=d["if"].call(b,b.autoRenewOff,{hash:{},inverse:s.noop,fn:s.program(7,p,c),data:c}))||0===f)e+=f;e+="\n\n        ";if((f=d.unless.call(b,b.autoRenewOff,{hash:{},inverse:s.noop,fn:s.program(9,q,c),data:c}))||0===f)e+=f;return e+"\n\n      "},k),data:k}))||0===h)b+=h;return b+'\n    </div>\n  </div>\n\n  <div class="invoices-tab-wrapper">\n    <div data-field-name="invoiceList"></div>\n  </div>\n</div>\n'})})();
b.Handlebars.registerPartial("settings-site-billing-subscribed.html".replace("/","."),d.templates["settings-site-billing-subscribed.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-content-item-grid",function(b){b.namespace("Squarespace");var d=b.Squarespace.ContentItemGrid=b.Base.create("ContentItemGrid",b.Squarespace.Widgets.SSWidget,[b.WidgetParent,b.WidgetChild,b.Squarespace.Mixins.ContentCollectionBulkActionable,b.Squarespace.Mixins.AddContentItemHandlerMixin],{initializer:function(){if(!this.get("model"))throw'ContentItemGrid: Missing attribute "model".';this.publish("itemSaved",{emitFacade:!0,bubbles:!0})},destructor:function(){this.get("model").items.detach(this.get("id")+
"|*");this._ddDelegate.destroy();this._ddReorder.destroy();this._ddGrouping.destroy();this._dragSelection.destroy();this._resizeEmitter&&this._resizeEmitter.destroy();this._uploader&&this._uploader.destroy()},renderUI:function(){d.superclass.renderUI.call(this);if(this.get("loadByViewport")){var c=this.get("contentBox").ancestor(function(b){return b.getComputedStyle("overflowY").match(/scroll|auto/)});if(!c||c.test("html,body"))c=b.one(b.config.win);this._scrollEl=c}},bindUI:function(){d.superclass.bindUI.call(this);
var c=this.get("contentBox"),e=this.get("id"),f=this.get("model").items;this._setupDragBehaviors();this.on("*:aviary-start",function(){this.set("dragSelectionEnabled",!1);this.set("keyBindingsEnabled",!1);this.deselectAll()},this);this.on("*:aviary-finish",function(){this.set("dragSelectionEnabled",!0);this.set("keyBindingsEnabled",!0)},this);this.on("*:remove",function(c){this.removeItems(new b.ArrayList(c.target))},this);this._resizeEmitter=new b.Squarespace.ResizeEmitter;this._resizeEmitter.on("resize",
this._refreshStylesheet,this);this.after(["minMarginChange","imageSizeChange"],function(){this._refreshStylesheet();this._refreshImages()},this);this._ddDelegate.dd.on("drag:mouseDown",function(c){var e=b.Widget.getByNode(c.ev.target);null!==e&&(e.get("contentBox").one("img")&&!c.ev.target.ancestor(".inside",!0))&&c.halt()});this._ddReorder.on("reordered",this._onSingleReorder,this);this._ddGrouping.on("group-reordered",this._onGroupReorder,this);this.on("dragSelectionEnabledChange",function(b){this._dragSelection.set("enabled",
b.newVal)},this);this._dragSelection.on([this.get("id")+"|selection-complete",this.get("id")+"|selection-dragged"],function(b){this._updateSelectedWidgets(b.region)},this);b.on(e+"|keydown",this._onKeydown,b.config.doc,this);if(this.get("showActionTray"))this.on("selectionChange",function(b){b.stopImmediatePropagation();this.updateActionTray()},this);this.get("showAddIcon")&&this.get("boundingBox").delegate("click",this.handleAddContentRequest,".add-item",this);c.delegate("click",function(b){this._uploader||
this.handleAddContentRequest()},".empty-state",this);this.after(["addChild","removeChild"],function(){this._checkEmptyState();this._refreshStylesheet()},this);this._registerEvent(f.after(e+"|add",function(b){!b.onReorder&&!b.onUpload&&(this._addItemWidget(b.model),this.get("loadByViewport")&&this._loadItemImagesInViewport())},this));this._registerEvent(f.after(e+"|remove",function(b){b.onReorder||this._removeItemWidget(b.model)},this));this.get("loadByViewport")&&(this._scrollEl.on("scroll",this._loadItemImagesInViewport,
this),this._resizeEmitter.on("resize:end",this._loadItemImagesInViewport,this))},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("contentBox");this._clearElements();this._widgetMap={};var e=this.get("model"),f=e.items;this._stylesheet||(this._stylesheet=b.Node.create('<style type="text/css"></style>'));this.get("boundingBox").appendChild(this._stylesheet);(e=e.get("typeName"))&&c.addClass("collection-type-"+e);var e=this.get("collectionConfiguration").get("acceptTypes"),g=!1,h=b.Squarespace.Singletons.Template.get("customTypes"),
k=b.Object.keys(h);b.Array.each(e,function(b){var c=-1!==k.indexOf(b)&&"image"==h[b].get("base");if("image"==b||c)g=!0});g&&(this._uploader=this._createUploader(),this._uploader.render(c));f.each(function(b,c){this._addItemWidget(b)},this);this._ddDelegate.syncTargets();this._checkEmptyState();this._refreshStylesheet();this.get("showAddIcon")&&(this._addIconEl||(this._addIconEl=b.Node.create('<button class="add-item" tabindex="-1"></button>')),this.get("boundingBox").append(this._addIconEl));this.get("loadByViewport")&&
this._loadItemImagesInViewport()},removeItems:function(c){var e=this.get("model"),d=b.bind(function(){var b=[];c.each(function(c){c.get("item").get("id")&&(b.push(c.get("item")),c.remove())},this);0<b.length&&e.items.removeItems(b)},this);if(c.size()===e.items.size())d();else{for(var g=c.item(0).get("boundingBox"),h=[];b.Widget.getByNode(g);){if(!b.instanceOf(b.Widget.getByNode(g),b.Squarespace.Widgets.ActionTray)){var k=g.plug(b.Squarespace.PositionAnimator).positionAnimator;k.hold();h.push(k)}g=
g.next()}d();b.Array.each(h,function(b){b.release()})}},enableDragSelection:function(){var b=this._dragSelection;b&&b.set("enabled",!0)},disableDragSelection:function(){var b=this._dragSelection;b&&b.set("enabled",!1)},_createNewContentItemAndShowEditor:function(c,e){var d=this.get("itemEditorOptions");if(c.recordType==b.Squarespace.RecordType.IMAGE&&d.variant==b.Squarespace.ContentItemEditorVariants.MINIMAL&&b.Lang.isValue(this._uploader))this._uploader.openFileSelectDialog(),e();else{var g=this.get("model"),
h=new b.Squarespace.Models.ContentItem(b.merge(c,{displayIndex:g.get("nextDisplayIndex")}));b.instanceOf(this.get("model"),b.Squarespace.Models.ContentCollection)?h.set("collectionId",g.get("id")):(h.set("collectionId",g.get("collectionId")),h.set("parentId",g.get("id")));var k=new (b.Squarespace.ContentItemEditorFactory.getEditor(h,this.get("itemEditorOptions")))({model:h}),l=h.on("save",function(c){this.fire("itemSaved");b.Object.getValue(c,["options","headers","X-AutoSave"])||g.items.add(h)},this);
k.on("visibleChange",function(b){b.newVal||l.detach()});(d=this.get("itemEditorOptions.defaultWorkflowState"))&&h.set("workflowState",d);k.on("visibleChange",function(b){b.newVal?(this.set("dragSelectionEnabled",!1),this.set("keyBindingsEnabled",!1)):(this.set("dragSelectionEnabled",!0),this.set("keyBindingsEnabled",!0))},this);b.instanceOf(this.get("model"),b.Squarespace.Models.ContentCollection)&&g.isNew()?(this._registerEvent(g.on("save",function(){h.set("collectionId",g.get("id"));e();k.show()})),
g.save()):(e(),k.show())}},_addItemWidget:function(c){var e=new b.Squarespace.ContentItemImage(b.merge(this.get("contentItemImageOptions"),{item:c,parentModel:this.get("model"),itemEditorOptions:this.get("itemEditorOptions"),preventLoad:this.get("loadByViewport")}));b.Do.before(function(){this.set("dragSelectionEnabled",!1);this.set("keyBindingsEnabled",!1);this.deselectAll()},e,"editItem",this);b.Do.after(function(){b.Do.currentRetVal.on("visibleChange",function(b){b.newVal||(this.set("dragSelectionEnabled",
!0),this.set("keyBindingsEnabled",!0))},this)},e,"editItem",this);this._widgetMap[c.get("clientId")]=e;this.add(e);return e},_removeItemWidget:function(b){b=b.get("clientId");var e=this._widgetMap[b];e&&(e.remove(),delete this._widgetMap[b])},_loadItemImagesInViewport:function(){var b=this._scrollEl,e=b.get("scrollTop"),d=e+b.get("region").height,g=[];this.each(function(b){var c=b.get("boundingBox").get("region"),l=c.top,c=c.bottom;if(l>=e&&l<=d||c>=e&&c<=d)g.push(b),b.set("preventLoad",!1)},this)},
_updateSelectedWidgets:function(c){this.each(function(e){if(b.instanceOf(e,b.Squarespace.ContentItemImage)){var d=e.get("contentBox").one("img");d?e.set("selected",d.intersect(c).inRegion?1:0):e.set("selected",e.get("contentBox").intersect(c).inRegion?1:0)}})},_insertChildBeforeUploader:function(b){this._uploader&&b.after("render",function(){this._uploader.get("boundingBox").insert(b.get("boundingBox"),"before")},this)},_createUploader:function(){var c=new b.Squarespace.Uploader({dragAndDropArea:this.get("boundingBox"),
multipleFiles:!0,autoUpload:!0,fileFilters:[{description:"Images",extensions:"*.jpg;*.jpeg;*.png;*.gif"}],processFile:b.bind(this._uploadImageProcessor,this),addPlaceholder:b.bind(this._addImagePlaceholder,this),fileComplete:b.bind(this._imageUploadComplete,this),createJob:b.bind(this._createImageProcessingJob,this),selectButtonLabel:this.get("strings.uploadText"),preflight:this.get("uploadPreflight")});this.on("uploadPreflightChange",function(b){c.get("destroyed")||c.set("preflight",b.newVal)});
c.after(this.get("id")+"|uploaderror",function(e){e=e.fileData||c.fileDataFromFile(e.file);e.placeholder.setContent(c.makeDefaultErrorBlock(e));b.Widget.getByNode(e.placeholder).get("item").set("mediaProcessingState",b.Squarespace.MediaProcessingState.ERROR)});return c},_checkEmptyState:function(){this.isEmpty()?(this.set("dragSelectionEnabled",!1),this._renderEmptyState()):(this.set("dragSelectionEnabled",!0),this._removeEmptyState())},_renderEmptyState:function(){var c=this.get("contentBox");c.addClass("empty");
if(this.get("showEmptyState")){c.addClass("show-empty-state");var e=this.get("strings.emptyTitle"),d=this.get("strings.emptyDesc");this._uploader?this._uploader.set("selectButtonLabel",'<div class="title">'+e+'</div><div class="desc">'+d+"</div>"):(this._emptyStateEl||(this._emptyStateEl=b.Node.create('<div class="empty-state"><div class="icon"></div><div class="text"><div class="title">'+e+'</div><div class="desc">'+d+"</div></div></div>")),c.append(this._emptyStateEl))}},_removeEmptyState:function(){var b=
this.get("contentBox");this.get("showEmptyState")&&(b.removeClass("show-empty-state"),this._uploader?this._uploader.set("selectButtonLabel",this.get("strings.uploadText")):this._emptyStateEl&&this._emptyStateEl.inDoc()&&this._emptyStateEl.remove());this.get("contentBox").removeClass("empty")},_refreshStylesheet:function(){this.size();var c=this.get("boundingBox"),e=c.get("offsetWidth"),d="";if(this.isEmpty())d+=" #"+c.get("id")+".sqs-content-item-grid .sqs-uploader { min-width: 100%; width: 100%; height: 100%; }",
d+=" #"+c.get("id")+".sqs-content-item-grid .sqs-uploader-content { width: 100%; height: 100%; margin: 0 auto; padding: 0; } ";else var g=this.get("imageSize"),h=this.get("minMargin"),e=Math.floor(e/(g+2*h)),k="."+b.Squarespace.ContentItemImage.CSS_PREFIX,d=d+(" #"+c.get("id")+".sqs-content-item-grid "+k+", .sqs-content-item-grid .sqs-uploader { min-width: "+g+"px; width: "+100/e+"%; }"),d=d+(" #"+c.get("id")+".sqs-content-item-grid .sqs-uploader { height: "+(g+2*h)+"px; }"),d=d+(" #"+c.get("id")+
".sqs-content-item-grid "+k+"-content { width: "+g+"px; height: "+g+"px; margin: 0 auto; padding: "+h+"px 0; }"),d=d+(" #"+c.get("id")+".sqs-content-item-grid "+k+"-content .inside { width: "+g+"px; height: "+g+"px; }"),d=d+(" #"+c.get("id")+" "+k+":nth-child("+e+"n) { margin-right: 0; }"),d=d+(" #"+c.get("id")+".sqs-content-item-grid .sqs-uploader-content { width: "+g+"px; height: "+g+"px; margin: 0 auto; padding: "+h+"px 0; } ");this._stylesheet.set("innerHTML",d)},_refreshImages:function(){this.get("contentBox").all("img[data-src]").each(function(b){b.refresh()})},
_clearElements:function(){this._addIconEl&&this._addIconEl.inDoc()&&this._addIconEl.remove();this._stylesheet&&this._stylesheet.remove();this._uploader&&this._uploader.destroy();this._removeEmptyState();this.removeAll()},_setupDragBehaviors:function(){var c="."+b.Squarespace.ContentItemImage.CSS_PREFIX+":not(.yui3-dd-super-proxy-clone)",e=(this._ddDelegate=new b.DD.Delegate({container:this.get("contentBox"),nodes:c,target:!0})).dd;this._ddReorder=e.plug(b.Squarespace.DDReorder,{container:this.get("contentBox"),
nodes:c,multiSelectNodes:c+".selected"}).ddreorder;this._ddGrouping=e.plug(b.Squarespace.DDDragGrouping,{container:this.get("contentBox"),nodes:c,multiSelectNodes:c+".selected"}).dragGrouping;c={horizontal:!1,scrollDelay:100};if(this.get("windowScrollOnDrag"))e.plug(b.Plugin.DDWinScroll,c);else{var d=this.get("scrollNode")||this.get("contentBox");e.plug(b.Plugin.DDNodeScroll,b.merge(c,{node:d}))}e=this.get("dragRegion")||this.get("boundingBox");this._dragSelection=new b.Squarespace.DragSelection({node:"body",
boundingRegion:e,activationRegion:e,enabled:this.get("dragSelectionEnabled")})},_onKeydown:function(b){this.get("keyBindingsEnabled")&&(46==b.keyCode||8==b.keyCode)&&this.removeSelected()},_getDraggingNodes:function(){var c="."+b.Squarespace.ContentItemImage.CSS_PREFIX+".selected,.proxy-animating-back,.yui3-dd-dragging",e=":not(."+this._ddReorder.get("cloneClass")+")";return this.get("contentBox").all(c).filter(e)},_onSingleReorder:function(c){1===this._getDraggingNodes().size()&&this.get("model").items.reorderItems([b.Widget.getByNode(c.node).get("item")],
c.newIndex)},_onGroupReorder:function(c){var e=this._getDraggingNodes();if(1<e.size()){var d=this.get("contentBox").get("children"),e=e.getDOMNodes().sort(function(b,c){return d.indexOf(b)>d.indexOf(c)?1:-1}),e=b.Array.map(e,function(c){return b.Widget.getByNode(c).get("item")},this);this.get("model").items.reorderItems(e,c.newIndex)}},_afterAddChild:function(c){b.WidgetParent.prototype._afterAddChild.call(this,c);this._insertChildBeforeUploader(c.child);this._ddDelegate.syncTargets()},_uploadImageProcessor:function(c){var e=
this.get("model"),d=this._uploader.fileDataFromFile(c.file);d&&!c.item&&(c.item=d.item);var d={contentType:"image",process:"true",index:c.item?c.item.get("displayIndex"):e.get("nextDisplayIndex")},g=e.get("id");(e=e.get("collectionId"))?(d.collectionId=e,d.parentItemId=g):d.collectionId=g;c.postData=d;c.invalid&&(c=c.invalid[0],new b.Squarespace.Widgets.Alert({"strings.title":c.title,"strings.message":c.message}))},_addImagePlaceholder:function(c){var e=new b.Squarespace.Models.ContentItem({mediaProcessingState:b.Squarespace.MediaProcessingState.QUEUED,
displayIndex:c.postData.index,recordType:b.Squarespace.RecordType.IMAGE});this.get("model").items.add(e,{onUpload:!0});c.item=e;c=this._addItemWidget(e);this.get("loadByViewport")&&this._loadItemImagesInViewport();return c.get("contentBox").one(".inside")},_imageUploadComplete:function(c,e){c.item.setAttrs(e.media[0]);0===c.index&&this._registerEvent(c.item.after(this.get("id")+"|mediaProcessingStateChange",function(c){c.newVal==b.Squarespace.MediaProcessingState.READY&&this.get("model").load()},
this))},_createImageProcessingJob:function(c,e){if(!e.job)return console.warn("No job created. Image processing on the frontend should hang."),null;c.item.setAttrs(e.media[0]);var d=new b.Squarespace.ImageProcessingJob(b.merge(e.job,{started:!0}));d.set("collection",this.get("model"));return d}},{CSS_PREFIX:"sqs-content-item-grid",ASYNC_DATA:!0,ATTRS:{defaultChildType:{value:b.Squarespace.ContentItemImage},model:{validator:function(c){return b.instanceOf(c,b.Squarespace.Models.ContentCollection)||
b.instanceOf(c,b.Squarespace.Models.ContentItem)}},collection:{getter:function(){return this.get("model")}},collectionConfiguration:{setter:function(c){return!b.instanceOf(c,b.Model)?new b.Model(c):c}},contentItemImageOptions:{value:{}},imageSize:{value:100},minMargin:{value:20},strings:{value:{uploadText:"Click here or drag and drop to upload images.",emptyTitle:"Add Items",emptyDesc:"This collection is empty. Click here to add your first item."}},multiple:{value:!0},showAddIcon:{value:!1},showEmptyState:{value:!0},
dragRegion:{},windowScrollOnDrag:{value:!1},scrollNode:{value:null},keyBindingsEnabled:{value:!0},dragSelectionEnabled:{value:!0},uploadPreflight:{},loadByViewport:{value:!0}}})},"1.0",{requires:"widget-parent widget-child event-key dd-delegate squarespace-ss-widget squarespace-content-item-image squarespace-uploader squarespace-image-loader squarespace-job-manager squarespace-async-task-synchronizer squarespace-dd-behaviors squarespace-drag-selection squarespace-models-content-collection squarespace-models-content-item squarespace-dialog-flow squarespace-dialog-content-selector squarespace-content-collection-bulk-actionable squarespace-content-item-types-selector squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-dialog-labelled-value-table",function(b){b.namespace("Squarespace");var d=b.Squarespace.DialogFields.LabelledValueTable=b.Base.create("LabelledValueTable",b.Squarespace.DialogField2,[],{initializer:function(){b.Lang.isValue(this.get("data"))||this.set("data",this.get("defaultData"))},renderUI:function(){d.superclass.renderUI.call(this);this.get("contentBox");this._populateTable(this.get("data"))},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox");this.on("rowsChanged",
this._updateDataFromTable,this);b.delegate("change",this._updateDataFromTable,"input",this);b.delegate("click",this._insertNewRow,".add-row",this);b.delegate("click",this._removeRow,".remove",this)},_populateTable:function(c){b.Array.each(c,this._addRow,this)},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("contentBox");b.Lang.isValue(this.get("data"))&&c.toggleClass("empty",0===this.get("data").length)},_updateDataFromTable:function(){this.set("data",this._extractRowValuesFromTable())},
_removeRow:function(b){b.currentTarget.ancestor(".row").remove();b.stopPropagation();this.fire("rowsChanged")},_insertNewRow:function(){var b=this.get("contentBox"),e={};e[this.get("valueKey")]=2500;this._addRow(e);b.one(".add-row").scrollIntoView();this.fire("rowsChanged")},_addRow:function(c){var e=this.get("contentBox");c=b.Node.create(b.Handlebars.render(this.getProperty("ROW_TEMPLATE"),{value:c[this.get("valueKey")],label:c[this.get("labelKey")]}));b.Lang.isValue(this.get("valueInputPlugin"))&&
c.one('input[name="value"]').plug(this.get("valueInputPlugin"));e.one("tbody").append(c)},_extractRowValuesFromTable:function(){var c=[];this.get("contentBox").one("tbody").all(".row").each(function(e){var d={},g=this.get("valueInputPlugin");b.Lang.isValue(g)?(g=g.NS,d[this.get("valueKey")]=e.one('input[name="value"]')[g].get("data")):d[this.get("valueKey")]=e.one('input[name="value"]').get("value");d[this.get("labelKey")]=e.one('input[name="label"]').get("value");c.push(d)},this);return c}},{CSS_PREFIX:"sqs-labelled-value-table",
HANDLEBARS_TEMPLATE:"dialog-labelled-value-table.html",ROW_TEMPLATE:'<tr class="row"><td class="left"><input type="text" class="value" name="value" value="{{value}}" /></td><td class="right"><input type="text" class="label" name="label" value="{{label}}" /></td><td class="remove"><div class="remove-row"></div></td></tr>',ATTRS:{strings:{value:{title:"",description:"",emptyMessage:"Empty",valueLabel:"My Value",labelLabel:"My Label"}},valueKey:{value:"value"},labelKey:{value:"label"},valueInputPlugin:{value:null},
defaultData:{value:[]}}})},"1.0",{requires:"base json handlebars squarespace-animations squarespace-input-utils squarespace-dialog-field-2 squarespace-dialog-labelled-value-table-template".split(" ")});
YUI.add("squarespace-block-image-editor-base",function(b){var d=d||function(){},c=b.namespace("Squarespace.Block.Editor").ImageBase=b.Base.create("image-block-editor-dialog-base",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(){this._host.contentImage.get("model").after(["imageIdChange","processingChange"],this.syncUI,this);this.onHostEvent("focusedChange",function(b){this._host.get("editController").alignInsertPoints()},this)},_syncResizable:d,destructor:function(){this.drop&&this.drop.destroy();
this._host.get("model").detach("blockEditor|*");this._host.contentImage.detach("blockEditor|*");this._host.contentCaption.detach("blockEditor|*")},_bindDialogEvents:function(){c.superclass._bindDialogEvents.call(this);this.configDialog.get("dialog").on("dismiss",function(b){this._getContentItemEditor().set("editing",!1)},this)},_getContentItemEditor:function(){return this._host.contentImage.contentEditor}},{ATTRS:{blockName:{value:"Image"},editing:{value:!1},editingOverlay:{valueFn:function(){return null}},
editingTrueOnNewBlock:{value:!1},editingEvent:{value:["dblclick","contextmenu"]}}})},"1.0",{requires:["base","squarespace-model-editor","squarespace-block-editor-base","squarespace-block-editor-dialog"]});
YUI.add("squarespace-form-editing-utils",function(b){b.namespace("Squarespace");b.Squarespace.FormEditingUtils={resolveFieldTitle:function(d,c){var e=0;b.Array.each(c,function(b){b.type===d.type&&e++},this);0<e&&(d.title=d.title+" "+e)},resolveFieldId:function(d,c){d.id||(b.Lang.isValue(d.title)||b.Squarespace.FormEditingUtils.resolveFieldTitle(d,c),d.id=b.guid(b.Squarespace.Utils.createUrl(d.type)+"-"))}}},"1.0",{requires:["squarespace-util","squarespace-dialog-description","squarespace-dialog-text",
"squarespace-dialog-code","squarespace-dialog-wysiwyg"]});
YUI.add("squarespace-hb-number-format",function(b){b.Handlebars.registerHelper("number-format",function(d,c){var e=c.hash,f=b.Lang.isUndefined(e.prefix)?"$":e.prefix,g=b.Lang.isUndefined(e.thousandsSeparator)?",":e.thousandsSeparator,h=b.Lang.isUndefined(e.decimalSeparator)?".":e.decimalSeparator,k=b.Lang.isUndefined(e.decimalPlaces)?2:parseInt(e.decimalPlaces,10),e=b.Lang.isUndefined(e.suffix)?"":e.suffix;return b.Number.format(d,{prefix:f,thousandsSeparator:g,decimalSeparator:h,decimalPlaces:k,
suffix:e})})},"1.0",{requires:["handlebars-base","datatype-number-format"]});
YUI.add("squarespace-dialog-map",function(b){var d=function(b){b.stopPropagation()};b.namespace("Squarespace.DialogFields");var c=b.Squarespace.DialogFields.Map=b.Base.create("dialogMap",b.Squarespace.DialogField2,[],{initializer:function(b){b.panel&&(this.panel=b.panel);this.get("googleMapsLoaded")||this._setupGoogleMaps()},destructor:function(){b.Squarespace.GoogleMap.detach("load-success",this._setGoogleMapsLoadedTrue)},renderUI:function(){c.superclass.renderUI.call(this);this.get("anchorMap")?
this._mapDisplay=this.panel.getAnchorEl():(this._initMapEl(),this.show());this._renderGoogleAutoComplete()},bindUI:function(){c.superclass.bindUI.call(this);var e=this.get("contentBox");e.one(".map-address-fields").all(".field-input").each(function(b){b.on("keyup",this._updateDataBasedOn,this);b.on("focus",this._updateDataAfterBlur,this)},this);e.on("click",d);this._mapDisplay.on("click",d);e=this.get("dialog")||this.get("panel");b.Lang.isValue(e)&&(this._rerenderHandler=e.after("tab-focused",function(b){this.get("googleMapsLoaded")&&
this.map&&this._drawMap()},this));this._bindGoogleAutoComplete()},_renderGoogleAutoComplete:function(){var c=b.Squarespace.Damask.ContextGlobals.fromTop("Y"),d=this.get("boundingBox");this._autocomplete=new c.Squarespace.Widgets.GooglePlacesAutocomplete({inputNode:d.one("input.map-address-line1"),className:"sqs-dialog-map-google-autocomplete"});c=d.ancestor(".standard-dialog-wrapper")||b.one("body");this._autocomplete.render(c);this._autocomplete.get("boundingBox").setStyle("zIndex",b.Squarespace.DIALOG_ZINDEX_BASE+
10)},_bindGoogleAutoComplete:function(){this._lockedForAutocomplete=!1;this._autocomplete.on("listMouseDown",function(){this._lockedForAutocomplete=!0;b.later(1E3,this,function(){this._lockedForAutocomplete=!1},this)},this);this._autocomplete.on("keyboardContinue",function(){this._lockedForAutocomplete=!0},this);this._autocomplete.on("select",function(){this._lockedForAutocomplete=!0},this);this._autocomplete.on("placeDetails",this._populateFieldsFromAutocomplete,this)},_initMapEl:function(){this._mapDisplay=
b.Node.create('<div class="field-map sqs-disable-drag-selection"><div class="field-map-inner">Use the field above to select a location.</div></div>');this.get("contentBox").one(".field-wrapper").append(this._mapDisplay);this.get("height")&&this._mapDisplay.setStyle("height",this.get("height"))},_updateDataAfterBlur:function(b){if(b.target)b.target.once("blur",this._updateDataBasedOn,this)},_populateFieldsFromAutocomplete:function(b){var c=this.get("contentBox");c.one(".map-address-line1").set("value",
b.place.address);c.one(".map-address-line2").set("value",b.place.fullLocality);c.one(".map-address-country").set("value",b.place.country);this._lockedForAutocomplete=!1;c.one(".map-address-title").focus();b={addressTitle:c.one(".map-address-title").get("value"),addressLine1:b.place.address,addressLine2:b.place.fullLocality,addressCountry:b.place.country,markerLat:this.map.center.lat(),markerLng:this.map.center.lng()};this.didDataChange(b)&&(this.set("data",b,{silent:!0}),this.geocodeAndUpdateAddress())},
_updateDataBasedOn:function(c){if(!this._lockedForAutocomplete&&("blur"===c.type||c.keyCode&&13===c.keyCode)){var d=this.get("contentBox"),d={addressTitle:d.one(".map-address-title").get("value"),addressLine1:d.one(".map-address-line1").get("value"),addressLine2:d.one(".map-address-line2").get("value"),addressCountry:d.one(".map-address-country").get("value")};c.keyCode&&(d.markerLat=this.map.center.lat(),d.markerLng=this.map.center.lng());this.didDataChange(d)&&(this.set("data",b.merge(this.get("data"),
d),{silent:!0}),this.geocodeAndUpdateAddress())}},_clearLatLngData:function(c){c=b.Lang.isValue(c)?c:this.get("data");delete c.markerLat;delete c.markerLng;delete c.mapLat;delete c.mapLng;return c},_geocodeAndUpdateAddress:function(c,d){this._geocoder.geocode({address:c},b.bind(function(c,e){if(e===google.maps.GeocoderStatus.OK){var k=c[0].geometry.location,l=k.lat(),p=k.lng(),q={mapLat:l,mapLng:p};q.markerLat=l;q.markerLng=p;this._updateMap({markerLatLng:b.Lang.isValue(q.markerLat)?k:null,mapCenterLatLng:k,
mapOnlyUpdate:!0});this.set("data",b.merge(d,q))}else this.showMessageForGeocoderStatus(e);b.Lang.isValue(this.panel)&&this.panel.fire("geocode",this)},this))},geocodeAndUpdateAddress:function(){if(this.get("googleMapsLoaded")){var c=this.get("data"),d=this.getSearchableAddress(c);b.Lang.isValue(d)&&this._geocodeAndUpdateAddress(d,c)}},_setupGoogleMaps:function(){var c=b.Squarespace.GoogleMap;c.on("load-success",this._setGoogleMapsLoadedTrue,this);c.load()},_setGoogleMapsLoadedTrue:function(b){this.set("googleMapsLoaded",
!0)},show:function(){this.set("visible",!0);this._showMap()},_showMap:function(){if(this.map)this._refreshMapAndCenter();else if(this.get("anchorMap")&&!this._mapDisplay._node.__map)this._mapDisplay.on("maps-loaded",this._drawMap,this);else if(this.get("googleMapsLoaded"))this._drawMap();else this.onceAfter("googleMapsLoadedChange",this._drawMap,this)},_refreshMapAndCenter:function(){this._mapDisplay.setStyle("display","block");b.Lang.isValue(google)&&(b.Lang.isValue(this.map)&&b.Lang.isValue(this.marker))&&
(google.maps.event.trigger(this.map,"resize"),this.map.setCenter(this.marker.getPosition()))},_drawMap:function(c){if(!this.get("destroyed")){c=google.maps;if(this.get("anchorMap"))this.map=this._mapDisplay._node.__map,this._geocoder=this._mapDisplay._node.__geocoder,this.marker=this._mapDisplay._node.__marker;else{var d=b.merge(this.get("defaultLocation"),this.get("data"));this._geocoder=new c.Geocoder;this.map=new c.Map(this._mapDisplay.getDOMNode(),{zoom:d.mapZoom,center:new c.LatLng(d.mapLat,
d.mapLng),mapTypeId:c.MapTypeId.ROADMAP,scrollwheel:this.get("scrollwheelEnabled")});b.Squarespace.Rendering.createGrayscaleMap(this.map);b.Lang.isValue(d.markerLat)&&(this.marker=this._mapDisplay._node.__marker=new c.Marker({map:this.map,animation:c.Animation.DROP,draggable:!0,position:new c.LatLng(d.markerLat,d.markerLng),icon:{url:"/universal/images-v6/icons/icon-map-marker-2x.png",size:new c.Size(52,68),scaledSize:new c.Size(26,34),anchor:new c.Point(13,34)}}))}c.event.addListener(this.map,"idle",
b.bind(this._updateDataFromGoogleMaps,this));c.event.addListener(this.map,"dblclick",b.bind(this._updateMarker,this));this.bindMarkerDragEvent();this._mapDisplay.on("marker-created",this.bindMarkerDragEvent,this);this._setInitialState()}},_updateMarker:function(c){b.Lang.isValue(c.latLng)&&this._updateMap({markerLatLng:c.latLng})},_updateDataFromGoogleMaps:function(){var c;c=this.map;var d=this.marker,g={};b.Lang.isNumber(c.center.lat())&&b.Lang.isNumber(c.center.lng())&&(g.mapLat=c.center.lat(),
g.mapLng=c.center.lng(),g.mapZoom=c.getZoom());d&&d.visible&&(g.markerLat=d.getPosition().lat(),g.markerLng=d.getPosition().lng());this.didDataChange(g)&&(c=b.merge(this.get("data"),g),this.set("data",c))},_updateMap:function(c){!this._mapDisplay.ancestor(".sqs-block",!0)&&(this.map&&b.Lang.isValue(google))&&(b.Lang.isValue(c.markerLatLng)&&this._setMarkerPosition(c.markerLatLng,c.mapOnlyUpdate),!b.Lang.isUndefined(c.mapCenterLatLng)&&!this.isContainedInMap(this.map,c.markerLatLng)&&this._setMapPosition(c.mapCenterLatLng,
c.zoom))},_setMapPosition:function(c,d){b.Lang.isValue(c)&&this.map.setCenter(c);b.Lang.isValue(d)&&this.map.setZoom(d)},_setMarkerPosition:function(b,c){this.marker?this.marker.setPosition(b):this.marker=this._mapDisplay._node.__marker=new google.maps.Marker({map:this.map,animation:google.maps.Animation.DROP,draggable:!0,position:b});this.bindMarkerDragEvent();c||this._onMarkerChange()},bindMarkerDragEvent:function(){this.marker||(this.marker=this._mapDisplay.getDOMNode().__marker);this.marker&&
(b.Lang.isUndefined(this.markerDragListener)||google.maps.event.removeListener(this.markerDragListener),this.markerDragListener=google.maps.event.addListener(this.marker,"dragend",b.bind(this._onMarkerChange,this)))},isContainedInMap:function(c,d){if(b.Lang.isValue(c)&&b.Lang.isValue(d)){var g=c.getBounds();if(b.Lang.isValue(g))return g.contains(d)}return!1},_onMarkerChange:function(){this._geocoder.geocode({location:this.marker.getPosition()},b.bind(function(b,c){c===google.maps.GeocoderStatus.OK?
this.updateFormFields(b[0].address_components):this.showMessageForGeocoderStatus(c)},this))},_setInitialState:function(){var c=this.get("data"),d=this.get("contentBox");if(b.Lang.isObject(c))if(c.addressTitle&&d.one(".map-address-title").set("value",c.addressTitle),c.addressLine1&&d.one(".map-address-line1").set("value",c.addressLine1),c.addressLine2&&d.one(".map-address-line2").set("value",c.addressLine2),c.addressCountry&&d.one(".map-address-country").set("value",c.addressCountry),c.forceLoc)this.geocodeAndUpdateAddress();
else if(this.map&&!b.Lang.isUndefined(google)){var g,h;c.markerLat&&c.markerLng&&(g=new google.maps.LatLng(c.markerLat,c.markerLng));c.mapLat&&c.mapLng&&(h=new google.maps.LatLng(c.mapLat,c.mapLng));this._updateMap({markerLatLng:g,mapCenterLatLng:h,zoom:c.mapZoom,mapOnlyUpdate:!0})}},updateFormFields:function(c){var d=this.get("contentBox"),g=this.get("data")||{},h=d.one(".map-address-line1"),k=d.one(".map-address-line2"),d=d.one(".map-address-country"),l,p,q,r,s,t,u=[],v=[];b.Object.each(c,function(b){-1!==
b.types.indexOf("locality")?p=b.short_name:-1!==b.types.indexOf("administrative_area_level_1")?q=b.short_name:-1!==b.types.indexOf("country")?l=b.long_name:-1!==b.types.indexOf("route")?s=b.short_name:-1!==b.types.indexOf("street_number")?r=b.short_name:-1!==b.types.indexOf("postal_code")&&(t=b.short_name)},this);r&&u.push(r);s&&u.push(s);p&&v.push(p);q&&v.push(q);t&&v.push(t);h&&(h.set("value",u.join(" ")),g.addressLine1=h.get("value"));k&&(k.set("value",v.join(", ")),g.addressLine2=k.get("value"));
d&&(d.set("value",l),g.addressCountry=d.get("value"));b.Lang.isValue(this.marker)&&(c=this.marker.getPosition().lng(),h=this.marker.getPosition().lat(),g=b.merge(g,{markerLat:h,markerLng:c,mapLat:h,mapLng:c}));this.set("data",g)},showMessageForGeocoderStatus:function(c){c!==google.maps.GeocoderStatus.OK&&(c===google.maps.GeocoderStatus.OVER_QUERY_LIMIT?new b.Squarespace.Widgets.Alert({"strings.title":"Too Many Queries","strings.message":"You have exceeded Google Maps' maximum query rate. Please wait a moment before resuming."}):
c!==google.maps.GeocoderStatus.ZERO_RESULTS&&new b.Squarespace.Widgets.Alert({"strings.title":"Lookup Failed","strings.message":"Address lookup was not successful: "+status}))},getSearchableAddress:function(b){var c=[];""!==b.addressLine1&&c.push(b.addressLine1);""!==b.addressLine2&&c.push(b.addressLine2);""!==b.addressTitle&&!c.length&&c.unshift(b.addressTitle);""!==b.addressCountry&&c.push(b.addressCountry);return c.join(", ")},_roundedEqual:function(c,d){return b.Lang.isNumber(c)&&b.Lang.isNumber(d)&&
Number(c).toFixed(6)===Number(d).toFixed(6)},didDataChange:function(c){var d=(c?this.get("data"):this._initialData)||{};c=c||this.get("data");var g=this.get("defaultLocation");return!b.Lang.isObject(c)?!1:b.Object.some(c,function(c,e){var l=d[e];if(c===d[e]||this._roundedEqual(c,l))return!1;var p=!b.Object.hasKey(g,e),l=b.Lang.isValue(l),q=this._roundedEqual(c,g[e]);return p||!(q&&l)},this)}},{CSS_PREFIX:"sqs-maps",HANDLEBARS_TEMPLATE:"dialog-map.html",ATTRS:{anchorMap:{},scrollwheelEnabled:{value:!0},
data:{setter:b.Squarespace.debounce(function(b){return b},100,null,!0)},defaultLocation:{valueFn:function(){var c={mapLat:40.7207559,mapLng:-74.0007613,mapZoom:12};if(Static.SQUARESPACE_CONTEXT){var d=Static.SQUARESPACE_CONTEXT.website;d&&d.location&&(c=b.merge(c,d.location))}return c}},googleMapsLoaded:{getter:function(c){return c||!!b.Squarespace.GoogleMap.loaded}},strings:{value:{placeholderAddressTitle:"Title",placeholderAddress1:"Address",placeholderAddress2:"City, State, Zip",placeholderAddressCountry:"Country"}}}})},
"1.0",{requires:"base node squarespace-damask-context-globals squarespace-debounce squarespace-dialog squarespace-dialog-field-2 squarespace-dialog-map-template squarespace-util squarespace-widgets-google-places-autocomplete squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-scrollintoview",function(b){b.Node.prototype.scrollIntoView=function(){var d=b.Node.getDOMNode(this.get("offsetParent"));if(!d)return this;for(var c={top:this.get("offsetTop"),bottom:this.get("offsetTop")+this.get("offsetHeight"),left:this.get("offsetLeft"),right:this.get("offsetLeft")+this.get("offsetWidth"),move:function(b,c){this.top+=c;this.bottom+=c;this.left+=b;this.right+=b}};;){for(;;){var e=null===d.offsetParent,f=b.one(d),g=b.Node.getDOMNode(f)===b.config.doc.body,h=
g?b.DOM.winWidth():d.clientWidth,g=g?b.DOM.winHeight():d.clientHeight;if(d.scrollWidth-f.horizMarginBorderPadding()>h||d.scrollHeight-f.vertMarginBorderPadding()>g)break;else if(e)return this;c.move(d.offsetLeft-d.scrollLeft,d.offsetTop-d.scrollTop);d=d.offsetParent||d.parentNode}var k=e?b.config.doc.documentElement.scrollLeft||b.config.doc.body.scrollLeft:d.scrollLeft,h=g=e?b.config.doc.documentElement.scrollTop||b.config.doc.body.scrollTop:d.scrollTop,l=g+(e?b.DOM.winHeight():d.clientHeight),g=
k,k=k+(e?b.DOM.winWidth():d.clientWidth),p=0;"hidden"!=f.getStyle("overflowY")&&(c.top<h?p=c.top-h:c.bottom>l&&(p=Math.min(c.bottom-l,c.top-h)));h=0;"hidden"!=f.getStyle("overflowX")&&(c.left<g?h=c.left-g:c.right>k&&(h=Math.min(c.right-k,c.left-g)));if(e){(h||p)&&window.scrollBy(h,p);break}else d.scrollLeft+=h,d.scrollTop+=p,c.move(d.offsetLeft-d.scrollLeft,d.offsetTop-d.scrollTop),d=d.offsetParent}return this}},"1.0",{requires:["gallery-dimensions","dom-screen"]});
YUI.add("squarespace-abtest",function(b){function d(d,w){function y(c){c=b.JSON.stringify({name:c.name,totalFrequencyUnits:c.totalFrequencyUnits,variations:c.variations});return b.Squarespace.MurmurHash.hash(c)}function z(b){for(var c={name:b.name,totalFrequencyUnits:b._total_units,variations:[],conversionGoal:b._conversion_goal},e=0;e<b._variations.length;e++){var d=b._variations[e];c.variations.push({name:d.name,frequency:d.units,item:null==d.item?null:d.item.toString()})}c.variations.sort(function(b,
c){return b.name<c.name?-1:b.name>c.name?1:0});c.hash=y(c);return c}function B(b){if(!b._finalized){if(2>b._variations.length)throw"Must have at least two variations defined.";b._variations.sort(function(b,c){return b.name<c.name?-1:b.name>c.name?1:0});var c=0,e=[],d=[];b._variations.forEach(function(b){b.units!=q?(c+=b.units,e.push(b)):d.push(b)});if(0<d.length){if(c>=b._total_units)throw"Total units for variations excluding the REMAINDER variations must be less than total units of "+b._total_units+
", instead of "+c;var f=b._total_units-c,g=Math.floor(f/d.length),h=f%d.length;if(1>g)throw"Remaining "+f+" units cannot be distributed among "+d.length+" variations.";for(f=0;f<d.length;f++){var k=d[f];k.units=f+1==d.length?g+h:g;c+=k.units;e.push(k)}}if(c!=b._total_units)throw"Total units for all variations must equal the specified total units of "+b._total_units+", instead of "+c;b._variations=e;if(null==b._conversion_goal)throw"Must define a conversionGoal for a test";b._description=z(b);b._finalized=
!0}}if(!c.test(d))throw"Test name must match regex "+c;if(void 0===w)w=100;else if(!("number"===typeof w&&Math.floor(w)===w)||2>w)throw"Units must be an integer > 2, not: "+w;this.name=d;this._variations=[];this._conversion_goal=null;this._total_units=w;this._selection_listeners=[];this._participation_filters=[];this._item_for_non_participant=null;this._finalized=!1;this.variation=function(b,c,d){var f;if(2==arguments.length)d=c,f=q;else if(f=parseInt(c,10),isNaN(f)||1>f)throw"Units must be a number > 0, not: "+
c;if(!e.test(b))throw"Variation name must match regex "+e;if(this._finalized)throw"Cannot add a variation to a test already finalized and used for selection";for(var g=0;g<this._variations.length;g++)if(b==this._variations[g].name)throw"Already have a test variation with name: "+b;this._variations.push({name:b,units:f,item:d});return this};this.conversionGoal=function(b,c){if(null!=this._conversion_goal)throw"Already defined a conversion goal: "+this._conversion_goal;if(!f.test(b))throw"Conversion goal name must match regex "+
f;void 0===c&&(c=l);if(isNaN(c))throw"percent_change_target for a conversion goal must be number";if(1<c||-1>c)throw"percent_change_target is a fraction, e.g. 0.10 for 10%. Cannot exceed 1 or be less than -1.";this._conversion_goal={metric:b,targetPercentChange:c};return this};this.filter=function(b,c){this._participation_filters.push(b);1<arguments.length&&(this._item_for_non_participant=c);return this};this.filterOutParticipantsInOtherTests=function(b,c){return 1<arguments.length?this.filter(t(b),
c):this.filter(t(b))};this.requireParticipationInOtherTests=function(b,c){return 1<arguments.length?this.filter(u(b),c):this.filter(u(b))};this.itemForNonParticipant=function(b){this._item_for_non_participant=b;return this};this.addSelectionListener=function(b){this._selection_listeners.push(b);return this};this.removeSelectionListener=function(b){b=this._selection_listeners.indexOf(b);0<=b&&this._selection_listeners.splice(b,1);return this};this.pastParticipationKey=function(){B(this);return this.name+
":"+this._description.hash};this.select=function(){B(this);var c,e=b.Cookie.get(h);c=null==e?{}:b.QueryString.parse(e);var d=b.Cookie.get(g)||"",f=null,l=null,e=!0;if(void 0!==c[this.pastParticipationKey()])a:{for(var f=this._variations,q=c[this.pastParticipationKey()],t=0;t<f.length;t++)if(f[t].name==q){f=f[t];break a}f=null}if(null==f){f=!1;for(q=0;q<this._participation_filters.length;q++)if(!this._participation_filters[q](d,c)){f=!0;break}if(f)f={name:s,units:r,item:this._item_for_non_participant},
e=!1;else{for(var l=(Math.abs(b.Squarespace.MurmurHash.hash(d+this.name,k))&65535)%this._total_units,f=this._variations,q=null,u=t=0,v=0;v<f.length;v++){q=f[v];u=t+q.units;if(l>=t&&l<u)break;t=u}if(!q)throw"No variation found for bucket id: "+l;f=q;c[this.pastParticipationKey()]=f.name}}c={test:this,selected:f,bucket_id:l,user:d,participations:c};if(e)try{b.Cookie.set(h,b.QueryString.stringify(c.participations)),b.io("/api/events/ABTest",{data:{variation:c.selected.name,selectionCriteria:c.user,description:b.JSON.stringify(c.test._description)},
on:{}})}catch(w){console.log("ABTest selection recording error: "+w)}for(e=0;e<p.length;e++)try{p[e](c)}catch(y){console.log("Global selection listener error: "+y)}for(e=0;e<this._selection_listeners.length;e++)try{this._selection_listeners[e](c)}catch(z){console.log("Selection listener error: "+z)}return f.item};return this}b.namespace("Squarespace");var c=/^[a-zA-Z]\w{0,63}$/,e=/^[a-zA-Z0-9][\w ]{0,63}$/,f=/^[a-zA-Z0-9].{0,250}$/,g="SS_MID",h="SS_ABPP",k=42,l=0.1,p=[],q=-1,r=0,s="__non_participant__",
t=function(c){if(!b.Array.test(c)||!c.length)throw"Must provide a non-empty array of test names";var e=b.Array(c);return function(c,d){return!b.Object.some(d,function(c,d){var f=d.indexOf(":");if(0>f)return!1;var g=d.substring(0,f);return b.Array.some(e,function(b){return g==b})?!0:!1})}},u=function(c){if(!b.Array.test(c)||!c.length)throw"Must provide a non-empty array of test names";var e={};b.Array.each(c,function(b){e[b]=!1});return function(c,d){b.Object.each(d,function(c,d){var f=d.indexOf(":");
if(0>f)return!1;f=d.substring(0,f);b.Object.hasKey(e,f)&&(e[f]=!0)});return!b.Object.some(e,function(b,c){return!b})}};b.Squarespace.ABTest={newTest:function(b,c){return new d(b,c)},addSelectionListener:function(b){p.push(b)},removeSelectionListener:function(b){b=p.indexOf(b);0<=b&&p.splice(b,1)}}},"1.0",{requires:"io-base cookie json querystring-stringify-simple querystring-parse-simple squarespace-murmurhash".split(" ")});
YUI.add("squarespace-aviary",function(b){var d=b.Base.create("Aviary",b.Base,[],{launch:function(c,e){if(!c||!b.instanceOf(c,b.Squarespace.Models.ContentItem))throw"Aviary must have a valid item in order to launch.";this._item=c;this._mode=e;b.one("#injection_site")||b.one("body").append(b.Node.create('<div id="injection_site"></div>'));b.Lang.isValue(this._editor)?this._startEditing():this._createEditorSingleton(c);var d=b.one("#avpw_holder");d&&d.setStyle("visibility","hidden")},_getAviaryFileFormatForItem:function(c){var e=
c.get("filename");return b.Lang.isValue(e)?e.match(/.*(jpeg|jpg)/i)?"jpg":"png":c.get("contentType").match(/.*(jpeg|jpg)/i)?"jpg":"png"},_startEditing:function(){var c=this._getItemUrl(),e=this._item.getAssetUrlForFormat("original"),c=b.Node.create('<img id="temp-aviary-img" src="'+c+'" />').hide();b.one("body").append(c);b.Data.get({url:"/api/rest/aviary/signature",success:b.bind(function(b){var c=this._getAviaryFileFormatForItem(this._item);this._editor.launch({image:"temp-aviary-img",hiresUrl:e,
timestamp:b.timestamp,salt:b.salt,encryptionMethod:b.encryptionMethod,signature:b.signature,fileFormat:c,apiKey:b.apiKey})},this)})},_getItemUrl:function(){return b.Lang.sub("//{identifier}.{appDomain}/{context}/{id}?format=original&t={datetime}",{identifier:Static.SQUARESPACE_CONTEXT.website.identifier,appDomain:Static.SQUARESPACE_CONTEXT.appDomain,context:this._mode==b.Squarespace.UploadModes.GLOBAL?"global":"item",id:this._item.get("id"),datetime:(new Date).getTime()})},_createEditorSingleton:function(){this._editor=
new Aviary.Feather({apiKey:"1f973cd5d",apiVersion:3,tools:"orientation,crop,resize,text,enhance,brightness,contrast,effects,saturation,sharpness,draw,redeye,whiten,blemish,frames",appendTo:"",minimumStyling:!0,maxSize:2500,onLoad:b.bind(function(){this._startEditing()},this),onReady:b.bind(function(){window.scrollTo(0,0);var c=b.one("#avpw_holder");c.hasClass("sqs-prevent-block-focus-change")||c.addClass("sqs-prevent-block-focus-change");c.on("click",function(b){b.stopPropagation()});c.setStyle("visibility",
"visible");this.fire("ready");b.Squarespace.EscManager.addTarget(this._editor)},this),onClose:b.bind(function(){b.one("#avpw_holder").setStyle("visibility","hidden");var c=b.one("#temp-aviary-img");c&&c.remove(!0);this.fire("close");b.Squarespace.EscManager.removeTarget(this._editor)},this),onSaveButtonClicked:b.bind(function(){b.Squarespace.Utils.isProductionEnvironment()&&this._editor.saveHiRes();return!0},this),onSaveHiRes:b.bind(function(b,e){this._save(e);this._editor.close()},this),onSave:b.bind(function(b,
e){this._save(e);this._editor.close()},this)})},_save:function(c){var e=this._item;b.Data.post({url:"/api/commondata/Save"+(this._mode===b.Squarespace.UploadModes.GLOBAL?"GlobalMedia":"Media"),data:{replaceItemId:e.get("id"),process:!0,contentType:e.get("contentType"),recordType:e.get("recordType"),fileUrl:c},success:function(c){c=new b.Squarespace.ImageProcessingJob(b.merge(c.job,{started:!0}));c.once("complete",function(){e.load();this.fire("save")},this);c.once("failure",function(){e.set("mediaProcessingState",
b.Squarespace.MediaProcessingState.ERROR)},this);e.set("mediaProcessingState",b.Squarespace.MediaProcessingState.QUEUED);Static.JOB_MANAGER.addJob(c)}},this)}});b.Aviary=new d},"1.0",{requires:"base node event thirdparty-aviary squarespace-jobs squarespace-enum squarespace-util squarespace-models-content-item".split(" ")});
YUI.add("squarespace-stats-block-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["stats-block.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="front">\n  <div class="front-content"></div>\n  <button type="button" class="edit-button">Edit</button>\n</div>\n\n<div class="back">\n  <div class="block-config-wrapper"></div>\n  <button type="button" class="commit-button">Done</button>\n</div>\n'})})();
b.Handlebars.registerPartial("stats-block.html".replace("/","."),d.templates["stats-block.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-settings-site-injection",function(b){b.namespace("Squarespace.Settings.Site").CodeInjection=b.Base.create("codeInjectionSettings",b.Squarespace.Widgets.SettingsPanel,[],{},{CSS_PREFIX:"sqs-code-injection-settings",ATTRS:{initialDataUrl:{value:"/api/config/GetInjectionSettings"},saveUrl:{value:"/api/config/SaveInjectionSettings"},"strings.title":{value:"Code Injection"},"strings.description":{value:'Squarespace allows you to insert arbitrary snippets of code into certain sections of your site. This allows you to customize a template without editing its code. <a target="new" href="'+
b.Squarespace.HelpLinks.CODE_INJECTION+'"> Click here for more help regarding code injection.</a>'},fields:{value:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Header",padding:[0,0],text:"Enter code that will be injected into the 'head' tag on every page of your site."}},{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"header"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Footer",text:"Enter code that will be injected into the template-defined footer on every page of your site."}},
{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"footer"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Lock Page",text:"Enter the code that will be used on the site-wide lock page.  Note that this will replace any default Squarespace messages on the lock page."}},{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"lockPage"}},{ctor:b.Squarespace.DialogFields.Description,config:{$escape:!0,title:"Order Confirmation Page",text:"Enter code that will be injected into the footer of the order confirmation page after checkout. If you'd like to pass the Order ID, subtotal, grand total, or customer email to a third party service, use the tags below in your code:<ul><li><code>{orderId}</code>: The unique ID of the confirmed order</li><li><code>{orderSubtotal}</code>: The subtotal of the confirmed order</li><li><code>{orderSubtotalCents}</code>: The subtotal of the confirmed order, in cents</li><li><code>{orderGrandTotal}</code>: The grand total of the confirmed order</li><li><code>{orderGrandTotalCents}</code>: The grand total of the confirmed order, in cents</li><li><code>{customerEmailAddress}</code>: The customer's email address, as it was entered in the \"Billing Info\" section</li></ul>"}},
{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"orderConfirmationPage"}},{$when:function(d){return b.Lang.isString(d.postItem)&&0<d.postItem.length},ctor:b.Squarespace.DialogFields.Description,config:{title:"Post Blog Item (Deprecated -- Use Per-Collection Config)",text:"Enter the code that will be injected onto the page immediately after each blog content block (but before the blog post's footer block, if any)."}},{$when:function(d){return b.Lang.isString(d.postItem)&&0<d.postItem.length},
ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"postItem"}}]}}})},"1.0",{requires:["squarespace-dialog-code","squarespace-dialog-description","squarespace-settings-panel"]});
YUI.add("squarespace-dashboard-manager",function(b){b.namespace("Squarespace");b.Squarespace.DashboardManager=Class.extend(b.Squarespace.PanelManager,{_name:"DashboardManager",viewMenuItem:function(d){this._super(d);this._commentCountEvt&&this._commentCountEvt.detach();this._hasCommentModeration&&(this._commentCountBadge=new b.Squarespace.Widgets.NumericBadge({value:Static.SQUARESPACE_CONTEXT.website.unmoderatedCommentCount}),this._commentCountBadge.render(this.menuContainerEl.one(".comment-settings")));
this._commentCountEvt=b.Global.on("sqsContextChange",function(){this._commentCountBadge&&this._commentCountBadge.set("value",Static.SQUARESPACE_CONTEXT.website.unmoderatedCommentCount)},this)},_destroy:function(){this._commentCountBadge&&this._commentCountBadge.destroy();this._currentView&&(this._currentView.destroy(),this._currentView=null);this._super()},getTitle:function(){return"Activity"},getDescription:function(){return"The activity area allows you to track your site visitors and manage comments."},
getName:function(){return"statistics"},getMenuItems:function(){var d=[{name:"traffic-overview",title:"Traffic Overview",viewPeriod:"month",get:this.getOverview,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"mobile-usage",title:"Mobile Usage",viewPeriod:"month",get:this.getDeviceOverview,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"subscribers",title:"Subscribers",viewPeriod:"month",tab:"all",tabName:"All",get:this.getSubscribers,
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"referrers",title:"Referrers",viewPeriod:"week",get:this.getReferrers,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"popular-content",title:"Popular Content",viewPeriod:"week",get:this.getPopularContent,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"search-queries",title:"Search Queries",viewPeriod:"week",get:this.getSearchEngine,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},
{name:"detailed-activity",title:"Detailed Activity",page:1,searchParams:{},searchDialogData:{},get:this.getDetailedActivity,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS}];Static.SQUARESPACE_CONTEXT.websiteSettings.disqusShortname||(d.push({type:!Static.SQUARESPACE_CONTEXT.websiteSettings.disqusShortname?"divider":void 0,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"comment-settings",title:"Comments",ctor:b.Squarespace.Widgets.CommentModeration,
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS}),this._hasCommentModeration=!0);b.Squarespace.Utils.isBetaFeatureEnabled()&&d.push({type:!Static.SQUARESPACE_CONTEXT.websiteSettings.disqusShortname?"divider":void 0,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS},{name:"timeline",title:"Timeline",get:this._showTimeline,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY_STATS});return d},_showDashboard:function(){this._showCtor(b.Squarespace.Views.Stats.Dashboard)},
_showTimeline:function(){this._showCtor(b.Squarespace.Stats.Views.Timeline)},_showCtor:function(b){var c=this.el;c.empty();this._currentView&&(this._currentView.destroy(),this._currentView=!1);this._currentView=new b;this._currentView.render(c)},_periodToDays:function(b){var c=0;switch(b){case "1day":c=1;break;case "2days":c=2;break;case "3days":c=3;break;case "week":c=7;break;case "month":c=31;break;default:c=7}return c},getOverview:function(){b.Data.get({url:"/api/census/GetReport",data:{name:"traffic",
segmentName:this.currentPanel.viewPeriod,verbose:"true"},success:this.renderOverview,failure:this.renderOverview},this)},getDeviceOverview:function(){b.Data.get({url:"/api/census/GetReport",data:{name:"device",segmentName:this.currentPanel.viewPeriod,verbose:"true"},success:this.renderDeviceOverview,failure:this.renderDeviceOverview},this)},getSubscribers:function(){b.Data.get({url:"/api/census/GetReport",data:{name:"subscriber",segmentName:this.currentPanel.viewPeriod,verbose:"true"},success:this.renderSubscribers,
failure:this.renderSubscribers},this)},_startTimedSpinner:function(){this._currentSpinHandle&&this._currentSpinHandle.cancel();var d=new b.Squarespace.Spinner({color:"dark"}),c=b.Node.create('<div class="spinner-container"></div>'),e=b.later(500,this,function(){d.render(c)});this.el.append(c);var f={cancel:function(){d.get("rendered")||e.cancel();d.destroy();c.remove(!0)}};return this._currentSpinHandle=f},getReferrers:function(){var d=this._periodToDays(this.currentPanel.viewPeriod),c=this._startTimedSpinner();
b.Data.get({url:"/api/census/GetReport",data:{name:"referrer",numberOfDays:d,verbose:!1},success:function(b){c.cancel();this.renderReferrers(b)},failure:function(b){c.cancel();this.renderReferrers(b)}},this)},getPopularContent:function(){var d=this._periodToDays(this.currentPanel.viewPeriod),c=this._startTimedSpinner();b.Data.get({url:"/api/census/GetReport",data:{name:"content",numberOfDays:d,verbose:!1},success:function(b){c.cancel();this.renderPopularContent(b)},failure:function(b){c.cancel();
this.renderPopularContent(b)}},this)},getSearchEngine:function(){var d=this._periodToDays(this.currentPanel.viewPeriod),c=this._startTimedSpinner();b.Data.get({url:"/api/census/GetReport",data:{name:"searchEngine",numberOfDays:d,verbose:!1},success:function(b){c.cancel();this.renderSearchEngine(b)},failure:function(b){c.cancel();this.renderSearchEngine(b)}},this)},getDetailedActivity:function(){var d=this.currentPanel.searchParams,c=this._startTimedSpinner();b.Data.get({url:"/api/census/GetReport",
data:{name:"details",page:this.currentPanel.page,visitFilter:d.visitorFilter,activityFilter:d.activityFilter,referrerFilter:d.referrerFilter,startDate:d.startDate,verbose:!1,endDate:d.endDate},success:function(b){c.cancel();this.renderDetailedActivity(b)},failure:function(b){c.cancel();this.renderDetailedActivity(b)}},this)},getPeriodChange:function(d,c){var e={name:"referrer",segmentName:c.viewPeriod,numberOfDays:this._periodToDays(c.viewPeriod),periodChange:"true"};b.Data.get({url:"/api/census/GetReport",
data:e,success:b.bind(this.renderPeriodChange,this,d),verbose:!1})},renderGenericFailure:function(b){this.el.append(this.renderNoData("error"))},renderReferrers:function(b){this._renderChartAccordionPanel(b,{panelTitle:"Referrers",countTitle:"Count",countAttr:"count",descriptionTitle:"Referrer",descriptionAttr:"domain",subCountAttr:"count",subDescriptionAttr:"path",chartFn:this.renderReferrersChart})},renderPopularContent:function(d){var c=!d.summaries||0===d.summaries.length,e=b.DB.DIV("panel-top-container clear"),
f=this.renderPanelTitle("Popular Content"),g=this.renderViewingPeriod(this.currentPanel,b.bind(this.viewMenuItem,this,this.currentPanel.name),["1day","2days","3days","week","month"],["1 Day","2 Days","3 Days","Week","Month"]);f.append(g);e.append(f);if(c||d.error)e.append(this.renderNoData(d.error?"error":"large","Check Back Later")),this.el.append(b.DB.DIV("statistics",e));else{c=b.DB.DIV("chart-container clear pie");f=b.DB.DIV("summary pie clear");e.append(c).append(f);f.append(this.renderSummary(d.totalCount,
null,null,"Total Page Views"));f=b.DB.DIV("detail padtop");if(0<d.summaries.length){g=b.DB.DIV("table");g.append(b.DB.DIV("head",b.DB.DIV("row clear",b.DB.DIV("cell first-column data",{html:"Count"}),b.DB.DIV("cell icon"),b.DB.DIV("cell",{html:"Page"}))));var h=b.DB.DIV("body");g.append(h);for(var k=0;k<d.summaries.length;++k){var l=d.summaries[k],p=this.parseTargetName(l.page),q=this.mapCollectionTypeToIcon(p.collectionType)||b.DB.DIV({html:"&nbsp;"}),l=b.DB.DIV("row clear",b.DB.DIV("cell data first-column",
{html:this.formatNumber(l.count)}),b.DB.DIV("cell icon",q),b.DB.DIV("cell text",b.DB.A({html:p.title,href:l.pageUrl,target:"_blank"})));h.append(l)}f.append(g)}this.el.append(b.DB.DIV("statistics",e,f));this.renderPopularContentChart(d,c)}},renderSearchEngine:function(b){this._renderChartAccordionPanel(b,{panelTitle:"Search Engine Queries",countTitle:"Count",countAttr:"count",descriptionTitle:"Search Query",descriptionAttr:"searchQuery",subCountAttr:"count",subDescriptionAttr:"searchEngine",chartFn:this.renderSearchEngineChart})},
_renderChartAccordionPanel:function(d,c){var e=b.merge({panelTitle:"",countTitle:"",countAttr:"",descriptionTitle:"",descriptionAttr:"",subCountAttr:"",subDescriptionAttr:"",chartFn:function(){}},b.Lang.isObject(c)?c:{}),f=!d.summaries||0===d.summaries.length,g=b.DB.DIV("panel-top-container clear"),h=this.renderPanelTitle(e.panelTitle),k=this.renderViewingPeriod(this.currentPanel,b.bind(this.viewMenuItem,this,this.currentPanel.name),["1day","2days","3days","week","month"],["1 Day","2 Days","3 Days",
"Week","Month"]);g.append(h);h.append(k);if(f||d.error)g.append(this.renderNoData(d.error?"error":"large")),this.el.append(b.DB.DIV("statistics",g));else{f=b.DB.DIV("chart-container clear");h=b.DB.DIV("summary pie clear");h.append(this.renderSummary(d.totalCount,null,null,"Total Page Views"));g.append(f);g.append(h);h=b.DB.DIV("detail padtop sub-stats-accordion");if(d.summaries&&0<d.summaries.length){for(var k=b.DB.DIV("table",b.DB.DIV("head",b.DB.DIV("row clear",b.DB.DIV("cell first-column data",
{html:e.countTitle}),b.DB.DIV("cell",{html:e.descriptionTitle})))),l=new b.Squarespace.Accordion,p=0;p<d.summaries.length;++p){var q=b.DB.DIV("accordion-container"),r=b.DB.DIV("accordion-header"),s=b.DB.DIV("accordion-body"),t=b.DB.DIV("body"),u=d.summaries[p],v=b.DB.DIV("row clear",b.DB.DIV("cell data first-column",{html:this.formatNumber(u[e.countAttr])}),b.DB.DIV("cell text",{html:u[e.descriptionAttr]}));t.append(v);k.append(t);u.domain||(u.domain="");if("Direct"===u.domain)v.one(".text").addClass("direct");
else{var w=b.DB.DIV("sub-body",{id:"referrerSource-"+p});if(u.subStatistics){for(var y=0;y<u.subStatistics.length;++y){var z=u.subStatistics[y];w.append(b.DB.DIV("row clear",b.DB.DIV("cell first-column data",{html:z[e.subCountAttr]}),b.DB.DIV("cell text",{colspan:2},b.DB.SPAN("bullet",{html:"&bull;"}),b.DB.A({href:"http://"+u.domain+z[e.subDescriptionAttr],html:"http://"+u.domain+this.trimEnd(z[e.subDescriptionAttr]),target:"_blank"}))))}y="";for(z=0;z<Math.min(u.subStatistics.length,4);++z)y+="&bull;";
v.append(b.DB.DIV("cell indicator",{html:y}))}r.append(t);s.append(w);q.append(r);q.append(s);l.add(q)}}h.append(k);l.render(k)}this.el.append(b.DB.DIV("statistics",g,h));e.chartFn.apply(this,[d,f])}},renderDetailedActivity:function(d){d.hasOwnProperty("lastId")&&(detailedActivityLastId=d.lastId);var c=!d.hits||0===d.hits.length,e=b.DB.DIV("panel-top-container clear"),f=this.renderPanelTitle("Detailed Activity"),g=b.DB.DIV("view-period-container"),h=b.DB.A("view-period clean",b.DB.IMG({src:"/universal/images-v6/configuration/stats-search-queries.png"}));
g.append(h);h.on("click",function(){this.showActivitySearchDialog(h)},this);f.append(g);e.append(f);if(c||d.error)e.append(this.renderNoData(d.error?"error":"large","Check Back Later")),this.el.append(b.DB.DIV("statistics",e));else{var k=b.DB.DIV("detail allactivity");if(0===d.hits.length)k.append(this.renderNoData());else{var l={chrome:b.DB.IMG({src:"/universal/images-v6/configuration/stats-chrome.png"}),firefox:b.DB.IMG({src:"/universal/images-v6/configuration/stats-firefox.png"}),explorer:b.DB.IMG({src:"/universal/images-v6/configuration/stats-explorer.png"}),
safari:b.DB.IMG({src:"/universal/images-v6/configuration/stats-safari.png"})},p={windows:b.DB.IMG({src:"/universal/images-v6/configuration/stats-windows.png"}),macosx:b.DB.IMG({src:"/universal/images-v6/configuration/stats-apple.png"}),linux:b.DB.IMG({src:"/universal/images-v6/configuration/stats-linux.png"})},q=function(b,c,e){b=b.toLowerCase();for(var d=0;d<c.length;++d){var f=c[d];if(-1!==b.indexOf(f))return e[f].cloneNode()}return null},r=b.bind(function(c){return q(c,b.Object.keys(l),l)},this),
s=b.bind(function(c){return q(c,b.Object.keys(p),p)},this),t=function(c,e){e=""===e?"-":e;return b.DB.DIV("item-box",b.DB.DIV({html:c}),b.DB.DIV("detail",{html:e}))},u=function(c){var e=r(c.browser),d=s(c.os);return b.DB.DIV("detail-small",d,e,b.DB.DIV({html:c.userAgent}))},v=b.DB.DIV("table",b.DB.DIV("head",b.DB.DIV("row clear",b.DB.DIV("cell detail first-column",{html:"Time"}),b.DB.DIV("cell detail",{html:"Visitor"}),b.DB.DIV("cell detail",{html:"Page Title"})))),w=[],y=b.bind(function(c,e){var d=
b.DB.DIV("accordion-container"),f=b.DB.DIV("accordion-header"),g=b.DB.DIV("accordion-body"),h=b.DB.DIV("body"),k=b.DB.SPAN("statistics-visitor-info",{html:c.ipAddress});k.setData({hit:c});w.push(k);var l=this.formatTargetName(c.targetName),p=c.accessOnShort.split("at"),q=p[0].trim(),p=p[1].trim(),k=b.DB.DIV("row clear",b.DB.DIV("cell detail first-column",{html:q}).append(b.DB.SPAN("small-time",{html:p})),b.DB.DIV("cell detail",k),b.DB.DIV("cell detail",{html:l}));h.append(k);h.append(b.DB.DIV("clear"));
v.append(h);l=b.DB.DIV("detail-sub-body",{id:"visitBody-"+e});t("Hostname:",c.hostname);var q=b.DB.DIV("cell first-column",t("Hostname:",c.hostname)),p=b.DB.DIV("cell",t("Tags:",c.tag)),r=b.DB.DIV("cell",u(c));l.append(b.DB.DIV("row pad clear",q,p,r));q.append(t("Country:",c.country));p.append(t("Referrer:",this.trimEnd(c.referrer)));k.setStyle("cursor","pointer");f.append(h);g.append(l);d.append(f);d.append(g);return d},this);this.currentPanel.accordion=new b.Squarespace.Accordion;this.currentPanel.accordion.add(d.hits.map(y));
k.append(v);this.currentPanel.accordion.render(v);c=b.DB.DIV("load-more");d.hasMoreRecords&&(c.append(b.DB.DIV("statistics-load-more-btn",{html:"Load More"})),c.one(".statistics-load-more-btn").on("click",function(c){if(!this.currentPanel.activityLoading){var e=this.currentPanel.searchParams;++this.currentPanel.page;this.currentPanel.activityLoading=!0;b.Data.get({url:"/api/census/GetReport",data:{name:"details",page:this.currentPanel.page,visitFilter:e.visitorFilter,activityFilter:e.activityFilter,
referrerFilter:e.referrerFilter,startDate:e.startDate,endDate:e.endDate,verbose:!1,lastId:detailedActivityLastId},success:function(e){e.hasOwnProperty("lastId")&&(detailedActivityLastId=e.lastId);this.currentPanel.activityLoading=!1;if(!e.hasMoreRecords){var d=c.target,f=d.getXY(),g=d.cloneNode(!0),h=b.one(".load-more"),l=k.one(".table");l.setStyles({"z-index":200,position:"absolute"});b.one("body").append(g);g.setStyles({"z-index":1,left:f[0],top:f[1],position:"absolute"});f=new b.Anim({node:g,duration:0.3,
easing:b.Easing.easeOutStrong,to:{opacity:0}});f.on("end",function(){l.setStyles({"z-index":null,position:null});g.remove(!0)});f.run();h.remove(!0);d.remove(!0)}this.currentPanel.accordion.add(e.hits.map(y))}},this)}},this));this.el.append(b.DB.DIV("statistics",e,k,c))}}},renderOverview:function(d){var c=!d.trafficBySegment||0===d.trafficBySegment.length,e=b.DB.DIV("panel-top-container clear"),f=this.renderPanelTitle("Overview"),g=this.renderViewingPeriod(this.currentPanel,b.bind(this.viewMenuItem,
this,this.currentPanel.name),["day","month","week","year"],["Hourly","Daily","Weekly","Monthly"]);f.append(g);e.append(f);if(c||d.error)e.append(this.renderNoData(d.error?"error":"large","Check Back Later")),this.el.append(b.DB.DIV("statistics",e));else{c=b.DB.DIV("chart-container clear line");f=this.currentPanel.viewPeriod;f.charAt(0).toUpperCase();f.slice(1);var h;d&&0<d.trafficBySegment.length&&(h=b.DB.DIV("summary line clear",this.renderSummary(d.viewsTotal,d.viewsAverage,"avg","Page Views",!0).addClass("page-views-summary"),
this.renderSummary(d.visitsTotal,d.visitsAverage,"avg","Visits",!0).addClass("visits-summary"),this.renderSummary(d.visitorsTotal,d.visitorsAverage,"avg","Audience Size",!0).addClass("visitors-summary")));e.append(c).append(h);this.el.append(b.DB.DIV("statistics",e));e=b.DB.DIV("traffic-details clear");f=b.DB.DIV("detail overview");0<d.trafficBySegment.length&&(g=b.DB.DIV("table"),(new b.Squarespace.BarTable({data:d.trafficBySegment.reverse(),key:"timePeriodShort",values:["views","visits","visitors"],
valueNameMap:{views:"page views",visits:"visits",visitors:"audience size"},toolTips:{views:"Number of hits on your site.",visits:"Number unique visits on your site.",visitors:"Number of unique visitors on your site."}})).render(g),f.append(g));e.append(f);f=b.DB.DIV("analyses");0<d.trafficBySegment.length&&(f.append(this.renderAnalysis("Browsers",d.browsers,"browser")),f.append(this.renderAnalysis("Operating Systems",d.os,"os")));e.append(f);this.el.append(e);h&&(new b.Squarespace.ToolTip({target:".visitors-summary",
title:"Audience Size",body:"Audience Size (sometimes called Unique Visitors) is an estimate of the total number of distinct people that reached your site within a certain time period. This metric is tracked using a browser cookie with a 2-year expiration time."}),new b.Squarespace.ToolTip({target:".page-views-summary",title:"Page Views",body:"Page views tracks how many actual page requests your site saw within a certain time period. Requests for individual images and other scripts are not counted as raw hits \u2014 only full page loads are."}),
new b.Squarespace.ToolTip({target:".visits-summary",title:"Visits",body:"Visits tracks a series of requests from the same uniquely identified individual (a visitor) in a set period of time. A visit is made up of several page views. Squarespace tracks visits by setting a browser cookie with a 30-minute expiration. Any hits within a 30-minute browsing session are tracked as a single visit."}));this.renderOverviewChart(d,c,this.currentPanel.viewPeriod)}},renderDeviceOverview:function(d){var c=!d.deviceBySegment||
0===d.deviceBySegment.length,e=b.DB.DIV("panel-top-container clear"),f=this.renderPanelTitle("Mobile Usage"),g=this.renderViewingPeriod(this.currentPanel,b.bind(this.viewMenuItem,this,this.currentPanel.name),["day","month","week","year"],["Hourly","Daily","Weekly","Monthly"]);f.append(g);e.append(f);if(c||d.error)e.append(this.renderNoData(d.error?"error":"large","Check Back Later")),this.el.append(b.DB.DIV("statistics",e));else{c=b.DB.DIV("chart-container clear line");f=this.currentPanel.viewPeriod;
f.charAt(0).toUpperCase();f.slice(1);var h;d&&0<d.deviceBySegment.length&&(f=d.desktopTotal+d.mobileTotal,0===f&&(f=1),h=b.DB.DIV("summary line clear",this.renderSummary((100*(d.desktopTotal/f)).toFixed(2),d.desktopTotal,"total","Desktop",!0).addClass("desktop-summary"),this.renderSummary((100*(d.mobileTotal/f)).toFixed(2),d.mobileTotal,"total","Mobile",!0).addClass("mobile-summary")));e.append(c).append(h);this.el.append(b.DB.DIV("statistics",e));e=b.DB.DIV("traffic-details clear");g=b.DB.DIV("detail overview");
if(d)for(var k=0;k<d.deviceBySegment.length;k++)f=d.deviceBySegment[k].desktop+d.deviceBySegment[k].mobile,0===f&&(f=1),d.deviceBySegment[k].desktop=(100*(d.deviceBySegment[k].desktop/f)).toFixed(2),d.deviceBySegment[k].mobile=(100*(d.deviceBySegment[k].mobile/f)).toFixed(2);0<d.deviceBySegment.length&&(f=b.DB.DIV("table mobile-usage"),(new b.Squarespace.BarTable({data:d.deviceBySegment.reverse(),key:"timePeriodShort",values:["desktop","mobile"],valueNameMap:{desktop:"desktop",mobile:"mobile"},toolTips:{desktop:"Percentage of pageviews originating from a desktop device.",
mobile:"Percentage of pageviews originating from a mobile device."}})).render(f),g.append(f));e.append(g);f=b.DB.DIV("analyses");0<d.deviceBySegment.length&&(f.append(this.renderAnalysis("Desktop OS",d["desktop os"],"os")),f.append(this.renderAnalysis("Mobile OS",d["mobile os"],"os")));e.append(f);this.el.append(e);h&&(new b.Squarespace.ToolTip({target:".desktop-summary",title:"Desktop",body:"Percentage of pageviews originating from a desktop device."}),new b.Squarespace.ToolTip({target:".mobile-summary",
title:"Mobile",body:"Percentage of pageviews originating from a mobile device."}));this.renderDeviceOverviewChart(d,c,this.currentPanel.viewPeriod)}},renderSubscribers:function(d){function c(b){return b.replace(/[^a-z0-9]/g,function(b){var c=b.charCodeAt(0);return 32==c?"-":65<=c&&90>=c?"_"+b.toLowerCase():"__"+("000"+c.toString(16)).slice(-4)})}this.currentPanel.data=d;var e=this.currentPanel.tabName;d&&(d.blogs&&!d.blogs[e]&&d.blogs.All)&&(this.currentPanel.tab="all",e=this.currentPanel.tabName=
"All");var f=!d||!d.blogs||!d.blogs[e]||!d.blogs[e].trafficBySegment||0===d.blogs[e].trafficBySegment.length,g=b.DB.DIV("panel-top-container clear"),h=this.renderPanelTitle("Subscribers"),k=this.renderViewingPeriod(this.currentPanel,b.bind(this.viewMenuItem,this,this.currentPanel.name),["month","week","year"],["Daily","Weekly","Monthly"]);h.append(k);g.append(h);if(d&&d.blogs){var h=["all"],k=["All"],l;for(l in d.blogs)"all"!==l.toLowerCase()&&(h.push(c(l)),k.push(l));l=this.renderSubscriberTabs(this.currentPanel,
b.bind(this.viewMenuItem,this,this.currentPanel.name),h,k);g.append(l)}f||d.error?(g.append(this.renderNoData(d.error?"error":"large","Check Back Later")),this.el.append(b.DB.DIV("statistics",g))):(f=b.DB.DIV("chart-container clear line"),l=this.currentPanel.viewPeriod,l=l.charAt(0).toUpperCase()+l.slice(1),g.append(f),this.el.append(b.DB.DIV("statistics",g)),g=b.DB.DIV("details-description",{html:"Subscribers is an estimate of the number of unique active subscribers you have for each RSS feed on your site.&nbsp;&nbsp;Squarespace attempts to count individual subscriber requests as well as requests from popular news readers."}),
this.el.append(g),g=b.DB.DIV("subs-details clear"),l=b.DB.DIV("detail overview"),0<d.blogs[e].trafficBySegment.length&&(h=b.DB.DIV("table"),(new b.Squarespace.BarTable({data:d.blogs[e].trafficBySegment.reverse(),key:"timePeriodShort",values:["subs"],valueNameMap:{subs:"subscribers"}})).render(h),l.append(h)),g.append(l),l=b.DB.DIV("analyses"),0<d.blogs[e].trafficBySegment.length&&l.append(this.renderAnalysis("Feed Readers",d.blogs[e],"bot",!1)),g.append(l),this.el.append(g),this.renderSubscribersChart(d.blogs[e],
f,this.currentPanel.viewPeriod))},renderAnalysis:function(d,c,e,f){function g(b,c){return c.count-b.count}var h=b.DB.DIV("analysis clear");if(c.summaries&&0<c.summaries.length)(new b.Squarespace.WeightedList({data:c.summaries.sort(g),key:"percentage",label:e,valueLabel:!1===f?null:"count",range:[14,22],formatter:function(b){return b.percentage.toFixed(2)+"%"},title:d})).render(h);else return null;return h},renderViewingPeriod:function(d,c,e,f){c=b.DB.DIV("settings-filters tabs");for(var g=b.bind(function(c){console.log("updateViewing");
d.viewPeriod=c;this.clearPanel();this.currentPanel.viewPeriod=c;b.bind(this.currentPanel.get,this)();d.menuEl.one(".description")},this),h=0;h<e.length;++h){var k=e[h],l=b.DB.DIV("filter view-period",{id:"viewing-"+k,html:f[h]+" "});c.append(l);this.panelEvents.push(l.on("click",b.bind(g,this,k)))}c.one("#viewing-"+d.viewPeriod).addClass("active");return c},renderSubscriberTabs:function(d,c,e,f){c=b.DB.DIV("settings-filters tabs");for(var g=b.bind(function(c,e){d.tab=c;this.clearPanel();this.currentPanel.tab=
c;this.currentPanel.tabName=e;b.bind(this.renderSubscribers,this,this.currentPanel.data)();d.menuEl.one(".description")},this),h=0;h<e.length;++h){var k=e[h],l=b.DB.DIV("filter view-tab",{id:"tab-"+k,html:f[h]+" "});c.append(l);this.panelEvents.push(l.on("click",b.bind(g,this,k,f[h])))}c.one("#tab-"+d.tab).addClass("active");return c},renderNoData:function(d){var c="error"===d?"Statistics Server Unavailable":"No Data Available",e=b.DB.DIV("no-data "+d),c=b.DB.DIV("container "+d,b.DB.DIV({html:c}));
e.append(c);"small"===d?c.prepend(b.DB.IMG("icon small",{src:"/universal/images-v6/configuration/stats-nodata-small.png"})):"large"===d?c.prepend(b.DB.IMG("icon large",{src:"/universal/images-v6/configuration/stats-nodata-large.png"})):"error"===d?c.prepend(b.DB.IMG("icon large",{src:"/universal/images-v6/configuration/stats-no-server.png"})):c.prepend(b.DB.IMG("icon",{src:"/universal/images-v6/configuration/stats-nodata.png"}));c.append(b.DB.DIV("description",{html:"Please try again in a moment."}));
return e},renderOverviewChart:function(d,c,e){if(0===d.trafficBySegment.length)c.append(this.renderNoData());else{var f={font:"Helvetica Neue","font-size":"10px",fill:"#a3a3a3"},g={"letter-spacing":"1px",font:"Helvetica Neue","font-weight":700,"font-size":"7px",fill:"#fff"};c={targetContainer:b.Node.getDOMNode(c),gridColor:"#e9e9e9",width:716,height:235,animate:!0,yAxisLabelStyle:f,labelFunc:function(b,c,e,d){var h=b.text(c,e-2,d.text).attr(f).toBack();d.image&&b.image(d.image,c-10,e+h.getBBox().height-
2,20,15);d.subText&&(e=e+h.getBBox().height+2,c=b.text(c,e+3,d.subText).attr(g).getBBox(),b.rect(c.x-2,c.y-3,c.width+4,c.height+6).attr({stroke:"#c6c6c6",fill:"#c6c6c6"}).toBack())},labels:[],lines:[]};var h={title:"Audience Size",fillStyle:{fill:"#c4c4c4",opacity:0.4},lineStyle:{stroke:"#222222","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#333"},data:[]},k={title:"Visits",fillStyle:{fill:"#949494",opacity:0.8},lineStyle:{stroke:"#828282","stroke-width":2,"stroke-linejoin":"round"},
dotStyle:{fill:"#fff",stroke:"#797979"},data:[]},l={title:"Page Views",lineStyle:{stroke:"#dfdfdf","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#bbb"},data:[]};c.lines=[h,k,l];var p="";d=d.trafficBySegment.reverse();for(var q=0;q<d.length;++q){var r=d[q],s=null,t=this.formatShortDate(r,e),s={text:t.primary,flyout:r.timePeriodShort},t=t.secondary.toUpperCase();t!==p&&(p=s.subText=t);s.toString=function(){return this.flyout};c.labels.push(s);h.data.push(r.visitors);k.data.push(r.visits);
l.data.push(r.views)}new b.Squarespace.Graphing.LineChart(c)}},renderDeviceOverviewChart:function(d,c,e){if(0===d.deviceBySegment.length)c.append(this.renderNoData());else{var f={font:"Helvetica Neue","font-size":"10px",fill:"#a3a3a3"},g={"letter-spacing":"1px",font:"Helvetica Neue","font-weight":700,"font-size":"7px",fill:"#fff"};c={targetContainer:b.Node.getDOMNode(c),gridColor:"#e9e9e9",width:716,height:235,animate:!0,yAxisLabelStyle:f,labelFunc:function(b,c,e,d){var h=b.text(c,e-2,d.text).attr(f).toBack();
d.image&&b.image(d.image,c-10,e+h.getBBox().height-2,20,15);d.subText&&(e=e+h.getBBox().height+2,c=b.text(c,e+3,d.subText).attr(g).getBBox(),b.rect(c.x-2,c.y-3,c.width+4,c.height+6).attr({stroke:"#c6c6c6",fill:"#c6c6c6"}).toBack())},labels:[],lines:[]};var h={title:"Mobile",fillStyle:{fill:"#c4c4c4",opacity:0.4},lineStyle:{stroke:"#222222","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#333"},data:[]},k={title:"Desktop",fillStyle:{fill:"#949494",opacity:0.8},lineStyle:{stroke:"#828282",
"stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#797979"},data:[]};c.lines=[h,k];c.is_percentage=!0;var l="";d=d.deviceBySegment.reverse();for(var p=0;p<d.length;++p){var q=d[p],r=null,s=this.formatShortDate(q,e),r={text:s.primary,flyout:q.timePeriodShort},s=s.secondary.toUpperCase();s!==l&&(l=r.subText=s);r.toString=function(){return this.flyout};c.labels.push(r);k.data.push(q.desktop);h.data.push(q.mobile)}new b.Squarespace.Graphing.LineChart(c)}},renderSubscribersChart:function(d,
c,e){if(0===d.trafficBySegment.length)c.append(this.renderNoData());else{var f={font:"Helvetica Neue","font-size":"10px",fill:"#a3a3a3"},g={"letter-spacing":"1px",font:"Helvetica Neue","font-weight":700,"font-size":"7px",fill:"#fff"};c={targetContainer:b.Node.getDOMNode(c),gridColor:"#e9e9e9",width:716,height:235,animate:!0,yAxisLabelStyle:f,labelFunc:function(b,c,e,d){var h=b.text(c,e-2,d.text).attr(f).toBack();d.image&&b.image(d.image,c-10,e+h.getBBox().height-2,20,15);d.subText&&(e=e+h.getBBox().height+
2,c=b.text(c,e+3,d.subText).attr(g).getBBox(),b.rect(c.x-2,c.y-3,c.width+4,c.height+6).attr({stroke:"#c6c6c6",fill:"#c6c6c6"}).toBack())},labels:[],lines:[]};var h={title:"Subscribers",fillStyle:{fill:"#c4c4c4",opacity:0.4},lineStyle:{stroke:"#222222","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#333"},data:[]};c.lines=[h];var k="";d=d.trafficBySegment.reverse();for(var l=0;l<d.length;++l){var p=d[l],q=null,r=this.formatShortDate(p,e),q={text:r.primary,flyout:p.timePeriodShort},
r=r.secondary.toUpperCase();r!==k&&(k=q.subText=r);q.toString=function(){return this.flyout};c.labels.push(q);h.data.push(p.subs)}new b.Squarespace.Graphing.LineChart(c)}},renderStandardPieChart:function(d,c,e){(new b.Squarespace.PieChart({data:d.slice(0,10),key:"percentage",formatter:e,radius:100,range:["#222","#eee"]})).render(c)},renderReferrersChart:function(d,c){this.renderStandardPieChart(d.summaries,c,b.bind(function(b){return b.domain},this))},renderPopularContentChart:function(d,c){this.renderStandardPieChart(d.summaries,
c,b.bind(function(b){return b.page},this))},renderSearchEngineChart:function(d,c){this.renderStandardPieChart(d.summaries,c,b.bind(function(b){return b.searchQuery+(b.searchEngine?" ("+b.searchEngine+")":"")},this))},renderPercentDiv:function(d,c){var e=b.DB.DIV("cell-fill",b.DB.DIV("value",{html:this.formatNumber(d)})),f=Math.round(100*(d/c));e.setStyle("width",f+"%");return e},renderDateCell:function(d,c){var e=b.DB.DIV("date block-container",b.DB.DIV({html:d.primary}));d.secondary!==c?e.prepend(b.DB.DIV("date block",
{html:d.secondary.toUpperCase()})):e.prepend(b.DB.DIV("date padding"));return e},renderSummary:function(d,c,e,f,g){if(!g&&0===d)return null;g=b.DB.DIV("item clear");d=b.DB.DIV("clear",b.DB.DIV("big-number float-left",{html:this.formatNumber(d)}));g.append(d);null!==c&&0!==c&&d.append(b.DB.DIV("float-left average",b.DB.DIV("text tiny",{html:e}),b.DB.DIV("small-number",{html:"/"+this.formatNumber(c)})));g.append(b.DB.DIV("text",{html:f}));return g},renderPeriodChange:function(d,c){var e=null,e=0>c.change?
b.DB.IMG({src:"/universal/images-v6/configuration/stats-down.png",width:10,height:7}):0<c.change?b.DB.IMG({src:"/universal/images-v6/configuration/stats-up.png",width:10,height:7}):b.DB.IMG({src:"/universal/images-v6/configuration/stats-still.png",width:10,height:7});d.set("innerHTML"," "+c.value);d.prepend(e)},showActivitySearchDialog:function(d){this.currentDialog||(d=this.currentDialog=new b.Squarespace.EditingDialog({sitleTitle:"Search",width:340,style:"flyout",anchor:d,overlay:0.5,buttons:[{type:"cancel",
title:"Cancel"},{type:"remove",title:"Reset"},{type:"saveAndClose",title:"Search"}],initialData:this.currentPanel.searchDialogData,primaryTabs:[{title:"Search Activity Log",icon:"/universal/images-v6/configuration/stats-search-queries-white.png",scroll:!1,fields:[{type:"text",required:!1,name:"visitor",title:"Visitor Filter",fieldStyle:"normal",style:"major",defaultValue:""},{type:"text",required:!1,name:"activity",title:"Activity Filter",fieldStyle:"normal",style:"major",defaultValue:""},{type:"text",
required:!1,name:"referrer",title:"Referrer Filter",fieldStyle:"normal",style:"major",defaultValue:""},{ctor:b.Squarespace.DialogFields.Stateflow,config:{width:0.5,direction:"up",style:"major",name:"startDate",defaultValue:"",states:{any:{title:"Any Start Date",optionDesc:"",stateDesc:"Any start date."},after:{title:"After Date",optionDesc:"Begin date.",stateDesc:"After [DATE]."}},stateOrder:["any","after"]}},{ctor:b.Squarespace.DialogFields.Stateflow,width:0.5,direction:"up",style:"major",name:"endDate",
defaultValue:"",states:{now:{title:"Now",optionDesc:"Before now.",stateDesc:"Before now."},before:{title:"Before Date",optionDesc:"End Date.",stateDesc:"Before [DATE]."}},stateOrder:["now","before"]}]}]}),d.on("send-requested",function(){var b=this.currentPanel.searchDialogData=this.currentDialog.getData(),e={visitorFilter:b.visitor,activityFilter:b.activity,referrerFilter:b.referrer};"after"===b.startDate.state&&(e.startDate=b.startDate.date);"before"===b.endDate.state&&(e.endDate=b.endDate.date);
this.currentPanel.searchParams=e;this.currentPanel.page=1;this.currentDialog.close();this.refreshPanel()},this),d.on("remove-requested",function(){this.currentPanel.searchDialogData={};this.currentDialog.setData({})},this),d.on("cancel",function(){this.currentDialog=null},this),d.on("close",function(){this.currentDialog=null},this),d.show())},trimEnd:function(b,c){c=c||50;return b.length>c?b.substring(0,c)+"...":b},parseTargetName:function(b){var c=/\((\w+)\)/.exec(b);return c&&2<=c.length&&c.index?
{title:b.substring(0,c.index),collectionType:c[1].substring(0,1).toUpperCase()+c[1].substring(1)}:{title:b,collectionType:""}},formatTargetName:function(b){b=this.parseTargetName(b);return b.title+(""!==b.collectionType?" ("+b.collectionType+")":"")},formatAndTruncateTargetName:function(b,c){var e=this.formatTargetName(b);return this.truncWithEllipsis(e,c||20)},truncWithEllipsis:function(b,c){c=c||20;return b.length>c?b.slice(0,c-3)+"...":b},formatShortDate:function(b,c){var e={};if("month"===c||
"week"===c){var f=b.timePeriodShort.split(" ");e.primary=f[1];e.secondary=f[0]}else if("day"===c){var f=b.timePeriodShort.split(":")[0],g=b.timePeriodShort.split(" ")[1];e.primary=f;e.secondary=g}else"year"===c?(f=b.timePeriodLong.split(" ")[1],e.primary=b.timePeriodShort,e.secondary=f):e.primary=b.timePeriodShort;return e},formatNumber:function(d){return 0===d?"-":b.DataType.Number.format(d,{thousandsSeparator:",",decimalSeparator:"."})},mapCollectionTypeToIcon:function(d){d=d.toLowerCase();var c=
b.DB.IMG();return"gallery"===d?(c.setAttribute("src","/universal/images-v6/modules/gallery-sitemap.png"),c):"journal"===d?(c.setAttribute("src","/universal/images-v6/modules/journal-sitemap.png"),c):"page"===d?(c.setAttribute("src","/universal/images-v6/modules/page-sitemap.png"),c):"link"===d?(c.setAttribute("src","/universal/images-v6/modules/link-sitemap.png"),c):"twitter"===d?(c.setAttribute("src","/universal/images-v6/modules/twitter-sitemap.png"),c):"rss"===d?(c.setAttribute("src","/universal/images-v6/modules/rss-sitemap.png"),
c):null}});b.namespace("Squarespace.ConfigurationPanelRenderers");b.Squarespace.ConfigurationPanelRenderers.dashboard=b.Squarespace.DashboardManager},"1.0",{requires:"anim cookie datatype-number json node oop squarespace-accordion squarespace-charts squarespace-dialog-stateflow squarespace-dombuilder squarespace-graphing squarespace-numeric-badge squarespace-panel-manager squarespace-settings-activity-detailed-activity squarespace-settings-activity-mobile-usage squarespace-settings-activity-popular-content squarespace-settings-activity-referrers squarespace-settings-activity-search-queries squarespace-settings-activity-subscribers squarespace-settings-activity-timeline squarespace-settings-activity-traffic-overview squarespace-settings-comments squarespace-spinner squarespace-stats-dashboard-view squarespace-stats-timeline-view squarespace-tray squarespace-ui-base".split(" ")});
YUI.add("squarespace-dialog-datetime-picker",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.DateTimePicker=b.Base.create("dataTimePicker",b.Squarespace.DialogField2,[],{initializer:function(c){this._suppressErrors=!1;this._picker=new b.Squarespace.DialogFields.StateScheduler({data:this.get("data"),type:"date",direction:this.get("direction"),maximumDate:this.get("maximumDate"),targetNode:this.get("contentBox"),allowNever:!1,visible:!1})},destructor:function(){this._picker&&
this._picker.destroy()},renderUI:function(){d.superclass.renderUI.call(this);this._picker.render(this.get("contentBox").ancestor("body")||b.one("body"));this._setTimePickerVisiblity()},bindUI:function(){d.superclass.bindUI.call(this);this._bindCalendarToggleEvents();this._picker.after("dataChange",this._updateData,this);this.after("dataChange",this._updatePickerData,this);this.on("dataChange",function(b){this.get("validator").call(this,b.newVal)?this.hideError():(b.halt(),this._suppressErrors||this.showError(this.get("strings.errorMessage")))},
this)},_bindCalendarToggleEvents:function(){this.get("contentBox").delegate("click",this._handleActiveAreaClick,".sqs-datetime-picker-date",this);this._registerEvent(this._picker.get("contentBox").on("clickoutside",function(b){b.target!==this.get("contentBox").one(".sqs-datetime-picker-date")&&this._hidePicker()},this))},isValid:function(){return 0===this.get("errors").length},_updateData:function(b){this.set("data",b.newVal)},_updatePickerData:function(b){this._suppressErrors=!0;this._picker.set("data",
b.newVal);this._suppressErrors=!1},syncUI:function(){d.superclass.syncUI.call(this);this._updateTitle(this.get("data"));this._updateDescription(this.get("data"))},_handleActiveAreaClick:function(b){this._showPicker(b.currentTarget)},_showPicker:function(b){this._picker.set("visible",!0);this._picker.set("data",this.get("data"));this._alignPicker(b)},_alignPicker:function(b){b=b||this.get("defaultPositionNode");var e=this._picker.get("boundingBox"),d=this.get("direction"),g=b.get("region"),h=g["1"],
g=g["0"]-(e.one(".workflow-flyout").get("offsetWidth")-g.width)/2;"down"===d?(h+=b.get("offsetHeight"),h-=parseInt(e.getStyle("marginTop"),10)):(h-=e.get("offsetHeight"),h-=parseInt(e.getStyle("marginBottom"),10));e.setStyles({top:h,left:g,position:"absolute"})},_hidePicker:function(){this._picker.get("visible")&&this.isValid()&&(this._picker.set("visible",!1),this.hideError())},_updateDescription:function(b){var e=this.get("contentBox");b=this._getDescriptionText(new Date(b));e.one(".sqs-datetime-picker-description").empty().append(b)},
_updateTitle:function(b){var e=this.get("contentBox");b=this._getTitleText(new Date(b));e.one(".sqs-datetime-picker-title").empty().append(b)},_setTimePickerVisiblity:function(){var b=this._picker.get("contentBox"),e=this.get("timePickerEnabled");b.toggleClass("sqs-datetime-picker-time-disabled",!e)},_getDateEl:function(c){return'<span class="sqs-datetime-picker-date">'+b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,{format:this.get("dateFormat")}))+"</span>"},_getDescriptionText:function(c){c=
this._getDateEl(c);c=this.get("strings.description").replace("[DATE]",c);return b.Node.create('<span class="sqs-datetime-picker-date-wrapper">'+c+"</span>")},_getTitleText:function(c){c=this._getDateEl(c);c=this.get("strings.title").replace("[DATE]",c);return b.Node.create('<span class="sqs-datetime-picker-title-content">'+c+"</span>")}},{CSS_PREFIX:"sqs-datetime-picker",TEMPLATE:'<div class="sqs-datetime-picker-title"></div><div class="sqs-datetime-picker-description"></div>',ATTRS:{data:{setter:function(c){return b.Lang.isDate(c)?
c.getTime():b.Lang.isNumber(c)?c:b.Attribute.INVALID_VALUE}},dateFormat:{value:"%a, %b %d %Y at %I:%M%p"},defaultPositionNode:{getter:function(){return this.get("boundingBox").one(".sqs-datetime-picker-date")||this.get("boundingBox")}},direction:{value:"down",getter:function(b){var e=["down","up"];return-1===e.indexOf(b)?e[0]:b}},errorFlyoutAnimationTime:{value:0.01},maximumDate:{},timePickerEnabled:{value:!0},strings:{value:{description:"[DATE]",title:"",errorMessage:""}},validator:{value:function(){return!0},
validator:b.Lang.isFunction}}})},"1.0",{requires:["base","squarespace-dialog-field-2","squarespace-ss-widget"]});
YUI.add("squarespace-widgets-inventory",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.Inventory=b.Base.create("Inventory",b.Squarespace.Widgets.ModelList,[],{},{CSS_PREFIX:"sqs-inventory",ATTRS:{defaultChildType:{value:b.Squarespace.Widgets.InventoryProduct},strings:{value:{modelName:"product"}},emptyStateIconSrc:{value:"/universal/images-v6/configuration/no-products.png"}}})},"1.0",{requires:["base","node","squarespace-widgets-inventory-product","squarespace-widgets-model-list"]});
YUI.add("squarespace-stats-block-gauge",function(b){var d=b.namespace("Squarespace.Views.Stats").Gauge=b.Base.create("gauge",b.Squarespace.Views.Stats.Summary,[],{template:"stats-block-gauge.html",_bindUI:function(){d.superclass._bindUI.apply(this,arguments);var b=this.get("id");this.after(b+"|dataChange",this._renderChart,this)},_renderDefaultState:function(b){d.superclass._renderDefaultState.apply(this,arguments);this.set("data",b.summary)},_setTrendClass:function(){var b=this.get("container");
b.hasClass("positive-trend")||b.addClass("positive-trend")},_renderChart:function(){function c(b){b=180*(b/g)*Math.PI/180;return b>Math.PI?Math.PI:b}function e(b,c){var e=180*(b/g)*Math.PI/180;return{x:p*c*Math.cos(e),y:p*c*Math.sin(e)}}var d=this.get("data"),g=0===d.average?1:d.average/0.7,h=this.get("container"),k=h.one(".graphic"),l=k.get("offsetWidth")||h.get("offsetWidth"),h=k.get("offsetHeight")||h.get("offsetHeight"),p=Math.min(l-15,h-15)-15,k=d3.select(k.getDOMNode()).append("svg"),q=d3.svg.arc().startAngle(0).outerRadius(p);
k.datum(d).attr("width",l).attr("height",h).attr("class","gauge chart");d=k.append("g").attr("transform","rotate(270)").attr("transform","translate("+l/2+","+(h-15)+")");d.append("path").attr("class","full").attr("transform","rotate(270)").attr("d",q.endAngle(Math.PI));d.append("path").attr("class","amount").attr("transform","rotate(270)").attr("d",function(b,e){return q.endAngle(c(b.total))(b,e)});d.append("path").attr("class","needle").attr("transform","rotate(180)").attr("d",function(b,c){var d;
d=b.total>g?g:b.total;var f=g/32,h=e(d,1),k=e(d-f,0.35);d=e(d+f,0.35);h=[h,k,d,h];return d3.svg.line().x(function(b){return b.x}).y(function(b){return b.y})(h)});d.append("path").attr("class","average").attr("transform","rotate(270)").attr("d",function(b,e){if(0===b.average)return null;var d=c(b.average);return q.startAngle(d).endAngle(d)(b,e)});d.append("text").attr("class","label display-avg").text(function(b,c){return 0<b.average?"AVG":""}).attr("transform",function(b,c){var d=e(b.average,1);return"translate("+
(Math.abs(d.x)+5)+","+(-d.y-5)+")"});d.append("path").attr("class","inner").attr("transform","rotate(270)").attr("d",d3.svg.arc().outerRadius(0.35*p).startAngle(0).endAngle(Math.PI));d.append("text").attr("class","label display-amount").text(function(c,e){var d;d=c.total;if(b.Lang.isUndefined(d))d="Err";else{var f=0,g="";1E9<=d?(d/=1E9,f=2,g="B"):1E8<=d?(d/=1E6,f=0,g="M"):1E7<=d?(d/=1E6,f=1,g="M"):1E6<=d?(d/=1E6,f=2,g="M"):1E5<=d?(d/=1E3,g="K",f=0):1E4<=d&&(d/=1E3,g="K",f=1);d=b.DataType.Number.format(d,
{prefix:"",decimalSeparator:".",thousandsSeparator:",",decimalPlaces:f,suffix:g})}return d})}},{CSS_PREFIX:"sqs-gauge",ATTR:{data:{value:null}}})},"1.0",{requires:["base-base","squarespace-stats-block-view","squarespace-stats-block-gauge-template","thirdparty-d3"]});
YUI.add("squarespace-dialog-multi-option",function(b){var d=b.namespace("Squarespace.DialogFields").MultiOption=b.Base.create("multiOption",b.Squarespace.DialogField2,[],{initializer:function(c){this.get("data");!this.get("data")&&!b.Lang.isUndefined(c.defaultValue)&&this.set("data",c.defaultValue);this._selectedOptionEl=null},renderUI:function(){d.superclass.renderUI.call(this);this._calculateMargins();this._renderTitle();this._renderOptions()},bindUI:function(){this.get("contentBox").delegate("click",
this._onOptionClick,".option",this);this.after("optionsChange",this._renderOptions,this);this.after("stringsChange",this._renderTitle,this)},syncUI:function(){d.superclass.syncUI.call(this);this._setupOptionWidths()},getBBInnerWidth:function(){var b=this.get("boundingBox");return b.get("offsetWidth")-(parseInt(b.getComputedStyle("paddingLeft"),10)+parseInt(b.getComputedStyle("paddingRight"),10))},selectOption:function(b){this.get("contentBox").all(".option").each(function(e){this._optionMatchesData(e,
b)&&this._selectOption(e)},this)},addOption:function(b){b=this.get("options");b.push(optionOjb);this.set("options",b)},_renderTitle:function(){var c=this.get("strings.title"),e=this.get("contentBox"),d=e.one(".title");c&&b.Lang.isNull(d)?e.append(b.Node.create('<div class="title">'+this.get("strings.title")+"</div>")):c?d.setHTML(this.get("strings.title")):!c&&!b.Lang.isNull(d)&&d.remove()},_renderOptions:function(){var c=this.get("contentBox"),e=this.get("options"),d=this._getOptionWidth();c.all(".option").remove();
b.Array.each(e,function(e){if(e.section)c.append(b.Node.create('<div class="option-label">'+e.section+"</div>"));else{var h=b.Node.create(b.Lang.sub('<div class="option" data-value="{value}"><div class="option-content"><div class="option-title">{title}</div></div></div>',e));h.setData(e);h.setStyles({width:d});var k=e.description;k&&h.one(".option-content").append(b.Node.create('<div class="option-description">'+k+"</div>"));e.icon?h.addClass("icon-"+e.icon):h.addClass("no-icon");c.append(h);this._optionMatchesData(h)&&
this._markSelected(h);e.upgradeLocked&&(h.addClass("upgrade-locked"),new b.Squarespace.ToolTip({target:".option.upgrade-locked",title:"Upgrade to Connect",body:"You must be on the Business Plan to use this feature.",dialogTooltip:!0,showTimeout:350}),h.on("click",function(){(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Do you want to upgrade?","strings.message":"Upgrading to the Business Plan will enable this feature."})).on("confirm",
e.upgradeConfirmCb)}))}},this)},_selectOptions:function(){this.get("contentBox").all(".option").each(function(b){this._optionMatchesData(b)&&this._selectOption(b)},this)},_optionMatchesData:function(c,e){b.Lang.isUndefined(e)&&(e=this.get("data"));var d=c.getData("value");if(this.get("numeric"))return e===b.Number.parse(d);b.Lang.isObject(d)&&b.Lang.isObject(e)&&console.warn("Trying to compare to objects, which is a bit out of scope.");return e===d},_onOptionClick:function(c){c.halt();c=c.target.hasClass("option")?
c.target:c.target.ancestor(".option");var e=this.get("optionClickCb");c.hasClass("upgrade-locked")||this._selectOption(c);b.Lang.isFunction(e)&&e(this.get("data"))},_markSelected:function(b){b!=this._selectedOptionEl&&(this._selectedOptionEl&&this._selectedOptionEl.removeClass("selected"),b.addClass("selected"),this._selectedOptionEl=b)},_selectOption:function(c){if(c!=this._selectedOptionEl){this._markSelected(c);c=c.getData("value");if(this.get("numeric")){var e=b.Number.parse(c);b.Lang.isNumber(e)&&
(c=e)}this.set("data",c);this.get("submitOnSelect")&&(c=this.get("dialog"),b.Lang.isValue(c)&&c.saveAndClose())}},_getOptionWidth:function(){var c=this.get("optionWidth");if(b.Lang.isValue(c))return c;c=this.get("options");c=parseInt(this.get("columns"),10)||c.length;return this.getBBInnerWidth()/c-this.get("marginOffset")},_calculateMargins:function(){var c=b.Node.create('<div class="option" style="visibility:hidden;"></div>');this.get("contentBox").append(c);var e=parseInt(c.getStyle("marginLeft"),
10),d=parseInt(c.getStyle("marginRight"),10);this.set("marginOffset",e+d);c.remove()},_setupOptionWidths:function(){var b=this.get("columns")||this.get("options").length;0<parseInt(b,10)&&this.get("boundingBox").addClass("columns-"+b);this.get("contentBox").all(".option").setStyle("width",this._getOptionWidth())}},{CSS_PREFIX:"sqs-multi-option",ATTRS:{data:{setter:function(c){return this.get("numeric")?b.Number.parse(c):c}},options:{value:null},optionClickCb:{value:null,setter:function(c){return!b.Lang.isFunction(c)?
null:c}},optionWidth:{value:null},submitOnSelect:{value:!1},columns:{value:null},marginOffset:{value:0,validator:b.Lang.isNumber},numeric:{value:!1,validator:b.Lang.isBoolean},readOnly:{value:!0}}})},"1.0",{requires:["base","datatype-number-parse","squarespace-dialog-field-2","squarespace-widgets-confirmation"]});
YUI.add("squarespace-content-item-types-mixin-custom-sanitizer",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.CustomSanitizer=b.Base.create("sanitizerMixin",b.Base,[],{sanitizeTemplateContextForCustomType:function(d,c){b.Lang.isValue(c)&&(d.presentationName=c.get("title"))},sanitizeConfigurationForCustomType:function(d,c,e){if(b.Lang.isValue(c)){var f=[],g=c.get("fields");b.Array.each(g,function(c,d){switch(c.type){case "text":f.push({$include:["fields.title",{"config.name":"custom-"+
c.name,"config.strings.title":c.title||"","config.strings.placeholder":""}]});break;case "checkbox":f.push({ctor:b.Squarespace.DialogFields.Check,config:{name:"custom-"+c.name,"strings.title":c.title}});break;case "wysiwyg":f.push({ctor:b.Squarespace.DialogFields.Description,config:{title:c.title||""}});f.push({ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"custom-"+c.name,toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:227,classNames:"major"}});break;case "image":(function(c){f.push({$include:["fields.mainImage",
{name:"custom-"+c.name,mode:b.Squarespace.UploadModes.CHILD,childType:b.Squarespace.RecordType.IMAGE,preflight:function(b){var d=e.get("model"),f=e.get("dialog").getField("custom-"+c.name);d.get("id")?b&&b():(d.once("save",function(){f.get("data").set("parentId",d.get("id"));f.refreshItemPostData();b&&b()}),e.autoSave())}}]})})(c);break;case "gallery":(function(c){f.push({ctor:b.Squarespace.DialogFields.Description,config:{title:c.title||""}});f.push({$include:["fields.childItemsGrid",{"config.width":null,
"config.height":170,"config.name":"custom-"+c.name,"config.uploadPreflight":function(b){var d=e.get("model"),f=e.get("dialog").getField("custom-"+c.name).get("data");d.get("id")?(f.set("id",d.get("id")),b()):(d.once("save",function(){f.set("id",d.get("id"));b()},d),e.autoSave())}}]})})(c)}},this);c={tabTitle:c.get("title"),name:c.get("name"),scroll:!0,fields:f};d.tabs.push(c)}},sanitizeDataForCustomType:function(d,c,e){if(b.Lang.isValue(c)){var f=c.get("fields");b.Lang.isObject(d.customContent)||
(d.customContent={customType:c.get("name")});b.Array.each(f,function(c,f){var k=c.name;switch(c.type){case "text":case "wysiwyg":case "checkbox":d.customContent[k]=d["custom-"+k];delete d["custom-"+k];break;case "image":d["custom-"+k].get("hasFileData")?d.customContent[k]=d["custom-"+k].getAttrs():delete d.customContent[k];delete d["custom-"+k];break;case "gallery":d.customContent[k]=e.get("dialog").getField("custom-"+k).get("data").get("items").toJSON();delete d["custom-"+k];break;default:b.Squarespace.Logger.log("Custom Type Saving Error",
{message:"Could not find anything for field.",field:c})}},this)}},setDataForCustomType:function(d,c,e){b.Lang.isValue(c)&&(c=c.get("fields"),b.Array.each(c,function(c,g){var h=c.type,k=c.name,l="custom"+k,k=b.Object.getValue(d,["customContent",k]);switch(h){case "text":case "wysiwyg":case "checkbox":d[l]=k;break;case "image":b.Lang.isValue(k)?d[l]=new b.Squarespace.Models.ContentItem(b.merge(k,{collectionId:e.get("model").get("collectionId"),parentId:e.get("model").get("id"),recordType:b.Squarespace.RecordType.IMAGE})):
d[l]=new b.Squarespace.Models.ContentItem({collectionId:e.get("model").get("collectionId"),parentId:e.get("model").get("id"),recordType:b.Squarespace.RecordType.IMAGE});break;case "gallery":h=new b.Squarespace.Models.ContentItem({id:e.get("model").get("id"),collectionId:e.get("model").get("collectionId"),recordType:b.Squarespace.RecordType.IMAGE});b.Lang.isValue(k)&&h.get("items").add(k);d[l]=h;break;default:b.Squarespace.Logger.log("Custom Type Saving Error",{message:"Could not find any data to set for field.",
field:c})}},this))}},{})},"1.0",{requires:"squarespace-content-item-types-enum-record-type squarespace-content-item-types-settings squarespace-content-item-utils squarespace-dialog-description squarespace-enum squarespace-logger squarespace-model-editor squarespace-models-content-collection squarespace-models-content-item squarespace-models-template".split(" ")});
YUI.add("squarespace-block-html",function(b){b.namespace("Squarespace.Block").Html=b.Base.create("block-html",b.Squarespace.Block.ParentBase,[],{initializer:function(d){this.contentHtml=this.add({childType:b.Squarespace.Content.Html,model:d.model,editable:d.editable}).item(0);this.set("model",this.contentHtml.get("model"))},renderUI:function(){this.contentHtml.render(this.get("contentBox"))},syncUI:function(){this.contentHtml.syncUI()},appendHTML:function(b){b=this.get("model").get("html").trim()+
b.trim();this.contentHtml.setContent(b)},isEmpty:function(){return!this.get("model").get("html")},toJSON:function(){return{type:this.get("type"),id:this.get("id"),value:this.contentHtml.toJSON()}}},{CSS_PREFIX:"sqs-block-html",MODEL:b.Squarespace.ContentModel.Html,ATTRS:{classNames:{value:"html-block"},type:{value:2},model:{getter:function(){return this.contentHtml.get("model")}},editor:{valueFn:function(){return b.Squarespace.Block.Editor.Html}},mobileEditor:{valueFn:function(){return b.Squarespace.Block.Editor.Html}},
emailEditor:{valueFn:function(){return b.Squarespace.Block.Editor.Html}},floatable:{value:!1}}})},"1.0",{requires:["squarespace-ss-widget","squarespace-block-base","squarespace-block-html-editor","squarespace-block-content-html","widget-parent"]});
YUI.add("squarespace-content-manager-plugin-sticky-header",function(b){b.namespace("Squarespace.Plugin");b.Squarespace.Plugin.StickyHeader=b.Base.create("stickyHeader",b.Plugin.Base,[],{initializer:function(){var b=this.get("host"),c=b.get("boundingBox");this._cb=b.get("contentBox");this._nodeList=[];this.afterHostMethod("addChild",this._interleaveHeaders,this);this.afterHostMethod("removeChild",this._interleaveHeaders,this);this.afterHostMethod("syncUI",this._interleaveHeaders,this);this.afterHostMethod("render",
this._initScroll,this);this.after("stateChange",this._syncState,this);this._renderHeaders();c.toggleClass("sqs-force-sticky",!this._hasNativeStickyPositioning());b.get("rendered")?this._interleaveHeaders():this.afterHostEvent("renderedChange",this._interleaveHeaders,this)},destructor:function(){this._deleteHeaders()},_syncState:function(b){this._deleteHeaders();this._renderHeaders()},_initScroll:function(d){d=this.get("scrollNode");b.Lang.isValue(d)&&d.after("scroll",this._syncHeaders,this)},_hasNativeStickyPositioning:function(){return b.Array.some(this._nodeList,
function(d){d=d.getStyle("position");return b.Lang.isString(d)&&-1!==d.indexOf("sticky")},this)},_deleteHeaders:function(){this._cb.all(".sqs-sticky-header").remove(!0)},_renderHeaders:function(){b.Array.each(this.get("states"),this._addState,this)},_addState:function(d,c){this._nodeList.push(b.Node.create('<div class="sqs-sticky-header sqs-stick-header-'+d.name+'"><div class="sqs-sticky-header-content">'+d.label+"</div></div>"))},_interleaveHeaders:function(){var d,c,e=":not(."+this.get("itemSelector")+
"-hidden)",f="."+this.get("itemSelector")+"-",g=this.get("states");b.Array.each(g,function(g,k){c=f+g.name+e;d=this._cb.one(c);var l=this._nodeList[k],p=b.Lang.isValue(d);l.toggleClass("hidden",!p);p?d.insert(l,"before"):this._cb.append(l)},this);this._setStyles()},_syncHeaders:function(b){this._setStyles()},_setStyles:function(){var d=this.get("scrollNode");if(b.Lang.isValue(d)&&!this._hasNativeStickyPositioning()){var c=d.get("region");b.Array.each(this._nodeList,function(b){b.setStyles({top:null});
var d=b.get("region").top;d<c.top&&b.setStyles({top:Math.floor(c.top-d)})},this)}},_getClosestScrollingAncestor:function(b){for(;(!b||!b.test("body"))&&"auto"!==b.getStyle("overflow");)b=b.get("parentNode");return b}},{NS:"StickyHeader",ATTRS:{scrollNode:{getter:function(d){return b.Lang.isValue(d)?d:this._getClosestScrollingAncestor(this.get("host").get("boundingBox"))}},states:{validator:b.Squarespace.AttrValidators.isArray,value:[]},itemSelector:{getter:function(d){return!b.Lang.isValue(d)?this.get("host").get("defaultChildType").CSS_PREFIX:
d}}}})},"1.0",{requires:["base","plugin","squarespace-attr-validators"]});
YUI.add("squarespace-form-builder-field-editor",function(b){var d={description:{ctor:b.Squarespace.DialogFields.TextArea,config:{name:"description","strings.description":"A description / instructions for this field.","strings.placeholder":"Description"}},required:{ctor:b.Squarespace.DialogFields.Check,config:{name:"required","strings.title":"Required"}},placeholder:{ctor:b.Squarespace.DialogFields.Text,config:{name:"placeholder",className:"thin","strings.placeholder":"Placeholder text"}},currencySymbol:{ctor:b.Squarespace.DialogFields.Text,
config:{name:"currencySymbol",className:"thin","strings.placeholder":"Currency symbol",maxLength:1}},showCountryCode:{ctor:b.Squarespace.DialogFields.Check,config:{name:"showCountryCode","strings.title":"Show Country Code"}},options:{ctor:b.Squarespace.DialogFields.TextArea,config:{name:"options","strings.placeholder":"Options","strings.description":"Enter options one per line."}},underline:{ctor:b.Squarespace.DialogFields.Check,config:{name:"underline","strings.title":"Underline"}},key:{ctor:b.Squarespace.DialogFields.Text,
config:{name:"key",className:"thin",disabled:!0,"strings.placeholder":"Key","strings.description":'<strong>This is a hidden field.</strong> Hidden fields can be used to collect variables from the URL in your form submissions. To fill in this field, include the variable from the box above in the query string for this page. <a target="_blank" href="'+b.Squarespace.HelpLinks.HIDDEN_FORM_FIELD+'">Read more here.</a>'}},value:{ctor:b.Squarespace.DialogFields.Text,config:{name:"value",className:"thin",
"strings.placeholder":"Default Value","strings.description":"If no value is passed through the query string, the default value above will be used."}}},c={text:["description","placeholder","required"],textarea:["description","placeholder","required"],email:["description","placeholder","required"],currency:["description","currencySymbol","required"],number:["description","placeholder","required"],website:["description","placeholder","required"],password:["description","required"],twitter:["description",
"required"],date:["description","required"],time:["description","required"],name:["description","required"],address:["description","required"],phone:["description","showCountryCode","required"],section:["description","underline"],radio:["description","options","required"],checkbox:["description","options","required"],select:["description","options","required"],likert:["description","options","required"],hidden:["key","value"]};b.namespace("Squarespace.Widgets");var e=b.Squarespace.Widgets.FormBuilderFieldEditor=
b.Base.create("FormBuilderFieldEditor",b.Squarespace.Widgets.SSWidget,[b.WidgetParent],{renderUI:function(){e.superclass.renderUI.call(this);var f=this.get("field");b.Array.each(c[f.type],function(c){var e=d[c],k=f[c];b.Lang.isValue(k)&&("options"===c&&(k=k.join("\n")),e.config.data=k);this.add(new e.ctor(e.config))},this)},bindUI:function(){e.superclass.bindUI.call(this);var c=this.get("field");this.each(function(e){var d=e.get("name");e.after("dataChange",function(e){e=e.newVal;"options"===d&&(e=
e.split("\n"),e=b.Array.map(e,function(b){return b.trim()}));c[d]=e;this.fire("change",{fieldName:d,data:e})},this)},this)}},{CSS_PREFIX:"sqs-form-builder-field-editor",ATTRS:{field:{value:null}}})},"1.0",{requires:"base node widget-parent squarespace-ss-widget squarespace-dialog-text squarespace-dialog-text-area squarespace-dialog-check squarespace-help".split(" ")});
YUI.add("squarespace-dialog-category-selector",function(b){var d=b.namespace("Squarespace.DialogFields").CategorySelector=b.Base.create("categorySelector",b.Squarespace.DialogField2,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox"),e=this.get("strings.title");e&&c.append(b.Node.create('<div class="title">'+e+"</div>"));e=b.Node.create('<div class="categories"></div>');c.append(e);this._set("errorFlyoutAnchor",e);var c=this.get("data"),f=this.get("categories");0===
f.length&&0===c.length?this._renderEmptyMessage(e):(this._renderInvalidCategories(e,c,f),this._renderValidCategories(e,f))},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").delegate("click",function(b){b=b.currentTarget;var e=b.getAttribute("data-name"),d=this.get("data");b.hasClass("selected")?(b.removeClass("selected"),d.splice(d.indexOf(e),1)):(b.addClass("selected"),d.push(e));this.set("data",d)},".category",this);this.after("dataChange",this.hideError,this)},_renderEmptyMessage:function(c){c.append(b.Node.create('<div class="no-categories">No product categories were found. You may add them directly to your products in the content manager.</div>'))},
_renderInvalidCategories:function(c,e,d){b.Array.each(e,function(e){-1===d.indexOf(e)&&(e=b.Node.create('<div class="category-wrapper"><div class="category selected invalid" data-name="'+e+'"><div class="category-name">'+e+" (Invalid)</div></div></div>"),c.append(e))},this)},_renderValidCategories:function(c,e){b.Array.each(e,function(e){var d=b.Node.create('<div class="category-wrapper"><div class="category" data-name="'+e+'"><div class="category-name">'+e+"</div></div></div>");-1!==this.get("data").indexOf(e)&&
d.one(".category").addClass("selected");c.append(d)},this)},_getErrors:function(){var b=[];1>this.get("data").length&&b.push("At least one category must be selected.");return b}},{CSS_PREFIX:"sqs-category-selector",ASYNC_DATA:!0,ATTRS:{icon:{value:!0},data:{value:[]},categories:{value:[]},categoriesPerRow:{value:3}}})},"1.0",{requires:["base","squarespace-dialog-field-2"]});
YUI.add("squarespace-widgets-alert",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.Alert=b.Base.create("alert",b.Squarespace.Widgets.Confirmation,[],{},{CSS_PREFIX:"sqs-widgets-confirmation",TYPE:b.Squarespace.Widgets.Confirmation.TYPE,ANCHOR:b.Squarespace.Widgets.Confirmation.ANCHOR,ATTRS:{className:{value:"alert"},style:{value:b.Squarespace.Widgets.Confirmation.TYPE.CONFIRM_ONLY},"strings.confirm":{value:"Okay"}}})},"1.0",{requires:["base","squarespace-widgets-confirmation"]});
YUI.add("squarespace-gallery-option-synchronizer",function(b){b.namespace("Squarespace").GalleryOptionSynchronizer=b.Base.create("galleryOptionSynchronizer",b.Base,[],{sync:function(d,c){var e=this.get("block"),f=c.details[0].get("name"),g=d.get("currentDesign"),h=["content-method-frame","autoplay"];switch(g){case "grid":-1!==["thumbnails-per-row","padding"].indexOf(f)&&(this.renderGridCSS(d.get("data")),this.refreshGallery(),h=h.concat(["thumbnails-per-row","padding"]));break;case "slideshow":-1!==
["thumbnail-strip-margin","thumbnail-strip-height"].indexOf(f)&&(this.renderSlideshowCSS(d.get("data")),h=h.concat(["thumbnail-strip-margin","thumbnail-strip-height"]))}var k=e.resizeVertically;e.resizeVertically="slider"===g;g=e.resizeVertically!==k;e.value=b.merge(e.value,d.get("data"));-1===h.indexOf(f)&&e.render();(-1!==["design","autoplay","thumbnails"].indexOf(f)||g)&&e.updateBlockSizing()},unsetVSize:function(){var b=this.get("block"),c=b.getBoundingEl();c.get("className").split(" ").filter(function(b){return b.startsWith("vsize-")}).forEach(function(b){c.removeClass(b)});
b.getBoundingEl().removeClass("sized");delete b.value.vSize},renderGridCSS:function(d){var c=this.get("block"),e=c.getBoundingEl().one(".sqs-gallery-container");if(e){var f=e.get("className").split(" "),g;b.Array.forEach(f,function(b){b.startsWith("sqs-gallery-thumbnails-per-row-")&&(g=b)});g&&e.removeClass(g);e.addClass("sqs-gallery-thumbnails-per-row-"+d["thumbnails-per-row"]);e="#block"+c.id+" .sqs-gallery-block-grid { margin-right: -{padding}px; } #block-"+c.id+" .sqs-gallery-block-grid .sqs-gallery-design-grid-slide .margin-wrapper { margin-right: {padding}px; margin-bottom: {padding}px; };";
(c=c.getBoundingEl().one("#design-grid-css"))&&c.setContent(b.substitute(e,d))}},renderSlideshowCSS:function(b){var c=this.get("block"),e=c.getBoundingEl();e&&(e.one(".sqs-gallery-thumbnails").setStyles({marginTop:b["thumbnail-strip-margin"],height:b["thumbnail-strip-height"]}),c.getBoundingEl().one(".sqs-gallery-thumbnails").getData("gallery")["gallery-design"].syncUI())},refreshGallery:function(){b.Squarespace.GalleryManager.initializeBlock(this.get("block").contentEl)}},{ATTRS:{block:{}}})},"1.0",
{requires:["base","base-build"]});
YUI.add("squarespace-stringset-utils-mixin",function(b){b.namespace("Squarespace.Mixins").StringSetUtils=b.Base.create("stringSetUtils",b.Base,[],{memberInSet:function(d,c,e){e&&(d=b.Array.map(d,function(b){return b.toLowerCase()}),c=c.toLowerCase());return-1!==b.Array.indexOf(d,c)},cleanMember:function(d){return b.Lang.trim(d.replace(RegExp("[,<>]","g"),""))},filterMember:function(d,c,e){return b.Array.filter(d,function(b){return e?b.toLowerCase()!==c.toLowerCase():b!==c})},diffStringSets:function(d,
c,e){var f=d,g=c;f.length<g.length&&(g=d,f=c);return b.Array.filter(f,function(b){return!this.memberInSet(g,b,e)},this)}},{})},"1.0",{requires:["base","squarespace-util"]});
YUI.add("squarespace-settings-activity-traffic-overview",function(b){b.namespace("Squarespace.Settings.Activity");b.Squarespace.Settings.Activity.TrafficOverview=b.Base.create("ActivityManagerTrafficOverview",b.Squarespace.Settings.Activity.BaseManager,[],{_isDataEmpty:function(d){return!b.Lang.isArray(d.trafficBySegment)||0===d.trafficBySegment.length},_renderSuccess:function(d){this.get("contentBox");var c=this.get("contentBody"),e=this.get("activeTab"),f=b.Node.create('<div class="chart-container clear line">');
c.append(f);this._isDataEmpty(d)||(c.append(this._getSummaryEl(d)),this._addToolTips());var g=this._getTableEl(d),h=this._getAnalysesEl(d),k=b.Node.create('<div class="traffic-details clear"></div>');k.append(g).append(h);c.append(k);this.renderOverviewChart(d,f,e)},_getTableEl:function(d){var c=b.Node.create('<div class="detail overview"></div>');if(0<d.trafficBySegment.length){var e=b.Node.create('<div class="table"></div>');(new b.Squarespace.BarTable({data:[].concat(d.trafficBySegment).reverse(),
key:"timePeriodShort",values:["views","visits","visitors"],valueNameMap:{views:"page views",visits:"visits",visitors:"audience size"},toolTips:{views:"Number of hits on your site.",visits:"Number unique visits on your site.",visitors:"Number of unique visitors on your site."}})).render(e);c.append(e)}return c},_getAnalysesEl:function(d){var c=b.Node.create('<div class="analyses"></div>');this._isDataEmpty(d)||(c.append(this.renderAnalysis("Browsers",d.browsers,"browser")),c.append(this.renderAnalysis("Operating Systems",
d.os,"os")));return c},_getSummaryEl:function(d){var c=b.Node.create('<div class="summary line clear">'),e=this.renderSummary(d.viewsTotal,d.viewsAverage,"avg","Page Views",!0).addClass("page-views-summary"),f=this.renderSummary(d.visitsTotal,d.visitsAverage,"avg","Visits",!0).addClass("visits-summary");d=this.renderSummary(d.visitorsTotal,d.visitorsAverage,"avg","Audience Size",!0).addClass("visitors-summary");c.append(e).append(f).append(d);return c},_addToolTips:function(){new b.Squarespace.ToolTip({target:".visitors-summary",
title:"Audience Size",body:"Audience Size (sometimes called Unique Visitors) is an estimate of the total number of distinct people that reached your site within a certain time period. This metric is tracked using a browser cookie with a 2-year expiration time."});new b.Squarespace.ToolTip({target:".page-views-summary",title:"Page Views",body:"Page views tracks how many actual page requests your site saw within a certain time period. Requests for individual images and other scripts are not counted as raw hits \u2014 only full page loads are."});
new b.Squarespace.ToolTip({target:".visits-summary",title:"Visits",body:"Visits tracks a series of requests from the same uniquely identified individual (a visitor) in a set period of time. A visit is made up of several page views. Squarespace tracks visits by setting a browser cookie with a 30-minute expiration. Any hits within a 30-minute browsing session are tracked as a single visit."})},renderOverviewChart:function(d,c,e){if(this._isDataEmpty(d))c.append(this.renderNoData());else{var f={font:"Helvetica Neue",
"font-size":"10px",fill:"#a3a3a3"},g={"letter-spacing":"1px",font:"Helvetica Neue","font-weight":700,"font-size":"7px",fill:"#fff"};c={targetContainer:b.Node.getDOMNode(c),gridColor:"#e9e9e9",width:716,height:235,animate:!0,yAxisLabelStyle:f,labelFunc:function(b,c,e,d){var h=b.text(c,e-2,d.text).attr(f).toBack();d.image&&b.image(d.image,c-10,e+h.getBBox().height-2,20,15);d.subText&&(e=e+h.getBBox().height+2,c=b.text(c,e+3,d.subText).attr(g).getBBox(),b.rect(c.x-2,c.y-3,c.width+4,c.height+6).attr({stroke:"#c6c6c6",
fill:"#c6c6c6"}).toBack())},labels:[],lines:[]};var h={title:"Audience Size",fillStyle:{fill:"#c4c4c4",opacity:0.4},lineStyle:{stroke:"#222222","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#333"},data:[]},k={title:"Visits",fillStyle:{fill:"#949494",opacity:0.8},lineStyle:{stroke:"#828282","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#797979"},data:[]},l={title:"Page Views",lineStyle:{stroke:"#dfdfdf","stroke-width":2,"stroke-linejoin":"round"},
dotStyle:{fill:"#fff",stroke:"#bbb"},data:[]};c.lines=[h,k,l];var p="";d=d.trafficBySegment;for(var q=0;q<d.length;++q){var r=d[q],s=null,t=this.formatShortDate(r,e),s={text:t.primary,flyout:r.timePeriodShort},t=t.secondary.toUpperCase();t!==p&&(p=s.subText=t);s.toString=function(){return this.flyout};c.labels.push(s);h.data.push(r.visitors);k.data.push(r.visits);l.data.push(r.views)}new b.Squarespace.Graphing.LineChart(c)}}},{CSS_PREFIX:"sqs-activity-manager-traffic-overview",ATTRS:{activeTab:{value:"month"},
strings:{value:{title:"Overview"}},requestParams:{getter:function(){return{name:"traffic",segmentName:this.get("activeTab"),verbose:"true"}}}}})},"1.0",{requires:["base","squarespace-graphing","squarespace-ui-base","squarespace-bar-table","squarespace-settings-activity-base-manager"]});
YUI.add("squarespace-dialog-cookie-check",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.CookieCheck=b.Base.create("cookieCheck",b.Squarespace.DialogFields.Check,[],{initializer:function(c){this.set("data","true"===b.Cookie.get(this.get("cookieKey")))},bindUI:function(){d.superclass.bindUI.call(this);this.get("autoSetCookie")&&this.after("dataChange",function(b){this.setCookie(b.newVal)},this)},setCookie:function(){this._setCookie(this.get("data"))},_setCookie:function(c){c||
"setToFalse"==this.get("disabledBehavior")?b.Cookie.set(this.get("cookieKey"),c,{path:this.get("path"),expires:this.get("expires")}):"remove"==this.get("disabledBehavior")&&b.Cookie.remove(this.get("cookieKey"),{path:this.get("path")})}},{CSS_PREFIX:"sqs-check",ATTRS:{autoSetCookie:{value:!1,setter:function(b){return!!b}},cookieKey:{validator:b.Lang.isString},expires:{valueFn:function(){return b.DataType.Date.addYears(new Date,10)}},path:{value:"/"},readOnly:{value:!0},data:{value:!1},disabledBehavior:{value:"remove"}}})},
"1.0",{requires:["base","cookie","squarespace-dialog-field-2","squarespace-dialog-check"]});
YUI.add("squarespace-settings-billing-down",function(b){b.namespace("Squarespace.Widgets").BillingSettingsDown=b.Base.create("billingSettingsDown",b.Squarespace.Widgets.SettingsPanel,[b.Squarespace.Widgets.BillingSettingsBase],{},{CSS_PREFIX:"sqs-billing-settings-down",ATTRS:{buttons:{value:[]},fields:{value:[{ctor:b.Squarespace.DialogFields.Description,config:{padding:[0,0],className:"removed billing-subpanel-unavailable",title:"Billing features are currently unavailable.",text:"During this time, you cannot make changes to your plan and your subscription will not renew or expire. <br/>Please check back again later as the billing features will return shortly."}}]}}})},
"1.0",{requires:["base","squarespace-settings-panel","squarespace-dialog-description","squarespace-settings-billing-base"]});
YUI.add("squarespace-content-item-types-text-panel",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.TextPanel=b.Base.create("textPostEditorPanel",b.Squarespace.ContentItemEditor.BasePanel,[],{_getTemplateContext:function(){var c=d.superclass._getTemplateContext.call(this);c.enableFeatured=!0;c.enablePassthrough=!0;c.enableExcerpt=!0;b.Array.each(this.get("hideFields"),function(b){c["disable"+b.capitalize()]=!0});return c}},{ATTRS:{"strings.presentationName":{value:"Post"},
editorConfiguration:{value:{title:"Edit {presentationName}",width:750,name:"text-post-editor",overlay:0.5,verticalHeight:"full",initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.text"],$when:function(b){return!(b.disableTitle&&b.disableLayout)}},{$include:"tabs.options.default",$when:function(b){return!(b.disableTitle&&b.disableLayout)}},{$include:["tabs.options.default","tabs.panel.primary","tabs.primary.text"],$when:function(b){return b.disableTitle&&b.disableLayout}},
{$include:"tabs.location"},{$include:"tabs.social"}],buttons:[{type:"askBeforeSavingChangesAndClose",title:"Done"}]}},hideFields:{value:[]}}})},"1.0",{requires:["squarespace-content-item-types-base","squarespace-content-item-types-base-panel","squarespace-content-item-types-post-editors"]});
YUI.add("squarespace-settings-newsletters-messages",function(b){var d=b.Base.create("newslettersDraftMessagesList",b.Squarespace.DialogField2,[],{initializer:function(e){var d=this;b.Squarespace.NewsletterMessagesList.load(function(){d.view=new c({model:b.Squarespace.NewsletterMessagesList});d.get("contentBox").append(d.view.get("container"));d.syncUI()})},bindUI:function(){this._addRemoveEvent=b.Squarespace.NewsletterMessagesList.after(["add","remove"],this.syncUI,this)},syncUI:function(){if(this.view&&
(this.view.render(),!b.one(".sqs-newsletters-messages .message.current"))){var c=b.one(".sqs-newsletters-messages .message");c&&this.view.openDraft(c)}},destructor:function(){b.Squarespace.Newsletters.editMessagePanel&&(b.Squarespace.Newsletters.editMessagePanel.destroy(),b.Squarespace.Newsletters.editMessagePanel=null);b.Squarespace.Newsletters.viewsent&&(b.Squarespace.Newsletters.viewsent.remove(!0),b.Squarespace.Newsletters.viewsent=null);this._addRemoveEvent.detach()}}),c=b.Base.create("DraftsView",
b.Squarespace.View,[],{events:{".message":{click:"openDraftHandler"}},template:"newsletters-draft-messages.html",initializer:function(b){this.config=b;c.superclass.initializer.apply(this,arguments)},render:function(){var e;c.superclass.render.apply(this,arguments);b.Squarespace.Newsletters.editMessagePanel&&(b.Squarespace.Newsletters.editMessagePanel.syncUI(),e=b.Squarespace.Newsletters.editMessagePanel.get("model").get("id"),(currentNode=b.one(".sqs-newsletters-messages .newsletters-draft-messages-list .message .item[id="+
e+"]"))?currentNode.ancestor(".message").addClass("current"):b.Squarespace.Newsletters.editMessagePanel.get("isNew")&&b.one(".sqs-newsletters-messages .message").addClass("current"));b.Squarespace.Newsletters.viewsent&&(e=b.Squarespace.Newsletters.viewsent.getAttribute("messageId"),(currentNode=b.one(".sqs-newsletters-messages .newsletters-draft-messages-list .message .item[id="+e+"]"))&&this.openDraft(currentNode.ancestor(".message")))},_getTemplateContext:function(){for(var c=this.get("model").filter(function(c){return c.get("status")==
b.Squarespace.NewsletterMessageStatus.DRAFT||c.get("status")==b.Squarespace.NewsletterMessageStatus.TEST_SEND||c.get("status")==b.Squarespace.NewsletterMessageStatus.TEST_SENDING||c.get("status")==b.Squarespace.NewsletterMessageStatus.TEST_ERROR||c.get("status")==b.Squarespace.NewsletterMessageStatus.TEST_SENT}),e=0;e<c.length;e++)c[e]=c[e].toJSON();return{drafts:c}},openDraftHandler:function(b){var c=b.target.ancestor(".message");b.preventDefault();this.openDraft(c)},openDraft:function(c){c.hasClass("current")||
(b.all(".sqs-newsletters-messages .message.current").removeClass("current"),c.addClass("current"),b.Squarespace.Newsletters.editMessagePanel&&(b.Squarespace.Newsletters.editMessagePanel.destroy(),b.Squarespace.Newsletters.editMessagePanel=null),b.Squarespace.Newsletters.viewsent&&(b.Squarespace.Newsletters.viewsent.remove(!0),b.Squarespace.Newsletters.viewsent=null),c=c.one(".item").get("id"),b.Squarespace.Newsletters.editMessagePanel=new b.Squarespace.Widgets.NewsletterMessageEditor({model:this.get("model").getById(c)}),
b.Squarespace.Newsletters.editMessagePanel.render())}},{ATTRS:{}}),e=b.Base.create("newslettersSentMessagesList",b.Squarespace.DialogField2,[],{initializer:function(c){var e=this;b.Squarespace.NewsletterMessagesList.load(function(){e.view=new f({model:b.Squarespace.NewsletterMessagesList,dialog:c.dialog});e.get("contentBox").append(e.view.get("container"));e.syncUI()})},bindUI:function(){b.Squarespace.NewsletterMessagesList.after(["add","remove"],this.syncUI,this)},syncUI:function(){this.view&&this.view.render()}}),
f=b.Base.create("SentsView",b.Squarespace.View,[],{events:{".message":{click:"openSentHandler"},".retry":{click:"retry"},".undo":{click:"undo"}},template:"newsletters-sent-messages.html",initializer:function(){f.superclass.initializer.apply(this,arguments);this.get("model")},render:function(){var c;f.superclass.render.apply(this,arguments);b.Squarespace.Newsletters.viewsent&&(c=b.Squarespace.Newsletters.viewsent.getAttribute("messageId"),(currentNode=b.one(".sqs-newsletters-messages .newsletters-sent-messages-list .message .item[id="+
c+"]"))&&currentNode.ancestor(".message").addClass("current"));b.Squarespace.Newsletters.editMessagePanel&&(b.Squarespace.Newsletters.editMessagePanel.syncUI(),c=b.Squarespace.Newsletters.editMessagePanel.get("model").get("id"),(currentNode=b.one(".sqs-newsletters-messages .newsletters-sent-messages-list .message .item[id="+c+"]"))&&this.openSent(currentNode.ancestor(".message")))},_getTemplateContext:function(){var c=this.get("model");c.oldcomparator=c.comparator;c.comparator=function(b){return b.get("sentOn")||
1E17};c.sort();c.comparator=c.oldcomparator;for(var c=c.filter(function(c){return c.get("status")==b.Squarespace.NewsletterMessageStatus.SEND||c.get("status")==b.Squarespace.NewsletterMessageStatus.SENDING||c.get("status")==b.Squarespace.NewsletterMessageStatus.PENDING||c.get("status")==b.Squarespace.NewsletterMessageStatus.ERROR||c.get("status")==b.Squarespace.NewsletterMessageStatus.SENT}),e=0;e<c.length;e++)switch(c[e]=c[e].toJSON(),c[e].status){case b.Squarespace.NewsletterMessageStatus.SEND:case b.Squarespace.NewsletterMessageStatus.SENDING:c[e].status_sending=
!0;clearTimeout(this.get("refreshTimeout"));this.set("refreshTimeout",window.setTimeout(this._refreshSentMessages,1E3,this));break;case b.Squarespace.NewsletterMessageStatus.PENDING:c[e].status_pending=!0;clearTimeout(this.get("refreshTimeout"));this.set("refreshTimeout",window.setTimeout(this._refreshSentMessages,1E3,this));break;case b.Squarespace.NewsletterMessageStatus.ERROR:c[e].status_error=!0;break;case b.Squarespace.NewsletterMessageStatus.SENT:c[e].status_sent=!0}return{sents:c}},_refreshSentMessages:function(b){clearTimeout(b.get("refreshTimeout"));
b.get("model").load(function(){b.render()})},retry:function(c){c=c.target.ancestor(".item");var e=c.get("id");c.ancestor(".message");if(c=this.get("model").getById(e))c.set("status",b.Squarespace.NewsletterMessageStatus.SEND),c.save(),this.render()},undo:function(c){c=c.target.ancestor(".item");var e=c.get("id");c.ancestor(".message");if(c=this.get("model").getById(e))c.set("status",b.Squarespace.NewsletterMessageStatus.DRAFT),c.save(),this.render()},openSentHandler:function(b){var c=b.target.ancestor(".message");
b.preventDefault();this.openSent(c)},openSent:function(c){if(!c.hasClass("current")){b.all(".sqs-newsletters-messages .message.current").removeClass("current");c.addClass("current");b.Squarespace.Newsletters.editMessagePanel&&(b.Squarespace.Newsletters.editMessagePanel.destroy(),b.Squarespace.Newsletters.editMessagePanel=null);b.Squarespace.Newsletters.viewsent&&(b.Squarespace.Newsletters.viewsent.remove(!0),b.Squarespace.Newsletters.viewsent=null);c=c.one(".item").get("id");var e=b.Squarespace.UITemplates.render("widgets-newsletter-message-viewsent.html",
{src:"https://"+window.location.host+"/newsletter/messages/"+c});b.Squarespace.Newsletters.viewsent=b.Node.create(e);b.Squarespace.Newsletters.viewsent.setAttribute("messageId",c);b.one(".sqs-damask-content").appendChild(b.Squarespace.Newsletters.viewsent)}}},{ATTRS:{}}),g=b.namespace("Squarespace.Widgets").NewslettersMessagesManager=b.Base.create("NewslettersMessagesManager",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){b.Squarespace.NewsletterMessagesList=new b.Squarespace.Models.NewsletterMessageList;
this.set("fields",this._getFields());b.Squarespace.SiteUserList||(b.Squarespace.SiteUserList=new b.Squarespace.Models.SiteUserList,b.Squarespace.SiteUserList.load())},bindUI:function(){g.superclass.bindUI.apply(this,arguments)},_getInitialButtons:function(){return[{label:"New",className:"add primary",action:b.bind(this._showAddMessageDialog,this)}]},_showAddMessageDialog:function(){var c=b.Squarespace.Newsletters.TemplateType,e=new b.Squarespace.Lightbox({content:'<div class="wrapper newsletter-template-picker"><h3>Choose a layout</h3><ul class="templates"><li class="sqs-newsletter-featured-template" data-template-type="'+
c.FEATURED.enumName+'">Show off products, posts or pages.</li><li class="sqs-newsletter-update-template" data-template-type="'+c.UPDATE.enumName+'">Update subscribers on the latest.</li><li class="sqs-newsletter-gallery-template" data-template-type="'+c.GALLERY.enumName+'">Showcase a gallery from your site.</li></ul><div class="sqs-newsletter-create"><span>Feeling creative? </span><a>Create Your Own</a></div></div>',zIndex:25E3,transition:"scale",name:"template-picker",opacity:0.7,clickAnywhereToExit:!0,
disableNormalClose:!1,margin:0});e.show();c=e.getContentEl();c.one(".newsletter-template-picker").on("click",function(b){b.halt()});c.one("UL").delegate("click",function(b){this._showMessageEditor(b.target.getData("template-type"));e.hide()},"li",this);c.one(".sqs-newsletter-create a").on("click",function(b){this._showMessageEditor();e.hide()},this)},_showMessageEditor:function(c){b.all(".sqs-newsletters-messages .message.current").removeClass("current");b.Squarespace.Newsletters.editMessagePanel&&
(b.Squarespace.Newsletters.editMessagePanel.destroy(),b.Squarespace.Newsletters.editMessagePanel=null);b.Squarespace.Newsletters.viewsent&&(b.Squarespace.Newsletters.viewsent.remove(!0),b.Squarespace.Newsletters.viewsent=null);b.Squarespace.Newsletters.editMessagePanel=new b.Squarespace.Widgets.NewsletterMessageEditor({templateType:c});b.Squarespace.Newsletters.editMessagePanel.render()},_getFields:function(){return[{ctor:d,config:{name:"drafts"}},{ctor:e,config:{name:"sents"}}]}},{CSS_PREFIX:"sqs-newsletters-messages",
ATTRS:{buttons:{valueFn:"_getInitialButtons",validator:b.Lang.isArray},"strings.title":{value:"Messages"},"strings.description":{value:'Squarespace Newsletters is a new beta feature that allows you to easily send newsletters to a mailing list from your website in a completely integrated way. We look forward to your feedback and suggestions. <a href="#">Watch Video</a>'},fields:{}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-hb-humanizedate-format squarespace-hb-date-format squarespace-models-layout squarespace-newsletters-draft-messages-template squarespace-newsletters-sent-messages-template squarespace-newsletters-templates squarespace-settings-panel squarespace-ui-base squarespace-widgets-newsletter-message-editor squarespace-widgets-newsletter-message-viewsent-template".split(" ")});
YUI.add("squarespace-tray",function(b){var d=b.namespace("Squarespace.Widgets").Tray=b.Base.create("tray",b.Squarespace.Widgets.SSWidget,[],{bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("id");this.after(b+"|stringsChange",this._afterStringsChange);this.after(b+"|buttonsChange",this._afterButtonsChange)},syncUI:function(){d.superclass.syncUI.call(this);this._uiUpdateText();this._uiSetButtons(this.get("buttons"))},_afterButtonsChange:function(b){this._uiSetButtons(b.newVal,b.animate)},
_afterStringsChange:function(b){this._uiUpdateText()},_uiUpdateText:function(){var c=this.get("contentBox");c.one(".title").setContent(b.Escape.html(this.get("strings.title")));c.one(".title").setAttribute("title",b.Escape.html(this.get("strings.title")));c.one(".subtitle").setContent(b.Escape.html(this.get("strings.subtitle")))},_uiSetButtons:function(c,e){var d=this.get("contentBox").one(this.getProperty("CONTROLS_CONTAINER"));if(!d)throw"No CONTROLS_CONTAINER in the template to put buttons in.";
e&&(d.plug(b.Squarespace.Plugins.SizeAnimator),d.sizeAnimator.hold());d.empty();b.Array.each(c,function(c,e,f){var g=this._createButtonWidget(c);g.on(this.get("id")+"|click",function(e){c.allowMouseEvents||(e.halt(),e.stopImmediatePropagation());this.fire("button-click",{button:g,buttonConfig:c,originalClickEvent:e});c.action&&(e.button=g,e.buttonConfig=c,b.bind(c.action,c.context)(e))},this);g.get("boundingBox").addClass("label-"+b.Squarespace.Utils.slugify(c.label));g.get("boundingBox").addClass("no-frame");
c.container?(e=this.get("contentBox").one(c.container),g.render(e)):g.render(d)},this);e&&d.sizeAnimator.release()},_createButtonWidget:function(c){return new b.Squarespace.Widgets.Button({"strings.text":c.label,className:c.className})}},{CSS_PREFIX:"sqs-tray",CONTROLS_CONTAINER:".buttons",TEMPLATE:'<div class="header"><div class="title"></div><div class="spinner-wrapper"></div><div class="subtitle"></div></div><div class="body"><div class="buttons"></div></div>',ATTRS:{strings:{value:{title:"",subtitle:""}},
buttons:{value:[],validator:function(b,c){for(var e=1;e<b.length;e++)if(!b[e].label)return console.warn("No label provided",b),!1;return!0}}}}),c=b.namespace("Squarespace.Widgets").HeaderTray=b.Base.create("headerTray",b.Squarespace.Widgets.Tray,[b.WidgetParent,b.WidgetChild],{renderUI:function(){c.superclass.renderUI.call(this);this.get("loading")?this._startSpinner():this._stopSpinner()},bindUI:function(){c.superclass.bindUI.call(this);this._uiBindShadow();var b=this.get("id");this.after(b+"|shadowChange",
this._uiBindShadow);this.after(b+"|shadowOpacityChange",this._syncShadowUI);this.after(b+"|loadingChange",function(b){b.newVal?this.get("rendered")?this._startSpinner():console.warn(this.name+": Cannot start spinner before widget is rendered."):this._stopSpinner()},this)},_syncShadowUI:function(){this.get("contentBox").one(".shadow").setStyles({opacity:Math.min(this.get("shadowOpacity"),this.get("shadowMaxOpacity"))})},_startSpinner:function(){this._uiUpdateText();var c=this.get("contentBox").one(".spinner-wrapper");
this._spinnerTimer&&this._spinnerTimer.cancel();this._spinner=new b.Squarespace.Spinner({render:c,color:"dark"})},_stopSpinner:function(){this._spinnerTimer&&(this._spinnerTimer.cancel(),this._spinnerTimer=null);this._spinner&&(this._spinner.destroy(),this._spinner=null)},_uiBindShadow:function(){this._shadowScrollEvent&&this._shadowScrollEvent.detach();this.get("shadow")&&(this._shadowScrollEvent=b.one(window).on(this.get("id")+"|scroll",function(){this.set("shadowOpacity",this._calculateOpacity())},
this))},_calculateOpacity:function(){var c=this.get("shadowScrollTop"),e=b.one(window).get("scrollTop");return e<c?e/c:1},_createButtonWidget:function(c){return new b.Squarespace.Widgets.Button({"strings.text":c.label,href:c.href,name:c.name,className:c.className,active:c.active})}},{CSS_PREFIX:"sqs-header-tray",TEMPLATE:'<div class="header"><div class="title"></div><div class="spinner-wrapper"></div><div class="subtitle"></div></div><div class="body"><div class="buttons"></div></div><div class="footer"></div><div class="shadow"></div>',
ATTRS:{shadow:{value:!0,validator:b.Lang.isBoolean},shadowOpacity:{value:0,validator:b.Lang.isNumber},shadowMaxOpacity:{value:0.4,validator:b.Lang.isNumber},shadowScrollTop:{value:100,validator:b.Lang.isNumber},loading:{value:!1,validator:b.Lang.isBoolean}}}),e=b.namespace("Squarespace.Widgets").LibraryManagerHeaderTray=b.Base.create("libraryManagerHeaderTray",b.Squarespace.Widgets.HeaderTray,[],{_uiSetButtons:function(){e.superclass._uiSetButtons.apply(this,arguments);var b=this.get("contentBox"),
c=b.one(".buttons").get("offsetWidth");b.one(".header .title").setStyle("marginRight",c)}},{CSS_PREFIX:"sqs-library-manager-header-tray",TEMPLATE:'<div class="header"><div class="title"></div><div class="filters"></div><div class="pagination"></div><div class="subtitle"></div></div><div class="body"><div class="buttons"></div></div><div class="shadow"></div>'}),f=b.namespace("Squarespace.Widgets").TabbedHeaderTray=b.Base.create("tabbedHeaderTray",b.Squarespace.Widgets.HeaderTray,[],{initializer:function(){this.publish("tab-switch-requested",
{emitFacade:!0,defaultFn:this._updateActiveButtonClass,context:this,preventable:!0});this.after(this.get("id")+"|button-click",function(b){null!==b.button.ancestor(this.getProperty("CONTROLS_CONTAINER"))&&this.fire("tab-switch-requested",{button:b.button})},this)},_createButtonWidget:function(c){return new b.Squarespace.Widgets.TabButton({"strings.text":c.label,href:c.href,name:c.name,className:c.className,active:c.active})},_uiSetButtons:function(){f.superclass._uiSetButtons.apply(this,arguments);
var b=this.get("defaultTab"),c=this.get("boundingBox").one(this.getProperty("CONTROLS_CONTAINER")).get("children");0!==c.size()&&(b?c.each(function(c){c.hasClass("name-"+b)&&c.addClass("active")},this):c.item(0).addClass("active"))},_updateActiveButtonClass:function(b){this.get("boundingBox").one(this.getProperty("CONTROLS_CONTAINER")).get("children").each(function(c,e,d){c.toggleClass("active",b.button.get("boundingBox")===c)},this)}},{CSS_PREFIX:"sqs-tabbed-header-tray",CONTROLS_CONTAINER:".tabs",
TEMPLATE:'<div class="header"><div class="title"></div><div class="spinner-wrapper"></div><div class="subtitle"></div></div><div class="body"><div class="tabs"></div><div class="buttons"></div></div><div class="footer"></div><div class="shadow"></div>',ATTRS:{defaultTab:{}}});b.namespace("Squarespace.Widgets").ActionTray=b.Base.create("actionTray",b.Squarespace.Widgets.Tray,[],{destructor:function(){this._displayTimer&&this._displayTimer.cancel();this._displayAnim&&this._displayAnim.stop(!0).destroy()},
renderUI:function(){b.Squarespace.Widgets.ActionTray.superclass.renderUI.call(this);this.get("boundingBox").one(".action-tray").setStyle("top","100px")},bindUI:function(){var b=this.get("id");this.get("contentBox").on(b+"|click",function(b){b.halt()});this.on(b+"|visibleChange",this._onVisibleChange);this.after([b+"|buttonsChange",b+"|countChange",b+"|showThresholdChange",b+"|stringsChange"],this._afterUIAttributeChange)},syncUI:function(){this._uiSetCount(this.get("count"));this._uiSetButtons(this.get("buttons"));
this._uiSetTitle(this.get("strings.title"));this._uiSetSubtitle(this.get("strings.subtitle"))},_onVisibleChange:function(c){if(!c.silent){c.preventDefault();var e=c.newVal,d=c.prevVal,f=this.get("boundingBox"),p=this.get("animationDuration"),q=f.one(".action-tray");if(this.get("enabled")||!e){this._displayTimer&&(this._displayTimer.cancel(),delete this._displayTimer);var r=b.bind(function(){this._displayAnim&&(e===d&&this._displayAnim.stop(),delete this._displayAnim)},this);this._displayTimer=e?b.later(1E3*
this.get("showDelay"),this,function(){this._displayTimer=null;r();f.setStyle("display","block");this._displayAnim=new b.Anim({node:q,duration:p,easing:this.get("easingIn"),to:{top:"0",opacity:1}});this._anims.add(this._displayAnim);this._displayAnim.onceAfter(this.get("id")+"|end",function(){this._displayAnim=null;this.set("visible",!0,{silent:!0})},this);this._displayAnim.run()}):b.later(1E3*this.get("hideDelay"),this,function(){q.inDoc()?(this._displayTimer=null,r(),f.setStyle("display",null),this._displayAnim=
new b.Anim({node:q,duration:p,easing:this.get("easingOut"),to:{top:"100px",opacity:0}}),this._anims.add(this._displayAnim),this._displayAnim.onceAfter(this.get("id")+"|end",function(){this._displayAnim=null;f.setStyle("display","none");this.set("visible",!1,{silent:!0})},this),this._displayAnim.run()):console.warn("Trying to animate tray that is not in the dom.")})}}},_afterUIAttributeChange:function(b){switch(b.attrName){case "showThreshold":case "count":this._uiSetCount();break;case "buttons":this._uiSetButtons(this.get("buttons"));
break;case "strings":"strings.subtitle"===b.subAttrName?this._uiSetSubtitle(this.get("strings.subtitle")):"strings.title"===b.subAttrName?this._uiSetTitle(this.get("strings.title")):this._uiSetCount(this.get("count"));break;default:console.warn("How did you get here? That's not possible!")}},_uiSetCount:function(){var c=this.get("count");0!==c&&this.get("contentBox").one(".description .top").setContent(b.substitute(this.get("strings.title"),{count:c,label:1===c?"Item":"Items"}));this.set("visible",
c>=this.get("showThreshold"))},_uiSetSubtitle:function(b){this.get("contentBox").one(".bottom").setContent(b)},_uiSetTitle:function(b){this.get("contentBox").one(".top").setContent(b)},_setEnabled:function(b){b||this.hide();return b},hide:function(){this.set("visible",!1)},show:function(){this.set("visible",!0)},enable:function(){this.set("enabled",!0)},disable:function(){this.set("enabled",!1)}},{CSS_PREFIX:"sqs-action-tray",TEMPLATE:'<div class="action-tray"><div class="description"><div class="top"></div><div class="bottom"></div></div><div class="buttons"></div></div>',
ATTRS:{strings:{value:{title:"{count} {label} Selected",subtitle:"This action will be applied to all selected items above."}},enabled:{value:!0,setter:"_setEnabled",lazyAdd:!1},buttons:{value:[],validator:function(b,c){for(var e=1;e<b.length;e++){var d=b[e];if(!d.action)return console.warn("No action (callback function) provided",b),!1;if(!d.label)return console.warn("No label provided",b),!1}return!0}},count:{value:0},showThreshold:{value:1},showDelay:{value:0.3},hideDelay:{value:0.1},animationDuration:{value:0.25},
easingIn:{value:b.Easing.easeOutStrong},easingOut:{value:b.Easing.easeOutStrong}}})},"1.0",{requires:["squarespace-dialog-tab","squarespace-dialog-button","squarespace-ss-widget","squarespace-dombuilder","squarespace-plugin-sizeanimator"]});
YUI.add("squarespace-dialog-check",function(b){b.namespace("Squarespace.DialogFields");var d=function(b,e){return function(d){d.halt();b.call(e,d)}};b.Squarespace.DialogFields.Check=b.Base.create("check",b.Squarespace.DialogField2,[],{initializer:function(c){!b.Lang.isValue(c.data)&&b.Lang.isValue(c.defaultValue)&&this.set("data",c.defaultValue)},bindUI:function(){b.Squarespace.DialogFields.Check.superclass.bindUI.call(this);this.get("boundingBox").on("tap",d(this._toggleActive,this));this.get("boundingBox").after("mousedown",
function(b){b.halt()},this)},syncUI:function(){b.Squarespace.DialogFields.Check.superclass.syncUI.call(this);this.get("contentBox").setHTML(this.renderTemplate());b.Lang.isValue(this.get("strings.description"))?this.get("boundingBox").addClass("has-description"):this.get("boundingBox").addClass("has-no-description")},_toggleActive:function(){this.set("data",!this.get("data"))}},{CSS_PREFIX:"sqs-check",HANDLEBARS_TEMPLATE:"dialog-check.html",ATTRS:{data:{value:!1}}})},"1.0",{requires:["base","base-build",
"event-tap","squarespace-dialog-field-2","squarespace-dialog-check-template"]});
YUI.add("squarespace-block-content-html-editor-base",function(b){b.namespace("Squarespace.Content").HtmlEditorBase=b.Base.create("contentHtmlEditor",b.Plugin.Base,[],{initializer:function(){this._host=this.get("host");this._bb=this._host.get("boundingBox");this._cb=this._host.get("contentBox");this.block=this._host.get("parent");this.initEngine();this._host.after("focusedChange",function(b){b.newVal?this._afterFocus(b):this._afterBlur(b)},this);this.once("initializedChange",this.syncEditorUI,this);
this._bb.addClass("sqs-editing")},syncEditorUI:function(){},_getVisualEditorData:function(){throw"_getVisualEditorData() not implemented.";},initEngine:function(){switch(this._host.get("model").get("engine")){case "text":case "textNoBreak":this.initTextEngine();break;case "wysiwyg":case "visual":this.initVisualEngine()}},initTextEngine:function(){var d=this._host.get("model").get("engine"),c=this._host.get("placeholderText"),e=this._host.get("model").get("html");this._bb.addClass("sqs-html-engine-"+
d.toLowerCase());this.titleEditable=b.Node.create('<textarea class="sqs-textarea-editor" placeholder="'+c+'" autocapitalize="on">'+e+"</textarea>");this._bb.appendChild(this.titleEditable);var f=this.textarea=this._bb.one("textarea"),g=this._host.get("referenceNode")||this._cb;"font text-align text-rendering letter-spacing text-transform color".split(" ").forEach(function(b){var c=g.getComputedStyle(b);f.setStyle(b,c);g!=this._cb&&this._cb.setStyle(b,c)},this);if("textNoBreak"===d)f.on("keydown",
function(b){13===b.keyCode&&b.preventDefault()},this);f.on("valuechange",function(c){c=b.Escape.html(c.target.get("value"));-1!==c.indexOf("\n")&&(c=c.replace(/\n/g," "),f.set("value",c));this._host.get("model").set("html",c);this._host.syncUI()},this)},initVisualEngine:function(){throw"initVisualEngine() not implemented!";},_giveEditorFocus:function(){},_afterFocus:function(b){this._giveEditorFocus()},_afterBlur:function(b){this.visualEditor?this.visualEditor.didDataChange()&&this._save():this._save();
this._fireContentUpdate()},_save:function(){var d=this._host.get("model"),c,e;this.visualEditor?e=c=this._getVisualEditorData():this.textarea&&(c=e=this.textarea.get("value"));b.Lang.isValue(c)&&d.setAttrs({source:e,html:c});this.block&&this.block.get("isNewBlock")&&this.block.set("isNewBlock",!1)},_fireContentUpdate:function(){this.get("host").get("parent").fire("widget:contentUpdate")},getMobileAppMenuConfig:function(){return null},_destroyVisualEditor:function(){throw"_destroyVisualEditor not implemented.";
},destructor:function(){this._bb.removeClass("sqs-editing");this._destroyVisualEditor();this._debounceSaveOnKeyUp&&this._debounceSaveOnKeyUp.cancel&&this._debounceSaveOnKeyUp.cancel();this.titleEditable&&this.titleEditable.remove()}},{NS:"contentEditor",ATTRS:{tabIndex:{value:0}}})},"2.0",{requires:["node","base","plugin","squarespace-visual-editor","squarespace-debounce"]});
YUI.add("squarespace-content-manager-widgets-knowledge-base-list",function(b){b.namespace("Squarespace.KnowledgeBase").List=b.Base.create("KnowledgeBaseList",b.Squarespace.Blog.List,[],{addSearch:function(){var b=this.get("boundingBox");b.hasClass("sqs-kb-list-with-search")||b.addClass("sqs-kb-list-with-search")},removeSearch:function(){var b=this.get("boundingBox");b.hasClass("sqs-kb-list-with-search")&&b.removeClass("sqs-kb-list-with-search")}},{CSS_PREFIX:"sqs-kb-list",ATTRS:{defaultChildType:{value:b.Squarespace.KnowledgeBase.Item}}})},
"1.0",{requires:["squarespace-content-manager-widgets-knowledge-base-item","squarespace-content-manager-widgets-blog-list"]});YUI.add("squarespace-block-fivehundredpix-model",function(b){b.namespace("Squarespace.ContentModel").FivehundredpixBlock=b.Base.create("fiveHundredPixModel",b.Squarespace.ContentModel.SummaryGalleryBlock,[],{},{})},"1.0",{requires:["base","model","squarespace-enum","squarespace-block-summary-gallery-model"]});
YUI.add("squarespace-block-in-browser-message-link",function(b){b.namespace("Squarespace.Block").InBrowserMessageLink=b.Base.create("block-in-browser-message-link",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-in-browser-message-link",ATTRS:{type:{readOnly:!0,valueFn:function(){return b.Squarespace.BlockType.IN_BROWSER_MESSAGE_LINK}},emailEditor:{readOnly:!0,valueFn:function(){return b.Squarespace.Block.Editor.InBrowserMessageLink}}}})},"1.0",{requires:["base","model","squarespace-block-base-modelsync",
"squarespace-block-in-browser-message-link-editor","squarespace-enum"]});
YUI.add("uploader-flash",function(b,d){function c(c,e,d){var f=this._id=b.guid("yuiswf");c=p.one(c);d=d||{};var g=((d.version||t)+"").split("."),g=h.isFlashVersionAtLeast(parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)),y=h.isFlashVersionAtLeast(8,0,0)&&!g&&d.useExpressInstall,F=y?u:e;e="<object ";var U="yId="+b.id+"&YUISwfId="+f+"&YUIBridgeCallback="+v+"&allowedDomain="+document.location.hostname;b.SWF._instances[f]=this;if(c&&(g||y)&&F){e+='id="'+f+'" ';e=l.ie?e+('classid="'+r+'" '):e+('type="'+
s+'" data="'+q.html(F)+'" ');e+='width="100%" height="100%">';l.ie&&(e+='<param name="movie" value="'+q.html(F)+'"/>');for(var H in d.fixedAttributes)w.hasOwnProperty(H)&&(e+='<param name="'+q.html(H)+'" value="'+q.html(d.fixedAttributes[H])+'"/>');for(var G in d.flashVars)H=d.flashVars[G],k.isString(H)&&(U+="&"+q.html(G)+"="+q.html(encodeURIComponent(H)));U&&(e+='<param name="flashVars" value="'+U+'"/>');c.set("innerHTML",e+"</object>");this._swf=p.one("#"+f)}else this.publish("wrongflashversion",
{fireOnce:!0}),this.fire("wrongflashversion",{type:"wrongflashversion"})}function e(){e.superclass.constructor.apply(this,arguments)}var f=b.Lang.sub,g=b.Uploader.Queue,h=b.SWFDetect,k=b.Lang,l=b.UA,p=b.Node,q=b.Escape,r="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000",s="application/x-shockwave-flash",t="10.0.22",u="http://fpdownload.macromedia.com/pub/flashplayer/update/current/swf/autoUpdater.swf?"+Math.random(),v="SWF.eventHandler",w={align:"",allowFullScreen:"",allowNetworking:"",allowScriptAccess:"",
base:"",bgcolor:"",loop:"",menu:"",name:"",play:"",quality:"",salign:"",scale:"",tabindex:"",wmode:""};c._instances=c._instances||{};c.eventHandler=function(b,e){c._instances[b]._eventHandler(e)};c.prototype={_eventHandler:function(b){"swfReady"===b.type?(this.publish("swfReady",{fireOnce:!0}),this.fire("swfReady",b)):"log"!==b.type&&this.fire(b.type,b)},callSWF:function(b,c){c||(c=[]);return this._swf._node[b]?this._swf._node[b].apply(this._swf._node,c):null},toString:function(){return"SWF "+this._id}};
b.augment(c,b.EventTarget);b.SWF=c;var y=function(b){y.superclass.constructor.apply(this,arguments)};b.extend(y,b.Base,{initializer:function(c){this.get("id")||this._set("id",b.guid("file"))},_swfEventHandler:function(b){if(b.id===this.get("id"))switch(b.type){case "uploadstart":this.fire("uploadstart",{uploader:this.get("uploader")});break;case "uploadprogress":this.fire("uploadprogress",{originEvent:b,bytesLoaded:b.bytesLoaded,bytesTotal:b.bytesTotal,percentLoaded:Math.min(100,Math.round(1E4*b.bytesLoaded/
b.bytesTotal)/100)});this._set("bytesUploaded",b.bytesLoaded);break;case "uploadcomplete":this.fire("uploadfinished",{originEvent:b});break;case "uploadcompletedata":this.fire("uploadcomplete",{originEvent:b,data:b.data});break;case "uploadcancel":this.fire("uploadcancel",{originEvent:b});break;case "uploaderror":this.fire("uploaderror",{originEvent:b,status:b.status,statusText:b.message,source:b.source})}},startUpload:function(b,c,e){if(this.get("uploader")){var d=this.get("uploader");e=e||"Filedata";
var f=this.get("id");c=c||null;this._set("bytesUploaded",0);d.on("uploadstart",this._swfEventHandler,this);d.on("uploadprogress",this._swfEventHandler,this);d.on("uploadcomplete",this._swfEventHandler,this);d.on("uploadcompletedata",this._swfEventHandler,this);d.on("uploaderror",this._swfEventHandler,this);d.callSWF("upload",[f,b,c,e])}},cancelUpload:function(){this.get("uploader")&&(this.get("uploader").callSWF("cancel",[this.get("id")]),this.fire("uploadcancel"))}},{NAME:"file",TYPE:"flash",ATTRS:{id:{writeOnce:"initOnly",
value:null},size:{writeOnce:"initOnly",value:0},name:{writeOnce:"initOnly",value:null},dateCreated:{writeOnce:"initOnly",value:null},dateModified:{writeOnce:"initOnly",value:null},bytesUploaded:{readOnly:!0,value:0},type:{writeOnce:"initOnly",value:null},uploader:{writeOnce:"initOnly",value:null}}});b.FileFlash=y;b.UploaderFlash=b.extend(e,b.Widget,{_buttonState:"up",_buttonFocus:!1,_swfContainerId:null,_swfReference:null,queue:null,_tabElementBindings:null,initializer:function(){this._swfContainerId=
b.guid("uploader");this.queue=this._swfReference=null;this._buttonState="up";this._tabElementBindings=this._buttonFocus=null;this._fileList=[];this.publish("fileselect");this.publish("uploadstart");this.publish("fileuploadstart");this.publish("uploadprogress");this.publish("totaluploadprogress");this.publish("uploadcomplete");this.publish("alluploadscomplete");this.publish("uploaderror");this.publish("mouseenter");this.publish("mouseleave");this.publish("mousedown");this.publish("mouseup");this.publish("click")},
renderUI:function(){var c=this.get("boundingBox"),d=this.get("contentBox"),g=this.get("selectFilesButton"),h=b.Node.create(f(e.FLASH_CONTAINER,{swfContainerId:this._swfContainerId}));c.setStyle("position","relative");g.setStyles({width:"100%",height:"100%"});d.append(g);d.append(h);this._swfReference=new b.SWF(h,this.get("swfURL"),{version:"10.0.45",fixedAttributes:{wmode:"transparent",allowScriptAccess:"always",allowNetworking:"all",scale:"noscale"}})},bindUI:function(){this._swfReference.on("swfReady",
function(){this._setMultipleFiles();this._setFileFilters();this._triggerEnabled();this._attachTabElements();this.after("multipleFilesChange",this._setMultipleFiles,this);this.after("fileFiltersChange",this._setFileFilters,this);this.after("enabledChange",this._triggerEnabled,this);this.after("tabElementsChange",this._attachTabElements)},this);this._swfReference.on("fileselect",this._updateFileList,this);this._swfReference.on("mouseenter",function(){this.fire("mouseenter");this._setButtonClass("hover",
!0);"down"===this._buttonState&&this._setButtonClass("active",!0)},this);this._swfReference.on("mouseleave",function(){this.fire("mouseleave");this._setButtonClass("hover",!1);this._setButtonClass("active",!1)},this);this._swfReference.on("mousedown",function(){this.fire("mousedown");this._buttonState="down";this._setButtonClass("active",!0)},this);this._swfReference.on("mouseup",function(){this.fire("mouseup");this._buttonState="up";this._setButtonClass("active",!1)},this);this._swfReference.on("click",
function(){this.fire("click");this._buttonFocus=!0;this._setButtonClass("focus",!0);b.one("body").focus();this._swfReference._swf.focus()},this)},_attachTabElements:function(){if(null!==this.get("tabElements")&&null!==this.get("tabElements").from&&null!==this.get("tabElements").to){null!==this._tabElementBindings?(this._tabElementBindings.from.detach(),this._tabElementBindings.to.detach(),this._tabElementBindings.tabback.detach(),this._tabElementBindings.tabforward.detach(),this._tabElementBindings.focus.detach(),
this._tabElementBindings.blur.detach()):this._tabElementBindings={};var c=b.one(this.get("tabElements").from),e=b.one(this.get("tabElements").to);this._tabElementBindings.from=c.on("keydown",function(b){9===b.keyCode&&!b.shiftKey&&(b.preventDefault(),this._swfReference._swf.setAttribute("tabindex",0),this._swfReference._swf.setAttribute("role","button"),this._swfReference._swf.setAttribute("aria-label",this.get("selectButtonLabel")),this._swfReference._swf.focus())},this);this._tabElementBindings.to=
e.on("keydown",function(b){9===b.keyCode&&b.shiftKey&&(b.preventDefault(),this._swfReference._swf.setAttribute("tabindex",0),this._swfReference._swf.setAttribute("role","button"),this._swfReference._swf.setAttribute("aria-label",this.get("selectButtonLabel")),this._swfReference._swf.focus())},this);this._tabElementBindings.tabback=this._swfReference.on("tabback",function(){this._swfReference._swf.blur();setTimeout(function(){c.focus()},30)},this);this._tabElementBindings.tabforward=this._swfReference.on("tabforward",
function(){this._swfReference._swf.blur();setTimeout(function(){e.focus()},30)},this);this._tabElementBindings.focus=this._swfReference._swf.on("focus",function(){this._buttonFocus=!0;this._setButtonClass("focus",!0)},this);this._tabElementBindings.blur=this._swfReference._swf.on("blur",function(){this._buttonFocus=!1;this._setButtonClass("focus",!1)},this)}else null!==this._tabElementBindings&&(this._tabElementBindings.from.detach(),this._tabElementBindings.to.detach(),this._tabElementBindings.tabback.detach(),
this._tabElementBindings.tabforward.detach(),this._tabElementBindings.focus.detach(),this._tabElementBindings.blur.detach())},_setButtonClass:function(b,c){c?this.get("selectFilesButton").addClass(this.get("buttonClassNames")[b]):this.get("selectFilesButton").removeClass(this.get("buttonClassNames")[b])},_setFileFilters:function(){this._swfReference&&0<this.get("fileFilters").length&&this._swfReference.callSWF("setFileFilters",[this.get("fileFilters")])},_setMultipleFiles:function(){this._swfReference&&
this._swfReference.callSWF("setAllowMultipleFiles",[this.get("multipleFiles")])},_triggerEnabled:function(){this.get("enabled")?(this._swfReference.callSWF("enable"),this._swfReference._swf.setAttribute("aria-disabled","false"),this._setButtonClass("disabled",!1)):(this._swfReference.callSWF("disable"),this._swfReference._swf.setAttribute("aria-disabled","true"),this._setButtonClass("disabled",!0))},_getFileList:function(){return this._fileList.concat()},_setFileList:function(b){this._fileList=b.concat();
return this._fileList.concat()},_updateFileList:function(c){b.one("body").focus();this._swfReference._swf.focus();c=c.fileList;var e=[],d=[],f=this._swfReference,g=this.get("fileFilterFunction");b.each(c,function(b){var c={};c.id=b.fileId;c.name=b.fileReference.name;c.size=b.fileReference.size;c.type=b.fileReference.type;c.dateCreated=b.fileReference.creationDate;c.dateModified=b.fileReference.modificationDate;c.uploader=f;e.push(c)});g?b.each(e,function(c){c=new b.FileFlash(c);g(c)&&d.push(c)}):
b.each(e,function(c){d.push(new b.FileFlash(c))});0<d.length&&(c=this.get("fileList"),this.set("fileList",this.get("appendNewFiles")?c.concat(d):d),this.fire("fileselect",{fileList:d}))},_uploadEventHandler:function(b){switch(b.type){case "file:uploadstart":this.fire("fileuploadstart",b);break;case "file:uploadprogress":this.fire("uploadprogress",b);break;case "uploaderqueue:totaluploadprogress":this.fire("totaluploadprogress",b);break;case "file:uploadcomplete":this.fire("uploadcomplete",b);break;
case "uploaderqueue:alluploadscomplete":this.queue=null;this.fire("alluploadscomplete",b);break;case "file:uploaderror":case "uploaderqueue:uploaderror":this.fire("uploaderror",b);break;case "file:uploadcancel":case "uploaderqueue:uploadcancel":this.fire("uploadcancel",b)}},upload:function(c,e,d){e=e||this.get("uploadURL");d=d||this.get("postVarsPerFile");var f=c.get("id");d=d.hasOwnProperty(f)?d[f]:d;c instanceof b.FileFlash&&(c.on("uploadstart",this._uploadEventHandler,this),c.on("uploadprogress",
this._uploadEventHandler,this),c.on("uploadcomplete",this._uploadEventHandler,this),c.on("uploaderror",this._uploadEventHandler,this),c.on("uploadcancel",this._uploadEventHandler,this),c.startUpload(e,d,this.get("fileFieldName")))},uploadAll:function(b,c){this.uploadThese(this.get("fileList"),b,c)},uploadThese:function(b,c,e){this.queue||(c=c||this.get("uploadURL"),e=e||this.get("postVarsPerFile"),this.queue=new g({simUploads:this.get("simLimit"),errorAction:this.get("errorAction"),fileFieldName:this.get("fileFieldName"),
fileList:b,uploadURL:c,perFileParameters:e,retryCount:this.get("retryCount")}),this.queue.on("uploadstart",this._uploadEventHandler,this),this.queue.on("uploadprogress",this._uploadEventHandler,this),this.queue.on("totaluploadprogress",this._uploadEventHandler,this),this.queue.on("uploadcomplete",this._uploadEventHandler,this),this.queue.on("alluploadscomplete",this._uploadEventHandler,this),this.queue.on("alluploadscancelled",function(){this.queue=null},this),this.queue.on("uploaderror",this._uploadEventHandler,
this),this.queue.startUpload(),this.fire("uploadstart"))}},{FLASH_CONTAINER:'<div id="{swfContainerId}" style="position:absolute; top:0px; left: 0px; margin: 0; padding: 0; border: 0; width:100%; height:100%"></div>',SELECT_FILES_BUTTON:"<button type='button' class='yui3-button' tabindex='-1'>{selectButtonLabel}</button>",TYPE:"flash",NAME:"uploader",ATTRS:{appendNewFiles:{value:!0},buttonClassNames:{value:{hover:"yui3-button-hover",active:"yui3-button-active",disabled:"yui3-button-disabled",focus:"yui3-button-selected"}},
enabled:{value:!0},errorAction:{value:"continue",validator:function(b){return b===g.CONTINUE||b===g.STOP||b===g.RESTART_ASAP||b===g.RESTART_AFTER}},fileFilters:{value:[]},fileFilterFunction:{value:null},fileFieldName:{value:"Filedata"},fileList:{value:[],getter:"_getFileList",setter:"_setFileList"},multipleFiles:{value:!1},postVarsPerFile:{value:{}},selectButtonLabel:{value:"Select Files"},selectFilesButton:{valueFn:function(){return b.Node.create(f(b.UploaderFlash.SELECT_FILES_BUTTON,{selectButtonLabel:this.get("selectButtonLabel")}))}},
simLimit:{value:2,validator:function(b){return 2<=b&&5>=b}},swfURL:{valueFn:function(){return 0<b.UA.ie?"flashuploader.swf?t="+b.guid("uploader"):"flashuploader.swf"}},tabElements:{value:null},uploadURL:{value:""},retryCount:{value:3}}});b.UploaderFlash.Queue=g},"3.17.2",{requires:"swfdetect escape widget base cssbutton node event-custom uploader-queue".split(" ")});
YUI.add("squarespace-dialog-oauth-service-connect-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-oauth-service-connect.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+('<div class="sqs-content-inner">\n\n  <div class="text">\n    <div class="title">'+b((l=(l=c.strings,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'</div>\n    <div class="message"></div>\n  </div>\n\n  <div class="fields"></div>\n\n  <div class="icon"></div>\n\n</div>\n')})})();
b.Handlebars.registerPartial("dialog-oauth-service-connect.html".replace("/","."),d.templates["dialog-oauth-service-connect.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-domain-errors",function(b){b.namespace("Squarespace.Widgets");var d=b.Base.create("domainMessage",b.Squarespace.Widgets.SSWidget,[],{},{ATTRS:{title:{},message:{}},CSS_PREFIX:"sqs-domain-message",HANDLEBARS_TEMPLATE:"domain-message.html"});b.Squarespace.Widgets.DomainWarning=b.Base.create("domainWarning",d,[],{},{CSS_PREFIX:"sqs-domain-warning"});var c=b.Squarespace.Widgets.DomainError=b.Base.create("domainError",d,[],{renderUI:function(){b.Squarespace.Widgets.DomainError.superclass.renderUI.apply(this,
arguments);this.get("contentBox").append('<div class="check-button">Check Again</div>')},bindUI:function(){b.Squarespace.Widgets.DomainError.superclass.bindUI.apply(this,arguments);this.get("contentBox").one(".check-button").on("click",function(b){b.halt();this.fire("check-domain-status")},this)}},{ATTRS:{errors:{value:[]}},CSS_PREFIX:"sqs-domain-error",HANDLEBARS_TEMPLATE:"domain-error.html"});b.Squarespace.Widgets.LinkedDomainPropagationWarning=b.Base.create("linkedDomainPropagationWarning",c,[],
{},{CSS_PREFIX:"sqs-linked-domain-propagation-warning"});c=b.Squarespace.Widgets.DomainInfo=b.Base.create("domainInfo",d,[],{},{CSS_PREFIX:"sqs-domain-info"});d=b.Squarespace.Widgets.DomainVerificationPending=b.Base.create("DomainVerificationPending",d,[],{renderUI:function(){b.Squarespace.Widgets.DomainError.superclass.renderUI.apply(this,arguments);this.get("contentBox").append('<div class="resend-button">Resend Email Verification</div>')},bindUI:function(){b.Squarespace.Widgets.DomainError.superclass.bindUI.apply(this,
arguments);this.get("contentBox").one(".resend-button").on("click",function(b){b.halt();this._resendVerificationEmail()},this)},_resendVerificationEmail:function(){this.get("contentBox").one(".resend-button").replace('<div id="sending">Sending...</div>');b.Data.post({url:"/api/rest/domains/"+this.get("domain.id")+"/verification-email",success:function(){this.get("contentBox").one("#sending").replace('<div id="sent">Email sent</div>')},failure:function(){this.get("contentBox").one("#sending").replace('<div id="sent">Failed to send email</div>')}},
this)}},{ATTRS:{errors:{value:[]},domain:{value:null}},CSS_PREFIX:"sqs-domain-verification-pending",HANDLEBARS_TEMPLATE:"domain-error.html"});b.Squarespace.Widgets.DomainVerificationSuspended=b.Base.create("DomainVerificationSuspended",d,[],{},{CSS_PREFIX:"sqs-domain-verification-suspended"});b.Squarespace.Widgets.DomainPropagationWarning=b.Base.create("domainPropagationWarning",c,[],{},{CSS_PREFIX:"sqs-managed-domain-propagation-warning"})},"1.0",{requires:["base-build","squarespace-ss-widget","squarespace-domain-error-template",
"squarespace-domain-message-template"]});
YUI.add("squarespace-dialog-hidden",function(b){var d=function(){};b.namespace("Squarespace.DialogFields").Hidden=b.Base.create("hidden",b.Squarespace.DialogField2,[],{initializer:function(){this.unplug(b.Plugin.WidgetAnim)},focus:null,enable:null,disable:null,blur:null,renderUI:d,bindUI:d,syncUI:d},{CSS_PREFIX:"sqs-hidden",ATTRS:{visible:{value:!1},focusable:{value:!1}}});b.Squarespace.DialogFields.HiddenField=b.Squarespace.DialogFields.Hidden},"1.0",{requires:["base","base-build","squarespace-dialog-field-2"]});
YUI.add("squarespace-widget-anim-tween",function(b){var d=b.namespace("Squarespace.Plugins").WidgetAnimTween=b.Base.create("sqsPluginWidgetAnimTween",b.Plugin.Base,[],{initializer:function(b){this.beforeHostMethod("_uiSetVisible",this._uiAnimSetVisible)},_uiAnimSetVisible:function(c){var e=this.get("host");if(e.get("rendered")){if(c){c=this.get("showTweenOptions");var d=c.onStart||function(){};c.onStart=b.bind(function(){this._uiSetVisible(!0);d()},this)}else{c=this.get("hideTweenOptions");var g=
c.onStop||function(){};c.onStop=b.bind(function(){this._uiSetVisible(!1);g()},this)}JSTween.tween(e.get("boundingBox").getDOMNode(),c);JSTween.play();return new b.Do.Prevent}},_uiSetVisible:function(b){var e=this.get("host"),d=e.getClassName("hidden");e.get("boundingBox").toggleClass(d,!b)}},{NS:"anim",TWEENS:{zoomFadeIn:function(){return{transform:{start:"scale(0.97)",stop:"scale(1)",time:0,duration:0.3,effect:"easeOut"},opacity:{start:0,stop:100,time:0,duration:0.3,effect:"easeOut"}}},zoomFadeOut:function(){return{transform:{start:"scale(1)",
stop:"scale(0.97)",time:0,duration:0.4,effect:"easeOut"},opacity:{start:100,stop:0,time:0,duration:0.4,effect:"easeOut"}}}},ATTRS:{showTweenOptions:{valueFn:function(){return d.TWEENS.zoomFadeIn()}},hideTweenOptions:{valueFn:function(){return d.TWEENS.zoomFadeOut()}}}})},"1.0",{requires:["base","plugin","thirdparty-jstween"]});
YUI.add("squarespace-configuration-menu",function(b){var d=b.Base.create("alignedBadge",b.Squarespace.Widgets.NumericBadge,[b.WidgetPosition],{},{CSS_PREFIX:"sqs-numeric-badge"});b.Squarespace.ConfigurationMenu=b.Base.create("configurationMenu",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this._dragDirectionXY=[1,1];this._dragLastXY=[0,0]},renderUI:function(){this.get("boundingBox").addClass("config-panel root depth-0");var c=this.get("contentBox");c.append('<div class="site-chooser-glyph">&nbsp;</div>');
this._navEl=b.Node.create('<div class="nav"></div>').appendTo(c);this._renderMenuItems();this._renderCommentBadge();this._renderFolder();this._renderFooter();this.get("sortable")&&(this.ddm=new b.DD.Delegate({container:this._navEl,cont:this._navEl,target:{},nodes:".nav-chunk",invalid:".folder, [data-fixed=true]"}),this.ddm.dd.plug(b.Plugin.DDProxy,{moveOnEnd:!1,cloneNode:!0}),this.ddm.syncTargets(),this._applyOrder())},_renderMenuItems:function(){b.Object.each(this.get("menuItemsData"),function(c,
e){var d=b.Node.create('<div class="nav-chunk nav-'+c.name+'"></div>');d.setAttribute("data-identifier",e);c.fixed&&d.setAttribute("data-fixed","true");var g=b.Node.create('<div class="nav-icon clear">');g.setStyle("backgroundImage","url("+c.icon+")");g.getDOMNode().data=c;if(parseInt(e,10)===b.Squarespace.ConfigurationMenuItemType.HELP){var h=b.Node.create('<a href="http://help.squarespace.com/" target="_blank"></a>');h.appendTo(d);g.appendTo(h)}else g.appendTo(d);this._isItemShowable(c)||d.addClass("hide");
d.appendTo(this._navEl);c.tip&&new b.Squarespace.ToolTip({target:d,title:c.tip.title,body:c.tip.body})},this)},_renderFooter:function(){this._footerWidget=new b.Squarespace.Widgets.ConfigurationFooter({render:this.get("contentBox"),memberAccount:this.get("memberAccount")})},_renderFolder:function(){this._folderEl=b.Node.create('<div class="nav-chunk folder empty"></div>');this._folderEl.setAttribute("data-fixed","true");this._folderEl.setAttribute("data-identifier",b.Squarespace.ConfigurationMenuItemType.FOLDER);
this._folderEl.appendTo(this._navEl);var c=b.Node.create('<div class="hatch"></div>');c.appendTo(this._folderEl);var e=b.Node.create('<div class="nav-icon clear"></div>');e.setStyle("backgroundImage","url(/universal/images-v6/icons/icon-dotdotdot-32-light.png)");e.appendTo(c);c.append('<div class="shading"></div>');this._folderContentsEl=b.Node.create('<div class="contents"></div>').appendTo(this._folderEl);this._ddViewportEl=b.Node.create('<div class="dd-viewport"></div>')},_renderCommentBadge:function(){var c=
this._navEl.one(".nav-chunk.nav-dashboard");if(c){var e=Static.SQUARESPACE_CONTEXT.websiteSettings.disqusShortname;this.commentBadge=new d({value:Static.SQUARESPACE_CONTEXT.website.unmoderatedCommentCount,visible:b.Lang.isUndefined(e)||""===e,render:c});this.commentBadge.get("boundingBox").setStyle("position","absolute");this.commentBadge.move(60,c.getY()+c.get("offsetHeight")/4)}},bindUI:function(){this.get("boundingBox").on("click",this.onPanelClick,this);this.on("click:module",this.onNavButtonClick,
this);this.after("selectionChange",this.syncUI,this);this.after("menuItemsChange",this.onMenuItemsChange,this);if(this.commentBadge)b.Global.on("sqsContextChange",this.onContextChange,this);this._folderEl.on("mouseover",this.onFolderMouseOver,this);this._folderEl.on("mouseout",this.onFolderMouseOut,this);this._folderEl.on("click",this.onFolderClick,this);if(this.ddm){this.ddm.dd.removeInvalid("a");this.ddm.on("drag:start",this.onDragStart,this);this.ddm.after("drag:end",this.onDragEnd,this);this.ddm.on("drag:drag",
this.onDragUpdate,this);this.ddm.on("drag:enter",this.onDragEnter,this);this.ddm.on("drag:exit",this.onDragExit,this);(new b.DD.Drop({node:this._navEl})).on("drop:enter",this.onDropEnterNav,this);var c=new b.DD.Drop({node:this._folderEl,padding:"0 0 5000 0"});c.on("drop:enter",this.onDropEnterFolder,this);c.on("drop:exit",this.onDropExitFolder,this);c.on("drop:hit",this.onDropHitFolder,this)}var e=this.get("memberAccount");this._registerEvent(e.on("displayNameChange",function(c){e.isMe()&&this.get("contentBox").one(".user-id .user-display-name").setContent(b.Escape.html(c.newVal))},
this));c=this.get("contentBox").one(".nav-notifications");b.Lang.isValue(c)&&(c.on("click",this._onNotificationNavClick,this),b.Squarespace.NotificationsService.after("notificationsChange",this.syncUI,this))},syncUI:function(){var c=this.get("selection");this._navEl.all(".nav-chunk").each(function(b){b.toggleClass("active",b.hasClass("nav-"+c))});this._syncNotification();this._folderEl.toggleClass("active",b.Lang.isValue(this._folderEl.one(".active")));this._folderEl.toggleClass("empty",!b.Lang.isValue(this._folderEl.one(".nav-chunk")))},
_syncNotification:function(){var c=this.get("contentBox").one(".nav-notifications");b.Lang.isValue(c)&&(this._isNotificationMenuItemOrdered()||this._navEl.insertBefore(c,this._folderEl),c.hasClass("active")&&this._navEl.all(".nav-chunk").removeClass("active"),0<b.Squarespace.NotificationsService.get("notifications").length?(c.addClass("nav-chunk").addClass("visible"),this._syncNotificationBadge(c)):this.get("contentBox").one(".nav-notifications").removeClass("nav-chunk").removeClass("visible"))},
_isNotificationMenuItemOrdered:function(){var c=this.get("menuItems");return!b.Lang.isArray(c)?!1:!!b.Array.find(c,function(c){return parseInt(c.identifier,10)===b.Squarespace.ConfigurationMenuItemType.NOTIFICATIONS})},_syncNotificationBadge:function(c){var e=c.one(".unread-badge");b.Lang.isValue(e)||(e=b.Node.create('<div class="unread-badge">'),c.append(e));e.set("innerHTML",b.Squarespace.NotificationsService.get("notifications").length)},_getOrder:function(b){var e=[];b.each(function(b){if(!b.hasClass("yui3-dd-draggable")){var c=
{identifier:b.getAttribute("data-identifier")};b.hasClass("folder")&&b.one(".nav-chunk")&&(c.items=this._getOrder(b.all(".nav-chunk")));e.push(c)}},this);return e},_applyOrder:function(){var c=this.get("menuItems");if(b.Lang.isArray(c)&&c.length)for(var e=c.length-1;0<=e;e--){var d=c[e];if(b.Lang.isArray(d.items))for(var g=0;g<d.items.length;g++){var h=this._navEl.one(".nav-chunk[data-identifier="+d.items[g].identifier+"]");h&&this._folderContentsEl.append(h)}else this._navEl.prepend(this._navEl.one(".nav-chunk[data-identifier="+
d.identifier+"]"))}this.syncUI()},_isItemShowable:function(c){return c.hidden||c.requiredPermission&&!b.Squarespace.Utils.userHasAccessPermission(c.requiredPermission)||c.hideWhenWebsiteStatusIs&&0<=c.hideWhenWebsiteStatusIs.indexOf(Static.SQUARESPACE_CONTEXT.website.siteStatus.value)||this._disableByPlan(Static.SQUARESPACE_CONTEXT.plan,c)?!1:!0},_disableByPlan:function(b,e){return-1!==(e.prohibitedForPlans||[]).indexOf(b)},_updateDDViewport:function(b){this._ddViewportEl.setStyle("height",this._folderEl.get("offsetTop")+
0.7*this._folderEl.get("offsetHeight"));this._ddViewportEl.setStyle("width",window.innerWidth);b&&this._ddViewportEl.setStyle("overflow",b)},getAvailableMenuItems:function(){var c={};b.Object.each(this.get("menuItemsData"),function(b){this._isItemShowable(b)&&(c[b.name]=!0,!c["default"]&&"home"!==b.name&&(c["default"]=b.name))},this);return c},getSelectionData:function(){var c=b.Object.values(this.get("menuItemsData")),e=this.get("selection");return b.Array.find(c,function(b){return b.name===e})},
onPanelClick:function(b){this.get("boundingBox").contains(b.target)&&(b.target.hasClass("nav-icon")?this.fire("click:module",{module:b.target.data().name}):null!==b.target.ancestor(".beta-tag",!0)&&this.fire("click:betatag"))},onNavButtonClick:function(){b.Lang.isValue(this._notificationsWidget)&&this._notificationsWidget.get("visible")&&this._notificationsWidget.hide()},onMenuItemsChange:function(c){b.Data.post({url:"/api/config/SaveConfigurationMenuItems",data:{order:JSON.stringify(this.get("menuItems"))}})},
onContextChange:function(){this.commentBadge.set("value",Static.SQUARESPACE_CONTEXT.website.unmoderatedCommentCount)},onFolderMouseOver:function(b){this._folderEl.addClass("open")},onFolderMouseOut:function(b){this._navEl.hasClass("dragging")||this._folderEl.removeClass("open")},onFolderClick:function(b){this._folderEl.toggleClass("open")},onDragStart:function(b){var e=b.target.get("node");b=b.target.get("dragNode");b.addClass("drag-proxy");this._ddViewportEl.appendTo(this._navEl);this._ddViewportEl.append(b);
this._updateDDViewport(this._folderEl.contains(e)?"visible":"hidden");this._navEl.addClass("dragging")},onDragEnd:function(b){this._ddViewportEl.remove();this._navEl.removeClass("dragging");this._folderEl.removeClass("disabled");this.set("menuItems",this._getOrder(this.get("boundingBox").all(".nav>.nav-chunk")));this.syncUI()},onDragUpdate:function(c){c=c.target.lastXY;this._dragDirectionXY=[c[0]<this._dragLastXY[0]?-1:1,c[1]<this._dragLastXY[1]?-1:1];this._dragLastXY=c;b.DD.DDM.syncActiveShims(!0)},
onDragEnter:function(c){var e=c.drag.get("node"),d=c.drop.get("node");c=this._folderEl.contains(e);this._updateDDViewport(c?"visible":"hidden");if(d.hasClass("nav-chunk")&&!d.hasAttribute("data-fixed")){var g=d;if(c&&0<this._dragDirectionXY[0]||!c&&0<this._dragDirectionXY[1])g=d.get("nextSibling");d.hasPlugin(b.Squarespace.PositionAnimator.NS)||(d.plug(b.Squarespace.PositionAnimator),d.positionAnimator.after("released",function(){d.drop.sizeShim();d.drop.overTarget=!1},this));d.positionAnimator.hold();
d.get("parentNode").insertBefore(e,g);d.positionAnimator.release(!0)}},onDragExit:function(b){this._folderEl.contains(b.drag.get("node"))||this._folderEl.addClass("disabled").removeClass("open")},onDropEnterFolder:function(c){var e=c.drag.get("node");c.drag.get("dragNode").addClass("over-folder");this._folderEl.contains(e)&&(this._folderEl.get("parentNode").insertBefore(e,this._folderEl),c=e.get("offsetHeight"),e.setStyle("height",0),e=e.anim({height:c},{duration:0.2,easing:b.Easing.strongOut}),e.on("tween",
this._updateDDViewport,this),e.run())},onDropExitFolder:function(b){b.drag.get("dragNode").removeClass("over-folder")},onDropHitFolder:function(c){var e=c.drag.get("node");c=c.drag.get("dragNode");if(!this._folderEl.contains(e)){var d=e.cloneNode(!0);d.removeClass("yui3-dd-dragging");d.setStyle("opacity",0);e.get("parentNode").insertBefore(d,e);d.anim({height:0},{duration:0.2,easing:b.Easing.strongOut,end:function(){d.remove(!0)}}).run();e.appendTo(this._folderContentsEl);var g=e.cloneNode(!0);g.removeClass("yui3-dd-dragging");
g.setStyle("position","absolute");g.setStyle("opacity",1);g.setXY([c.getX()-this._folderEl.getX(),Math.min(c.getY()-this._folderEl.getY(),this._folderEl.get("offsetHeight"))]);g.appendTo(this._folderEl);g.anim({left:0,top:0,opacity:0},{duration:0.2,easing:b.Easing.strongOut,end:function(){g.remove(!0)}}).run()}},onDropEnterNav:function(b){this._folderEl.addClass("disabled").removeClass("open")},_onNotificationNavClick:function(c){c.halt();this._navEl.all(".nav-chunk").each(function(b){b.removeClass("active")});
c=c.target.ancestor(".nav-notifications",!0);b.Lang.isValue(this._notificationsWidget)||(this._notificationsWidget=new b.Squarespace.Widgets.Notifications({render:this._navEl,buttonNode:c,visible:!1,overlay:!0}),this._notificationsWidget.on("close",this.syncUI,this));this._notificationsWidget.toggleVisibility();this._folderEl.removeClass("open");this._notificationsWidget.get("visible")?b.Squarespace.EscManager.addTarget(this._notificationsWidget):b.Squarespace.EscManager.removeTarget(this._notificationsWidget)}},
{CSS_PREFIX:"sqs-configuration-menu",ATTRS:{sortable:{writeOnce:!0,value:!0},selection:{value:""},menuItems:{value:[]},memberAccount:{},menuItemsData:{writeOnce:!0,valueFn:function(){var c={},e=b.Squarespace.ConfigurationMenuItemType;c[e.HOME]={title:"View Site",icon:"/universal/images-v6/content/icon-preview-32-light.png",name:"home",tip:{title:"Preview",body:"Exit the Squarespace manager and view your website as visitors would see it."}};c[e.CONTENT]={title:"Content",icon:"/universal/images-v6/content/icon-content-32-light.png",
name:"content",tip:{title:"Content Manager",body:"The content manager is home to all of the content on your site.  Add more pages and manage your site content from here."},hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_CONTENT_MANAGER};c[e.DASHBOARD]={title:"Activity",icon:"/universal/images-v6/content/icon-stats-32-light.png",name:"dashboard",tip:{title:"Activity",body:"The activity area lets you manage comments and view site statistics."},
hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_ACTIVITY,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]};c[e.SETTINGS]={title:"Settings",icon:"/universal/images-v6/content/icon-settings-32-light.png",name:"settings",tip:{title:"Settings",body:"Settings gives you control over member accounts, basic site preferences, domains, fonts, and more."},requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS};c[e.HELP]={title:"Help",
icon:"/universal/images-v6/configuration/nav-help.png",name:"help",tip:{title:"Help",body:"Help is just a click away. Click here to visit the Squarespace Help Center where you can search through the knowledgebase and contact Customer Care."}};c[e.NOTIFICATIONS]={title:"Notifications",icon:"/universal/images-v6/configuration/nav-notifications-sm.png",name:"notifications",tip:{title:"Notifications",body:"The latest news and updates from Squarespace."}};b.Squarespace.Utils.isNewslettersEnabled()&&(c[e.NEWSLETTERS]=
{title:"Newsletters",icon:"/universal/images-v6/content/icon-newsletters-32-light.png",name:"newsletters",tip:{title:"Newsletters",body:"Compose and manage your email newsletters."},hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_NEWSLETTER});c[e.COMMERCE]={title:"Commerce",icon:"/universal/images-v6/icons/icon-commerce-25-light-solid.png",name:"commerce",tip:{title:"Commerce",body:"The commerce area lets you configure your site for selling products and accepting donations. Manage orders, configure tax rates, create coupons, and more."},
hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]};return c}}}})},"1.0",{requires:"anim attribute base dd dd-delegate dd-drag dd-drop dd-proxy json node squarespace-account-menu squarespace-commerce-utils squarespace-common squarespace-dombuilder squarespace-enum squarespace-gizmo squarespace-numeric-badge squarespace-ss-widget squarespace-ui-base squarespace-widgets-configuration-footer squarespace-widgets-notifications widget widget-position".split(" ")});
YUI.add("squarespace-content-manager-widgets-base",function(b){b.Intl.add("content-manager-widgets-base","en",{example_content_subtitle:"Use the controls on the right to either remove this page or make it your own."});b.Intl.add("content-manager-widgets-base","en-damask",{example_content_subtitle:"Use the controls above your site preview to either remove this page or make it your own."});b.Intl.setLang("content-manager-widgets-base",b.Squarespace.Utils.isDamaskEnabled()?"en-damask":"en");var d=b.namespace("Squarespace.ContentManagerWidgets").Base=
b.Base.create("ContentManagerBase",b.Squarespace.Widgets.DataWidget,[b.WidgetChild,b.WidgetParent],{initializer:function(){this.headerTray=this.add(b.merge({childType:b.Squarespace.Widgets.LibraryManagerHeaderTray},this._getHeaderTrayOptions())).item(0);this.collectionConfigurationEditor=new b.Squarespace.Editor.Collection({model:this.get("collection")});this.disabledTray=this.add(b.merge({childType:b.Squarespace.Widgets.ActionTray,"strings.title":"Page Disabled",className:"page-disabled","strings.subtitle":"This page will only be visible to administrators and editors until it is enabled.",
showThreshold:0,count:0,buttons:[{label:"Enable",action:this._toggleEnabled,context:this,className:"dark"}]})).item(0);this.disabledTray.set("visible",!this.get("collection").get("enabled"));this.unsupportedTray=this.add(b.merge({childType:b.Squarespace.Widgets.ActionTray,"strings.title":"Unsupported Collection","strings.subtitle":"This page will not be rendered on the frontend.",showThreshold:0,count:0,buttons:[{label:"Configure",action:function(c){this.hasUnsavedChanges()?this.ensureSavedChanges(b.bind(this.openCollectionConfigureDialog,
this)):this.openCollectionConfigureDialog()},context:this,className:"dark no-frame"}]})).item(0);this.unsupportedTray.set("visible",!this.get("collectionConfiguration").get("supported"));var c=[{label:"Make a Page Like This",action:function(c){this.hasUnsavedChanges()?this.ensureSavedChanges(b.bind(function(){this.get("collection").cloneToNewCollection()},this)):this.get("collection").cloneToNewCollection()},context:this,className:"dark"},{label:"Remove Example Page",action:function(c){this.hasUnsavedChanges()?
this.ensureSavedChanges(b.bind(this.removeExampleCollection,this)):this.removeExampleCollection()},context:this,className:"dark"}];this.exampleContentTray=this.add(b.merge({childType:b.Squarespace.Widgets.ActionTray,"strings.title":"Example Content","strings.subtitle":b.Intl.get("content-manager-widgets-base","example_content_subtitle"),className:"example-content-tray",showThreshold:0,count:0,buttons:c})).item(0);this.exampleContentTray.set("visible",this.get("collection").get("isDemoCollection"))},
renderUI:function(){this.headerTray.render(this.get("contentBox"));this.get("contentBox").prepend(this.headerTray.get("boundingBox"));this.exampleContentTray.render(this.get("boundingBox"))},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("collection");this.collectionConfigurationEditor.on("page-duplicated",function(c){this.get("root").set("selectedCollection",b.Squarespace.ContentCollectionCache.getById(c.collection.get("id")))},this);this._registerEvent(c.on("titleChange",function(b){this.headerTray.set("strings.title",
b.newVal)},this));this._registerEvent(c.on("enabledChange",function(b){this.disabledTray.set("visible",!b.newVal)},this));this._registerEvent(c.on("urlIdChange",function(c){b.Array.each(this.headerTray.get("buttons"),function(b){"view-page"==b.className&&(b.href=c.newVal)})},this));this._registerEvent(c.after("clonedExampleContent",function(b){this.headerTray.set("buttons",this._getHeaderTrayOptions().buttons);this.syncUI()},this));this._registerEvent(b.on(this.get("id")+"|key",function(c){!this.get("collection").get("isDemoCollection")&&
(0===b.Squarespace.OPEN_DIALOGS.length&&!c.target.ancestor("input, textarea, [contenteditable=true]",!0))&&(this.hasUnsavedChanges()?this.ensureSavedChanges(b.bind(this.handleAddContentRequest,this)):(this.handleAddContentRequest(),c.halt()))},window,"down:32",this))},syncUI:function(){var b=this.get("collection"),e=b.get("isDemoCollection");this.disabledTray.set("visible",!b.get("enabled"));this.unsupportedTray.set("visible",!this.get("collectionConfiguration").get("supported"));this.exampleContentTray.set("visible",
e);var b=this.get("boundingBox"),d=this.headerTray.get("contentBox").one(".title");e?(b.one(".content-overlay")||(b.addClass("has-example-content-overlay"),b.append('<div class="content-overlay sqs-disable-drag-selection"></div>')),d.one(".demo-collection-tag")||d.append('<div class="demo-collection-tag">Example Page</div>')):((e=b.one(".content-overlay"))&&e.remove(!0),b.removeClass("has-example-content-overlay"),(e=d.one(".title .demo-collection-tag"))&&e.remove(!0))},_toggleEnabled:function(){var c=
this.get("collection");c.set("enabled",!c.get("enabled"));var e=c.get("enabled"),d=b.bind(function(){if(e&&!c.get("enabled"))(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Upgrade","strings.title":"Page Limit Reached","strings.message":"This collection cannot be enabled because you have exceeded the maximum number of pages allowed by your current plan (20). Upgrade to the <strong>Unlimited</strong> plan to enable more pages."})).on("confirm",function(){CONFIG_PANEL.getHistory().replace({module:"settings",
"settings-subPanelName":"billing-settings"})})},this);if(e)c.save({},d);else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Disable Collection","strings.message":"Are you sure you wish to disable this collection?"})).on("confirm",function(){c.save({},d)},this)},hasUnsavedChanges:function(){console.warn("hasUnsavedChanges not implemented!");return!1},ensureSavedChanges:function(b){console.warn("ensureSavedChanges not implemented.");b()},_getHeaderTrayOptions:function(){var c=this.get("collection"),
e=c.getTemplateConfiguration();e&&(typeLabel=e.get("title"));typeLabel||(typeLabel=(c.get("typeName")||"Page").capitalize());var d=[];b.Cookie.get("damask")||d.push({label:"View "+typeLabel,className:"view-page light",href:c.get("urlId"),action:function(e){this.hasUnsavedChanges()?(e.halt(),this.ensureSavedChanges(b.bind(CONFIG_PANEL.showSite,CONFIG_PANEL,{targetUrl:c.get("fullUrl")}))):(e.stopPropagation(),CONFIG_PANEL.showSite({targetUrl:c.get("fullUrl")}))},context:this});c.get("isDemoCollection")||
(d.push({label:"Settings",className:"settings light",action:function(b){this.openCollectionConfigureDialog()},context:this}),this.get("addContentButtonVisible")&&(e||console.warn("No collectionConfiguration found. Somethings wrong here."),e=(e?e.get("addText"):null)||"Add Content",b.Cookie.get("damask")&&(e="New"),d.push({label:e,className:"add primary",action:this.handleAddContentRequest,context:this})));d=b.Array.map(d,function(b){b.className=(b.className||"")+" no-frame";return b});return{strings:{title:b.Squarespace.Utils.isDamaskEnabled()?
c.get("navigationTitle"):c.get("title"),subtitle:""},buttons:d,visible:!0}},openCollectionConfigureDialog:function(){this.collectionConfigurationEditor.show()},handleAddContentRequest:function(){throw"Not implemented.";},closeOpenDialogs:function(){var c=b.Object.values(b.Squarespace.BlockType);if(0<b.Squarespace.OPEN_DIALOGS.length)for(var e=0;e<b.Squarespace.OPEN_DIALOGS.length;++e){var d=b.Squarespace.OPEN_DIALOGS[e].getAnchorData();d&&(b.Lang.isValue(d.type)&&-1!==c.indexOf(d.type))&&b.Squarespace.OPEN_DIALOGS[e].close()}},
removeExampleCollection:function(){b.Squarespace.NavigationUIUtils.deleteCollection(this.get("collection"))}},{ASYNC_DATA:!0,CSS_PREFIX:"sqs-content-manager-base",ATTRS:{collection:{},collectionConfiguration:{},addContentButtonVisible:{value:!0},helpSectionIdentifier:{value:"welcome"}}})},"1.0",{requires:"base squarespace-ss-widget squarespace-editor-collection squarespace-content-item-types-editor squarespace-content-item-types-selector squarespace-abtest squarespace-content-manager-navigation-ui-utils squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-models-shopping-cart",function(b){b.namespace("Squarespace.Models");b.namespace("Squarespace.Singletons");var d=b.Squarespace.Models.ShoppingCart=b.Base.create("shoppingCart",b.Model,[],{initializer:function(){this.publish("item-added",{emitFacade:!0});this.publish("loaded",{emitFacade:!0});this.publish("recalculate-start",{emitFacade:!0});this.publish("recalculate-end",{emitFacade:!0});this._isRecalculating=this._readInProgress=!1;this.on("recalculate-start",function(){this._isRecalculating=
!0},this);this.on("recalculate-end",function(){this._isRecalculating=!1},this)},toJSON:function(){var c=d.superclass.toJSON.call(this),e=c.created;b.Lang.isNull(e)||(c.created=e.getTime());return c},sync:function(b,e,d){switch(b){case "read":this._read(e,d)}},load:function(c,e,d){"function"===typeof c&&(e=c,c={});this._readinProgress?this.after("load",e,d):b.Model.prototype.load.call(this,c,e?b.bind(e,d||this):null)},isRecalculating:function(){return this._isRecalculating},hasEntry:function(c,e){return b.Array.reduce(this.get("entries"),
!1,function(d,g){return b.Lang.isValue(e)?d||g.itemId==c&&e.sku==g.chosenVariant.sku:d||g.itemId==c})},addEntry:function(c,e,d,g,h,k){b.Data.post({url:"/api/commerce/shopping-cart/entries",headers:{"Content-Type":"application/json"},data:b.JSON.stringify({itemId:c,sku:b.Lang.isValue(e)?e.sku:null,quantity:d,additionalFields:b.JSON.stringify(g)}),success:function(c){b.Squarespace.CommerceAnalytics.itemAdded(c);this.setAttrs(c.shoppingCart);this.fire("item-added");b.Lang.isFunction(h)&&h.call(k||this,
null,c.newlyAdded)},failure:function(c){c.crumbFail&&(b.Squarespace.Utils.areCookiesEnabled()?c.error="Your session has expired. Please reload the page and try again.":c.error="Please enable cookies in your browser, reload the page, and try again.");b.Lang.isFunction(h)&&h.call(k||this,c.message,null)}},this)},updateFormSubmission:function(c,e,d,g){var h=c.chosenVariant;this.fire("recalculate-start");b.Data.put({headers:{"Content-Type":"application/json"},url:b.Lang.sub("/api/commerce/shopping-cart/entries/{entryId}/additionalFields",
{entryId:c.id}),data:b.JSON.stringify({itemId:c.itemId,sku:b.Lang.isValue(h)?h.sku:null,additionalFields:b.JSON.stringify(e)}),success:function(c){this.fire("recalculate-end");this.setAttrs(c.shoppingCart);b.Lang.isFunction(d)&&d.call(g||this,null,c.updatedEntry)},failure:function(c){this.fire("recalculate-end");b.Lang.isFunction(d)&&d.call(g||this,c.message,null)}},this)},updateQuantity:function(c,e,d,g){var h=c.chosenVariant;this.fire("recalculate-start");b.Data.put({headers:{"Content-Type":"application/json"},
url:b.Lang.sub("/api/commerce/shopping-cart/entries/{entryId}",{entryId:c.id}),data:b.JSON.stringify({itemId:c.itemId,sku:b.Lang.isValue(h)?h.sku:null,quantity:e}),success:function(c){this.fire("recalculate-end");0===e?b.Squarespace.CommerceAnalytics.itemRemoved(c):b.Squarespace.CommerceAnalytics.itemModified(c);this.setAttrs(c.shoppingCart);b.Lang.isFunction(d)&&d.call(g||this,null,c.updatedEntry)},failure:function(c){this.fire("recalculate-end");b.Lang.isFunction(d)&&d.call(g||this,c.message,null)}},
this)},updateShippingLocation:function(c,e,d){this.fire("recalculate-start");b.Data.put({url:"/api/commerce/shopping-cart/shipping-location",data:c,success:function(c){this.fire("recalculate-end");this.setAttrs(c);b.Lang.isFunction(e)&&e.call(d||this,null)},failure:function(c){this.fire("recalculate-end");b.Lang.isFunction(e)&&e.call(d||this,c.message,null)}},this)},updateShippingMethod:function(c,e,d){this.fire("recalculate-start");b.Data.put({url:"/api/commerce/shopping-cart/selected-shipping-option",
data:{shippingOptionId:c},success:function(c){this.fire("recalculate-end");this.setAttrs(c);b.Lang.isFunction(e)&&e.call(d||this,null)},failure:function(c){this.fire("recalculate-end");b.Lang.isFunction(e)&&e.call(d||this,c.message,null)}},this)},addCoupon:function(c,e,d){b.Data.post({url:"/api/commerce/shopping-cart/coupons",data:{promoCode:c},success:function(c){this.setAttrs(c);b.Lang.isFunction(e)&&e.call(d||this,null)},failure:function(c){b.Lang.isFunction(e)&&e.call(d||this,c.message,null)}},
this)},removeCoupon:function(c,e,d){b.Data.del({url:"/api/commerce/shopping-cart/coupons/"+c,success:function(c){this.setAttrs(c);b.Lang.isFunction(e)&&e.call(d||this,null)},failure:function(c){b.Lang.isFunction(e)&&e.call(d||this,c.message,null)}},this)},_read:function(c,e){this._readInProgress=!0;this.fire("loading");b.Data.get({url:"/api/commerce/shopping-cart",success:function(b){this.fire("loaded");this._readInProgress=!1;e(null,b)},failure:function(b){this.fire("loaded");this._readInProgress=
!1;e(b.message,null)}},this)}},{ATTRS:{id:{validator:b.Lang.isString},websiteId:{validator:b.Lang.isString},orderId:{validator:b.Lang.isString},created:{getter:function(c){return b.Lang.isValue(c)?new Date(c):null},setter:function(c){return b.Lang.isDate(c)?c.getTime():c},validator:b.Lang.isNumber},isPurchased:{value:!1,validator:b.Lang.isBoolean},entries:{value:[],validator:b.Lang.isArray},shippingOptions:{value:[],validator:b.Lang.isArray},selectedShippingOption:{validator:b.Lang.isObject},shippingLocation:{validator:b.Lang.isObject},
applicableTaxRules:{value:[],validator:b.Lang.isArray},coupons:{value:[],validator:b.Lang.isArray},validCoupons:{value:[],validator:b.Lang.isArray},invalidCoupons:{value:[],validator:b.Lang.isArray},subtotalCents:{validator:b.Lang.isNumber,value:0},taxCents:{validator:b.Lang.isNumber,value:0},shippingCostCents:{validator:b.Lang.isNumber,value:0},discountCents:{validator:b.Lang.isNumber,value:0},grandTotalCents:{validator:b.Lang.isNumber,value:0},totalQuantity:{validator:b.Lang.isNumber,value:0},hasDigital:{validator:b.Lang.isBoolean,
value:!1},purelyDigital:{validator:b.Lang.isBoolean,value:!1},requiresShipping:{validator:b.Lang.isBoolean,value:!1}}});b.Squarespace.Singletons.ShoppingCart=new d},"1.0",{requires:["base","model","squarespace-commerce-utils","squarespace-commerce-analytics"]});
YUI.add("squarespace-content-item-types-base-panel",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.BasePanel=b.Base.create("ContentItemEditorPanel",b.Squarespace.ModelEditorPanel,[b.Squarespace.Mixins.CustomSanitizer],{initializer:function(b){this.publish("fields-rendered",{emitFacade:!0})},renderUI:function(){this.get("contentBox").append(this.get("targetNode"));d.superclass.renderUI.call(this)},getFieldData:function(){var c=this.get("model"),e=this.get("model").toJSON();
e.workflow={state:b.Squarespace.ContentItemUtils.getWorkflowStateIdentifier(e.workflowState),date:e.publishOn};e.commenting={state:b.Squarespace.ContentItemUtils.getCommentStateIdentifier(e.commentState),date:e.commentDisableOn};e.mainImage=c;e.gallery=c;e.clickthroughUrl&&(e.clickthroughUrl={url:e.clickthroughUrl});this.setDataForCustomType(e,this.getCustomTypeConfiguration(),this);return e},sanitizeFieldData:function(c){delete c.author;delete c.mainImage;this._normalizeDates(c);this._attachCommentingToData(c);
this._attachWorkflowToData(c);c.tags=c.tags||[];c.categories=c.categories||[];delete c.id;delete c.gallery;b.Lang.isObject(c.clickthroughUrl)&&(c.clickthroughUrl=c.clickthroughUrl.url);this.sanitizeDataForCustomType(c,this.getCustomTypeConfiguration(),this);return c},getCustomTypeConfiguration:function(){var c,e=this.get("model").get("customContent.customType");b.Lang.isValue(e)&&(c=b.Squarespace.Singletons.Template.get("customTypes."+e));return c||null},_getWorkflowStateForString:function(c){return b.Object.getValue({published:b.Squarespace.WorkflowStates.PUBLISHED,
scheduled:b.Squarespace.WorkflowStates.SCHEDULED,needsreview:b.Squarespace.WorkflowStates.NEEDS_REVIEW,draft:b.Squarespace.WorkflowStates.DRAFT},c)},_attachWorkflowToData:function(b){b.workflowState=this._getWorkflowStateForString(b.workflow.state);b.publishOn=b.workflow.date;delete b.workflow},_attachCommentingToData:function(c){c.commentState=b.Squarespace.CommentStates["allow"===c.commenting.state?"ENABLED":"DISABLED"];c.commentDisableOn=c.commenting.date;delete c.commenting},_normalizeDates:function(c){b.Array.each("addedOn publishOn updatedOn commentDisableOn startDate endDate".split(" "),
function(e,d){b.Lang.isDate(c[e])?c[e]=c[e].getTime():b.Lang.isNumber(c[e])&&console.warn(e+" should really be a date. Should fix this.")},this)},_routeAction:function(b){switch(b){case "saveAndPublish":this._publishPost();break;default:d.superclass._routeAction.call(this,b)}},_getTemplateContext:function(){var c=this.get("model").toJSON(),e=this.get("model").get("collectionId");b.Squarespace.ContentCollectionCache.getCollectionById(e,function(b){c.urlPrefix="/"+b.get("urlId")+"/"});c.presentationName=
this.get("strings.presentationName");c.model=this.get("model");c.editor=this;return c},getTemplateContext:function(){var b=this._getTemplateContext();this.sanitizeTemplateContextForCustomType(b,this.getCustomTypeConfiguration());return b},_publishPost:function(){var c=this.get("panel");this.get("model").set("workflowState",b.Squarespace.WorkflowStates.PUBLISHED);var c=c.getField("workflow"),e=c.getValue();c.setValue({state:"published",date:e.date?e.date:(new Date).getTime()});this._saveAndClose()}},
{CSS_PREFIX:"sqs-content-item-editor-panel",ATTRS:{makeContext:{value:b.Squarespace.ContentItemEditorSettings},strings:{value:{presentationName:"Item"}},targetNode:{value:b.Node.create('<div class="settings-panel-fields">')}}})},"1.0",{requires:"base node squarespace-content-item-types-enum-record-type squarespace-content-item-types-mixin-custom-sanitizer squarespace-content-item-types-settings squarespace-content-item-utils squarespace-dialog-description squarespace-enum squarespace-model-editor-panel squarespace-models-content-collection squarespace-models-content-item squarespace-models-template".split(" ")});
YUI.add("squarespace-tourtip",function(b){b.mix(b.Node.DOM_EVENTS,{DOMNodeRemoved:!0});b.namespace("Squarespace").Tourtip=b.Base.create("tourtip",b.Widget,[],{initializer:function(d){var c={type:"tooltip",bodyContent:this._getContent(),zIndex:5E4};config=b.merge(c,d);if(config["align.node"]&&!b.one(config["align.node"])||config.align&&config.align.node&&!b.one(config.align.node))console.warn("The node specified as a target for the tooltip is missing: "+(config["align.node"]||config.align.node));else{this.alignNode=
b.one(config["align.node"]||(config.align?config.align.node:null));this.panel=new b.Squarespace.Panel(config);this.after("titleChange",this._setContent,this,this._getContent);this.after("bodyChange",this._setContent,this,this._getContent);this.after("iconChange",this._setContent,this,this._getContent);if(this.alignNode)this.alignNode.on("DOMNodeRemoved",this.hide,this);this.panel.on("click",this.hide,this);!b.Lang.isUndefined(config.hideIn)&&0<config.hideIn&&b.later(config.hideIn,this,this.hide)}},
hide:function(d){this.hidden||(d&&d.preventDefault(),this.hidden=!0,this.panel&&(d=new b.Anim({node:this.panel.get("boundingBox"),to:{opacity:0},duration:0.15}),d.on("end",function(){this.destroyer();this.fire("hidden")},this),d.run()))},_getContent:function(){var d=this.get("title"),c=this.get("body"),e=this.get("icon"),e=b.Node.create('<div class="'+this.getClassName()+" "+this.getClassName(e)+'"></div>');d&&e.append('<div class="'+this.getClassName("title")+'">'+d+"</div>");d=b.Node.create('<div class="'+
this.getClassName("body")+'"></div>');d.setContent(c);e.append(d);return e},_setContent:function(b){this.panel.set("bodyContent",b)},destroyer:function(){this.panel.destroy()}},{CSS_PREFIX:"sqs-tourtip",NAME:"tip",ATTRS:{icon:{value:"open",validator:function(b){return"info"===b||"question"===b||"okay"===b||"alert"===b||"open"===b}},title:{},body:{},direction:{value:"below"}}})},"0.1.0",{requires:["node","squarespace-panel"]});
YUI.add("squarespace-dialog-state-scheduler",function(b){var d=b.namespace("Squarespace.DialogFields").StateScheduler2=b.Base.create("stateScheduler",b.Squarespace.DialogField2,[b.WidgetChild,b.WidgetParent],{initializer:function(c){this.get("contentBox");c=b.Lang.isValue(c.data)?new Date(c.data):new Date;var e=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,{format:"%M"})),d=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,{format:"%p"})),g=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,{format:"%l"}));
this._widgets=[];this._widgets[0]=new b.Squarespace.DialogFields.InsetCalendar({name:"calendar",data:c});this._widgets[1]=new b.Squarespace.DialogFields.InsetTimer({name:"timer",data:{minutes:Number(e),ampm:d,hours:Number(g)}});this._widgets[2]=new b.Squarespace.DialogFields.Slider({name:"slider",range:["duration"===this.get("type")&&this.get("allowNever")?-1:0,90],data:this.get("durationOffset"),labelWidth:0,length:260,visible:"duration"===this.get("type"),thumbUrl:"/universal/images-v6/dialog/slider-thumb-dark.png"})},
destructor:function(){b.Array.each(this._widgets,function(b,e){b.detach();b.destroy()})},renderUI:function(){d.superclass.renderUI.call(this);this.get("data");var c=this.get("type"),e=this.get("contentBox");e.one(".title").set("text",this.get("strings.title"));this._widgets[0].render(e.one(".sqs-state-scheduler-components"));this._widgets[1].render(e.one(".sqs-state-scheduler-components"));"duration"===c&&(this._durationEl=b.Node.create('<div class="duration-wrapper"></div>'),this._durationEl.append(b.Node.create('<div class="duration-display"><span class="duration"></span></div><div class="slider-container-wrapper"></div>')),
e.one(".sqs-state-scheduler-options").append(this._durationEl),this._widgets[2].render(e.one(".slider-container-wrapper")),this._widgets[2].show())},syncUI:function(){d.superclass.syncUI.call(this);this._widgets[2].get("visible")&&this._durationEl.one(".duration").set("text",this.getShortDurationText())},bindUI:function(){d.superclass.bindUI.call(this);this._widgets[0].after("dataChange",this._mergeDateTimeComponents,this);this._widgets[1].after("dataChange",this._mergeDateTimeComponents,this);this._widgets[2].after("dataChange",
this._updateTimeOffset,this);this.get("contentBox").delegate("click",this.destroy,".close",this)},_mergeDateTimeComponents:function(c){c=this._widgets[0].get("data");var e=b.merge(this._widgets[1].get("data"),{});if(b.Lang.isNull(c))this.get("allowNever")?(this.set("durationOffset",-1),this.set("data",null)):this.set("data",Date.now());else{var d=e.ampm,g=e.hours;12===g&&(g=0);"PM"===d&&(g+=12);e=e.minutes;c=b.Squarespace.DateUtils.createWebsiteDate(c.getFullYear(),c.getMonth(),c.getDate(),g,e);this.set("durationOffset",
b.Squarespace.DateUtils.calculateFullDayOffset(new Date,c));this.set("data",c)}},_updateTimeOffset:function(b){if(-1===b.newVal&&this.get("allowNever"))this._widgets[0].set("data",null),this._widgets[1].disable();else{this._widgets[1].enable();var e=new Date;e.addDays(b.newVal);this._widgets[0].setAttrs({day:e.getDate(),month:e.getMonth(),year:e.getFullYear(),data:e})}},getShortDurationText:function(){var c=this.get("data"),c=this.get("allowNever")&&b.Lang.isNull(c),e=this.get("durationOffset");return-1===
e&&c?"Never":0===e?"Today":1==e?"Tomorrow":-1==e?"Yesterday":-1>e?Math.abs(e)+" Days ago":Math.abs(e)+" Days"}},{CSS_PREFIX:"sqs-state-scheduler",TEMPLATE:'<div class="sqs-state-scheduler"><div class="close">x</div><div class="sqs-state-scheduler-options"><div class="title clear"></div><div class="sqs-state-scheduler-components clear"></div></div></div>',ATTRS:{allowNever:{value:!1},data:{setter:function(c){return b.Lang.isDate(c)?c.getTime():c}},day:{value:1,setter:function(b){return parseInt(b,
10)}},durationOffset:{value:0},strings:{value:{title:"Select a Date &amp; Time"}},type:{value:"date",validator:function(b){validTypes=["duration","date"];return-1!==validTypes.indexOf(b)}}}})},"1.0",{requires:"base base-build slider squarespace-dialog-fields squarespace-dialog-field-2 squarespace-dialog-slider squarespace-dialog-statepicker-inset-timer squarespace-dialog-statepicker-inset-calendar squarespace-timezone-tools squarespace-date-utils".split(" ")});
YUI.add("squarespace-models-site-user-list",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.SiteUserList=b.Base.create("SiteUserList",b.Squarespace.Models.ModelList,[b.Squarespace.Mixins.PaginatedModelList],{model:b.Squarespace.Models.SiteUser,url:"/api/site-users?subscriberStates=APPROVED"},{ATTRS:{paginator:{valueFn:function(){return new b.Squarespace.Models.RangePaginator({models:this,limit:18,orderBy:"subscriber.createdOn",orderDirection:b.Squarespace.OrderDirection.DESCENDING})}}}})},
"1.0",{requires:["base","squarespace-mixins-paginated-model-list","squarespace-models-model-list","squarespace-models-range-paginator","squarespace-models-site-user"]});
YUI.add("squarespace-calendar-core-renderer",function(b){var d=function(c){return c.recordType===b.Squarespace.RecordType.EVENT?c.structuredContent.startDate:c.addedOn};b.Squarespace.SquarespaceCalendar=b.Base.create("SquarespaceCalendar",b.Calendar,[],{initializer:function(){this._fetchEvents()},bindUI:function(){b.Calendar.superclass.bindUI.call(this);this.before("dateChange",this._clearEvents,this);this.after("dateChange",this._fetchEvents,this);this.after("collectionIdChange",this._fetchEvents,
this)},_clearEvents:function(){this.set("events",[])},_fetchEvents:function(){var c=this.get("date"),c=b.DataType.Date.format(c,{format:"%B-%Y",locale:"en"});b.Data.get({url:this._getFetchUrl(c),success:this._parseResponse,failure:this._handleResponseError},this)},_parseResponse:function(b){this.set("events",b)},_handleResponseError:function(c){console.error("Failed fetch data: "+c);new b.Squarespace.Widgets.Alert({"strings.title":"Server Request Failed","strings.message":"Failed to get calender data, "+
c.message})},_getFetchUrl:function(b){return"/api/open/GetItemsByMonth?collectionId="+this.get("collectionId")+"&month="+b}},{ATTRS:{events:{value:[],validator:b.Lang.isArray},collectionId:{value:null,validator:b.Lang.isString}}});b.Squarespace.CalendarBaseRenderer=b.Base.create("CalendarBaseRenderer",b.Plugin.Base,[],{initializer:function(b){this.host=b.host;this.afterHostEvent("eventsChange",this._onEventsChange,this)},_onEventsChange:function(c){var e=null;b.Lang.isArray(c.newVal)&&0<c.newVal.length&&
(e=b.bind(this._calendarFilterFunction,this));this.host.set("customRenderer",{rules:{all:"events"},filterFunction:e})},_calendarFilterFunction:function(b,e,d){d=this.host.get("events");d=this._getEventsOfDay(d,b);this._sortEvents(d);this._renderDay(b,e,d)},_renderDay:function(b,e,d){0<d.length&&e.setStyle("background","gray")},_sortEvents:function(b){b.sort(function(b,c){var g=d(b);return d(c)-g})},_getEventsOfDay:function(c,e){var d=b.DataType.Date.format(e,{format:"%Y-%m-%d"});return b.Lang.isArray(c)&&
0<c.length?b.Array.filter(c,function(b){return this._isEventPartOfDay(b,d)},this):[]},_isEventPartOfDay:function(c,e){var d,g;g=c.structuredContent;if(c.recordType!==b.Squarespace.RecordType.EVENT)return d=b.Squarespace.DateUtils.dateFormat(c.addedOn,{format:"%Y-%m-%d"}),d===e;d=b.Squarespace.DateUtils.dateFormat(g.startDate,{format:"%Y-%m-%d"});g=b.Squarespace.DateUtils.dateFormat(g.endDate,{format:"%Y-%m-%d"});return e==d||e==g||new Date(e)>new Date(d)&&new Date(e)<new Date(g)?!0:!1},_getEventDisplayTime:function(c){c=
d(c);return b.Squarespace.DateUtils.dateFormat(c,{format:"%l:%M%P"}).trim()},_isSameDay:function(c,e){if(c.recordType!==b.Squarespace.RecordType.EVENT)return!0;var d=b.Squarespace.DateUtils.dateFormat(c.structuredContent.startDate,{format:"%Y-%m-%d"}),g=b.DataType.Date.format(e,{format:"%Y-%m-%d"});return d===g}},{NS:"calendarPlugin"})},"1.0",{requires:["calendar","node","squarespace-ui-base","squarespace-date-utils","squarespace-widgets-alert"]});
YUI.add("squarespace-widgets-newsletter-message-editor-overlay-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-newsletter-message-editor-overlay.html"]=b(function(b,c,d,h,k){function l(b,c){return" hidden"}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p=this.escapeExpression;b='<div class="newsletters-edit-overlay ';(h=d.additionalClasses)?h=h.call(c,{hash:{},data:k}):(h=c.additionalClasses,h="function"===typeof h?
h.apply(c):h);b+=p(h)+'">\n    <div class="overlay-container">\n        <div class="close-button"></div>\n        <div class="horiz-center">\n            <div class="vert-center">\n                <span class="overlay-title">';(h=d.overlayTitle)?h=h.call(c,{hash:{},data:k}):(h=c.overlayTitle,h="function"===typeof h?h.apply(c):h);b+=p(h)+'</span>\n                <span class="overlay-message';if((h=d["if"].call(c,c.hideMessage,{hash:{},inverse:this.noop,fn:this.program(1,l,k),data:k}))||0===h)b+=h;
b+='">';(h=d.overlayMessage)?h=h.call(c,{hash:{},data:k}):(h=c.overlayMessage,h="function"===typeof h?h.apply(c):h);b+=p(h)+'</span>\n                <button class="overlay-send';if((h=d["if"].call(c,c.hideSend,{hash:{},inverse:this.noop,fn:this.program(1,l,k),data:k}))||0===h)b+=h;b+='">\n                    <span class="overlay-send-label">';(h=d.overlaySendLabel)?h=h.call(c,{hash:{},data:k}):(h=c.overlaySendLabel,h="function"===typeof h?h.apply(c):h);b+=p(h)+'</span>\n                </button>\n                <button class="overlay-cancel';
if((h=d["if"].call(c,c.hideCancel,{hash:{},inverse:this.noop,fn:this.program(1,l,k),data:k}))||0===h)b+=h;b+='">\n                    <span class="overlay-cancel-label">';(h=d.overlayCancelLabel)?h=h.call(c,{hash:{},data:k}):(h=c.overlayCancelLabel,h="function"===typeof h?h.apply(c):h);return b+=p(h)+"</span>\n                </button>\n            </div>\n        </div>\n    </div>\n</div>"})})();b.Handlebars.registerPartial("widgets-newsletter-message-editor-overlay.html".replace("/","."),d.templates["widgets-newsletter-message-editor-overlay.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-gallery-model",function(b){var d=b.namespace("Squarespace.ContentModel").GalleryBlock=b.Base.create("GalleryBlockModel",b.Model,[],{toJSON:function(){var b=d.superclass.toJSON.call(this);delete b.transientGallery;return b}},{ATTRS:{design:{value:"slideshow"},aspectRatio:{},autoplay:{},"autoplay-duration":{},controls:{},"auto-crop":{},"square-thumbs":{},thumbnails:{},"thumbnail-strip-height":{},"thumbnail-strip-margin":{},"show-meta":{},"meta-position":{},"show-meta-on-hover":{},
"active-alignment":{},"thumbnails-per-row":{},padding:{},lightbox:{},"max-width":{},collectionId:{},existingGalleryId:{},vSize:{},transientGallery:{setter:function(c){var e=this.get("transientGallery");b.Lang.isValue(e)&&b.Lang.isFunction(e.destroy)&&e.destroy();return!b.instanceOf(c,b.Squarespace.Models.ContentCollection)?new b.Squarespace.Models.ContentCollection(c):c},value:{}},transientGalleryId:{getter:function(c){return!b.Lang.isValue(c)&&b.Lang.isValue(this.get("transientGallery"))?this.get("transientGallery").get("id"):
c}}}})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-widgets-google-apps-suspended-subscription",function(b){b.namespace("Squarespace.Widgets.GoogleApps");var d=b.Squarespace.DialogFields.StateIndicatorBanner.STATES;b.Squarespace.Widgets.GoogleApps.SuspendedSubscription=b.Base.create("GoogleAppsSuspendedSubscription",b.Squarespace.Widgets.GoogleApps.BaseSubscription,[],{_getBannerConfig:function(){var c=this.get("model").get("suspensionDate"),c=b.DataType.Date.addDays(c,4),c=Math.round(Math.abs(((new Date).getTime()-c.getTime())/
864E5));return{name:"subscriptionState",data:1,stateDisplays:[{value:1,state:d.WARN,message:"Your Google Apps account has been suspended and will be removed in <strong>"+c+" days</strong>."}]}}},{CSS_PREFIX:"sqs-google-apps-suspended-subscription",ATTRS:{stateBannerConfig:{getter:"_getBannerConfig"}}})},"1.0",{requires:"base datatype-date-format datatype-date-math squarespace-dialog-state-indicator-banner squarespace-models-google-apps-subscription squarespace-widgets-google-apps-user-list-manager".split(" ")});
YUI.add("squarespace-block-image-editor",function(b){var d=b.namespace("Squarespace.Block.Editor").Image=b.Base.create("image-block-editor-dialog-web",b.Squarespace.Block.Editor.ImageBase,[],{initializer:function(){this._initResize();this._initOverlay()},_initOverlay:function(){var c=this._host.contentImage;this._overlay=b.Node.create('<div class="sqs-editing-overlay"></div>');c.get("contentBox").append(this._overlay);this._editingChangeHandle=c.on("editingChange",function(b){b.newVal?this._overlay.hide():
this._overlay.show()},this)},syncUI:function(){var b=this._host.contentImage.get("model"),c=b.get("imageId"),b=b.get("processing");c&&!b?this._initResize():this._destroyResize()},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Image")},_initConfigDialog:function(){var b=d.superclass._initConfigDialog.call(this);b.set("imageContentModel",this._host.contentImage.get("model"));b.set("imageContentWidget",this._host.contentImage);return b},
destructor:function(){this._editingChangeHandle.detach();this._destroyResize();this._overlay.destroy()},_initResize:function(){function c(){var b=k.get("boundingBox").get("region");return 100*(b.height/b.width)}function d(){var b=k.get("model").get("dimensions");return 100*(b.height/b.width)}if(this._model.get("imageId")){var g=this.get("host"),h=g.get("boundingBox"),k=g.contentImage;if(!k.get("boundingBox")[b.Plugin.Resize.NS]){g.plug(b.Squarespace.WidgetResize,{resizeNode:k.get("boundingBox")});
var l=h.one(".yui3-resize-handles-wrapper");h.appendChild(l);var p=k.get("boundingBox").resize;p.on("handle-dblclick",function(){k.get("model").set("aspectRatio",d())},this);p.on("resize:start",function(c){b.Lang.isValue(this._model.get("vSize"))&&this._model.set("vSize",null);c=g.contentImage.contentEditor;this.resizeStartEditingState=c.get("editing");c.set("editing",!1);g.get("editController").disableInsertPoints()},this);p.on("resize:resize",function(b){var c=k.get("boundingBox").get("region"),
e=g.get("boundingBox").get("region");b=g.get("boundingBox").one(".yui3-resize-handle-b").get("region");var d=k.get("model").get("dimensions"),f=p.delegate.dd,h=f.mouseXY[1];this.mouseDelta||(this.mouseDelta=b.bottom-b.height/2-h);var l=c.width/d.width,c=parseInt(d.height,10)*l+(c.top+(e.bottom-c.bottom));h>c-10&&h<c+10&&(f.actXY[1]=c-b.height/2)},this);p.after("resize:resize",function(b){k.get("model").set("aspectRatio",c(),{silent:!0})});p.on("resize:end",function(b){this.mouseDelta=null;g.contentImage.contentEditor.set("editing",
this.resizeStartEditingState);this._host.get("editController").enableInsertPoints()},this);p.after("resize:end",function(){k.get("model").set("vSize",null);k.get("model").set("aspectRatio",c())})}}},_destroyResize:function(){var c=this._host.contentImage.get("boundingBox");c.resize&&this._host.unplug(b.Squarespace.WidgetResize);c.setStyles({width:null,height:null,border:null,margin:null})}},{NS:"blockEditor"}),c=b.namespace("Squarespace.Block.ModelEditorDialog").Image=b.Base.create("blockImageEditorDialog",
b.Squarespace.ModelEditorDialog,[],{_showDialog:function(){c.superclass._showDialog.call(this);var e=this.get("dialog");e.once("ready",function(c){this._syncClickThroughNodeVisibility();b.Lang.isValue(e.getField("lightbox"))&&e.getField("lightbox").after("dataChange",this._syncClickThroughNodeVisibility,this);e.getField("image").after("dataChange",function(){this._syncContentImage()},this);this._syncContentImage()},this);var d=this.get("imageContentModel");d.on("focalPointChange",function(b){var c=
e.getField("image");c&&c.setFocalPointPluginValue(b.newVal)});d.after("imageIdChange",function(c){var h=e.getField("image");if(h)if(c.newVal){var k=new b.Squarespace.Models.ContentItem({id:d.getImageContentItemField("id"),mediaProcessingState:b.Squarespace.MediaProcessingState.QUEUED});k.load(function(){h.set("data",k);h.syncUI()})}else h.set("data",null)},this)},_syncClickThroughNodeVisibility:function(){var c=this.get("dialog"),d=c.getField("clickThrough").get("contentBox");b.Lang.isValue(c.getField("lightbox"))?
c.getField("lightbox").get("data")?d.hide():d.show():d.show()},getDialogData:function(){var c=this.get("model").toJSON(),d=c.linkTo;b.Lang.isString(d)&&(c.clickThrough={url:d,newWindow:c.newwindow});c.description={html:c.description};c.image=new b.Squarespace.Models.ContentItem({id:c.imageId});c.filename=this.get("imageContentModel").getImageContentItemField("filename");return c},sanitizeDialogData:function(c){c.lightbox?(c.linkTo="",c.newwindow=!1):c.clickThrough&&c.clickThrough.url?(c.linkTo=c.clickThrough.url,
c.newwindow=c.clickThrough.newWindow):(c.linkTo="",c.newwindow=!1);b.Lang.isValue(c.image)?c.imageId=c.image.get("id"):c.imageId=null;return{linkTo:c.linkTo,newwindow:c.newwindow,lightbox:c.lightbox,layout:c.layout,stretch:c.stretch,filename:c.filename}},_syncContentImage:function(){var c=this.get("dialog").getData(),d=this.get("id"),g=null,h=c.image;b.Lang.isValue(h)&&(g=h.get("id"),h.detach(d+"|*"),h.after(d+"|mediaProcessingStateChange",function(b){this.get("imageContentModel").applyAttrsFromContentItem(h);
h.load()},this),h.after(d+"|assetUrlChange",function(c){this.get("imageContentModel").set("aspectRatio",null);this.get("imageContentModel").applyAttrsFromContentItem(h);this.get("imageContentWidget").syncUI();this.get("imageContentWidget").contentEditor.set("editing",b.Lang.isValue(this.get("imageContentWidget").imgNode))},this),h.after(d+"|mediaFocalPointChange",function(b){this.get("imageContentModel").set("focalPoint",b.newVal)},this));this.get("imageContentModel").setAttrs({imageId:g})},save:function(b,
d,g){this._syncContentImage();c.superclass.save.apply(this,arguments)},_getDialogConfig:function(){return{name:"imageBlockConfig",initialDataByReference:!0,width:400,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?652:490}},buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Image",icon:"/universal/images-v6/icons/icon-image-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.FileImage,transientStore:!0,
height:168,contentType:"image",name:"image",autoSaveFocalPoint:!0},{ctor:b.Squarespace.DialogFields.Select,config:{name:"layout",className:"thin dark",defaultValue:"caption-below",options:[{value:"caption-hidden",label:"Do Not Display Caption"},{value:"caption-below",label:"Caption Below"},{value:"caption-overlay",label:"Caption Overlay"},{value:"caption-overlay-hover",label:"Caption Overlay on Hover"}]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"filename",strings:{title:"Filename",description:"Optional. Set the file name that will appear in image URLs.",
placeholder:"something.jpg"},className:"thin dark"}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"stretch",strings:{title:"Stretch",description:"Stretch the image to span the container."}}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"lightbox",strings:{title:"Lightbox",description:"Clicking on the image will enlarge the image into a lightbox."}}},{ctor:b.Squarespace.DialogFields.CreateLink,config:{name:"clickThrough","strings.title":"Clickthrough URL",condensed:!0}}]}]}}},{ATTRS:{dialogConfig:{valueFn:"_getDialogConfig"},
imageContentModel:{},imageContentWidget:{}}})},"1.0",{requires:"base squarespace-block-image-editor-base squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-create-link squarespace-dialog-file-image squarespace-dialog-select squarespace-dialog-text squarespace-model-editor".split(" ")});
YUI.add("squarespace-hb-money-format",function(b){b.Handlebars.registerHelper("money-format",function(d,c){return b.Squarespace.Commerce.moneyFormat(d)})},"1.0",{requires:["handlebars-base","squarespace-commerce-utils"]});
YUI.add("squarespace-dialog-social-account-picker",function(b){var d=b.namespace("Squarespace.DialogFields").SocialAccountPicker=b.Base.create("socialAccountPicker",b.Squarespace.DialogField2,[],{initializer:function(c){this._multiSelect=new b.Squarespace.DialogFields.MultiSelect({children:this._toToggles(c.accounts),data:c.data,draggable:!0});this.add(this._multiSelect);this._authenticator=new b.Squarespace.SocialAuthenticator},_toToggles:function(c){return b.Array.map(c,function(c){return new b.Squarespace.DialogFields.SocialAccountToggle({account:c})})},
_getData:function(){var b=[];this._multiSelect&&(b=this._multiSelect.get("data"));return b},renderUI:function(){d.superclass.renderUI.call(this);this.get("contentBox").append(b.Node.create('<header><button type="button" class="add-account-button"><span>Add Account</span></button></header>'))},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox").one(".add-account-button"),e=this.get("id");b.on(e+"|click",this._addNewAccount,this);this._multiSelect.on(e+"|dataChange",function(){var b=
this.get("dialog");b&&b.fire("datachange",this)},this)},_addNewAccount:function(){this._authenticator.once("account-added",function(){b.Data.get({url:"/api/config/GetSocialAccounts",success:function(c){var e=this.get("data");this._multiSelect.removeAll();Static.SQUARESPACE_CONTEXT.connectedAccounts=c.connectedAccounts;c=this._toToggles(b.Array.filter(c.connectedAccounts,function(b){return!!b.profileUrl}));b.Array.each(c,function(b){this._multiSelect.add(b);b.set("active",-1!==e.indexOf(b.get("account.id")))},
this);this._multiSelect._ddDel.syncTargets()}},this)},this);this._authenticator.addAccount()}},{CSS_PREFIX:"sqs-social-account-picker",ATTRS:{accounts:{},data:{getter:"_getData"}}})},"1.0",{requires:"base base-build squarespace-dialog-field-2 squarespace-dialog-social-account-toggle squarespace-dialog-multi-select squarespace-social-authenticator".split(" ")});
YUI.add("file-html5",function(b,d){var c=b.bind,e=b.config.win,f=function(b){var c=null,c=f.isValidFile(b)?b:f.isValidFile(b.file)?b.file:!1;f.superclass.constructor.apply(this,arguments);if(c&&f.canUpload()){this.get("file")||this._set("file",c);this.get("name")||this._set("name",c.name||c.fileName);if(this.get("size")!=(c.size||c.fileSize))this._set("size",c.size||c.fileSize);this.get("type")||this._set("type",c.type);c.hasOwnProperty("lastModifiedDate")&&!this.get("dateModified")&&this._set("dateModified",
c.lastModifiedDate)}};b.extend(f,b.Base,{initializer:function(c){this.get("id")||this._set("id",b.guid("file"))},_uploadEventHandler:function(b){var c=this.get("xhr");switch(b.type){case "progress":this.fire("uploadprogress",{originEvent:b,bytesLoaded:b.loaded,bytesTotal:this.get("size"),percentLoaded:Math.min(100,Math.round(1E4*b.loaded/this.get("size"))/100)});this._set("bytesUploaded",b.loaded);break;case "load":if(200<=c.status&&299>=c.status){this.fire("uploadcomplete",{originEvent:b,data:b.target.responseText});
b=c.upload;var e=this.get("boundEventHandler");b.removeEventListener("progress",e);b.removeEventListener("error",e);b.removeEventListener("abort",e);c.removeEventListener("load",e);c.removeEventListener("error",e);c.removeEventListener("readystatechange",e);this._set("xhr",null)}else this.fire("uploaderror",{originEvent:b,data:c.responseText,status:c.status,statusText:c.statusText,source:"http"});break;case "error":this.fire("uploaderror",{originEvent:b,data:c.responseText,status:c.status,statusText:c.statusText,
source:"io"});break;case "abort":this.fire("uploadcancel",{originEvent:b});break;case "readystatechange":this.fire("readystatechange",{readyState:b.target.readyState,originEvent:b})}},startUpload:function(e,d,f){this._set("bytesUploaded",0);this._set("xhr",new XMLHttpRequest);this._set("boundEventHandler",c(this._uploadEventHandler,this));var l=new FormData;f=f||"Filedata";var p=this.get("xhr"),q=this.get("xhr").upload,r=this.get("boundEventHandler");b.each(d,function(b,c){l.append(c,b)});l.append(f,
this.get("file"));p.addEventListener("loadstart",r,!1);q.addEventListener("progress",r,!1);p.addEventListener("load",r,!1);p.addEventListener("error",r,!1);q.addEventListener("error",r,!1);q.addEventListener("abort",r,!1);p.addEventListener("abort",r,!1);p.addEventListener("loadend",r,!1);p.addEventListener("readystatechange",r,!1);p.open("POST",e,!0);p.withCredentials=this.get("xhrWithCredentials");b.each(this.get("xhrHeaders"),function(b,c){p.setRequestHeader(c,b)});p.send(l);this.fire("uploadstart",
{xhr:p})},cancelUpload:function(){var b=this.get("xhr");b&&b.abort()}},{NAME:"file",TYPE:"html5",ATTRS:{id:{writeOnce:"initOnly",value:null},size:{writeOnce:"initOnly",value:0},name:{writeOnce:"initOnly",value:null},dateCreated:{writeOnce:"initOnly",value:null},dateModified:{writeOnce:"initOnly",value:null},bytesUploaded:{readOnly:!0,value:0},type:{writeOnce:"initOnly",value:null},file:{writeOnce:"initOnly",value:null},xhr:{readOnly:!0,value:null},xhrHeaders:{value:{}},xhrWithCredentials:{value:!0},
boundEventHandler:{readOnly:!0,value:null}},isValidFile:function(b){return e&&e.File&&b instanceof File},canUpload:function(){return e&&e.FormData&&e.XMLHttpRequest}});b.FileHTML5=f},"3.17.2",{requires:["base"]});
YUI.add("squarespace-block-video",function(b){var d=b.Base.create("VideoBlockModel",b.Model,[],{toJSON:function(){var c={layout:this.get("layout"),overlay:this.get("overlay"),description:this.get("description"),hSize:this.get("hSize"),vSize:this.get("vSize"),floatDir:this.get("floatDir")},d=this.get("customThumb");b.Lang.isValue(d)&&(c.customThumb=d.get("id"));var g=this.get("oembed"),h=b.Lang.isObject(g);b.Array.forEach("html url width height providerName thumbnailUrl resolvedBy".split(" "),function(b){c[b]=
h?g[b]:this.get(b)},this);return c}},{ATTRS:{customThumb:{setter:function(c){if(b.Lang.isString(c))return new b.Squarespace.Models.ContentItem({id:c});if(b.instanceOf(c,b.Squarespace.Models.ContentItem))return c}},oembed:{},layout:{value:"caption-hidden"},overlay:{value:!1},description:{value:{}}}}),c=b.namespace("Squarespace.Block").Video=b.Base.create("block-video",b.Squarespace.Block.ModelSyncBase,[],{bindUI:function(){c.superclass.bindUI.call(this);var b=this.get("model"),d=b.get("customThumb");
d&&this._bindImageListeners(d);b.on("customThumbChange",function(b){b.prevVal&&b.prevVal.detach(this.get("id")+"|*");b.newVal&&this._bindImageListeners(b.newVal)},this)},syncUI:function(){this.get("contentBox").all(".intrinsic").addClass("sqs-intrinsic")},_renderSuccess:function(e){e.html?(this.get("editController").isMobileApp()&&(e.html=e.html.replace(/("|'|&quot;)?\/\//g,function(b,c){return c?c+"http://":b})),c.superclass._renderSuccess.call(this,e),b.config.win.location.protocol.startsWith("https")&&
(e=this.get("contentBox").one("object embed"))&&e.setAttribute("src",e.getAttribute("src").replace("http://","https://")),this._pluginVideoLoader()):(this._renderError(),console.warn("Error rendering video block:",e))},_pluginVideoLoader:function(){var c=this.get("contentBox").one(".sqs-video-wrapper");c&&!c.hasPlugin(b.Squarespace.VideoLoader.NS)&&c.plug(b.Squarespace.VideoLoader)},refreshVideo:function(){var b=this.get("contentBox").one(".sqs-video-wrapper");b&&b.videoloader.refreshVideo()},_bindImageListeners:function(b){var c=
this.get("id");b.after(c+"|mediaProcessingStateChange",this._renderBlock,this);b.after(c+"|mediaFocalPointChange",function(b){var c=this.get("contentBox").one(".sqs-video-overlay img");if(c){var e=c.loader;c.setAttribute("data-image-focal-point",b.newVal.x+","+b.newVal.y);e.fire("refresh")}},this)}},{CSS_PREFIX:"sqs-block-video",MODEL:d,ATTRS:{editor:{valueFn:function(){return b.Squarespace.Block.Editor.Video}},mobileEditor:{valueFn:function(){return b.Squarespace.Block.Editor.VideoMobile}},type:{value:b.Squarespace.BlockType.VIDEO}}})},
"1.0",{requires:["squarespace-block-base-modelsync","squarespace-video-loader"]});
YUI.add("squarespace-block-editor-dialog",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.OPEN_DIALOGS=[];var d=b.Squarespace.Block.Editor.Dialog=b.Base.create("block-editor-dialog",b.Squarespace.Block.Editor.Base,[],{initializer:function(){this.configDialog=this._initConfigDialog();this._bindDialogEvents()},destructor:function(){this.configDialog.destroy()},_afterEditingChange:function(b){b.newVal&&this.configDialog&&this.configDialog.set("visible",!0);d.superclass._afterEditingChange.apply(this,
arguments);this._host.hasPlugin("insertPoint")&&this._host.insertPoint.toggleInsertPointsDisabled(b.newVal)},_plugInsertPoint:function(){d.superclass._plugInsertPoint.call(this);this._host.insertPoint.toggleInsertPointsDisabled(this.get("editing"))},_getModelEditor:function(){console.error("No Model Editor configured for: "+this.get("blockName"))},_initConfigDialog:function(){var c=this._getModelEditor();if(!b.Lang.isValue(c))return null;var c=new c({id:"editorDialog",model:this._model,anchorNode:this.get("dialogEditorAnchorNode"),
zIndex:9E3}),e=c.get("dialogConfig");if(this.get("lockedLayout")&&b.Lang.isArray(e.buttons)){var d=b.Array.filter(e.buttons,function(c){return!b.Lang.isValue(c)||"remove"!==c.type},this);e.buttons=d}c.set("dialogConfig",b.merge({closeOthers:!1,name:"block-configuration",style:"flyout",flyoutPointerDirection:"hidden",draggable:9!==b.UA.ie&&10!==b.UA.ie},e));return c},_bindDialogEvents:function(){if(!b.Lang.isNull(this.configDialog)){var c=this.configDialog.get("dialog");c.on("shown",function(){for(this._bb.addClass("sqs-edit-dialog-open");b.Squarespace.Block.Editor.OPEN_DIALOGS.length;)b.Squarespace.Block.Editor.OPEN_DIALOGS.shift().dialog.close();
b.Squarespace.Block.Editor.OPEN_DIALOGS.push({dialog:c,layout:this.get("host").get("boundingBox").ancestor(".sqs-layout")})},this);c.on("dismiss",this._onModelEditorDismiss,this);this.configDialog.on("nonSavingClose",function(){this.get("revertResizingOnCancel")&&(this._model.get("vSize")!==c.getData().vSize&&this._model.set("vSize",c.getData().vSize,{silent:!0}),this._model.get("aspectRatio")!==c.getData().aspectRatio&&this._model.set("aspectRatio",c.getData().aspectRatio))},this);c.on("render-anchor",
function(b){this._updateModel(this.configDialog.sanitizeDialogData(b))},this);c.on("remove-requested",function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Block","strings.message":"Are you sure you wish to remove this block?",className:"sqs-prevent-block-focus-change question",render:c.el&&c.el.ancestor("body")||!0})).on("confirm",function(){c.close(c,!0);this.fire("remove")},this)},this)}},_onModelEditorDismiss:function(c){var e=this.configDialog.get("dialog");this._disableEditing();
this._bb.removeClass("sqs-edit-dialog-open");b.Squarespace.Block.Editor.OPEN_DIALOGS=b.Array.filter(b.Squarespace.Block.Editor.OPEN_DIALOGS,function(b,c){return b.dialog!==e},this)}},{NS:"blockEditor",ATTRS:{blockName:{valueFn:function(){return b.Squarespace.StringUtils.toUpperCamelCase(this.get("host").get("blockTypeName"))}},editing:{value:!1},editingEvent:{value:["dblclick","contextmenu"]},editingOverlay:{valueFn:function(){return b.Node.create('<div class="sqs-editing-overlay"></div>')}},dialogEditorAnchorNode:{valueFn:function(){return this.get("host").get("contentBox")}},
revertResizingOnCancel:{value:!0},defaultEditingMode:{value:!0}}})},"1.0",{requires:"base plugin squarespace-util squarespace-block-editor-base squarespace-dialog-fields-generators squarespace-model-editor squarespace-string-utils squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-editor-form-product",function(b){b.namespace("Squarespace");b.Squarespace.ProductFormModelEditor=b.Base.create("productFormModelEditor",b.Squarespace.FormModelEditor,[],{initializer:function(){this.get("dialog").on("remove-requested",this._confirmAndRemove,this)},_confirmAndRemove:function(){var d=this.get("model"),c=d.isNew();(new b.Squarespace.Widgets.Confirmation({"strings.title":c?"Discard Form":"Delete Form","strings.message":c?"Are you sure you wish to discard this form?":
'Are you sure you wish to delete this form? Any products that are currently using this form in their Workflow settings will be set to "No Form Required".'})).on("confirm",function(){d.destroy({remove:!0});this.destroy()},this)}},{ATTRS:{dialogConfigStrings:{value:{title:"Edit Product Checkout Form",loadingText:"Editing Product Checkout Form..."}}}})},"1.0",{requires:["base","squarespace-editor-form","squarespace-ui-base","squarespace-widgets-confirmation"]});
YUI.add("squarespace-dialog-developer-registration-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-developer-registration.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n        <div class="text"><strong>Name: </strong>';(f=d.businessName)?f=f.call(b,{hash:{},data:c}):(f=b.businessName,f=typeof f===p?f.apply(b):f);e+=q(f)+'</div>\n        <div class="text"><strong>Email: </strong>';(f=d.businessEmailAddress)?f=f.call(b,{hash:{},
data:c}):(f=b.businessEmailAddress,f=typeof f===p?f.apply(b):f);e+=q(f)+'</div>\n        <div class="text"><strong>Phone Number: </strong>';(f=d.phoneNumber)?f=f.call(b,{hash:{},data:c}):(f=b.phoneNumber,f=typeof f===p?f.apply(b):f);e+=q(f)+'</div>\n        <div class="text"><strong>Address: </strong>';(f=d.streetAddress)?f=f.call(b,{hash:{},data:c}):(f=b.streetAddress,f=typeof f===p?f.apply(b):f);e+=q(f)+", ";(f=d.cityStateZip)?f=f.call(b,{hash:{},data:c}):(f=b.cityStateZip,f=typeof f===p?f.apply(b):
f);e+=q(f)+", ";(f=d.countryCode)?f=f.call(b,{hash:{},data:c}):(f=b.countryCode,f=typeof f===p?f.apply(b):f);e+=q(f)+'</div>\n        <div class="text"><strong>Website: </strong>';(f=d.businessWebsiteUrl)?f=f.call(b,{hash:{},data:c}):(f=b.businessWebsiteUrl,f=typeof f===p?f.apply(b):f);return e+=q(f)+"</div>\n      "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p="function",q=this.escapeExpression,r=this;if((c=d["if"].call(c,c.isDeveloperWithMarketingDetails,{hash:{},
inverse:r.program(4,function(b,c){return'\n\n   \n  <div class="developer-signup sqs-description">\n    <div class="title">Developer Registration</div>\n    <div class="text">Use this area to register your Squarespace member account as a developer. Registering as a developer will enable this account to access certain advanced developer features within our interface.</div>\n    <a href="#" class="signup">Register as a Developer</a>\n  </div> \n\n'},k),fn:r.program(1,function(b,c){var e,f;e='\n   \n  \n  <div class="developer sqs-description">\n    <div class="title">Developer Registration</div>\n    <div class="text"><strong>You are a registered developer, welcome to the developer platform!</strong> To enable developer mode on a website and begin accessing the source code, go to Settings &gt; Developer area in the website manager and flip the developer toggle in the upper right.</div>\n\n    <div class="developer-information">\n      ';
if((f=d["with"].call(b,b.marketingData,{hash:{},inverse:r.noop,fn:r.program(2,l,c),data:c}))||0===f)e+=f;return e+'\n    </div>\n\n    <a href="#" class="edit">Edit Developer Registration</a>\n  </div>\n  \n'},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("dialog-developer-registration.html".replace("/","."),d.templates["dialog-developer-registration.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-markdown-editor-email",function(b){b.namespace("Squarespace.Block.Editor").MarkdownEmail=b.Base.create("markdown-block-editor-dialog",b.Squarespace.Block.Editor.Markdown,[],{initializer:function(){this.get("host").set("floatable",!1)},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.MarkdownEmail")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Markdown"},minHSize:{value:2}}});var d=b.namespace("Squarespace.Block.ModelEditorDialog").MarkdownEmail=
b.Base.create("block-markdown-editor",b.Squarespace.Block.ModelEditorDialog.Markdown,[],{sanitizeDialogData:function(){var c=d.superclass.sanitizeDialogData.apply(this,arguments),e=b.Squarespace.Layout.EmailUtils.prepHtmlForEmail(c.html);c.html=e;return c}},{})},"1.0",{requires:["base","squarespace-block-markdown-editor","squarespace-damask-context-globals","squarespace-layout-email-utils"]});
YUI.add("squarespace-dialog-file-manager",function(b){b.namespace("Squarespace.DialogFields").FileManager=b.Base.create("fileManager",b.Squarespace.DialogField2,[],{initializer:function(){this._selectedLoaded=this._deletePrompt=this._committing=this._activeEditingEl=!1;this._reloadFromFirstPage()},renderUI:function(){var d=this.get("contentBox");d.prepend('<div class="search"></div><div class="attachments"></div>');d.one(".attachments").plug(b.Squarespace.ScrollLock);var c=new b.Squarespace.DialogFields.Text({"strings.placeholder":"search"});
c.render(d.one(".search"));this._searchInput=c.get("contentBox").one("input");this.renderAttachments()},renderAttachments:function(){this.get("contentBox").one(".attachments").empty().append(this.renderTemplate())},bindUI:function(){var d=this.get("contentBox");d.delegate("valuechange",function(b){this.set("searchQuery",b.newVal)},".search input",this);this.after("searchQueryChange",this._reloadFromFirstPage,this);this._searchInput.on("click",this._cancelAttachmentEdit,this);var c=d.one(".attachments");
c.plug(b.Plugin.ScrollInfo);c.scrollInfo.on("scroll",this._onScroll,this);d.delegate("mouseenter",function(b){!this._activeEditingEl&&!this._deletePrompt&&(d.all(".attachments .attachment").removeClass("active"),b.currentTarget.addClass("active"))},".attachments .attachment",this);d.delegate("mouseleave",function(b){!this._activeEditingEl&&!this._deletePrompt&&b.currentTarget.removeClass("active")},".attachments .attachment",this);d.delegate("click",this._onAttachmentListClick,".attachments",this);
d.delegate("click",this._enterAttachmentEditMode,".attachment .edit",this);d.delegate("key",this._commitAttachmentEdit,"press:13","input",this);d.delegate("click",this._onRemoveClick,".attachments .attachment .remove",this)},updateFullList:function(){this.set("searchQuery","");this._reloadFromFirstPage()},_reloadFromFirstPage:function(){var d=this.get("loadedItemsModel");d.reset();var c=this.get("searchQuery"),e=0<c.length,f;e?(f=this.get("searchResultsCurrentPageModel"),f.set("searchQuery",c)):f=
this.get("allItemsCurrentPageModel");f.firstPage();f.load({},b.bind(function(){d.add(f);var c=this.get("data");b.Lang.isString(c)&&(this._selectedLoaded=!1,d.some(function(b){if(b.get("urlId")===c)return d.add(d.remove(b),{index:0}),this._selectedLoaded=!0},this),!this._selectedLoaded&&!e&&this._loadSelected());this.renderAttachments()},this))},_loadNextPage:function(){var d;d=0<this.get("searchQuery").length?this.get("searchResultsCurrentPageModel"):this.get("allItemsCurrentPageModel");d.get("hasNextPage")&&
(d.nextPage(),d.load({},b.bind(function(){var c=this.get("data");b.Lang.isString(c)&&d.some(function(b){if(b.get("urlId")===c)return this._selectedLoaded?d.remove(b):this._selectedLoaded=!0,!0},this);this.get("loadedItemsModel").add(d);this.renderAttachments()},this)))},_loadSelected:function(){b.Data.get({url:b.Squarespace.API_ROOT+"content-items",data:{recordType:b.Squarespace.RecordType.ATTACHMENT,urlId:this.get("data")},success:function(d){d=b.Object.getValue(d,["results"]);if(!this._selectedLoaded&&
b.Lang.isArray(d)&&0!==d.length){this._selectedLoaded=!0;var c=new b.Squarespace.Models.ContentItem;c.setAttrs(d[0]);this.get("loadedItemsModel").add(c,{index:0});this.renderAttachments()}}},this)},_selectAttachment:function(b,c){if(!this._activeEditingEl){b=b.ancestor(".attachment",!0);var e=b.getAttribute("data-urlId");b.siblings(".selected").removeClass("selected");b.addClass("selected");this.set("data",e,{silent:c})}},_onScroll:function(b){b=b.currentTarget.get("host");0===b.get("scrollHeight")-
b.get("scrollTop")-b.height()&&this._loadNextPage()},_onAttachmentListClick:function(b){b.target.ancestor(".edit, .remove, .filename input",!0)||(this._activeEditingEl?this._commitAttachmentEdit():b.target.ancestor(".attachment",!0)&&this._selectAttachment(b.target.ancestor(".attachment",!0)))},_onRemoveClick:function(b){this._activeEditingEl&&this._cancelAttachmentEdit();this._promptDeleteAttachment(b)},_enterAttachmentEditMode:function(b){this._activeEditingEl&&this._cancelAttachmentEdit(b);this._activeEditingEl=
b.currentTarget.ancestor(".attachment");this._activeEditingEl.addClass("editing");this._activeEditingEl.one(".filename input").select();b.halt(!0)},_cancelAttachmentEdit:function(b){if((!b||!b.target.ancestor(".edit, .remove, .filename-editable",!0))&&!this._committing&&this._activeEditingEl){this._activeEditingEl.removeClass("editing");var c=this._activeEditingEl.one(".filename");c.one("input.filename-editable").set("value",c.one(".filename-text").get("text"));this._activeEditingEl=!1;b&&b.halt(!0)}},
_commitAttachmentEdit:function(d){this._committing=!0;if(this._activeEditingEl){d=this._activeEditingEl.getAttribute("data-id");var c=this._activeEditingEl.getAttribute("data-urlId"),e=this._activeEditingEl.one(".filename input.filename-editable");this._activeEditingEl.one(".filename input.filename-text");var f=e.get("value"),g=c===this.get("data");c!==f&&this.get("loadedItemsModel").getById(d).set("filename",f).save(b.bind(function(c,e){var d=b.JSON.parse(e.response);b.Lang.isNull(c)?(g&&this.set("data",
d.urlId,{silent:!0}),this._activeEditingEl.setAttribute("data-urlId",d.urlId),this._activeEditingEl.one(".filename-text").set("text",f),this._activeEditingEl.removeClass("editing"),this._activeEditingEl=!1):(d=b.Object.getValue(d,["errors","name"]),b.Lang.isString(d)&&new b.Squarespace.Widgets.Alert({"strings.title":"File Name Error","strings.message":d}));this._committing=!1},this))}},_promptDeleteAttachment:function(d){d.halt(!0);this._deletePrompt=!0;d=d.currentTarget.ancestor(".attachment",!0);
var c=d.getAttribute("data-id"),e=d.getAttribute("data-urlId");b.Squarespace.Fluent.Confirm({"strings.confirm":"Delete","strings.title":"Delete File","strings.message":"Are you sure you want to delete this file?"}).then(b.bind(function(){this._deletePrompt=!1;this._deleteAttachment(c,e)},this),b.bind(function(){this._deletePrompt=!1},this))},_deleteAttachment:function(d,c){this.get("loadedItemsModel").getById(d).destroy({remove:!0},b.bind(function(e){b.Lang.isNull(e)&&c===this.get("data")&&(this.set("data",
null,{silent:!0}),this._reloadFromFirstPage())},this))},_getHBTemplateContext:function(){return{attachments:this.get("loadedItemsModel").toJSON(),searchQuery:this.get("searchQuery"),selectedUrlId:this.get("data")}}},{CSS_PREFIX:"sqs-file-manager",ASYNC_DATA:!0,HANDLEBARS_TEMPLATE:"dialog-file-manager.html",ATTRS:{searchQuery:{value:"",validator:b.Lang.isString},loadedItemsModel:{value:new b.ModelList,validator:b.Squarespace.AttrValidators.isInstanceOf(b.ModelList)},allItemsCurrentPageModel:{value:new b.Squarespace.Models.AttachmentsList({pageSize:6}),
validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.AttachmentsList)},searchResultsCurrentPageModel:{value:new b.Squarespace.Models.SearchedAttachmentsList({pageSize:6}),validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.SearchedAttachmentsList)}}})},"1.0",{requires:"base base-build node-scroll-info squarespace-dialog squarespace-dialog-field-2 squarespace-dialog-file-manager-template squarespace-hb-compare squarespace-models-attachments-list squarespace-util squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-mixins-paginated-model-list",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.PaginatedModelList=b.Base.create("PaginatedModelList",b.Base,[],{initializer:function(){this.publish("firstPage");this.publish("previousPage");this.publish("nextPage");this.publish("currentPage");b.Do.after(function(){var d=this.get("paginator").paginateURL(b.Do.currentRetVal);return new b.Do.AlterReturn("Adding pagination params.",d)},this,"getURL",this);b.Do.before(function(d){d=
b.JSON.parse(d);this._set("hasPreviousPage",d.hasPreviousPage);this._set("hasNextPage",d.hasNextPage)},this,"parse",this)},firstPage:function(){this.get("paginator").firstPage();this.fire("firstPage")},previousPage:function(){this.get("paginator").previousPage();this.fire("previousPage")},nextPage:function(){this.get("paginator").nextPage();this.fire("nextPage")},currentPage:function(){this.get("paginator").currentPage();this.fire("currentPage")}},{ATTRS:{paginator:{valueFn:function(){return new b.Squarespace.Models.Paginator},
validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.Paginator)},hasPreviousPage:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0},hasNextPage:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0}}})},"1.0",{requires:["base","event-custom","json","squarespace-attr-validators","squarespace-models-paginator"]});
YUI.add("squarespace-settings-site-general",function(b){var d=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Google Analytics Account Number",text:'Enter your <a target="_blank" href="'+b.Squarespace.HelpLinks.GENERAL_GA+'">Google Analytics Account Number</a> to enable Google Analytics on your site.',padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"googleAnalyticsId","strings.placeholder":"UA-XXXXX-YY",saveOnEnter:!0}},{$when:b.Squarespace.Utils.isBetaFeatureEnabled,
ctor:b.Squarespace.DialogFields.Description,config:{title:"Mixpanel Token (Beta)",text:'Enter your <a href="http://mixpanel.com/docs/getting-started/where-can-i-find-my-project-token">Mixpanel Token</a> to enable Mixpanel tracking on your site.',padding:[15,0]}},{$when:b.Squarespace.Utils.isBetaFeatureEnabled,ctor:b.Squarespace.DialogFields.Text,config:{name:"mixpanelId","strings.placeholder":"xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx",saveOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Typekit Kit ID",
text:'Enter your Typekit kit ID to enable custom fonts on your site. <a target="_blank" href="'+b.Squarespace.HelpLinks.GENERAL_TYPEKIT+'">Click here to learn more.</a>',padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"typekitId","strings.placeholder":"xxxxxxxx",saveOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Disqus Shortname",text:'Entering your <a href="http://help.disqus.com/customer/portal/articles/466208-what-s-a-shortname-">Disqus shortname</a> will replace Squarespace\'s commenting system with Disqus throughout your site.',
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,width:300,config:{name:"disqusShortname","strings.placeholder":"xxxxxxxxxxx",saveOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Amazon Associate Tag",text:"When adding Amazon items to your pages, entering your Amazon associate tag allows you to collect revenue for the items you sell.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,width:300,config:{name:"amazonAssociateTag","strings.placeholder":"xxxxxxxx-20",
saveOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Site-Wide Password",text:"<strong>Create a private website.</strong>  Setting a password below will create a <strong>site-wide</strong> password preventing all visitors without this password from seeing your site.  This option is useful for turning off access to a site that is being built or is otherwise not ready for the public to see.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,width:300,config:{name:"password",
"strings.placeholder":"Password",saveOnEnter:!0,password:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Template Settings",text:"These settings control various aspects of your template display.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"disablePromotedBlocks","strings.title":"Disable Promoted Blocks","strings.description":"Certain templates extract main content blocks and reposition these to emphasize parts of your layout.  This setting will disable automatic block movement."}},
{$when:function(b){return b.disableMobileStylesAvailable},ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"disableMobileStyles","strings.title":"Disable Mobile Styles","strings.description":"Disable special mobile designs for this template.  Your website will appear the same on mobile devices as it does on desktops."}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"404 Error / Page Not Found",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"notFoundPageId",
className:"thin",defaultValue:"system-default",options:{$valueFn:function(){var c=[];c.push({label:"System Default",value:"system-default"});b.Squarespace.ContentCollectionCache.each(function(d){var g=d.getTemplateConfiguration();b.Squarespace.ContentCollectionUtils.isTemplatePage(d)?c.push({value:d.get("id"),label:d.get("navigationTitle")}):g&&!1===g.get("folder")&&(g=g.get("collectionType"),(g===b.Squarespace.CollectionTypes.PRODUCT||g===b.Squarespace.CollectionTypes.GENERIC||g===b.Squarespace.CollectionTypes.PAGE)&&
c.push({value:d.get("id"),label:d.get("navigationTitle")}))});return c}}}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Homepage Title Format",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.StructuredInput,config:{variables:{"%s":{title:"Site Name",tip:"The title of your website."},"%c":{title:"Collection Title",tip:"The collection title for your homepage."}},name:"homepageTitleFormat",title:"Enter a format string...",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"title",
width:450}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Collection Title Format",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.StructuredInput,config:{variables:{"%s":{title:"Site Name",tip:"The title of your website."},"%c":{title:"Collection Title",tip:"The collection title."}},name:"collectionTitleFormat",title:"Enter a format string...",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"title",width:450}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Item Title Format",
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.StructuredInput,config:{variables:{"%s":{title:"Site Name",tip:"The title of your website."},"%c":{title:"Collection Title",tip:"The collection title."},"%i":{title:"Item Title",tip:"The item title."}},name:"itemTitleFormat",title:"Enter a format string...",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"title",width:450}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Markdown Editing",text:'Enabling <a href="http://daringfireball.net/projects/markdown/">Markdown</a> mode will cause all rich text fields (in posts, pages, etc.) to start with a Markdown block by default, instead of a WYSIWYG block.',
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"markdownMode","strings.title":"Use Markdown by Default","strings.description":"Prefer editing in Markdown instead of rich text."}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Image Metadata Importing",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"imageMetadataImportMode","strings.title":"Enable Metadata Importing for Galleries","strings.description":"Enabling metadata importing will cause EXIF/IPTC metadata to be linked to the images you import.",
className:"dark"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Post URL Format",text:"Enter the default format for your blog posts below.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.StructuredInput,config:{variables:{"%t":{title:"Title",tip:"The title of your post, normalized for a URL."},"%m":{title:"Month",tip:"The numeric month your post was created on."},"%d":{title:"Day",tip:"The numeric day of the month your post was created on."},"%y":{title:"Year",tip:"The year your post was created on."}},
name:"defaultPostFormat",title:"Enter a format string...",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"title"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Simple Liking",text:"Allow lightweight post liking.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"simpleLikingEnabled","strings.title":"Simple Liking Enabled","strings.description":"Allow users to like posts without logging in."}},{ctor:b.Squarespace.DialogFields.Description,
config:{title:"Comments",text:"Change settings related to commenting on your site.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentsEnabled","strings.title":"Enable Comments","strings.description":"Enable or disable comments globally.",defaultValue:!0}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentLikesAllowed","strings.title":"Comment Likes Allowed","strings.description":"Allow users to like other users' comments."}},
{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentFlagsAllowed","strings.title":"Comment Flags Allowed","strings.description":"Allow users to flag other users' comments."}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentApprovalRequired","strings.title":"Approval Required","strings.description":"Require moderator approval before showing a comment."}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentAnonAllowed","strings.title":"Anonymous Comments Allowed",
"strings.description":"Allow users to post comments anonymously."}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentThreaded","strings.title":"Threaded","strings.description":"Allow commenters to respond to other comments.",defaultValue:!0}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"commentAvatarsOn","strings.title":"Avatars Visible","strings.description":"Show avatars on comments.",defaultValue:!0}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",
name:"commentEnableByDefault","strings.title":"Enable Comments by Default When Posting","strings.description":"Should the comments option be enabled or disabled by default when posting.",defaultValue:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Auto-Disable Comments Default Value",text:"The default setting for the number of days to wait until auto-disabling comments."}},{ctor:b.Squarespace.DialogFields.Slider,config:{name:"commentDisableAfterDaysDefault",range:[0,90],"strings.suffix":"Day",
"strings.zeroLabel":"Never",pluralize:!0,labelWidth:66}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Comment Sort Order",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"commentSortType",defaultValue:1,className:"thin",options:[{value:"1",label:"Oldest First"},{value:"2",label:"Newest First"},{value:"3",label:"Most Liked"},{value:"4",label:"Least Liked"}]}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Auto-Moderation Threshold",text:"The number of flags a comment must receive before it is automatically set to Awaiting Moderation."}},
{ctor:b.Squarespace.DialogFields.Slider,config:{name:"commentFlagThreshold",range:[0,20],"strings.zeroLabel":"Off",labelWidth:66}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Promotion / Indexing",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"allowSquarespacePromotion","strings.title":"Allow Squarespace Promotion","strings.description":"Promoted websites are included in our examples section, and can receive a significant amount of traffic as a result."}},
{$when:b.Squarespace.Utils.isSquarespaceAdmin,ctor:b.Squarespace.DialogFields.Description,config:{title:"Additional Functionality",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"useEscapeKeyToLogin","strings.title":"Login with Escape Key","strings.description":"When enabled, pressing the Escape key from the front of your website will bring up the login screen."}}];b.namespace("Squarespace.Settings.Site");var c=b.Squarespace.Settings.Site.General=b.Base.create("generalSettings",
b.Squarespace.Widgets.SettingsPanel,[],{bindUI:function(){c.superclass.bindUI.call(this);this.on("saved-changes",function(c){c=this._getSanitizedPanelData();for(var d in Static.SQUARESPACE_CONTEXT.websiteSettings)c.hasOwnProperty(d)&&(Static.SQUARESPACE_CONTEXT.websiteSettings[d]=c[d]);b.Squarespace.Utils.isSquarespaceAdmin()&&b.Cookie.set("betaFeatureActive",c.betaFeatureActive,{path:"/"})})},_processResponseData:function(c){if(b.Squarespace.Utils.isSquarespaceAdmin()&&b.Lang.isObject(c[this.get("initialDataPropertyName")])){var d=
b.Cookie.get("betaFeatureActive"),d="false"!==d?!0:!1,g=this.get("initialDataPropertyName");c[g].betaFeatureActive=d}return c},_saveChanges:function(){return b.Squarespace.Promises.create(function(e,d){var g=this._getSanitizedPanelData();""!==g.password&&g.password!==b.Squarespace.PasswordMask?b.Squarespace.Fluent.Confirm({"strings.title":"Lock Entire Website","strings.message":"You are about to restrict access to your entire website to anyone without this password. Are you sure?"}).then(b.bind(function(){c.superclass._saveChanges.call(this).then(e,
d)},this),d):c.superclass._saveChanges.call(this).then(e,d)},this)}},{CSS_PREFIX:"sqs-general-settings",ATTRS:{initialDataUrl:{value:"/api/config/GetGeneralSettings"},initialDataPropertyName:{value:"settings"},saveUrl:{value:"/api/config/SaveGeneralSettings"},"strings.title":{value:"General"},"strings.description":{value:'General settings contains toggles for various site preferences, including page title formats, third-party tracking services, control commenting settings, and posting defaults. <a target="new" href="'+
b.Squarespace.HelpLinks.GENERAL+'">Click here for more help regarding general settings.</a>'},fields:{value:d}}})},"1.0",{requires:"node oop anim json squarespace-dombuilder squarespace-graphing datatype-number squarespace-tourtip squarespace-dialog-timezone squarespace-dialog-text squarespace-dialog-description squarespace-dialog-structured-input squarespace-dialog-check squarespace-dialog-toggle squarespace-dialog-select squarespace-settings-panel squarespace-dialog-file-image squarespace-enum".split(" ")});
YUI.add("squarespace-dialog-credit-card-number",function(b){b.namespace("Squarespace.DialogFields").CreditCardNumber=b.Base.create("creditCardNumber",b.Squarespace.DialogFields.Text,[],{initializer:function(d){this._cardTypeSetManually=!1;b.Lang.isUndefined(d.data)||this._setData(d.data);this._syncingSelectField=!1},renderUI:function(){b.Squarespace.DialogFields.CreditCardNumber.superclass.renderUI.call(this);var d=this.get("contentBox"),c=this.getProperty("VALID_CARD_TYPES"),e=b.Node.create('<img class="credit-card-type-icon" />');
e.setAttribute("width","27px");e.setAttribute("height","19px");d.appendChild(e);var f=this._typeDropdown=b.Node.create('<select class="card-type-dropdown"></select>');b.Object.each(c,function(c,e){var d=b.Node.create("<option></option>");d.setAttribute("value",e);d.setContent(c);f.appendChild(d)},this);d.appendChild(f)},bindUI:function(){b.Squarespace.DialogFields.Text.superclass.bindUI.call(this);var d=this.get("id"),c=this.get("contentBox"),e=this._typeDropdown;this.after(d+"|numberChange",this._afterNumberChange,
this);this._textField.after(d+"|valueChange",function(b){b.dataSync||this.set("number",b.newVal,{dataSync:!0})},this);this.after(d+"|typeChange",function(b){this._uiSetCardType(b.newVal)},this);c.one(".credit-card-type-icon").on(d+"|click",function(b){e.simulate("mousedown")},this);e.on(d+"|change",function(){this._syncingSelectField?(this._cardTypeSetManually=!0,this.set("type",e.get("value"))):this._syncingSelectField=!1},this)},syncUI:function(){b.Squarespace.DialogFields.CreditCardNumber.superclass.syncUI.call(this);
var d=this.get("type"),c=this.get("number"),e=this.get("strings.placeholder");e&&this._textField.setAttribute("placeholder",e);this._uiSetCardType(d);this._textField.set("value",c,{dataSync:!0})},_afterNumberChange:function(b){var c=b.newVal;this.get("rendered")&&!b.dataSync&&this._textField.set("value",c,{dataSync:!0});c||(this._cardTypeSetManually=!1);!this._cardTypeSetManually&&!c.startsWith("*****")&&this._inferCardType()},_hideCardTypeIcon:function(){if(!this._cardTypeSetManually){var b=this.get("contentBox").one(".credit-card-type-icon");
b.hide();b.addClass("hidden")}},_uiSetCardType:function(d){if(b.Lang.isNull(d))this._hideCardTypeIcon();else{this._syncingSelectField=!0;this._typeDropdown.set("value",d);var c=this.get("contentBox").one(".credit-card-type-icon"),e=this.getProperty("VALID_CARD_TYPES");c.show();c.removeClass("hidden");-1!==b.Object.keys(e).indexOf(d)?(c.setAttribute("src","/universal/images-v6/billing/"+d+"-icon.png"),c.setAttribute("alt",e[d])):(c.addClass("unknown"),c.setAttribute("src","/universal/images-v6/billing/unknown-icon.png"),
c.setAttribute("alt","Unknown card type"))}},_inferCardType:function(){var b=this.get("number");if(b){var b=b.substring(0,6),c="unknown";if(this._verifyLeadingSingleValue(34,b)||this._verifyLeadingSingleValue(37,b))c="AmericanExpress";else if(this._verifyLeadingRange(51,55,b,2))c="MasterCard";else if(this._verifyLeadingSingleValue(4,b))c="Visa";else if(this._verifyLeadingSingleValue(6011,b)||this._verifyLeadingRange(622126,622925,b,6)||this._verifyLeadingRange(644,649,b,3)||this._verifyLeadingSingleValue(65,
b))c="Discover";this.set("type",c,{inferred:!0})}else this.set("type",null)},_verifyLeadingSingleValue:function(b,c){return c.startsWith(b.toString())},_verifyLeadingRange:function(b,c,e,f){if(e.length<f)return!1;e=parseInt(e.substring(0,f),10);return e>=b&&e<=c},_getData:function(){return{number:this.get("number"),type:this.get("type")}},_setData:function(b){this.set("number",b.number);this.set("type",b.type)},didDataChange:function(){var b=this._initialData,c=this.get("data");return b.number===
c.number&&b.type===c.type}},{CSS_PREFIX:"sqs-credit-card-number",VALID_CARD_TYPES:{amex:"American Express",discover:"Discover",mastercard:"MasterCard",visa:"Visa"},ATTRS:{data:{value:{type:null,number:""},validator:function(d){return b.Lang.isUndefined(d)?(console.warn(this.name+": data cannot be undefined"),!1):b.Lang.isUndefined(d.number)?(console.warn(this.name+": data.number was not set. Data was:",d),!1):!0},getter:"_getData",setter:"_setData"},number:{value:"",validator:b.Lang.isString},type:{value:null}}});
b.Squarespace.DialogFields.LabeledCreditCardNumber=b.Base.create("labeledCreditCardNumber",b.Squarespace.DialogFields.CreditCardNumber,[b.Squarespace.DialogFields.DialogFieldLabel],{},{CSS_PREFIX:"sqs-labeled-credit-card-number"})},"1.0",{requires:["node","squarespace-ui-base","node-event-simulate","squarespace-dialog-text"]});
YUI.add("squarespace-dialog-service-connect",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.ServiceConnect=b.Base.create("serviceConnect",b.Squarespace.DialogField2,[],{initializer:function(){if(this.constructor===d)throw"DialogFields.ServiceConnect: This is an abstract class and is not meant to be used on its own.";this._edited=!1},renderUI:function(){d.superclass.renderUI.call(this)},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox");this.onceAfter("dataChange",
function(){this._edited=!0},this);this.after(["disabledChange","connectionInProgressChange"],this.syncUI,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("connectionInProgress")?this._setInProgressState():this.get("data.connected")?this._setConnectedState():this._setDisconnectedState()},didDataChange:function(){return this._edited},_setInProgressState:function(){this.get("contentBox").removeClass("connected").removeClass("not-connected").addClass("in-progress")},_setConnectedState:function(){this.get("contentBox").removeClass("in-progress").removeClass("not-connected").addClass("connected")},
_setDisconnectedState:function(){this.get("contentBox").removeClass("in-progress").removeClass("connected").addClass("not-connected")},_connect:function(){throw"DialogFields.ServiceConnect: _connect must be implemented by the extending class.";},_disconnect:function(){throw"DialogFields.ServiceConnect: _disconnect must be implemented by the extending class.";}},{CSS_PREFIX:"sqs-service-connect",ATTRS:{data:{value:{connected:!1}},connectionInProgress:{value:!1}}})},"1.0",{requires:["base","squarespace-dialog-field-2"]});
YUI.add("squarespace-widgets-async-model-list-manager",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.AsyncModelListManager=b.Base.create("AsyncModelListManager",b.Squarespace.Widgets.ModelListManager,[b.Squarespace.Mixins.Loadable],{syncUI:function(){d.superclass.syncUI.call(this);this.get("loading")?this._renderLoadingState():this._renderLoadedState()},_renderLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=b.later(500,this,function(){this._destroyHeaderAndBody();
this._spinner=new b.Squarespace.Spinner({render:this.get("contentBox"),size:44,color:"dark"})})},_renderLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._spinner&&this._spinner.destroy(!0);this._destroyHeaderAndBody();var b=this._createHeader(),e=this._createBody();b.render(this._headerNode);e.render(this._modelsNode);this._set("header",b);this._set("body",e)},_destroyHeaderAndBody:function(){this.get("header").destroy(!0);this.get("body").destroy(!0)}},{CSS_PREFIX:"sqs-async-model-list-manager",
ATTRS:{}})},"1.0",{requires:["base","squarespace-mixins-loadable","squarespace-spinner","squarespace-widgets-model-list-manager"]});
YUI.add("squarespace-block-posts-by-model",function(b){b.namespace("Squarespace.ContentModel").PostsByBlock=b.Base.create("PostsByBlockModel",b.Model,[],{},{ATTRS:{}});b.namespace("Squarespace.ContentModel").PostsByTag=b.Base.create("PostsByTagModel",b.Squarespace.ContentModel.PostsByBlock,[],{},{});b.namespace("Squarespace.ContentModel").PostsByCategory=b.Base.create("PostsByCategoryModel",b.Squarespace.ContentModel.PostsByBlock,[],{},{});b.namespace("Squarespace.ContentModel").PostsByAuthor=b.Base.create("PostsByAuthorModel",
b.Squarespace.ContentModel.PostsByBlock,[],{},{});b.namespace("Squarespace.ContentModel").PostsByMonth=b.Base.create("PostsByMonthModel",b.Squarespace.ContentModel.PostsByBlock,[],{},{})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-block-logo-editor",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.Logo=b.Base.create("logo-block-editor",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(){this.get("host").set("floatable",!1);this.set("lockedLayout",!0);this.afterHostEvent("widget:contentUpdate",function(){var c=this.get("host").get("contentBox").one("img");b.Lang.isValue(c)?(this._model.set("hasLogo",!0),c.setStyle("height","60px")):this._model.set("hasLogo",!1)},this)},
_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Logo")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Logo"},minHSize:{value:6}}});b.namespace("Squarespace.Block.ModelEditorDialog").Logo=b.Base.create("blockLogoEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var b=this.get("dialog");b.on("ready",function(){this._syncCheckboxes();b.getField("useNameAsLogo").after("dataChange",this._syncCheckboxes,this)},this)},_syncCheckboxes:function(){var b=
this.get("dialog"),e=b.getField("useNameAsLogo"),b=b.getField("displayTagline").get("contentBox");this.get("model").get("hasLogo")?(e.get("contentBox").show(),b.toggleClass("shown",!!e.get("data"))):(e.set("data",!0),e.get("contentBox").hide(),b.toggleClass("shown",!0))}},{ATTRS:{dialogConfig:{valueFn:function(){return d}},hasLogo:{value:!1,validator:b.Squarespace.AttrValidators.Boolean}}});var d={initialDataByReference:!0,name:"editLogoBlock",width:300,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",
title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Logo Settings",icon:"/universal/images-v6/icons/icon-logo-16-light-solid.png",scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Change your logo in Settings."}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"align",defaultValue:"left",options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"useNameAsLogo",
defaultValue:!1,"strings.title":"Hide Logo","strings.description":"Your company name will be displayed instead of your logo."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"displayTagline",defaultValue:!0,"strings.title":"Display Tagline","strings.description":"Display your site's tagline beneath the company name."}}]}]}},"1.0",{requires:["base","squarespace-block-editor-base","squarespace-damask-context-globals"]});
YUI.add("squarespace-knowledge-base-filter",function(b){var d=b.namespace("Squarespace.Widgets").KnowledgeBaseFilter=b.Base.create("KBFilter",b.Squarespace.Widgets.SSWidget,[],{initializer:function(c){if(!b.Lang.isValue(c.listSource))throw"listSource was not supplied.";this._listSource=this.get("listSource");this._search({value:"",fields:this._getSearchFields})},renderUI:function(){d.superclass.renderUI.apply(this,arguments);var b=this.get("contentBox");this._inputEl=b.one(".search-filter");this._clearEl=
b.one(".btn-clear");this._renderResultFields()},bindUI:function(){d.superclass.bindUI.apply(this,arguments);this._clearEl.on("click",this._clearFilter,this);this._inputEl.on(["keydown","keyup"],function(b){27==b.keyCode&&(this._clearFilter(),this._inputEl.focus(),b.halt())},this);this._inputEl.on("keyup",function(b){this._loadFilter(b)},this);this.after(["thresholdChange","visibleChange"],this.syncUI,this);this._listSource.after("syncComplete",this.syncUI,this);this.after("resultItemsChange",this._renderResultFields,
this)},syncUI:function(){d.superclass.syncUI.apply(this,arguments);this.isFilterActive()?this._clearEl.show({duration:0.2}):this._clearEl.hide();this.get("visible")?this._listSource.addSearch():this._listSource.removeSearch()},_loadFilter:function(b){var e=this._inputEl.get("value"),d=this._getSearchFields();13==b.keyCode&&this.set("loading",!0);this._search({value:e,fields:d,e:b})},_clearFilter:function(b){this._inputEl.set("value","").blur();this._loadFilter(b)},update:function(c){b.Lang.isObject(c)&&
(b.Lang.isValue(c.pageSize)&&this.set("threshold",c.pageSize),b.Lang.isValue(c.totalItems)&&this.set("visible",c.totalItems>c.pageSize))},focusInput:function(){this._inputEl&&this._inputEl.focus()},_getSearchFields:function(){return["title","tags","categories"]},isFilterActive:function(){var c=this._inputEl.get("value");return b.Lang.isString(c)&&0<c.length},_getTextContent:function(c,e){var d;d=c.toJSON();if("author"===e)return d=c.get(e),d.displayName;if("email"===e)return d=c.get("author"),d.email;
if("id"===e)return d.id;d=c.get(e);return b.Lang.isValue(d)?d:""},_search:function(c){var e=c.value.trim();""===e?(this.set("filterFn",function(b){return!0}),this.set("loading",!1)):13==c.e.keyCode&&b.Data.get({url:"/api/search/GeneralSearch",data:{q:e},success:this._searchResultCallback,error:this._searchResultCallbackError},this)},_searchResultCallback:function(c){this.set("loading",!1);this.get("resultItems");this.get("page");this.set("resultItems",c.items);this.set("filterFn",b.bind(function(c){var d=
!1,g=this._getTextContent(c,"id");b.Array.each(this.get("resultItems"),function(b){d=g===b.id?!0:d},this);return d},this))},_searchResultCallbackError:function(){this.set("loading",!1);console.error("error data",data)},_renderTags:function(){this.get("contentBox");var c=this.get("resultItems"),e=[],d=0;b.Array.each(c,function(c){b.Array.each(c.tags,function(b){-1===e.indexOf(b)&&e.push(b)})});this.tagsNode?(this.tagsNode.empty(),this.tagsNode.addClass("tags"),this.tagsNode.appendChild("<div class=title>TAGS</div>")):
(this.tagsNode=b.Node.create("<div class=tags><div class=title>TAGS</div></div>"),this.sidebarNode.appendChild(this.tagsNode));b.Array.each(e.slice(0,20),function(c){if(c){var e=b.Node.create("<a href=# id=tag>"+c+"</a>");e.addClass("el");e.on("click",function(b){this._inputEl.set("value",c);this._loadFilter()},this);this.tagsNode.appendChild(e);d++}},this)},_renderCategories:function(){this.get("contentBox");var c=this.get("resultItems"),e=[],d=0;b.Array.each(c,function(c){b.Array.each(c.categories,
function(b){-1===e.indexOf(b)&&e.push(b)})});this.catsNode?(this.catsNode.empty(),this.catsNode.addClass("categories"),this.catsNode.appendChild("<div class=title>CATEGORIES</div>")):(this.catsNode=b.Node.create("<div class=categories><div class=title>CATEGORIES</div></div>"),this.sidebarNode.appendChild(this.catsNode));b.Array.each(e.slice(0,10),function(c){if(c){var e=b.Node.create("<a href=# id=cat>"+c+"</a>");e.addClass("el");e.on("click",function(b){this._inputEl.set("value",c);this._loadFilter()},
this);this.catsNode.appendChild(e);d++}},this)},_renderResultFields:function(){var c=this.get("resultItems"),e=[],d=[];b.Array.each(c,function(c){b.Array.each(c.tags,function(b){b&&e.push(b)});b.Array.each(c.categories,function(b){b&&d.push(b)})});c=this.get("contentBox");this.sidebarNode||(this.sidebarNode=b.Node.create("<div class=sidebar></div>"),c.appendChild(this.sidebarNode));0<e.length?this._renderTags():this.tagsNode&&this.tagsNode.empty();0<d.length?this._renderCategories():this.catsNode&&
this.catsNode.empty()}},{CSS_PREFIX:"sqs-kb-filter",TEMPLATE:'<div class="search-filter-wrapper"><div class="search-filter-input"><input class="search-filter" placeholder="titles, tags, categories" type="text"><div class="btn-clear">Clear</div></div><div id="search-filter-by-type"> </div></div>',ATTRS:{threshold:{validate:b.Lang.isNumber,value:20},highlighting:{value:!0},filterFn:{value:!1},resultItems:{value:[]},listSource:{value:{},writeOnce:"initOnly"},visible:{value:!1},collection:{},loading:{value:!1}}})},
"1.0",{requires:["base","node","highlight","squarespace-ss-widget"]});
YUI.add("squarespace-models-member-website-settings",function(b){var d=b.namespace("Squarespace.Models").MemberWebsiteSettings=b.Base.create("MemberWebsiteSettings",b.Model,[b.Squarespace.ModelSync.REST],{root:"/api/member-website-settings"},{ATTRS:{previewInstallationId:{}}});Static&&(Static.SQUARESPACE_CONTEXT&&Static.SQUARESPACE_CONTEXT.authenticatedAccountWebsiteSettings)&&(b.namespace("Squarespace.Singletons").AuthenticatedMemberWebsiteSettings=new d(Static.SQUARESPACE_CONTEXT.authenticatedAccountWebsiteSettings))},
"1.0",{requires:["model","base","promise","squarespace-model-sync-rest"]});
YUI.add("squarespace-dialog-label",function(b){b.namespace("Squarespace.Plugin").DialogFieldLabel=b.Base.create("dialogFieldLabel",b.Plugin.Base,[],{initializer:function(b){this.afterHostMethod("renderUI",this._render,this);this.afterHostMethod("syncUI",this.syncLabel,this)},destructor:function(){b.detach(this.get("id")+"|*");var d=this.get("host"),c=d.get("boundingBox");d.get("rendered")&&(c&&c._node)&&d.get("boundingBox").removeClass(b.Squarespace.Plugin.DialogFieldLabel.CSS_PREFIX+"-plugged")},
_render:function(){this.renderLabel();this.bindLabel();this.syncLabel();this.get("host").get("boundingBox").addClass(b.Squarespace.Plugin.DialogFieldLabel.CSS_PREFIX+"-plugged")},renderLabel:function(){this._labelNode=b.Node.create("<label></label>");this._labelNode.addClass(b.Squarespace.Plugin.DialogFieldLabel.CSS_PREFIX);var d=this._labelNode;this.get("inField");var c=this.get("renderNode");this.get("strings.text");var e=this.get("className"),f=this.get("forNode"),g=this.get("host").get("contentBox");
e&&d.addClass(e);c?(b.Lang.isString(c)&&(c=g.one(c)),c.appendChild(d)):f?(b.Lang.isString(f)&&(f=g.one(f)),(c=f.getAttribute("id"))&&d.setAttribute("for",c),f.insert(d,"before")):(g.one("input")||g.one("select")||g.one("textarea")||g.one("button")).insert(d,"before")},bindLabel:function(){var b=this.get("id");this.on(b+"|classNameChange",function(b){this._labelNode.removeClass(b.prevVal);this._labelNode.addClass(b.newVal)},this)},syncLabel:function(){this._labelNode.setContent(this.get("strings.text"))}},
{NS:"label",CSS_PREFIX:"sqs-dialog-field-label",ATTRS:{strings:{value:{text:""}},renderNode:{value:null},className:{value:null},forNode:{value:null}}});b.namespace("Squarespace.DialogFields").DialogFieldLabel=function(d){b.Do.before(function(){this.plug(b.Squarespace.Plugin.DialogFieldLabel,b.merge({renderNode:d.labelRenderNode||null,forNode:d.labelForNode||null,className:d.labelClassName||null,"strings.text":this.get("strings.label")},d.labelConfig||{},this.getProperty("LABEL_CONFIG")||{}))},this,
"renderUI",this)};b.Squarespace.DialogFields.DialogFieldLabel.NAME="dialogFieldLabel"},"1.0",{requires:["base","node","plugin","squarespace-dialog-field-2"]});
YUI.add("squarespace-mixins-google-places-autocomplete",function(b){b.namespace("Squarespace.Mixins");var d={POSTAL_CODE:"postal_code",COUNTRY:"country",LOCALITY:"locality",ROUTE:"route",STREET_NUMBER:"street_number",ADMIN_LEVEL_1:"administrative_area_level_1",SUBLOCALITY:"sublocality",POSTAL_TOWN:"postal_town",NEIGHBORHOOD:"neighborhood"},c=b.Object.values(d),e=b.Squarespace.Localities.COUNTRY_OPTIONS,f=["geocode"];b.Squarespace.Mixins.GooglePlacesAutocomplete=b.Base.create("GooglePlacesAutocomplete",
b.Base,[],{initializer:function(){this.publish("placeDetails");b.Do.after(this._afterRenderUI,this,"renderUI",this);b.Do.after(this._afterBindUI,this,"bindUI",this);this.after("render",this._enableBrowserAutoComplete,this);this.setAttrs({source:b.bind(this._accessAutocompleteService,this),enableCache:!1,resultTextLocator:"description",resultFilters:this._filterResults,resultFormatter:this._formatResults,minQueryLength:3});b.Squarespace.GoogleMap.loaded||b.Squarespace.GoogleMap.load()},_afterRenderUI:function(){var b=
this.get("contentBox");b.addClass("sqs-google-places-autocomplete-mixin");b.one(".sqs-scroll-ac-scroll-container").append('<div class="google-required-elements"><div class="google-attributions"></div><div class="powered-by-google"></div></div>')},_afterBindUI:function(){this.before("select",this._getDetailsForPrediction,this);this.on("placeDetails",this._fillWithAddressLine1,this);this._inputNode.on("focus",function(){this._inputNode.setAttribute("autocomplete","off");this._inputIsFocused=!0},this);
this._inputNode.on("blur",function(){this._inputNode.setAttribute("autocomplete","on");this._inputIsFocused=!1},this)},_enableBrowserAutoComplete:function(){this._inputNode.setAttribute("autocomplete","on")},_getDetailsForPrediction:function(b){b.halt();var c=b.result.raw;this._accessPlaceDetailsService(c,function(b,e){if(e===google.maps.places.PlacesServiceStatus.OK){var d=this._extractPlaceComponents(b),d=this._buildLocationPayload(d,c);this.fire("placeDetails",{place:d})}else console.warn("Error communicating with Google Places API")})},
_extractPlaceComponents:function(f){return b.Array.reduce(f.address_components,{},function(f,g){var l=b.Array.find(g.types,function(e){return-1!==b.Array.indexOf(c,e)});f[l]=l?l===d.ADMIN_LEVEL_1?g.short_name:l===d.COUNTRY?e[g.short_name].title:g.long_name:"";return f})},_buildLocationPayload:function(c,e){var f=b.Object.getValue(c,"street_number")||"",l=b.Object.getValue(c,"route")||"",p=b.Object.getValue(c,"country")||"",q=b.Object.getValue(c,"locality")||"",r=b.Object.getValue(c,"sublocality")||
"",s=b.Object.getValue(c,"neighborhood")||"",r=[b.Object.getValue(c,"postal_town")||"",q,r,s],q=b.Array.find(r,function(c){return b.Array.find(e.terms,function(b){return b.value===c})})||q,r=b.Object.getValue(c,d.ADMIN_LEVEL_1)||"",s=b.Object.getValue(c,d.POSTAL_CODE)||"",t=b.Array.filter([q,r,s],function(b){return!!b}).join(", ").trim();return{address:(f+" "+l).trim(),country:p,city:q,state:r,zip:s,fullLocality:t}},_accessAutocompleteService:function(c,e){if(!this._autocompleteService)if(b.Squarespace.GoogleMap.loaded)this._autocompleteService=
new google.maps.places.AutocompleteService;else{console.warn("Google Places API has not loaded yet");e();return}this._autocompleteService.getPlacePredictions({input:c,types:f},b.bind(function(){this._inputIsFocused&&e.apply(this,arguments)},this))},_accessPlaceDetailsService:function(c,e){if(!this._placeDetailsService)if(b.Squarespace.GoogleMap.loaded){var d=this.get("contentBox").one(".google-attributions");this._placeDetailsService=new google.maps.places.PlacesService(d)}else{console.warn("Google Places API has not loaded yet");
e();return}this._placeDetailsService.getDetails(c,b.bind(e,this))},_formatResults:function(c,e){return b.Array.map(e,function(c){var e=c.raw.terms,d=c.raw.matched_substrings,f=-1!==b.Array.indexOf(c.raw.types,"street_address"),g=e[0].offset+e[0].value.length,e=e[1].offset+e[1].value.length,h=f?e:g;return b.Array.map(c.text.split(""),function(b,e){var f=["google-ac-character"];this._indexWithinMatchedSubstring(e,d)&&f.push("google-ac-matched-character");f='<span class="'+f.join(" ").trim()+'">'+b+
"</span>";return 0===e?'<div class="google-ac-address">'+f:e===h?f+"</div>":e===h+1?'<div class="google-ac-trailing">'+f:e===c.text.length?f+"</div>":f},this).join("")},this)},_indexWithinMatchedSubstring:function(c,e){return b.Array.some(e,function(b){return c>=b.offset&&c<b.offset+b.length})},_filterResults:function(c,e){return b.Array.filter(e,function(b){return this._predictionHasRouteComponent(b.raw)&&this._predictionContainsCountryInList(b.raw)},this)},_predictionContainsCountryInList:function(c){var e=
this.get("countriesAllowed");return!b.Lang.isArray(e)||0===e.length?!0:b.Array.find(e,function(b){return-1!==c.description.indexOf(b)})},_predictionHasRouteComponent:function(c){return-1!==b.Array.indexOf(c.types,d.ROUTE)}},{ATTRS:{countriesAllowed:{validator:b.Squarespace.AttrValidators.isNullOrArray}}})},"1.0",{requires:"autocomplete-highlighters base event-custom squarespace-attr-validators squarespace-localities squarespace-google-places-autocomplete-css squarespace-util".split(" ")});
YUI.add("squarespace-block-calendar-model",function(b){b.namespace("Squarespace.ContentModel").CalendarBlock=b.Base.create("CalendarBlockModel",b.Model,[],{},{ATTRS:{collectionId:{value:null}}})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-flyout-link-edit",function(b){b.namespace("Squarespace.Flyout");b.Squarespace.Flyout.LinkEdit=b.Base.create("LinkEdit",b.Squarespace.Widgets.DataWidget,[],{initializer:function(){this.renderUI();this.bindUI()},destructor:function(b){this._promptPanel.destroy(b);this._editPanel.destroy(b)},renderUI:function(){this._promptPanel=new b.Squarespace.Panel({constrain:!0,zIndex:(2*b.Squarespace.DIALOG_ZINDEX_BASE||3E4)+105,animDuration:0,"align.points":this.get("alignment"),pointer:!1,
type:"link-edit"});this._editPanel=new b.Squarespace.Panel({constrain:!0,zIndex:(2*b.Squarespace.DIALOG_ZINDEX_BASE||3E4)+105,animDuration:this.get("panelAnimDuration"),"align.points":this.get("alignment"),pointer:!1,type:"link-edit"});this._promptPanel.set("visible",!1);this._editPanel.set("visible",!1);this._promptPanel.get("boundingBox").addClass("sqs-prevent-block-focus-change");this._editPanel.get("boundingBox").addClass("sqs-prevent-block-focus-change")},bindUI:function(){var d=this._promptPanel.get("contentBox");
d.delegate("click",this._openEditFromPrompt,".edit",this);d.delegate("click",this.unlink,".unlink",this);this.after("open",function(){var c=b.one("body"),e=this.get("anchorNode").ancestor("body");this.panelClickEvents&&0<this.panelClickEvents.length&&this._detachPanelClickEvents();this.panelClickEvents=[];e!==c&&(this.panelClickEvents.push(e.on(this.get("id")+"|click",this._onPanelClick,this)),this.panelClickEvents.push(e.on(this.get("id")+"|scroll",this._onPanelClick,this)));this.panelClickEvents.push(c.on(this.get("id")+
"|mouseup",this._onPanelClick,this))},this)},_detachPanelClickEvents:function(){for(var b;b=this.panelClickEvents.pop();)b.detach()},_onPanelClick:function(b){b=b.target;var c=this.get("anchorNode"),e=function(b){return b.compareTo(c)};!b.test(".sqs-panel-type-link-edit")&&(!b.ancestor(".sqs-panel-type-link-edit")&&!b.ancestor(e,!0)&&!b.test(".field-wysiwyg-tool-link")&&!b.ancestor(".field-wysiwyg-tool-link")&&!b.ancestor(".flyout-link-prompt")&&!b.ancestor(".cke"))&&this.close(!0)},openPrompt:function(d,
c,e,f,g){g=g||this.get("offset");this.set("anchorNode",d);this.set("linkUrl",c||d.getAttribute("href"));this.set("linkId",e||"");g&&this.set("offset",g);this.set("newWindow",b.Lang.isUndefined(f)?"_blank"==d.getAttribute("target"):f);d=this.get("linkUrl");c="#"==d?"No link URL":d;this.get("anchorNode").get("region").bottom+328>b.one(window).get("region").bottom&&(this.set("alignment",["bl","tl"]),this._topAlign=!0);this._promptPanel.get("bodyContent")?(e=this._promptPanel.get("boundingBox").one(".prompt-url"),
e.set("text",c),e.setAttribute("href",d)):this._promptPanel.set("bodyContent",b.Node.create('<div class="flyout-link-prompt"><a class="prompt-url text" href="'+d+'" target="_blank">'+c+'</a><div class="separator"> - </div><div class="edit text">Edit</div><div class="separator">|</div><div class="unlink text">Remove</div></div>'));this._promptPanel.set("align",{node:this.get("anchorNode"),points:this.get("alignment")});this._promptPanel.set("visible",!0);g&&this._promptPanel.setPanelOffset(g);this.bindPromptUI();
b.Squarespace.EscManager.addTarget(this);this.set("open",!0);this.fire("open")},openEdit:function(d,c,e,f,g){g=g||this.get("offset");this._promptPanel.get("visible")&&this._closePrompt();this.set("anchorNode",d);this.set("linkUrl",c||d.getAttribute("href"));this.set("linkId",e||"");g&&this.set("offset",g);this.set("newWindow",b.Lang.isUndefined(f)?"_blank"==d.getAttribute("target"):f);this.get("anchorNode").get("region").bottom+328>b.one(window).get("region").bottom&&(this.set("alignment",["bl","tl"]),
this._topAlign=!0);d=b.Node.create('<div class="flyout-link-edit-content"></div>');this._editPanel.set("bodyContent",d);this._editPanel.set("align",{node:this.get("anchorNode"),points:this.get("alignment")});this._editPanel.set("visible",!0);g&&this._editPanel.setPanelOffset(g);this._createLinkField=new b.Squarespace.DialogFields.CreateLink({data:{url:this.get("linkUrl"),newWindow:this.get("newWindow")},showPlaceholder:!1,disableNewWindow:this.get("disableNewWindow")});this._createLinkField.on("rendered",
function(){this._editPanel.align();g&&this._editPanel.setPanelOffset(g)},this);this._createLinkField.render(d);this.bindEditUI();this.get("open")||(b.Squarespace.EscManager.addTarget(this),this.set("open",!0),this.fire("open"))},_openEditFromPrompt:function(b){this.openEdit(this.get("anchorNode"),this.get("linkUrl"),this.get("linkId"),this.get("newWindow"))},close:function(d){this.get("open")&&(this._promptPanel.get("visible")?this._closePrompt():this._closeEdit(),this._detachPanelClickEvents(),this.set("alignment",
["tl","bl"]),this._topAlign=!1,this.set("open",!1),this.set("offset",null),b.one("body").detach(this.get("id")+"|click"),d&&b.Squarespace.EscManager.removeTarget(this))},bindPromptUI:function(){var b=this.get("anchorNode").ancestor(".field-wysiwyg");if(b)b.on("scroll",function(){this._promptPanel.align()},this)},bindEditUI:function(){var b=this.get("anchorNode").ancestor(".field-wysiwyg");if(b)b.on("scroll",function(){this._editPanel.align()},this);this._createLinkField.after("dataChange",function(b){b=
b.newVal;this.set("linkUrl",b.url||"#");this.set("newWindow",b.newWindow);this.updateLink()},this);if(this._topAlign)this._createLinkField.on("animating",function(){this._editPanel.align()},this);this._createLinkField.on("close",function(){this.close(!0)},this)},updateLink:function(){this.set("data",{anchorNode:this.get("anchorNode"),linkId:this.get("linkId"),linkUrl:this.get("linkUrl"),newWindow:this.get("newWindow")})},unlink:function(){this.close(!0);this.fire("unlink",{anchorNode:this.get("anchorNode"),
linkId:this.get("linkId")})},_closePrompt:function(){var b=this.get("offset");this._promptPanel.set("visible",!1);this.set("open",!1);b&&this._promptPanel.setPanelOffset(b)},_closeEdit:function(){var b=this.get("offset");this._editPanel.set("visible",!1);b&&this._editPanel.setPanelOffset(b);this.fire("close")}},{NS:"linkedit",ATTRS:{alignment:{value:["tl","bl"]},anchorNode:{value:null},disableNewWindow:{value:!1},linkId:{value:""},linkUrl:{value:"#"},newWindow:{value:!0},open:{value:!1},panelAnimDuration:{value:0.1}}})},
"0.1",{requires:"base base-build plugin overlay squarespace-panel squarespace-dialog-create-link squarespace-tab-view squarespace-external-link-tab squarespace-file-manager-tab squarespace-existing-content-link-tab".split(" ")});
YUI.add("squarespace-block-opentable-editor",function(b){b.namespace("Squarespace.Block.Editor").Opentable=b.Base.create("opentable-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Opentable")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Opentable"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Opentable=b.Base.create("blockOpentableEditor",b.Squarespace.ModelEditorDialog,
[],{},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:375,height:120,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Configure OpenTable",icon:"/universal/images-v6/icons/icon-opentable-20-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"restaurantId",maxLength:10,className:"thin",submitOnEnter:!0,strings:{title:"OpenTable Restaurant ID",description:"Your OpenTable restaurant ID.  You can locate your restaurant ID on the OpenTable website."}}}]}]}},
"1.0",{requires:["base","squarespace-damask-context-globals","squarespace-dialog-text","squarespace-model-editor"]});
YUI.add("squarespace-form-builder-field-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["form-builder-field.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+('<div class="field-control-bar">\n  <div class="field-drag-handle-wrapper">\n    <div class="field-drag-handle"></div>\n  </div>\n\n  <div class="field-type-icon '+b((l=(l=c.field,null==l||!1===l?l:l.type),"function"===
typeof l?l.apply(c):l))+'"></div>\n\n  <div class="field-title"></div>\n\n  <div class="field-controls">\n    <div class="remove-field">&times;</div>\n    <div class="field-locked-icon"></div>\n    <div class="edit-field">'+b((l=(l=c.strings,null==l||!1===l?l:l.editText),"function"===typeof l?l.apply(c):l))+'</div>\n  </div>\n</div>\n\n<div class="editor-wrapper"></div>\n')})})();b.Handlebars.registerPartial("form-builder-field.html".replace("/","."),d.templates["form-builder-field.html"])},"1.0",
{requires:["handlebars-base"]});YUI.add("squarespace-block-twitter-model",function(b){b.namespace("Squarespace.ContentModel").TwitterBlock=b.Base.create("TwitterBlockModel",b.Model,[],{},{ATTRS:{}})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-settings-commerce-donations",function(b){b.namespace("Squarespace");var d=b.Base.create("contribution-summary",b.Squarespace.DialogField2,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox");b.Data.get({url:"/api/config/GetFragment",data:{name:"contribution-summary"},success:b.bind(function(e){var d=this.get("data"),f=d.currency,d=b.merge(d,{currencyCode:f,currencySymbol:b.Squarespace.CurrencySymbol[f],showCurrencyCode:b.Squarespace.Commerce.showCurrencyCodeForCurrency(f)});
c.setContent(b.JSONTemplate.evaluateJsonTemplate(e.html,d))},this)})}},{CSS_PREFIX:"sqs-contribution-summary"}),c=b.Base.create("contributionList",b.Squarespace.SSWidget,[],{renderUI:function(){var c=this.get("contentBox"),e=this.get("contribution");c.append(b.Node.create(b.Handlebars.render('<div class="contribution-row"><div class="summary"><div class="amount">'+b.Squarespace.Commerce.moneyString(e.get("amountCents"))+'</div></div><div class="details"><div class="title">{{donationTitle}}</div><div class="name">{{donor.name}}</div><div class="email">{{donor.email}}</div><div class="date">{{date-format submittedOn format="%B %d, %Y"}}</div></div>{{#if testMode}}<div class="status-text-wrapper"><div class="status-text">TEST</div></div>{{/if}}</div>',
e.getAttrs())))},bindUI:function(){this.get("contentBox").on("click",function(){var c=new b.Squarespace.EditingDialog;c.setParams({width:700,verticalHeight:"full",overlay:0.5,closeOthers:!1,buttons:[{type:"cancel",title:"Close"}],initialData:{contribution:this.get("contribution").getAttrs()},tabs:[{title:"Contribution Summary",icon:"/universal/images-v6/icons/icon-donation-32-light.png",scroll:!0,fields:[{ctor:d,config:{name:"contribution"}}]}]});c.show()},this)}},{ATTRS:{contribution:{value:null}}}),
e=b.Base.create("contributionList",b.Squarespace.DialogField2,[],{initializer:function(c){c=new b.Squarespace.Models.ContributionList({model:b.Squarespace.Models.Contribution});this.set("contributions",c);this.publish("page-loaded")},syncUI:function(){e.superclass.syncUI.call(this);this.get("contentBox").empty();var b=this.get("contributions");0===b.size()?this._showEmptyMessage():b.each(this._renderContribution,this)},bindUI:function(){e.superclass.bindUI.call(this)},requestPage:function(c){var e=
this.get("contributions");e.set("offset",c.offset);e.load(b.bind(function(){this.syncUI();var b=e.get("pagination");this.fire("page-loaded",b)},this))},_showEmptyMessage:function(){this.get("contentBox").append("<div class='no-options'><img src='/universal/images-v6/configuration/no-donations.png'/><div class='empty-text'>You haven't received any donations yet.</div></div>")},_renderContribution:function(b){var e=this.get("contentBox");(new c({contribution:b})).render(e)}},{CSS_PREFIX:"sqs-contribution-list",
ATTRS:{contributions:{value:null}}}),f=b.namespace("Squarespace.Settings.Commerce").Donations=b.Base.create("ContributionsManager",b.Squarespace.Widgets.SettingsPanel,[],{destructor:function(){this._pagination&&this._pagination.destroy()},renderUI:function(){f.superclass.renderUI.call(this);var c=this._headerTray.get("boundingBox").one(".footer");this._pagination=new b.Squarespace.Widgets.Pagination({currentPage:1,pageSize:5});this._pagination.render(c)},bindUI:function(){f.superclass.bindUI.call(this);
this._pagination.on("pageRequested",function(c){this.getField("contributions").requestPage(b.QueryString.parse(c.start.substr(1)))},this)},syncUI:function(){f.superclass.syncUI.call(this);this.getField("contributions").on("page-loaded",function(b){this._pagination.update({hasNextPage:b.offset+b.limit<b.totalItems,nextPageStart:"?offset="+(b.offset+b.limit)+"&limit="+b.limit,hasPreviousPage:0<=b.offset-b.limit,previousPageStart:"?offset="+(b.offset-b.limit)+"&limit="+b.limit})},this);this.getField("contributions").requestPage({offset:0,
limit:5})},_clearTestDonations:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Clear Test Donations","strings.message":"This will permanently remove all test donations."})).on("confirm",function(){b.Data.del({url:"/api/rest/commerce/contributions/test",success:b.bind(function(){this.getField("contributions").requestPage({offset:0,limit:5})},this)})},this)}},{CSS_PREFIX:"sqs-contributions",ATTRS:{"strings.title":{value:"Donations"},"strings.description":{value:"View the donations that have been contributed to your cause(s)."},
fields:{value:[{ctor:e,config:{name:"contributions"}}]},buttons:{value:[{label:"Clear Test Donations",container:".buttons",className:"clear-test-donations",action:function(){this._clearTestDonations()}},{label:"Export All Donations to CSV",container:".buttons",action:function(){document.location="/api/rest/commerce/contributions/csv?crumb="+b.Cookie.get("crumb")}}]}}})},"1.0",{requires:"node oop anim json model squarespace-settings-panel squarespace-commerce-utils squarespace-models-contribution squarespace-enum squarespace-dialog-contribution-summary-template squarespace-hb-money-format squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-dialog-time-range",function(b){var d=b.namespace("Squarespace.DialogFields").TimeRange=b.Base.create("timeRange",b.Squarespace.DialogFields.LabeledText,[],{initializer:function(){this._isValid=!0},bindUI:function(){d.superclass.bindUI.apply(this);this._textField.getDOMNode().addEventListener("blur",b.bind(this._validateAfterBlur,this));this._textField.on("valuechange",this._validateAfterBlur,this)},_validateAfterBlur:function(b){this._isPlaceholder()&&this._textField.set("value",
null);b=this.get("errors");0<b.length?this.showError(b[0]):(this._isValid=!0,this.hideError())},showError:function(b){this._isValid&&(this._isValid=!1,d.superclass.showError.call(this,b))},_isPlaceholder:function(){var b=this.get("strings.placeholder"),e=this._textField.get("value"),e=e.toLowerCase().trim(),b=b.toLowerCase().trim();return e===b},_getErrors:function(){var c=[],e=this._textField;e&&(e=e.get("value"),(e=b.Squarespace.BusinessHoursUtils.parseMultipleTimeRange(e))?this.set("multipleTimeRange",
e):c.push(this.get("strings.errorMsg")));return c},_afterValueChange:function(){this._isValid&&this.hideError()}},{CSS_PREFIX:"sqs-time-range",LABEL_CONFIG:{forNode:"input[type]"},ATTRS:{strings:{value:{errorMsg:"Could not parse time",placeholder:"Closed"}},data:{value:null,validator:b.Squarespace.AttrValidators.isMultipleTimeRange}}})},"1.0",{requires:["squarespace-dialog-text"]});
YUI.add("squarespace-form-preview",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.FormPreview=b.Base.create("formPreview",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this._getTemplateSchema(function(b){this._template=b;this.syncUI()},this)},bindUI:function(){d.superclass.bindUI.call(this);this.get("form").on("change",this.syncUI,this);this.after(["useLightboxChange","lightboxHandleTextChange","buttonAlignmentChange"],this.syncUI,this)},syncUI:function(){d.superclass.syncUI.call(this);
if(this._template){var c=this.get("form"),e=this.get("useLightbox"),c={showTitle:e,useLightbox:e,lightboxHandleText:this.get("lightboxHandleText")||"Open Form",buttonAlignment:this.get("buttonAlignment"),formFields:c.get("fields"),formSubmitButtonText:c.get("submitButtonText"),formSubmissionMessage:c.get("submissionMessage"),hideSubmitButton:this.get("hideSubmitButton")};this.get("contentBox").setHTML(b.JSONTemplate.evaluateJsonTemplate(this._template.html,c))}},_getTemplateSchema:function(c,e){b.Data.get({url:"/api/template/GetTemplateSchema",
data:{componentType:"widget",type:b.Squarespace.BlockType.FORM},success:function(b){c.call(e||this,b)}},this)}},{CSS_PREFIX:"sqs-preview-form",ATTRS:{form:{value:null,validator:function(c){return b.instanceOf(c,b.Squarespace.Models.Form)}},useLightbox:{value:!1},lightboxHandleText:{value:"Open Form"},hideSubmitButton:{value:!1}}})},"1.0",{requires:"base node json squarespace-enum squarespace-ss-widget squarespace-models-form squarespace-json-template".split(" ")});
YUI.add("squarespace-settings-site-url-mappings",function(b){b.namespace("Squarespace.Settings.Site").UrlMappings=b.Base.create("advancedSettings",b.Squarespace.Widgets.SettingsPanel,[],{},{CSS_PREFIX:"sqs-settings-panel-url-mappings",HANDLEBARS_TEMPLATE:"settings-advanced.html",ATTRS:{initialDataUrl:{value:"/api/config/GetAdvancedSettings"},saveUrl:{value:"/api/config/SaveAdvancedSettings"},"strings.title":{value:"URL Mappings"},"strings.saveSuccessfulDescription":{value:"URL mappings saved."},"strings.help-url-mappings-href":{value:b.Squarespace.HelpLinks.URL_MAPPINGS},
"strings.help-redirect-types-href":{value:b.Squarespace.HelpLinks.REDIRECT_TYPES},fields:{value:[{ctor:b.Squarespace.DialogFields.UrlMappings,config:{name:"mappings"}}]}}})},"1.0",{requires:["squarespace-dialog-code","squarespace-settings-panel","squarespace-settings-advanced-template"]});
YUI.add("squarespace-settings-commerce-email",function(b){b.namespace("Squarespace.Settings.Commerce");b.Squarespace.Settings.Commerce.Email=b.Base.create("emailManager",b.Squarespace.Widgets.SettingsPanel,[],{_sendPreview:function(d){b.Data.get({url:this.get("sendPreviewUrl"),data:{emailType:d},success:b.bind(function(c){new b.Squarespace.Widgets.Information({"strings.title":"Preview Sent","strings.message":"The sample notification has been sent to your address."})},this)})},_restoreDefaults:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Restore Defaults",
"strings.message":"Do you want to reset your email settings to system defaults?"})).on("confirm",function(){b.Data.get({url:this.get("initialDataUrl"),data:{getDefaults:!0},success:b.bind(function(d){b.Object.each(d,function(c,e){var f=this.getField(e);f instanceof b.Squarespace.DialogFields.Code?f.loadValue(d[e]):f.setValue(d[e])},this)},this)})},this)}},{CSS_PREFIX:"sqs-settings-commerce-email",ATTRS:{initialDataUrl:{value:"/api/commerce/admin/GetEmailSettings"},saveUrl:{value:"/api/commerce/admin/SaveEmailSettings"},
sendPreviewUrl:{value:"/api/commerce/admin/PreviewEmail"},buttons:{value:[{label:"Restore Defaults",type:"restoreDefault",action:function(){this._restoreDefaults()}},{label:"Save Settings",type:"save"}],validator:b.Lang.isArray},"strings.title":{value:"Email Settings"},"strings.description":{value:'You may receive email notifications when your stock level drops to a certain level. You may also customize and preview the contents of emails that are automatically sent to your customers. Emails are sent from the "Customer Support Email" address configured below.'},
fields:{valueFn:function(){var d={website:{siteTitle:"MySite",baseUrl:"http://www.squarespace.com"},showPhysical:!0,showDigital:!1,order:{displayId:"00001",submittedOn:new Date}},c="Send Test Email to "+Static.SQUARESPACE_CONTEXT.authenticatedAccount.email;this.get("dialogParams");var e=function(b){return function(){this._sendPreview(b)}};return[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Customer Support Email",text:"All emails to your customers will be sent from this address."}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"fromEmail",className:"thin","strings.validationFailMessage":"The email address you entered is invalid.",validator:b.Squarespace.EmailUtils.isValid}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Automatic Stock Level Alert Email",text:"Notify me by email when the stock level in any item drops to this level."}},{ctor:b.Squarespace.DialogFields.Slider,config:{name:"stockLevelAlertLimit",range:[0,20],"strings.suffix":"Item","strings.zeroLabel":"Never",
pluralize:!0,labelWidth:60}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Order Confirmed Subject",text:"The subject line for an order confirmation email."}},{ctor:b.Squarespace.DialogFields.StructuredInput,config:{name:"orderConfirmedSubjectFormat",title:"Enter a format string...",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"title",width:350,variables:{"%o":{title:"Order #",tip:"The order confirmation number."},"%s":{title:"Site Name",tip:"The title of your website."}}}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Order Confirmed Message",text:"When a customer submits their order, they will receive a confirmation email with their order summary and this message."}},{ctor:b.Squarespace.DialogFields.jsonTemplateCode,config:{name:"orderConfirmedMessage",height:170,sampleData:d}},{ctor:b.Squarespace.DialogFields.Button,config:{$dontRecurse:!0,"strings.text":c,name:"previewConfirmedEmail",onClick:e(b.Squarespace.CommerceEmailTypes.ORDER_CONFIRMED),context:this}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Order Shipped Subject Line",text:"The subject line for the automated shipment notification sent to customers."}},{ctor:b.Squarespace.DialogFields.StructuredInput,config:{name:"orderShippedSubjectFormat",title:"Enter a format string...",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"title",width:350,variables:{"%o":{title:"Order #",tip:"The order confirmation number."},"%s":{title:"Site Name",tip:"The title of your website."}}}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Order Shipped Message",text:"When you mark an order as shipped, the customer will receive a notification with their order summary and this message."}},{ctor:b.Squarespace.DialogFields.jsonTemplateCode,config:{name:"orderShippedMessage",height:170,sampleData:d}},{ctor:b.Squarespace.DialogFields.Button,config:{$dontRecurse:!0,"strings.text":c,name:"previewShippedEmail",onClick:e(b.Squarespace.CommerceEmailTypes.ORDER_SHIPPED),context:this}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Header",text:"All invoices and notification emails sent to customers will include this at the top."}},{ctor:b.Squarespace.DialogFields.jsonTemplateCode,config:{name:"orderHeader",fieldStyle:"normal",height:170,sampleData:d}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Footer",text:"All invoices and notification emails sent to customers will include this at the bottom."}},{ctor:b.Squarespace.DialogFields.jsonTemplateCode,config:{name:"orderFooter",
fieldStyle:"normal",height:170,sampleData:d}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Donation Thank You",text:"When a donation is made to your site, the contributor will receive this automated confirmation message."}},{ctor:b.Squarespace.DialogFields.jsonTemplateCode,config:{name:"contributionConfirmedMessage",height:170,sampleData:d}},{ctor:b.Squarespace.DialogFields.Button,config:{$dontRecurse:!0,"strings.text":c,name:"previewDonationEmail",onClick:e(b.Squarespace.CommerceEmailTypes.CONTRIBUTION_CONFIRMED),
context:this}}]}}}})},"1.0",{requires:"anim json node oop squarespace-dialog-button squarespace-dialog-description squarespace-settings-panel squarespace-tray squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("widget-stack",function(b,d){function c(b){}var e=b.Lang,f=b.UA,g=b.Node,h=b.Widget;c.ATTRS={shim:{value:6==f.ie},zIndex:{value:0,setter:"_setZIndex"}};c.HTML_PARSER={zIndex:function(b){return this._parseZIndex(b)}};c.SHIM_CLASS_NAME=h.getClassName("shim");c.STACKED_CLASS_NAME=h.getClassName("stacked");c.SHIM_TEMPLATE='<iframe class="'+c.SHIM_CLASS_NAME+'" frameborder="0" title="Widget Stacking Shim" src="javascript:false" tabindex="-1" role="presentation"></iframe>';c.prototype={initializer:function(){this._stackNode=
this.get("boundingBox");this._stackHandles={};b.after(this._renderUIStack,this,"renderUI");b.after(this._syncUIStack,this,"syncUI");b.after(this._bindUIStack,this,"bindUI")},_syncUIStack:function(){this._uiSetShim(this.get("shim"));this._uiSetZIndex(this.get("zIndex"))},_bindUIStack:function(){this.after("shimChange",this._afterShimChange);this.after("zIndexChange",this._afterZIndexChange)},_renderUIStack:function(){this._stackNode.addClass(c.STACKED_CLASS_NAME)},_parseZIndex:function(b){b=!b.inDoc()||
"static"===b.getStyle("position")?"auto":b.getComputedStyle("zIndex");return"auto"===b?null:b},_setZIndex:function(b){e.isString(b)&&(b=parseInt(b,10));e.isNumber(b)||(b=0);return b},_afterShimChange:function(b){this._uiSetShim(b.newVal)},_afterZIndexChange:function(b){this._uiSetZIndex(b.newVal)},_uiSetZIndex:function(b){this._stackNode.setStyle("zIndex",b)},_uiSetShim:function(b){b?(this.get("visible")?this._renderShim():this._renderShimDeferred(),6==f.ie&&this._addShimResizeHandlers()):this._destroyShim()},
_renderShimDeferred:function(){this._stackHandles.shimdeferred=this._stackHandles.shimdeferred||[];this._stackHandles.shimdeferred.push(this.on("visibleChange",function(b){b.newVal&&this._renderShim()}))},_addShimResizeHandlers:function(){this._stackHandles.shimresize=this._stackHandles.shimresize||[];var b=this.sizeShim,c=this._stackHandles.shimresize;c.push(this.after("visibleChange",b));c.push(this.after("widthChange",b));c.push(this.after("heightChange",b));c.push(this.after("contentUpdate",b))},
_detachStackHandles:function(b){b=this._stackHandles[b];var c;if(b&&0<b.length)for(;c=b.pop();)c.detach()},_renderShim:function(){var b=this._shimNode,c=this._stackNode;b||(b=this._shimNode=this._getShimTemplate(),c.insertBefore(b,c.get("firstChild")),this._detachStackHandles("shimdeferred"),this.sizeShim())},_destroyShim:function(){this._shimNode&&(this._shimNode.get("parentNode").removeChild(this._shimNode),this._shimNode=null,this._detachStackHandles("shimdeferred"),this._detachStackHandles("shimresize"))},
sizeShim:function(){var b=this._shimNode,c=this._stackNode;b&&(6===f.ie&&this.get("visible"))&&(b.setStyle("width",c.get("offsetWidth")+"px"),b.setStyle("height",c.get("offsetHeight")+"px"))},_getShimTemplate:function(){return g.create(c.SHIM_TEMPLATE,this._stackNode.get("ownerDocument"))}};b.WidgetStack=c},"3.17.2",{requires:["base-build","widget"],skinnable:!0});
YUI.add("squarespace-block-content-html",function(b){b.namespace("Squarespace.Content").Html=b.Base.create("html",b.Squarespace.SSWidget,[b.WidgetChild,b.Squarespace.Content.ContentBase],{initializer:function(b){(!b||!b.model)&&this.set("model",{});this.get("boundingBox").addClass("sqs-dd-invalid-handle")},syncUI:function(){var d=this.get("model").get("html");this.get("boundingBox").toggleClass("sqs-empty",b.Lang.isValue(d));var c=this.get("parent");(!c||!c.get("editController").isMobileApp())&&this.get("editable")&&
-1<["visual","wysiwyg"].indexOf(this.get("model").get("engine"))?this.contentEditor.visualEditor.setEditorData(d):this.get("contentBox").set("innerHTML",d);this.hasPlugin("contentEditor")&&this.contentEditor.syncEditorUI();c&&c.fire("widget:contentUpdate")},updateContentFromDOM:function(){var b=this.get("contentBox").getHTML();this.get("model").set("html",b||"")},setContent:function(b){this.get("model").set("html",b||"");this.syncUI()}},{CSS_PREFIX:"sqs-html",ATTRS:{model:{lazyAdd:!1,writeOnce:!0,
setter:function(d){if(b.instanceOf(d,b.Squarespace.ContentModel.Html))return d;if(b.Lang.isObject(d))return new b.Squarespace.ContentModel.Html(d)}},placeholderText:{value:"Write here..."},editor:{getter:function(){var d=this.get("parent");return d&&d.get("editController").isMobileApp()?b.Squarespace.Content.HtmlEditorMobile:d&&d.get("editMode")===b.Squarespace.Layout.EditMode.EMAIL?b.Squarespace.Content.HtmlEditorEmail:b.Squarespace.Content.HtmlEditor}},tabIndex:{value:null},type:{value:"full"},
referenceNode:{}}});b.namespace("Squarespace.ContentModel").Html=b.Base.create("HtmlContentModel",b.Model,[],{},{ATTRS:{engine:{value:"wysiwyg"},source:{value:""},html:{value:""}}})},"1.0",{requires:["model","squarespace-ss-widget","squarespace-block-content-base","widget-child"]});
YUI.add("squarespace-content-item-types-text",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.namespace("Squarespace.ContentItemEditor").Text=b.Base.create("TextContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{_dialogOnReady:function(){d.superclass._dialogOnReady.apply(this,arguments);this.get("model").get("autoSaved")&&this._bindTitleToPostUrl()},_bindTitleToPostUrl:function(){var c=this.get("dialog"),e=c.getField("title"),d=c.getField("urlId");e&&d&&(e.on("dataChange",
function(c){var e=d.get("data").split("/");e[e.length-1]=b.Squarespace.Utils.createUrlWithSlash(c.newVal);d.set("data",e.join("/"))},this),c.once(["close","dismiss"],function(b){this.get("model").set("autoSaved",!1)},this))},getPresentationName:function(){return"Post"},_getTemplateContext:function(){var b=d.superclass._getTemplateContext.call(this);b.enableFeatured=!0;b.enablePassthrough=!0;b.enableExcerpt=!0;return b}},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",width:750,
name:"text-post-editor",overlay:0.5,verticalHeight:"full",initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.text"]},{$include:"tabs.options.default"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["squarespace-content-item-types-base","squarespace-content-item-types-post-editors"]});
YUI.add("squarespace-uploader",function(b){if(b.Squarespace.Utils.isInDamaskFrame())b.Squarespace.Uploader=window.top.Y.Squarespace.Uploader;else{b.namespace("Squarespace");var d={ERR_FILE_UPLOAD:"Upload failed, please retry",ERR_FILE_PROCESSING:"Error processing file, please retry.",INVALID_SIZE_TITLE:"File Size Limit Exceeded",INVALID_SIZE:"The file <strong>{name}</strong> is too large. The maximum allowed file size is <strong>{size}MB</strong>.",INVALID_TYPE_TITLE:"Only {typeDescription} Allowed",
INVALID_TYPE:"The file <strong>{name}</strong> does not appear to be a supported {type} file.",HINT_FILE_UPLOAD:"Click here or drag and drop to add a file",HINT_FILE_UPLOAD_CLICK_ONLY:"Click here to add a file"};"none"===b.Uploader.TYPE?console.error("non-functional uploader"):b.Squarespace.Uploader=b.Base.create("uploader",b.Uploader,[b.WidgetChild],{initializer:function(c){this.set("swfURL","/combo/yui/?3.10.1/uploader/assets/flashuploader.swf");this.set("buttonClassNames",{hover:"",active:"",focus:""});
this.after(["dragenter","dragleave","drop"],this._ddHandler,this);this._files={};this.get("fileFilters")||this.addAttr("fileFilters",{value:null});this.after("uploadprogress",this._onUploadFileProgress,this);this.after("uploadcomplete",this._onUploadFileComplete,this);this.on("uploaderror",this._onUploadFileFailure,this);this.on("fileListChange",this._fileListChange,this);this.after("fileFiltersChange",this._fileFiltersChange,this);b.Data.DEBUG&&(this.on("fileuploadstart",function(c){console.log("[UPLOAD] SEND:  "+
this.get("uploadURL")+" (POST) : ",b.clone(c.target._files[c.file.get("id")].postData))},this),this.on("uploadcomplete",function(c){console.log("[UPLOAD] RECV:  "+this.get("uploadURL")+" (POST) : ",b.clone(c.target._files[c.file.get("id")].postData))},this));c.fileFilters&&this.set("fileFilters",c.fileFilters)},destructor:function(){var b=this.get("dragAndDropArea");b&&b.removeClass("drop-active");this._jobOnceCompleteEvt&&this._jobOnceCompleteEvt.detach();this._jobOnceFailureEvt&&this._jobOnceFailureEvt.detach()},
cleanupFile:function(b){if(b){var e=b.get("id");this.set("fileList",this.get("fileList").filter(function(b){return b.get("id")!==e}),{source:"cleanupFile"});delete this._files[e]}},bindUI:function(){b.Squarespace.Uploader.superclass.bindUI.call(this);this.on("selectButtonLabelChange",function(b){this.get("selectFilesButton").one(".text").setContent(b.newVal)},this)},_onUploadFileProgress:function(b){var e=b.file&&b.file.get("id");if(e=(e=this._files[e])&&e.placeholder&&e.placeholder.progress)e.set("showBar",
!0),e.set("showSpinner",!1),e.set("progress",b.percentLoaded)},_onUploadFileComplete:function(c){var e=c.file&&c.file.get("id"),e=this._files[e]||{},d=e.placeholder&&e.placeholder.progress,g=c.data;if("string"===typeof g)try{g=b.JSON.parse(g)}catch(h){this._onUploadFileFailure(c)}if(g.error)this._onServerRejectFile(c,g);else if(d?(d.set("progress",100),d.set("showBar",!1)):console.warn("No progress plugin was found on the placeholder. (_onUploadFileComplete)"),this.get("fileComplete")&&this.get("fileComplete")(e,
g),this.get("createJob")){if(g&&g.job&&(d&&d.set("showSpinner",!0),c=e.job=this.get("createJob")(e,g)))c.get("id")||c.set("id",e.id),this._jobOnceCompleteEvt=c.once("complete",b.bind(this._onJobHandler,this,"Complete",e)),this._jobOnceFailureEvt=c.once("failure",b.bind(this._onJobHandler,this,"Failure",e)),Static.JOB_MANAGER.addJob(c)}else d&&e.placeholder.progress.setAttrs({showBar:!1,showSpinner:!1}),this.cleanupFile(c.file),this.fire("upload-complete",b.JSON.parse(c.data))},_onServerRejectFile:function(c,
e){new b.Squarespace.Widgets.Alert({"strings.title":"Upload error","strings.message":e.error});this.fire("upload-failure");this.cleanupFile(c.file)},_onUploadFileFailure:function(c){var e=this.fileDataFromFile(c.file);e.error={type:b.Squarespace.MediaProcessingErrors.UPLOAD,message:d.ERR_FILE_UPLOAD};c.fileData=e;this.cleanupFile(c.file);this.abort()},_onJobHandler:function(c,e,f){var g="job"+c,h=e.placeholder&&e.placeholder.progress;h&&h.set("showSpinner",!1);if(e.id&&!this._files[e.id])return console.log("file upload aborted");
"failure"==c.toLowerCase()&&(e.error={type:b.Squarespace.MediaProcessingErrors.PROCESSING,message:d.ERR_FILE_PROCESSING});this.get(g)&&this.get(g)(e,f.target);this.cleanupFile(e.file);this.fire(g,{job:f.target,fileData:e})},_ddHandler:function(b){var e=this.get("dragAndDropArea");e&&("dragenter"===b.type?e.addClass("drop-active"):e.removeClass("drop-active"))},uploadAll:function(){var c=this.get("fileList");c&&0===c.length||(this.get("isTransient")&&!this.get("transientItemId")?this.preflightTransient(this.get("isGlobal"),
function(){b.each(this._files,function(b){var c=b.postData,d=this.get("transientItemId");c&&("undefined"!==typeof c.replaceItemId&&!c.replaceItemId)&&(b.postData.replaceItemId=d)},this);this.uploadAll()},this):(c=this.get("preflight"))?c(b.bind(function(){b.each(this.get("fileList"),function(b,c){this._processFile(this.fileDataFromFile(b))},this);b.Squarespace.Uploader.superclass.uploadAll.call(this)},this)):b.Squarespace.Uploader.superclass.uploadAll.call(this))},abort:function(){this.set("fileList",
[])},fileDataFromFile:function(b){if(b)return this._files[b.get("id")]},preflightTransient:function(c,e,d){b.Data.post({url:"/api/commondata/"+(c?"SaveTransientGlobalItem":"SaveTransientItem"),data:this.transientItemId,success:b.bind(function(b){this.set("transientItemId",b.id);this.set("transientItemUrl",b.urlId);e.call(d||this,b)},this)})},validateFile:function(c){c=c.get?this.fileDataFromFile(c):c;var e=c.file,f=[];e.get("size")>1048576*this.get("maxSize")&&f.push({title:d.INVALID_SIZE_TITLE,message:b.substitute(d.INVALID_SIZE,
{name:e.get("name"),size:this.get("maxSize")})});if(this._extensionCheck&&!this._extensionCheck.test(e.get("name"))){var g=this.get("fileFilters").map(function(b){return b.description}),g=1<g.length?g.slice(0,-1).join(",")+" or "+g[g.length-1]:g[0],g={typeDescription:g,name:e.get("name"),type:g.toLowerCase().replace(/s\b/g,"")};f.push({title:b.substitute(d.INVALID_TYPE_TITLE,g),message:b.substitute(d.INVALID_TYPE,g)})}g=this.get("validateFileFn");b.Lang.isFunction(g)&&(e=g(e,c),b.Lang.isObject(e)&&
f.push(e));f.length&&(c.invalid=f);return!f.length},makeDefaultErrorBlock:function(c){var e=(c=c.file?c:this.fileDataFromFile(c))&&c.error;return!e?"":err=b.Node.create('<div class="failed"><div class="message">'+e.message+'</div><div class="filename">'+c.file.get("name")+'</div><div class="button"><div class="button-title">Dismiss</div></div></div>')},_fileFiltersChange:function(c){var e=[];c.newVal&&(b.each(c.newVal,function(b){b=b.extensions.split(";").map(function(b){return"(?:"+b.slice(2)+"$)"});
e=e.concat(b)},this),this._extensionCheck=RegExp(e.join("|"),"i"))},_setFileFilters:function(){if(this._fileInputField)if(0<this.get("fileFilters").length){for(var b=[],e=this.get("fileFilters"),d=0;d<e.length;d++)b+=e[d].acceptTypes;this._fileInputField.set("accept",b)}else this._fileInputField.set("accept","")},_fileListChange:function(c){if("cleanupFile"!=c.source){var e={},d=!1;!this.get("multipleFiles")&&1<c.newVal.length&&(c.newVal=[c.newVal[0]]);var g=[];b.each(c.newVal,function(b,c){var h=
b.get("id");if(this._files[h])g.push(b);else{var q=this._processFile({id:h,file:b,index:c});q.invalid?(console.log("invalid",b.get("name")),g.push(b)):(e[h]=q,d=!0,!e[h].placeholder&&this.get("addPlaceholder")&&(e[h].placeholder=this.get("addPlaceholder")(e[h])),console.log("processing "+b.get("name")),delete this._files[h])}},this);if(g.length)for(var h=0;h<g.length;h++)c.newVal.remove(g[h]);this.get("removePlaceholder")&&b.each(this._files,function(b,c){this.queue&&this.queue.cancelUpload(b.file);
b.job&&Static.JOB_MANAGER.removeJobById(b.job.id);this.get("removePlaceholder")(b)},this);this._files=e;d&&this.get("autoUpload")&&b.later(0,this,this.uploadAll)}},_processFile:function(c){this.validateFile(c);var e=this.get("processFile");e&&e(c);c.postData=b.merge(c.postData||{},{fileName:c.file.get("name"),fileSize:c.file.get("size")});e=this.get("postVarsPerFile");e[c.id]=c.postData;this.set("postVarsPerFile",e);return c},_makeDefaultSelectFilesButton:function(){return b.Node.create('<button class="upload-indicator image" tabindex="0"><div class="icon">&nbsp;</div><div class="text">'+
this.get("selectButtonLabel")+"</div></button>")}},{CSS_PREFIX:"sqs-uploader",ATTRS:{processFile:{},addPlaceholder:{},removePlaceholder:{},preflight:{},createJob:{},fileComplete:{},jobComplete:{},jobFailure:{},autoUpload:{value:!1},isTransient:{value:!1},isGlobal:{value:!1},transientItemId:{value:""},transientItemUrl:{value:""},maxSize:{value:20},uploadURL:{valueFn:function(){return"/api/commondata/"+(this.get("isGlobal")?"SaveGlobalMedia":"SaveMedia")},setter:function(c){return b.Data.addCrumb(c)}},
selectButtonLabel:{value:"flash"==b.Uploader.TYPE?d.HINT_FILE_UPLOAD_CLICK_ONLY_HINT:d.HINT_FILE_UPLOAD},selectFilesButton:{valueFn:"_makeDefaultSelectFilesButton",setter:function(b){return!b?this._makeDefaultSelectFilesButton():b}},validateFileFn:{}}})}},"1.0",{requires:["base","node","widget-child","uploader","squarespace-widgets-alert"]});
YUI.add("squarespace-models-billing-summary",function(b){b.namespace("Squarespace.Models.Billing");b.Squarespace.Models.Billing.Summary=b.Base.create("billingSummary",b.Model,[b.Squarespace.ModelSync.REST],{url:"/api/billing/summary",isNew:function(){return!1},parse:function(d){d=b.Squarespace.Models.Billing.Info.superclass.parse.call(this,d);d.subscriptions=new b.Squarespace.Models.Billing.SubscriptionList({items:b.Array.map(d.subscriptions,function(b){b.renewalDate=new Date(b.renewalDate);return b})});
d.eligibleBillingContacts=new b.Squarespace.Models.Billing.ContactList({items:d.eligibleBillingContacts});d.customer=new b.Squarespace.Models.Billing.Customer(d.customer);return d}},{ATTRS:{eligibleBillingContacts:{validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.Billing.ContactList)},subscriptions:{validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.Billing.SubscriptionList)},customer:{validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.Billing.Customer)}}})},
"1.0",{requires:"base model squarespace-model-sync-rest squarespace-models-billing-customer squarespace-models-billing-subscription-list squarespace-models-billing-contact-list".split(" ")});
YUI.add("squarespace-models-range-paginator",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.RangePaginator=b.Base.create("RangePaginator",b.Squarespace.Models.Paginator,[],{initializer:function(){b.Do.before(function(c){c=b.JSON.parse(c);var e=c.nextPageStart;this._set("previousPageStart",c.previousPageStart||null);this._set("nextPageStart",e||null)},this.get("models"),"parse",this)},firstPage:function(){d.superclass.firstPage.call(this);this._set("previousPageStart",null);
this._set("nextPageStart",null);this._set("start",null);this.set("pageAction",b.Squarespace.PageAction.NEXT)},previousPage:function(){d.superclass.previousPage.call(this);this._set("start",this.get("previousPageStart"));this.set("pageAction",b.Squarespace.PageAction.PREVIOUS)},nextPage:function(){d.superclass.nextPage.call(this);this._set("start",this.get("nextPageStart"));this.set("pageAction",b.Squarespace.PageAction.NEXT)},currentPage:function(){d.superclass.currentPage.call(this);this._set("pageAction",
b.Squarespace.PageAction.NEXT)},_getPaginationParams:function(){var c=d.superclass._getPaginationParams.call(this);c.pageAction=this.get("pageAction");var e=this.get("start");b.Lang.isValue(e)&&(c.start=e);return c}},{ATTRS:{pageAction:{value:b.Squarespace.PageAction.NEXT,validator:function(c){if(b.Object.hasValue(b.Squarespace.PageAction,c))return!0;console.error("RangePaginator: Invalid pageAction.");return!1}},start:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString,readOnly:!0},
previousPageStart:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString,setter:function(b){return b},readOnly:!0},nextPageStart:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString,setter:function(b){return b},readOnly:!0}}})},"1.0",{requires:["base","squarespace-attr-validators","squarespace-enum","squarespace-models-paginator"]});
YUI.add("squarespace-settings-activity-mixin-spinnerfied",function(b){b.namespace("Squarespace.Settings.Activity");b.Squarespace.Settings.Activity.MixinSpinnerfied=b.Base.create("mixinSpinnerfied",b.Base,[],{initializer:function(){b.Do.before(this._startSpinner,this,"requestData",this);b.Do.before(this._stopSpinner,this,"_requestDataSuccess",this);b.Do.before(this._stopSpinner,this,"_requestDataFailure",this)},destructor:function(){this._stopSpinner()},_startSpinner:function(){this._stopSpinner();
this.clearElements();var d=new b.Squarespace.Spinner({color:"dark"}),c=b.Node.create('<div class="spinner-container"></div>'),e=b.later(100,this,function(){d.render(c)});this.get("contentBox").append(c);this._currentSpinHandle={cancel:function(){d.get("rendered")||e.cancel();d.destroy();c.remove(!0)}}},_stopSpinner:function(){this.hasSpinner()&&(this._currentSpinHandle.cancel(),this._currentSpinHandle=null)},hasSpinner:function(){return b.Lang.isValue(this._currentSpinHandle)}},{})},"1.0",{requires:["base",
"squarespace-spinner"]});YUI.add("squarespace-hb-money-string",function(b){b.Handlebars.registerHelper("money-string",function(d,c){return new b.Handlebars.SafeString(b.Squarespace.Commerce.moneyString(d))})},"1.0",{requires:["handlebars-base","squarespace-commerce-utils"]});
YUI.add("squarespace-dialog-flow",function(b){b.namespace("Squarespace");b.Squarespace.DialogFlow=b.Base.create("dialogFlow",b.Base,[],{initializer:function(b){this.set("options",b.options);this.set("title",b.title);this.set("fieldName",b.fieldName)},showPrescreen:function(d){var c=this.get("fieldName");b.Lang.isUndefined(d)&&(d={});var e=this._prescreen=new b.Squarespace.EditingDialog({name:this.get("fieldName"),overlay:0.5,width:this.get("width"),style:"flyout",initialData:d,closeOthers:!1,buttons:[{type:"cancel",
title:"Cancel"}],discardChangesConfirmation:!1,primaryTabs:[{title:this.get("title"),icon:this.get("icon")||"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:this.get("subtitle"),text:this.get("description")}},{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:c,options:this.get("options"),optionClickCb:this.get("optionClickCb"),columns:this.get("optionColumns")}}]}]});e.on("ready",function(){e.getField(c).after("dataChange",
function(b){e.close();this.proceed(d,b.newVal)},this)},this);e.show()},close:function(){this._prescreen.close()},proceed:function(d,c){d[this.get("fieldName")]=c;var e=this.get("nextDialogGenerator");if(e)if(e=e(d),e instanceof b.Squarespace.DialogFlow)e.showPrescreen(d);else if(e.constructor instanceof b.Squarespace.EditingDialog.constructor)e.show();else{if(void 0===e)throw"nextDialog not specified";throw"Unsupported Dialog";}else this.fire("proceed",{valueChoice:c})}},{NS:"dialogFlow",ATTRS:{description:{value:""},
fieldName:{value:""},nextDialogGenerator:{value:null},options:{value:[]},optionClickCb:{value:null},optionColumns:{value:1},subtitle:{value:""},title:{value:""},width:{value:550}}})},"1.0",{requires:["base","squarespace-dialog","squarespace-dialog-description","squarespace-dialog-multi-option"]});
YUI.add("squarespace-editor-navigation-collection",function(b){var d={name:"collection-configure",width:475,savingText:"Saving...",loadingText:"Loading...",flyoutPointerDirection:"left",tabs:[{title:{$valueFn:function(b){return(b=b.getTemplateConfiguration())?"Edit "+b.get("title"):"Edit Page"}},icon:"/universal/images-v6/icons/icon-settings-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{submitOnEnter:!0,required:!0,name:"navigationTitle","strings.placeholder":"Page Title"}},
{ctor:b.Squarespace.DialogFields.Url,config:{submitOnEnter:!0,required:!0,name:"urlId",prefix:"/","strings.placeholder":"page-name"},$when:b.Squarespace.Utils.isDamaskEnabled},{type:"text",name:"urlId",prefix:"/",description:"The unique location slug for this page.",fieldStyle:"normal",titleStyle:"top",filter:"url-slug-with-slash",style:"thin",icon:"link",$when:function(){return!b.Squarespace.Utils.isDamaskEnabled()}},{ctor:b.Squarespace.DialogFields.Description,config:{countHeight:!0,padding:[5,
0],text:{$valueFn:function(b){return b.getTemplateConfiguration()&&b.get("folder")?"Enter a URL for this folder above":"<strong>Enter a URL for this collection above.</strong> Advanced settings for this collection are located in the upper right while editing the collection."}}}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"duplicate",title:"Duplicate Page",$when:function(c){return c.get("type")==b.Squarespace.CollectionTypes.PAGE}},{type:"setFront",title:"Set Homepage",$when:function(c){var d=
c.getTemplateConfiguration();return d&&d.get("folder")&&!d.get("index")?!1:c.get("id")==b.Squarespace.Singletons.Template.get("homepageCollectionId")?!1:!0}},{type:"toggleEnabled",title:{$valueFn:function(b){return b.get("enabled")?"Disable":"Enable"}},$when:function(b){var c=b.getTemplateConfiguration();return c?c.get("folder")&&!b.get("enabled"):!1}},{type:"remove",title:"Delete",$when:function(c){return c.get("type")!=b.Squarespace.CollectionTypes.TEMPLATE_PAGE}},{type:"saveAndClose",title:"Save"}]},
c=b.namespace("Squarespace.Editor").NavigationCollection=b.Base.create("NavigationCollectionEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this.plug(b.Squarespace.ModelEditorPlugins.LoadBeforeShowing);this.on("modelChange",function(c){var e=this.get("dialog");this._dataChangeHandler&&this._dataChangeHandler.detach();this._cancelHandler&&this._cancelHandler.detach();c.newVal&&(this._dataChangeHandler=e.on("datachange",function(d){if((d.getDialog?d.getDialog():d.get("dialog")).state==
b.Squarespace.DialogStates.EDITING&&"navigationTitle"==d.getName()){c.newVal.set("navigationTitle",d.getValue());c.newVal.set("title",d.getValue());var k=e.getField("urlId");this.get("isNew")&&k.setValue(b.Squarespace.Utils.createUrl(d.getValue(),"",null))}},this),this._cancelHandler=e.on("cancel",function(){c.newVal.resetToLastRead()}))},this);var c=this.get("dialog");c.on("button-setFront",this._changeHomepageCollectionId,this);c.on("button-duplicate",this._duplicatePage,this);c.on("button-toggleEnabled",
this._toggleEnabled,this)},_changeHomepageCollectionId:function(){var c=this.get("model"),d=this.get("dialog"),g=this.get("template");(new b.Squarespace.Widgets.Confirmation({"strings.title":"Set Homepage","strings.message":"Are you sure you want to make this collection the front page of your site?  It will be the first thing visitors to your site see."})).on("confirm",function(){d.updateTitle(b.Squarespace.DialogStates.SAVING);d.showSaveOverlay();g.set("homepageCollectionId",c.get("id"));g.saveHomepageCollectionId(function(c,
e){c?(new b.Squarespace.SystemError("Something Went Wrong",c,"json")).show():(d._removeButton("setFront"),d.hideSaveOverlay())})},this)},sanitizeDialogData:function(b){c.superclass.sanitizeDialogData.call(this,b);b.title=b.navigationTitle;b.enabled=this.get("model").get("enabled");return b},_duplicatePage:function(){var c=this.get("model");(new b.Squarespace.Widgets.Confirmation({"strings.title":"Duplicate Page","strings.message":"Are you sure you want to create a copy of <strong>"+b.Escape.html(c.get("navigationTitle"))+
"</strong>?"})).on("confirm",function(){b.Data.post({url:"/api/commondata/CopyCollection",data:{collectionId:c.get("id")},success:function(c){var e=b.Squarespace.ContentCollectionCache.add(c);c=this.get("template").get("navigations").getHiddenNavigation().get("itemList");var d=c.add({collectionId:e.get("id"),enabled:!0,title:e.get("navigationTitle"),typeName:e.get("typeName"),urlId:e.get("urlId")});c.save(b.bind(function(){this.fire("page-duplicated",{collection:e,navigationItem:d})},this))}},this);
this.hide()},this)},_toggleEnabled:function(){var c=this.get("model"),d=!c.get("enabled"),g=b.bind(function(){if(d&&!c.get("enabled"))(new b.Squarespace.Widgets.Confirmation({"strings.title":"Page Limit Reached","strings.message":"This collection cannot be enabled because you have exceeded the maximum number of pages allowed by your current plan (20). Upgrade to the <strong>Unlimited</strong> plan to enable more pages.","strings.confirm":"Upgrade"})).on("confirm",function(){CONFIG_PANEL.getHistory().replace({module:"settings",
"settings-subPanelName":"billing-settings"})})},this);if(d)c.set("enabled",!0),this.save({},g);else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Disable Collection","strings.message":"Are you sure you wish to disable this collection?"})).on("confirm",function(){c.set("enabled",!1);this.save({},g)},this)}},{ATTRS:{dialogConfig:{value:d},isNew:{value:!1},template:{valueFn:function(){return b.Squarespace.Singletons.Template}}}})},"1.0",{requires:["squarespace-dialog-text","squarespace-dialog-description",
"squarespace-model-editor","squarespace-widgets-confirmation"]});
YUI.add("squarespace-dialog-form-builder",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.FormBuilder=b.Base.create("formBuilder",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(){this._fieldSelector=this._createFieldSelector();this._edited=!1},destructor:function(){this._fieldSelector.destroy();this._ddDelegate&&this._ddDelegate.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._childrenContainer=
this._fieldContainer=b.appendChild('<div class="field-container"></div>');this._addFieldButton=b.appendChild('<div class="add-field-button"><div class="title"><div class="type-icon add"></div><span class="title-text">Add Field</span></div></div>');this._setupDragAndDrop()},bindUI:function(){d.superclass.bindUI.call(this);this._fieldSelector.on("datachange",function(c){c=c.getValue();var e=this._validateFieldSelection(c);e?new b.Squarespace.Widgets.Alert({"strings.title":e.title,"strings.message":e.description}):
(this._fieldSelector.close(),this.addField(b.clone(c),!0))},this);this.on("change",function(){this.fire("dataChange",{noSyncUI:!0});this._edited=!0},this);this._addFieldButton.on("click",function(b){b.halt();this._openFieldSelector()},this);this.on("*:editingChange",function(b){b.newVal&&this.closeChildren(b.target)},this);this.on("*:removeClicked",function(b){this._confirmFieldRemoval(b.target)},this);this.on("*:fieldChange",function(b){this.fire("change")},this);this.on("*:destroy",function(){this._ddDelegate.syncTargets()},
this);this._ddReorder.on("reordered",function(b){this._reorderField(b.oldIndex,b.newIndex)},this)},syncUI:function(){d.superclass.syncUI.call(this);this.removeAll().each(function(b){b.destroy()});var c=this.get("data");b.Array.each(c,function(e){b.Squarespace.FormEditingUtils.resolveFieldId(e,c);this._renderFieldWidget(e)},this)},didDataChange:function(){return this._edited},closeChildren:function(c){var e=b.Lang.isValue(c);this.each(function(b){b.get("editing")&&(!e||b!==c)&&b.closeEdit()})},addField:function(c,
e){var d=this.get("data");b.Squarespace.FormEditingUtils.resolveFieldTitle(c,d);b.Squarespace.FormEditingUtils.resolveFieldId(c,d);this._renderFieldWidget(c,e);d.push(c);this.fire("change")},removeField:function(c){var e=c.get("field").id;this._removeFieldWidget(c);c=this.get("data");var d;b.Array.each(c,function(b,c){b.id===e&&(d=c)},this);c.splice(d,1);this.fire("change")},lockField:function(b){this.each(function(e){e.get("field").id===b.id&&e.lock()},this)},unlockField:function(b){this.each(function(e){e.get("field").id===
b.id&&e.unlock()},this)},getFieldWidget:function(b){var e;this.each(function(d){d.get("field").id===b.id&&(e=d)},this);return e},_setupDragAndDrop:function(){this._ddDelegate=new b.DD.Delegate({container:this._fieldContainer,nodes:".sqs-form-builder-field:not(.yui3-dd-super-proxy-clone)",handles:[".sqs-form-builder-field:not(.yui3-dd-super-proxy-clone) .field-drag-handle-wrapper"],target:!0});var c=this._ddDelegate.dd;this._ddReorder=c.plug(b.Squarespace.DDReorder,{container:this._fieldContainer,
nodes:".sqs-form-builder-field:not(.yui3-dd-super-proxy-clone)"}).ddreorder;c.plug(b.Plugin.DDConstrained,{constrain:this._fieldContainer,stickY:!0});c.plug(b.Plugin.DDNodeScroll,{node:this._fieldContainer,horizontal:!1,scrollDelay:100})},_reorderField:function(b,e){var d=this.get("data"),g=d.splice(b,1)[0];d.splice(e,0,g);this.add(this.remove(b),e);this.fire("change")},_renderFieldWidget:function(c,e){var d=this.add(new b.Squarespace.Widgets.FormBuilderField({field:c})).item(0);e&&(d.once("editingChange",
function(){var b=this.get("boundingBox"),c=b.get("scrollTop"),e=d.get("boundingBox").getY(),c=c+e-b.getY();b.set("scrollTop",c)},this),d.openEdit(),d.focusAndSelect());this._ddDelegate.syncTargets()},_removeFieldWidget:function(c){var e=c.get("boundingBox"),d=[];this.get("contentBox").all(".add-field-button, .sqs-form-builder-field").each(function(c){c!==e&&(c.plug(b.Squarespace.PositionAnimator),c=c.positionAnimator,c.hold(),d.push(c))});c.blur();this.remove(c);c.destroy(!0);b.Array.each(d,function(b){b.release()})},
_openFieldSelector:function(){this.get("dialog").addChildDialog(this._fieldSelector);this._fieldSelector.show({anchor:this._addFieldButton})},_confirmFieldRemoval:function(c){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove","strings.message":"Are you sure you wish to remove this field?"})).on("confirm",function(){this.removeField(c)},this)},_validateFieldSelection:function(b){b="email"===b.type;var e=this.get("allowMultipleEmailFields"),d=this._hasEmailField();if(b&&!e&&d)return{title:"Email Field Not Added",
description:"Only one email field can be added to a Mailchimp-connected form."}},_hasEmailField:function(){var c=!1;b.Array.each(this.get("data"),function(b){"email"===b.type&&(c=!0)});return c},_createFieldSelector:function(){var c=this._getFieldOptions(),e=Math.min(c.length,5);return new b.Squarespace.EditingDialog({closeOthers:!1,loadingText:"Loading...",closingText:"Creating...",style:"flyout",flyoutPointerDirection:"centered",width:100*e,overlay:0.5,primaryTabs:[{title:"Add Form Field",icon:"/universal/images-v6/icons/icon-plus-16-light.png",
fields:[{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"fieldOptions",titleStyle:"top",className:"button round square",defaultValue:null,iconDropPx:20,buttonStyle:!0,columns:e,alwaysShowTitles:!0,options:c}}]}]})},_getFieldOptions:function(){var c=b.Squarespace.FormFieldConfigs;return[{icon:"text",title:"Text",value:c.TEXT},{icon:"textarea",title:"Text Area",value:c.TEXT_AREA},{icon:"select",title:"Select",value:c.SELECT},{icon:"checkbox",title:"Checkbox",value:c.CHECKBOX},{icon:"radio",
title:"Radio",value:c.RADIO},{icon:"likert",title:"Survey",value:c.LIKERT},{icon:"name",title:"Name",value:c.NAME},{icon:"password",title:"Password",value:c.PASSWORD},{icon:"address",title:"Address",value:c.ADDRESS},{icon:"twitter",title:"Twitter",value:c.TWITTER},{icon:"email",title:"Email",value:c.EMAIL},{icon:"website",title:"Website",value:c.WEBSITE},{icon:"date",title:"Date",value:c.DATE},{icon:"time",title:"Time",value:c.TIME},{icon:"phone",title:"Phone",value:c.PHONE},{icon:"number",title:"Number",
value:c.NUMBER},{icon:"currency",title:"Currency",value:c.CURRENCY},{icon:"sectionbreak",title:"Line",value:c.SECTION},{icon:"hidden",title:"Hidden",value:c.HIDDEN}]}},{CSS_PREFIX:"sqs-form-builder",ATTRS:{data:{value:[],validator:b.Squarespace.AttrValidators.isArray},allowMultipleEmailFields:{value:!0,validator:b.Squarespace.AttrValidators.isBoolean}}})},"1.0",{requires:"base node widget-parent squarespace-util squarespace-ui-base squarespace-dd-behaviors squarespace-dialog squarespace-dialog-field-2 squarespace-dialog-multi-option squarespace-form-builder-field squarespace-form-field-configs squarespace-attr-validators squarespace-form-editing-utils squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-dialog-text-datetime-picker",function(b){b.namespace("Squarespace.DialogFields");var d={13:!0,27:!0,16:!0,17:!0,18:!0,20:!0,36:!0,35:!0,33:!0,34:!0,37:!0,38:!0,39:!0,40:!0,112:!0,113:!0,114:!0,115:!0,116:!0,117:!0,118:!0,119:!0,120:!0,121:!0,122:!0,123:!0,45:!0,91:!0,144:!0},c=b.Squarespace.DialogFields.TextDateTimePicker=b.Base.create("textDateTimePicker",b.Squarespace.DialogFields.DateTimePicker,[],{renderUI:function(){c.superclass.renderUI.call(this);this.get("boundingBox").addClass("sqs-text");
var e=this.get("contentBox").one(".sqs-datetime-picker-input");e.set("name",this.get("name"));var d=0,g=this.get("dialog")||this.get("panel");b.Lang.isValue(g)&&b.Lang.isFunction(g.getNextTabIndex)&&(d=g.getNextTabIndex());e.set("tabIndex",d)},_bindCalendarToggleEvents:function(){var c=this.get("contentBox").one(".sqs-datetime-picker-input");this._registerEvent(this._picker.get("contentBox").after("clickoutside",function(b){if(b.target===c)return!1;this._hidePicker()},this));c.on("click",function(b){b.target.focus();
this._showPicker(b.target)},this);c.on("keyup",b.Squarespace.debounce(function(b){d[b.keyCode]||this.updateContent()},400,!1),this)},_updatePickerData:function(b){this._suppressErrors=!0;this._picker.set("data",b.newVal);this._alignPicker();this._suppressErrors=!1},updateContent:function(){var c=this.get("contentBox").one(".sqs-datetime-picker-input"),c=(new Date(c.get("value"))).getTime();b.Lang.isNumber(c)?this.set("data",c):this._updateDescription(this.get("data"))},_updateDescription:function(c){c=
new Date(c);var d=this.get("contentBox").one(".sqs-datetime-picker-input");c=b.Squarespace.DateUtils.dateFormat(c,{format:this.get("dateFormat")});d.set("value",c)}},{ATTRS:{dateFormat:{value:"%D @ %I:%M %p"},defaultPositionNode:{getter:function(){return this.get("boundingBox").one(".sqs-datetime-picker-input")||this.get("boundingBox")}},errorFlyoutAnchor:{getter:function(){return this.get("contentBox").one(".sqs-datetime-picker-input-wrapper")}}},CSS_PREFIX:"sqs-text-datetime-picker",TEMPLATE:'<div class="sqs-datetime-picker-title"></div><div class="sqs-datetime-picker-input-wrapper"><input class="sqs-datetime-picker-input" type="text"></div>'})},
"1.0",{requires:["base","squarespace-dialog-datetime-picker","squarespace-dialog-field-2","squarespace-ss-widget"]});
YUI.add("squarespace-models-tax-rule",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.TaxRule=b.Base.create("TaxRule",b.Model,[],{initializer:function(d){var c=b.Squarespace.Localities.COUNTRIES_TO_STATES[this.get("countryCode")];d.scope==b.Squarespace.TaxScopes.COUNTRY?this.set("name",b.Squarespace.Localities.COUNTRY_OPTIONS[d.countryCode].title):d.scope==b.Squarespace.TaxScopes.STATE?this.set("name",c[d.state].title):d.zipStart!=d.zipEnd?this.set("name",d.zipStart+" to "+d.zipEnd):
this.set("name",d.zipStart);this.set("shippingRate",this.get("chargeTaxOnShipping")?this.get("rate"):0)},newChildRaw:function(){var d;switch(this.get("scope")){case b.Squarespace.TaxScopes.COUNTRY:d={scope:b.Squarespace.TaxScopes.STATE,chargeTaxOnShipping:this.get("chargeTaxOnShipping"),chargeTaxOnServices:this.get("chargeTaxOnServices"),countryCode:this.get("countryCode")};break;case b.Squarespace.TaxScopes.STATE:d={scope:b.Squarespace.TaxScopes.LOCAL,chargeTaxOnShipping:this.get("chargeTaxOnShipping"),
chargeTaxOnServices:this.get("chargeTaxOnServices"),countryCode:this.get("countryCode"),state:this.get("state")};break;case b.Squarespace.TaxScopes.LOCAL:throw"Cannot create a scope lower than local";}return d},hasStates:function(){return!b.Lang.isUndefined(b.Squarespace.Localities.COUNTRIES_TO_STATES[this.get("countryCode")])},getStateOptions:function(){return b.Squarespace.Localities.getNewStateOptionsForCountry(this.get("countryCode"))},isUSA:function(){return"US"===this.get("countryCode")},hasLocalTaxes:function(){return this.isUSA()},
isCanadian:function(){return"CA"==this.get("countryCode")},getAggregateRates:function(d){var c=this.get("rate")+b.Array.reduce(d,0,function(b,c){return b+c.get("rate")}),e=this.get("chargeTaxOnServices")?this.get("rate"):0,e=e+b.Array.reduce(d,0,function(b,c){return b+(c.get("chargeTaxOnServices")?c.get("rate"):0)}),f=this.get("chargeTaxOnShipping")?this.get("rate"):0,f=f+b.Array.reduce(d,0,function(b,c){return b+(c.get("chargeTaxOnShipping")?c.get("rate"):0)});return{products:c,services:e,shipping:f}},
debugLog:function(){var d=this.get("scope");if(d==b.Squarespace.TaxScopes.COUNTRY)return"["+this.get("countryCode")+"]";if(d==b.Squarespace.TaxScopes.STATE)return"["+this.get("countryCode")+","+this.get("state")+"]";if(d==b.Squarespace.TaxScopes.LOCAL)return"["+this.get("countryCode")+","+this.get("state")+","+this.get("name")+"]"},isParentOf:function(d){var c=this.get("scope");return c<d.get("scope")?c==b.Squarespace.TaxScopes.COUNTRY?this.get("countryCode")==d.get("countryCode"):c==b.Squarespace.TaxScopes.STATE?
this.get("countryCode")==d.get("countryCode")&&this.get("state")==d.get("state"):!1:!1},sync:function(b,c,e){switch(b){case "create":this._saveAll(e);break;case "delete":this._delete(e);break;case "read":this._read(e);break;case "update":c&&c.fields?this._saveFields(c.fields,e):this._saveAll(e)}},_saveAll:function(d){b.Data.post({url:"/api/commerce/admin/SaveTaxRule",data:this.getAttrs(),success:function(b){d(null,b)},failure:function(b){d(b,null)}},this)},_saveFields:function(b,c){},_delete:function(d){b.Data.post({url:"/api/commerce/admin/RemoveTaxRule",
data:{id:this.get("id")},success:function(b){d(null,b)},failure:function(b){d(b,null)}},this)},_read:function(b){}},{ATTRS:{countryCode:{},state:{},zipStart:{},zipEnd:{},chargeTaxOnShipping:{value:!1},chargeTaxOnServices:{value:!0},scope:{}}})},"2.0",{requires:["base","model","squarespace-enum","squarespace-localities","squarespace-commerce-utils"]});
YUI.add("squarespace-plugin-numeric-formatter",function(b){b.namespace("Squarespace.Plugin");b.Squarespace.Plugin.NumericFormatter=b.Base.create("numericFormatter",b.Plugin.Base,[],{initializer:function(){b.Lang.isNumber(Number(this.get("host").get("value")))?this.set("data",Number(this.get("host").get("value"))):this.set("data",0);this.set("displayString",this._format(this.get("data")));this._bindUI();this._syncUI()},_format:function(b){return this.get("displayFormatter")(b)},_syncUI:function(){var d=
this.get("data"),c=this.get("displayString");this.get("hasFocus")?this.get("host").set("value",0<d?c:""):(c="",b.Lang.isNull(this.get("prefixUnit"))||(c+=this.get("prefixUnit")),c+=this._format(d),b.Lang.isNull(this.get("postfixUnit"))||(c+=" "+this.get("postfixUnit")),this.get("host").set("value",c))},_bindUI:function(){var b=this.get("host");this.on("displayStringChange",this._syncUI,this);b.on("valuechange",this._onValueChange,this);b.on("keydown",this._onKeyDown,this);b.on("focus",this._onFocus,
this);b.on("blur",this._onBlur,this)},_onFocus:function(){this.set("hasFocus",!0);this._syncUI();setTimeout(b.bind(function(){this.get("host").select()},this),0)},_onBlur:function(){this.set("hasFocus",!1);this.set("displayString",this._format(this.get("data")))},_onKeyDown:function(b){var c;c=this.get("host").get("value");-1<[9,13,8,46,37,39].indexOf(b.keyCode)||(c=96<=b.keyCode&&105>=b.keyCode?String.fromCharCode(b.keyCode-48):190===b.keyCode||110===b.keyCode?-1<c.indexOf(".")?"x":".":String.fromCharCode(b.keyCode),
isFinite(Number(c))||"."===c||(b.stopPropagation(),b.preventDefault()))},_onValueChange:function(){var b=this.get("host").get("value"),b=this._transformToData(b);this.set("data",b)},_displayFormatter:function(b){return b},_transformToData:function(d){var c;b.Lang.isUndefined(this.get("prefixUnit"))||(c=String(d).replace(RegExp(this.get("prefixUnit"))));b.Lang.isUndefined(this.get("postfixUnit"))||(c=String(d).replace(RegExp(this.get("postfixUnit"))));return Number(c)}},{NS:"numericFormatterPlugin",
ATTRS:{hasFocus:{value:!1},data:{value:null},displayString:{value:null},prefixUnit:{value:null},postfixUnit:{value:null},displayFormatter:{value:function(b){return b}}}})},"1.0",{requires:["plugin","squarespace-util"]});
YUI.add("squarespace-block-link-editor",function(b){b.namespace("Squarespace.Block.Editor").Link=b.Base.create("link-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Link")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Link"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Link=b.Base.create("block-link-editor",b.Squarespace.ModelEditorDialog,[],{_sanitizeURL:function(b){return null===
b.match(/^[(?!\/\/)(http:\/\/|https:\/\/|\/|mailto:)].*/i)?"http://"+b:b},sanitizeDialogData:function(b){b.linkTarget&&4<b.linkTarget.length&&(b.linkTarget=this._sanitizeURL(b.linkTarget));return b}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:335,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit External Link",icon:"/universal/images-v6/icons/icon-link-16-light-solid.png",scroll:!0,fields:[{type:"description",
text:"Below, enter the title and the URL of the link you would like to add."},{type:"text",name:"linkTitle",submitOnEnter:!0,title:"Link Title",titleStyle:"inline",style:"title"},{type:"text",name:"linkTarget",submitOnEnter:!0,title:"http://...",titleStyle:"inline",style:"normal"},{type:"check",name:"newWindow",title:"Open in New Window",description:"When clicked, open this link in a new window."}]}]}},"1.0",{requires:["squarespace-block-editor-dialog","squarespace-damask-context-globals"]});
YUI.add("squarespace-block-flickr",function(b){b.namespace("Squarespace.Block").Flickr=b.Base.create("block-flickr",b.Squarespace.Block.SummaryGallery,[],{},{CSS_PREFIX:"sqs-block-flickr",MODEL:b.Squarespace.ContentModel.FlickrBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Flickr},type:{value:b.Squarespace.BlockType.FLICKR}}})},"1.0",{requires:["base","squarespace-enum","squarespace-block-summary-gallery","squarespace-block-flickr-editor","squarespace-block-flickr-model"]});
YUI.add("squarespace-stats-block-pie-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["stats-block-pie.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="sqs-pie">\n  <div class="graphic"></div>\n\n  <div class="description">\n    <div class="datametric">';(h=d.dataMetric)?h=h.call(c,{hash:{},data:k}):(h=c.dataMetric,h="function"===typeof h?h.apply(c):h);b+=l(h)+
'</div>\n    <div class="timeframe">';(h=d.timeFrame)?h=h.call(c,{hash:{},data:k}):(h=c.timeFrame,h="function"===typeof h?h.apply(c):h);return b+=l(h)+"</div>\n  </div>\n</div>"})})();b.Handlebars.registerPartial("stats-block-pie.html".replace("/","."),d.templates["stats-block-pie.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-shipping-legend-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-shipping-legend.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="title">';(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n<div class="head">\n  <div class="key"><div class="swatch gray" style="background-color:#222"></div></div>\n  <div class="header item">Item</div>\n  <div class="header dimensions">Dimensions</div>\n  <div class="header coordinates">Coordinates</div>\n  <div class="header weight right">Weight</div>\n</div>\n<div class="scrollable">\n';
if((h=d.each.call(c,c.packed,{hash:{},inverse:this.noop,fn:this.programWithDepth(1,function(b,c,e){var d;return b=""+('\n  <div class="shipping-legend-item" data-box-index="'+l((d=b.boxIndex,"function"===typeof d?d.apply(b):d))+'">\n    <div class="key">\n      <div class="swatch gray" style="background-color: '+l((d=b.grayColor,"function"===typeof d?d.apply(b):d))+';"></div>\n      <div class="swatch activeColor" style="background-color: '+l((d=b.activeColor,"function"===typeof d?d.apply(b):d))+
';"></div>\n    </div>\n    <div class="row">\n      <div class="cell item">'+l((d=b.title,"function"===typeof d?d.apply(b):d))+'</div>\n      <div class="cell dimensions">'+l((d=b.length,"function"===typeof d?d.apply(b):d))+l((d=e.dimensionUnit,"function"===typeof d?d.apply(b):d))+" x "+l((d=b.height,"function"===typeof d?d.apply(b):d))+l((d=e.dimensionUnit,"function"===typeof d?d.apply(b):d))+" x "+l((d=b.depth,"function"===typeof d?d.apply(b):d))+l((d=e.dimensionUnit,"function"===typeof d?d.apply(b):
d))+'</div>\n      <div class="cell coordinates">('+l((d=b.x,"function"===typeof d?d.apply(b):d))+", "+l((d=b.y,"function"===typeof d?d.apply(b):d))+", "+l((d=b.z,"function"===typeof d?d.apply(b):d))+')</div>\n      <div class="cell weight right">'+l((d=b.weight,"function"===typeof d?d.apply(b):d))+" "+l((d=e.weightUnit,"function"===typeof d?d.apply(b):d))+"</div>\n    </div>\n  </div>\n")},k,c),data:k}))||0===h)b+=h;return b+"\n</div>"})})();b.Handlebars.registerPartial("dialog-shipping-legend.html".replace("/",
"."),d.templates["dialog-shipping-legend.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-plugin-sizeanimator",function(b){b.namespace("Squarespace.Plugins").SizeAnimator=b.Base.create("SizeAnimator",b.Plugin.Base,[],{hold:function(){var b=this.get("host");this._width=b.get("offsetWidth");this._height=b.get("offsetHeight")},release:function(){var d=this.get("host"),c=b.Node.create("<div></div>"),e=d.get("offsetWidth"),f=d.get("offsetHeight");e==this._width&&this._height==f||(d.get("children").each(function(b){c.append(b)}),c.setStyles({width:e,height:f}),d.appendChild(c),
d.addClass("sqs-sizeanimator-animating"),d.anim({width:e,height:f},{from:{width:this._width,height:this._height},end:function(){d.removeClass("sqs-sizeanimator-animating");d.setStyles({width:null,height:null});c._node&&(c.get("children").each(function(b){d.append(b)}),c.remove())}}).run())}},{NS:"sizeAnimator",ATTRS:{}})},"1.0",{requires:["base","plugin"]});
YUI.add("squarespace-dialog-promises",function(b){var d=b.namespace("Squarespace.Promises");d.submitDialog=function(c,e,d){var g=d||this;return new b.Promise(function(d,f){var l=new b.Squarespace.EditingDialog(c);l.on("send-requested",function(){var b=e.call(g,l.getData());window.action=b;b.then(function(b){l.close();d(b)},function(b){b.errors&&l.showErrors(b.errors)})});l.on(["cancel-click","canccel"],function(){f(null)});l.show()})};d.getDialogData=function(c){return d.create(function(e,d){var g=
new b.Squarespace.EditingDialog(c);g.on("send-requested",function(){var b=g.getData();g.close();e(b)});g.on(["cancel-click","cancel"],function(){d(null)});g.show()},this)}},"1.0",{requires:["promise","squarespace-dialog","squarespace-promises"]});
YUI.add("squarespace-accordion",function(b){function d(b){d.superclass.constructor.apply(this,arguments)}b.namespace("Squarespace");d.NAME="accordion";d.ATTRS={header:{setter:function(b){return""+b},value:"accordion-header"},body:{setter:function(b){return""+b},value:"accordion-body"},container:{setter:function(b){return""+b},value:"accordion-container"},openCloseDuration:{value:0.2}};b.extend(d,b.Widget,{initializer:function(b){this._items=[];this.publish("add",{defaultFn:this._defaultAdd});this.publish("headerClick",
{defaultFn:this._defaultClick});this._rendered=!1},bindUI:function(){var b=this.get("contentBox"),e=this.get("header");b.delegate("click",this._onClick,"."+e,this)},_onClick:function(b){this.fire("headerClick",b)},add:function(c){c=b.Lang.isArray(c)?c:[c];c.forEach(function(c){b.ArrayList.prototype.add.call(this,c)},this);this.fire("add",{nodes:c})},renderUI:function(){var b=this.get("contentBox"),e=this.get("body"),d;this._items.forEach(function(g){b.append(g);(d=g.one("."+e))&&d.hide(!0)},this);
this._rendered=!0},_defaultAdd:function(b){b=b.nodes;var e=this.get("contentBox");this._rendered?this._dynamicAdd(b):b.forEach(function(b){this._initializeNode(b);e.append(b);b.inDoc()&&b.one("."+this.get("body")).hide()},this)},_dynamicAdd:function(c){var e=this.get("contentBox"),d="."+this.get("body"),g=b.DB.DIV("accordion-expandable");g.plug(b.Squarespace.Animations.Expandable);e.append(g);g.hide(!0);c.forEach(function(b){this._initializeNode(b);b.one(d).hide(!0);g.append(b)},this);g.show();g.after("opened",
function(){g.insert(g.all(".accordion-container"),"before");g.remove(!0)})},_initializeNode:function(c){var e=this.get("body");c&&(c.one("."+e).plug(b.Squarespace.Animations.Expandable,{duration:this.get("openCloseDuration")}),c.addClass("accordion-closed"))},_isClosed:function(b){return b.hasClass("accordion-closed")},_close:function(b){var e=b.one("."+this.get("body"));e.hide();e.once("closed",function(){b.removeClass("accordion-open");b.addClass("accordion-closed")})},_open:function(b){var e=b.one("."+
this.get("body"));e.show();e.once("opened",function(){b.addClass("accordion-open");b.removeClass("accordion-closed")})},_toggleOpen:function(b){b.one("."+this.get("body"));b&&(this._isClosed(b)?this._open(b):this._close(b))},_defaultClick:function(b){b=b.details[0].target.ancestor("."+this.get("container"),!0);this._closeAll();this._toggleOpen(b)},_closeAll:function(){this.each(function(b){this._isClosed(b)||this._close(b)},this)}});b.augment(d,b.ArrayList);b.Squarespace.Accordion=d},"1.0",{requires:["widget",
"squarespace-animations","arraylist","arraylist-add"]});
YUI.add("squarespace-dialog-numeric-text",function(b){var d=b.Squarespace.DialogFields.NumericText=b.Base.create("numericText",b.Squarespace.DialogFields.Text,[],{renderUI:function(){d.superclass.renderUI.call(this);this.get("contentBox").one("input").plug(b.Squarespace.Plugin.NumericFormatter,{displayFormatter:this.get("displayFormatter")})},bindUI:function(){var b=this.get("contentBox").one("input");b.on("valuechange",function(){this.set("data",b.numericFormatterPlugin.get("data"))},this)},getErrors:function(){return this.get("validator")(this.get("data"))?
[]:[this.get("strings.validationFailMessage")]}},{CSS_PREFIX:"sqs-numeric-text",LABEL_CONFIG:{forNode:"input[type]"},ATTRS:{strings:{value:{validationFailMessage:"This must be numeric."}},displayFormatter:{validator:b.Lang.isFunction,value:function(b){return b}},validator:{value:b.Lang.isNumber},data:{value:0,validator:b.Lang.isNumber}}})},"1.0",{requires:["base-build","squarespace-dialog-text","squarespace-plugin-numeric-formatter"]});
YUI.add("squarespace-developer-registrar",function(b){var d={style:"flyout",name:"developer-marketing-details",closeOthers:!1,overlay:0.5,width:420,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Developer Account Registration",icon:"/universal/images-v6/dialog/login-icon.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{submitOnEnter:!0,required:!0,name:"businessName","strings.title":"Business Name","strings.placeholder":"Web Design, Inc."}},{ctor:b.Squarespace.DialogFields.Text,
config:{submitOnEnter:!0,required:!0,name:"businessEmailAddress","strings.title":"Business Email Address","strings.placeholder":"support@yourbusiness.com"}},{ctor:b.Squarespace.DialogFields.Text,config:{submitOnEnter:!0,required:!0,name:"phoneNumber","strings.title":"Business Phone Number","strings.placeholder":"(555) 312-7393"}},{ctor:b.Squarespace.DialogFields.Text,config:{submitOnEnter:!0,required:!0,name:"streetAddress","strings.title":"Business Mailing Address","strings.placeholder":"Street Address"}},
{ctor:b.Squarespace.DialogFields.Text,config:{submitOnEnter:!0,required:!0,name:"cityStateZip","strings.placeholder":"City, State, Zip"}},{ctor:b.Squarespace.DialogFields.Select,config:{required:!0,name:"countryCode",data:"US",options:b.Squarespace.Localities.getNewCountryOptions(),"strings.title":"Country",submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Text,config:{submitOnEnter:!0,required:!0,name:"businessWebsiteUrl","strings.title":"Business Website URL","strings.placeholder":"http://www.yourbusiness.com/"}}]}]},
c=b.Base.create("developerRegistrar",b.Base,[],{register:function(c){return this._getMarketingDetailsFromUser(c).then(b.bind(this._saveRegistration,this))},_getMarketingDetailsFromUser:function(c){var d=this._getMarketingDialogConf(c);return b.Squarespace.Promises.getDialogData(d).then(function(b){return{account:c,data:b}})},_getMarketingDialogConf:function(c){var f=c.get("developerAccount");return b.merge(d,{savingText:f?"Saving...":"Registering...",initialData:c.get("developerAccountMarketingDetails")})},
_saveRegistration:function(c){return b.Squarespace.Promises.create(function(d,g){var h=c.account;h.setAttrs({developerAccount:!0,developerAccountMarketingDetails:c.data});h.save(function(c){b.Lang.isValue(c)?g(c):d(h)})},this)}});b.namespace("Squarespace.Singletons").DeveloperRegistrar=new c},"1.0",{requires:"base squarespace-dialog squarespace-promises squarespace-dialog-promises squarespace-dialog-text squarespace-dialog-select".split(" ")});
YUI.add("squarespace-block-content-image",function(b){var d=b.namespace("Squarespace.Content").Image=b.Base.create("image",b.Squarespace.SSWidget,[b.WidgetChild,b.Squarespace.Content.ContentBase],{initializer:function(c){this._bb=this.get("boundingBox");this._cb=this.get("contentBox");this.LOG=new b.Squarespace.Debugger({output:!1,name:"BlockContentImage",uid:!0})},render:function(){var c=this.get("model"),e=b.Lang.isValue(this.get("parent"));if(!c.isEmpty()&&!c.isImageDataLoaded()){if(e){var f=b.bind(function(){this.get("parent").set("stack",
null)},this),g=this.get("parent").get("stack");g&&(f=g.add(f))}this.LOG.log("Loading image data...");c.loadImageData().then(b.bind(function(){this.LOG.log("Loaded image data: ",{baseAssetUrl:c.get("baseAssetUrl"),dimensions:c.get("dimensions")});this.syncUI();e&&f();this.fire("image-loaded")},this))}d.superclass.render.apply(this,arguments)},syncUI:function(){var b=this.get("model");b.isEmpty()||b.get("error")||!b.get("isBase64")&&b.get("processing")?this._syncImageRendering():b.isImageDataLoaded()&&
(this._syncImageRendering(),this._syncAspectRatio(),this._syncStretch(),this._adjustImage())},bindUI:function(){var c=this.get("model");c.after(["imageIdChange","errorChange"],function(){this.syncUI()},this);c.after(["completedChange","processingChange"],function(){this._syncProgress()},this);c.after("aspectRatioChange",function(){this._syncAspectRatio();this._syncImageRendering();this._adjustImage()},this);c.after("stretchChange",function(){this._syncStretch()},this);c.after("focalPointChange",function(){this._syncImageRendering();
this._adjustImage()},this);b.Lang.isValue(c.get("vSize"))&&c.after("vSizeChange",function(){var b=this.get("contentBox").get("offsetHeight"),d=this.get("contentBox").get("offsetWidth");c.set("aspectRatio",100*(b/d))},this)},_showEmptyImageState:function(){var b=this.get("model");this.imgNode&&(this.imgNode.remove(!0),this.imgNode=null);this._bb.addClass("sqs-empty");b.get("error")&&(this.LOG.log("Displaying error",b.get("error")),this.set("editing",!1),this.errorNode||(this._bb.addClass("sqs-error"),
this.errorNode=this._cb.appendChild('<div class="error-wrapper"><div class="message"></div><a href="#" class="clear">Clear</a></div>'),this.errorNode.one("a.clear").on("click",function(e){e.halt();this.errorNode.remove();this.errorNode=null;this.set("editing",!0);b.setAttrs({error:null,imageId:null})},this)),this.errorNode.one(".message").setContent(b.get("error")))},_syncImageRendering:function(){var c=this.get("model");c.isEmpty()||!c.get("isBase64")&&c.get("processing")||c.get("error")?this._showEmptyImageState():
(this.errorNode&&(this.errorNode.remove(),this.errorNode=null,this._bb.removeClass("sqs-error")),this.imgNode||(this.imgNode=b.Node.create("<img>"),this.imgNode.on("load",function(){this._fireContentUpdate()},this),this._cb.append(this.imgNode)),c=c.get("baseAssetUrl"),b.Lang.isValue(this.get("parent"))&&(this.get("parent").get("editController").isMobileApp()&&this.imgNode.getAttribute("src")!==c)&&(this.LOG.log("Attempting to load image",c),this.imgNode.setAttribute("src",c)),this._bb.removeClass("sqs-empty"))},
_syncProgress:function(){var c=this.get("model"),e=c.get("completed"),d=b.Lang.isValue(this.get("parent"));b.Lang.isValue(e)&&1>e?(this.LOG.log("Uploading...",100*e+"%"),this._cb.plug(b.Squarespace.Plugin.Progress,{progress:100*e,showBar:!0,showSpinner:!1}),this._cb.addClass(this.getClassName("processing"))):c.get("processing")&&d&&!this.get("parent").get("editController").isMobileApp()?(this.LOG.log("Showing processing spinner"),this._cb.plug(b.Squarespace.Plugin.Progress,{showBar:!1,showSpinner:!0}),
this._cb.addClass(this.getClassName("processing"))):(this.LOG.log("Removing processing state."),this._cb.unplug(b.Squarespace.Plugin.Progress),this._cb.removeClass(this.getClassName("processing")))},_syncAspectRatio:function(c){var e=this.get("model");c=e.get("aspectRatio");var d=e.get("dimensions"),e=e.get("vSize");b.Lang.isValue(e)?(this.LOG.log("Applying vSize value",e,"(pixel value: "+24*e+")"),this.get("contentBox").setStyle("paddingBottom",24*e)):(c||(this.LOG.log("Aspect ratio not found."),
d?(this.LOG.log("Applying evaluated aspectRatio (from dimensions)",c),c=100*(d.height/d.width)):(this.LOG.log("Evaluating `aspectRatio` to 75% (no dimensions found)"),c=75)),this.LOG.log("Applying aspectRatio",c),c=parseFloat(c)+"%",this.get("contentBox").setStyle("paddingBottom",c))},_syncStretch:function(){var b=this.get("model"),e=b.get("stretch"),b=b.get("dimensions");!e&&b?(this.get("boundingBox").setStyle("maxWidth",b.width),this.get("boundingBox").addClass("stretch")):(this.get("boundingBox").setStyle("maxWidth",
null),this.get("boundingBox").removeClass("stretch"))},_attemptToEvaluateDimensions:function(){var c=this.get("model");if(b.Lang.isValue(c.get("baseAssetUrl"))){this.LOG.log("Dimensions missing, attempting to evaluate dimensions in the browser");var e=new Image;e.addEventListener("load",b.bind(function(){this.LOG.log("Missing dimensions evaluated from browser",{width:e.width,height:e.height});c.set("dimensions",{width:e.width,height:e.height});this.syncUI()},this));e.src=c.get("baseAssetUrl")}},_adjustImage:function(){if(this.imgNode){var c=
this.get("model");if(!c.isEmpty()&&c.isImageDataLoaded()){var e=c.get("dimensions");b.Lang.isValue(e)?(this.get("boundingBox").addClass("sqs-intrinsic"),e=c.get("focalPoint").split(","),e={focalPoint:{x:parseFloat(e[0]),y:parseFloat(e[1])},mode:"fill",fixedRatio:!0,stretch:c.get("stretch")},c.get("isBase64")||(e.source=c.get("baseAssetUrl")),c.get("dimensions")&&(e.dimensions=c.get("dimensions")),this.LOG.log("Sending off to ImageLoader",e),ImageLoader.load(this.imgNode,e)):this._attemptToEvaluateDimensions()}}else this.LOG.warn("_adjustImage called without an imgNode in existence.")},
_fireContentUpdate:function(){this.get("parent")&&this.get("parent").fire("widget:contentUpdate")}},{CSS_PREFIX:"sqs-image",ATTRS:{model:{writeOnce:!0,setter:function(c){if(b.Lang.isObject(c))return new b.Squarespace.ContentModel.Image(c);if(b.instanceOf(c,b.Squarespace.ContentModel.Image))return c},value:{},lazyAdd:!1},tabIndex:{value:null},editor:{value:b.Squarespace.Content.Image.Editor}}});b.namespace("Squarespace.ContentModel").Image=b.Base.create("ImageContentModel",b.Model,[],{initializer:function(){this._imageContentItem=
new b.Squarespace.Models.ContentItem({id:this.get("imageId"),collectionId:this.get("collectionId")});this._bindImageListeners(this._imageContentItem);this.after("imageIdChange",function(c){c.newVal?(this._imageContentItem=new b.Squarespace.Models.ContentItem({id:c.newVal,collectionId:this.get("collectionId")}),this._bindImageListeners(this._imageContentItem)):(this.set("dimensions",null),this.set("processing",null),this.set("error",null),this.set("baseAssetUrl",null),this.set("aspectRatio",null))})},
_bindImageListeners:function(c){c.after("mediaProcessingStateChange",function(c){c.newVal==b.Squarespace.MediaProcessingState.READY&&this.loadImageData()},this)},getImageContentItemField:function(b){return this._imageContentItem.get(b)},setItemData:function(c){this._imageContentItem.setAttrs(c);b.Lang.isString(c.id)&&this.set("imageId",c.id)},isEmpty:function(){return!this.get("imageId")&&!this.get("isBase64")},isImageDataLoaded:function(){var c=this.get("baseAssetUrl");return b.Lang.isValue(c)},
loadImageData:function(){if(!b.Lang.isValue(this._itemPromise)||"pending"!==this._itemPromise.getStatus())this._itemPromise=new b.Promise(b.bind(function(c,e){var d=this._imageContentItem;d.load(b.bind(function(b){b?b.notFound?this.set("error","The requested image could not be found."):this.set("error",b.error):this.applyAttrsFromContentItem(d);c();this._itemPromise=null},this))},this));return this._itemPromise},applyAttrsFromContentItem:function(c){b.Squarespace.ContentItemUtils.isErrorProcessingState(c)?
this.set("error","There was an error while processing the image."):b.Squarespace.ContentItemUtils.isProcessingState(c)?this.set("processing",!0):(this.set("processing",!1),this.set("baseAssetUrl",c.get("assetUrl")),this.set("dimensions",c.get("originalSize")),this.set("focalPoint",c.get("mediaFocalPoint")),this.set("filename",c.get("filename")),c=this.get("dimensions"),!b.Lang.isValue(this.get("aspectRatio"))&&b.Lang.isValue(c)&&this.set("aspectRatio",100*(c.height/c.width),{silent:!0}))},saveFocalPoint:function(){this._imageContentItem.set("mediaFocalPoint",
this.get("focalPoint"));this._imageContentItem.save({fields:["mediaFocalPoint"]})}},{ATTRS:{imageId:{},isBase64:{},baseAssetUrl:{value:null},dimensions:{setter:function(c){if(b.Lang.isString(c))return c=c.split("x"),{width:c[0],height:c[1]};if(b.Lang.isValue(c))return c}},aspectRatio:{setter:function(c){c=parseFloat(c);return b.Lang.isNumber(c)?c:null}},focalPoint:{value:"0.5, 0.5",setter:function(c){return b.Lang.isObject(c)?c.x+","+c.y:!c?"0.5, 0.5":c}},scale:{value:"cover",setter:function(b){return"cover"===
b||"contain"===b?b:"cover"}},filename:{value:null,validator:b.Lang.isString}}})},"1.0",{requires:"model widget-child promise squarespace-models-content-item squarespace-ss-widget squarespace-block-content-base squarespace-block-content-image-editor squarespace-debugger squarespace-content-item-utils".split(" ")});
YUI.add("squarespace-external-authentication",function(b){b.namespace("Squarespace");b.Squarespace.ExternalAuthentication=b.Base.create("externalAuthentication",b.Base,[],{initializer:function(){this.publish("completed")},openPopupWindow:function(d,c,e){d="/auth/ExternalAuthenticationInitiate?"+this._buildQueryParams(d,c,e);this._oauthWindow=window.open(d,"ConnectWithOAuth","location=0,status=0,scrollbars=1,width=1020,height=520");this._checkClosedOnInterval();d=window.addEventListener?"addEventListener":
"attachEvent";(0,window[d])("attachEvent"==d?"onmessage":"message",b.bind(this._receiveMessage,this),!1)},_buildQueryParams:function(d,c,e){var f="serviceProvider="+d;b.Lang.isValue(c)&&b.Lang.isValue(e)&&(f+="&"+c+"="+e);this.get("useLoginFlag")&&(f+="&loginFlag=true");this.get("includeWebsiteList")&&(f+="&includeWebsiteList=true");c=this.get("targetIdentifier");b.Lang.isString(c)&&(f+="&targetIdentifier="+c);c=this.get("authenticationType");b.Lang.isValue(c)&&(f+="&type="+c);(c=this._getInviteCode())&&
(f+="&"+c);d===b.Squarespace.ExternalServiceProviders.FACEBOOK&&(f+="&redirArgs="+encodeURIComponent("scope"+b.Squarespace.FacebookExtendedPermissions));return f+="&uuid="+this.get("uuid")},_getInviteCode:function(){var d=document.location.search;"?"===d[0]&&(d=d.slice(1));return b.Array.find(d.split("&"),function(b){return 0===b.indexOf("invitation=")},this)},_receiveMessage:function(d){d=JSON.parse(d.data);b.Lang.isObject(d)&&(this.set("websites",d.websites),this.set("website",d.website),this.set("memberAccount",
d.memberAccount))},_checkClosedOnInterval:function(){this._oauthWindow.closed||window.callbackFinished?(window.callbackFinished=!1,this.fire("completed")):b.later(200,this,this._checkClosedOnInterval)}},{ATTRS:{useLoginFlag:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},includeWebsiteList:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},targetIdentifier:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},uuid:{value:null,valueFn:function(){var b=(new Date).getTime();
return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var e=(b+16*Math.random())%16|0;b=Math.floor(b/16);return("x"==c?e:e&7|8).toString(16)})},validator:b.Squarespace.AttrValidators.isNullOrString},authenticationType:{value:null},websites:{value:null},website:{value:null},memberAccount:{value:null}}})},"1.0",{requires:["base","squarespace-enum","squarespace-util"]});
YUI.add("squarespace-dialog-order-summary",function(b){var d=b.namespace("Squarespace.DialogFields").OrderSummaryField=b.Base.create("order-summary",b.Squarespace.DialogField2,[],{initializer:function(c){this._order=b.clone(c.order);var e=!1;b.Lang.isObject(this._order)&&b.Lang.isObject(this._order.purchasedCart)&&b.Array.each(this._order.purchasedCart.coupons,function(c){b.Lang.isNumber(c.computedDiscount)&&(e=!0);c.summary=b.Squarespace.CommerceCouponFormatters.getCouponSummary(c)},this);e||(this._order.purchasedCart.coupons=
!1)},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("boundingBox"),e=this._order,f=e.currency,g=b.Squarespace.CurrencySymbol[f];b.Data.get({url:"/api/config/GetFragment",data:{name:"order-summary"},success:b.bind(function(d){c.setContent(b.JSONTemplate.evaluateJsonTemplate(d.html,{order:e,customer:e.customer,nativeCurrencySymbol:g,nativeCurrencyCode:f,showCurrencyCode:"USD"!==f&&"$"===g}))},this)})}},{TEMPLATE:'<div class="orderSummary"><div class="clearfix"><div class="billing"><span class="title"></span></div><div class="shipping"><span class="title"></span></div></div><div class="items"><span class="title"></span><div class="box"></div></div></div>',
CSS_PREFIX:"sqs-order-summary",ATTRS:{strings:{value:{billingTitle:"Billing",shippingTitle:"Shipping"}}}})},"1.0",{requires:["base","base-build","squarespace-dialog-field-2","squarespace-commerce-coupon-formatters","squarespace-commerce-utils"]});
window.FB||(window.FB={_apiKey:null,_session:null,_userStatus:"unknown",_logging:!0,_inCanvas:-1<window.location.search.indexOf("fb_sig_in_iframe=1")||-1<window.location.search.indexOf("session=")||-1<window.location.search.indexOf("signed_request=")||-1<window.name.indexOf("iframe_canvas")||-1<window.name.indexOf("app_runner"),_https:-1<window.name.indexOf("_fb_https"),_domain:{api:"https://api.facebook.com/",api_read:"https://api-read.facebook.com/",cdn:"http://static.ak.fbcdn.net/",https_cdn:"https://s-static.ak.fbcdn.net/",
graph:"https://graph.facebook.com/",staticfb:"http://static.ak.facebook.com/",https_staticfb:"https://s-static.ak.facebook.com/",www:"http://www.facebook.com/",https_www:"https://www.facebook.com/",m:"http://m.facebook.com/",https_m:"https://m.facebook.com/"},_locale:null,_localeIsRtl:!1,getDomain:function(b,d){var c=!d&&("https:"==window.location.protocol||FB._https);switch(b){case "api":return FB._domain.api;case "api_read":return FB._domain.api_read;case "cdn":return c?FB._domain.https_cdn:FB._domain.cdn;
case "cdn_foreign":return FB._domain.cdn_foreign;case "https_cdn":return FB._domain.https_cdn;case "graph":return FB._domain.graph;case "staticfb":return c?FB._domain.https_staticfb:FB._domain.staticfb;case "https_staticfb":return FB._domain.https_staticfb;case "www":return c?FB._domain.https_www:FB._domain.www;case "https_www":return FB._domain.https_www;case "m":return c?FB._domain.https_m:FB._domain.m;case "https_m":return FB._domain.https_m}},copy:function(b,d,c,e){for(var f in d)if(c||"undefined"===
typeof b[f])b[f]=e?e(d[f]):d[f];return b},create:function(b,d){for(var c=window.FB,e=b?b.split("."):[],f=e.length,g=0;g<f;g++){var h=e[g],k=c[h];k||(k=d&&g+1==f?d:{},c[h]=k);c=k}return c},provide:function(b,d,c){return FB.copy("string"==typeof b?FB.create(b):b,d,c)},guid:function(){return"f"+(1073741824*Math.random()).toString(16).replace(".","")},log:function(b){FB._logging&&(window.Debug&&window.Debug.writeln?window.Debug.writeln(b):window.console&&window.console.log(b));FB.Event&&FB.Event.fire("fb.log",
b)},$:function(b){return document.getElementById(b)}});
FB.provide("Array",{indexOf:function(b,d){if(b.indexOf)return b.indexOf(d);var c=b.length;if(c)for(var e=0;e<c;e++)if(b[e]===d)return e;return-1},merge:function(b,d){for(var c=0;c<d.length;c++)0>FB.Array.indexOf(b,d[c])&&b.push(d[c]);return b},filter:function(b,d){for(var c=[],e=0;e<b.length;e++)d(b[e])&&c.push(b[e]);return c},keys:function(b,d){var c=[],e;for(e in b)(d||b.hasOwnProperty(e))&&c.push(e);return c},map:function(b,d){for(var c=[],e=0;e<b.length;e++)c.push(d(b[e]));return c},forEach:function(b,
d,c){if(b)if("[object Array]"===Object.prototype.toString.apply(b)||!(b instanceof Function)&&"number"==typeof b.length)if(b.forEach)b.forEach(d);else{c=0;for(var e=b.length;c<e;c++)d(b[c],c,b)}else for(e in b)(c||b.hasOwnProperty(e))&&d(b[e],e,b)},toArray:function(b){for(var d=0,c=[],e=b.length;d<e;d++)c[d]=b[d];return c}});
FB.provide("QS",{encode:function(b,d,c){d=void 0===d?"&":d;c=!1===c?function(b){return b}:encodeURIComponent;var e=[];FB.Array.forEach(b,function(b,d){null!==b&&"undefined"!=typeof b&&e.push(c(d)+"="+c(b))});e.sort();return e.join(d)},decode:function(b){var d=decodeURIComponent,c={};b=b.split("&");var e,f;for(e=0;e<b.length;e++)(f=b[e].split("=",2))&&f[0]&&(c[d(f[0])]=d(f[1]||""));return c}});
FB.provide("Content",{_root:null,_hiddenRoot:null,_callbacks:{},append:function(b,d){if(!d)if(FB.Content._root)d=FB.Content._root;else if(FB.Content._root=d=FB.$("fb-root"))d.className+=" fb_reset";else{FB.log('The "fb-root" div has not been created.');return}if("string"==typeof b){var c=document.createElement("div");d.appendChild(c).innerHTML=b;return c}return d.appendChild(b)},appendHidden:function(b){if(!FB.Content._hiddenRoot){var d=document.createElement("div"),c=d.style;c.position="absolute";
c.top="-10000px";c.width=c.height=0;FB.Content._hiddenRoot=FB.Content.append(d)}return FB.Content.append(b,FB.Content._hiddenRoot)},insertIframe:function(b){b.id=b.id||FB.guid();b.name=b.name||FB.guid();var d=FB.guid(),c=!1,e=!1;FB.Content._callbacks[d]=function(){c&&!e&&(e=!0,b.onload&&b.onload(b.root.firstChild))};if(document.attachEvent){var f='<iframe id="'+b.id+'" name="'+b.name+'"'+(b.title?' title="'+b.title+'"':"")+(b.className?' class="'+b.className+'"':"")+' style="border:none;'+(b.width?
"width:"+b.width+"px;":"")+(b.height?"height:"+b.height+"px;":"")+'" src="javascript:false;" frameborder="0" scrolling="no" allowtransparency="true" onload="FB.Content._callbacks.'+d+'()"></iframe>';b.root.innerHTML='<iframe src="javascript:false" frameborder="0" scrolling="no" style="height:1px"></iframe>';c=!0;window.setTimeout(function(){b.root.innerHTML=f;b.root.firstChild.src=b.url;b.onInsert&&b.onInsert(b.root.firstChild)},0)}else{var g=document.createElement("iframe");g.id=b.id;g.name=b.name;
g.onload=FB.Content._callbacks[d];g.scrolling="no";g.style.border="none";g.style.overflow="hidden";b.title&&(g.title=b.title);b.className&&(g.className=b.className);b.height&&(g.style.height=b.height+"px");b.width&&(g.style.width="100%"==b.width?b.width:b.width+"px");b.root.appendChild(g);c=!0;g.src=b.url;b.onInsert&&b.onInsert(g)}},submitToTarget:function(b,d){var c=document.createElement("form");c.action=b.url;c.target=b.target;c.method=d?"GET":"POST";FB.Content.appendHidden(c);FB.Array.forEach(b.params,
function(b,d){if(null!==b&&void 0!==b){var g=document.createElement("input");g.name=d;g.value=b;c.appendChild(g)}});c.submit();c.parentNode.removeChild(c)}});
FB.provide("Flash",{_minVersions:[[9,0,159,0],[10,0,22,87]],_swfPath:"swf/XdComm.swf",_callbacks:[],_names:{},_unloadRegistered:!1,init:function(){FB.Flash._init||(FB.Flash._init=!0,window.FB_OnFlashXdCommReady=function(){FB.Flash._ready=!0;for(var b=0,d=FB.Flash._callbacks.length;b<d;b++)FB.Flash._callbacks[b]();FB.Flash._callbacks=[]},FB.Flash.embedSWF("XdComm",FB.getDomain("cdn_foreign")+FB.Flash._swfPath))},embedSWF:function(b,d,c){var e=!!document.attachEvent;FB.Content.appendHidden('<object type="application/x-shockwave-flash" id="'+
b+'" '+(c?'flashvars="'+c+'" ':"")+(e?'name="'+b+'" ':"")+(e?"":'data="'+d+'" ')+(e?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ':"")+'allowscriptaccess="always"><param name="movie" value="'+d+'"></param><param name="allowscriptaccess" value="always"></param></object>');9<=FB.UA.ie()&&(FB.Flash._unloadRegistered||(window.attachEvent("onunload",function(){FB.Array.forEach(FB.Flash._names,function(b,c){var e=document.getElementById(c);e&&e.removeNode(!0)})}),FB.Flash._unloadRegistered=!0),
FB.Flash._names[b]=!0)},hasMinVersion:function(){if("undefined"===typeof FB.Flash._hasMinVersion){var b,d,c=[];try{b=(new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).GetVariable("$version")}catch(e){0<navigator.mimeTypes.length&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin&&(b=(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]).description)}if(b){var f=b.replace(/\D+/g,",").match(/^,?(.+),?$/)[1].split(",");b=0;for(d=f.length;b<d;b++)c.push(parseInt(f[b],
10))}FB.Flash._hasMinVersion=!1;b=0;d=FB.Flash._minVersions.length;a:for(;b<d;b++)if(f=FB.Flash._minVersions[b],f[0]==c[0])for(var g=1,h=f.length,k=c.length;g<h&&g<k;g++)if(c[g]<f[g]){FB.Flash._hasMinVersion=!1;continue a}else if(FB.Flash._hasMinVersion=!0,c[g]>f[g])break a}return FB.Flash._hasMinVersion},onReady:function(b){FB.Flash.init();FB.Flash._ready?window.setTimeout(b,0):FB.Flash._callbacks.push(b)}});this.JSON||(this.JSON={});
(function(){function b(b){return 10>b?"0"+b:b}function d(b){f.lastIndex=0;return f.test(b)?'"'+b.replace(f,function(b){var c=k[b];return"string"===typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function c(b,e){var f,k,t,u,v=g,w,y=e[b];y&&("object"===typeof y&&"function"===typeof y.toJSON)&&(y=y.toJSON(b));"function"===typeof l&&(y=l.call(e,b,y));switch(typeof y){case "string":return d(y);case "number":return isFinite(y)?String(y):"null";case "boolean":case "null":return String(y);
case "object":if(!y)return"null";g+=h;w=[];if("[object Array]"===Object.prototype.toString.apply(y)){u=y.length;for(f=0;f<u;f+=1)w[f]=c(f,y)||"null";t=0===w.length?"[]":g?"[\n"+g+w.join(",\n"+g)+"\n"+v+"]":"["+w.join(",")+"]";g=v;return t}if(l&&"object"===typeof l){u=l.length;for(f=0;f<u;f+=1)k=l[f],"string"===typeof k&&(t=c(k,y))&&w.push(d(k)+(g?": ":":")+t)}else for(k in y)Object.hasOwnProperty.call(y,k)&&(t=c(k,y))&&w.push(d(k)+(g?": ":":")+t);t=0===w.length?"{}":g?"{\n"+g+w.join(",\n"+g)+"\n"+
v+"}":"{"+w.join(",")+"}";g=v;return t}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(c){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(b){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,k={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(b,e,d){var f;h=g="";if("number"===typeof d)for(f=0;f<d;f+=1)h+=" ";else"string"===typeof d&&(h=d);if((l=e)&&"function"!==typeof e&&("object"!==typeof e||"number"!==typeof e.length))throw Error("JSON.stringify");return c("",{"":b})});
"function"!==typeof JSON.parse&&(JSON.parse=function(b,c){function d(b,e){var f,g,h=b[e];if(h&&"object"===typeof h)for(f in h)Object.hasOwnProperty.call(h,f)&&(g=d(h,f),void 0!==g?h[f]=g:delete h[f]);return c.call(b,e,h)}var f;e.lastIndex=0;e.test(b)&&(b=b.replace(e,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,
"")))return f=eval("("+b+")"),"function"===typeof c?d({"":f},""):f;throw new SyntaxError("JSON.parse");})})();FB.provide("JSON",{stringify:function(b){return window.Prototype&&Object.toJSON?Object.toJSON(b):JSON.stringify(b)},parse:function(b){return JSON.parse(b)},flatten:function(b){var d={},c;for(c in b)if(b.hasOwnProperty(c)){var e=b[c];null===e||void 0===e||(d[c]="string"==typeof e?e:FB.JSON.stringify(e))}return d}});
FB.provide("",{api:function(){"string"===typeof arguments[0]?FB.ApiServer.graph.apply(FB.ApiServer,arguments):FB.ApiServer.rest.apply(FB.ApiServer,arguments)}});
FB.provide("ApiServer",{METHODS:["get","post","delete","put"],_callbacks:{},_readOnlyCalls:{fql_query:!0,fql_multiquery:!0,friends_get:!0,notifications_get:!0,stream_get:!0,users_getinfo:!0},graph:function(){for(var b=Array.prototype.slice.call(arguments),d=b.shift(),c=b.shift(),e,f,g;c;){var h=typeof c;if("string"===h&&!e)e=c.toLowerCase();else if("function"===h&&!g)g=c;else if("object"===h&&!f)f=c;else{FB.log("Invalid argument passed to FB.api(): "+c);return}c=b.shift()}e=e||"get";f=f||{};"/"===
d[0]&&(d=d.substr(1));0>FB.Array.indexOf(FB.ApiServer.METHODS,e)?FB.log("Invalid method passed to FB.api(): "+e):FB.ApiServer.oauthRequest("graph",d,e,f,g)},rest:function(b,d){var c=b.method.toLowerCase().replace(".","_");if(FB.Auth&&"auth_revokeauthorization"===c){var e=d;d=function(b){!0===b&&(FB._oauth?FB.Auth.setAuthResponse(null,"not_authorized"):FB.Auth.setSession(null,"notConnected"));e&&e(b)}}b.format="json-strings";b.api_key=FB._apiKey;FB.ApiServer.oauthRequest(FB.ApiServer._readOnlyCalls[c]?
"api_read":"api","restserver.php","get",b,d)},oauthRequest:function(b,d,c,e,f){!e.access_token&&FB.getAccessToken()&&(e.access_token=FB.getAccessToken());e.sdk="joey";e.pretty=0;var g=f;f=function(b){FB.Auth&&(b&&FB._session&&FB._session.access_token==e.access_token&&("190"===b.error_code||b.error&&("invalid_token"===b.error||"OAuthException"===b.error.type)))&&FB.getLoginStatus(null,!0);g&&g(b)};try{FB.ApiServer.jsonp(b,d,c,FB.JSON.flatten(e),f)}catch(h){try{if(!FB.initSitevars.corsKillSwitch&&FB.ApiServer.corsPost(b,
d,c,FB.JSON.flatten(e),f))return}catch(k){}if(FB.Flash.hasMinVersion())FB.ApiServer.flash(b,d,c,FB.JSON.flatten(e),f);else throw Error("Your browser does not support long connect requests. You can fix this problem by upgrading your browser or installing the latest version of Flash");}},corsPost:function(b,d,c,e,f){d=FB.getDomain(b)+d;"graph"==b&&(e.method=c);b=FB.QS.encode(e);var g=FB.ApiServer._createCORSRequest("POST",d,"application/x-www-form-urlencoded");return g?(g.onload=function(){f&&f(FB.JSON.parse(g.responseText))},
g.send(b),!0):!1},_createCORSRequest:function(b,d,c){if(!window.XMLHttpRequest)return null;var e=new XMLHttpRequest;"withCredentials"in e?(e.open(b,d,!0),e.setRequestHeader("Content-type",c)):window.XDomainRequest?(e=new XDomainRequest,e.open(b,d)):e=null;return e},jsonp:function(b,d,c,e,f){var g=FB.guid(),h=document.createElement("script");"graph"===b&&"get"!==c&&(e.method=c);e.callback="FB.ApiServer._callbacks."+g;b=FB.getDomain(b)+d+(-1<d.indexOf("?")?"&":"?")+FB.QS.encode(e);if(2E3<b.length)throw Error("JSONP only support a maximum of 2000 bytes of input.");
FB.ApiServer._callbacks[g]=function(b){f&&f(b);delete FB.ApiServer._callbacks[g];h.parentNode.removeChild(h)};h.src=b;document.getElementsByTagName("head")[0].appendChild(h)},flash:function(b,d,c,e,f){window.FB_OnXdHttpResult||(window.FB_OnXdHttpResult=function(b,c){FB.ApiServer._callbacks[b](decodeURIComponent(c))});FB.Flash.onReady(function(){"graph"===b&&(e.suppress_http_code=1);var g=FB.getDomain(b)+d,h=FB.QS.encode(e);"get"===c?2E3<g.length+h.length?("graph"===b&&(e.method="get"),c="post",h=
FB.QS.encode(e)):(g+=(-1<g.indexOf("?")?"&":"?")+h,h=""):"post"!==c&&("graph"===b&&(e.method=c),c="post",h=FB.QS.encode(e));var k=document.XdComm.sendXdHttpRequest(c.toUpperCase(),g,h,null);FB.ApiServer._callbacks[k]=function(b){f&&f(FB.JSON.parse(b));delete FB.ApiServer._callbacks[k]}})}});
FB.provide("EventProvider",{subscribers:function(){this._subscribersMap||(this._subscribersMap={});return this._subscribersMap},subscribe:function(b,d){var c=this.subscribers();c[b]?c[b].push(d):c[b]=[d]},unsubscribe:function(b,d){var c=this.subscribers()[b];FB.Array.forEach(c,function(b,f){b==d&&(c[f]=null)})},monitor:function(b,d){if(!d()){var c=this,e=function(){d.apply(d,arguments)&&c.unsubscribe(b,e)};this.subscribe(b,e)}},clear:function(b){delete this.subscribers()[b]},fire:function(){var b=
Array.prototype.slice.call(arguments),d=b.shift();FB.Array.forEach(this.subscribers()[d],function(c){c&&c.apply(this,b)})},listen:function(b,d,c){b.addEventListener?b.addEventListener(d,c,!1):b.attachEvent&&b.attachEvent("on"+d,c)},unlisten:function(b,d,c){b.removeEventListener?b.removeEventListener(d,c,!1):b.detachEvent&&b.detachEvent("on"+d,c)}});FB.provide("Event",FB.EventProvider);
FB.provide("XD",{_origin:null,_transport:null,_callbacks:{},_forever:{},_xdProxyUrl:"connect/xd_proxy.php",_openerTransport:null,_openerOrigin:null,_nonOpenerOrigin:null,init:function(b){if(!FB.XD._origin){var d=window.location.protocol+"//"+window.location.host+"/"+FB.guid();window.addEventListener&&!window.attachEvent&&window.postMessage?(FB.XD._origin=d,FB.XD.PostMessage.init(),FB.XD._transport="postmessage"):!b&&FB.Flash.hasMinVersion()?document.getElementById("fb-root")?(b=document.domain,"facebook.com"==
b&&(b=window.location.host),FB.XD._origin=window.location.protocol+"//"+b+"/"+FB.guid(),FB.XD.Flash.init(),FB.XD._transport="flash"):(FB.log&&FB.log("missing fb-root, defaulting to fragment-based xdcomm"),FB.XD._transport="fragment",FB.XD.Fragment._channelUrl=b||window.location.toString()):(FB.XD._transport="fragment",FB.XD.Fragment._channelUrl=b||window.location.toString());b=!!window.attachEvent;"postmessage"!=FB.XD._transport&&(b&&window.postMessage)&&(FB.XD._openerTransport=FB.XD._transport,FB.XD._openerOrigin=
FB.XD._origin,FB.XD._nonOpenerOrigin=d)}},resolveRelation:function(b){for(var d,c,e=b.split("."),f=window,g=0,h=e.length;g<h;g++)if(d=e[g],"opener"===d||"parent"===d||"top"===d)f=f[d];else if(c=/^frames\[['"]?([a-zA-Z0-9-_]+)['"]?\]$/.exec(d))f=f.frames[c[1]];else throw new SyntaxError("Malformed id to resolve: "+b+", pt: "+d);return f},handler:function(b,d,c,e,f){if(0<window.location.toString().indexOf(FB.XD.Fragment._magic))return"javascript:false;//";FB.initSitevars.forceSecureXdProxy&&(f=!0);
f=FB.getDomain((f?"https_":"")+"cdn")+FB.XD._xdProxyUrl+"#";e=e||FB.guid();d=d||"opener";FB.XD._openerTransport&&("opener"==d?(FB.XD._transport=FB.XD._openerTransport,FB.XD._origin=FB.XD._openerOrigin):(FB.XD.PostMessage.init(),FB.XD._transport="postmessage",FB.XD._origin=FB.XD._nonOpenerOrigin));if("fragment"==FB.XD._transport){f=FB.XD.Fragment._channelUrl;var g=f.indexOf("#");0<g&&(f=f.substr(0,g));f+=(0>f.indexOf("?")?"?":"&")+FB.XD.Fragment._magic+"#?=&"}c&&(FB.XD._forever[e]=!0);FB.XD._callbacks[e]=
b;return f+FB.QS.encode({cb:e,origin:FB.XD._origin,relation:d,transport:FB.XD._transport})},recv:function(b){if("string"==typeof b)try{b=FB.JSON.parse(b)}catch(d){b=FB.QS.decode(b)}var c=FB.XD._callbacks[b.cb];FB.XD._forever[b.cb]||delete FB.XD._callbacks[b.cb];c&&c(b)},PostMessage:{_isInitialized:!1,init:function(){if(!FB.XD.PostMessage._isInitialized){var b=FB.XD.PostMessage.onMessage;window.addEventListener?window.addEventListener("message",b,!1):window.attachEvent("onmessage",b);FB.XD.PostMessage._isInitialized=
!0}},onMessage:function(b){FB.XD.recv(b.data)}},WebView:{onMessage:function(b,d,c){FB.XD.recv(c)}},Flash:{init:function(){FB.Flash.onReady(function(){document.XdComm.postMessage_init("FB.XD.Flash.onMessage",FB.XD._openerOrigin?FB.XD._openerOrigin:FB.XD._origin)})},onMessage:function(b){FB.XD.recv(decodeURIComponent(b))}},Fragment:{_magic:"fb_xd_fragment",checkAndDispatch:function(){var b=window.location.toString(),d=b.substr(b.indexOf("#")+1);0<b.indexOf(FB.XD.Fragment._magic)&&(FB.init=FB.getLoginStatus=
FB.api=function(){},document.documentElement.style.display="none",FB.XD.resolveRelation(FB.QS.decode(d).relation).FB.XD.recv(d))}}});FB.XD.Fragment.checkAndDispatch();
FB.provide("UA",{ie:function(){return FB.UA._populate()||this._ie},firefox:function(){return FB.UA._populate()||this._firefox},opera:function(){return FB.UA._populate()||this._opera},safari:function(){return FB.UA._populate()||this._safari},chrome:function(){return FB.UA._populate()||this._chrome},windows:function(){return FB.UA._populate()||this._windows},osx:function(){return FB.UA._populate()||this._osx},linux:function(){return FB.UA._populate()||this._linux},ios:function(){FB.UA._populate();return FB.UA.mobile()&&
this._ios},mobile:function(){FB.UA._populate();return!FB._inCanvas&&this._mobile},nativeApp:function(){return FB.UA.mobile()&&navigator.userAgent.match(/FBAN\/\w+;/i)},android:function(){FB.UA._populate();return FB.UA.mobile()&&this._android},iPad:function(){FB.UA._populate();return FB.UA.mobile()&&this._iPad},_populated:!1,_populate:function(){if(!FB.UA._populated){FB.UA._populated=!0;var b=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))/.exec(navigator.userAgent),
d=/(Mac OS X)|(Windows)|(Linux)/.exec(navigator.userAgent),c=/\b(iPhone|iP[ao]d)/.exec(navigator.userAgent);FB.UA._iPad=/\b(iPad)/.exec(navigator.userAgent);FB.UA._android=navigator.userAgent.match(/Android/i);FB.UA._mobile=c||FB.UA._android||navigator.userAgent.match(/Mobile/i);b?(FB.UA._ie=b[1]?parseFloat(b[1]):NaN,8<=FB.UA._ie&&!window.HTMLCollection&&(FB.UA._ie=7),FB.UA._firefox=b[2]?parseFloat(b[2]):NaN,FB.UA._opera=b[3]?parseFloat(b[3]):NaN,FB.UA._safari=b[4]?parseFloat(b[4]):NaN,FB.UA._safari?
(b=/(?:Chrome\/(\d+\.\d+))/.exec(navigator.userAgent),FB.UA._chrome=b&&b[1]?parseFloat(b[1]):NaN):FB.UA._chrome=NaN):FB.UA._ie=FB.UA._firefox=FB.UA._opera=FB.UA._chrome=FB.UA._safari=NaN;d?(FB.UA._osx=!!d[1],FB.UA._windows=!!d[2],FB.UA._linux=!!d[3]):FB.UA._osx=FB.UA._windows=FB.UA._linux=!1;FB.UA._ios=c}}});
FB.provide("Arbiter",{_canvasProxyUrl:"connect/canvas_proxy.php",BEHAVIOR_EVENT:"e",BEHAVIOR_PERSISTENT:"p",BEHAVIOR_STATE:"s",inform:function(b,d,c,e,f){if(FB.Canvas.isTabIframe()||FB._inPlugin&&window.postMessage||!FB._inCanvas&&FB.UA.mobile()&&window.postMessage){var g=FB.JSON.stringify({method:b,params:d,behavior:f||FB.Arbiter.BEHAVIOR_PERSISTENT});if(window.postMessage){FB.XD.resolveRelation(c||"parent").postMessage(g,"*");return}try{window.opener.postMessage(g);return}catch(h){}}e|=window!=
window.parent&&0===document.referrer.indexOf("https:");b=FB.getDomain((e?"https_":"")+"staticfb",!0)+FB.Arbiter._canvasProxyUrl+"#"+FB.QS.encode({method:b,params:FB.JSON.stringify(d||{}),behavior:f||FB.Arbiter.BEHAVIOR_PERSISTENT,relation:c});var k=FB.Content.appendHidden("");FB.Content.insertIframe({url:b,root:k,width:1,height:1,onload:function(){setTimeout(function(){k.parentNode.removeChild(k)},10)}})}});
FB.provide("Canvas",{_timer:null,_lastSize:{},_pageInfo:{clientWidth:0,clientHeight:0,scrollLeft:0,scrollTop:0,offsetLeft:0,offsetTop:0},getPageInfo:function(b){var d={channelUrl:FB.XD.handler(function(c){for(var e in FB.Canvas._pageInfo)c[e]&&(FB.Canvas._pageInfo[e]=c[e]|0);b&&b(FB.Canvas._pageInfo)},"top.frames["+window.name+"]",!0),frame:window.name};FB.Arbiter.inform("getPageInfo",d,"top")},hideFlashElement:function(b){b.style.visibility="hidden"},showFlashElement:function(b){b.style.visibility=
""},_flashClassID:"CLSID:D27CDB6E-AE6D-11CF-96B8-444553540000",_hideFlashCallback:function(b){for(var d=window.document.getElementsByTagName("object"),c=0;c<d.length;c++){var e=d[c];if(!("application/x-shockwave-flash"!=e.type.toLowerCase()&&e.classid.toUpperCase()!=FB.Canvas._flashClassID)){for(var f=!1,g=0;g<e.childNodes.length;g++)if("param"==e.childNodes[g].nodeName.toLowerCase()&&"wmode"==e.childNodes[g].name.toLowerCase()&&("opaque"==e.childNodes[g].value.toLowerCase()||"transparent"==e.childNodes[g].value.toLowerCase()))f=
!0;f||(0.001>=Math.random()&&FB.api(FB._apiKey+"/occludespopups","post",{}),FB.Canvas._devHideFlashCallback?(e={state:b.state,elem:e},f=FB.bind(function(b){"opened"==b.state?FB.Canvas.hideFlashElement(b.elem):FB.Canvas.showFlashElement(b.elem)},this,e),setTimeout(f,200),FB.Canvas._devHideFlashCallback(e)):"opened"==b.state?(e._old_visibility=e.style.visibility,e.style.visibility="hidden"):"closed"==b.state&&(e.style.visibility=e._old_visibility,delete e._old_visibility))}}},_devHideFlashCallback:null,
_setHideFlashCallback:function(b){FB.Canvas._devHideFlashCallback=b},init:function(){var b=FB.Dom.getViewportInfo();FB.Canvas._pageInfo.clientWidth=b.width;FB.Canvas._pageInfo.clientHeight=b.height;FB.Canvas.getPageInfo();b=FB.XD.handler(FB.Canvas._hideFlashCallback,"top.frames["+window.name+"]",!0);FB.Arbiter.inform("iframeSetupFlashHiding",{channelUrl:b})},setSize:function(b){"object"!=typeof b&&(b={});var d=0,c=0;b=b||{};if(null==b.width||null==b.height)b=FB.copy(b,FB.Canvas._computeContentSize()),
d=16,c=4;b=FB.copy(b,{frame:window.name||"iframe_canvas"});if(FB.Canvas._lastSize[b.frame]){var e=b.height-FB.Canvas._lastSize[b.frame].height;if(FB.Canvas._lastSize[b.frame].width==b.width&&e<=c&&e>=-d)return!1}FB.Canvas._lastSize[b.frame]=b;FB.Arbiter.inform("setSize",b);return!0},scrollTo:function(b,d){FB.Arbiter.inform("scrollTo",{frame:window.name||"iframe_canvas",x:b,y:d})},setAutoGrow:function(b,d){void 0===d&&"number"==typeof b&&(d=b,b=!0);void 0===b||b?(null===FB.Canvas._timer&&(FB.Canvas._timer=
window.setInterval(FB.Canvas.setSize,d||100)),FB.Canvas.setSize()):null!==FB.Canvas._timer&&(window.clearInterval(FB.Canvas._timer),FB.Canvas._timer=null)},setAutoResize:function(b,d){return FB.Canvas.setAutoGrow(b,d)},isTabIframe:function(){return 0===window.name.indexOf("app_runner_")},setDoneLoading:function(b){FB.Canvas._passAppTtiMessage(b,"RecordIframeAppTti")},stopTimer:function(b){FB.Canvas._passAppTtiMessage(b,"StopIframeAppTtiTimer")},setUrlHandler:function(b){var d=FB.XD.handler(b,"top.frames["+
window.name+"]",!0);FB.Arbiter.inform("setUrlHandler",d);FB.Event.listen(window,"load",function(){FB.Arbiter.inform("setUrlHandler",d)})},startTimer:function(){FB.Canvas._passAppTtiMessage(null,"StartIframeAppTtiTimer")},_passAppTtiMessage:function(b,d){var c=null;b&&(c=FB.XD.handler(b,"top.frames["+window.name+"]",!1));FB.Arbiter.inform(d,{frame:window.name||"iframe_canvas",time:(new Date).getTime(),appId:parseInt(FB._apiKey,10),channelUrl:c})},_computeContentSize:function(){var b=document.body,
d=document.documentElement,c=0,e=Math.max(b.offsetTop,0),f=Math.max(d.offsetTop,0);bottom=Math.max(b.scrollHeight+e,b.offsetHeight+e,d.scrollHeight+f,d.offsetHeight+f);b.offsetWidth<b.scrollWidth?c=b.scrollWidth+b.offsetLeft:FB.Array.forEach(b.childNodes,function(b){b=b.offsetWidth+b.offsetLeft;b>c&&(c=b)});0<d.clientLeft&&(c+=2*d.clientLeft);0<d.clientTop&&(bottom+=2*d.clientTop);return{height:bottom,width:c}}});
FB.provide("String",{trim:function(b){return b.replace(/^\s*|\s*$/g,"")},format:function(b){FB.String.format._formatRE||(FB.String.format._formatRE=/(\{[^\}^\{]+\})/g);var d=arguments;return b.replace(FB.String.format._formatRE,function(b,e){var f=parseInt(e.substr(1),10),f=d[f+1];return null===f||void 0===f?"":f.toString()})},escapeHTML:function(b){var d=document.createElement("div");d.appendChild(document.createTextNode(b));return d.innerHTML.replace(/"/g,"&quot;").replace(/'/g,"&#39;")},quote:function(b){var d=
/["\\\x00-\x1f\x7f-\x9f]/g,c={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return d.test(b)?'"'+b.replace(d,function(b){var d=c[b];if(d)return d;d=b.charCodeAt();return"\\u00"+Math.floor(d/16).toString(16)+(d%16).toString(16)})+'"':'"'+b+'"'}});
FB.provide("Dom",{containsCss:function(b,d){return 0<=(" "+b.className+" ").indexOf(" "+d+" ")},addCss:function(b,d){FB.Dom.containsCss(b,d)||(b.className=b.className+" "+d)},removeCss:function(b,d){FB.Dom.containsCss(b,d)&&(b.className=b.className.replace(d,""),FB.Dom.removeCss(b,d))},getByClass:function(b,d,c){d=d||document.body;c=c||"*";if(d.querySelectorAll)return FB.Array.toArray(d.querySelectorAll(c+"."+b));d=d.getElementsByTagName(c);c=[];for(var e=0,f=d.length;e<f;e++)this.containsCss(d[e],
b)&&(c[c.length]=d[e]);return c},getStyle:function(b,d){var c=!1;if(b.currentStyle)FB.Array.forEach(d.match(/\-([a-z])/g),function(b){d=d.replace(b,b.substr(1,1).toUpperCase())}),c=b.currentStyle[d];else if(FB.Array.forEach(d.match(/[A-Z]/g),function(b){d=d.replace(b,"-"+b.toLowerCase())}),window.getComputedStyle&&(c=document.defaultView.getComputedStyle(b,null).getPropertyValue(d),"background-position-y"==d||"background-position-x"==d))if("top"==c||"left"==c)c="0px";return"opacity"==d?b.filters&&
b.filters.alpha?c:100*c:c},setStyle:function(b,d,c){var e=b.style;"opacity"==d?(100<=c&&(c=99.999),0>c&&(c=0),e.opacity=c/100,e.MozOpacity=c/100,e.KhtmlOpacity=c/100,b.filters&&(void 0==b.filters.alpha?b.filter="alpha(opacity="+c+")":b.filters.alpha.opacity=c)):e[d]=c},addScript:function(b){var d=document.createElement("script");d.type="text/javascript";d.src=b;return document.getElementsByTagName("head")[0].appendChild(d)},addCssRules:function(b,d){FB.Dom._cssRules||(FB.Dom._cssRules={});var c=!0;
FB.Array.forEach(d,function(b){b in FB.Dom._cssRules||(c=!1,FB.Dom._cssRules[b]=!0)});if(!c)if(FB.UA.ie())try{document.createStyleSheet().cssText=b}catch(e){document.styleSheets[0]&&(document.styleSheets[0].cssText+=b)}else{var f=document.createElement("style");f.type="text/css";f.textContent=b;document.getElementsByTagName("head")[0].appendChild(f)}},getViewportInfo:function(){var b=document.documentElement&&"CSS1Compat"==document.compatMode?document.documentElement:document.body;return{scrollTop:b.scrollTop,
scrollLeft:b.scrollLeft,width:self.innerWidth?self.innerWidth:b.clientWidth,height:self.innerHeight?self.innerHeight:b.clientHeight}},ready:function(b){FB.Dom._isReady?b&&b():FB.Event.subscribe("dom.ready",b)}});
(function(){function b(){FB.Dom._isReady=!0;FB.Event.fire("dom.ready");FB.Event.clear("dom.ready")}if(FB.Dom._isReady||"complete"==document.readyState)return b();document.addEventListener?document.addEventListener("DOMContentLoaded",b,!1):document.attachEvent&&document.attachEvent("onreadystatechange",b);FB.UA.ie()&&window===top&&function(){try{document.documentElement.doScroll("left")}catch(c){setTimeout(arguments.callee,0);return}b()}();var d=window.onload;window.onload=function(){b();d&&("string"==
typeof d?eval(d):d())}})();
FB.provide("Intl",{_punctCharClass:"[.!?\u3002\uff01\uff1f\u0964\u2026\u0eaf\u1801\u0e2f\uff0e]",_endsInPunct:function(b){return"string"!=typeof b?!1:b.match(RegExp(FB.Intl._punctCharClass+"[)\"'\u00bb\u0f3b\u0f3d\u2019\u201d\u203a\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\ufd3f\uff07\uff09\uff3ds]*$"))},_tx:function(b,d){if(void 0!==d)if("object"!=typeof d)FB.log("The second arg to FB.Intl._tx() must be an Object for tx("+b+", ...)");else{var c,e;for(e in d)d.hasOwnProperty(e)&&
(c=FB.Intl._endsInPunct(d[e])?RegExp("{"+e+"}"+FB.Intl._punctCharClass+"*","g"):RegExp("{"+e+"}","g"),b=b.replace(c,d[e]))}return b},tx:function(b,d){return!FB.Intl._stringTable?null:FBIntern.Intl._tx(FB.Intl._stringTable[b],d)}});
FB.provide("",{bind:function(){var b=Array.prototype.slice.call(arguments),d=b.shift(),c=b.shift();return function(){return d.apply(c,b.concat(Array.prototype.slice.call(arguments)))}},Class:function(b,d,c){if(FB.CLASSES[b])return FB.CLASSES[b];d=d||function(){};d.prototype=c;d.prototype.bind=function(b){return FB.bind(b,this)};d.prototype.constructor=d;FB.create(b,d);return FB.CLASSES[b]=d},subclass:function(b,d,c,e){if(FB.CLASSES[b])return FB.CLASSES[b];var f=FB.create(d);FB.copy(e,f.prototype);
e._base=f;e._callBase=function(b){var c=Array.prototype.slice.call(arguments,1);return f.prototype[b].apply(this,c)};return FB.Class(b,c?c:function(){f.apply&&f.apply(this,arguments)},e)},CLASSES:{}});FB.provide("Type",{isType:function(b,d){for(;b;){if(b.constructor===d||b===d)return!0;b=b._base}return!1}});FB.Class("Obj",null,FB.copy({setProperty:function(b,d){FB.JSON.stringify(d)!=FB.JSON.stringify(this[b])&&(this[b]=d,this.fire(b,d))}},FB.EventProvider));
FB.subclass("Dialog","Obj",function(b){this.id=b;FB.Dialog._dialogs||(FB.Dialog._dialogs={},FB.Dialog._addOrientationHandler());FB.Dialog._dialogs[b]=this},{});
FB.provide("Dialog",{_dialogs:null,_lastYOffset:0,_loaderEl:null,_overlayEl:null,_stack:[],_active:null,_popStateListenerOn:!1,_hideOnPopState:function(b){FB.Dialog.hide(FB.Dialog._stack.pop())},get:function(b){return FB.Dialog._dialogs[b]},_findRoot:function(b){for(;b;){if(FB.Dom.containsCss(b,"fb_dialog"))return b;b=b.parentNode}},_createWWWLoader:function(b){b=parseInt(b,10);return FB.Dialog.create({content:'<div class="dialog_title">  <a id="fb_dialog_loader_close">    <div class="fb_dialog_close_icon"></div>  </a>  <span>Facebook</span>  <div style="clear:both;"></div></div><div class="dialog_content"></div><div class="dialog_footer"></div>',
width:b?b:460})},_createMobileLoader:function(){var b=FB.UA.nativeApp()?"":'<table>  <tbody>    <tr>      <td class="header_left">        <label class="touchable_button">          <input type="submit" value="'+FB.Intl._tx("Cancel")+'"            id="fb_dialog_loader_close"/>        </label>      </td>      <td class="header_center">        <div>'+FB.Intl._tx("Loading...")+'</div>      </td>      <td class="header_right">      </td>    </tr>  </tbody></table>';return FB.Dialog.create({classes:"loading"+
(FB.UA.iPad()?" centered":""),content:'<div class="dialog_header">'+b+"</div>"})},_restoreBodyPosition:function(){if(!FB.UA.iPad()){var b=document.getElementsByTagName("body")[0];FB.Dom.removeCss(b,"fb_hidden")}},_showIPadOverlay:function(){FB.UA.iPad()&&(FB.Dialog._overlayEl||(FB.Dialog._overlayEl=document.createElement("div"),FB.Dialog._overlayEl.setAttribute("id","fb_dialog_ipad_overlay"),FB.Content.append(FB.Dialog._overlayEl,null)),FB.Dialog._overlayEl.className="")},_hideIPadOverlay:function(){FB.UA.iPad()&&
(FB.Dialog._overlayEl.className="hidden")},showLoader:function(b,d){FB.Dialog._showIPadOverlay();FB.Dialog._loaderEl||(FB.Dialog._loaderEl=FB.Dialog._findRoot(FB.UA.mobile()?FB.Dialog._createMobileLoader():FB.Dialog._createWWWLoader(d)));b||(b=function(){});var c=FB.$("fb_dialog_loader_close");FB.Dom.removeCss(c,"fb_hidden");c.onclick=function(){FB.Dialog._hideLoader();FB.Dialog._restoreBodyPosition();FB.Dialog._hideIPadOverlay();b()};var e=FB.$("fb_dialog_ipad_overlay");e&&(e.ontouchstart=c.onclick);
FB.Dialog._makeActive(FB.Dialog._loaderEl)},_hideLoader:function(){FB.Dialog._loaderEl&&FB.Dialog._loaderEl==FB.Dialog._active&&(FB.Dialog._loaderEl.style.top="-10000px")},_makeActive:function(b){FB.Dialog._setDialogSizes();FB.Dialog._lowerActive();FB.Dialog._active=b;FB.Canvas&&FB.Canvas.getPageInfo(function(b){FB.Dialog._centerActive(b)});FB.Dialog._centerActive(FB.Canvas._pageInfo)},_lowerActive:function(){FB.Dialog._active&&(FB.Dialog._active.style.top="-10000px",FB.Dialog._active=null)},_removeStacked:function(b){FB.Dialog._stack=
FB.Array.filter(FB.Dialog._stack,function(d){return d!=b})},_centerActive:function(b){var d=FB.Dialog._active;if(d){var c=FB.Dom.getViewportInfo(),e=parseInt(d.offsetWidth,10),f=parseInt(d.offsetHeight,10),e=c.scrollLeft+(c.width-e)/2,g=(c.height-f)/2.5;e<g&&(g=e);var h=c.height-f-g,k=(c.height-f)/2;b&&(k=b.scrollTop-b.offsetTop+(b.clientHeight-f)/2);k<g?k=g:k>h&&(k=h);k+=c.scrollTop;FB.UA.mobile()&&(b=100,FB.UA.iPad()?b+=(c.height-f)/2:(c=document.getElementsByTagName("body")[0],FB.Dom.addCss(c,
"fb_hidden"),k=e=1E4),c=FB.Dom.getByClass("fb_dialog_padding",d),c.length&&(c[0].style.height=b+"px"));d.style.left=(0<e?e:0)+"px";d.style.top=(0<k?k:0)+"px"}},_setDialogSizes:function(){if(FB.UA.mobile()&&!FB.UA.iPad())for(var b in FB.Dialog._dialogs)if(document.getElementById(b)){var d=document.getElementById(b);d.style.width=FB.UIServer.getDefaultSize().width+"px";d.style.height=FB.UIServer.getDefaultSize().height+"px"}},_handleOrientationChange:function(b){if(FB.UA.android()&&screen.availWidth==
FB.Dialog._availScreenWidth)window.setTimeout(FB.Dialog._handleOrientationChange,50);else if(FB.Dialog._availScreenWidth=screen.availWidth,FB.UA.iPad())FB.Dialog._centerActive();else for(var d in FB.Dialog._dialogs)document.getElementById(d)&&(document.getElementById(d).style.width=FB.UIServer.getDefaultSize().width+"px")},_addOrientationHandler:function(){if(FB.UA.mobile()){var b="onorientationchange"in window?"orientationchange":"resize";FB.Dialog._availScreenWidth=screen.availWidth;FB.Event.listen(window,
b,FB.Dialog._handleOrientationChange)}},create:function(b){b=b||{};var d=document.createElement("div"),c=document.createElement("div"),e="fb_dialog";if(b.closeIcon&&b.onClose){var f=document.createElement("a");f.className="fb_dialog_close_icon";f.onclick=b.onClose;d.appendChild(f)}e+=" "+(b.classes||"");FB.UA.ie()?(e+=" fb_dialog_legacy",FB.Array.forEach("vert_left vert_right horiz_top horiz_bottom top_left top_right bottom_left bottom_right".split(" "),function(b){var c=document.createElement("span");
c.className="fb_dialog_"+b;d.appendChild(c)})):e+=FB.UA.mobile()?" fb_dialog_mobile":" fb_dialog_advanced";b.content&&FB.Content.append(b.content,c);d.className=e;e=parseInt(b.width,10);isNaN(e)||(d.style.width=e+"px");c.className="fb_dialog_content";d.appendChild(c);FB.UA.mobile()&&(e=document.createElement("div"),e.className="fb_dialog_padding",d.appendChild(e));FB.Content.append(d);b.visible&&FB.Dialog.show(d);return c},show:function(b){var d=FB.Dialog._findRoot(b);d&&(FB.Dialog._removeStacked(d),
FB.Dialog._hideLoader(),FB.Dialog._makeActive(d),FB.Dialog._stack.push(d),"fbCallID"in b&&FB.Dialog.get(b.fbCallID).fire("iframe_show"),FB.Event._popStateListenerOn||(FB.Event.listen(window,"popstate",FB.Dialog._hideOnPopState),FB.Event._popStateListenerOn=!0))},hide:function(b){FB.Dialog._findRoot(b)==FB.Dialog._active&&(FB.Dialog._lowerActive(),FB.Dialog._restoreBodyPosition(),FB.Dialog._hideIPadOverlay(),"fbCallID"in b&&FB.Dialog.get(b.fbCallID).fire("iframe_hide"),FB.Event._popStateListenerOn&&
(FB.Event.unlisten(window,"popstate",FB.Dialog._hideOnPopState),FB.Event._popStateListenerOn=!1))},remove:function(b){if(b=FB.Dialog._findRoot(b)){var d=FB.Dialog._active==b;FB.Dialog._removeStacked(b);d?(FB.Dialog._hideLoader(),0<FB.Dialog._stack.length?FB.Dialog.show(FB.Dialog._stack.pop()):(FB.Dialog._lowerActive(),FB.Dialog._restoreBodyPosition(),FB.Dialog._hideIPadOverlay())):null===FB.Dialog._active&&0<FB.Dialog._stack.length&&FB.Dialog.show(FB.Dialog._stack.pop());window.setTimeout(function(){b.parentNode.removeChild(b)},
3E3)}},isActive:function(b){return(b=FB.Dialog._findRoot(b))&&b===FB.Dialog._active}});
FB.provide("",{ui:function(b,d){b=FB.copy({},b);if(!b.method)return FB.log('"method" is a required parameter for FB.ui().'),null;if(("permissions.request"==b.method||"permissions.oauth"==b.method)&&("iframe"==b.display||"dialog"==b.display)){var c;FB._oauth?(c=b.scope,c=c.split(/\s|,/g)):(c=b.perms,c=c.split(","));for(var e=0;e<c.length;e++){var f=FB.String.trim(c[e]);if(f&&!FB.initSitevars.iframePermissions[f]){b.display="popup";break}}}c=FB.UIServer.prepareCall(b,d);if(!c)return null;e=c.params.display;
"dialog"===e?e="iframe":"none"===e&&(e="hidden");e=FB.UIServer[e];if(!e)return FB.log('"display" must be one of "popup", "dialog", "iframe", "touch", "async", "hidden", or "none"'),null;e(c);return c.dialog}});
FB.provide("UIServer",{Methods:{},_loadedNodes:{},_defaultCb:{},_resultToken:'"xxRESULTTOKENxx"',_forceHTTPS:!1,genericTransform:function(b){if("dialog"==b.params.display||"iframe"==b.params.display)b.params.display="iframe",b.params.channel=FB.UIServer._xdChannelHandler(b.id,"parent.parent");return b},prepareCall:function(b,d){var c=b.method.toLowerCase(),e=FB.copy({},FB.UIServer.Methods[c]),f=FB.guid(),g=!0!==e.noHttps&&(FB._https||"auth.status"!==c&&"login.status"!=c);FB.UIServer._forceHTTPS=g;
FB.copy(b,{api_key:FB._apiKey,app_id:FB._apiKey,locale:FB._locale,sdk:"joey",access_token:g&&FB.getAccessToken()||void 0});b.display=FB.UIServer.getDisplayMode(e,b);e.url||(e.url="dialog/"+c);c={cb:d,id:f,size:e.size||FB.UIServer.getDefaultSize(),url:FB.getDomain(g?"https_www":"www")+e.url,forceHTTPS:g,params:b,name:c,dialog:new FB.Dialog(f)};if(g=e.transform?e.transform:FB.UIServer.genericTransform)if(c=g(c),!c)return;e=(e.getXdRelation||FB.UIServer.getXdRelation)(c.params);!(c.id in FB.UIServer._defaultCb)&&
(!("next"in c.params)&&!("redirect_uri"in c.params))&&(c.params.next=FB.UIServer._xdResult(c.cb,c.id,e,!0));"parent"===e&&(c.params.channel_url=FB.UIServer._xdChannelHandler(f,"parent.parent"));return c=FB.UIServer.prepareParams(c)},prepareParams:function(b){var d=b.params.method;FB.Canvas.isTabIframe()||delete b.params.method;FB.TemplateUI&&FB.TemplateUI.supportsTemplate(d,b)?(FB.reportTemplates&&console.log("Using template for "+d+"."),FB.TemplateUI.useCachedUI(d,b)):(b.params=FB.JSON.flatten(b.params),
d=FB.QS.encode(b.params),!FB.UA.nativeApp()&&FB.UIServer.urlTooLongForIE(b.url+"?"+d)?b.post=!0:d&&(b.url+="?"+d));return b},urlTooLongForIE:function(b){return 2E3<b.length},getDisplayMode:function(b,d){return"hidden"===d.display||"none"===d.display?d.display:FB.Canvas.isTabIframe()&&"popup"!==d.display?"async":FB.UA.mobile()||"touch"===d.display?"touch":!FB.getAccessToken()&&"dialog"==d.display&&!b.loggedOutIframe?(FB.log('"dialog" mode can only be used when the user is connected.'),"popup"):b.connectDisplay&&
!FB._inCanvas?b.connectDisplay:d.display||(FB.getAccessToken()?"dialog":"popup")},getXdRelation:function(b){b=b.display;if("popup"===b||"touch"===b)return"opener";if("dialog"===b||"iframe"===b||"hidden"===b||"none"===b)return"parent";if("async"===b)return"parent.frames["+window.name+"]"},popup:function(b){var d="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,c="undefined"!=typeof window.screenY?window.screenY:window.screenTop,e="undefined"!=typeof window.outerWidth?window.outerWidth:
document.documentElement.clientWidth,f="undefined"!=typeof window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,g=FB.UA.mobile()?null:b.size.width,h=FB.UA.mobile()?null:b.size.height,d=parseInt((0>d?window.screen.width+d:d)+(e-g)/2,10),c=parseInt(c+(f-h)/2.5,10),f=[];null!==g&&f.push("width="+g);null!==h&&f.push("height="+h);f.push("left="+d);f.push("top="+c);f.push("scrollbars=1");("permissions.request"==b.name||"permissions.oauth"==b.name)&&f.push("location=1,toolbar=0");
f=f.join(",");b.post?(FB.UIServer.setLoadedNode(b,window.open("about:blank",b.id,f)),FB.Content.submitToTarget({url:b.url,target:b.id,params:b.params})):FB.UIServer.setLoadedNode(b,window.open(b.url,b.id,f));b.id in FB.UIServer._defaultCb&&FB.UIServer._popupMonitor()},setLoadedNode:function(b,d){FB.UIServer._loadedNodes[b.id]=d;b.params&&"popup"!=b.params.display&&(d.fbCallID=b.id)},getLoadedNode:function(b){return FB.UIServer._loadedNodes[b.id]},hidden:function(b){b.className="FB_UI_Hidden";b.root=
FB.Content.appendHidden("");FB.UIServer._insertIframe(b)},iframe:function(b){b.className="FB_UI_Dialog";var d=function(){FB.UIServer._triggerDefault(b.id)};b.root=FB.Dialog.create({onClose:d,closeIcon:!0,classes:FB.UA.iPad()?"centered":""});b.hideLoader||FB.Dialog.showLoader(d,b.size.width);FB.Dom.addCss(b.root,"fb_dialog_iframe");FB.UIServer._insertIframe(b)},touch:function(b){b.params&&b.params.in_iframe?b.ui_created?FB.Dialog.showLoader(function(){FB.UIServer._triggerDefault(b.id)},0):FB.UIServer.iframe(b):
FB.UA.nativeApp()&&!b.ui_created?(b.frame=b.id,FB.Native.onready(function(){FB.UIServer.setLoadedNode(b,FB.Native.open(b.url+"#cb="+b.frameName))}),FB.UIServer._popupMonitor()):b.ui_created||FB.UIServer.popup(b)},async:function(b){b.frame=window.name;delete b.url;delete b.size;FB.Arbiter.inform("showDialog",b)},getDefaultSize:function(){if(FB.UA.mobile()){if(FB.UA.iPad())return{width:500,height:590};if(FB.UA.android())return{width:screen.availWidth,height:screen.availHeight};var b=window.innerWidth,
d=window.innerHeight;return{width:b,height:Math.max(d,1.2<b/d?screen.width:screen.height)}}return{width:575,height:240}},_insertIframe:function(b){FB.UIServer._loadedNodes[b.id]=!1;var d=function(c){b.id in FB.UIServer._loadedNodes&&FB.UIServer.setLoadedNode(b,c)};b.post?FB.Content.insertIframe({url:"about:blank",root:b.root,className:b.className,width:b.size.width,height:b.size.height,id:b.id,onInsert:d,onload:function(c){FB.Content.submitToTarget({url:b.url,target:c.name,params:b.params})}}):FB.Content.insertIframe({url:b.url,
root:b.root,className:b.className,width:b.size.width,height:b.size.height,id:b.id,name:b.frameName,onInsert:d})},_handleResizeMessage:function(b,d){var c=FB.UIServer._loadedNodes[b];d.height&&(c.style.height=d.height+"px");d.width&&(c.style.width=d.width+"px");FB.Arbiter.inform("resize.ack",d||{},"parent.frames["+c.name+"]",!0);FB.Dialog.isActive(c)||FB.Dialog.show(c)},_triggerDefault:function(b){FB.UIServer._xdRecv({frame:b},FB.UIServer._defaultCb[b]||function(){})},_popupMonitor:function(){var b,
d;for(d in FB.UIServer._loadedNodes)if(FB.UIServer._loadedNodes.hasOwnProperty(d)&&d in FB.UIServer._defaultCb){var c=FB.UIServer._loadedNodes[d];try{if(c.tagName)continue}catch(e){}try{c.closed?FB.UIServer._triggerDefault(d):b=!0}catch(f){}}b&&!FB.UIServer._popupInterval?FB.UIServer._popupInterval=window.setInterval(FB.UIServer._popupMonitor,100):!b&&FB.UIServer._popupInterval&&(window.clearInterval(FB.UIServer._popupInterval),FB.UIServer._popupInterval=null)},_xdChannelHandler:function(b,d){var c=
FB.UIServer._forceHTTPS&&7!==FB.UA.ie();return FB.XD.handler(function(c){var d=FB.UIServer._loadedNodes[b];d&&("resize"==c.type?FB.UIServer._handleResizeMessage(b,c):"hide"==c.type?FB.Dialog.hide(d):"rendered"==c.type?(c=FB.Dialog._findRoot(d),FB.Dialog.show(c)):"fireevent"==c.type&&FB.Event.fire(c.event))},d,!0,null,c)},_xdNextHandler:function(b,d,c,e){e&&(FB.UIServer._defaultCb[d]=b);return FB.XD.handler(function(c){FB.UIServer._xdRecv(c,b)},c)+"&frame="+d},_xdRecv:function(b,d){var c=FB.UIServer._loadedNodes[b.frame];
try{FB.Dom.containsCss(c,"FB_UI_Hidden")?window.setTimeout(function(){c.parentNode.parentNode.removeChild(c.parentNode)},3E3):FB.Dom.containsCss(c,"FB_UI_Dialog")&&(FB.Dialog.remove(c),FB.TemplateUI&&FB.UA.mobile()&&FB.TemplateUI.populateCache())}catch(e){}try{c.close&&(c.close(),FB.UIServer._popupCount--)}catch(f){}delete FB.UIServer._loadedNodes[b.frame];delete FB.UIServer._defaultCb[b.frame];d(b)},_xdResult:function(b,d,c,e){return FB.UIServer._xdNextHandler(function(c){b&&b(c.result&&c.result!=
FB.UIServer._resultToken&&FB.JSON.parse(c.result))},d,c,e)+"&result="+encodeURIComponent(FB.UIServer._resultToken)}});
FB.provide("",{getLoginStatus:function(b,d){if(FB._apiKey){if(b){if(!d&&"loaded"==FB.Auth._loadState){FB._oauth?b({status:FB._userStatus,authResponse:FB._authResponse}):b({status:FB._userStatus,session:FB._session});return}FB.Event.subscribe("FB.loginStatus",b)}if(d||"loading"!=FB.Auth._loadState){FB.Auth._loadState="loading";var c=function(b){FB.Auth._loadState="loaded";FB.Event.fire("FB.loginStatus",b);FB.Event.clear("FB.loginStatus")};FB.UA.mobile()&&window.postMessage&&window.localStorage?FB.Auth.staticAuthCheck(c):
FB._oauth?FB.ui({method:"login.status",display:"none",domain:location.hostname},c):FB.ui({method:"auth.status",display:"hidden"},c)}}else FB.log("FB.getLoginStatus() called before calling FB.init().")},getSession:function(){if(FB._oauth)throw Error("FB.getSession incompatible with OAuth2.");return FB._session},getAuthResponse:function(){if(!FB._oauth)throw Error("getAuthResponse called when OAuth2 support is disabled.  Please fix.");return FB._authResponse},getAccessToken:function(){return FB._oauth?
FB._authResponse&&FB._authResponse.accessToken||null:FB._session&&FB._session.access_token||null},getUserID:function(){return FB._oauth?FB._userID:FB._session&&FB._session.uid||0},login:function(b,d){FB._oauth?(d&&(d.perms&&!d.scope)&&(d.scope=d.perms,delete d.perms,FB.log("OAuth2 specification states that 'perms' should now be called 'scope'.  Please update.")),FB.ui(FB.copy({method:"permissions.oauth",display:"popup",domain:location.hostname},d||{}),b)):FB.ui(FB.copy({method:"permissions.request",
display:"popup"},d||{}),b)},logout:function(b){FB.ui({method:"auth.logout",display:"hidden"},b)}});
FB.provide("Auth",{_callbacks:[],_xdStorePath:"xd_localstorage/",staticAuthCheck:function(b){var d=FB.getDomain("https_staticfb");FB.Content.insertIframe({root:FB.Content.appendHidden(""),className:"FB_UI_Hidden",url:d+FB.Auth._xdStorePath,onload:function(c){c=frames[c.name];var e=FB.guid(),f=!1,g=function(c){f||(f=!0,FB.Auth._staticAuthHandler(b,c))};FB.XD.handler(g,"parent",!0,e);setTimeout(g,500);c.postMessage(FB.JSON.stringify({method:"getItem",params:["LoginInfo_"+FB._apiKey,!0],returnCb:e}),
d)}})},_staticAuthHandler:function(b,d){if(d&&d.data&&d.data.status&&"connected"==d.data.status){var c;c=d.data.status;d.data.https&&(FB._https=!0);c=FB._oauth?FB.Auth.setAuthResponse(d.data.authResponse||null,c):FB.Auth.setSession(d.data.session||null,c);b&&b(c)}else FB._oauth?FB.ui({method:"login.status",display:"none"},b):FB.ui({method:"auth.status",display:"hidden"},b)},setSession:function(b,d){if(FB._oauth)throw Error("FB.Auth.setSession incompatible with OAuth2.");var c=!FB._session&&b,e=FB._session&&
!b,f=FB._session&&b&&FB._session.uid!=b.uid,g=c||e||FB._session&&b&&FB._session.access_token!=b.access_token,h=d!=FB._userStatus,k={session:b,status:d};FB._session=b;FB._userStatus=d;g&&(FB.Cookie&&FB.Cookie.getEnabled())&&FB.Cookie.set(b);h&&FB.Event.fire("auth.statusChange",k);(e||f)&&FB.Event.fire("auth.logout",k);(c||f)&&FB.Event.fire("auth.login",k);g&&FB.Event.fire("auth.sessionChange",k);FB.Auth._refreshTimer&&(window.clearTimeout(FB.Auth._refreshTimer),delete FB.Auth._refreshTimer);FB.Auth._loadState&&
(b&&b.expires)&&(FB.Auth._refreshTimer=window.setTimeout(function(){FB.getLoginStatus(null,!0)},12E5));return k},setAuthResponse:function(b,d){if(!FB._oauth)throw Error("FB.Auth.setAuthResponse only compatible with OAuth2.");var c=0;if(b)if(b.userID)c=b.userID;else if(b.signedRequest){var e=FB.Auth.parseSignedRequest(b.signedRequest);e&&e.user_id&&(c=e.user_id)}var e=!FB._userID&&b,f=FB._userID&&!b,g=b&&FB._userID!=c,h=e||f||g,k=d!=FB._userStatus,l={authResponse:b,status:d};FB._authResponse=b;FB._userID=
c;FB._userStatus=d;(f||g)&&FB.Event.fire("auth.logout",l);(e||g)&&FB.Event.fire("auth.login",l);h&&FB.Event.fire("auth.authResponseChange",l);k&&FB.Event.fire("auth.statusChange",l);FB.Auth._refreshTimer&&(window.clearTimeout(FB.Auth._refreshTimer),delete FB.Auth._refreshTimer);FB.Auth._loadState&&b&&(FB.Auth._refreshTimer=window.setTimeout(function(){FB.getLoginStatus(null,!0)},12E5));return l},xdHandler:function(b,d,c,e,f,g){return FB.UIServer._xdNextHandler(FB.Auth.xdResponseWrapper(b,f,g),d,c,
e)},xdResponseWrapper:function(b,d,c){return function(e){try{c=FB.JSON.parse(e.session)}catch(f){}c&&(d="connected");e&&e.https&&(FB._https=!0);var g=FB.Auth.setSession(c||null,d);g.perms=e&&e.perms||null;if(e&&e.required_perms&&FB.UA.nativeApp()){e=JSON.parse(e.required_perms);var h=[];FB.Array.forEach(e,function(b,c){h=h.concat(b)});e=h.join(",");FB.login(b,{perms:e})}else b&&b(g)}},_getSessionOrigin:function(){return FB.UA.nativeApp()?3:FB.UA.mobile()?2:FB._inCanvas?5:1},xdNewHandler:function(b,
d,c,e,f){if(!FB._oauth)throw Error("xdNewHandler should not be invoked unless OAuth2 is being used.");return FB.UIServer._xdNextHandler(FB.Auth.xdNewResponseWrapper(b,e,f),d,c,!0)},xdNewResponseWrapper:function(b,d,c){if(!FB._oauth)throw Error("xdNewResponseWrapper should not be invoked unless OAuth2 is being used.");return function(e){if(e.access_token){var f=FB.Auth.parseSignedRequest(e.signed_request);d={accessToken:e.access_token,userID:f.user_id,expiresIn:parseInt(e.expires_in,10),signedRequest:e.signed_request};
FB.Auth.setAuthResponse(d,"connected");if(FB.Cookie.getEnabled()){var f=0===d.expiresIn?0:(new Date).getTime()+1E3*d.expiresIn,g=FB.Cookie._domain;!g&&e.base_domain&&(g="."+e.base_domain);FB.Cookie.setSignedRequestCookie(e.signed_request,f,g)}}else!FB._authResponse&&d?FB.Auth.setAuthResponse(d,"connected"):d&&"permissions.oauth"==c||(FB.Auth.setAuthResponse(null,e.error&&"not_authorized"===e.error?"not_authorized":"unknown"),FB.Cookie.getEnabled()&&FB.Cookie.clearSignedRequestCookie());e&&(e.https&&
!FB._https)&&(FB._https=!0);response={authResponse:FB._authResponse,status:FB._userStatus};b&&b(response)}},parseSignedRequest:function(b){if(!b)return null;b=b.split(".",2)[1];b=FB.Auth.base64URLDecode(b);return FB.JSON.parse(b)},base64URLDecode:function(b){b=b.replace(/\-/g,"+").replace(/\_/g,"/");if(0!==b.length%4)for(var d=4-b.length%4,c=0;c<d;c++)b+="=";for(var d="",e,f,g="",h="",k=0;k<b.length;k+=4)e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(k)),f=
"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(k+1)),c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(k+2)),h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(b.charAt(k+3)),e=e<<2|f>>4,f=(f&15)<<4|c>>2,g=(c&3)<<6|h,d+=String.fromCharCode(e),64!=c&&(d+=String.fromCharCode(f)),64!=h&&(d+=String.fromCharCode(g));return unescape(d)}});
FB.provide("UIServer.Methods",{"permissions.request":{size:{width:FB.UA.mobile()?null:640,height:FB.UA.mobile()?null:241},transform:function(b){if(FB._apiKey)if(FB._session&&!b.params.perms&&!b.params.auth_type)FB.log("FB.login() called when user is already connected."),b.cb&&b.cb({status:FB._userStatus,session:FB._session});else return b=FB.UIServer.genericTransform(b),b.cb=FB.Auth.xdResponseWrapper(b.cb,FB._userStatus,FB._session),b.params.method="permissions.request",FB.copy(b.params,{fbconnect:FB._inCanvas?
0:1,return_session:1,session_version:3}),b;else FB.log("FB.login() called before calling FB.init().")}},"permissions.oauth":{url:"dialog/oauth",size:{width:FB.UA.mobile()?null:627,height:FB.UA.mobile()?null:326},transform:function(b){if(FB._apiKey)if(FB._authResponse&&!b.params.scope)FB.log("FB.login() called when user is already connected."),b.cb&&b.cb({status:FB._userStatus,authResponse:FB._authResponse});else{var d=b.cb,c=b.id;delete b.cb;FB.copy(b.params,{client_id:FB._apiKey,redirect_uri:FB.Auth.xdNewHandler(d,
c,"opener",FB._authResponse,"permissions.oauth"),origin:FB.Auth._getSessionOrigin(),response_type:"token,signed_request",domain:location.hostname});return b}else FB.log("FB.login() called before FB.init().")}},"auth.logout":{url:"logout.php",transform:function(b){if(FB._apiKey)if(FB._oauth&&!FB._authResponse)FB.log("FB.logout() called without an access token.");else if(!FB._oauth&&!FB._session)FB.log("FB.logout() called without a session.");else return b.params.next=FB._oauth?FB.Auth.xdNewHandler(b.cb,
b.id,"parent",FB._authResponse):FB.Auth.xdHandler(b.cb,b.id,"parent",!1,"unknown"),b;else FB.log("FB.logout() called before calling FB.init().")}},"auth.status":{url:"extern/login_status.php",transform:function(b){var d=b.cb,c=b.id,e=FB.Auth.xdHandler;delete b.cb;FB.copy(b.params,{no_session:e(d,c,"parent",!1,"notConnected"),no_user:e(d,c,"parent",!1,"unknown"),ok_session:e(d,c,"parent",!1,"connected"),session_version:3,extern:FB._inCanvas?0:2,session_origin:FB.Auth._getSessionOrigin()});return b}},
"login.status":{url:"dialog/oauth",transform:function(b){var d=b.cb,c=b.id;delete b.cb;FB.copy(b.params,{client_id:FB._apiKey,redirect_uri:FB.Auth.xdNewHandler(d,c,"parent",FB._authResponse),origin:FB.Auth._getSessionOrigin(),response_type:"token,signed_request,code",domain:location.hostname});return b}}});FB.provide("CanvasInsights",{setDoneLoading:function(b){FB.Canvas.setDoneLoading(b)}});
FB.provide("Cookie",{_domain:null,_enabled:!1,setEnabled:function(b){FB.Cookie._enabled=!!b;"string"==typeof b&&(FB.Cookie._domain=b)},getEnabled:function(){return FB.Cookie._enabled},load:function(){var b=document.cookie.match("\\bfbs_"+FB._apiKey+'="([^;]*)\\b'),d;b&&(d=FB.QS.decode(b[1]),d.expires=parseInt(d.expires,10),FB.Cookie._domain=d.base_domain);return d},loadMeta:function(){var b=document.cookie.match("\\bfbm_"+FB._apiKey+"=([^;]*)\\b"),d;b&&(d=FB.QS.decode(b[1]),FB.Cookie._domain||(FB.Cookie._domain=
d.base_domain));return d},loadSignedRequest:function(){var b=document.cookie.match("\\bfbsr_"+FB._apiKey+"=([^;]*)\\b");return!b?null:b[1]},setSignedRequestCookie:function(b,d,c){if(!FB._oauth)throw Error("FB.Cookie.setSignedRequestCookie should only be used with OAuth2.");if(!b)throw Error("Value passed to FB.Cookie.setSignedRequestCookie was empty.");if(FB.Cookie.getEnabled()){if(c){var e=FB.QS.encode({base_domain:c});FB.Cookie.setRaw("fbm_",e,d,c)}FB.Cookie._domain=c;FB.Cookie.setRaw("fbsr_",b,
d,c)}},clearSignedRequestCookie:function(){if(!FB._oauth)throw Error("FB.Cookie.setSignedRequestCookie should only be used with OAuth2.");FB.Cookie.getEnabled()&&FB.Cookie.setRaw("fbsr_","",0,FB.Cookie._domain)},setRaw:function(b,d,c,e){e&&(document.cookie=b+FB._apiKey+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT;",document.cookie=b+FB._apiKey+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT;domain="+location.hostname+";");var f=(new Date(c)).toGMTString();document.cookie=b+FB._apiKey+"="+d+(d&&0===c?"":"; expires="+
f)+"; path=/"+(e?"; domain="+e:"")},set:function(b){b?(FB.Cookie.setRaw("fbs_",'"'+FB.QS.encode(b)+'"',b.expires,b.base_domain),FB.Cookie._domain=b.base_domain):FB.Cookie.clear()},clear:function(){FB.Cookie.setRaw("fbs_","",0,FB.Cookie._domain)}});
FB.provide("Frictionless",{_allowedRecipients:{},_useFrictionless:!1,_updateRecipients:function(){FB.Frictionless._allowedRecipients={};FB.api("/me/apprequestformerrecipients",function(b){b&&!b.error&&FB.Array.forEach(b.data,function(b){FB.Frictionless._allowedRecipients[b.recipient_id]=!0},!1)})},init:function(){FB.Frictionless._useFrictionless=!0;FB.getLoginStatus(function(b){"connected"==b.status&&FB.Frictionless._updateRecipients()});FB.Event.subscribe("auth.login",function(b){b.session&&FB.Frictionless._updateRecipients()})},
_processRequestResponse:function(b,d){return function(c){var e=c&&c.updated_frictionless;FB.Frictionless._useFrictionless&&e&&FB.Frictionless._updateRecipients();c&&(!d&&c.frictionless&&(FB.Dialog._hideLoader(),FB.Dialog._restoreBodyPosition(),FB.Dialog._hideIPadOverlay()),delete c.frictionless,delete c.updated_frictionless);b&&b(c)}},isAllowed:function(b){if(!b)return!1;if("number"===typeof b)return FB.Frictionless._allowedRecipients[b];"string"===typeof b&&(b=b.split(","));b=FB.Array.map(b,FB.String.trim);
var d=!0,c=!1;FB.Array.forEach(b,function(b){d=d&&FB.Frictionless._allowedRecipients[b];c=!0},!1);return d&&c}});
FB.provide("",{initSitevars:{},init:function(b){b=FB.copy(b||{},{logging:!0,status:!0});FB._userID=0;FB._apiKey=b.appId||b.apiKey;FB._oauth=FB.forceOAuth||!!b.oauth;!b.logging&&0>window.location.toString().indexOf("fb_debug=1")&&(FB._logging=!1);FB.XD.init(b.channelUrl);FB.UA.mobile()&&(FB.TemplateUI&&FB.TemplateData&&FB.TemplateData._enabled&&!1!==b.useCachedDialogs)&&(FB.TemplateUI.init(),FB.Event.subscribe("auth.statusChange",FB.TemplateData.update));b.reportTemplates&&(FB.reportTemplates=!0);
b.frictionlessRequests&&FB.Frictionless.init();if(FB._apiKey){FB.Cookie.setEnabled(b.cookie);if(FB._oauth)if(b.authResponse)FB.Auth.setAuthResponse(b.authResponse,"connected");else{var d=FB.Cookie.loadSignedRequest(),d=FB.Auth.parseSignedRequest(d);FB._userID=d&&d.user_id||0;FB.Cookie.loadMeta()}else b.session=b.session||FB.Cookie.load(),FB.Auth.setSession(b.session,b.session?"connected":"unknown");b.status&&FB.getLoginStatus()}FB._inCanvas&&(FB.Canvas._setHideFlashCallback(b.hideFlashCallback),FB.Canvas.init());
FB.Event.subscribe("xfbml.parse",function(){FB.XFBML.IframeWidget.batchWidgetPipeRequests()});b.xfbml&&window.setTimeout(function(){if(FB.XFBML)if(FB.initSitevars.parseXFBMLBeforeDomReady){FB.XFBML.parse();var b=window.setInterval(function(){FB.XFBML.parse()},100);FB.Dom.ready(function(){window.clearInterval(b);FB.XFBML.parse()})}else FB.Dom.ready(FB.XFBML.parse)},0);FB.Canvas&&FB.Canvas.Prefetcher&&FB.Canvas.Prefetcher._maybeSample()}});
FB.provide("Canvas.Prefetcher",{_sampleRate:0,_appIdsBlacklist:[],_links:[],COLLECT_AUTOMATIC:0,COLLECT_MANUAL:1,_collectionMode:0,addStaticResource:function(b){FB._inCanvas&&FB._apiKey&&FB.Canvas.Prefetcher._links.push(b)},setCollectionMode:function(b){if(!FB._inCanvas||!FB._apiKey||b!=FB.Canvas.Prefetcher.COLLECT_AUTOMATIC&&b!=FB.Canvas.Prefetcher.COLLECT_MANUAL)return!1;FB.Canvas.Prefetcher._collectionMode=b},_maybeSample:function(){FB._inCanvas&&(FB._apiKey&&FB.Canvas.Prefetcher._sampleRate)&&
(Math.random()>1/FB.Canvas.Prefetcher._sampleRate||"*"!=FB.Canvas.Prefetcher._appIdsBlacklist&&-1==FB.Array.indexOf(FB.Canvas.Prefetcher._appIdsBlacklist,parseInt(FB._apiKey,10))&&window.setTimeout(FB.Canvas.Prefetcher._sample,3E4))},_sample:function(){var b={object:"data",link:"href",script:"src"};FB.Canvas.Prefetcher._collectionMode==FB.Canvas.Prefetcher.COLLECT_AUTOMATIC&&FB.Array.forEach(b,function(b,c){FB.Array.forEach(window.document.getElementsByTagName(c),function(c){c[b]&&FB.Canvas.Prefetcher._links.push(c[b])})});
b=FB.JSON.stringify(FB.Canvas.Prefetcher._links);FB.api(FB._apiKey+"/staticresources","post",{urls:b,is_https:FB._https});FB.Canvas.Prefetcher._links=[]}});FB.provide("Canvas.EarlyFlush",{addResource:function(b){return FB.Canvas.Prefetcher.addStaticResource(b)},setCollectionMode:function(b){return FB.Canvas.Prefetcher.setCollectionMode(b)}});
FB.provide("UIServer.MobileIframableMethod",{transform:function(b){return"touch"===b.params.display&&b.params.access_token&&window.postMessage?(b.params.channel=FB.UIServer._xdChannelHandler(b.id,"parent"),FB.UA.nativeApp()||(b.params.in_iframe=1),b):FB.UIServer.genericTransform(b)},getXdRelation:function(b){return"touch"===b.display&&window.postMessage&&b.in_iframe?"parent":FB.UIServer.getXdRelation(b)}});
FB.provide("UIServer.Methods",{"stream.share":{size:{width:575,height:380},url:"sharer.php",transform:function(b){b.params.u||(b.params.u=window.location.toString());return b}},"fbml.dialog":{size:{width:575,height:300},url:"render_fbml.php",loggedOutIframe:!0,transform:function(b){return b}},"auth.logintofacebook":{size:{width:530,height:287},url:"login.php",transform:function(b){b.params.skip_api_login=1;var d=FB.UIServer.getXdRelation(b.params),d=FB.UIServer._xdResult(b.cb,b.id,d,!0);b.params.next=
FB.getDomain(FB._https?"https_www":"www")+"login.php?"+FB.QS.encode({api_key:FB._apiKey,next:d,skip_api_login:1});return b}},apprequests:{transform:function(b){b=FB.UIServer.MobileIframableMethod.transform(b);b.params.frictionless=FB.Frictionless&&FB.Frictionless._useFrictionless;b.params.frictionless&&(FB.Frictionless.isAllowed(b.params.to)&&(b.params.in_iframe=!0,b.hideLoader=!0),b.cb=FB.Frictionless._processRequestResponse(b.cb,b.hideLoader));return b},getXdRelation:function(b){return FB.UIServer.MobileIframableMethod.getXdRelation(b)}},
feed:FB.UIServer.MobileIframableMethod});
FB.provide("",{share:function(b){FB.log("FB.share() has been deprecated. Please use FB.ui() instead.");FB.ui({display:"popup",method:"stream.share",u:b})},publish:function(b,d){FB.log("FB.publish() has been deprecated. Please use FB.ui() instead.");b=b||{};FB.ui(FB.copy({display:"popup",method:"stream.publish",preview:1},b||{}),d)},addFriend:function(b,d){FB.log("FB.addFriend() has been deprecated. Please use FB.ui() instead.");FB.ui({display:"popup",id:b,method:"friend.add"},d)}});
FB.UIServer.Methods["auth.login"]=FB.UIServer.Methods["permissions.request"];
FB.provide("XFBML",{_renderTimeout:3E4,getElements:function(b,d,c){var e=FB.Array,f=FB.XFBML._getDomElements(b,d,c);b=FB.Dom.getByClass(d+"-"+c,b,"div");f=e.toArray(f);b=e.toArray(b);b=e.filter(b,function(b){return!b.hasChildNodes()||1===b.childNodes.length&&3===b.childNodes[0].nodeType});return e.merge(f,b)},parse:function(b,d){b=b||document.body;var c=1,e=function(){c--;0===c&&(d&&d(),FB.Event.fire("xfbml.render"))},f={};FB.XFBML._widgetPipeIsEnabled()&&FB.Array.forEach(FB.XFBML._tagInfos,function(c){if(c.supportsWidgetPipe){var e=
FB.XFBML.getElements(b,c.xmlns?c.xmlns:"fb",c.localName);f[c.localName]=e;FB.XFBML._widgetPipeEnabledTagCount+=e.length}});FB.Array.forEach(FB.XFBML._tagInfos,function(d){d.xmlns||(d.xmlns="fb");var h;h=void 0!==f[d.localName]?f[d.localName]:FB.XFBML.getElements(b,d.xmlns,d.localName);for(var k=0;k<h.length;k++)c++,FB.XFBML._processElement(h[k],d,e)});FB.Event.fire("xfbml.parse");window.setTimeout(function(){0<c&&FB.log(c+" XFBML tags failed to render in "+FB.XFBML._renderTimeout+"ms.")},FB.XFBML._renderTimeout);
e()},registerTag:function(b){FB.XFBML._tagInfos.push(b)},shouldUseWidgetPipe:function(){return!FB.XFBML._widgetPipeIsEnabled()?!1:1<FB.XFBML._widgetPipeEnabledTagCount},getBoolAttr:function(b,d){return(d=FB.XFBML.getAttr(b,d))&&-1<FB.Array.indexOf(["true","1","yes","on"],d.toLowerCase())},getAttr:function(b,d){return b.getAttribute(d)||b.getAttribute(d.replace(/_/g,"-"))||b.getAttribute(d.replace(/-/g,"_"))||b.getAttribute(d.replace(/-/g,""))||b.getAttribute(d.replace(/_/g,""))||b.getAttribute("data-"+
d)||b.getAttribute("data-"+d.replace(/_/g,"-"))||b.getAttribute("data-"+d.replace(/-/g,"_"))||b.getAttribute("data-"+d.replace(/-/g,""))||b.getAttribute("data-"+d.replace(/_/g,""))||null},_processElement:function(b,d,c){var e=b._element;if(e)e.subscribe("render",c),e.process();else{var f=function(){var f=eval(d.className),h=!1,k=!0,l=!1,p=!1,q="FB.XFBML.AddToTimeline"===d.className;if("FB.XFBML.LoginButton"===d.className||q)if(p=FB.XFBML.getBoolAttr(b,"render-in-iframe"),mode=FB.XFBML.getAttr(b,"mode"),
k=q&&"button"!=mode||FB.XFBML.getBoolAttr(b,"show-faces"),l=FB.XFBML.getBoolAttr(b,"show-login-face"),(h=q||p||k||l||FB.XFBML.getBoolAttr(b,"oneclick"))&&!q)f=FB.XFBML.Login;e=b._element=new f(b);if(h){f={show_faces:!!k,show_login_face:!!l,add_to_profile:q,mode:mode};if(h=FB.XFBML.getAttr(b,"scope"))FB._oauth?f.scope=h:f.perms=h;else if(h=FB.XFBML.getAttr(b,"perms"))f.perms=h;e.setExtraParams(f)}e.subscribe("render",c);e.process()};FB.CLASSES[d.className.substr(3)]?f():FB.log("Tag "+d.className+" was not found.")}},
_getDomElements:function(b,d,c){var e=d+":"+c;if(FB.UA.firefox())return b.getElementsByTagNameNS(document.body.namespaceURI,e);if(9>FB.UA.ie())try{var f=document.namespaces;if(f&&f[d]){var g=b.getElementsByTagName(c);if(!document.addEventListener||0<g.length)return g}}catch(h){}return b.getElementsByTagName(e)},_tagInfos:[{localName:"activity",className:"FB.XFBML.Activity"},{localName:"add-profile-tab",className:"FB.XFBML.AddProfileTab"},{localName:"add-to-timeline",className:"FB.XFBML.AddToTimeline"},
{localName:"bookmark",className:"FB.XFBML.Bookmark"},{localName:"comments",className:"FB.XFBML.Comments"},{localName:"comments-count",className:"FB.XFBML.CommentsCount"},{localName:"connect-bar",className:"FB.XFBML.ConnectBar"},{localName:"fan",className:"FB.XFBML.Fan"},{localName:"like",className:"FB.XFBML.Like",supportsWidgetPipe:!0},{localName:"like-box",className:"FB.XFBML.LikeBox"},{localName:"live-stream",className:"FB.XFBML.LiveStream"},{localName:"login",className:"FB.XFBML.Login"},{localName:"login-button",
className:"FB.XFBML.LoginButton"},{localName:"facepile",className:"FB.XFBML.Facepile"},{localName:"friendpile",className:"FB.XFBML.Friendpile"},{localName:"name",className:"FB.XFBML.Name"},{localName:"profile-pic",className:"FB.XFBML.ProfilePic"},{localName:"question",className:"FB.XFBML.Question"},{localName:"recommendations",className:"FB.XFBML.Recommendations"},{localName:"recommendations-bar",className:"FB.XFBML.RecommendationsBar"},{localName:"registration",className:"FB.XFBML.Registration"},
{localName:"send",className:"FB.XFBML.Send"},{localName:"serverfbml",className:"FB.XFBML.ServerFbml"},{localName:"share-button",className:"FB.XFBML.ShareButton"},{localName:"subscribe",className:"FB.XFBML.Subscribe"}],_widgetPipeEnabledTagCount:0,_widgetPipeIsEnabled:function(){return FB.widgetPipeEnabledApps&&void 0!==FB.widgetPipeEnabledApps[FB._apiKey]}});(function(){try{document.namespaces&&!document.namespaces.item.fb&&document.namespaces.add("fb")}catch(b){}})();
FB.provide("XFBML",{set:function(b,d,c){FB.log("FB.XFBML.set() has been deprecated.");b.innerHTML=d;FB.XFBML.parse(b,c)}});FB.subclass("Waitable","Obj",function(){},{set:function(b){this.setProperty("value",b)},error:function(b){this.fire("error",b)},wait:function(b,d){d&&this.subscribe("error",d);this.monitor("value",this.bind(function(){if(void 0!==this.value)return b(this.value),!0}))}});
FB.subclass("Data.Query","Waitable",function(){FB.Data.Query._c||(FB.Data.Query._c=1);this.name="v_"+FB.Data.Query._c++},{parse:function(b){var d=FB.String.format.apply(null,b),d=/^select (.*?) from (\w+)\s+where (.*)$/i.exec(d);this.fields=this._toFields(d[1]);this.table=d[2];this.where=this._parseWhere(d[3]);for(d=1;d<b.length;d++)FB.Type.isType(b[d],FB.Data.Query)&&(b[d].hasDependency=!0);return this},toFql:function(){var b="select "+this.fields.join(",")+" from "+this.table+" where ";switch(this.where.type){case "unknown":b+=
this.where.value;break;case "index":b+=this.where.key+"="+this._encode(this.where.value);break;case "in":b=1==this.where.value.length?b+(this.where.key+"="+this._encode(this.where.value[0])):b+(this.where.key+" in ("+FB.Array.map(this.where.value,this._encode).join(",")+")")}return b},_encode:function(b){return"string"==typeof b?FB.String.quote(b):b},toString:function(){return"#"+this.name},_toFields:function(b){return FB.Array.map(b.split(","),FB.String.trim)},_parseWhere:function(b){var d=/^\s*(\w+)\s*=\s*(.*)\s*$/i.exec(b),
c,e="unknown";d&&(c=d[2],/^(["'])(?:\\?.)*?\1$/.test(c)?(c=eval(c),e="index"):/^\d+\.?\d*$/.test(c)&&(e="index"));return"index"==e?{type:"index",key:d[1],value:c}:{type:"unknown",value:b}}});
FB.provide("Data",{query:function(b,d){var c=(new FB.Data.Query).parse(arguments);FB.Data.queue.push(c);FB.Data._waitToProcess();return c},waitOn:function(b,d){var c=new FB.Waitable,e=b.length;if("string"==typeof d){var f=d;d=function(b){return eval(f)}}FB.Array.forEach(b,function(f){f.monitor("value",function(){var h=!1;void 0!==FB.Data._getValue(f)&&(e--,h=!0);if(0===e){var k=d(FB.Array.map(b,FB.Data._getValue));c.set(void 0!==k?k:!0)}return h})});return c},_getValue:function(b){return FB.Type.isType(b,
FB.Waitable)?b.value:b},_selectByIndex:function(b,d,c,e){var f=new FB.Data.Query;f.fields=b;f.table=d;f.where={type:"index",key:c,value:e};FB.Data.queue.push(f);FB.Data._waitToProcess();return f},_waitToProcess:function(){0>FB.Data.timer&&(FB.Data.timer=setTimeout(FB.Data._process,10))},_process:function(){FB.Data.timer=-1;var b={},d=FB.Data.queue;FB.Data.queue=[];for(var c=0;c<d.length;c++){var e=d[c];"index"==e.where.type&&!e.hasDependency?FB.Data._mergeIndexQuery(e,b):b[e.name]=e}d={q:{}};FB.copy(d.q,
b,!0,function(b){return b.toFql()});d.queries=FB.JSON.stringify(d.queries);FB.api("/fql","GET",d,function(c){c.error?FB.Array.forEach(b,function(b){b.error(Error(c.error.message))}):FB.Array.forEach(c.data,function(c){b[c.name].set(c.fql_result_set)})})},_mergeIndexQuery:function(b,d){var c=b.where.key,e=b.where.value,f="index_"+b.table+"_"+c,g=d[f];g||(g=d[f]=new FB.Data.Query,g.fields=[c],g.table=b.table,g.where={type:"in",key:c,value:[]});FB.Array.merge(g.fields,b.fields);FB.Array.merge(g.where.value,
[e]);g.wait(function(d){b.set(FB.Array.filter(d,function(b){return b[c]==e}))})},timer:-1,queue:[]});window.setTimeout(function(){var b=/(connect.facebook.net|facebook.com\/assets.php).*?#(.*)/;FB.Array.forEach(document.getElementsByTagName("script"),function(d){if(d.src&&(d=b.exec(d.src))){var c=FB.QS.decode(d[2]);FB.Array.forEach(c,function(b,d){"0"==b&&(c[d]=0)});c.oauth=!0;FB.init(c)}});window.fbAsyncInit&&!window.fbAsyncInit.hasRun&&(window.fbAsyncInit.hasRun=!0,fbAsyncInit())},0);
FB.provide("Native",{NATIVE_READY_EVENT:"fbNativeReady",onready:function(b){if(FB.UA.nativeApp())if(window.__fbNative&&!this.nativeReady&&FB.provide("Native",window.__fbNative),this.nativeReady)b();else{var d=function(c){window.removeEventListener(FB.Native.NATIVE_READY_EVENT,d);FB.Native.onready(b)};window.addEventListener(FB.Native.NATIVE_READY_EVENT,d,!1)}else FB.log("FB.Native.onready only works when the page is rendered in a WebView of the native Facebook app. Test if this is the case calling FB.UA.nativeApp()")}});
FB.provide("UIServer.Methods",{"pay.prompt":{transform:function(b){var d=FB.XD.handler(function(c){b.cb(FB.JSON.parse(c.response))},"parent.frames["+(window.name||"iframe_canvas")+"]");b.params.channel=d;FB.Arbiter.inform("Pay.Prompt",b.params);return!1}}});
FB.provide("UIServer.Methods",{pay:{size:{width:555,height:120},noHttps:!0,connectDisplay:"popup",transform:function(b){if(!FB._inCanvas)return b.params.order_info=FB.JSON.stringify(b.params.order_info),b;var d=FB.XD.handler(function(c){b.cb(FB.JSON.parse(c.response))},"parent.frames["+(window.name||"iframe_canvas")+"]");b.params.channel=d;b.params.uiserver=!0;FB.Arbiter.inform("Pay.Prompt",b.params);return!1}}});
FB.provide("Helper",{isUser:function(b){return 22E8>b||1E14<=b&&0x5b0a58f100ef>=b||89E12<=b&&89999999999999>=b},getLoggedInUser:function(){return FB.getUserID()},upperCaseFirstChar:function(b){return 0<b.length?b.substr(0,1).toUpperCase()+b.substr(1):b},getProfileLink:function(b,d,c){(c=c||(b?FB.getDomain("www")+"profile.php?id="+b.uid:null))&&(d='<a class="fb_link" href="'+c+'">'+d+"</a>");return d},invokeHandler:function(b,d,c){b&&("string"===typeof b?eval(b):b.apply&&b.apply(d,c||[]))},fireEvent:function(b,
d){var c=d._attr.href;d.fire(b,c);FB.Event.fire(b,c,d)},executeFunctionByName:function(b){for(var d=Array.prototype.slice.call(arguments,1),c=b.split("."),e=c.pop(),f=window,g=0;g<c.length;g++)f=f[c[g]];return f[e].apply(this,d)}});
FB.provide("TemplateData",{_initialized:!1,_version:0,_response:null,_localStorageTimeout:86400,_enabled:!0,enabled:function(){return FB.TemplateData._enabled&&FB.TemplateData._initialized&&FB.TemplateData.supportsLocalStorage()&&"connected"==FB._userStatus&&FB.TemplateData.getResponse()},supportsLocalStorage:function(){try{return"localStorage"in window&&null!==window.localStorage}catch(b){return!1}},_isStale:function(b){return!b||!b.version||b.version!=FB.TemplateData._version||b.currentUserID!=
FB.getUserID()?!0:(Math.round((new Date).getTime())-b.setAt)/1E3>FB.TemplateData._localStorageTimeout},getResponse:function(){var b=FB.TemplateData;try{b._response=b._response||b.supportsLocalStorage()&&FB.JSON.parse(localStorage.FB_templateDataResponse||"null")}catch(d){b._response=null}b._isStale(b._response)&&b.saveResponse(null);return b._response},saveResponse:function(b){FB.TemplateData._response=b;FB.TemplateData.supportsLocalStorage()&&(localStorage.FB_templateDataResponse=FB.JSON.stringify(b))},
getData:function(){var b=FB.TemplateData.getResponse();return b?b.data:{}},init:function(b){b&&(FB.TemplateData._initialized=!0,FB.TemplateData._version=b,FB.TemplateData.supportsLocalStorage()&&!("FB_templateDataResponse"in localStorage)&&FB.TemplateData.clear())},clear:function(){FB.TemplateData.saveResponse(null)},update:function(b){"connected"!=FB._userStatus&&FB.TemplateData.clear();"connected"==FB._userStatus&&!FB.TemplateData.getResponse()&&FB.api({method:"dialog.template_data"},function(b){"error_code"in
b||(b={data:b,currentUserID:FB.getUserID(),setAt:(new Date).getTime(),version:FB.TemplateData._version},FB.TemplateData.saveResponse(b))})}});
FB.subclass("TemplateUI","Obj",function(b,d){this.method=b;var c=FB.UA.nativeApp()?0:1,e={display:"touch",preview_template:1,in_iframe:c,locale:FB._locale,v:FB.TemplateUI._version,user_agent:navigator.userAgent};window.devicePixelRatio&&(e.m_pixel_ratio=window.devicePixelRatio);e=FB.QS.encode(e);this.cachedCall={url:FB.getDomain("staticfb")+"dialog/"+b+"?"+e,frameName:FB.guid(),id:FB.guid(),size:FB.UIServer.getDefaultSize(),hideLoader:!0};FB.XD.handler(this.bind(function(b){"getParams"==b.type&&this.setProperty("getParamsCb",
b.returnCb)}),"parent",!0,this.cachedCall.frameName);c?(FB.UIServer.iframe(this.cachedCall),FB.Dialog.hide(this.cachedCall.root)):d&&!FB.TemplateUI._preloads[this.cachedCall.url]&&(c=document.createElement("div"),FB.TemplateUI._preloads[this.cachedCall.url]={container:c},FB.Content.insertIframe({url:this.cachedCall.url,root:FB.Content.appendHidden(c)}))},{use:function(b){if(!this.cachedCall.root){FB.UIServer.touch(this.cachedCall);var d=FB.TemplateUI._preloads[this.cachedCall.url];d&&d.container&&
(d.container.parentNode.removeChild(d.container),delete d.container)}b.ui_created=!0;b.root=this.cachedCall.root;FB.UIServer.setLoadedNode(b,FB.UIServer._loadedNodes[this.cachedCall.id]);delete FB.UIServer._loadedNodes[this.cachedCall.id];d=FB.Dialog._dialogs[b.id];FB.Dialog._dialogs[this.cachedCall.id]=d;d.id=this.cachedCall.id;delete FB.Dialog._dialogs[b.id];FB.UIServer.getLoadedNode(b).fbCallID=this.cachedCall.id;this.cachedCall.id=b.id;d={};FB.copy(d,b.params);FB.copy(d,FB.TemplateData.getData()[this.method]);
d.frictionless=FB.TemplateUI.isFrictionlessAppRequest(this.method,d);d.common=FB.TemplateData.getData().common;d.method=this.method;this.setParams(d);FB.UA.nativeApp()&&FB.UIServer._popupMonitor()},setParams:function(b){this.monitor("getParamsCb",this.bind(function(){if(this.getParamsCb)return(frames[this.cachedCall.frameName]||FB.UIServer.getLoadedNode(this.cachedCall)).postMessage(FB.JSON.stringify({params:b,cb:this.getParamsCb}),"*"),!0}))}});
FB.provide("TemplateUI",{_timer:null,_cache:{},_preloads:{},_version:0,init:function(){FB.TemplateData.init(FB.TemplateUI._version);FB.TemplateUI.initCache()},useCachedUI:function(b,d){try{FB.TemplateUI.populateCache(),cache=FB.TemplateUI._cache[b],delete FB.TemplateUI._cache[b],cache.use(d)}catch(c){FB.TemplateData.clear()}},populateCache:function(b){if(FB.TemplateData.enabled()&&FB.UA.mobile()){clearInterval(FB.TemplateUI._timer);var d={feed:!0,apprequests:!0},c;for(c in d)c in FB.TemplateUI._cache||
(FB.TemplateUI._cache[c]=new FB.TemplateUI(c,b))}},initCache:function(){FB.TemplateUI._timer=setInterval(function(){FB.TemplateUI.populateCache(!0)},2E3)},supportsTemplate:function(b,d){return FB.TemplateData.enabled()&&FB.TemplateUI.paramsAllowTemplate(b,d.params)&&"touch"===d.params.display&&FB.UA.mobile()},paramsAllowTemplate:function(b,d){var c={feed:{to:1,attachment:1,source:1},apprequests:{}};if(!(b in c))return!1;for(var e in c[b])if(d[e])return!1;return!FB.TemplateUI.willWriteOnGet(b,d)},
isFrictionlessAppRequest:function(b,d){return"apprequests"===b&&FB.Frictionless&&FB.Frictionless._useFrictionless},willWriteOnGet:function(b,d){return FB.TemplateUI.isFrictionlessAppRequest(b,d)&&d.to&&FB.Frictionless.isAllowed(d.to)}});FB.provide("URI",{resolve:function(b){if(!b)return window.location.href;var d=document.createElement("div");d.innerHTML='<a href="'+b.replace(/"/g,"&quot;")+'"></a>';return d.firstChild.href}});
FB.Class("XFBML.Element",function(b){this.dom=b},FB.copy({getAttribute:function(b,d,c){return(b=FB.XFBML.getAttr(this.dom,b))?c?c(b):b:d},_getBoolAttribute:function(b,d){return null===FB.XFBML.getAttr(this.dom,b)?d:FB.XFBML.getBoolAttr(this.dom,b)},_getPxAttribute:function(b,d){return this.getAttribute(b,d,function(b){b=parseInt(b.replace("px",""),10);return isNaN(b)?d:b})},_getAttributeFromList:function(b,d,c){return this.getAttribute(b,d,function(b){b=b.toLowerCase();return-1<FB.Array.indexOf(c,
b)?b:d})},isValid:function(){for(var b=this.dom;b;b=b.parentNode)if(b==document.body)return!0},clear:function(){this.dom.innerHTML=""}},FB.EventProvider));
FB.subclass("XFBML.IframeWidget","XFBML.Element",null,{_iframeName:null,_showLoader:!0,_refreshOnAuthChange:!1,_allowReProcess:!1,_fetchPreCachedLoader:!1,_visibleAfter:"load",_widgetPipeEnabled:!1,getUrlBits:function(){throw Error("Inheriting class needs to implement getUrlBits().");},setupAndValidate:function(){return!0},oneTimeSetup:function(){},getSize:function(){},getIframeName:function(){!this._iframeName&&(this._widgetPipeEnabled&&FB.XFBML.shouldUseWidgetPipe())&&(this._iframeName=this.generateWidgetPipeIframeName(),
FB.XFBML.IframeWidget.allWidgetPipeIframes[this._iframeName]=this,null===FB.XFBML.IframeWidget.masterWidgetPipeIframe&&(FB.XFBML.IframeWidget.masterWidgetPipeIframe=this));return this._iframeName},getIframeTitle:function(){},getChannelUrl:function(){if(!this._channelUrl){var b=this;this._channelUrl=FB.XD.handler(function(d){b.fire("xd."+d.type,d)},"parent.parent",!0)}return this._channelUrl},getIframeNode:function(){return this.dom.getElementsByTagName("iframe")[0]},arbiterInform:function(b,d,c){this.loaded?
this._arbiterInform(b,d,c):this.subscribe("iframe.onload",FB.bind(this._arbiterInform,this,b,d,c))},_arbiterInform:function(b,d,c){var e='parent.frames["'+this.getIframeNode().name+'"]';FB.Arbiter.inform(b,d,e,"https:"==window.location.protocol,c)},getDefaultWebDomain:function(){return"www"},getDefaultStaticDomain:function(){return"cdn"},process:function(b){if(this._done){if(!this._allowReProcess&&!b)return;this.clear()}else this._oneTimeSetup();this._done=!0;if(this.setupAndValidate()){this._showLoader&&
this._addLoader();FB.Dom.addCss(this.dom,"fb_iframe_widget");"immediate"!=this._visibleAfter?FB.Dom.addCss(this.dom,"fb_hide_iframes"):this.subscribe("iframe.onload",FB.bind(this.fire,this,"render"));b=this.getSize()||{};var d=this.getFullyQualifiedURL();"100%"==b.width&&FB.Dom.addCss(this.dom,"fb_iframe_widget_fluid");FB.Content.insertIframe({url:d,root:this.dom.appendChild(document.createElement("span")),name:this.getIframeName(),title:this.getIframeTitle(),className:FB._localeIsRtl?"fb_rtl":"fb_ltr",
height:b.height,width:b.width,onload:FB.bind(this.fire,this,"iframe.onload")});this.loaded=!1;this.subscribe("iframe.onload",FB.bind(function(){this.loaded=!0},this))}else this.fire("render")},generateWidgetPipeIframeName:function(){FB.XFBML.IframeWidget.widgetPipeIframeCount++;return"fb_iframe_"+FB.XFBML.IframeWidget.widgetPipeIframeCount},getFullyQualifiedURL:function(){if(FB.XFBML.shouldUseWidgetPipe()&&this._widgetPipeEnabled)return this._getWidgetPipeShell();var b=this._getURL();this._fetchPreCachedLoader||
(b+="?"+FB.QS.encode(this._getQS()));if(2E3<b.length){var b="about:blank",d=FB.bind(function(){this._postRequest();this.unsubscribe("iframe.onload",d)},this);this.subscribe("iframe.onload",d)}return b},_getWidgetPipeShell:function(){return FB.getDomain("www")+"common/widget_pipe_shell.php"},_oneTimeSetup:function(){this.subscribe("xd.resize",FB.bind(this._handleResizeMsg,this));FB.getLoginStatus&&(this.subscribe("xd.refreshLoginStatus",FB.bind(FB.getLoginStatus,FB,function(){},!0)),this.subscribe("xd.logout",
FB.bind(FB.logout,FB,function(){})));this._refreshOnAuthChange&&this._setupAuthRefresh();"load"==this._visibleAfter&&this.subscribe("iframe.onload",FB.bind(this._makeVisible,this));this.oneTimeSetup()},_makeVisible:function(){this._removeLoader();FB.Dom.removeCss(this.dom,"fb_hide_iframes");this.fire("render")},_setupAuthRefresh:function(){FB.getLoginStatus(FB.bind(function(b){var d=b.status;FB.Event.subscribe("auth.statusChange",FB.bind(function(b){this.isValid()&&(("unknown"==d||"unknown"==b.status)&&
this.process(!0),d=b.status)},this))},this))},_handleResizeMsg:function(b){if(this.isValid()){var d=this.getIframeNode();d.style.height=b.height+"px";b.width&&(d.style.width=b.width+"px");d.style.border="none";this._makeVisible()}},_addLoader:function(){this._loaderDiv||(FB.Dom.addCss(this.dom,"fb_iframe_widget_loader"),this._loaderDiv=document.createElement("div"),this._loaderDiv.className="FB_Loader",this.dom.appendChild(this._loaderDiv))},_removeLoader:function(){this._loaderDiv&&(FB.Dom.removeCss(this.dom,
"fb_iframe_widget_loader"),this._loaderDiv.parentNode&&this._loaderDiv.parentNode.removeChild(this._loaderDiv),this._loaderDiv=null)},_getQS:function(){return FB.copy({api_key:FB._apiKey,locale:FB._locale,sdk:"joey",session_key:FB._session&&FB._session.session_key,ref:this.getAttribute("ref")},this.getUrlBits().params)},_getURL:function(){var b=this.getDefaultWebDomain(),d="";this._fetchPreCachedLoader&&(b=this.getDefaultStaticDomain(),d="static/");return FB.getDomain(b)+"plugins/"+d+this.getUrlBits().name+
".php"},_postRequest:function(){FB.Content.submitToTarget({url:this._getURL(),target:this.getIframeNode().name,params:this._getQS()})}});
FB.provide("XFBML.IframeWidget",{widgetPipeIframeCount:0,masterWidgetPipeIframe:null,allWidgetPipeIframes:{},batchWidgetPipeRequests:function(){if(FB.XFBML.IframeWidget.masterWidgetPipeIframe){var b=FB.XFBML.IframeWidget._groupWidgetPipeDescriptions(),d={widget_pipe:FB.JSON.stringify(b),href:window.location,site:location.hostname,channel:FB.XFBML.IframeWidget.masterWidgetPipeIframe.getChannelUrl(),api_key:FB._apiKey,locale:FB._locale,sdk:"joey",session_key:FB._session&&FB._session.session_key},c=
FB.guid(),b=FB.XFBML.IframeWidget.masterWidgetPipeIframe.dom.appendChild(document.createElement("span"));FB.Content.insertIframe({url:"about:blank",root:b,name:c,className:"fb_hidden fb_invisible",onload:function(){FB.Content.submitToTarget({url:FB._domain.www+"widget_pipe.php?widget_pipe=1",target:c,params:d})}})}},_groupWidgetPipeDescriptions:function(){var b={},d;for(d in FB.XFBML.IframeWidget.allWidgetPipeIframes){var c=FB.XFBML.IframeWidget.allWidgetPipeIframes[d].getUrlBits(),e={widget:c.name};
FB.copy(e,c.params);b[d]=e}return b}});
FB.subclass("XFBML.Activity","XFBML.IframeWidget",null,{_visibleAfter:"load",_refreshOnAuthChange:!0,setupAndValidate:function(){this._attr={border_color:this.getAttribute("border-color"),colorscheme:this.getAttribute("color-scheme"),filter:this.getAttribute("filter"),action:this.getAttribute("action"),max_age:this.getAttribute("max_age"),font:this.getAttribute("font"),linktarget:this.getAttribute("linktarget","_blank"),header:this._getBoolAttribute("header"),height:this._getPxAttribute("height",
300),recommendations:this._getBoolAttribute("recommendations"),site:this.getAttribute("site",location.hostname),width:this._getPxAttribute("width",300)};return!0},getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:"activity",params:this._attr}}});
FB.subclass("XFBML.ButtonElement","XFBML.Element",null,{_allowedSizes:["icon","small","medium","large","xlarge"],onClick:function(){throw Error("Inheriting class needs to implement onClick().");},setupAndValidate:function(){return!0},getButtonMarkup:function(){return this.getOriginalHTML()},getOriginalHTML:function(){return this._originalHTML},process:function(){"_originalHTML"in this||(this._originalHTML=FB.String.trim(this.dom.innerHTML));if(this.setupAndValidate()){var b=this._getAttributeFromList("size",
"medium",this._allowedSizes),d="",c="";"icon"==b?d="fb_button_simple":(d=FB._localeIsRtl?"_rtl":"",c=this.getButtonMarkup(),d="fb_button"+d+" fb_button_"+b+d);""!==c&&(this.dom.innerHTML='<a class="'+d+'"><span class="fb_button_text">'+c+"</span></a>",this.dom.firstChild.onclick=FB.bind(this.onClick,this))}this.fire("render")}});
FB.subclass("XFBML.AddProfileTab","XFBML.ButtonElement",null,{getButtonMarkup:function(){return FB.Intl._tx("Add Profile Tab on Facebook")},onClick:function(){FB.ui({method:"profile.addtab"},this.bind(function(b){b.tab_added&&FB.Helper.invokeHandler(this.getAttribute("on-add"),this)}))}});
FB.subclass("XFBML.Facepile","XFBML.IframeWidget",null,{_visibleAfter:"load",_extraParams:{},setupAndValidate:function(){this._attr={href:this.getAttribute("href"),channel:this.getChannelUrl(),colorscheme:this.getAttribute("colorscheme","light"),max_rows:this.getAttribute("max-rows"),action:this.getAttribute("action","like"),tense:this.getAttribute("tense","past"),width:this._getPxAttribute("width",200),ref:this.getAttribute("ref"),size:this.getAttribute("size","small"),extended_social_context:this.getAttribute("extended_social_context",
!1),login_text:this.dom.innerHTML};this.clear();for(var b in this._extraParams)this._attr[b]=this._extraParams[b];return!0},setExtraParams:function(b){this._extraParams=b},oneTimeSetup:function(){var b=FB._userStatus;FB.Event.subscribe("auth.statusChange",FB.bind(function(d){("connected"==b||"connected"==d.status)&&this.process(!0);b=d.status},this))},getSize:function(){return"large"==this._attr.size?{width:this._attr.width,height:90}:{width:this._attr.width,height:70}},getUrlBits:function(){return{name:"facepile",
params:this._attr}}});FB.subclass("XFBML.AddToTimeline","XFBML.Facepile",null,{_visibleAfter:"load",getSize:function(){return{width:300,height:250}},getUrlBits:function(){return{name:"add_to_timeline",params:this._attr}}});FB.subclass("XFBML.Bookmark","XFBML.ButtonElement",null,{getButtonMarkup:function(){return FB.Intl._tx("Bookmark on Facebook")},onClick:function(){FB.ui({method:"bookmark.add"},this.bind(function(b){b.bookmarked&&FB.Helper.invokeHandler(this.getAttribute("on-add"),this)}))}});
FB.subclass("XFBML.Comments","XFBML.IframeWidget",null,{_visibleAfter:"immediate",_refreshOnAuthChange:!0,setupAndValidate:function(){var b={channel_url:this.getChannelUrl(),colorscheme:this.getAttribute("colorscheme"),numposts:this.getAttribute("num-posts",10),width:this._getPxAttribute("width",550),href:this.getAttribute("href"),permalink:this.getAttribute("permalink"),publish_feed:this.getAttribute("publish_feed"),mobile:this._getBoolAttribute("mobile")};FB.initSitevars.enableMobileComments&&(FB.UA.mobile()&&
!1!==b.mobile)&&(b.mobile=!0);if(b.href){var d=this.getAttribute("fb_comment_id");d||(d=FB.QS.decode(document.URL.substring(document.URL.indexOf("?")+1)).fb_comment_id)&&0<d.indexOf("#")&&(d=d.substring(0,d.indexOf("#")));d&&(b.fb_comment_id=d,this.subscribe("render",FB.bind(function(){window.location.hash=this.getIframeNode().id},this)))}else b.migrated=this.getAttribute("migrated"),b.xid=this.getAttribute("xid"),b.title=this.getAttribute("title",document.title),b.url=this.getAttribute("url",document.URL),
b.quiet=this.getAttribute("quiet"),b.reverse=this.getAttribute("reverse"),b.simple=this.getAttribute("simple"),b.css=this.getAttribute("css"),b.notify=this.getAttribute("notify"),b.xid||(d=document.URL.indexOf("#"),b.xid=0<d?encodeURIComponent(document.URL.substring(0,d)):encodeURIComponent(document.URL)),b.migrated&&(b.href="http://www.facebook.com/plugins/comments_v1.php?app_id="+FB._apiKey+"&xid="+encodeURIComponent(b.xid)+"&url="+encodeURIComponent(b.url));this._attr=b;return!0},oneTimeSetup:function(){this.subscribe("xd.addComment",
FB.bind(this._handleCommentMsg,this));this.subscribe("xd.commentCreated",FB.bind(this._handleCommentCreatedMsg,this));this.subscribe("xd.commentRemoved",FB.bind(this._handleCommentRemovedMsg,this))},getSize:function(){return this._attr.mobile?{width:"100%",height:160}:{width:this._attr.width,height:160}},getUrlBits:function(){return{name:"comments",params:this._attr}},getDefaultWebDomain:function(){return this._attr.mobile?"https_m":"https_www"},_handleCommentMsg:function(b){this.isValid()&&FB.Event.fire("comments.add",
{post:b.post,user:b.user,widget:this})},_handleCommentCreatedMsg:function(b){this.isValid()&&FB.Event.fire("comment.create",{href:b.href,commentID:b.commentID,parentCommentID:b.parentCommentID})},_handleCommentRemovedMsg:function(b){this.isValid()&&FB.Event.fire("comment.remove",{href:b.href,commentID:b.commentID})}});
FB.subclass("XFBML.CommentsCount","XFBML.Element",null,{process:function(){this._href=this.getAttribute("href",window.location.href);this._count=FB.Data._selectByIndex(["commentsbox_count"],"link_stat","url",this._href);FB.Dom.addCss(this.dom,"fb_comments_count_zero");this._count.wait(FB.bind(function(){var b=this._count.value[0].commentsbox_count;this.dom.innerHTML=FB.String.format('<span class="fb_comments_count">{0}</span>',b);0<b&&FB.Dom.removeCss(this.dom,"fb_comments_count_zero");this.fire("render")},
this))}});
FB.provide("Anim",{ate:function(b,d,c,e){c=!isNaN(parseFloat(c))&&0<=c?c:750;var f={},g={},h=null,k=setInterval(FB.bind(function(){h||(h=(new Date).getTime());var l=1;0!=c&&(l=Math.min(((new Date).getTime()-h)/c,1));FB.Array.forEach(d,FB.bind(function(c,e){if(!f[e]){var d=FB.Dom.getStyle(b,e);if(!1===d)return;f[e]=this._parseCSS(d+"")}g[e]||(g[e]=this._parseCSS(c.toString()));var h="";FB.Array.forEach(f[e],function(b,c){h=isNaN(g[e][c].numPart)&&"?"==g[e][c].textPart?b.numPart+b.textPart:isNaN(b.numPart)?
b.textPart:h+(b.numPart+Math.ceil((g[e][c].numPart-b.numPart)*Math.sin(Math.PI/2*l))+g[e][c].textPart+" ")});FB.Dom.setStyle(b,e,h)},this));1==l&&(clearInterval(k),e&&e(b))},this),40)},_parseCSS:function(b){var d=[];FB.Array.forEach(b.split(" "),function(b){var e=parseInt(b,10);d.push({numPart:e,textPart:b.replace(e,"")})});return d}});
FB.provide("Insights",{impression:function(b,d){var c="//ah8.facebook.com/impression.php/"+FB.guid()+"/",e=new Image(1,1),f=[];!b.api_key&&FB._apiKey&&(b.api_key=FB._apiKey);for(var g in b)f.push(encodeURIComponent(g)+"="+encodeURIComponent(b[g]));c+="?"+f.join("&");d&&(e.onload=d);e.src=c}});
FB.subclass("XFBML.ConnectBar","XFBML.Element",null,{_initialHeight:null,_initTopMargin:0,_picFieldName:"pic_square",_page:null,_displayed:!1,_notDisplayed:!1,_container:null,_animationSpeed:0,process:function(){FB.getLoginStatus(this.bind(function(b){FB.Event.monitor("auth.statusChange",this.bind(function(){this.isValid()&&"connected"==FB._userStatus?(this._uid=FB.Helper.getLoggedInUser(),FB.api({method:"Connect.shouldShowConnectBar"},this.bind(function(b){2!=b?(this._animationSpeed=0==b?750:0,this._showBar()):
this._noRender()}))):this._noRender();return!1}))}))},_showBar:function(){var b=FB.Data._selectByIndex(["first_name","profile_url",this._picFieldName],"user","uid",this._uid),d=FB.Data._selectByIndex(["display_name"],"application","api_key",FB._apiKey);FB.Data.waitOn([b,d],FB.bind(function(b){b[0][0].site_name=b[1][0].display_name;this._displayed||(this._displayed=!0,this._notDisplayed=!1,this._renderConnectBar(b[0][0]),this.fire("render"),FB.Insights.impression({lid:104,name:"widget_load"}),this.fire("connectbar.ondisplay"),
FB.Event.fire("connectbar.ondisplay",this),FB.Helper.invokeHandler(this.getAttribute("on-display"),this))},this))},_noRender:function(){this._displayed&&(this._displayed=!1,this._closeConnectBar());this._notDisplayed||(this._notDisplayed=!0,this.fire("render"),this.fire("connectbar.onnotdisplay"),FB.Event.fire("connectbar.onnotdisplay",this),FB.Helper.invokeHandler(this.getAttribute("on-not-display"),this))},_renderConnectBar:function(b){var d=document.createElement("div"),c=document.createElement("div");
d.className="fb_connect_bar";c.className="fb_reset fb_connect_bar_container";c.appendChild(d);document.body.appendChild(c);this._container=c;this._initialHeight=Math.round(parseFloat(FB.Dom.getStyle(c,"height"))+parseFloat(FB.Dom.getStyle(c,"borderBottomWidth")));d.innerHTML=FB.String.format('<div class="fb_buttons"><a href="#" class="fb_bar_close"><img src="{1}" alt="{2}" title="{2}"/></a></div><a href="{7}" class="fb_profile" target="_blank"><img src="{3}" alt="{4}" title="{4}"/></a>{5} <span><a href="{8}" class="fb_learn_more" target="_blank">{6}</a> &ndash; <a href="#" class="fb_no_thanks">{0}</a></span>',
FB.Intl._tx("No Thanks"),FB.getDomain("cdn")+FB.XFBML.ConnectBar.imgs.buttonUrl,FB.Intl._tx("Close"),b[this._picFieldName]||FB.getDomain("cdn")+FB.XFBML.ConnectBar.imgs.missingProfileUrl,FB.String.escapeHTML(b.first_name),FB.Intl._tx("Hi {firstName}. <strong>{siteName}</strong> is using Facebook to personalize your experience.",{firstName:FB.String.escapeHTML(b.first_name),siteName:FB.String.escapeHTML(b.site_name)}),FB.Intl._tx("Learn More"),b.profile_url,FB.getDomain("www")+"sitetour/connect.php");
var e=this;FB.Array.forEach(d.getElementsByTagName("a"),function(b){b.onclick=FB.bind(e._clickHandler,e)});this._page=document.body;b=0;b=this._page.parentNode?Math.round((parseFloat(FB.Dom.getStyle(this._page.parentNode,"height"))-parseFloat(FB.Dom.getStyle(this._page,"height")))/2):parseInt(FB.Dom.getStyle(this._page,"marginTop"),10);this._initTopMargin=b=isNaN(b)?0:b;window.XMLHttpRequest?(c.style.top=-1*this._initialHeight+"px",FB.Anim.ate(c,{top:"0px"},this._animationSpeed)):c.className+=" fb_connect_bar_container_ie6";
c={marginTop:this._initTopMargin+this._initialHeight+"px"};FB.UA.ie()?c.backgroundPositionY=this._initialHeight+"px":c.backgroundPosition="? "+this._initialHeight+"px";FB.Anim.ate(this._page,c,this._animationSpeed)},_clickHandler:function(b){b=b||window.event;for(b=b.target||b.srcElement;"A"!=b.nodeName;)b=b.parentNode;switch(b.className){case "fb_bar_close":FB.api({method:"Connect.connectBarMarkAcknowledged"});FB.Insights.impression({lid:104,name:"widget_user_closed"});this._closeConnectBar();break;
case "fb_learn_more":case "fb_profile":window.open(b.href);break;case "fb_no_thanks":this._closeConnectBar(),FB.api({method:"Connect.connectBarMarkAcknowledged"}),FB.Insights.impression({lid:104,name:"widget_user_no_thanks"}),FB.api({method:"auth.revokeAuthorization",block:!0},this.bind(function(){this.fire("connectbar.ondeauth");FB.Event.fire("connectbar.ondeauth",this);FB.Helper.invokeHandler(this.getAttribute("on-deauth"),this);this._getBoolAttribute("auto-refresh",!0)&&window.location.reload()}))}return!1},
_closeConnectBar:function(){this._notDisplayed=!0;var b={marginTop:this._initTopMargin+"px"};FB.UA.ie()?b.backgroundPositionY="0px":b.backgroundPosition="? 0px";var d=0==this._animationSpeed?0:300;FB.Anim.ate(this._page,b,d);FB.Anim.ate(this._container,{top:-1*this._initialHeight+"px"},d,function(b){b.parentNode.removeChild(b)});this.fire("connectbar.onclose");FB.Event.fire("connectbar.onclose",this);FB.Helper.invokeHandler(this.getAttribute("on-close"),this)}});
FB.provide("XFBML.ConnectBar",{imgs:{buttonUrl:"images/facebook-widgets/close_btn.png",missingProfileUrl:"pics/q_silhouette.gif"}});
FB.subclass("XFBML.Fan","XFBML.IframeWidget",null,{_visibleAfter:"load",setupAndValidate:function(){this._attr={api_key:FB._apiKey,connections:this.getAttribute("connections","10"),css:this.getAttribute("css"),height:this._getPxAttribute("height"),id:this.getAttribute("profile-id"),logobar:this._getBoolAttribute("logo-bar"),name:this.getAttribute("name"),stream:this._getBoolAttribute("stream",!0),width:this._getPxAttribute("width",300)};if(!this._attr.id&&!this._attr.name)return FB.log('<fb:fan> requires one of the "id" or "name" attributes.'),
!1;var b=this._attr.height;b||(b=(!this._attr.connections||"0"===this._attr.connections)&&!this._attr.stream?65:!this._attr.connections||"0"===this._attr.connections?375:this._attr.stream?550:250);this._attr.logobar&&(b+=25);this._attr.height=b;return!0},getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:"fan",params:this._attr}}});FB.subclass("XFBML.Friendpile","XFBML.Facepile",null,{});
FB.subclass("XFBML.EdgeCommentWidget","XFBML.IframeWidget",function(b){this._iframeWidth=b.width+1;this._iframeHeight=b.height;this._attr={master_frame_name:b.masterFrameName};this.dom=b.commentNode;this.dom.style.top=b.relativeHeightOffset;b.relativeWidthOffset&&(FB._localeIsRtl?this.dom.style.right=b.relativeWidthOffset:this.dom.style.left=b.relativeWidthOffset);this.dom.style.zIndex=FB.XFBML.EdgeCommentWidget.NextZIndex++;FB.Dom.addCss(this.dom,"fb_edge_comment_widget")},{_visibleAfter:"load",
_showLoader:!1,getSize:function(){return{width:this._iframeWidth,height:this._iframeHeight}},getUrlBits:function(){return{name:"comment_widget_shell",params:this._attr}}});FB.provide("XFBML.EdgeCommentWidget",{NextZIndex:1E4});
FB.subclass("XFBML.EdgeWidget","XFBML.IframeWidget",null,{_visibleAfter:"immediate",_showLoader:!1,setupAndValidate:function(){FB.Dom.addCss(this.dom,"fb_edge_widget_with_comment");this._attr={channel_url:this.getChannelUrl(),debug:this._getBoolAttribute("debug"),href:this.getAttribute("href",window.location.href),is_permalink:this._getBoolAttribute("is-permalink"),node_type:this.getAttribute("node-type","link"),width:this._getWidgetWidth(),font:this.getAttribute("font"),layout:this._getLayout(),
colorscheme:this.getAttribute("color-scheme"),action:this.getAttribute("action"),ref:this.getAttribute("ref"),show_faces:this._shouldShowFaces(),no_resize:this._getBoolAttribute("no_resize"),send:this._getBoolAttribute("send"),url_map:this.getAttribute("url_map"),extended_social_context:this._getBoolAttribute("extended_social_context",!1)};return!0},oneTimeSetup:function(){this.subscribe("xd.authPrompted",FB.bind(this._onAuthPrompt,this));this.subscribe("xd.edgeCreated",FB.bind(this._onEdgeCreate,
this));this.subscribe("xd.edgeRemoved",FB.bind(this._onEdgeRemove,this));this.subscribe("xd.presentEdgeCommentDialog",FB.bind(this._handleEdgeCommentDialogPresentation,this));this.subscribe("xd.dismissEdgeCommentDialog",FB.bind(this._handleEdgeCommentDialogDismissal,this));this.subscribe("xd.hideEdgeCommentDialog",FB.bind(this._handleEdgeCommentDialogHide,this));this.subscribe("xd.showEdgeCommentDialog",FB.bind(this._handleEdgeCommentDialogShow,this))},getSize:function(){return{width:this._getWidgetWidth(),
height:this._getWidgetHeight()}},_getWidgetHeight:function(){var b=this._getLayout(),d=this._shouldShowFaces()?"show":"hide",c=65+(this._getBoolAttribute("send")?25:0);return{standard:{show:80,hide:35},box_count:{show:c,hide:c},button_count:{show:21,hide:21},simple:{show:20,hide:20}}[b][d]},_getWidgetWidth:function(){var b=this._getLayout(),d=this._getBoolAttribute("send"),c=this._shouldShowFaces()?"show":"hide",e="recommend"===this.getAttribute("action"),f=(e?265:225)+(d?60:0),d=(e?130:90)+(d?60:
0),e="recommend"===this.getAttribute("action")?100:55,g="recommend"===this.getAttribute("action")?90:50,c=this._getPxAttribute("width",{standard:{show:450,hide:450},box_count:{show:e,hide:e},button_count:{show:d,hide:d},simple:{show:g,hide:g}}[b][c]),f={standard:{min:f,max:900},box_count:{min:e,max:900},button_count:{min:d,max:900},simple:{min:49,max:900}};c<f[b].min?c=f[b].min:c>f[b].max&&(c=f[b].max);return c},_getLayout:function(){return this._getAttributeFromList("layout","standard",["standard",
"button_count","box_count","simple"])},_shouldShowFaces:function(){return"standard"===this._getLayout()&&this._getBoolAttribute("show-faces",!0)},_handleEdgeCommentDialogPresentation:function(b){if(this.isValid()){var d=document.createElement("span");this._commentSlave=this._createEdgeCommentWidget(b,d);this.dom.appendChild(d);this._commentSlave.process();this._commentWidgetNode=d}},_createEdgeCommentWidget:function(b,d){var c={commentNode:d,externalUrl:b.externalURL,width:400,height:225,masterFrameName:b.masterFrameName,
layout:this._getLayout(),relativeHeightOffset:this._getHeightOffset(b),relativeWidthOffset:this._getWidthOffset(b)};return new FB.XFBML.EdgeCommentWidget(c)},_getHeightOffset:function(b){return b&&b.preComputedHeightOffset?parseInt(b.preComputedHeightOffset,10)+"px":{standard:"22px",button_count:"19px",box_count:"-5px",simple:"18px"}[this._getLayout()]},_getCommonEdgeCommentWidgetOpts:function(b,d,c,e){return{colorscheme:this._attr.colorscheme,commentNode:d,controllerID:b.controllerID,nodeImageURL:b.nodeImageURL,
nodeRef:this._attr.ref,nodeTitle:b.nodeTitle,nodeURL:b.nodeURL,nodeSummary:b.nodeSummary,width:400,height:300,relativeHeightOffset:e?this._getHeightOffset(b):this._getHeightOffset(),relativeWidthOffset:c?this._getWidthOffset(b):this._getWidthOffset(),error:b.error,siderender:b.siderender,extended_social_context:b.extended_social_context}},_getWidthOffset:function(b){return b&&b.preComputedWidthOffset?parseInt(b.preComputedWidthOffset,10)+"px":{standard:"0px",box_count:"0px",button_count:"0px",simple:"0px"}[this._getLayout()]},
_handleEdgeCommentDialogDismissal:function(b){this._commentWidgetNode&&(this.dom.removeChild(this._commentWidgetNode),delete this._commentWidgetNode)},_handleEdgeCommentDialogHide:function(){this._commentWidgetNode&&(this._commentWidgetNode.style.display="none")},_handleEdgeCommentDialogShow:function(){this._commentWidgetNode&&(this._commentWidgetNode.style.display="block")},_fireEventAndInvokeHandler:function(b,d){FB.Helper.fireEvent(b,this);FB.Helper.invokeHandler(this.getAttribute(d),this,[this._attr.href])},
_onEdgeCreate:function(){this._fireEventAndInvokeHandler("edge.create","on-create")},_onEdgeRemove:function(){this._fireEventAndInvokeHandler("edge.remove","on-remove")},_onAuthPrompt:function(){this._fireEventAndInvokeHandler("auth.prompt","on-prompt")}});
FB.subclass("XFBML.SendButtonFormWidget","XFBML.EdgeCommentWidget",function(b){this._base(b);FB.Dom.addCss(this.dom,"fb_send_button_form_widget");FB.Dom.addCss(this.dom,b.colorscheme);FB.Dom.addCss(this.dom,"undefined"!=typeof b.siderender&&b.siderender?"siderender":"");this._attr.nodeImageURL=b.nodeImageURL;this._attr.nodeRef=b.nodeRef;this._attr.nodeTitle=b.nodeTitle;this._attr.nodeURL=b.nodeURL;this._attr.nodeSummary=b.nodeSummary;this._attr.channel=this.getChannelUrl();this._attr.controllerID=
b.controllerID;this._attr.colorscheme=b.colorscheme;this._attr.error=b.error;this._attr.siderender=b.siderender;this._attr.extended_social_context=b.extended_social_context},{_showLoader:!0,getUrlBits:function(){return{name:"send_button_form_shell",params:this._attr}},oneTimeSetup:function(){this.subscribe("xd.messageSent",FB.bind(this._onMessageSent,this))},_onMessageSent:function(){FB.Event.fire("message.send",this._attr.nodeURL,this)}});
FB.subclass("XFBML.Send","XFBML.EdgeWidget",null,{setupAndValidate:function(){FB.Dom.addCss(this.dom,"fb_edge_widget_with_comment");this._attr={channel:this.getChannelUrl(),api_key:FB._apiKey,font:this.getAttribute("font"),colorscheme:this.getAttribute("colorscheme","light"),href:this.getAttribute("href",window.location.href),ref:this.getAttribute("ref"),extended_social_context:this.getAttribute("extended_social_context",!1)};return!0},getUrlBits:function(){return{name:"send",params:this._attr}},
_createEdgeCommentWidget:function(b,d){var c=this._getCommonEdgeCommentWidgetOpts(b,d);return new FB.XFBML.SendButtonFormWidget(c)},_getHeightOffset:function(){return"21px"},_getWidthOffset:function(){return"0px"},getSize:function(){return{width:FB.XFBML.Send.Dimensions.width,height:FB.XFBML.Send.Dimensions.height}}});FB.provide("XFBML.Send",{Dimensions:{width:80,height:25}});
FB.subclass("XFBML.Like","XFBML.EdgeWidget",null,{_widgetPipeEnabled:!0,getUrlBits:function(){return{name:"like",params:this._attr}},_createEdgeCommentWidget:function(b,d){if("send"in this._attr&&"widget_type"in b&&"send"==b.widget_type){var c=this._getCommonEdgeCommentWidgetOpts(b,d,!0,!0);return new FB.XFBML.SendButtonFormWidget(c)}return this._callBase("_createEdgeCommentWidget",b,d)},getIframeTitle:function(){return"Like this content on Facebook."}});
FB.subclass("XFBML.LikeBox","XFBML.EdgeWidget",null,{_visibleAfter:"load",setupAndValidate:function(){this._attr={channel:this.getChannelUrl(),api_key:FB._apiKey,connections:this.getAttribute("connections"),css:this.getAttribute("css"),height:this.getAttribute("height"),id:this.getAttribute("profile-id"),header:this._getBoolAttribute("header",!0),name:this.getAttribute("name"),show_faces:this._getBoolAttribute("show-faces",!0),stream:this._getBoolAttribute("stream",!0),width:this._getPxAttribute("width",
300),href:this.getAttribute("href"),colorscheme:this.getAttribute("colorscheme","light"),border_color:this.getAttribute("border_color")};this._getBoolAttribute("force_wall",!1)&&(this._attr.force_wall=!0);"0"===this._attr.connections?this._attr.show_faces=!1:this._attr.connections&&(this._attr.show_faces=!0);if(!this._attr.id&&!this._attr.name&&!this._attr.href)return FB.log('<fb:like-box> requires one of the "id" or "name" attributes.'),!1;var b=this._attr.height;b||(!this._attr.show_faces&&!this._attr.stream?
b=62:(b=95,this._attr.show_faces&&(b+=163),this._attr.stream&&(b+=300),this._attr.header&&"0"!==this._attr.header&&(b+=32)));this._attr.height=b;this.subscribe("xd.likeboxLiked",FB.bind(this._onLiked,this));this.subscribe("xd.likeboxUnliked",FB.bind(this._onUnliked,this));return!0},getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:"likebox",params:this._attr}},_onLiked:function(){FB.Helper.fireEvent("edge.create",this)},_onUnliked:function(){FB.Helper.fireEvent("edge.remove",
this)}});
FB.subclass("XFBML.LiveStream","XFBML.IframeWidget",null,{_visibleAfter:"load",setupAndValidate:function(){this._attr={app_id:this.getAttribute("event-app-id"),height:this._getPxAttribute("height",500),hideFriendsTab:this.getAttribute("hide-friends-tab"),redesigned:this._getBoolAttribute("redesigned-stream"),width:this._getPxAttribute("width",400),xid:this.getAttribute("xid","default"),always_post_to_friends:this._getBoolAttribute("always-post-to-friends",!1),via_url:this.getAttribute("via_url")};return!0},
getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:this._attr.redesigned?"live_stream_box":"livefeed",params:this._attr}}});FB.subclass("XFBML.Login","XFBML.Facepile",null,{_visibleAfter:"load",getSize:function(){return{width:this._attr.width,height:94}},getUrlBits:function(){return{name:"login",params:this._attr}}});
FB.subclass("XFBML.LoginButton","XFBML.ButtonElement",null,{setupAndValidate:function(){if(this._alreadySetup)return!0;this._alreadySetup=!0;this._attr={autologoutlink:this._getBoolAttribute("auto-logout-link"),length:this._getAttributeFromList("length","short",["long","short"]),onlogin:this.getAttribute("on-login"),perms:this.getAttribute("perms"),scope:this.getAttribute("scope"),registration_url:this.getAttribute("registration-url"),status:"unknown"};this._attr.autologoutlink&&FB.Event.subscribe("auth.statusChange",
FB.bind(this.process,this));this._attr.registration_url&&(FB.Event.subscribe("auth.statusChange",this._saveStatus(this.process,!1)),FB.getLoginStatus(this._saveStatus(this.process,!1)));return!0},getButtonMarkup:function(){var b=this.getOriginalHTML();if(b)return b;if(this._attr.registration_url)switch(this._attr.status){case "unknown":return this._getLoginText();case "notConnected":case "not_authorized":return FB.Intl._tx("Register");case "connected":return FB.getAccessToken()&&this._attr.autologoutlink?
FB.Intl._tx("Facebook Logout"):"";default:return FB.log("Unknown status: "+this._attr.status),FB.Intl._tx("Log In")}else return FB.getAccessToken()&&this._attr.autologoutlink?FB.Intl._tx("Facebook Logout"):FB.getAccessToken()?"":this._getLoginText()},_getLoginText:function(){return"short"==this._attr.length?FB.Intl._tx("Log In"):FB.Intl._tx("Log In with Facebook")},onClick:function(){if(this._attr.registration_url)switch(this._attr.status){case "unknown":FB.ui({method:"auth.logintoFacebook"},FB.bind(function(b){FB.bind(FB.getLoginStatus(this._saveStatus(this._authCallback,
!0),!0),this)},this));break;case "notConnected":case "not_authorized":window.top.location=this._attr.registration_url;break;case "connected":!FB.getAccessToken()||!this._attr.autologoutlink?this._authCallback():FB.logout(FB.bind(this._authCallback,this));break;default:FB.log("Unknown status: "+this._attr.status)}else!FB.getAccessToken()||!this._attr.autologoutlink?FB.login(FB.bind(this._authCallback,this),{perms:this._attr.perms,scope:this._attr.scope}):FB.logout(FB.bind(this._authCallback,this))},
_authCallback:function(b){FB.Helper.invokeHandler(this._attr.onlogin,this,[b])},_saveStatus:function(b,d){return FB.bind(function(c){if(d&&this._attr.registration_url&&("notConnected"==this._attr.status||"not_authorized"==this._attr.status)&&("notConnected"==c.status||"not_authorized"==c.status))window.top.location=this._attr.registration_url;this._attr.status=c.status;if(b)return b=this.bind(b,this),b(c)},this)}});
FB.subclass("XFBML.Name","XFBML.Element",null,{process:function(){FB.copy(this,{_uid:this.getAttribute("uid"),_firstnameonly:this._getBoolAttribute("first-name-only"),_lastnameonly:this._getBoolAttribute("last-name-only"),_possessive:this._getBoolAttribute("possessive"),_reflexive:this._getBoolAttribute("reflexive"),_objective:this._getBoolAttribute("objective"),_linked:this._getBoolAttribute("linked",!0),_subjectId:this.getAttribute("subject-id")});if(this._uid){var b=[];this._firstnameonly?b.push("first_name"):
this._lastnameonly?b.push("last_name"):b.push("name");this._subjectId&&(b.push("sex"),this._subjectId==FB.Helper.getLoggedInUser()&&(this._reflexive=!0));var d;FB.Event.monitor("auth.statusChange",this.bind(function(){if(!this.isValid())return this.fire("render"),!0;if(!this._uid||"loggedinuser"==this._uid)this._uid=FB.Helper.getLoggedInUser();this._uid&&(d=FB.Helper.isUser(this._uid)?FB.Data._selectByIndex(b,"user","uid",this._uid):FB.Data._selectByIndex(["name","id"],"profile","id",this._uid),d.wait(this.bind(function(b){this._subjectId==
this._uid?this._renderPronoun(b[0]):this._renderOther(b[0]);this.fire("render")})))}))}else FB.log('"uid" is a required attribute for <fb:name>'),this.fire("render")},_renderPronoun:function(b){var d="",d=this._objective;this._subjectId&&(d=!0,this._subjectId===this._uid&&(this._reflexive=!0));if(this._uid==FB.Connect.get_loggedInUser()&&this._getBoolAttribute("use-you",!0))d=this._possessive?this._reflexive?"your own":"your":this._reflexive?"yourself":"you";else switch(b.sex){case "male":d=this._possessive?
this._reflexive?"his own":"his":this._reflexive?"himself":d?"him":"he";break;case "female":d=this._possessive?this._reflexive?"her own":"her":this._reflexive?"herself":d?"her":"she";break;default:d=this._getBoolAttribute("use-they",!0)?this._possessive?this._reflexive?"their own":"their":this._reflexive?"themselves":d?"them":"they":this._possessive?this._reflexive?"his/her own":"his/her":this._reflexive?"himself/herself":d?"him/her":"he/she"}this._getBoolAttribute("capitalize",!1)&&(d=FB.Helper.upperCaseFirstChar(d));
this.dom.innerHTML=d},_renderOther:function(b){var d="",c="";this._uid==FB.Helper.getLoggedInUser()&&this._getBoolAttribute("use-you",!0)?d=this._reflexive?this._possessive?"your own":"yourself":this._possessive?"your":"you":b&&(null===b.first_name&&(b.first_name=""),null===b.last_name&&(b.last_name=""),this._firstnameonly&&void 0!==b.first_name?d=FB.String.escapeHTML(b.first_name):this._lastnameonly&&void 0!==b.last_name&&(d=FB.String.escapeHTML(b.last_name)),d||(d=FB.String.escapeHTML(b.name)),
""!==d&&this._possessive&&(d+="'s"));d||(d=FB.String.escapeHTML(this.getAttribute("if-cant-see","Facebook User")));d&&(this._getBoolAttribute("capitalize",!1)&&(d=FB.Helper.upperCaseFirstChar(d)),c=b&&this._linked?FB.Helper.getProfileLink(b,d,this.getAttribute("href",null)):d);this.dom.innerHTML=c}});
FB.subclass("XFBML.ProfilePic","XFBML.Element",null,{process:function(){var b=this.getAttribute("size","thumb"),d=FB.XFBML.ProfilePic._sizeToPicFieldMap[b],c=this._getPxAttribute("width"),e=this._getPxAttribute("height"),b=this.dom.style,f=this.getAttribute("uid");this._getBoolAttribute("facebook-logo")&&(d+="_with_logo");c&&(c+="px",b.width=c);e&&(e+="px",b.height=e);var g=this.bind(function(b){var f=(b=b?b[0]:null)?b[d]:null;f||(f=FB.getDomain("cdn")+FB.XFBML.ProfilePic._defPicMap[d]);var g=(c?
"width:"+c+";":"")+(e?"height:"+c+";":""),f=FB.String.format('<img src="{0}" alt="{1}" title="{1}" style="{2}" class="{3}" />',f,b?FB.String.escapeHTML(b.name):"",g,this.dom.className);this._getBoolAttribute("linked",!0)&&(f=FB.Helper.getProfileLink(b,f,this.getAttribute("href",null)));this.dom.innerHTML=f;FB.Dom.addCss(this.dom,"fb_profile_pic_rendered");this.fire("render")});FB.Event.monitor("auth.statusChange",this.bind(function(){if(!this.isValid())return this.fire("render"),!0;"loggedinuser"==
this.getAttribute("uid",null)&&(f=FB.Helper.getLoggedInUser());FB._userStatus&&f?FB.Data._selectByIndex(["name",d],FB.Helper.isUser(f)?"user":"profile",FB.Helper.isUser(f)?"uid":"id",f).wait(g):g()}))}});
FB.provide("XFBML.ProfilePic",{_defPicMap:{pic:"pics/s_silhouette.jpg",pic_big:"pics/d_silhouette.gif",pic_big_with_logo:"pics/d_silhouette_logo.gif",pic_small:"pics/t_silhouette.jpg",pic_small_with_logo:"pics/t_silhouette_logo.gif",pic_square:"pics/q_silhouette.gif",pic_square_with_logo:"pics/q_silhouette_logo.gif",pic_with_logo:"pics/s_silhouette_logo.gif"},_sizeToPicFieldMap:{n:"pic_big",normal:"pic_big",q:"pic_square",s:"pic",small:"pic",square:"pic_square",t:"pic_small",thumb:"pic_small"}});
FB.subclass("XFBML.Question","XFBML.IframeWidget",null,{_visibleAfter:"load",setupAndValidate:function(){this._attr={channel:this.getChannelUrl(),api_key:FB._apiKey,permalink:this.getAttribute("permalink"),id:this.getAttribute("id"),width:this._getPxAttribute("width",400),height:0,questiontext:this.getAttribute("questiontext"),options:this.getAttribute("options")};this.subscribe("xd.firstVote",FB.bind(this._onInitialVote,this));this.subscribe("xd.vote",FB.bind(this._onChangedVote,this));return!0},
getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:"question",params:this._attr}},_onInitialVote:function(b){FB.Event.fire("question.firstVote",this._attr.permalink,b.vote)},_onChangedVote:function(b){FB.Event.fire("question.vote",this._attr.permalink,b.vote)}});
FB.subclass("XFBML.Recommendations","XFBML.IframeWidget",null,{_visibleAfter:"load",_refreshOnAuthChange:!0,setupAndValidate:function(){this._attr={border_color:this.getAttribute("border-color"),colorscheme:this.getAttribute("color-scheme"),filter:this.getAttribute("filter"),font:this.getAttribute("font"),action:this.getAttribute("action"),linktarget:this.getAttribute("linktarget","_blank"),max_age:this.getAttribute("max_age"),header:this._getBoolAttribute("header"),height:this._getPxAttribute("height",
300),site:this.getAttribute("site",location.hostname),width:this._getPxAttribute("width",300)};return!0},getSize:function(){return{width:this._attr.width,height:this._attr.height}},getUrlBits:function(){return{name:"recommendations",params:this._attr}}});
FB.subclass("XFBML.RecommendationsBar","XFBML.IframeWidget",null,{getUrlBits:function(){return{name:"recommendations_bar",params:this._attr}},setupAndValidate:function(){function b(b,c){function e(){c();f=null;d=(new Date).getTime()}var d=0,f=null;return function(){if(!f){var c=(new Date).getTime();c-d<b?f=window.setTimeout(e,b-(c-d)):e()}return!0}}this._attr={channel:this.getChannelUrl(),api_key:FB._apiKey,font:this.getAttribute("font"),colorscheme:this.getAttribute("colorscheme"),href:FB.URI.resolve(this.getAttribute("href")),
side:function(b){return"left"==b||"right"==b?b:FB._localeIsRtl?"left":"right"}(this.getAttribute("side")),site:this.getAttribute("site"),action:this.getAttribute("action"),ref:this.getAttribute("ref"),trigger:function(b){b.match(/^\d+(?:\.\d+)?%$/)?b=Math.min(Math.max(parseInt(b,10),0),100)/100:"manual"!=b&&"onvisible"!=b&&(b="onvisible");return b}(this.getAttribute("trigger","")),read_time:function(b){return Math.max(parseInt(b,10)||30,10)}(this.getAttribute("read_time")),num_recommendations:function(b){return parseInt(b,
10)||2}(this.getAttribute("num_recommendations"))};FB._inPlugin=!0;this._showLoader=!1;this.subscribe("iframe.onload",FB.bind(function(){this.dom.children[0].className="fbpluginrecommendationsbar"+this._attr.side},this));var d=FB.bind(function(){FB.Event.unlisten(window,"scroll",d);FB.Event.unlisten(document.documentElement,"click",d);FB.Event.unlisten(document.documentElement,"mousemove",d);window.setTimeout(FB.bind(this.arbiterInform,this,"platform/plugins/recommendations_bar/action",null,FB.Arbiter.BEHAVIOR_STATE),
1E3*this._attr.read_time);return!0},this);FB.Event.listen(window,"scroll",d);FB.Event.listen(document.documentElement,"click",d);FB.Event.listen(document.documentElement,"mousemove",d);if("manual"==this._attr.trigger){var c=FB.bind(function(b){b==this._attr.href&&(FB.Event.unsubscribe("xfbml.recommendationsbar.read",c),this.arbiterInform("platform/plugins/recommendations_bar/trigger",null,FB.Arbiter.BEHAVIOR_STATE));return!0},this);FB.Event.subscribe("xfbml.recommendationsbar.read",c)}else{var e=
b(500,FB.bind(function(){this.calculateVisibility()&&(FB.Event.unlisten(window,"scroll",e),FB.Event.unlisten(window,"resize",e),this.arbiterInform("platform/plugins/recommendations_bar/trigger",null,FB.Arbiter.BEHAVIOR_STATE));return!0},this));FB.Event.listen(window,"scroll",e);FB.Event.listen(window,"resize",e);e()}this.visible=!1;var f=b(500,FB.bind(function(){!this.visible&&this.calculateVisibility()?(this.visible=!0,this.arbiterInform("platform/plugins/recommendations_bar/visible")):this.visible&&
!this.calculateVisibility()&&(this.visible=!1,this.arbiterInform("platform/plugins/recommendations_bar/invisible"));return!0},this));FB.Event.listen(window,"scroll",f);FB.Event.listen(window,"resize",f);f();this.focused=!0;f=FB.bind(function(){this.focused=!this.focused;return!0},this);FB.Event.listen(window,"blur",f);FB.Event.listen(window,"focus",f);this.animate=this.resize_running=!1;this.subscribe("xd.signal_animation",FB.bind(function(){this.animate=!0},this));return!0},getSize:function(){return{height:25,
width:"recommend"==this._attr.action?140:96}},calculateVisibility:function(){var b=document.documentElement.clientHeight;if(!this.focused&&window.console&&window.console.firebug)return this.visible;switch(this._attr.trigger){case "manual":return!1;case "onvisible":return this.dom.getBoundingClientRect().top<=b;default:return((window.pageYOffset||document.body.scrollTop)+b)/document.documentElement.scrollHeight>=this._attr.trigger}},_handleResizeMsg:function(b){this.isValid()&&(b.width&&(this.getIframeNode().style.width=
b.width+"px"),b.height&&(this._setNextResize(b.height),this._checkNextResize()),this._makeVisible())},_setNextResize:function(b){this.next_resize=b},_checkNextResize:function(){if(this.next_resize&&!this.resize_running){var b=this.getIframeNode(),d=this.next_resize;this.next_resize=null;this.animate?(this.animate=!1,this.resize_running=!0,FB.Anim.ate(b,{height:d+"px"},330,FB.bind(function(){this.resize_running=!1;this._checkNextResize()},this))):b.style.height=d+"px"}}});
FB.XFBML.RecommendationsBar.markRead=function(b){FB.Event.fire("xfbml.recommendationsbar.read",b||window.location.href)};
FB.subclass("XFBML.Registration","XFBML.IframeWidget",null,{_visibleAfter:"immediate",_baseHeight:167,_fieldHeight:28,_skinnyWidth:520,_skinnyBaseHeight:173,_skinnyFieldHeight:52,setupAndValidate:function(){this._attr={action:this.getAttribute("action"),border_color:this.getAttribute("border-color"),channel_url:this.getChannelUrl(),client_id:FB._apiKey,fb_only:this._getBoolAttribute("fb-only",!1),fb_register:this._getBoolAttribute("fb-register",!1),fields:this.getAttribute("fields"),height:this._getPxAttribute("height"),
redirect_uri:this.getAttribute("redirect-uri",window.location.href),no_footer:this._getBoolAttribute("no-footer"),no_header:this._getBoolAttribute("no-header"),onvalidate:this.getAttribute("onvalidate"),width:this._getPxAttribute("width",600),target:this.getAttribute("target")};this._attr.onvalidate&&this.subscribe("xd.validate",this.bind(function(b){var d=FB.JSON.parse(b.value),c=this.bind(function(c){FB.Arbiter.inform("Registration.Validation",{errors:c,id:b.id},'parent.frames["'+this.getIframeNode().name+
'"]',"https"==this._attr.channel_url.substring(0,5))});(d=FB.Helper.executeFunctionByName(this._attr.onvalidate,d,c))&&c(d)}));this.subscribe("xd.authLogin",FB.bind(this._onAuthLogin,this));this.subscribe("xd.authLogout",FB.bind(this._onAuthLogout,this));return!0},getSize:function(){return{width:this._attr.width,height:this._getHeight()}},_getHeight:function(){if(this._attr.height)return this._attr.height;var b;if(this._attr.fields)try{b=FB.JSON.parse(this._attr.fields)}catch(d){b=this._attr.fields.split(/,/)}else b=
["name"];return this._attr.width<this._skinnyWidth?this._skinnyBaseHeight+b.length*this._skinnyFieldHeight:this._baseHeight+b.length*this._fieldHeight},getUrlBits:function(){return{name:"registration",params:this._attr}},getDefaultWebDomain:function(){return"https_www"},_onAuthLogin:function(){FB.getAuthResponse()||FB.getLoginStatus();FB.Helper.fireEvent("auth.login",this)},_onAuthLogout:function(){FB.getAuthResponse()||FB.getLoginStatus();FB.Helper.fireEvent("auth.logout",this)}});
FB.subclass("XFBML.ServerFbml","XFBML.IframeWidget",null,{_visibleAfter:"resize",setupAndValidate:function(){this._attr={channel_url:this.getChannelUrl(),fbml:this.getAttribute("fbml"),width:this._getPxAttribute("width")};if(!this._attr.fbml){var b=this.dom.getElementsByTagName("script")[0];b&&"text/fbml"===b.type&&(this._attr.fbml=b.innerHTML)}return!this._attr.fbml?(FB.log('<fb:serverfbml> requires the "fbml" attribute.'),!1):!0},getSize:function(){return{width:this._attr.width,height:this._attr.height}},
getUrlBits:function(){return{name:"serverfbml",params:this._attr}}});
FB.subclass("XFBML.ShareButton","XFBML.Element",null,{process:function(){this._href=this.getAttribute("href",window.location.href);this._type=this.getAttribute("type","icon_link");FB.Dom.addCss(this.dom,"fb_share_count_hidden");this._renderButton(!0)},_renderButton:function(b){if(this.isValid()){var d="",c="",e="",f="",d=FB.Intl._tx("Share"),g="";switch(this._type){case "icon":case "icon_link":f="fb_button_simple";d='<span class="fb_button_text">'+("icon_link"==this._type?d:"&nbsp;")+"</span>";b=
!1;break;case "link":d=FB.Intl._tx("Share on Facebook");b=!1;break;case "button":d='<span class="fb_button_text">'+d+"</span>";f="fb_button fb_button_small";b=!1;break;case "button_count":d='<span class="fb_button_text">'+d+"</span>";c='<span class="fb_share_count_nub_right">&nbsp;</span><span class="fb_share_count fb_share_count_right">'+this._getCounterMarkup()+"</span>";f="fb_button fb_button_small";break;default:d='<span class="fb_button_text">'+d+"</span>",e='<span class="fb_share_count_nub_top">&nbsp;</span><span class="fb_share_count fb_share_count_top">'+
this._getCounterMarkup()+"</span>",f="fb_button fb_button_small",g="fb_share_count_wrapper"}var h=FB.guid();this.dom.innerHTML=FB.String.format('<span class="{0}">{4}<a id="{1}" class="{2}" target="_blank">{3}</a>{5}</span>',g,h,f,d,e,c);c=document.getElementById(h);c.href=this._href;c.onclick=function(){FB.ui({method:"stream.share",u:this.href});return!1};b||this.fire("render")}else this.fire("render")},_getCounterMarkup:function(){this._count||(this._count=FB.Data._selectByIndex(["total_count"],
"link_stat","url",this._href));var b="0";if(void 0!==this._count.value){if(0<this._count.value.length){var d=this._count.value[0].total_count;3<d&&(FB.Dom.removeCss(this.dom,"fb_share_count_hidden"),b=1E7<=d?Math.round(d/1E6)+"M":1E4<=d?Math.round(d/1E3)+"K":d)}}else this._count.wait(FB.bind(this._renderButton,this,!1));return'<span class="fb_share_count_inner">'+b+"</span>"}});
FB.subclass("XFBML.Subscribe","XFBML.EdgeWidget",null,{setupAndValidate:function(){this._attr={channel:this.getChannelUrl(),api_key:FB._apiKey,font:this.getAttribute("font"),colorscheme:this.getAttribute("colorscheme","light"),href:this.getAttribute("href"),ref:this.getAttribute("ref"),layout:this._getLayout(),show_faces:this._shouldShowFaces(),width:this._getWidgetWidth()};return!0},getUrlBits:function(){return{name:"subscribe",params:this._attr}},_getWidgetWidth:function(){var b=this._getLayout(),
d=this._getPxAttribute("width",{standard:450,box_count:83,button_count:115}[b]),c={standard:{min:225,max:900},box_count:{min:43,max:900},button_count:{min:63,max:900}};d<c[b].min?d=c[b].min:d>c[b].max&&(d=c[b].max);return d}});void 0;
FB.provide("",{_domain:{api:"https://api.facebook.com/",api_read:"https://api-read.facebook.com/",cdn:"http://static.ak.fbcdn.net/",cdn_foreign:"http://connect.facebook.net/",graph:"https://graph.facebook.com/",https_cdn:"https://s-static.ak.fbcdn.net/",https_staticfb:"https://s-static.ak.facebook.com/",https_www:"https://www.facebook.com/",staticfb:"http://static.ak.facebook.com/",www:"http://www.facebook.com/",m:"http://m.facebook.com/",https_m:"https://m.facebook.com/"},_locale:"en_US",_localeIsRtl:!1},
!0);FB.provide("Flash",{_minVersions:[[10,3,181,34],[11,0,0]],_swfPath:"rsrc.php/v1/yD/r/GL74y29Am1r.swf"},!0);FB.provide("XD",{_xdProxyUrl:"connect/xd_proxy.php?version=3"},!0);FB.provide("Arbiter",{_canvasProxyUrl:"connect/canvas_proxy.php?version=3"},!0);FB.provide("Auth",{_xdStorePath:"xd_localstorage/v2"},!0);
FB.initSitevars={parseXFBMLBeforeDomReady:!1,computeContentSizeVersion:0,enableMobile:1,enableMobileComments:1,forceSecureXdProxy:1,iframePermissions:{read_stream:!1,manage_mailbox:!1,manage_friendlists:!1,read_mailbox:!1,publish_checkins:!0,status_update:!0,photo_upload:!0,video_upload:!0,sms:!1,create_event:!0,rsvp_event:!0,offline_access:!0,email:!0,xmpp_login:!1,create_note:!0,share_item:!0,export_stream:!1,publish_stream:!0,publish_likes:!0,ads_management:!1,contact_email:!0,access_private_data:!1,
read_insights:!1,read_requests:!1,read_friendlists:!0,manage_pages:!1,physical_login:!1,manage_groups:!1,read_deals:!1}};FB.forceOAuth=!0;FB.widgetPipeEnabledApps={0x65632ea70350:1,cca6477272fc5cb805f85a84f20fca1d:1,0xa2efa5f9730a:1};FB.widgetPipeTagCountThreshold=4;FB.provide("Canvas.Prefetcher",{_appIdsBlacklist:[0x83d70a64a992],_sampleRate:500},!0);FB.provide("TemplateData",{_enabled:!0},!0);FB.provide("TemplateUI",{_version:18},!0);
FB.provide("XFBML.ConnectBar",{imgs:{buttonUrl:"rsrc.php/v1/yY/r/h_Y6u1wrZPW.png",missingProfileUrl:"rsrc.php/v1/yo/r/UlIqmHJn-SK.gif"}},!0);
FB.provide("XFBML.ProfilePic",{_defPicMap:{pic:"rsrc.php/v1/yh/r/C5yt7Cqf3zU.jpg",pic_big:"rsrc.php/v1/yL/r/HsTZSDw4avx.gif",pic_big_with_logo:"rsrc.php/v1/y5/r/SRDCaeCL7hM.gif",pic_small:"rsrc.php/v1/yi/r/odA9sNLrE86.jpg",pic_small_with_logo:"rsrc.php/v1/yD/r/k1xiRXKnlGd.gif",pic_square:"rsrc.php/v1/yo/r/UlIqmHJn-SK.gif",pic_square_with_logo:"rsrc.php/v1/yX/r/9dYJBPDHXwZ.gif",pic_with_logo:"rsrc.php/v1/yu/r/fPPR9f2FJ3t.gif"}},!0);
FB.Dom&&FB.Dom.addCssRules&&FB.Dom.addCssRules('.fb_hidden{position:absolute;top:-10000px;z-index:10001}\n.fb_invisible{display:none}\n.fb_reset{background:none;border-spacing:0;border:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size: 11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}\n.fb_link img{border:none}\n.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}\n.fb_dialog_advanced{padding:10px;-moz-border-radius:8px;-webkit-border-radius:8px}\n.fb_dialog_content{background:#fff;color:#333}\n.fb_dialog_close_icon{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v1/yL/r/s816eWC-2sl.gif);cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px;top:8px\\9;right:7px\\9}\n.fb_dialog_mobile .fb_dialog_close_icon{top:5px;left:5px;right:auto}\n.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}\n.fb_dialog_close_icon:hover{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v1/yL/r/s816eWC-2sl.gif)}\n.fb_dialog_close_icon:active{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent;_background-image:url(http://static.ak.fbcdn.net/rsrc.php/v1/yL/r/s816eWC-2sl.gif)}\n.fb_dialog_loader{background-color:#f2f2f2;border:1px solid #606060;font-size: 24px;padding:20px}\n.fb_dialog_top_left,\n.fb_dialog_top_right,\n.fb_dialog_bottom_left,\n.fb_dialog_bottom_right{height:10px;width:10px;overflow:hidden;position:absolute}\n.fb_dialog_top_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/ye/r/8YeTNIlTZjm.png) no-repeat 0 0;left:-10px;top:-10px}\n.fb_dialog_top_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/ye/r/8YeTNIlTZjm.png) no-repeat 0 -10px;right:-10px;top:-10px}\n.fb_dialog_bottom_left{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/ye/r/8YeTNIlTZjm.png) no-repeat 0 -20px;bottom:-10px;left:-10px}\n.fb_dialog_bottom_right{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/ye/r/8YeTNIlTZjm.png) no-repeat 0 -30px;right:-10px;bottom:-10px}\n.fb_dialog_vert_left,\n.fb_dialog_vert_right,\n.fb_dialog_horiz_top,\n.fb_dialog_horiz_bottom{position:absolute;background:#525252;filter:alpha(opacity=70);opacity:.7}\n.fb_dialog_vert_left,\n.fb_dialog_vert_right{width:10px;height:100%}\n.fb_dialog_vert_left{margin-left:-10px}\n.fb_dialog_vert_right{right:0;margin-right:-10px}\n.fb_dialog_horiz_top,\n.fb_dialog_horiz_bottom{width:100%;height:10px}\n.fb_dialog_horiz_top{margin-top:-10px}\n.fb_dialog_horiz_bottom{bottom:0;margin-bottom:-10px}\n.fb_dialog_iframe{line-height:0}\n.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #3b5998;color:#fff;font-size: 14px;font-weight:bold;margin:0}\n.fb_dialog_content .dialog_title > span{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/yd/r/Cou7n-nqK52.gif)\nno-repeat 5px 50%;float:left;padding:5px 0 7px 26px}\nbody.fb_hidden{-webkit-transform:none;height:100%;margin:0;left:-10000px;overflow:visible;position:absolute;top:-10000px;width:100%\n}\n.fb_dialog.fb_dialog_mobile.loading{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/yO/r/_j03izEX40U.gif)\nwhite no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}\n.fb_dialog.fb_dialog_mobile.loading.centered{max-height:590px;min-height:590px;max-width:500px;min-width:500px}\n#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .45);position:absolute;left:0;top:0;width:100%;min-height:100%;z-index:10000}\n#fb-root #fb_dialog_ipad_overlay.hidden{display:none}\n.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}\n.fb_dialog_content .dialog_header{-webkit-box-shadow:white 0 1px 1px -1px inset;background:-webkit-gradient(linear, 0 0, 0 100%, from(#738ABA), to(#2C4987));border-bottom:1px solid;border-color:#1d4088;color:#fff;font:14px Helvetica, sans-serif;font-weight:bold;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}\n.fb_dialog_content .dialog_header table{-webkit-font-smoothing:subpixel-antialiased;height:43px;width:100%\n}\n.fb_dialog_content .dialog_header td.header_left{font-size: 12px;padding-left:5px;vertical-align:middle;width:60px\n}\n.fb_dialog_content .dialog_header td.header_right{font-size: 12px;padding-right:5px;vertical-align:middle;width:60px\n}\n.fb_dialog_content .touchable_button{background:-webkit-gradient(linear, 0 0, 0 100%, from(#4966A6),\ncolor-stop(0.5, #355492), to(#2A4887));border:1px solid #29447e;-webkit-background-clip:padding-box;-webkit-border-radius:3px;-webkit-box-shadow:rgba(0, 0, 0, .117188) 0 1px 1px inset,\nrgba(255, 255, 255, .167969) 0 1px 0;display:inline-block;margin-top:3px;max-width:85px;line-height:18px;padding:4px 12px;position:relative}\n.fb_dialog_content .dialog_header .touchable_button input{border:none;background:none;color:#fff;font:12px Helvetica, sans-serif;font-weight:bold;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}\n.fb_dialog_content .dialog_header .header_center{color:#fff;font-size: 16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}\n.fb_dialog_content .dialog_content{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #555;border-bottom:0;border-top:0;height:150px}\n.fb_dialog_content .dialog_footer{background:#f2f2f2;border:1px solid #555;border-top-color:#ccc;height:40px}\n#fb_dialog_loader_close{float:left}\n.fb_dialog.fb_dialog_mobile .fb_dialog_close_button{text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}\n.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}\n.fb_iframe_widget{position:relative;display:-moz-inline-block;display:inline-block}\n.fb_iframe_widget iframe{position:relative;vertical-align:text-bottom}\n.fb_iframe_widget span{position:relative}\n.fb_hide_iframes iframe{position:relative;left:-10000px}\n.fb_iframe_widget_loader{position:relative;display:inline-block}\n.fb_iframe_widget_fluid{display:inline}\n.fb_iframe_widget_loader iframe{min-height:32px;z-index:2;zoom:1}\n.fb_iframe_widget_loader .FB_Loader{background:url(http://static.ak.fbcdn.net/rsrc.php/v1/y9/r/jKEcVPZFk-2.gif) no-repeat;height:32px;width:32px;margin-left:-16px;position:absolute;left:50%;z-index:4}\n.fb_button_simple,\n.fb_button_simple_rtl{background-image:url(http://static.ak.fbcdn.net/rsrc.php/v1/yH/r/eIpbnVKI9lR.png);background-repeat:no-repeat;cursor:pointer;outline:none;text-decoration:none}\n.fb_button_simple_rtl{background-position:right 0}\n.fb_button_simple .fb_button_text{margin:0 0 0 20px;padding-bottom:1px}\n.fb_button_simple_rtl .fb_button_text{margin:0 10px 0 0}\na.fb_button_simple:hover .fb_button_text,\na.fb_button_simple_rtl:hover .fb_button_text,\n.fb_button_simple:hover .fb_button_text,\n.fb_button_simple_rtl:hover .fb_button_text{text-decoration:underline}\n.fb_button,\n.fb_button_rtl{background:#29447e url(http://static.ak.fbcdn.net/rsrc.php/v1/yL/r/FGFbc80dUKj.png);background-repeat:no-repeat;cursor:pointer;display:inline-block;padding:0 0 0 1px;text-decoration:none;outline:none}\n.fb_button .fb_button_text,\n.fb_button_rtl .fb_button_text{background:#5f78ab url(http://static.ak.fbcdn.net/rsrc.php/v1/yL/r/FGFbc80dUKj.png);border-top:solid 1px #879ac0;border-bottom:solid 1px #1a356e;color:#fff;display:block;font-family:"lucida grande",tahoma,verdana,arial,sans-serif;font-weight:bold;padding:2px 6px 3px 6px;margin:1px 1px 0 21px;text-shadow:none}\na.fb_button,\na.fb_button_rtl,\n.fb_button,\n.fb_button_rtl{text-decoration:none}\na.fb_button:active .fb_button_text,\na.fb_button_rtl:active .fb_button_text,\n.fb_button:active .fb_button_text,\n.fb_button_rtl:active .fb_button_text{border-bottom:solid 1px #29447e;border-top:solid 1px #45619d;background:#4f6aa3;text-shadow:none}\n.fb_button_xlarge,\n.fb_button_xlarge_rtl{background-position:left -60px;font-size: 24px;line-height:30px}\n.fb_button_xlarge .fb_button_text{padding:3px 8px 3px 12px;margin-left:38px}\na.fb_button_xlarge:active{background-position:left -99px}\n.fb_button_xlarge_rtl{background-position:right -268px}\n.fb_button_xlarge_rtl .fb_button_text{padding:3px 8px 3px 12px;margin-right:39px}\na.fb_button_xlarge_rtl:active{background-position:right -307px}\n.fb_button_large,\n.fb_button_large_rtl{background-position:left -138px;font-size: 13px;line-height:16px}\n.fb_button_large .fb_button_text{margin-left:24px;padding:2px 6px 4px 6px}\na.fb_button_large:active{background-position:left -163px}\n.fb_button_large_rtl{background-position:right -346px}\n.fb_button_large_rtl .fb_button_text{margin-right:25px}\na.fb_button_large_rtl:active{background-position:right -371px}\n.fb_button_medium,\n.fb_button_medium_rtl{background-position:left -188px;font-size: 11px;line-height:14px}\na.fb_button_medium:active{background-position:left -210px}\n.fb_button_medium_rtl{background-position:right -396px}\n.fb_button_text_rtl,\n.fb_button_medium_rtl .fb_button_text{padding:2px 6px 3px 6px;margin-right:22px}\na.fb_button_medium_rtl:active{background-position:right -418px}\n.fb_button_small,\n.fb_button_small_rtl{background-position:left -232px;font-size: 10px;line-height:10px}\n.fb_button_small .fb_button_text{padding:2px 6px 3px;margin-left:17px}\na.fb_button_small:active,\n.fb_button_small:active{background-position:left -250px}\n.fb_button_small_rtl{background-position:right -440px}\n.fb_button_small_rtl .fb_button_text{padding:2px 6px;margin-right:18px}\na.fb_button_small_rtl:active{background-position:right -458px}\n.fb_share_count_wrapper{position:relative;float:left}\n.fb_share_count{background:#b0b9ec none repeat scroll 0 0;color:#333;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;text-align:center}\n.fb_share_count_inner{background:#e8ebf2;display:block}\n.fb_share_count_right{margin-left:-1px;display:inline-block}\n.fb_share_count_right .fb_share_count_inner{border-top:solid 1px #e8ebf2;border-bottom:solid 1px #b0b9ec;margin:1px 1px 0 1px;font-size: 10px;line-height:10px;padding:2px 6px 3px;font-weight:bold}\n.fb_share_count_top{display:block;letter-spacing:-1px;line-height:34px;margin-bottom:7px;font-size: 22px;border:solid 1px #b0b9ec}\n.fb_share_count_nub_top{border:none;display:block;position:absolute;left:7px;top:35px;margin:0;padding:0;width:6px;height:7px;background-repeat:no-repeat;background-image:url(http://static.ak.fbcdn.net/rsrc.php/v1/yU/r/bSOHtKbCGYI.png)}\n.fb_share_count_nub_right{border:none;display:inline-block;padding:0;width:5px;height:10px;background-repeat:no-repeat;background-image:url(http://static.ak.fbcdn.net/rsrc.php/v1/yX/r/i_oIVTKMYsL.png);vertical-align:top;background-position:right 5px;z-index:10;left:2px;margin:0 2px 0 0;position:relative}\n.fb_share_no_count{display:none}\n.fb_share_size_Small .fb_share_count_right .fb_share_count_inner{font-size: 10px}\n.fb_share_size_Medium .fb_share_count_right .fb_share_count_inner{font-size: 11px;padding:2px 6px 3px;letter-spacing:-1px;line-height:14px}\n.fb_share_size_Large .fb_share_count_right .fb_share_count_inner{font-size: 13px;line-height:16px;padding:2px 6px 4px;font-weight:normal;letter-spacing:-1px}\n.fb_share_count_hidden .fb_share_count_nub_top,\n.fb_share_count_hidden .fb_share_count_top,\n.fb_share_count_hidden .fb_share_count_nub_right,\n.fb_share_count_hidden .fb_share_count_right{visibility:hidden}\n.fb_connect_bar_container div,\n.fb_connect_bar_container span,\n.fb_connect_bar_container a,\n.fb_connect_bar_container img,\n.fb_connect_bar_container strong{background:none;border-spacing:0;border:0;direction:ltr;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal;vertical-align:baseline}\n.fb_connect_bar_container{position:fixed;left:0 !important;right:0 !important;height:42px !important;padding:0 25px !important;margin:0 !important;vertical-align:middle !important;border-bottom:1px solid #333 !important;background:#3b5998 !important;z-index:99999999 !important;overflow:hidden !important}\n.fb_connect_bar_container_ie6{position:absolute;top:expression(document.compatMode=="CSS1Compat"? document.documentElement.scrollTop+"px":body.scrollTop+"px")}\n.fb_connect_bar{position:relative;margin:auto;height:100%;width:100%;padding:6px 0 0 0 !important;background:none;color:#fff !important;font-family:"lucida grande", tahoma, verdana, arial, sans-serif !important;font-size: 13px !important;font-style:normal !important;font-variant:normal !important;font-weight:normal !important;letter-spacing:normal !important;line-height:1 !important;text-decoration:none !important;text-indent:0 !important;text-shadow:none !important;text-transform:none !important;white-space:normal !important;word-spacing:normal !important}\n.fb_connect_bar a:hover{color:#fff}\n.fb_connect_bar .fb_profile img{height:30px;width:30px;vertical-align:middle;margin:0 6px 5px 0}\n.fb_connect_bar div a,\n.fb_connect_bar span,\n.fb_connect_bar span a{color:#bac6da;font-size: 11px;text-decoration:none}\n.fb_connect_bar .fb_buttons{float:right;margin-top:7px}\n.fb_edge_widget_with_comment{position:relative;*z-index:1000}\n.fb_edge_widget_with_comment span.fb_edge_comment_widget{position:absolute}\n.fb_edge_widget_with_comment span.fb_edge_comment_widget iframe.fb_ltr{left:-4px}\n.fb_edge_widget_with_comment span.fb_edge_comment_widget iframe.fb_rtl{left:2px}\n.fb_edge_widget_with_comment span.fb_send_button_form_widget{left:0;z-index:1}\n.fb_edge_widget_with_comment span.fb_send_button_form_widget .FB_Loader{left:0;top:1px;margin-top:6px;margin-left:0;background-position:50% 50%;background-color:#fff;height:150px;width:394px;border:1px #666 solid;border-bottom:2px solid #283e6c;z-index:1}\n.fb_edge_widget_with_comment span.fb_send_button_form_widget.dark .FB_Loader{background-color:#000;border-bottom:2px solid #ccc}\n.fb_edge_widget_with_comment span.fb_send_button_form_widget.siderender\n.FB_Loader{margin-top:0}\n.fbpluginrecommendationsbarleft,\n.fbpluginrecommendationsbarright{position:fixed !important;bottom:0;z-index:999}\n/* @noflip */\n.fbpluginrecommendationsbarleft{left:10px}\n/* @noflip */\n.fbpluginrecommendationsbarright{right:10px}\n',"fb.css.base fb.css.dialog fb.css.iframewidget fb.css.button fb.css.sharebutton fb.css.connectbarwidget fb.css.edgecommentwidget fb.css.sendbuttonformwidget fb.css.plugin.recommendationsbar".split(" "));
YUI.add("thirdparty-facebook",function(b){},"1.0");
YUI.add("squarespace-models-xero-account",function(b){var d=b.namespace("Squarespace.Models").XeroAccount=b.Base.create("xeroAccount",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.REST_API_ROOT+"xero-accounts"},{ATTRS:{accountId:{},code:{},name:{},type:{},currencyCode:{},enablePayments:{},isSystemAccount:{}}});b.Squarespace.Models.XeroAccountList=b.Base.create("xeroAccountList",b.ModelList,[b.Squarespace.ModelSync.REST],{model:d,parse:function(c){return b.JSON.parse(c).results},findAccountByCode:function(b){var e=
this.filter(function(e){return e.get("code")===b});return 0<e.length?e[0]:null},findAccountById:function(b){var e=this.filter(function(e){return e.get("accountId")===b});return 0<e.length?e[0]:null},findAccountByName:function(b){var e=this.filter(function(e){return e.get("name")===b});return 0<e.length?e[0]:null}})},"1.0",{requires:["base","model","squarespace-model-sync-rest"]});
YUI.add("squarespace-content-item-types-enum-record-type",function(b){b.namespace("Squarespace.Enums").RecordType=new function(b,c){this.values=b;for(var e=0;e<this.values.length;e++){var f=this.values[e];this[f[0]]=f[1]}var g=this,h;for(h in c)(function(b){g[b]=function(){var e=c[b].apply(g,arguments);return 0<=g.values.indexOf(e)?e[1]:e}})(h)}([["TEXT",1,"text","Text"],["IMAGE",2,"image","Image"],["QUOTE",4,"quote","Quote"],["LINK",5,"link","Link"],["CHAT",6,"chat"],["AUDIO",7,"audio","Audio"],
["VIDEO",8,"video","Video"],["REVIEW",10,"review"],["STORE_ITEM",11,"store_item"],["EVENT",12,"event","Event"],["THREAD",13,"thread"],["GALLERY",14,"gallery","Gallery"],["BINARY",15,"binary"],["CSSASSET",16,"css-asset"],["TWEAKASSET",17,"tweak-asset"],["DIGITALGOOD",18,"digital-good"],["ATTACHMENT",19,"attachment"],["EXPORT_WORDPRESS",20,"wordpress-export"],["EXPORT_INTERNAL",21,"json-export"],["TWEET",50,"tweet"],["RSS",51,"rss"],["CHECKIN",52,"checkin"],["DELICIOUS",53,"delicious"],["KBARTICLE",
54,"kbarticle","KBArticle"]],{valueForString:function(b){for(var c=0;c<this.values.length;c++)if(this.values[c][2]==b)return this.values[c];return null},stringForValue:function(b){for(var c=0;c<this.values.length;c++)if(this.values[c][1]==b)return this.values[c][2];return null},titleForValue:function(b){for(var c=0;c<this.values.length;c++)if(this.values[c][1]==b)return this.values[c][3];return null}})});
YUI.add("squarespace-calendar-block-renderer",function(b){b.namespace("Y.Squarespace.Rendering");var d=YUI_CONFIG.classNamePrefix||"yui3",c=b.Base.create("SqspCalendarPlugin",b.Squarespace.CalendarBaseRenderer,[],{initializer:function(b){this.host.get("contentBox").delegate("hover",this._onHover,this._onHoverOut,"."+d+"-calendar-day",this)},_renderDay:function(e,d,g){0<g.length&&(e=this._groupEvents(g,e),e=this._createFlyoutNode(e),d.addClass("date-has-event"),d.append(b.Node.create(c.TEMPLATE_DAY_MARKER)),
d.append(e))},_onHover:function(b){b=b.target;var c=b.one(".event-menu"),d=this.host.get("contentBox");c&&(c.show(),c.get("offsetWidth")+b.getX()>d.getX()+d.get("offsetWidth")&&c.addClass("event-menu-right"))},_onHoverOut:function(b){b=b.target;(b=b.hasClass("event-menu")?b:b.one(".event-menu"))&&b.hide()},_groupEvents:function(c,d){var g={},h=[],k=[];b.Array.each(c,function(b){if(this._isSameDay(b,d)){var c=this._getEventDisplayTime(b),e=g[c];e||(e=[],g[c]=e);e.push(b)}else h.push(b)},this);b.Object.each(g,
function(b,c){k.splice(0,0,{displayTime:c,events:b})});0<h.length&&k.splice(0,0,{displayTime:"(from previous day)",events:h});return k},_createFlyoutNode:function(e){var d=b.Node.create(c.TEMPLATE_FLYOUT);b.Array.each(e,function(e){var h=b.Node.create(b.substitute(c.TEMPLATE_GROUP_NODE,{displayTime:e.displayTime}));d.append(h);b.Array.each(e.events,function(e){e=b.substitute(c.TEMPLATE_EVENT_NODE,{fullUrl:e.fullUrl,title:e.title});h.append(e)})});d.hide();return d}},{TEMPLATE_DAY_MARKER:'<div class="date-has-event-marker"></div>',
TEMPLATE_FLYOUT:'<div class="event-menu">',TEMPLATE_GROUP_NODE:'<div class="event-time-group" title="{displayTime}"><div class="event-time">{displayTime}</div></div>',TEMPLATE_EVENT_NODE:'<div class="event-item"><a class="event-link" href="{fullUrl}">{title}</a></div>',NS:"calendarPlugin"});b.namespace("Squarespace.Rendering").renderCalendar=function(e,d){var g;if(b.Lang.isString(d))collectionid=d;else if(b.Object.hasKey(d,"collectionId"))g=d.collectionId;else if(b.instanceOf(d,b.Squarespace.Models.ContentCollection))g=
d.get("id");else if(b.Squarespace.Utils.isDamaskEnabled())g=CONFIG_PANEL.getPreviewCollection().get("id");else{console.warn("Cannot render calendar: failed to determine collectionId");return}g=new b.Squarespace.SquarespaceCalendar({contentBox:e,date:new Date,collectionId:g});g.plug(c);g.render();return g};b.config.win.Squarespace.onInitialize(b,function(){var c=b.all(".sqs-block.calendar-block[data-block-json]");c.size()&&c.each(function(c){b.Squarespace.Rendering.renderCalendar(c.one(".sqs-block-content"),
b.JSON.parse(c.getAttribute("data-block-json")))},this)})},"1.0",{requires:["squarespace-calendar-core-renderer"]});
YUI.add("squarespace-external-link-tab",function(b){var d=b.namespace("Squarespace.Views").ExternalLinkTab=b.Base.create("ExternalLinkTab",b.Squarespace.View,[],{template:"external-link-tab.html",initializer:function(c){d.superclass.initializer.apply(this,arguments);this._protocolRegex=/(?:^#)|(?:^\.{0,2}\/)|(?:^mailto:)|^[a-z]+:\/\//;this._defaultProtocol="http://";this._initialLinkUrl=this.get("linkUrl");this._input=new b.Squarespace.DialogFields.Text({data:"#"==this.get("linkUrl")?null:this.get("linkUrl"),
"strings.placeholder":"http:// ..."});this.get("disableNewWindow")||(this._newWindowField=new b.Squarespace.DialogFields.Check({name:"newWindow","strings.title":"Open in new window",data:this.get("newWindow")}))},destructor:function(){this._newWindowField&&this._newWindowField.destroy()},render:function(){d.superclass.render.apply(this,arguments);var b=this.get("container");this._input.render(b.one(".link"));this.get("disableNewWindow")||this._newWindowField.render(b.one(".external-link-tab"));this.bindUI()},
bindUI:function(){var b=this._input.get("contentBox").one("input");b.on("valuechange",this._inputChange,this);b.on("key",function(b){this._dataChanged(!0);b.halt()},"down:13",this);this.get("disableNewWindow")||this._newWindowField.after("dataChange",function(b){this.set("newWindow",b.newVal);this._dataChanged()},this);this.get("container").one(".visit").on("click",this._visit,this)},reset:function(){this.set("linkUrl","");this.set("newWindow",!1);this.get("container").one('input[type="text"]').set("value",
"")},_inputChange:function(){var b=this._linkTrim(this._input.get("contentBox").one("input").get("value"));b&&(!this._protocolRegex.test(b)&&-1===b.indexOf(":"))&&(b=this._defaultProtocol+b);this.set("linkUrl",b);this._dataChanged()},_visit:function(){var b=this._input.get("contentBox").one("input").get("value");b&&(this._protocolRegex.test(b)||(b=this._defaultProtocol+b),window.open(b,"visitLink"))},_dataChanged:function(c){var e=this.get("onDataChange");b.Lang.isFunction(e)&&e(this.get("linkUrl"),
this.get("newWindow"),c)},_linkTrim:function(b){return(b||"").replace(/(?:^[^!-~]+)|(?:\s+$)/g,"")}},{ATTRS:{disableNewWindow:{value:!1},linkUrl:{value:null},newWindow:{value:!1},onDataChange:{value:null}}})},"1.0",{requires:["base","squarespace-dialog-check","squarespace-external-link-tab-template","squarespace-view"]});
YUI.add("squarespace-widgets-newsletter-message-viewsent-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-newsletter-message-viewsent.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};h=this.escapeExpression;b='<div class="newsletters-view-sentmessage">\n    <iframe src="';(d=d.src)?d=d.call(c,{hash:{},data:k}):(d=c.src,d="function"===typeof d?d.apply(c):d);return b+=h(d)+'"></iframe>\n</div>'})})();
b.Handlebars.registerPartial("widgets-newsletter-message-viewsent.html".replace("/","."),d.templates["widgets-newsletter-message-viewsent.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widgets-music-album-track-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-music-album-track.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="music-track-number"></div>\n<div class="music-track">\n  <span class="title"></span>\n  <div class="meta">\n    <span class="artist-name"></span>\n    <span class="duration"></span>\n  </div>\n  <div class="utils">\n    <a class="remove">Remove</a>\n  </div>\n</div>'})})();b.Handlebars.registerPartial("widgets-music-album-track.html".replace("/",
"."),d.templates["widgets-music-album-track.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-json-template",function(b){function d(b){return b.replace(/([\{\}\(\)\[\]\|\^\$\-\+\?])/g,"\\$1")}function c(b,c){var e=r[b+c];void 0===e&&(e="("+d(b)+"\\S.*?"+d(c)+"\n?)",e=RegExp(e,"g"));return e}function e(b,c){var e=[{context:b,index:-1}];return{PushSection:function(b){if(void 0===b||null===b)return null;b="@"==b?e[e.length-1].context:e[e.length-1].context[b]||null;e.push({context:b,index:-1});return b},Pop:function(){e.pop()},next:function(){var b=e[e.length-1];-1==b.index&&
(b={context:null,index:0},e.push(b));var c=e[e.length-2].context;if(b.index==c.length)e.pop();else return b.context=c[b.index++],!0},_Undefined:function(b){return void 0===c?null:c},_LookUpStack:function(b){for(var c=e.length-1;;){var d=e[c];if("@index"==b){if(-1!=d.index)return d.index}else if(d=d.context,"object"===typeof d&&(d=d[b],void 0!==d))return d;c--;if(-1>=c)return this._Undefined(b)}},get:function(b){if("@"==b)return e[e.length-1].context;var c=b.split("."),d=this._LookUpStack(c[0]);if(1<
c.length)for(var f=1;f<c.length;f++){if(null===d)return"[JSONT: Can't resolve '"+b+"'.]";d=d[c[f]];if(void 0===d)return this._Undefined(c[f])}return d}}}function f(b,c,e){for(var d=0;d<b.length;d++){var f=b[d];if("string"==typeof f)e(f);else(0,f[0])(f[1],c,e)}}function g(b,c,e){var d;d=c.get(b.name);for(var f=0;f<b.formatters.length;f++){var g=b.formatters[f];d=(0,g[0])(d,c,g[1])}e(d)}function h(b,c,e){var d=c.PushSection(b.section_name),g=!1;d&&(g=!0);d&&0===d.length&&(g=!1);g?(f(b.Statements(),
c,e),c.Pop()):(c.Pop(),f(b.Statements("or"),c,e))}function k(b,c,e){for(var d=c.get("@"),g=0;g<b.clauses.length;g++){var h=b.clauses[g],k=h[1];if((0,h[0][0])(d,c,h[0][1])){f(k,c,e);break}}}function l(b,c,e){var d=c.PushSection(b.section_name);if(d&&0<d.length){var d=d.length-1,g=b.Statements();b=b.Statements("alternate");for(var h=0;void 0!==c.next();h++)f(g,c,e),h!=d&&f(b,c,e)}else f(b.Statements("or"),c,e);c.Pop()}function p(e,d){function f(c){if(c.startsWith(q)){var e=d.partials[c.substr(q.length)];
if(e)return[function(c,d,f){return b.JSONTemplate.evaluateJsonTemplate(e,c)},null];throw{name:"BadPartialInclude",message:c.substr(q)+" is not a valid partial. Remember, loops are not supported (a partial include cannot be included inside itself)."};}var g=r.lookup(c);if(!g[0])throw{name:"BadFormatter",message:c+" is not a valid formatter"};return g}function p(b){var c=v.lookup(b);if(!c[0])throw{name:"BadPredicate",message:b+" is not a valid predicate"};return c}var r=new u([s(b.JSONTemplate.DEFAULT_FORMATTERS),
t(b.JSONTemplate.DEFAULT_PREFIX_FORMATTERS)]),v=u([s(b.JSONTemplate.DEFAULT_PREDICATES),t(b.JSONTemplate.DEFAULT_PARAMETRIC_PREDICATES)]),aa=d.format_char||"|";if(":"!=aa&&"|"!=aa)throw{name:"ConfigurationError",message:"Only format characters : and | are accepted"};var D=d.meta||"{}",M=D.length;if(1==M%2)throw{name:"ConfigurationError",message:D+" has an odd number of metacharacters"};for(var I=D.substring(0,M/2),D=D.substring(M/2,M),M=c(I,D),Q=w({}),V=[Q],C=I.length,Z,N,ca=0;;){Z=M.exec(e);if(null===
Z)break;else N=Z[0];Z.index>ca&&(ca=e.slice(ca,Z.index),Q.Append(ca));ca=M.lastIndex;Z=!1;"\n"==N.slice(-1)&&(N=N.slice(null,-1),Z=!0);N=N.slice(C,-C);if("#"!=N.charAt(0)){if("."==N.charAt(0)){N=N.substring(1,N.length);var R={"meta-left":I,"meta-right":D,space:" ",tab:"\t",newline:"\n"}[N];if(void 0!==R){Q.Append(R);continue}if(R=N.match(B)){N=R[3];R[1]?(Z=l,N=y({section_name:N})):(Z=h,N=w({section_name:N}));Q.Append([Z,N]);V.push(N);Q=N;continue}var X;if(R=N.match(A)){Z=(X=R[1])?p(X):null;Q.NewOrClause(Z);
continue}var R=!1,ba=N.match(K);if(ba){if(X=ba[1],R=!0,-1==X.indexOf("?")){Z=[function(b){return function(c,e){var d,f,g;if(-1!==b.indexOf(" || ")){d=b.split("||");for(g=0;g<d.length;g++)if(f=d[g].trim(),e.get(f))return!0;return!1}if(-1!==b.indexOf(" && ")){d=b.split(" && ");for(g=0;g<d.length;g++)if(f=d[g].trim(),!e.get(f))return!1;return!0}return e.get(b)}}(X),null];N=z();N.NewOrClause(Z);Q.Append([k,N]);V.push(N);Q=N;continue}}else if("?"==N.charAt(N.length-1)||"?"==N.split(" ")[0].charAt(N.split(" ")[0].length-
1))X=N,R=!0;if(R){Z=X?p(X):null;N=z();N.NewOrClause(Z);Q.Append([k,N]);V.push(N);Q=N;continue}if("alternates with"==N){Q.AlternatesWith();continue}if("end"==N){V.pop();if(0<V.length)Q=V[V.length-1];else throw{name:"TemplateSyntaxError",message:"Got too many {end} statements"};continue}}ba=N.split(aa);if(1==ba.length)R=[f("str")];else{R=[];for(N=1;N<ba.length;N++)R.push(f(ba[N]));N=ba[0]}Q.Append([g,{name:N,formatters:R}]);Z&&Q.Append("\n")}}Q.Append(e.slice(ca));if(1!==V.length)throw{name:"TemplateSyntaxError",
message:"Got too few {end} statements."};return Q}b.namespace("JSONTemplate");var q="apply ",r={};b.JSONTemplate.DEFAULT_FORMATTERS=b.Squarespace.TEMPLATE_FORMATTERS;b.JSONTemplate.DEFAULT_PREFIX_FORMATTERS=[].concat(b.Squarespace.TEMPLATE_PREFIX_FORMATTERS,[{name:"pluralize",func:function(b,c,e){switch(e.length){case 0:c="";e="s";break;case 1:c="";e=e[0];break;case 2:c=e[0];e=e[1];break;default:throw{name:"EvaluationError",message:"pluralize got too many args"};}return 1==b?c:e}},{name:"encode-space",
func:function(b,c,e){return b.replace(/\s/g,"&nbsp;")}},{name:"truncate",func:function(b,c,e){c=e[0]||100;e=e[1]||"...";b&&b.length>c&&(b=b.substring(0,c),b=b.replace(/\w+$/,""),b+=e);return b}},{name:"date",func:function(c,e,d){var f=0,f=(new Date(c)).getTimezoneOffset();if(!b.Lang.isNumber(c))return"Invalid date.";if("undefined"!==typeof TimezoneJS){var g;try{g=new TimezoneJS.Date(c,e.get("website.timeZone"))}catch(h){return"Invalid Timezone"}f=(isNaN(g.getTimezoneOffset())?0:g.getTimezoneOffset())-
f}else e=-parseInt(e.get("website.timeZoneOffset"),10)/6E4,g=(new Date).getTimezoneOffset(),f=e-g;c=new Date(c-6E4*f);d=d.join(" ");return b.DataType.Date.format(c,{format:d})}},{name:"image",func:function(c,e,d){var f;c.mediaFocalPoint&&(f=c.mediaFocalPoint.x+","+c.mediaFocalPoint.y);return'<img class="'+(d[0]?d[0]:"thumb-image")+'" '+(c.title?'alt="'+b.Squarespace.Escaping.escapeForHtmlTag(c.title)+'" ':"")+' data-image="'+c.assetUrl+'" data-image-dimensions="'+c.originalSize+'" data-image-focal-point="'+
f+'"/>'}},{name:"timesince",func:function(c,e,d){if(!b.Lang.isNumber(c))return"Invalid date.";d.join(" ");return'<span class="timesince" data-date="'+c+'">'+b.Squarespace.DateUtils.humanizeDate(c)+"</span>"}},{name:"resizedHeightForWidth",func:function(b,c,e){c=b.split("x");if(2!=c.length)return"Invalid source parameter.  Pass in 'originalSize'.";b=parseInt(c[0],10);c=parseInt(c[1],10);e=parseInt(e[0],10)/b;return parseInt(c*e,10)}},{name:"resizedWidthForHeight",func:function(b,c,e){c=b.split("x");
if(2!=c.length)return"Invalid source parameter.  Pass in 'originalSize'.";b=parseInt(c[0],10);c=parseInt(c[1],10);e=parseInt(e[0],10)/c;return parseInt(b*e,10)}},{name:"squarespaceThumbnailForWidth",func:function(c,e,d){return b.Squarespace.Rendering.getSquarespaceSizeForWidth(parseInt(d[0],10))}},{name:"squarespaceThumbnailForHeight",func:function(c,e,d){e=c.split("x");if(2!=e.length)return"Invalid source parameter.  Pass in 'originalSize'.";c=parseInt(e[0],10);e=parseInt(e[1],10);d=parseInt(d[0],
10)/e;d=parseInt(c*d,10);return b.Squarespace.Rendering.getSquarespaceSizeForWidth(d)}},{name:"cycle",func:function(b,c,e){return e[(b-1)%e.length]}}]);var s=function(b){return{lookup:function(c){return[b[c]||null,null]}}},t=function(b){return{lookup:function(c){for(var e=0;e<b.length;e++){var d=b[e].name,f=b[e].func;if(c.slice(0,d.length)==d)return e=c.charAt(d.length),c=""===e?[]:c.split(e).slice(1),[f,c]}return[null,null]}}},u=function(b){return{lookup:function(c){for(var e=0;e<b.length;e++){var d=
b[e].lookup(c);if(d[0])return d}return[null,null]}}},v=function(b){var c={current_clause:[],Append:function(b){c.current_clause.push(b)},AlternatesWith:function(){throw{name:"TemplateSyntaxError",message:"{.alternates with} can only appear with in {.repeated section ...}"};},NewOrClause:function(b){throw{name:"NotImplemented"};}};return c},w=function(b){var c=v(b);c.statements={"default":c.current_clause};c.section_name=b.section_name;c.Statements=function(b){return c.statements[b||"default"]||[]};
c.NewOrClause=function(b){if(b)throw{name:"TemplateSyntaxError",message:"{.or} clause only takes a predicate inside predicate blocks"};c.current_clause=[];c.statements.or=c.current_clause};return c},y=function(b){var c=w(b);c.AlternatesWith=function(){c.current_clause=[];c.statements.alternate=c.current_clause};return c},z=function(b){var c=v(b);c.clauses=[];c.NewOrClause=function(b){b=b||[function(b){return!0},null];c.current_clause=[];c.clauses.push([b,c.current_clause])};return c},B=/(repeated)?\s*(section)\s+(\S+)?/,
A=/^or(?:[\s\-]+(.+))?/,K=/^if(?:[\s\-]+(.+))?/;b.JSONTemplate.Template=Class.create({initialize:function(b,c,e){b=this.removeMultilineComments(b);this._options=c||{};this._program=p(b,this._options)},removeMultilineComments:function(b){for(var c=b.search("{##"),e;0<=c;)e=b.substr(c),b=b.substr(0,c)+e.substr(e.search("##}")+3),c=b.search("{##");return b},render:function(b,c){var d=e(b,this._options.undefined_str);f(this._program.Statements(),d,c)},expand:function(b){var c=[];this.render(b,function(b){c.push(b)});
return c.join("")}});b.JSONTemplate.DEFAULT_PREDICATES=b.Squarespace.TEMPLATE_PREDICATES;b.JSONTemplate.DEFAULT_PARAMETRIC_PREDICATES=b.Squarespace.TEMPLATE_PARAMETRIC_PREDICATES;b.JSONTemplate.evaluateJsonTemplate=function(c,e,d){return"string"!=typeof c?"JSON Template Error: Processing failed because no input was provided. (type: "+typeof c+", template: "+JSON.stringify(c)+", dictionary: "+JSON.stringify(e)+", partials: "+JSON.stringify(d)+")":(new b.JSONTemplate.Template(c,{partials:d})).expand(e)}},
"1.0",{requires:"datatype-date-format squarespace-common squarespace-util squarespace-date-utils json squarespace-template-helpers".split(" ")});
YUI.add("squarespace-block-search-editor",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.Search=b.Base.create("search-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(c){if(b.Squarespace.Utils.isBetaFeatureEnabled()){var d=this.configDialog.get("dialog");this._dialogReady=!1;if(b.Lang.isValue(d))d.on("ready",function(){var b=d.getField("collectionFilter");b&&(b.after("dataChange",this._onCollectionFilterCheckChange,this),!1===d.getField("collectionFilter").get("data")&&
(d.getField("contentDesc").hide(),d.getField("collectionId").hide()))},this);else this._dialogReady=!0}},_onCollectionFilterCheckChange:function(b){var c=this.configDialog.get("dialog"),d=c.getField("contentDesc"),c=c.getField("collectionId");!0!==b.newVal?(c.clearSelected(),c.set("data",{urlId:null,filter:null,id:null}),d.hide(),c.hide()):(d.show(),c.show())},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Search")}},{NS:"blockEditor",
ATTRS:{blockName:{value:"Search"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Search=b.Base.create("block-search-editor",b.Squarespace.ModelEditorDialog,[],{},{ATTRS:{dialogConfig:{valueFn:function(){return b.Squarespace.Utils.isBetaFeatureEnabled()?d:c}}}});var d={title:"Edit Search",flyoutPointerDirection:"hidden",style:"flyout",width:335,height:350,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{tabTitle:"Content",icon:"/universal/images-v6/icons/icon-search-16-light.png",
scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>This is a search block.</strong> Typing in this search input will allow users to search your website.",padding:[0,20]}},{ctor:b.Squarespace.DialogFields.Check,name:"collectionFilter",config:{"strings.title":"Filter by Collection"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"contentDesc",text:"Select the content you want to search.",padding:[0,10]}},{ctor:b.Squarespace.DialogFields.ContentIdSelector,
config:{name:"collectionId",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionFilter:{collectionType:[b.Squarespace.CollectionTypes.PRODUCT],collectionOrdering:[b.Squarespace.CollectionOrdering.CHRONOLOGICAL,b.Squarespace.CollectionOrdering.CALENDAR],folder:!1}}}]},{tabTitle:"Display",icon:"/universal/images-v6/icons/icon-search-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Check,name:"searchPreview",config:{"strings.title":"Quick Preview","strings.description":"A dropdown under the search block will allow a quicker access to the search results."}},
{ctor:b.Squarespace.DialogFields.Select,config:{name:"icon","strings.title":"Icon",className:"thin dark",defaultValue:"dark",options:[{value:"dark",label:"Dark"},{value:"light",label:"Light"}]}}]}]},c={title:"Edit Search",width:335,flyoutPointerDirection:"hidden",style:"flyout",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{icon:"/universal/images-v6/icons/icon-search-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,
config:{text:"<strong>This is a search block.</strong> Clicking this search button will allow users to search your website"}}]}]}},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-content-selector squarespace-model-editor".split(" ")});
YUI.add("squarespace-settings-site-manager",function(b){b.namespace("Squarespace").SettingsManager=Class.extend(b.Squarespace.PanelManager,{name:"SettingsManager",ready:function(){this.menuContainerEl.delegate("click",this.onHelpTabClick,".panel-menu-item.support-settings",this)},onHelpTabClick:function(d){b.Squarespace.Analytics.trackInternal("help_site_link_click",{position:"help_tab"})},getTitle:function(){return"Settings"},getDescription:function(){return"Settings allows you to adjust the overall settings for your website."},
getName:function(){return"settings"},getMenuItems:function(){var d;if(Static.SQUARESPACE_CONTEXT.billingSystemAvailable)switch(Static.SQUARESPACE_CONTEXT.billingStatus){case b.Squarespace.BillingStatus.FREE:d=b.Squarespace.Widgets.BillingSettingsFree;break;case b.Squarespace.BillingStatus.SUBSCRIBED:d=b.Squarespace.Widgets.BillingSettingsSubscribed;break;case b.Squarespace.BillingStatus.TRIAL:d=b.Squarespace.Widgets.BillingSettingsTrial;break;case b.Squarespace.BillingStatus.LINKED:d=b.Squarespace.Widgets.BillingSettingsLinked;
break;default:throw"Invalid billingStatus";}else d=b.Squarespace.Widgets.BillingSettingsDown;d=[{name:"site-settings",title:"Basic Information",ctor:b.Squarespace.Settings.Site.Basic,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_SITE},{name:"general-settings",title:"General",ctor:b.Squarespace.Settings.Site.General,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_GENERAL},
{name:"locale-settings",title:"Time / Geography",ctor:b.Squarespace.Settings.Site.Locale,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_LOCALE},{name:"domain-settings",title:"Domains",ctor:b.Squarespace.Settings.Site.Domains,hideWhenWebsiteStatusIs:[],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_DOMAIN},b.Squarespace.Utils.isBetaFeatureEnabled()?{name:"google-apps-email-settings",title:"Email (Beta)",
ctor:b.Squarespace.Widgets.GoogleAppsEmailSettings,hideWhenSiteStatusIs:[],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_DOMAIN}:null,{name:"overlay-settings",title:"Overlays",ctor:b.Squarespace.Settings.Site.Overlay,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_GENERAL},{name:"template-settings",title:"Templates",ctor:b.Squarespace.Settings.Site.Templates,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_TEMPLATE,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{name:"billing-settings",title:"Billing",ctor:d,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_BILLING},{title:"Account",type:"divider"},{name:"member-accounts",title:"Permissions",ctor:b.Squarespace.Settings.Site.Contributors,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_MEMBER_ACCOUNTS,
prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{name:"social-account-settings",title:"Connected Accounts",ctor:b.Squarespace.Settings.Site.SocialAccounts,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_SOCIAL_ACCOUNT},{name:"social-settings",title:"Share Buttons",ctor:b.Squarespace.Settings.Site.ShareButtons,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_SOCIAL_SETTINGS,
prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{name:"facebook-page-settings",title:"Facebook Page",ctor:b.Squarespace.Settings.Site.Facebook,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_FACEBOOK,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{title:"Account",type:"divider"},{name:"importing-settings",title:"Import / Export",ctor:b.Squarespace.Settings.Site.Importing,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_IMPORT,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{name:"injection-settings",title:"Code Injection",ctor:b.Squarespace.Settings.Site.CodeInjection,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_CODEINJECT},{name:"advanced-settings",title:"URL Mappings",ctor:b.Squarespace.Settings.Site.UrlMappings,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_ADVANCED,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{name:"developer-settings",title:"Developer",ctor:b.Squarespace.Widgets.DeveloperSettings,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_DEVELOPER,prohibitedForPlans:[b.Squarespace.PlanIds.DOMAIN]},{title:"Account",type:"divider"},{name:"lab-settings",title:"Labs",ctor:b.Squarespace.Settings.Site.LabSettings,
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_LABS,hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED]},{name:"session-settings",title:"Sessions",ctor:b.Squarespace.Widgets.SessionSettings,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_SESSIONS},{name:"mobile-settings",title:"Mobile Apps",type:"link",href:"http://www.squarespace.com/apps/",hideWhenWebsiteStatusIs:[b.Squarespace.StatusConstants.EXPIRED],requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_MOBILE},
{name:"support-settings",title:"Help",type:"link",href:"http://help.squarespace.com",requiredPermission:b.Squarespace.AccessPermissions.CONFIG_SETTINGS_SUPPORT}];return b.Array.reduce(d,[],function(c,e){b.Lang.isValue(e)&&(e.config=b.merge(e.config||{},{manager:this}),c.push(e));return c},this)}});b.namespace("Squarespace.ConfigurationPanelRenderers").settings=b.Squarespace.SettingsManager},"1.0",{requires:"anim datatype-number json node oop squarespace-graphing squarespace-panel-manager squarespace-settings-billing-down squarespace-settings-billing-free squarespace-settings-billing-linked squarespace-settings-billing-subscribed squarespace-settings-billing-trial squarespace-settings-developer squarespace-settings-recycle-bin squarespace-settings-sessions squarespace-settings-site-basic squarespace-settings-site-contributors squarespace-settings-site-domains squarespace-settings-site-facebook squarespace-settings-site-general squarespace-settings-site-google-apps squarespace-settings-site-importing squarespace-settings-site-injection squarespace-settings-site-labs squarespace-settings-site-locale squarespace-settings-site-overlay squarespace-settings-site-share-buttons squarespace-settings-site-social-accounts squarespace-settings-site-templates squarespace-settings-site-url-mappings".split(" ")});
Raphael=function(){function b(){if(b.is(arguments[0],Ua)){for(var c=arguments[0],e=ga[na](b,c.splice(0,3+b.is(c[0],ya))),d=e.set(),f=0,g=c[T];f<g;f++){var h=c[f]||{};V.test(h.type)&&d[sa](e[h.type]().attr(h))}return d}return ga[na](b,arguments)}function d(){}function c(e){if(b.vml){var d=/^\s+|\s+$/g;c=h(function(b){var c;b=ta(b)[Ka](d,ra);try{var e=new ca.ActiveXObject("htmlfile");e.write("<body>");e.close();c=e.body}catch(f){c=ca.createPopup().document.body}e=c.createTextRange();try{c.style.color=
b;var g=e.queryCommandValue("ForeColor");return"#"+("000000"+((g&255)<<16|g&65280|(g&16711680)>>>16)[ha](16)).slice(-6)}catch(h){return"none"}})}else{var f=N.createElement("i");f.title="Rapha\u00ebl Colour Picker";f.style.display="none";N.body[ba](f);c=h(function(b){f.style.color=b;return N.defaultView.getComputedStyle(f,ra).getPropertyValue("color")})}return c(e)}function e(){return"hsb("+[this.h,this.s,this.b]+")"}function f(){return"hsl("+[this.h,this.s,this.l]+")"}function g(){return this.hex}
function h(b,c,e){function d(){var f=Array[C].slice.call(arguments,0),g=f[fa]("\u25ba"),h=d.cache=d.cache||{},k=d.count=d.count||[];if(h[Z](g))return e?e(h[g]):h[g];1E3<=k[T]&&delete h[k.shift()];k[sa](g);h[g]=b[na](c,f);return e?e(h[g]):h[g]}return d}function k(c){var e=[];if(!b.is(c,Ua)||!b.is(c&&c[0],Ua))c=b.parsePathString(c);for(var d=0,f=c[T];d<f;d++){e[d]=[];for(var g=0,h=c[d][T];g<h;g++)e[d][g]=c[d][g]}e[ha]=b._path2string;return e}function l(b,c,e,d,f,g){var h=1/3,k=2/3;return[h*b+k*e,h*
c+k*d,h*f+k*e,h*g+k*d,f,g]}function p(b,c,e,d,f,g,k,l,q,r){var s=ea.PI,t=120*s/180,u=s/180*(+f||0),w=[],v,y=h(function(b,c,e){var d=b*ea.cos(e)-c*ea.sin(e);b=b*ea.sin(e)+c*ea.cos(e);return{x:d,y:b}});if(r)A=r[0],v=r[1],g=r[2],z=r[3];else{v=y(b,c,-u);b=v.x;c=v.y;v=y(l,q,-u);l=v.x;q=v.y;ea.cos(s/180*f);ea.sin(s/180*f);v=(b-l)/2;A=(c-q)/2;z=v*v/(e*e)+A*A/(d*d);1<z&&(z=ea.sqrt(z),e*=z,d*=z);var z=e*e,x=d*d,z=(g==k?-1:1)*ea.sqrt(ea.abs((z*x-z*A*A-x*v*v)/(z*A*A+x*v*v)));g=z*e*A/d+(b+l)/2;var z=z*-d*v/e+
(c+q)/2,A=ea.asin(((c-z)/d).toFixed(7));v=ea.asin(((q-z)/d).toFixed(7));A=b<g?s-A:A;v=l<g?s-v:v;0>A&&(A=2*s+A);0>v&&(v=2*s+v);k&&A>v&&(A-=2*s);!k&&v>A&&(v-=2*s)}ea.abs(v-A)>t&&(w=v,s=l,x=q,v=A+t*(k&&v>A?1:-1),l=g+e*ea.cos(v),q=z+d*ea.sin(v),w=p(l,q,e,d,f,0,k,s,x,[v,w,g,z]));s=v-A;f=ea.cos(A);g=ea.sin(A);k=ea.cos(v);v=ea.sin(v);s=ea.tan(s/4);e=4/3*e*s;s*=4/3*d;d=[b,c];b=[b+e*g,c-s*f];c=[l+e*v,q-s*k];l=[l,q];b[0]=2*d[0]-b[0];b[1]=2*d[1]-b[1];if(r)return[b,c,l][S](w);w=[b,c,l][S](w)[fa]()[Na](",");r=
[];l=0;for(q=w[T];l<q;l++)r[l]=l%2?y(w[l-1],w[l],u).y:y(w[l],w[l+1],u).x;return r}function q(b,c,e,d,f,g,h,k,l){var p=1-l;return{x:Ha(p,3)*b+3*Ha(p,2)*l*e+3*p*l*l*f+Ha(l,3)*h,y:Ha(p,3)*c+3*Ha(p,2)*l*d+3*p*l*l*g+Ha(l,3)*k}}function r(c,e,d,f){if(b.is(c,Ba)||b.is(c,"object")){if(c=b.is(c,Ba)?N.getElementById(c):c,c.tagName)return null==e?{container:c,width:c.style.pixelWidth||c.offsetWidth,height:c.style.pixelHeight||c.offsetHeight}:{container:c,width:e,height:d}}else return{container:1,x:c,y:e,width:d,
height:f}}function s(b,c){var e=this,d;for(d in c)if(c[Z](d)&&!(d in b))switch(typeof c[d]){case "function":(function(c){b[d]=b===e?c:function(){return c[na](e,arguments)}})(c[d]);break;case "object":b[d]=b[d]||{};s.call(this,b[d],c[d]);break;default:b[d]=c[d]}}function t(b,c){b==c.top&&(c.top=b.prev);b==c.bottom&&(c.bottom=b.next);b.next&&(b.next.prev=b.prev);b.prev&&(b.prev.next=b.next)}function u(b,c){c.top!==b&&(t(b,c),b.next=null,b.prev=c.top,c.top.next=b,c.top=b)}function v(b,c){c.bottom!==
b&&(t(b,c),b.next=c.bottom,b.prev=null,c.bottom.prev=b,c.bottom=b)}function w(b,c,e){t(b,e);c==e.top&&(e.top=b);c.next&&(c.next.prev=b);b.next=c.next;b.prev=c;c.next=b}function y(b,c,e){t(b,e);c==e.bottom&&(e.bottom=b);c.prev&&(c.prev.next=b);b.prev=c.prev;c.prev=b;b.next=c}function z(b){return function(){throw Error("Rapha\u00ebl: you are calling to method \u201c"+b+"\u201d of removed object");}}function B(){this.returnValue=!1}function A(){return this.originalEvent.preventDefault()}function K(){this.cancelBubble=
!0}function O(){return this.originalEvent.stopPropagation()}function E(b){for(var c=b.clientX,e=b.clientY,d,f=Rb.length;f--;){d=Rb[f];if($)for(var g=b.touches.length,h;g--;){if(h=b.touches[g],h.identifier==d.el._drag.id){c=h.clientX;e=h.clientY;(b.originalEvent?b.originalEvent:b).preventDefault();break}}else b.preventDefault();d.move&&d.move.call(d.el,c-d.el._drag.x,e-d.el._drag.y,c,e)}}function F(){b.unmousemove(E).unmouseup(F);for(var c=Rb.length,e;c--;)e=Rb[c],e.el._drag={},e.end&&e.end.call(e.el);
Rb=[]}function U(){return this.x+Y+this.y}function H(c,e){return function(d,f,g){d=ja(d);for(var h,k,l,p,q="",r={},s=0,t=0,u=d.length;t<u;t++){l=d[t];if("M"==l[0])h=+l[1],k=+l[2];else{p=ed(h,k,l[1],l[2],l[3],l[4],l[5],l[6]);if(s+p>f){if(e&&!r.start){h=ld(h,k,l[1],l[2],l[3],l[4],l[5],l[6],f-s);q+=["C",h.start.x,h.start.y,h.m.x,h.m.y,h.x,h.y];if(g)return q;r.start=q;q=["M",h.x,h.y+"C",h.n.x,h.n.y,h.end.x,h.end.y,l[5],l[6]][fa]();s+=p;h=+l[5];k=+l[6];continue}if(!c&&!e)return h=ld(h,k,l[1],l[2],l[3],
l[4],l[5],l[6],f-s),{x:h.x,y:h.y,alpha:h.alpha}}s+=p;h=+l[5];k=+l[6]}q+=l}r.end=q;h=c?s:e?r:b.findDotsAtSegment(h,k,l[1],l[2],l[3],l[4],l[5],l[6],1);h.alpha&&(h={x:h.x,y:h.y,alpha:h.alpha});return h}}function G(){var c=+new Date,e;for(e in Pb)if("length"!=e&&Pb[Z](e)){var d=Pb[e];if(d.stop||d.el.removed)delete Pb[e],Pb[T]--;else{var f=c-d.start,g=d.ms,h=d.easing,k=d.from,l=d.diff,p=d.to,q=d.t,r=d.prev||0,s=d.el,t=d.callback,u={},w;if(f<g){var t=b.easing_formulas[h]?b.easing_formulas[h](f/g):f/g,v;
for(v in k)if(k[Z](v)){switch(Ta[v]){case "along":w=t*g*l[v];p.back&&(w=p.len-w);h=fd(p[v],w);s.translate(l.sx-l.x||0,l.sy-l.y||0);l.x=h.x;l.y=h.y;s.translate(h.x-l.sx,h.y-l.sy);p.rot&&s.rotate(l.r+h.alpha,h.x,h.y);break;case ya:w=+k[v]+t*g*l[v];break;case "colour":w="rgb("+[aa(Pa(k[v].r+t*g*l[v].r)),aa(Pa(k[v].g+t*g*l[v].g)),aa(Pa(k[v].b+t*g*l[v].b))][fa](",")+")";break;case "path":w=[];for(var h=0,y=k[v][T];h<y;h++){w[h]=[k[v][h][0]];for(var z=1,x=k[v][h][T];z<x;z++)w[h][z]=+k[v][h][z]+t*g*l[v][h][z];
w[h]=w[h][fa](Y)}w=w[fa](Y);break;case "csv":switch(v){case "translation":w=l[v][0]*(f-r);h=l[v][1]*(f-r);q.x+=w;q.y+=h;w=w+Y+h;break;case "rotation":w=+k[v][0]+t*g*l[v][0];k[v][1]&&(w+=","+k[v][1]+","+k[v][2]);break;case "scale":w=[+k[v][0]+t*g*l[v][0],+k[v][1]+t*g*l[v][1],2 in p[v]?p[v][2]:ra,3 in p[v]?p[v][3]:ra][fa](Y);break;case "clip-rect":w=[];for(h=4;h--;)w[h]=+k[v][h]+t*g*l[v][h]}}u[v]=w}s.attr(u);s._run&&s._run.call(s)}else p.along&&(h=fd(p.along,p.len*!p.back),s.translate(l.sx-(l.x||0)+
h.x-l.sx,l.sy-(l.y||0)+h.y-l.sy),p.rot&&s.rotate(l.r+h.alpha,h.x,h.y)),(q.x||q.y)&&s.translate(-q.x,-q.y),p.scale&&(p.scale+=ra),s.attr(p),delete Pb[e],Pb[T]--,s.in_animation=null,b.is(t,"function")&&t.call(s);d.prev=f}}b.svg&&s&&s.paper&&s.paper.safari();Pb[T]&&ca.setTimeout(G)}function aa(b){return xa(Aa(b,255),0)}function D(b,c){if(null==b)return{x:this._.tx,y:this._.ty,toString:U};this._.tx+=+b;this._.ty+=+c;switch(this.type){case "circle":case "ellipse":this.attr({cx:+b+this.attrs.cx,cy:+c+this.attrs.cy});
break;case "rect":case "image":case "text":this.attr({x:+b+this.attrs.x,y:+c+this.attrs.y});break;case "path":var e=La(this.attrs.path);e[0][1]+=+b;e[0][2]+=+c;this.attr({path:e})}return this}function M(c){return function(e,d,f,g){var h={back:c};b.is(f,"function")?g=f:h.rot=f;e&&e.constructor==la&&(e=e.attrs.path);e&&(h.along=e);return this.animate(h,d,g)}}function I(b){this.items=[];this[T]=0;this.type="set";if(b)for(var c=0,e=b[T];c<e;c++)if(b[c]&&(b[c].constructor==la||b[c].constructor==I))this[this.items[T]]=
this.items[this.items[T]]=b[c],this[T]++}b.version="1.4.7";var Q=/[, ]+/,V=/^(circle|rect|path|ellipse|text|image)$/,C="prototype",Z="hasOwnProperty",N=document,ca=window,R=Object[C][Z].call(ca,"Raphael"),X=ca.Raphael,ba="appendChild",na="apply",S="concat",$="createTouch"in N,ra="",Y=" ",ta=String,Na="split",Qa="click dblclick mousedown mousemove mouseout mouseover mouseup touchstart touchmove touchend orientationchange touchcancel gesturestart gesturechange gestureend"[Na](Y),Oa={mousedown:"touchstart",
mousemove:"touchmove",mouseup:"touchend"},fa="join",T="length",ia=String[C].toLowerCase,ea=Math,xa=ea.max,Aa=ea.min,ya="number",Ba="string",Ua="array",ha="toString",Ra=Object[C][ha],Ha=ea.pow,sa="push",eb=/^(?=[\da-f]$)/,Xa=/^url\(['"]?([^\)]+?)['"]?\)$/i,zb=/^\s*((#[a-f\d]{6})|(#[a-f\d]{3})|rgba?\(\s*([\d\.]+\s*,\s*[\d\.]+\s*,\s*[\d\.]+(?:\s*,\s*[\d\.]+)?)\s*\)|rgba?\(\s*([\d\.]+%\s*,\s*[\d\.]+%\s*,\s*[\d\.]+%(?:\s*,\s*[\d\.]+%)?)\s*\)|hsb\(\s*([\d\.]+(?:deg|\xb0)?\s*,\s*[\d\.]+\s*,\s*[\d\.]+)\s*\)|hsb\(\s*([\d\.]+(?:deg|\xb0|%)\s*,\s*[\d\.]+%\s*,\s*[\d\.]+%)\s*\)|hsl\(\s*([\d\.]+(?:deg|\xb0)?\s*,\s*[\d\.]+\s*,\s*[\d\.]+)\s*\)|hsl\(\s*([\d\.]+(?:deg|\xb0|%)\s*,\s*[\d\.]+%\s*,\s*[\d\.]+%)\s*\))\s*$/i,
Pa=ea.round,va=parseFloat,db=parseInt,Ib=String[C].toUpperCase,Va={blur:0,"clip-rect":"0 0 1e9 1e9",cursor:"default",cx:0,cy:0,fill:"#fff","fill-opacity":1,font:'10px "Arial"',"font-family":'"Arial"',"font-size":"10","font-style":"normal","font-weight":400,gradient:0,height:0,href:"http://raphaeljs.com/",opacity:1,path:"M0,0",r:0,rotation:0,rx:0,ry:0,scale:"1 1",src:"",stroke:"#000","stroke-dasharray":"","stroke-linecap":"butt","stroke-linejoin":"butt","stroke-miterlimit":0,"stroke-opacity":1,"stroke-width":1,
target:"_blank","text-anchor":"middle",title:"Raphael",translation:"0 0",width:0,x:0,y:0},Ta={along:"along",blur:ya,"clip-rect":"csv",cx:ya,cy:ya,fill:"colour","fill-opacity":ya,"font-size":ya,height:ya,opacity:ya,path:"path",r:ya,rotation:"csv",rx:ya,ry:ya,scale:"csv",stroke:"colour","stroke-opacity":ya,"stroke-width":ya,translation:"csv",width:ya,x:ya,y:ya},Ka="replace";b.type=ca.SVGAngle||N.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML";if("VML"==
b.type){var bb=N.createElement("div");bb.innerHTML='<v:shape adj="1"/>';bb=bb.firstChild;bb.style.behavior="url(#default#VML)";if(!(bb&&"object"==typeof bb.adj))return b.type=null;bb=null}b.svg=!(b.vml="VML"==b.type);d[C]=b[C];b._id=0;b._oid=0;b.fn={};b.is=function(b,c){c=ia.call(c);return"object"==c&&b===Object(b)||"undefined"==c&&typeof b==c||"null"==c&&null==b||"array"==c&&Array.isArray&&Array.isArray(b)||ia.call(Ra.call(b).slice(8,-1))==c};b.setWindow=function(b){ca=b;N=ca.document};b.hsb2rgb=
function(c,e,d){b.is(c,"object")&&("h"in c&&"s"in c&&"b"in c)&&(d=c.b,e=c.s,c=c.h);return b.hsl2rgb(c,e,d/2)};b.hsl2rgb=function(c,e,d){b.is(c,"object")&&("h"in c&&"s"in c&&"l"in c)&&(d=c.l,e=c.s,c=c.h);if(1<c||1<e||1<d)c/=255,e/=255,d/=255;var f={},h=["r","g","b"],k;if(e){e=0.5>d?d*(1+e):d+e-d*e;d=2*d-e;for(var l=0,p=h.length;l<p;l++)k=c+1/3*-(l-1),0>k&&k++,1<k&&k--,f[h[l]]=1>6*k?d+6*(e-d)*k:1>2*k?e:2>3*k?d+6*(e-d)*(2/3-k):d}else f={r:d,g:d,b:d};f.r*=255;f.g*=255;f.b*=255;c=(~~f.r)[ha](16);h=(~~f.g)[ha](16);
e=(~~f.b)[ha](16);c=c[Ka](eb,"0");h=h[Ka](eb,"0");e=e[Ka](eb,"0");f.hex="#"+c+h+e;f.toString=g;return f};b.rgb2hsb=function(c,d,f){null==d&&(b.is(c,"object")&&"r"in c&&"g"in c&&"b"in c)&&(f=c.b,d=c.g,c=c.r);null==d&&b.is(c,Ba)&&(f=b.getRGB(c),c=f.r,d=f.g,f=f.b);if(1<c||1<d||1<f)c/=255,d/=255,f/=255;var g=xa(c,d,f),h=Aa(c,d,f);if(h==g)return{h:0,s:0,b:g,toString:e};h=g-h;c=(c==g?(d-f)/h:d==g?2+(f-c)/h:4+(c-d)/h)/6;0>c&&c++;1<c&&c--;return{h:c,s:h/g,b:g,toString:e}};b.rgb2hsl=function(c,e,d){null==
e&&(b.is(c,"object")&&"r"in c&&"g"in c&&"b"in c)&&(d=c.b,e=c.g,c=c.r);if(null==e&&b.is(c,Ba)){var g=b.getRGB(c);c=g.r;e=g.g;d=g.b}if(1<c||1<e||1<d)c/=255,e/=255,d/=255;var h=xa(c,e,d),k=Aa(c,e,d),g=(h+k)/2;if(k==h)c={h:0,s:0,l:g};else{var l=h-k;c=(c==h?(e-d)/l:e==h?2+(d-c)/l:4+(c-e)/l)/6;0>c&&c++;1<c&&c--;c={h:c,s:0.5>g?l/(h+k):l/(2-h-k),l:g}}c.toString=f;return c};var fb=/,?([achlmqrstvxz]),?/gi,wa=/\s*,\s*/,oa={hs:1,rg:1};b._path2string=function(){return this.join(",")[Ka](fb,"$1")};b.getRGB=h(function(e){if(!e||
(e=ta(e)).indexOf("-")+1)return{r:-1,g:-1,b:-1,hex:"none",error:1};if("none"==e)return{r:-1,g:-1,b:-1,hex:"none"};!(oa[Z](e.substring(0,2))||"#"==e.charAt())&&(e=c(e));var d,f,g,h,k;if(e=e.match(zb)){e[2]&&(g=db(e[2].substring(5),16),f=db(e[2].substring(3,5),16),d=db(e[2].substring(1,3),16));e[3]&&(g=db((k=e[3].charAt(3))+k,16),f=db((k=e[3].charAt(2))+k,16),d=db((k=e[3].charAt(1))+k,16));e[4]&&(e=e[4][Na](wa),d=va(e[0]),f=va(e[1]),g=va(e[2]),h=va(e[3]));e[5]&&(e=e[5][Na](wa),d=2.55*va(e[0]),f=2.55*
va(e[1]),g=2.55*va(e[2]),h=va(e[3]));if(e[6])return e=e[6][Na](wa),d=va(e[0]),f=va(e[1]),g=va(e[2]),("deg"==e[0].slice(-3)||"\u00b0"==e[0].slice(-1))&&(d/=360),b.hsb2rgb(d,f,g);if(e[7])return e=e[7][Na](wa),d=2.55*va(e[0]),f=2.55*va(e[1]),g=2.55*va(e[2]),("deg"==e[0].slice(-3)||"\u00b0"==e[0].slice(-1))&&(d/=360*2.55),b.hsb2rgb(d,f,g);if(e[8])return e=e[8][Na](wa),d=va(e[0]),f=va(e[1]),g=va(e[2]),("deg"==e[0].slice(-3)||"\u00b0"==e[0].slice(-1))&&(d/=360),b.hsl2rgb(d,f,g);if(e[9])return e=e[9][Na](wa),
d=2.55*va(e[0]),f=2.55*va(e[1]),g=2.55*va(e[2]),("deg"==e[0].slice(-3)||"\u00b0"==e[0].slice(-1))&&(d/=360*2.55),b.hsl2rgb(d,f,g);e={r:d,g:f,b:g};d=(~~d)[ha](16);f=(~~f)[ha](16);g=(~~g)[ha](16);d=d[Ka](eb,"0");f=f[Ka](eb,"0");g=g[Ka](eb,"0");e.hex="#"+d+f+g;isFinite(va(h))&&(e.o=h);return e}return{r:-1,g:-1,b:-1,hex:"none",error:1}},b);b.getColor=function(b){b=this.getColor.start=this.getColor.start||{h:0,s:1,b:b||0.75};var c=this.hsb2rgb(b.h,b.s,b.b);b.h+=0.075;1<b.h&&(b.h=0,b.s-=0.2,0>=b.s&&(this.getColor.start=
{h:0,s:1,b:b.b}));return c.hex};b.getColor.reset=function(){delete this.start};var Ia=/([achlmqstvz])[\s,]*((-?\d*\.?\d*(?:e[-+]?\d+)?\s*,?\s*)+)/ig,x=/(-?\d*\.?\d*(?:e[-+]?\d+)?)\s*,?\s*/ig;b.parsePathString=h(function(c){if(!c)return null;var e={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},d=[];b.is(c,Ua)&&b.is(c[0],Ua)&&(d=k(c));d[T]||ta(c)[Ka](Ia,function(b,c,f){var g=[];b=ia.call(c);f[Ka](x,function(b,c){c&&g[sa](+c)});"m"==b&&2<g[T]&&(d[sa]([c][S](g.splice(0,2))),b="l",c="m"==c?"l":"L");for(;g[T]>=
e[b]&&!(d[sa]([c][S](g.splice(0,e[b]))),!e[b]););});d[ha]=b._path2string;return d});b.findDotsAtSegment=function(b,c,e,d,f,g,h,k,l){var p=1-l,q=Ha(p,3)*b+3*Ha(p,2)*l*e+3*p*l*l*f+Ha(l,3)*h,p=Ha(p,3)*c+3*Ha(p,2)*l*d+3*p*l*l*g+Ha(l,3)*k,r=b+2*l*(e-b)+l*l*(f-2*e+b),s=c+2*l*(d-c)+l*l*(g-2*d+c),t=e+2*l*(f-e)+l*l*(h-2*f+e),u=d+2*l*(g-d)+l*l*(k-2*g+d);b=(1-l)*b+l*e;c=(1-l)*c+l*d;f=(1-l)*f+l*h;g=(1-l)*g+l*k;k=90-180*ea.atan((r-t)/(s-u))/ea.PI;(r>t||s<u)&&(k+=180);return{x:q,y:p,m:{x:r,y:s},n:{x:t,y:u},start:{x:b,
y:c},end:{x:f,y:g},alpha:k}};var cb=h(function(b){if(!b)return{x:0,y:0,width:0,height:0};b=ja(b);for(var c=0,e=0,d=[],f=[],g,h=0,k=b[T];h<k;h++)g=b[h],"M"==g[0]?(c=g[1],e=g[2],d[sa](c),f[sa](e)):(c=Ab(c,e,g[1],g[2],g[3],g[4],g[5],g[6]),d=d[S](c.min.x,c.max.x),f=f[S](c.min.y,c.max.y),c=g[5],e=g[6]);b=Aa[na](0,d);g=Aa[na](0,f);return{x:b,y:g,width:xa[na](0,d)-b,height:xa[na](0,f)-g}}),La=h(function(c){if(!b.is(c,Ua)||!b.is(c&&c[0],Ua))c=b.parsePathString(c);var e=[],d=0,f=0,g=0,h=0,k=0;"M"==c[0][0]&&
(d=c[0][1],f=c[0][2],g=d,h=f,k++,e[sa](["M",d,f]));for(var l=c[T];k<l;k++){var p=e[k]=[],q=c[k];if(q[0]!=ia.call(q[0]))switch(p[0]=ia.call(q[0]),p[0]){case "a":p[1]=q[1];p[2]=q[2];p[3]=q[3];p[4]=q[4];p[5]=q[5];p[6]=+(q[6]-d).toFixed(3);p[7]=+(q[7]-f).toFixed(3);break;case "v":p[1]=+(q[1]-f).toFixed(3);break;case "m":g=q[1],h=q[2];default:for(var r=1,s=q[T];r<s;r++)p[r]=+(q[r]-(r%2?d:f)).toFixed(3)}else{e[k]=[];"m"==q[0]&&(g=q[1]+d,h=q[2]+f);p=0;for(r=q[T];p<r;p++)e[k][p]=q[p]}q=e[k][T];switch(e[k][0]){case "z":d=
g;f=h;break;case "h":d+=+e[k][q-1];break;case "v":f+=+e[k][q-1];break;default:d+=+e[k][q-2],f+=+e[k][q-1]}}e[ha]=b._path2string;return e},0,k),jb=h(function(c){if(!b.is(c,Ua)||!b.is(c&&c[0],Ua))c=b.parsePathString(c);var e=[],d=0,f=0,g=0,h=0,k=0;"M"==c[0][0]&&(d=+c[0][1],f=+c[0][2],g=d,h=f,k++,e[0]=["M",d,f]);for(var l=c[T];k<l;k++){var p=e[k]=[],q=c[k];if(q[0]!=Ib.call(q[0]))switch(p[0]=Ib.call(q[0]),p[0]){case "A":p[1]=q[1];p[2]=q[2];p[3]=q[3];p[4]=q[4];p[5]=q[5];p[6]=+(q[6]+d);p[7]=+(q[7]+f);break;
case "V":p[1]=+q[1]+f;break;case "H":p[1]=+q[1]+d;break;case "M":g=+q[1]+d,h=+q[2]+f;default:for(var r=1,s=q[T];r<s;r++)p[r]=+q[r]+(r%2?d:f)}else{r=0;for(s=q[T];r<s;r++)e[k][r]=q[r]}switch(p[0]){case "Z":d=g;f=h;break;case "H":d=p[1];break;case "V":f=p[1];break;case "M":g=e[k][e[k][T]-2],h=e[k][e[k][T]-1];default:d=e[k][e[k][T]-2],f=e[k][e[k][T]-1]}}e[ha]=b._path2string;return e},null,k),Ab=h(function(b,c,e,d,f,g,h,k){var l=f-2*e+b-(h-2*f+e),p=2*(e-b)-2*(f-e),r=b-e,s=(-p+ea.sqrt(p*p-4*l*r))/2/l,l=
(-p-ea.sqrt(p*p-4*l*r))/2/l,t=[c,k],u=[b,h];1E12<ea.abs(s)&&(s=0.5);1E12<ea.abs(l)&&(l=0.5);0<s&&1>s&&(s=q(b,c,e,d,f,g,h,k,s),u[sa](s.x),t[sa](s.y));0<l&&1>l&&(s=q(b,c,e,d,f,g,h,k,l),u[sa](s.x),t[sa](s.y));l=g-2*d+c-(k-2*g+d);p=2*(d-c)-2*(g-d);r=c-d;s=(-p+ea.sqrt(p*p-4*l*r))/2/l;l=(-p-ea.sqrt(p*p-4*l*r))/2/l;1E12<ea.abs(s)&&(s=0.5);1E12<ea.abs(l)&&(l=0.5);0<s&&1>s&&(s=q(b,c,e,d,f,g,h,k,s),u[sa](s.x),t[sa](s.y));0<l&&1>l&&(s=q(b,c,e,d,f,g,h,k,l),u[sa](s.x),t[sa](s.y));return{min:{x:Aa[na](0,u),y:Aa[na](0,
t)},max:{x:xa[na](0,u),y:xa[na](0,t)}}}),ja=h(function(b,c){function e(b,c){var d;if(!b)return["C",c.x,c.y,c.x,c.y,c.x,c.y];!(b[0]in{T:1,Q:1})&&(c.qx=c.qy=null);switch(b[0]){case "M":c.X=b[1];c.Y=b[2];break;case "A":b=["C"][S](p[na](0,[c.x,c.y][S](b.slice(1))));break;case "S":d=c.x+(c.x-(c.bx||c.x));c=c.y+(c.y-(c.by||c.y));b=["C",d,c][S](b.slice(1));break;case "T":c.qx=c.x+(c.x-(c.qx||c.x));c.qy=c.y+(c.y-(c.qy||c.y));b=["C"][S](l(c.x,c.y,c.qx,c.qy,b[1],b[2]));break;case "Q":c.qx=b[1];c.qy=b[2];b=
["C"][S](l(c.x,c.y,b[1],b[2],b[3],b[4]));break;case "L":b=["C"][S]([c.x,c.y,b[1],b[2],b[1],b[2]]);break;case "H":b=["C"][S]([c.x,c.y,b[1],c.y,b[1],c.y]);break;case "V":b=["C"][S]([c.x,c.y,c.x,b[1],c.x,b[1]]);break;case "Z":b=["C"][S]([c.x,c.y,c.X,c.Y,c.X,c.Y])}return b}function d(b,c){if(7<b[c][T]){b[c].shift();for(var e=b[c];e[T];)b.splice(c++,0,["C"][S](e.splice(0,6)));b.splice(c,1);q=xa(g[T],h&&h[T]||0)}}function f(b,c,e,d,k){b&&(c&&"M"==b[k][0]&&"M"!=c[k][0])&&(c.splice(k,0,["M",d.x,d.y]),e.bx=
0,e.by=0,e.x=b[k][1],e.y=b[k][2],q=xa(g[T],h&&h[T]||0))}var g=jb(b),h=c&&jb(c);b={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};c={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null};for(var k=0,q=xa(g[T],h&&h[T]||0);k<q;k++){g[k]=e(g[k],b);d(g,k);h&&(h[k]=e(h[k],c));h&&d(h,k);f(g,h,b,c,k);f(h,g,c,b,k);var r=g[k],s=h&&h[k],t=r[T],u=h&&s[T];b.x=r[t-2];b.y=r[t-1];b.bx=va(r[t-4])||b.x;b.by=va(r[t-3])||b.y;c.bx=h&&(va(s[u-4])||c.x);c.by=h&&(va(s[u-3])||c.y);c.x=h&&s[u-2];c.y=h&&s[u-1]}return h?[g,h]:g},null,k),Vb=
h(function(c){for(var e=[],d=0,f=c[T];d<f;d++){var g={},h=c[d].match(/^([^:]*):?([\d\.]*)/);g.color=b.getRGB(h[1]);if(g.color.error)return null;g.color=g.color.hex;h[2]&&(g.offset=h[2]+"%");e[sa](g)}d=1;for(f=e[T]-1;d<f;d++)if(!e[d].offset){c=va(e[d-1].offset||0);h=0;for(g=d+1;g<f;g++)if(e[g].offset){h=e[g].offset;break}h||(h=100,g=f);h=va(h);for(h=(h-c)/(g-d+1);d<g;d++)c+=h,e[d].offset=c+"%"}return e}),$a=/^r(?:\(([^,]+?)\s*,\s*([^\)]+?)\))?/;b.pathToRelative=La;if(b.svg){d[C].svgns="http://www.w3.org/2000/svg";
d[C].xlink="http://www.w3.org/1999/xlink";var Pa=function(b){return+b+0.5*(~~b===b)},za=function(b,c){if(c)for(var e in c)c[Z](e)&&b.setAttribute(e,ta(c[e]));else return b=N.createElementNS(d[C].svgns,b),b.style.webkitTapHighlightColor="rgba(0,0,0,0)",b};b[ha]=function(){return"Your browser supports SVG.\nYou are running Rapha\u00ebl "+this.version};var yb=function(b,c){var e=za("path");c.canvas&&c.canvas[ba](e);c=new la(e,c);c.type="path";Fb(c,{fill:"none",stroke:"#000",path:b});return c},gc=function(c,
e,d){var f="linear",g=0.5,h=0.5,k=c.style;e=ta(e)[Ka]($a,function(b,c,e){f="radial";c&&e&&(g=va(c),h=va(e),b=2*(0.5<h)-1,0.25<Ha(g-0.5,2)+Ha(h-0.5,2)&&(h=ea.sqrt(0.25-Ha(g-0.5,2))*b+0.5)&&0.5!=h&&(h=h.toFixed(5)-1E-5*b));return ra});e=e[Na](/\s*\-\s*/);if("linear"==f){var l=e.shift(),l=-va(l);if(isNaN(l))return null;var l=[0,0,ea.cos(l*ea.PI/180),ea.sin(l*ea.PI/180)],p=1/(xa(ea.abs(l[2]),ea.abs(l[3]))||1);l[2]*=p;l[3]*=p;0>l[2]&&(l[0]=-l[2],l[2]=0);0>l[3]&&(l[1]=-l[3],l[3]=0)}e=Vb(e);if(!e)return null;
p=c.getAttribute("fill");(p=p.match(/^url\(#(.*)\)$/))&&d.defs.removeChild(N.getElementById(p[1]));p=za(f+"Gradient");p.id="r"+(b._id++)[ha](36);za(p,"radial"==f?{fx:g,fy:h}:{x1:l[0],y1:l[1],x2:l[2],y2:l[3]});d.defs[ba](p);d=0;for(l=e[T];d<l;d++){var q=za("stop");za(q,{offset:e[d].offset?e[d].offset:!d?"0%":"100%","stop-color":e[d].color||"#fff"});p[ba](q)}za(c,{fill:"url(#"+p.id+")",opacity:1,"fill-opacity":1});k.fill=ra;k.opacity=1;return k.fillOpacity=1},Jb=function(c){var e=c.getBBox();za(c.pattern,
{patternTransform:b.format("translate({0},{1})",e.x,e.y)})},Fb=function(c,e){function d(b,c){if(c=f[ia.call(c)]){var h=b.attrs["stroke-width"]||"1";b={round:h,square:h,butt:0}[b.attrs["stroke-linecap"]||e["stroke-linecap"]]||0;for(var k=[],l=c[T];l--;)k[l]=c[l]*h+(l%2?1:-1)*b;za(g,{"stroke-dasharray":k[fa](",")})}}var f={"":[0],none:[0],"-":[3,1],".":[1,1],"-.":[3,1,1,1],"-..":[3,1,1,1,1,1],". ":[1,3],"- ":[4,3],"--":[8,3],"- .":[4,3,1,3],"--.":[8,3,1,3],"--..":[8,3,1,3,1,3]},g=c.node,h=c.attrs,k=
c.rotate();e[Z]("rotation")&&(k=e.rotation);var l=ta(k)[Na](Q);l.length-1?(l[1]=+l[1],l[2]=+l[2]):l=null;va(k)&&c.rotate(0,!0);for(var p in e)if(e[Z](p)&&Va[Z](p)){var q=e[p];h[p]=q;switch(p){case "blur":c.blur(q);break;case "rotation":c.rotate(q,!0);break;case "href":case "title":case "target":var r=g.parentNode;if("a"!=ia.call(r.tagName)){var s=za("a");r.insertBefore(s,g);s[ba](g);r=s}r.setAttributeNS(c.paper.xlink,p,q);break;case "cursor":g.style.cursor=q;break;case "clip-rect":r=ta(q)[Na](Q);
if(4==r[T]){c.clip&&c.clip.parentNode.parentNode.removeChild(c.clip.parentNode);var t=za("clipPath"),s=za("rect");t.id="r"+(b._id++)[ha](36);za(s,{x:r[0],y:r[1],width:r[2],height:r[3]});t[ba](s);c.paper.defs[ba](t);za(g,{"clip-path":"url(#"+t.id+")"});c.clip=s}q||((q=N.getElementById(g.getAttribute("clip-path")[Ka](/(^url\(#|\)$)/g,ra)))&&q.parentNode.removeChild(q),za(g,{"clip-path":ra}),delete c.clip);break;case "path":"path"==c.type&&za(g,{d:q?h.path=jb(q):"M0,0"});break;case "width":if(g.setAttribute(p,
q),h.fx)p="x",q=h.x;else break;case "x":h.fx&&(q=-h.x-(h.width||0));case "rx":if("rx"==p&&"rect"==c.type)break;case "cx":l&&("x"==p||"cx"==p)&&(l[1]+=q-h[p]);g.setAttribute(p,q);c.pattern&&Jb(c);break;case "height":if(g.setAttribute(p,q),h.fy)p="y",q=h.y;else break;case "y":h.fy&&(q=-h.y-(h.height||0));case "ry":if("ry"==p&&"rect"==c.type)break;case "cy":l&&("y"==p||"cy"==p)&&(l[2]+=q-h[p]);g.setAttribute(p,q);c.pattern&&Jb(c);break;case "r":"rect"==c.type?za(g,{rx:q,ry:q}):g.setAttribute(p,q);break;
case "src":"image"==c.type&&g.setAttributeNS(c.paper.xlink,"href",q);break;case "stroke-width":g.style.strokeWidth=q;g.setAttribute(p,q);h["stroke-dasharray"]&&d(c,h["stroke-dasharray"]);break;case "stroke-dasharray":d(c,q);break;case "translation":q=ta(q)[Na](Q);q[0]=+q[0]||0;q[1]=+q[1]||0;l&&(l[1]+=q[0],l[2]+=q[1]);D.call(c,q[0],q[1]);break;case "scale":q=ta(q)[Na](Q);c.scale(+q[0]||1,+q[1]||+q[0]||1,isNaN(va(q[2]))?null:+q[2],isNaN(va(q[3]))?null:+q[3]);break;case "fill":if(r=ta(q).match(Xa)){var t=
za("pattern"),u=za("image");t.id="r"+(b._id++)[ha](36);za(t,{x:0,y:0,patternUnits:"userSpaceOnUse",height:1,width:1});za(u,{x:0,y:0});u.setAttributeNS(c.paper.xlink,"href",r[1]);t[ba](u);q=N.createElement("img");q.style.cssText="position:absolute;left:-9999em;top-9999em";q.onload=function(){za(t,{width:this.offsetWidth,height:this.offsetHeight});za(u,{width:this.offsetWidth,height:this.offsetHeight});N.body.removeChild(this);c.paper.safari()};N.body[ba](q);q.src=r[1];c.paper.defs[ba](t);g.style.fill=
"url(#"+t.id+")";za(g,{fill:"url(#"+t.id+")"});c.pattern=t;c.pattern&&Jb(c);break}r=b.getRGB(q);if(r.error){if(({circle:1,ellipse:1}[Z](c.type)||"r"!=ta(q).charAt())&&gc(g,q,c.paper)){h.gradient=q;h.fill="none";break}}else delete e.gradient,delete h.gradient,!b.is(h.opacity,"undefined")&&b.is(e.opacity,"undefined")&&za(g,{opacity:h.opacity}),!b.is(h["fill-opacity"],"undefined")&&b.is(e["fill-opacity"],"undefined")&&za(g,{"fill-opacity":h["fill-opacity"]});r[Z]("o")&&za(g,{"fill-opacity":1<r.o?r.o/
100:r.o});case "stroke":r=b.getRGB(q);g.setAttribute(p,r.hex);"stroke"==p&&r[Z]("o")&&za(g,{"stroke-opacity":1<r.o?r.o/100:r.o});break;case "gradient":({circle:1,ellipse:1}[Z](c.type)||"r"!=ta(q).charAt())&&gc(g,q,c.paper);break;case "opacity":case "fill-opacity":if(h.gradient){if(r=N.getElementById(g.getAttribute("fill")[Ka](/^url\(#|\)$/g,ra)))r=r.getElementsByTagName("stop"),r[r[T]-1].setAttribute("stop-opacity",q);break}default:"font-size"==p&&(q=db(q,10)+"px"),r=p[Ka](/(\-.)/g,function(b){return Ib.call(b.substring(1))}),
g.style[r]=q,g.setAttribute(p,q)}}rc(c,e);l?c.rotate(l.join(Y)):va(k)&&c.rotate(k,!0)},rc=function(b,c){if(!("text"!=b.type||!c[Z]("text")&&!c[Z]("font")&&!c[Z]("font-size")&&!c[Z]("x")&&!c[Z]("y"))){var e=b.attrs,d=b.node,f=d.firstChild?db(N.defaultView.getComputedStyle(d.firstChild,ra).getPropertyValue("font-size"),10):10;if(c[Z]("text")){for(e.text=c.text;d.firstChild;)d.removeChild(d.firstChild);c=ta(c.text)[Na]("\n");for(var g=0,h=c[T];g<h;g++)if(c[g]){var k=za("tspan");g&&za(k,{dy:1.2*f,x:e.x});
k[ba](N.createTextNode(c[g]));d[ba](k)}}else{c=d.getElementsByTagName("tspan");g=0;for(h=c[T];g<h;g++)g&&za(c[g],{dy:1.2*f,x:e.x})}za(d,{y:e.y});b=b.getBBox();(b=e.y-(b.y+b.height/2))&&isFinite(b)&&za(d,{y:e.y+b})}},la=function(c,e){this[0]=c;this.id=b._oid++;this.node=c;c.raphael=this;this.paper=e;this.attrs=this.attrs||{};this.transformations=[];this._={tx:0,ty:0,rt:{deg:0,cx:0,cy:0},sx:1,sy:1};!e.bottom&&(e.bottom=this);(this.prev=e.top)&&(e.top.next=this);e.top=this;this.next=null};la[C].rotate=
function(c,e,d){if(this.removed)return this;if(null==c)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][fa](Y):this._.rt.deg;var f=this.getBBox();c=ta(c)[Na](Q);c[T]-1&&(e=va(c[1]),d=va(c[2]));c=va(c[0]);this._.rt.deg=null!=e?c:this._.rt.deg+c;null==d&&(e=null);this._.rt.cx=e;this._.rt.cy=d;e=null==e?f.x+f.width/2:e;d=null==d?f.y+f.height/2:d;this._.rt.deg?(this.transformations[0]=b.format("rotate({0} {1} {2})",this._.rt.deg,e,d),this.clip&&za(this.clip,{transform:b.format("rotate({0} {1} {2})",
-this._.rt.deg,e,d)})):(this.transformations[0]=ra,this.clip&&za(this.clip,{transform:ra}));za(this.node,{transform:this.transformations[fa](Y)});return this};la[C].hide=function(){!this.removed&&(this.node.style.display="none");return this};la[C].show=function(){!this.removed&&(this.node.style.display="");return this};la[C].remove=function(){if(!this.removed){t(this,this.paper);this.node.parentNode.removeChild(this.node);for(var b in this)delete this[b];this.removed=!0}};la[C].getBBox=function(){if(this.removed)return this;
if("path"==this.type)return cb(this.attrs.path);if("none"==this.node.style.display){this.show();var b=!0}var c={};try{c=this.node.getBBox()}catch(e){}finally{c=c||{}}if("text"==this.type)for(var c={x:c.x,y:Infinity,width:0,height:0},d=0,f=this.node.getNumberOfChars();d<f;d++){var g=this.node.getExtentOfChar(d);g.y<c.y&&(c.y=g.y);g.y+g.height-c.y>c.height&&(c.height=g.y+g.height-c.y);g.x+g.width-c.x>c.width&&(c.width=g.x+g.width-c.x)}b&&this.hide();return c};la[C].attr=function(c,e){if(this.removed)return this;
if(null==c){c={};for(var d in this.attrs)this.attrs[Z](d)&&(c[d]=this.attrs[d]);this._.rt.deg&&(c.rotation=this.rotate());(1!=this._.sx||1!=this._.sy)&&(c.scale=this.scale());c.gradient&&"none"==c.fill&&(c.fill=c.gradient)&&delete c.gradient;return c}if(null==e&&b.is(c,Ba))return"translation"==c?D.call(this):"rotation"==c?this.rotate():"scale"==c?this.scale():"fill"==c&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[c];if(null==e&&b.is(c,Ua)){e={};d=0;for(var f=c.length;d<
f;d++)e[c[d]]=this.attr(c[d]);return e}null!=e?(d={},d[c]=e,Fb(this,d)):null!=c&&b.is(c,"object")&&Fb(this,c);return this};la[C].toFront=function(){if(this.removed)return this;this.node.parentNode[ba](this.node);var b=this.paper;b.top!=this&&u(this,b);return this};la[C].toBack=function(){if(this.removed)return this;this.node.parentNode.firstChild!=this.node&&(this.node.parentNode.insertBefore(this.node,this.node.parentNode.firstChild),v(this,this.paper));return this};la[C].insertAfter=function(b){if(this.removed)return this;
var c=b.node||b[b.length].node;c.nextSibling?c.parentNode.insertBefore(this.node,c.nextSibling):c.parentNode[ba](this.node);w(this,b,this.paper);return this};la[C].insertBefore=function(b){if(this.removed)return this;var c=b.node||b[0].node;c.parentNode.insertBefore(this.node,c);y(this,b,this.paper);return this};la[C].blur=function(c){if(0!==+c){var e=za("filter"),d=za("feGaussianBlur");this.attrs.blur=c;e.id="r"+(b._id++)[ha](36);za(d,{stdDeviation:+c||1.5});e.appendChild(d);this.paper.defs.appendChild(e);
this._blur=e;za(this.node,{filter:"url(#"+e.id+")"})}else this._blur&&(this._blur.parentNode.removeChild(this._blur),delete this._blur,delete this.attrs.blur),this.node.removeAttribute("filter")};var ob=function(b,c,e,d){var f=za("circle");b.canvas&&b.canvas[ba](f);b=new la(f,b);b.attrs={cx:c,cy:e,r:d,fill:"none",stroke:"#000"};b.type="circle";za(f,b.attrs);return b},Bc=function(b,c,e,d,f,g){var h=za("rect");b.canvas&&b.canvas[ba](h);b=new la(h,b);b.attrs={x:c,y:e,width:d,height:f,r:g||0,rx:g||0,
ry:g||0,fill:"none",stroke:"#000"};b.type="rect";za(h,b.attrs);return b},hc=function(b,c,e,d,f){var g=za("ellipse");b.canvas&&b.canvas[ba](g);b=new la(g,b);b.attrs={cx:c,cy:e,rx:d,ry:f,fill:"none",stroke:"#000"};b.type="ellipse";za(g,b.attrs);return b},Gc=function(b,c,e,d,f,g){var h=za("image");za(h,{x:e,y:d,width:f,height:g,preserveAspectRatio:"none"});h.setAttributeNS(b.xlink,"href",c);b.canvas&&b.canvas[ba](h);b=new la(h,b);b.attrs={x:e,y:d,width:f,height:g,src:c};b.type="image";return b},sc=function(b,
c,e,d){var f=za("text");za(f,{x:c,y:e,"text-anchor":"middle"});b.canvas&&b.canvas[ba](f);b=new la(f,b);b.attrs={x:c,y:e,"text-anchor":"middle",text:d,font:Va.font,stroke:"none",fill:"#000"};b.type="text";Fb(b,b.attrs);return b},oc=function(b,c){this.width=b||this.width;this.height=c||this.height;this.canvas.setAttribute("width",this.width);this.canvas.setAttribute("height",this.height);return this},ga=function(){var c=r[na](0,arguments),e=c&&c.container,f=c.x,g=c.y,h=c.width,c=c.height;if(!e)throw Error("SVG container not found.");
var k=za("svg"),f=f||0,g=g||0,h=h||512,c=c||342;za(k,{xmlns:"http://www.w3.org/2000/svg",version:1.1,width:h,height:c});1==e?(k.style.cssText="position:absolute;left:"+f+"px;top:"+g+"px",N.body[ba](k)):e.firstChild?e.insertBefore(k,e.firstChild):e[ba](k);e=new d;e.width=h;e.height=c;e.canvas=k;s.call(e,e,b.fn);e.clear();return e};d[C].clear=function(){for(var b=this.canvas;b.firstChild;)b.removeChild(b.firstChild);this.bottom=this.top=null;(this.desc=za("desc"))[ba](N.createTextNode("Created with Rapha\u00ebl"));
b[ba](this.desc);b[ba](this.defs=za("defs"))};d[C].remove=function(){this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=z(b)}}if(b.vml){var Hc={M:"m",L:"l",C:"c",Z:"x",m:"t",l:"r",c:"v",z:"x"},Gb=/([clmz]),?([^clmz]*)/gi,Kb=/-?[^,\s-]+/g,Qb=1E3+Y+1E3,Lb={path:1,rect:1},xc=function(b){var c=/[ahqstv]/ig,e=jb;ta(b).match(c)&&(e=ja);c=/[clmz]/g;if(e==jb&&!ta(b).match(c))return b=ta(b)[Ka](Gb,function(b,c,e){var d=[],f="m"==ia.call(c),g=Hc[c];e[Ka](Kb,function(b){f&&
2==d[T]&&(g+=d+Hc["m"==c?"l":"L"],d=[]);d[sa](Pa(10*b))});return g+d});var c=e(b),d;b=[];for(var f=0,g=c[T];f<g;f++){e=c[f];d=ia.call(c[f][0]);"z"==d&&(d="x");for(var h=1,k=e[T];h<k;h++)d+=Pa(10*e[h])+(h!=k-1?",":ra);b[sa](d)}return b[fa](Y)};b[ha]=function(){return"Your browser doesn\u2019t support SVG. Falling down to VML.\nYou are running Rapha\u00ebl "+this.version};yb=function(b,c){var e=Bb("group");e.style.cssText="position:absolute;left:0;top:0;width:"+c.width+"px;height:"+c.height+"px";e.coordsize=
c.coordsize;e.coordorigin=c.coordorigin;var d=Bb("shape"),f=d.style;f.width=c.width+"px";f.height=c.height+"px";d.coordsize=Qb;d.coordorigin=c.coordorigin;e[ba](d);d=new la(d,e,c);f={fill:"none",stroke:"#000"};b&&(f.path=b);d.isAbsolute=!0;d.type="path";d.path=[];d.Path=ra;Fb(d,f);c.canvas[ba](e);return d};Fb=function(c,e){c.attrs=c.attrs||{};var d=c.node,f=c.attrs,g=d.style,h;h=(e.x!=f.x||e.y!=f.y||e.width!=f.width||e.height!=f.height||e.r!=f.r)&&"rect"==c.type;var k=c,l;for(l in e)e[Z](l)&&(f[l]=
e[l]);h&&(f.path=uc(f.x,f.y,f.width,f.height,f.r),c.X=f.x,c.Y=f.y,c.W=f.width,c.H=f.height);e.href&&(d.href=e.href);e.title&&(d.title=e.title);e.target&&(d.target=e.target);e.cursor&&(g.cursor=e.cursor);"blur"in e&&c.blur(e.blur);if(e.path&&"path"==c.type||h)d.path=xc(f.path);null!=e.rotation&&c.rotate(e.rotation,!0);e.translation&&(h=ta(e.translation)[Na](Q),D.call(c,h[0],h[1]),null!=c._.rt.cx&&(c._.rt.cx+=+h[0],c._.rt.cy+=+h[1],c.setBox(c.attrs,h[0],h[1])));e.scale&&(h=ta(e.scale)[Na](Q),c.scale(+h[0]||
1,+h[1]||+h[0]||1,+h[2]||null,+h[3]||null));if("clip-rect"in e){h=ta(e["clip-rect"])[Na](Q);if(4==h[T]){h[2]=+h[2]+ +h[0];h[3]=+h[3]+ +h[1];l=d.clipRect||N.createElement("div");var p=l.style,q=d.parentNode;p.clip=b.format("rect({1}px {2}px {3}px {0}px)",h);d.clipRect||(p.position="absolute",p.top=0,p.left=0,p.width=c.paper.width+"px",p.height=c.paper.height+"px",q.parentNode.insertBefore(l,q),l[ba](q),d.clipRect=l)}e["clip-rect"]||d.clipRect&&(d.clipRect.style.clip=ra)}"image"==c.type&&e.src&&(d.src=
e.src);"image"==c.type&&e.opacity&&(d.filterOpacity=" progid:DXImageTransform.Microsoft.Alpha(opacity="+100*e.opacity+")",g.filter=(d.filterMatrix||ra)+(d.filterOpacity||ra));e.font&&(g.font=e.font);e["font-family"]&&(g.fontFamily='"'+e["font-family"][Na](",")[0][Ka](/^['"]+|['"]+$/g,ra)+'"');e["font-size"]&&(g.fontSize=e["font-size"]);e["font-weight"]&&(g.fontWeight=e["font-weight"]);e["font-style"]&&(g.fontStyle=e["font-style"]);if(null!=e.opacity||null!=e["stroke-width"]||null!=e.fill||null!=e.stroke||
null!=e["stroke-width"]||null!=e["stroke-opacity"]||null!=e["fill-opacity"]||null!=e["stroke-dasharray"]||null!=e["stroke-miterlimit"]||null!=e["stroke-linejoin"]||null!=e["stroke-linecap"]){d=c.shape||d;g=d.getElementsByTagName("fill")&&d.getElementsByTagName("fill")[0];h=!1;!g&&(h=g=Bb("fill"));if("fill-opacity"in e||"opacity"in e)c=((+f["fill-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+b.getRGB(e.fill).o+1||2)-1),0>c&&(c=0),1<c&&(c=1),g.opacity=c;e.fill&&(g.on=!0);if(null==g.on||"none"==e.fill)g.on=
!1;if(g.on&&e.fill)if(c=e.fill.match(Xa))g.src=c[1],g.type="tile";else if(g.color=b.getRGB(e.fill).hex,g.src=ra,g.type="solid",b.getRGB(e.fill).error&&(k.type in{circle:1,ellipse:1}||"r"!=ta(e.fill).charAt())&&gc(k,e.fill))f.fill="none",f.gradient=e.fill;h&&d[ba](g);g=d.getElementsByTagName("stroke")&&d.getElementsByTagName("stroke")[0];h=!1;!g&&(h=g=Bb("stroke"));if(e.stroke&&"none"!=e.stroke||e["stroke-width"]||null!=e["stroke-opacity"]||e["stroke-dasharray"]||e["stroke-miterlimit"]||e["stroke-linejoin"]||
e["stroke-linecap"])g.on=!0;("none"==e.stroke||null==g.on||0==e.stroke||0==e["stroke-width"])&&(g.on=!1);c=b.getRGB(e.stroke);g.on&&e.stroke&&(g.color=c.hex);c=((+f["stroke-opacity"]+1||2)-1)*((+f.opacity+1||2)-1)*((+c.o+1||2)-1);l=0.75*(va(e["stroke-width"])||1);0>c&&(c=0);1<c&&(c=1);null==e["stroke-width"]&&(l=f["stroke-width"]);e["stroke-width"]&&(g.weight=l);l&&1>l&&(c*=l)&&(g.weight=1);g.opacity=c;e["stroke-linejoin"]&&(g.joinstyle=e["stroke-linejoin"]||"miter");g.miterlimit=e["stroke-miterlimit"]||
8;e["stroke-linecap"]&&(g.endcap="butt"==e["stroke-linecap"]?"flat":"square"==e["stroke-linecap"]?"square":"round");e["stroke-dasharray"]&&(c={"-":"shortdash",".":"shortdot","-.":"shortdashdot","-..":"shortdashdotdot",". ":"dot","- ":"dash","--":"longdash","- .":"dashdot","--.":"longdashdot","--..":"longdashdotdot"},g.dashstyle=c[Z](e["stroke-dasharray"])?c[e["stroke-dasharray"]]:ra);h&&d[ba](g)}if("text"==k.type)switch(g=k.paper.span.style,f.font&&(g.font=f.font),f["font-family"]&&(g.fontFamily=
f["font-family"]),f["font-size"]&&(g.fontSize=f["font-size"]),f["font-weight"]&&(g.fontWeight=f["font-weight"]),f["font-style"]&&(g.fontStyle=f["font-style"]),k.node.string&&(k.paper.span.innerHTML=ta(k.node.string)[Ka](/</g,"&#60;")[Ka](/&/g,"&#38;")[Ka](/\n/g,"<br>")),k.W=f.w=k.paper.span.offsetWidth,k.H=f.h=k.paper.span.offsetHeight,k.X=f.x,k.Y=f.y+Pa(k.H/2),f["text-anchor"]){case "start":k.node.style["v-text-align"]="left";k.bbx=Pa(k.W/2);break;case "end":k.node.style["v-text-align"]="right";
k.bbx=-Pa(k.W/2);break;default:k.node.style["v-text-align"]="center"}};gc=function(b,c){b.attrs=b.attrs||{};var e="linear",d=".5 .5";b.attrs.gradient=c;c=ta(c)[Ka]($a,function(b,c,f){e="radial";c&&f&&(c=va(c),f=va(f),0.25<Ha(c-0.5,2)+Ha(f-0.5,2)&&(f=ea.sqrt(0.25-Ha(c-0.5,2))*(2*(0.5<f)-1)+0.5),d=c+Y+f);return ra});c=c[Na](/\s*\-\s*/);if("linear"==e){var f=c.shift(),f=-va(f);if(isNaN(f))return null}var g=Vb(c);if(!g)return null;b=b.shape||b.node;c=b.getElementsByTagName("fill")[0]||Bb("fill");!c.parentNode&&
b.appendChild(c);if(g[T]){c.on=!0;c.method="none";c.color=g[0].color;c.color2=g[g[T]-1].color;b=[];for(var h=0,k=g[T];h<k;h++)g[h].offset&&b[sa](g[h].offset+Y+g[h].color);c.colors&&(c.colors.value=b[T]?b[fa]():"0% "+c.color);"radial"==e?(c.type="gradientradial",c.focus="100%",c.focussize=d,c.focusposition=d):(c.type="gradient",c.angle=(270-f)%360)}return 1};la=function(c,e,d){this[0]=c;this.id=b._oid++;this.node=c;c.raphael=this;this.Y=this.X=0;this.attrs={};this.Group=e;this.paper=d;this._={tx:0,
ty:0,rt:{deg:0},sx:1,sy:1};!d.bottom&&(d.bottom=this);(this.prev=d.top)&&(d.top.next=this);d.top=this;this.next=null};la[C].rotate=function(b,c,e){if(this.removed)return this;if(null==b)return this._.rt.cx?[this._.rt.deg,this._.rt.cx,this._.rt.cy][fa](Y):this._.rt.deg;b=ta(b)[Na](Q);b[T]-1&&(c=va(b[1]),e=va(b[2]));b=va(b[0]);this._.rt.deg=null!=c?b:this._.rt.deg+b;null==e&&(c=null);this._.rt.cx=c;this._.rt.cy=e;this.setBox(this.attrs,c,e);this.Group.style.rotation=this._.rt.deg;return this};la[C].setBox=
function(b,c,e){if(this.removed)return this;var d=this.Group.style,f=this.shape&&this.shape.style||this.node.style;b=b||{};for(var g in b)b[Z](g)&&(this.attrs[g]=b[g]);c=c||this._.rt.cx;e=e||this._.rt.cy;var h=this.attrs,k;switch(this.type){case "circle":b=h.cx-h.r;g=h.cy-h.r;k=h=2*h.r;break;case "ellipse":b=h.cx-h.rx;g=h.cy-h.ry;k=2*h.rx;h=2*h.ry;break;case "image":b=+h.x;g=+h.y;k=h.width||0;h=h.height||0;break;case "text":this.textpath.v=["m",Pa(h.x),", ",Pa(h.y-2),"l",Pa(h.x)+1,", ",Pa(h.y-2)][fa](ra);
b=h.x-Pa(this.W/2);g=h.y-this.H/2;k=this.W;h=this.H;break;case "rect":case "path":this.attrs.path?(h=cb(this.attrs.path),b=h.x,g=h.y,k=h.width,h=h.height):(g=b=0,k=this.paper.width,h=this.paper.height);break;default:g=b=0,k=this.paper.width,h=this.paper.height}c=(null==c?b+k/2:c)-this.paper.width/2;e=(null==e?g+h/2:e)-this.paper.height/2;var l;d.left!=(l=c+"px")&&(d.left=l);d.top!=(l=e+"px")&&(d.top=l);this.X=Lb[Z](this.type)?-c:b;this.Y=Lb[Z](this.type)?-e:g;this.W=k;this.H=h;Lb[Z](this.type)?(f.left!=
(l=10*-c+"px")&&(f.left=l),f.top!=(l=10*-e+"px")&&(f.top=l)):"text"==this.type?(f.left!=(l=-c+"px")&&(f.left=l),f.top!=(l=-e+"px")&&(f.top=l)):(d.width!=(l=this.paper.width+"px")&&(d.width=l),d.height!=(l=this.paper.height+"px")&&(d.height=l),f.left!=(l=b-c+"px")&&(f.left=l),f.top!=(l=g-e+"px")&&(f.top=l),f.width!=(l=k+"px")&&(f.width=l),f.height!=(l=h+"px")&&(f.height=l))};la[C].hide=function(){!this.removed&&(this.Group.style.display="none");return this};la[C].show=function(){!this.removed&&(this.Group.style.display=
"block");return this};la[C].getBBox=function(){return this.removed?this:Lb[Z](this.type)?cb(this.attrs.path):{x:this.X+(this.bbx||0),y:this.Y,width:this.W,height:this.H}};la[C].remove=function(){if(!this.removed){t(this,this.paper);this.node.parentNode.removeChild(this.node);this.Group.parentNode.removeChild(this.Group);this.shape&&this.shape.parentNode.removeChild(this.shape);for(var b in this)delete this[b];this.removed=!0}};la[C].attr=function(c,e){if(this.removed)return this;if(null==c){c={};
for(var d in this.attrs)this.attrs[Z](d)&&(c[d]=this.attrs[d]);this._.rt.deg&&(c.rotation=this.rotate());(1!=this._.sx||1!=this._.sy)&&(c.scale=this.scale());c.gradient&&"none"==c.fill&&(c.fill=c.gradient)&&delete c.gradient;return c}if(null==e&&b.is(c,Ba))return"translation"==c?D.call(this):"rotation"==c?this.rotate():"scale"==c?this.scale():"fill"==c&&"none"==this.attrs.fill&&this.attrs.gradient?this.attrs.gradient:this.attrs[c];if(this.attrs&&null==e&&b.is(c,Ua)){var f={};d=0;for(e=c[T];d<e;d++)f[c[d]]=
this.attr(c[d]);return f}null!=e&&(f={},f[c]=e);null==e&&b.is(c,"object")&&(f=c);f&&(f.text&&"text"==this.type&&(this.node.string=f.text),Fb(this,f),f.gradient&&({circle:1,ellipse:1}[Z](this.type)||"r"!=ta(f.gradient).charAt())&&gc(this,f.gradient),(!Lb[Z](this.type)||this._.rt.deg)&&this.setBox(this.attrs));return this};la[C].toFront=function(){!this.removed&&this.Group.parentNode[ba](this.Group);this.paper.top!=this&&u(this,this.paper);return this};la[C].toBack=function(){if(this.removed)return this;
this.Group.parentNode.firstChild!=this.Group&&(this.Group.parentNode.insertBefore(this.Group,this.Group.parentNode.firstChild),v(this,this.paper));return this};la[C].insertAfter=function(b){if(this.removed)return this;b.constructor==I&&(b=b[b.length]);b.Group.nextSibling?b.Group.parentNode.insertBefore(this.Group,b.Group.nextSibling):b.Group.parentNode[ba](this.Group);w(this,b,this.paper);return this};la[C].insertBefore=function(b){if(this.removed)return this;b.constructor==I&&(b=b[0]);b.Group.parentNode.insertBefore(this.Group,
b.Group);y(this,b,this.paper);return this};var tc=/ progid:\S+Blur\([^\)]+\)/g;la[C].blur=function(c){var e=this.node.runtimeStyle,d=e.filter,d=d.replace(tc,ra);0!==+c?(this.attrs.blur=c,e.filter=d+Y+" progid:DXImageTransform.Microsoft.Blur(pixelradius="+(+c||1.5)+")",e.margin=b.format("-{0}px 0 0 -{0}px",Pa(+c||1.5))):(e.filter=d,e.margin=0,delete this.attrs.blur)};var ob=function(b,c,e,d){var f=Bb("group"),g=Bb("oval");f.style.cssText="position:absolute;left:0;top:0;width:"+b.width+"px;height:"+
b.height+"px";f.coordsize=Qb;f.coordorigin=b.coordorigin;f[ba](g);g=new la(g,f,b);g.type="circle";Fb(g,{stroke:"#000",fill:"none"});g.attrs.cx=c;g.attrs.cy=e;g.attrs.r=d;g.setBox({x:c-d,y:e-d,width:2*d,height:2*d});b.canvas[ba](f);return g},uc=function(c,e,d,f,g){return g?b.format("M{0},{1}l{2},0a{3},{3},0,0,1,{3},{3}l0,{5}a{3},{3},0,0,1,{4},{3}l{6},0a{3},{3},0,0,1,{4},{4}l0,{7}a{3},{3},0,0,1,{3},{4}z",c+g,e,d-2*g,g,-g,f-2*g,2*g-d,2*g-f):b.format("M{0},{1}l{2},0,0,{3},{4},0z",c,e,d,f,-d)},Bc=function(b,
c,e,d,f,g){var h=uc(c,e,d,f,g);b=b.path(h);var k=b.attrs;b.X=k.x=c;b.Y=k.y=e;b.W=k.width=d;b.H=k.height=f;k.r=g;k.path=h;b.type="rect";return b},hc=function(b,c,e,d,f){var g=Bb("group"),h=Bb("oval");g.style.cssText="position:absolute;left:0;top:0;width:"+b.width+"px;height:"+b.height+"px";g.coordsize=Qb;g.coordorigin=b.coordorigin;g[ba](h);h=new la(h,g,b);h.type="ellipse";Fb(h,{stroke:"#000"});h.attrs.cx=c;h.attrs.cy=e;h.attrs.rx=d;h.attrs.ry=f;h.setBox({x:c-d,y:e-f,width:2*d,height:2*f});b.canvas[ba](g);
return h},Gc=function(b,c,e,d,f,g){var h=Bb("group"),k=Bb("image");h.style.cssText="position:absolute;left:0;top:0;width:"+b.width+"px;height:"+b.height+"px";h.coordsize=Qb;h.coordorigin=b.coordorigin;k.src=c;h[ba](k);k=new la(k,h,b);k.type="image";k.attrs.src=c;k.attrs.x=e;k.attrs.y=d;k.attrs.w=f;k.attrs.h=g;k.setBox({x:e,y:d,width:f,height:g});b.canvas[ba](h);return k},sc=function(c,e,d,f){var g=Bb("group"),h=Bb("shape"),k=h.style,l=Bb("path"),p=Bb("textpath");g.style.cssText="position:absolute;left:0;top:0;width:"+
c.width+"px;height:"+c.height+"px";g.coordsize=Qb;g.coordorigin=c.coordorigin;l.v=b.format("m{0},{1}l{2},{1}",Pa(10*e),Pa(10*d),Pa(10*e)+1);l.textpathok=!0;k.width=c.width;k.height=c.height;p.string=ta(f);p.on=!0;h[ba](p);h[ba](l);g[ba](h);k=new la(p,g,c);k.shape=h;k.textpath=l;k.type="text";k.attrs.text=f;k.attrs.x=e;k.attrs.y=d;k.attrs.w=1;k.attrs.h=1;Fb(k,{font:Va.font,stroke:"none",fill:"#000"});k.setBox();c.canvas[ba](g);return k},oc=function(b,c){var e=this.canvas.style;b==+b&&(b+="px");c==
+c&&(c+="px");e.width=b;e.height=c;e.clip="rect(0 "+b+" "+c+" 0)";return this},Bb;N.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)");try{!N.namespaces.rvml&&N.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),Bb=function(b){return N.createElement("<rvml:"+b+' class="rvml">')}}catch(hd){Bb=function(b){return N.createElement("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}ga=function(){var c=r[na](0,arguments),e=c.container,f=c.height,g=c.width,h=c.x,c=c.y;if(!e)throw Error("VML container not found.");
var k=new d,l=k.canvas=N.createElement("div"),p=l.style,h=h||0,c=c||0,g=g||512,f=f||342;g==+g&&(g+="px");f==+f&&(f+="px");k.width=1E3;k.height=1E3;k.coordsize=1E4+Y+1E4;k.coordorigin="0 0";k.span=N.createElement("span");k.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";l[ba](k.span);p.cssText=b.format("width:{0};height:{1};display:inline-block;position:relative;clip:rect(0 {0} {1} 0);overflow:hidden",g,f);1==e?(N.body[ba](l),p.left=
h+"px",p.top=c+"px",p.position="absolute"):e.firstChild?e.insertBefore(l,e.firstChild):e[ba](l);s.call(k,k,b.fn);return k};d[C].clear=function(){this.canvas.innerHTML=ra;this.span=N.createElement("span");this.span.style.cssText="position:absolute;left:-9999em;top:-9999em;padding:0;margin:0;line-height:1;display:inline;";this.canvas[ba](this.span);this.bottom=this.top=null};d[C].remove=function(){this.canvas.parentNode.removeChild(this.canvas);for(var b in this)this[b]=z(b);return!0}}d[C].safari="Apple Computer, Inc."==
navigator.vendor&&(4>navigator.userAgent.match(/Version\/(.*?)\s/)[1]||"iP"==ca.navigator.platform.slice(0,2))?function(){var b=this.rect(-99,-99,this.width+99,this.height+99).attr({stroke:"none"});ca.setTimeout(function(){b.remove()})}:function(){};for(var mc=function(){if(N.addEventListener)return function(b,c,e,d){function f(g){if($&&Oa[Z](c))for(var h=0,k=g.targetTouches&&g.targetTouches.length;h<k;h++)if(g.targetTouches[h].target==b){k=g;g=g.targetTouches[h];g.originalEvent=k;g.preventDefault=
A;g.stopPropagation=O;break}return e.call(d,g)}var g=$&&Oa[c]?Oa[c]:c;b.addEventListener(g,f,!1);return function(){b.removeEventListener(g,f,!1);return!0}};if(N.attachEvent)return function(b,c,e,d){function f(b){b=b||ca.event;b.preventDefault=b.preventDefault||B;b.stopPropagation=b.stopPropagation||K;return e.call(d,b)}b.attachEvent("on"+c,f);return function(){b.detachEvent("on"+c,f);return!0}}}(),Rb=[],bb=Qa[T];bb--;)(function(c){b[c]=la[C][c]=function(e){b.is(e,"function")&&(this.events=this.events||
[],this.events.push({name:c,f:e,unbind:mc(this.shape||this.node||N,c,e,this)}));return this};b["un"+c]=la[C]["un"+c]=function(b){for(var e=this.events,d=e[T];d--;)if(e[d].name==c&&e[d].f==b){e[d].unbind();e.splice(d,1);!e.length&&delete this.events;break}return this}})(Qa[bb]);la[C].hover=function(b,c){return this.mouseover(b).mouseout(c)};la[C].unhover=function(b,c){return this.unmouseover(b).unmouseout(c)};la[C].drag=function(c,e,d){this._drag={};this.mousedown(function(f){(f.originalEvent||f).preventDefault();
this._drag.x=f.clientX;this._drag.y=f.clientY;this._drag.id=f.identifier;e&&e.call(this,f.clientX,f.clientY);!Rb.length&&b.mousemove(E).mouseup(F);Rb.push({el:this,move:c,end:d})});return this};la[C].undrag=function(c,e,d){for(e=Rb.length;e--;)Rb[e].el==this&&Rb[e].move==c&&Rb[e].end==d&&Rb.splice(e,1),!Rb.length&&b.unmousemove(E).unmouseup(F)};d[C].circle=function(b,c,e){return ob(this,b||0,c||0,e||0)};d[C].rect=function(b,c,e,d,f){return Bc(this,b||0,c||0,e||0,d||0,f||0)};d[C].ellipse=function(b,
c,e,d){return hc(this,b||0,c||0,e||0,d||0)};d[C].path=function(c){c&&!b.is(c,Ba)&&!b.is(c[0],Ua)&&(c+=ra);return yb(b.format[na](b,arguments),this)};d[C].image=function(b,c,e,d,f){return Gc(this,b||"about:blank",c||0,e||0,d||0,f||0)};d[C].text=function(b,c,e){return sc(this,b||0,c||0,e||ra)};d[C].set=function(b){1<arguments[T]&&(b=Array[C].splice.call(arguments,0,arguments[T]));return new I(b)};d[C].setSize=oc;d[C].top=d[C].bottom=null;d[C].raphael=b;la[C].resetScale=function(){if(this.removed)return this;
this._.sx=1;this._.sy=1;this.attrs.scale="1 1"};la[C].scale=function(b,c,e,d){if(this.removed)return this;if(null==b&&null==c)return{x:this._.sx,y:this._.sy,toString:U};c=c||b;!+c&&(c=b);var f,g,h=this.attrs;if(0!=b){var k=this.getBBox(),l=k.x+k.width/2,p=k.y+k.height/2;f=b/this._.sx;g=c/this._.sy;e=+e||0==e?e:l;d=+d||0==d?d:p;var k=~~(b/ea.abs(b)),q=~~(c/ea.abs(c)),r=this.node.style,s=e+(l-e)*f,p=d+(p-d)*g;switch(this.type){case "rect":case "image":var t=h.width*k*f,u=h.height*q*g;this.attr({height:u,
r:h.r*Aa(k*f,q*g),width:t,x:s-t/2,y:p-u/2});break;case "circle":case "ellipse":this.attr({rx:h.rx*k*f,ry:h.ry*q*g,r:h.r*Aa(k*f,q*g),cx:s,cy:p});break;case "text":this.attr({x:s,y:p});break;case "path":for(var l=La(h.path),v=!0,w=0,y=l[T];w<y;w++){var z=l[w],x=Ib.call(z[0]);if(!("M"==x&&v))if(v=!1,"A"==x)z[l[w][T]-2]*=f,z[l[w][T]-1]*=g,z[1]*=k*f,z[2]*=q*g,z[5]=+!(k+q?!+z[5]:+z[5]);else if("H"==x)for(var x=1,A=z[T];x<A;x++)z[x]*=f;else if("V"==x){x=1;for(A=z[T];x<A;x++)z[x]*=g}else{x=1;for(A=z[T];x<
A;x++)z[x]*=x%2?f:g}}g=cb(l);f=s-g.x-g.width/2;g=p-g.y-g.height/2;l[0][1]+=f;l[0][2]+=g;this.attr({path:l})}this.type in{text:1,image:1}&&(1!=k||1!=q)?this.transformations?(this.transformations[2]="scale("[S](k,",",q,")"),this.node.setAttribute("transform",this.transformations[fa](Y)),f=-1==k?-h.x-(t||0):h.x,g=-1==q?-h.y-(u||0):h.y,this.attr({x:f,y:g}),h.fx=k-1,h.fy=q-1):(this.node.filterMatrix=" progid:DXImageTransform.Microsoft"+".Matrix(M11="[S](k,", M12=0, M21=0, M22=",q,", Dx=0, Dy=0, sizingmethod='auto expand', filtertype='bilinear')"),
r.filter=(this.node.filterMatrix||ra)+(this.node.filterOpacity||ra)):this.transformations?(this.transformations[2]=ra,this.node.setAttribute("transform",this.transformations[fa](Y)),h.fx=0,h.fy=0):(this.node.filterMatrix=ra,r.filter=(this.node.filterMatrix||ra)+(this.node.filterOpacity||ra));h.scale=[b,c,e,d][fa](Y);this._.sx=b;this._.sy=c}return this};la[C].clone=function(){if(this.removed)return null;var b=this.attr();delete b.scale;delete b.translation;return this.paper[this.type]().attr(b)};var ld=
h(function(b,c,e,d,f,g,h,k,l){for(var p=0,r,s=0;1.01>s;s+=0.01){var t=q(b,c,e,d,f,g,h,k,s);s&&(p+=Ha(Ha(r.x-t.x,2)+Ha(r.y-t.y,2),0.5));if(p>=l)return t;r=t}}),ed=h(function(b,c,e,d,f,g,h,k){for(var l={x:0,y:0},p=0,r=0;1.01>r;r+=0.01){var s=q(b,c,e,d,f,g,h,k,r);r&&(p+=Ha(Ha(l.x-s.x,2)+Ha(l.y-s.y,2),0.5));l=s}return p}),md=H(1),fd=H(),nc=H(0,1);la[C].getTotalLength=function(){if("path"==this.type)return this.node.getTotalLength?this.node.getTotalLength():md(this.attrs.path)};la[C].getPointAtLength=
function(b){if("path"==this.type)return this.node.getPointAtLength?this.node.getPointAtLength(b):fd(this.attrs.path,b)};la[C].getSubpath=function(b,c){if("path"==this.type){if(1E-6>ea.abs(this.getTotalLength()-c))return nc(this.attrs.path,b).end;c=nc(this.attrs.path,c,1);return b?nc(c,b).end:c}};b.easing_formulas={linear:function(b){return b},"<":function(b){return Ha(b,3)},">":function(b){return Ha(b-1,3)+1},"<>":function(b){b*=2;return 1>b?Ha(b,3)/2:(Ha(b-2,3)+2)/2},backIn:function(b){return b*
b*(2.70158*b-1.70158)},backOut:function(b){b-=1;return b*b*(2.70158*b+1.70158)+1},elastic:function(b){return 0==b||1==b?b:Ha(2,-10*b)*ea.sin(2*(b-0.075)*ea.PI/0.3)+1},bounce:function(b){b<1/2.75?b*=7.5625*b:b<2/2.75?(b-=1.5/2.75,b=7.5625*b*b+0.75):b<2.5/2.75?(b-=2.25/2.75,b=7.5625*b*b+0.9375):(b-=2.625/2.75,b=7.5625*b*b+0.984375);return b}};var Pb={length:0};la[C].animateWith=function(b,c,e,d,f){Pb[b.id]&&(c.start=Pb[b.id].start);return this.animate(c,e,d,f)};la[C].animateAlong=M();la[C].animateAlongBack=
M(1);la[C].onAnimation=function(b){this._run=b||0;return this};la[C].animate=function(c,e,d,f){if(b.is(d,"function")||!d)f=d||null;var g={},h={},k={},l;for(l in c)if(c[Z](l)&&Ta[Z](l))switch(g[l]=this.attr(l),null==g[l]&&(g[l]=Va[l]),h[l]=c[l],Ta[l]){case "along":var p=md(c[l]),q=fd(c[l],p*!!c.back),r=this.getBBox();k[l]=p/e;k.tx=r.x;k.ty=r.y;k.sx=q.x;k.sy=q.y;h.rot=c.rot;h.back=c.back;h.len=p;c.rot&&(k.r=va(this.rotate())||0);break;case ya:k[l]=(h[l]-g[l])/e;break;case "colour":g[l]=b.getRGB(g[l]);
p=b.getRGB(h[l]);k[l]={r:(p.r-g[l].r)/e,g:(p.g-g[l].g)/e,b:(p.b-g[l].b)/e};break;case "path":p=ja(g[l],h[l]);g[l]=p[0];q=p[1];k[l]=[];p=0;for(r=g[l][T];p<r;p++){k[l][p]=[0];for(var s=1,t=g[l][p][T];s<t;s++)k[l][p][s]=(q[p][s]-g[l][p][s])/e}break;case "csv":q=ta(c[l])[Na](Q);p=ta(g[l])[Na](Q);switch(l){case "translation":g[l]=[0,0];k[l]=[q[0]/e,q[1]/e];break;case "rotation":g[l]=p[1]==q[1]&&p[2]==q[2]?p:[0,q[1],q[2]];k[l]=[(q[0]-g[l][0])/e,0,0];break;case "scale":c[l]=q;g[l]=ta(g[l])[Na](Q);k[l]=[(q[0]-
g[l][0])/e,(q[1]-g[l][1])/e,0,0];break;case "clip-rect":g[l]=ta(g[l])[Na](Q);k[l]=[];for(p=4;p--;)k[l][p]=(q[p]-g[l][p])/e}h[l]=q}this.stop();this.in_animation=1;Pb[this.id]={start:c.start||+new Date,ms:e,easing:d,from:g,diff:k,to:h,el:this,callback:f,t:{x:0,y:0}};1==++Pb[T]&&G();return this};la[C].stop=function(){Pb[this.id]&&Pb[T]--;delete Pb[this.id];return this};la[C].translate=function(b,c){return this.attr({translation:b+" "+c})};la[C][ha]=function(){return"Rapha\u00ebl\u2019s object"};b.ae=
Pb;I[C][sa]=function(){for(var b,c,e=0,d=arguments[T];e<d;e++)if((b=arguments[e])&&(b.constructor==la||b.constructor==I))c=this.items[T],this[c]=this.items[c]=b,this[T]++;return this};I[C].pop=function(){delete this[this[T]--];return this.items.pop()};for(var gd in la[C])la[C][Z](gd)&&(I[C][gd]=function(b){return function(){for(var c=0,e=this.items[T];c<e;c++)this.items[c][b][na](this.items[c],arguments);return this}}(gd));I[C].attr=function(c,e){if(c&&b.is(c,Ua)&&b.is(c[0],"object")){e=0;for(var d=
c[T];e<d;e++)this.items[e].attr(c[e])}else for(var d=0,f=this.items[T];d<f;d++)this.items[d].attr(c,e);return this};I[C].animate=function(c,e,d,f){(b.is(d,"function")||!d)&&(f=d||null);var g=this.items[T],h=g,k,l=this,p;f&&(p=function(){!--g&&f.call(l)});d=b.is(d,Ba)?d:p;for(k=this.items[--h].animate(c,e,d,p);h--;)this.items[h].animateWith(k,c,e,d,p);return this};I[C].insertAfter=function(b){for(var c=this.items[T];c--;)this.items[c].insertAfter(b);return this};I[C].getBBox=function(){for(var b=[],
c=[],e=[],d=[],f=this.items[T];f--;){var g=this.items[f].getBBox();b[sa](g.x);c[sa](g.y);e[sa](g.x+g.width);d[sa](g.y+g.height)}b=Aa[na](0,b);c=Aa[na](0,c);return{x:b,y:c,width:xa[na](0,e)-b,height:xa[na](0,d)-c}};I[C].clone=function(b){b=new I;for(var c=0,e=this.items[T];c<e;c++)b[sa](this.items[c].clone());return b};b.registerFont=function(b){if(!b.face)return b;this.fonts=this.fonts||{};var c={w:b.w,face:{},glyphs:{}},e=b.face["font-family"],d;for(d in b.face)b.face[Z](d)&&(c.face[d]=b.face[d]);
if(this.fonts[e])this.fonts[e][sa](c);else this.fonts[e]=[c];if(!b.svg){c.face["units-per-em"]=db(b.face["units-per-em"],10);for(var f in b.glyphs)if(b.glyphs[Z](f)&&(e=b.glyphs[f],c.glyphs[f]={w:e.w,k:{},d:e.d&&"M"+e.d[Ka](/[mlcxtrv]/g,function(b){return{l:"L",c:"C",x:"z",t:"m",r:"l",v:"c"}[b]||"M"})+"z"},e.k))for(var g in e.k)e[Z](g)&&(c.glyphs[f].k[g]=e.k[g])}return b};d[C].getFont=function(c,e,d,f){f=f||"normal";d=d||"normal";e=+e||{normal:400,bold:700,lighter:300,bolder:800}[e]||400;if(b.fonts){var g=
b.fonts[c];if(!g){c=RegExp("(^|\\s)"+c[Ka](/[^\w\d\s+!~.:_-]/g,ra)+"(\\s|$)","i");for(var h in b.fonts)if(b.fonts[Z](h)&&c.test(h)){g=b.fonts[h];break}}var k;if(g){h=0;for(c=g[T];h<c&&!(k=g[h],k.face["font-weight"]==e&&(k.face["font-style"]==d||!k.face["font-style"])&&k.face["font-stretch"]==f);h++);}return k}};d[C].print=function(c,e,d,f,g,h){h=h||"middle";var k=this.set(),l=ta(d)[Na](ra),p=0;b.is(f,d)&&(f=this.getFont(f));if(f){d=(g||16)/f.face["units-per-em"];var q=f.face.bbox.split(Q);g=+q[0];
h=+q[1]+("baseline"==h?q[3]-q[1]+ +f.face.descent:(q[3]-q[1])/2);for(var q=0,r=l[T];q<r;q++){var s=q&&f.glyphs[l[q-1]]||{},t=f.glyphs[l[q]],p=p+(q?(s.w||f.w)+(s.k&&s.k[l[q]]||0):0);t&&t.d&&k[sa](this.path(t.d).attr({fill:"#000",stroke:"none",translation:[p,0]}))}k.scale(d,d,g,h).translate(c-g,e-h)}return k};var oe=/\{(\d+)\}/g;b.format=function(c,e){var d=b.is(e,Ua)?[0][S](e):arguments;c&&b.is(c,Ba)&&d[T]-1&&(c=c[Ka](oe,function(b,c){return null==d[++c]?ra:d[c]}));return c||ra};b.ninja=function(){R?
Raphael=X:delete Raphael;return b};b.el=la[C];return b}();YUI.add("thirdparty-raphael",function(b){},"1.0");
YUI.add("squarespace-stats-block-sparkline",function(b){var d=b.namespace("Squarespace.Views.Stats").Sparkline=b.Base.create("sparkline",b.Squarespace.Views.Stats.Block,[],{template:"stats-block-sparkline.html",_bindUI:function(){d.superclass._bindUI.apply(this,arguments);var b=this.get("id");this.after(b+"|dataChange",this._renderChart,this)},_loadData:function(){var c=b.Squarespace.StatsTimeFrameUtils.getDateRange(this.get("timeFrame"));b.Data.get({url:"/api/census/GetData",data:{start:c.start.getTime(),
end:c.end.getTime(),dataType:1,dataMetric:this.get("dataMetric"),granularity:this.get("granularity")},success:function(b){this.fire("dataLoaded",{data:b})},failure:function(b){this.fire("dataLoaded",{error:b.error||"Failed to load data."})}},this)},_renderDefaultState:function(b){d.superclass._renderDefaultState.apply(this,arguments);this._setTrendClass(0<b.raw.length?b.raw[b.raw.length-1].vw-b.raw[0].vw:0);this.set("data",b)},_setTrendClass:function(b){var e=this.get("container"),d=0<=b;b=d?"positive-trend":
"negative-trend";d=d?"negative-trend":"positive-trend";e.hasClass(b)||(e.removeClass(d),e.addClass(b))},_renderChart:function(){var b=this.get("data"),e=b.raw,d=this.get("container"),g=d.one(".graphic"),h=g.get("offsetWidth")||d.get("offsetWidth"),d=g.get("offsetHeight")||d.get("offsetHeight"),g=d3.select(g.getDOMNode()).append("svg"),k=d3.time.scale().rangeRound([0,h]),l=d3.scale.linear().rangeRound([d,0]);0===e.length&&(e=[{d:b.start,vw:0},{d:b.end,vw:0}]);b=d3.svg.line().x(function(b){return k(b.d)}).y(function(b){return l(b.vw)}).interpolate("linear");
k.domain(d3.extent(e,function(b){return b.d}));l.domain([d3.min(e,function(b){return b.vw}),d3.max(e,function(b){return b.vw})]).nice();g.datum(e).attr("width",h).attr("height",d).attr("class","time chart");g.append("path").attr("width",h).attr("height",d).attr("class","line").attr("d",b)}},{CSS_PREFIX:"sqs-sparkline",ATTR:{data:{value:null}}})},"1.0",{requires:["base-base","squarespace-stats-block-view","squarespace-stats-block-sparkline-template","thirdparty-d3"]});
YUI.add("squarespace-content-manager-kb-item-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["content-manager-kb-item.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e={hash:{format:"%b %d, %Y"},data:c};return e='\n        <span class="publish-on">'+(r((f=d["date-format"]||b["date-format"],f?f.call(b,b.publishOn,e):s.call(b,"date-format",b.publishOn,e)))+"</span>\n      ")}function p(b,c){var e,f;e="\n        ";if((f=d["if"].call(b,b.addedOn,
{hash:{},inverse:t.noop,fn:t.program(11,q,c),data:c}))||0===f)e+=f;return e+"\n      "}function q(b,c){var e,f;e={hash:{format:"%b %d, %Y"},data:c};return e='\n          <span class="added-on">'+(r((f=d["date-format"]||b["date-format"],f?f.call(b,b.addedOn,e):s.call(b,"date-format",b.addedOn,e)))+"</span>\n        ")}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var r=this.escapeExpression,s=d.helperMissing,t=this,u=d.blockHelperMissing;b='<div class="kb-list-item">\n  <header class="kb-list-item-header">\n    <h2>\n      ';
if((h=d["if"].call(c,c.title,{hash:{},inverse:t.program(3,function(b,c){return'\n        <span class="no-title">No Title</span>\n      '},k),fn:t.program(1,function(b,c){var e,f;e="\n        ";(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f="function"===typeof f?f.apply(b):f);return e+=r(f)+"\n      "},k),data:k}))||0===h)b+=h;b+='\n    </h2>\n  </header>\n\n  <div class="meta">\n    ';if((h=d["if"].call(c,c.eventDateDescriptor,{hash:{},inverse:t.program(7,function(b,c){var e,f;e="\n      ";
if((f=d["if"].call(b,b.publishOn,{hash:{},inverse:t.program(10,p,c),fn:t.program(8,l,c),data:c}))||0===f)e+=f;return e+"\n    "},k),fn:t.program(5,function(b,c){var e,f;e='\n      <span class="event">';(f=d.eventDateDescriptor)?f=f.call(b,{hash:{},data:c}):(f=b.eventDateDescriptor,f="function"===typeof f?f.apply(b):f);if(f||0===f)e+=f;return e+"</span>\n    "},k),data:k}))||0===h)b+=h;b+='\n\n    <span class="number-of-likes">Rated ';(h=d.rating)?h=h.call(c,{hash:{},data:k}):(h=c.rating,h="function"===
typeof h?h.apply(c):h);b+=r(h)+"&#37 by ";(h=d.votes)?h=h.call(c,{hash:{},data:k}):(h=c.votes,h="function"===typeof h?h.apply(c):h);b+=r(h)+' votes</span>\n  </div>\n\n  <div class="preview">\n    <a href="';(h=d.fullUrl)?h=h.call(c,{hash:{},data:k}):(h=c.fullUrl,h="function"===typeof h?h.apply(c):h);b+=r(h)+'" class="icon icon-';(h=d.recordTypeLabel)?h=h.call(c,{hash:{},data:k}):(h=c.recordTypeLabel,h="function"===typeof h?h.apply(c):h);b+=r(h)+'">\n      Preview ';(h=d.title)?h=h.call(c,{hash:{},
data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=r(h)+'\n\n      <span class="arrow"></span>\n    </a>\n  </div>\n\n  ';k={hash:{},inverse:t.noop,fn:t.program(13,function(b,c){var e,f;e='\n    <div class="flag ';(f=d.className)?f=f.call(b,{hash:{},data:c}):(f=b.className,f="function"===typeof f?f.apply(b):f);e+=r(f)+'">\n      ';(f=d.message)?f=f.call(b,{hash:{},data:c}):(f=b.message,f="function"===typeof f?f.apply(b):f);return e+=r(f)+"\n    </div>\n  "},k),data:k};(h=d.flag)?h=h.call(c,
k):(h=c.flag,h="function"===typeof h?h.apply(c):h);d.flag||(h=u.call(c,h,k));if(h||0===h)b+=h;return b+"\n</div>"})})();b.Handlebars.registerPartial("content-manager-kb-item.html".replace("/","."),d.templates["content-manager-kb-item.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-affix-text",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.AttrValidators,c=b.Squarespace.DialogFields.AffixText=b.Base.create("affixText",b.Squarespace.DialogField2,[],{initializer:function(){this._textField=new b.Squarespace.DialogFields.Text;this._textField.after("dataChange",this._syncData,this);this._textField.after("focusedChange",this._syncFocus,this);var c=this.get("affixes");this._selectField=new b.Squarespace.DialogFields.Select({options:b.Array.map(c,
function(b){return{label:b,value:b}}),data:c[0]});this.set("selectedAffix",c[0]);this._selectField.after("dataChange",function(b){this.set("data",this._affix(this._textField.get("data"),b.newVal))},this);this.after("selectedAffixChange",this._syncAffix,this)},destructor:function(){this._textField.destroy();this._selectField.destroy()},renderUI:function(){c.superclass.renderUI.call(this);this.get("contentBox").append('<div class="fields"></div>')},bindUI:function(){c.superclass.bindUI.call(this);this.after("focusedChange",
function(b){this.get("boundingBox").toggleClass("focused",b.newVal)},this)},syncUI:function(){c.superclass.syncUI.call(this);this.get("selectable")&&0<this.get("affixes").length?this._selectField.enable():this._selectField.disable()},_syncFocus:function(b){b.newVal?this.focus():this.blur()},_syncData:function(b){b.silent||this.set("data",b.newVal)},_syncAffix:function(b){this._selectField.set("data",b.newVal)},_getMatchingAffix:function(){throw"Field must implement _getMatchingAffix";},_chompAffix:function(){throw"Field must implement _chompAffix";
},_affix:function(){throw"Field must implement _affix";}},{CSS_PREFIX:"sqs-affix-text",ATTRS:{affixes:{validator:d.isNullOrArray,setter:b.Array.dedupe,writeOnce:"initOnly"},data:{setter:function(c){if(!b.Lang.isValue(c))return c;var d=this._getMatchingAffix(c);return b.Lang.isValue(d)?(this._set("selectedAffix",d),c=this._chompAffix(c,d),this._textField.set("data",c,{silent:!0}),this._affix(c,d)):this._affix(c,this.get("selectedAffix"))}},selectedAffix:{validator:function(b){return-1<this.get("affixes").indexOf(b)},
readOnly:!0},selectable:{validator:d.isBoolean,value:!0,writeOnce:"initOnly"}}})},"1.0",{requires:["base","squarespace-dialog-select","squarespace-attr-validators","squarespace-dialog-field-2","squarespace-dialog-text"]});
YUI.add("squarespace-dialog-wysiwyg-wrapper",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.WysiwygWrapper=b.Base.create("wysiwygWrapper",b.Squarespace.DialogField2,[],{initializer:function(){this._edited=!1;this._fieldName=this.get("fieldConfig.name")||"description"},didDataChange:function(){return this._edited},renderUI:function(){d.superclass.renderUI.call(this);var c={};c[this._fieldName]=this.get("data");var e=[b.merge({type:"wysiwyg",style:"normal",fieldStyle:"normal",
titleStyle:"top",menuConfig:"small",optional:!0},this.get("fieldConfig"))],c=this._embeddedDialog=new b.Squarespace.EditingDialog({autoFocus:!1,siteTitle:"Squarespace",loadingText:"Loading...",savingText:"Verifying...",closingText:"Success!...",style:"transparent",buttons:[],colorScheme:"dark",buttonAlign:"left",width:368,height:this.get("fieldConfig.dialogHeight")||177,closeOthers:!1,closeable:!1,showAnim:"fade",disableOverlayCancel:!0,disableTips:!1,discardChangesConfirmation:!0,primaryTabs:[{tabTitle:"none",
icon:"none",fields:e}],hideAnim:"noHideAnimation",embedWithinEl:this.get("contentBox"),initialData:c});c.show();b.Squarespace.OPEN_DIALOGS.remove(c);b.Squarespace.EscManager.removeTarget(c)},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("id");this.after("dataChange",function(e){this._edited=!0;var d=e.prevVal,g=e.newVal;e.source!==b&&(d&&d.html!==g.html)&&(e={},e[this._fieldName]=g,this._embeddedDialog.setData(e))},this);this._registerEvent(this._embeddedDialog.after("datachange",
function(e,d){this.set("data",e.getValue(),{source:b})},this))},markAsSaved:function(){this._embeddedDialog.clearEdited()}},{CSS_PREFIX:"sqs-dialog-wsyiwyg-wrapper",ATTRS:{fieldConfig:{value:{}}}})},"1.0",{requires:["base","squarespace-dialog-field-2","squarespace-dialog","squarespace-util"]});
YUI.add("squarespace-localities",function(b){b.namespace("Squarespace");b.Squarespace.Localities={COUNTRY_OPTIONS:{"":{title:"Not Specified",empty:!0},US:{title:"United States"},CA:{title:"Canada"},AF:{title:"Afghanistan"},AL:{title:"Albania"},DZ:{title:"Algeria"},AS:{title:"American Samoa"},AD:{title:"Andorra"},AO:{title:"Angola"},AI:{title:"Anguilla"},AQ:{title:"Antarctica"},AG:{title:"Antigua and Barbuda"},AR:{title:"Argentina"},AM:{title:"Armenia"},AW:{title:"Aruba"},AU:{title:"Australia"},AT:{title:"Austria"},
AX:{title:"Aland Islands"},AZ:{title:"Azerbaijan"},BS:{title:"Bahamas"},BH:{title:"Bahrain"},BD:{title:"Bangladesh"},BB:{title:"Barbados"},BY:{title:"Belarus"},BE:{title:"Belgium"},BZ:{title:"Belize"},BJ:{title:"Benin"},BM:{title:"Bermuda"},BT:{title:"Bhutan"},BO:{title:"Bolivia"},BA:{title:"Bosnia and Herzegovina"},BW:{title:"Botswana"},BV:{title:"Bouvet Island"},BR:{title:"Brazil"},IO:{title:"British Indian Ocean Territory"},BN:{title:"Brunei Darussalam"},BG:{title:"Bulgaria"},BF:{title:"Burkina Faso"},
BI:{title:"Burundi"},KH:{title:"Cambodia"},CI:{title:"Cote d'Ivoire"},CM:{title:"Cameroon"},CV:{title:"Cape Verde"},KY:{title:"Cayman Islands"},CF:{title:"Central African Republic"},TD:{title:"Chad"},CL:{title:"Chile"},CN:{title:"China"},CX:{title:"Christmas Island"},CC:{title:"Cocos (Keeling) Islands"},CO:{title:"Colombia"},KM:{title:"Comoros"},CG:{title:"Congo"},CD:{title:"Congo, Democratic Republic"},CK:{title:"Cook Islands"},CR:{title:"Costa Rica"},HR:{title:"Croatia"},CU:{title:"Cuba"},CY:{title:"Cyprus"},
CZ:{title:"Czech Republic"},DK:{title:"Denmark"},DJ:{title:"Djibouti"},DM:{title:"Dominica"},DO:{title:"Dominican Republic"},TL:{title:"Timor-Leste"},EC:{title:"Ecuador"},EG:{title:"Egypt"},SV:{title:"El Salvador"},GQ:{title:"Equatorial Guinea"},ER:{title:"Eritrea"},EE:{title:"Estonia"},ET:{title:"Ethiopia"},FK:{title:"Falkland Islands (Malvinas)"},FO:{title:"Faroe Islands"},FJ:{title:"Fiji"},FI:{title:"Finland"},FR:{title:"France"},GF:{title:"French Guiana"},PF:{title:"French Polynesia"},TF:{title:"French Southern Territories"},
GA:{title:"Gabon"},GM:{title:"Gambia"},GE:{title:"Georgia"},DE:{title:"Germany"},GH:{title:"Ghana"},GI:{title:"Gibraltar"},GR:{title:"Greece"},GL:{title:"Greenland"},GD:{title:"Grenada"},GG:{title:"Guernsey"},GP:{title:"Guadeloupe"},GU:{title:"Guam"},GT:{title:"Guatemala"},GN:{title:"Guinea"},GW:{title:"Guinea-Bissau"},GY:{title:"Guyana"},HT:{title:"Haiti"},HM:{title:"Heard and McDonald Islands"},HN:{title:"Honduras"},HK:{title:"Hong Kong"},HU:{title:"Hungary"},IS:{title:"Iceland"},IN:{title:"India"},
ID:{title:"Indonesia"},IR:{title:"Iran"},IQ:{title:"Iraq"},IE:{title:"Ireland"},IL:{title:"Israel"},IT:{title:"Italy"},JM:{title:"Jamaica"},JP:{title:"Japan"},JE:{title:"Jersey"},JO:{title:"Jordan"},KZ:{title:"Kazakhstan"},KE:{title:"Kenya"},KI:{title:"Kiribati"},KP:{title:"Korea, Democratic People's Republic"},KR:{title:"Korea (South)"},KV:{title:"Kosovo"},KW:{title:"Kuwait"},KG:{title:"Kyrgyzstan"},LA:{title:"Laos"},LV:{title:"Latvia"},LB:{title:"Lebanon"},LS:{title:"Lesotho"},LR:{title:"Liberia"},
LY:{title:"Libya"},LI:{title:"Liechtenstein"},LT:{title:"Lithuania"},LU:{title:"Luxembourg"},MO:{title:"Macau"},MK:{title:"Macedonia"},MG:{title:"Madagascar"},MW:{title:"Malawi"},MY:{title:"Malaysia"},MV:{title:"Maldives"},ML:{title:"Mali"},MT:{title:"Malta"},MH:{title:"Marshall Islands"},MQ:{title:"Martinique"},MR:{title:"Mauritania"},MU:{title:"Mauritius"},YT:{title:"Mayotte"},MX:{title:"Mexico"},FM:{title:"Micronesia"},MD:{title:"Moldova"},MC:{title:"Monaco"},MN:{title:"Mongolia"},ME:{title:"Montenegro"},
MS:{title:"Montserrat"},MA:{title:"Morocco"},MZ:{title:"Mozambique"},MM:{title:"Myanmar"},NA:{title:"Namibia"},NR:{title:"Nauru"},NP:{title:"Nepal"},NL:{title:"Netherlands"},AN:{title:"Netherlands Antilles"},NC:{title:"New Caledonia"},NZ:{title:"New Zealand"},NI:{title:"Nicaragua"},NE:{title:"Niger"},NG:{title:"Nigeria"},NU:{title:"Niue"},NF:{title:"Norfolk Island"},MP:{title:"Northern Mariana Islands"},NO:{title:"Norway"},OM:{title:"Oman"},PK:{title:"Pakistan"},PW:{title:"Palau"},PA:{title:"Panama"},
PG:{title:"Papua New Guinea"},PS:{title:"Palestine, State of"},PY:{title:"Paraguay"},PE:{title:"Peru"},PH:{title:"Philippines"},PN:{title:"Pitcairn"},PL:{title:"Poland"},PT:{title:"Portugal"},PR:{title:"Puerto Rico"},QA:{title:"Qatar"},RE:{title:"Reunion"},RO:{title:"Romania"},RU:{title:"Russian Federation"},RW:{title:"Rwanda"},GS:{title:"South Georgia and the South Sandwich Islands"},BL:{title:"Saint Barthelemy"},KN:{title:"Saint Kitts and Nevis"},LC:{title:"Saint Lucia"},VC:{title:"Saint Vincent and the Grenadines"},
WS:{title:"Samoa"},SM:{title:"San Marino"},ST:{title:"Sao Tome and Principe"},SA:{title:"Saudi Arabia"},SN:{title:"Senegal"},RS:{title:"Serbia"},SC:{title:"Seychelles"},SL:{title:"Sierra Leone"},SG:{title:"Singapore"},SK:{title:"Slovakia"},SI:{title:"Slovenia"},SB:{title:"Solomon Islands"},SO:{title:"Somalia"},ZA:{title:"South Africa"},ES:{title:"Spain"},LK:{title:"Sri Lanka"},SH:{title:"Saint Helena"},PM:{title:"Saint Pierre and Miquelon"},SD:{title:"Sudan"},SR:{title:"Suriname"},SJ:{title:"Svalbard and Jan Mayen Islands"},
SZ:{title:"Swaziland"},SE:{title:"Sweden"},CH:{title:"Switzerland"},SY:{title:"Syria"},TW:{title:"Taiwan"},TJ:{title:"Tajikistan"},TZ:{title:"Tanzania"},TH:{title:"Thailand"},TG:{title:"Togo"},TK:{title:"Tokelau"},TO:{title:"Tonga"},TT:{title:"Trinidad and Tobago"},TN:{title:"Tunisia"},TR:{title:"Turkey"},TM:{title:"Turkmenistan"},TC:{title:"Turks and Caicos Islands"},TV:{title:"Tuvalu"},UM:{title:"United States Minor Outlying Islands"},UG:{title:"Uganda"},UA:{title:"Ukraine"},AE:{title:"United Arab Emirates"},
GB:{title:"United Kingdom"},UY:{title:"Uruguay"},UZ:{title:"Uzbekistan"},VU:{title:"Vanuatu"},VA:{title:"Vatican City State (Holy See)"},VE:{title:"Venezuela"},VN:{title:"Viet Nam"},VG:{title:"Virgin Islands (British)"},VI:{title:"Virgin Islands (U.S.)"},WF:{title:"Wallis and Futuna Islands"},EH:{title:"Western Sahara"},YE:{title:"Yemen"},ZM:{title:"Zambia"},ZW:{title:"Zimbabwe"}},STATE_OPTIONS:{AL:{title:"Alabama"},AK:{title:"Alaska"},AZ:{title:"Arizona"},AR:{title:"Arkansas"},CA:{title:"California"},
CO:{title:"Colorado"},CT:{title:"Connecticut"},DE:{title:"Delaware"},FL:{title:"Florida"},GA:{title:"Georgia"},HI:{title:"Hawaii"},ID:{title:"Idaho"},IL:{title:"Illinois"},IN:{title:"Indiana"},IA:{title:"Iowa"},KS:{title:"Kansas"},KY:{title:"Kentucky"},LA:{title:"Louisiana"},ME:{title:"Maine"},MD:{title:"Maryland"},MA:{title:"Massachusetts"},MI:{title:"Michigan"},MN:{title:"Minnesota"},MS:{title:"Mississippi"},MO:{title:"Missouri"},MT:{title:"Montana"},NE:{title:"Nebraska"},NV:{title:"Nevada"},NH:{title:"New Hampshire"},
NJ:{title:"New Jersey"},NM:{title:"New Mexico"},NY:{title:"New York"},NC:{title:"North Carolina"},ND:{title:"North Dakota"},OH:{title:"Ohio"},OK:{title:"Oklahoma"},OR:{title:"Oregon"},PA:{title:"Pennsylvania"},RI:{title:"Rhode Island"},SC:{title:"South Carolina"},SD:{title:"South Dakota"},TN:{title:"Tennessee"},TX:{title:"Texas"},UT:{title:"Utah"},VT:{title:"Vermont"},VA:{title:"Virginia"},WA:{title:"Washington"},DC:{title:"Washington, District of Columbia"},WV:{title:"West Virginia"},WI:{title:"Wisconsin"},
WY:{title:"Wyoming"},AA:{title:"Armed Forces Europe"},AE:{title:"Armed Forces Americas"},AP:{title:"Armed Forces Pacific"}}};b.Squarespace.Localities.COUNTRIES_TO_STATES={US:b.Squarespace.Localities.STATE_OPTIONS,CA:{ON:{title:"Ontario"},QC:{title:"Quebec"},NS:{title:"Nova Scotia"},NB:{title:"New Brunswick"},MB:{title:"Manitoba"},BC:{title:"British Columbia"},PE:{title:"Prince Edward Island"},SK:{title:"Saskatchewan"},AB:{title:"Alberta"},NL:{title:"Newfoundland and Labrador"},NT:{title:"Northwest Territories"},
YT:{title:"Yukon"},NU:{title:"Nunavut"}}};b.Squarespace.Localities.countryCodeFromName=function(c){for(var d in b.Squarespace.Localities.COUNTRY_OPTIONS)if(b.Squarespace.Localities.COUNTRY_OPTIONS[d].title===c)return d};var d=function(c){return b.Array.reduce(b.Object.keys(c).sort(),[],function(b,d){b.push({label:c[d].title,value:d});return b})},c=function(b){return b.sort(function(b,c){return b.label<c.label?-1:1})};b.Squarespace.Localities.getNewCountryOptions=function(){return c(d(b.Squarespace.Localities.COUNTRY_OPTIONS))};
b.Squarespace.Localities.getNewStateOptionsForCountry=function(c){return d(b.Squarespace.Localities.COUNTRIES_TO_STATES[c])};b.Squarespace.Localities.getAmericentricSortedCountryOptions=function(){var c=b.Array.filter(b.Squarespace.Localities.getNewCountryOptions(),function(b){return""!==b.value});c.sort(function(b,c){return"United States"===b.label?-1:"United States"===c.label||b.label>c.label?1:b.label<c.label?-1:0});return c}});
YUI.add("squarespace-content-manager-widgets-splash-page",function(b){b.namespace("Squarespace.ContentManagerWidgets");b.Squarespace.ContentManagerWidgets.SplashPage=b.Base.create("ContentManagerSplashPage",b.Squarespace.ContentManagerWidgets.Base,[b.Squarespace.ContentManagerWidgets.SaveChangesTray],{},{CSS_PREFIX:"sqs-content-manager-splash-page",ATTRS:{addContentButtonVisible:{value:!1}}})},"1.0",{requires:["base","squarespace-content-manager-widgets-base","squarespace-content-manager-widgets-save-changes-tray"]});
YUI.add("squarespace-dialog-check-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-check.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p=this.escapeExpression;b='<div class="check-element ';if((h=d["if"].call(c,c.data,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){return"active"},k),data:k}))||0===h)b+=h;b+='">\n  ';if((l=d["if"].call(c,(h=c.strings,null==h||!1===h?h:h.title),
{hash:{},inverse:this.noop,fn:this.program(3,function(b,c){var e,d;return e=""+('\n    <div class="title">'+p((d=(d=b.strings,null==d||!1===d?d:d.title),"function"===typeof d?d.apply(b):d))+"</div>\n  ")},k),data:k}))||0===l)b+=l;b+="\n  ";if((l=d["if"].call(c,(h=c.strings,null==h||!1===h?h:h.description),{hash:{},inverse:this.noop,fn:this.program(5,function(b,c){var e,d;return e=""+('\n    <div class="description">'+p((d=(d=b.strings,null==d||!1===d?d:d.description),"function"===typeof d?d.apply(b):
d))+"</div>\n  ")},k),data:k}))||0===l)b+=l;return b+"\n</div>"})})();b.Handlebars.registerPartial("dialog-check.html".replace("/","."),d.templates["dialog-check.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-widget-resize",function(b){b.namespace("Squarespace").WidgetResize=b.Base.create("widget-resize",b.Plugin.Base,[],{initializer:function(){this._timers=[];this._host=this.get("host");this.on("resizeNodeChange",this._removeOldPlugin,this);this.on(["resizeVerticallyChange","resizeNodeChange"],this._resizeVerticallyChange,this);this.on("resize:start",this._onResizeStart,this);this.on("resize:resize",this._onResizeResize,this);this.on("resize:end",this._onResizeEnd,this);this.on("resize:mouseUp",
this._onResizeMouseUp,this);this.once("resize:ready",this._initSyntheticDblClick,this);this._resizeVerticallyChange();this._initSyntheticDblClick()},_initSyntheticDblClick:function(){var d=null,c=null,e=this.get("resizeNode").resize,f=b.bind(function(){c&&(c.detach(),c=null);d||(d=e.delegate.on("drag:mouseDown",function(g){d.detach();d=null;c=e.delegate.on("drag:mouseDown",function(b){e.fire("handle-dblclick");f()},this);b.later(300,this,f)},this))},this);f()},_resizeVerticallyChange:function(){var d=
this.get("resizeVertically"),c=this.get("resizeNode");d&&(c&&!c.resize)&&(this.resizeV&&this.resizeV.destroy(),c.plug(b.Plugin.Resize,{handles:this.get("handles"),wrap:this.get("wrap"),defMinHeight:this.get("minHeight")}),this.resizeV=c.resize,c.resize.on("resize:start",this.fire,this),c.resize.after("resize:resize",this.fire,this),c.resize.on("resize:end",this.fire,this));this._timers.push(b.later(0,this,this.resetResizeWrapperSize))},_removeOldPlugin:function(d){d.prevVal&&d.prevVal.hasPlugin(b.Plugin.Resize.NS)&&
d.prevVal.unplug(b.Plugin.Resize)},_onResizeStart:function(b){b=this._host.get("boundingBox");this._host.get("contentBox");b.addClass("sqs-resizing")},_onResizeResize:function(b){b=this._host.get("boundingBox").get("region");this.set("aspectRatio",100*(b.height/b.width))},_onResizeEnd:function(b){this._host.get("boundingBox").removeClass("sqs-resizing");this.resetResizeWrapperSize()},resetResizeWrapperSize:function(){this._timers.push(b.later(0,this,function(){var b=this.get("resizeNode"),c=this._host.get("boundingBox"),
e={height:null,width:null};b.setStyles(e);b!==c&&c.setStyles(e);this.resizeV&&this.resizeV.get("wrapper").setStyles(e)}))},destructor:function(){for(this.get("resizeNode").unplug(b.Plugin.Resize);0!==this._timers.length;)this._timers.shift().cancel()}},{NS:"WidgetResize",ATTRS:{aspectRatio:{value:null},handles:{value:["b"],validator:b.Lang.isArray},minHeight:{value:50,validator:b.Lang.isNumber},resizeVertically:{value:!0,lazyAdd:!1},resizeNode:{valueFn:function(){this.get("host").get("boundingBox")}},
wrap:{value:!0}}})},"1.0",{requires:["resize","resize-plugin"]});
YUI.add("squarespace-file-manager-tab-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["file-manager-tab.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="file-manager-tab">\n  <div class="options"></div>\n  <div class="frames"></div>\n</div>\n'})})();b.Handlebars.registerPartial("file-manager-tab.html".replace("/","."),d.templates["file-manager-tab.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-flickr-oembed-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["flickr-oembed.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="flickr-oembed">\n  <a href="';(h=d.url)?h=h.call(c,{hash:{},data:k}):(h=c.url,h="function"===typeof h?h.apply(c):h);b+=l(h)+'">\n    <img src="';(h=d["flickr-url"])?h=h.call(c,{hash:{},data:k}):(h=c["flickr-url"],
h="function"===typeof h?h.apply(c):h);b+=l(h)+'" width="100%" />\n  </a>\n  ';if((h=d["if"].call(c,c.title,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n    <p><a href="';(f=d.url)?f=f.call(b,{hash:{},data:c}):(f=b.url,f="function"===typeof f?f.apply(b):f);e+=l(f)+'">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f="function"===typeof f?f.apply(b):f);return e+=l(f)+"</a></p>\n  "},k),data:k}))||0===h)b+=h;return b+"\n</div>"})})();b.Handlebars.registerPartial("flickr-oembed.html".replace("/",
"."),d.templates["flickr-oembed.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-content-manager-navigation-bar",function(b){var d=b.namespace("Squarespace.ContentManager").NavigationBar=b.Base.create("NavigationBar",b.Squarespace.SSWidget,[b.WidgetChild,b.WidgetParent],{initializer:function(){this.addPageDialog=new b.Squarespace.ContentManager.AddPageDialog;this.navigationExternalLinkDialog=new b.Squarespace.Editor.NavigationExternalLink;this.navigationPageDialog=new b.Squarespace.Editor.NavigationCollection},renderUI:function(){d.superclass.renderUI.call(this);
var c=this.get("contentBox");this.get("template").get("navigations").each(function(e){this.add({childType:b.Squarespace.ContentManager.Navigation,navigation:e,render:c.one(".navigations")})},this);this.get("navigationLocked")?this.get("boundingBox").addClass(this.getClassName("locked")):this._attachDragAndDrop();this.get("navigationPermanentlyLocked")&&this.get("boundingBox").addClass(this.getClassName("permanently-locked"));this.get("contentBox").appendChild('<div class="recycle-bin-button"><span>Deleted Pages</span></div>')},
bindUI:function(){this._bindDuplicatePageBehaviors();this._bindAddPageBehaviors();this._bindNavigationItemConfigurationBehaviors();this._bindChildSelectedBehaviors();this._bindNavigationScrollLock();this._bindRecycleBinButton()},syncUI:function(){var b=0<Static.SQUARESPACE_CONTEXT.deletedCollectionsCount,e=this.getClassName("recycle-bin-visible");this.get("boundingBox").toggleClass(e,b)},_bindRecycleBinButton:function(){var c=this.get("contentBox").one(".recycle-bin-button");c.on("click",function(b){b.halt();
this.get("root").showReycleBin(c)},this);this._registerEvent(b.Squarespace.ContentCollectionCache.on("add",function(b){Static.SQUARESPACE_CONTEXT.deletedCollectionsCount--;this.syncUI()},this));this._registerEvent(b.Squarespace.ContentCollectionCache.on(["*:clonedExampleContent","remove"],function(b){Static.SQUARESPACE_CONTEXT.deletedCollectionsCount++;this.syncUI()},this))},_bindNavigationScrollLock:function(){this.get("scrollableNode").plug(b.Squarespace.ScrollLock)},_bindNavigationLockBehaviors:function(){var c=
this.get("contentBox").one(".standard-toggle.lock");c.on("click",function(){b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)&&this.set("navigationLocked",!this.get("navigationLocked"))},this);this.on("navigationLockedChange",function(e){c[e.newVal?"addClass":"removeClass"]("active");c.setContent(this.get("strings."+(e.newVal?"locked":"unlocked")));this.get("boundingBox")[e.newVal?"addClass":"removeClass"](this.getClassName("locked"));b.Data.post({url:"/api/config/SetNavigationLock",
data:{locked:e.newVal}},this);Static.SQUARESPACE_CONTEXT.authenticatedAccount.editingSiteIds||(Static.SQUARESPACE_CONTEXT.authenticatedAccount.editingSiteIds=[]);e.newVal?(Static.SQUARESPACE_CONTEXT.authenticatedAccount.editingSiteIds.remove(b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"])),this._detachDragAndDrop()):(Static.SQUARESPACE_CONTEXT.authenticatedAccount.editingSiteIds.push(b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"])),this._attachDragAndDrop())},this)},
_bindDuplicatePageBehaviors:function(){this.navigationPageDialog.on("page-duplicated",function(c){this.get("root").set("selectedCollection",b.Squarespace.ContentCollectionCache.getById(c.collection.get("id")))},this)},_bindAddPageBehaviors:function(){this.get("contentBox").delegate("click",function(c){var e=b.Widget.getByNode(c.target);if(b.instanceOf(e,b.Squarespace.ContentManager.NavigationItemFolder)){var d=e.get("collectionConfiguration");b.Lang.isArray(d)&&0===d.length&&(d=e.get("item").getNavigationItemList().getTemplateNavigation());
this.showAddPageDialog(c.target.ancestor(".add-page",!0),d)}else b.instanceOf(e,b.Squarespace.ContentManager.Navigation)?this.showAddPageDialog(c.target.ancestor(".add-page",!0),e.get("navigation")):console.warn("This shouldnt have happened.");c.halt()},".add-page",this)},_bindNavigationItemConfigurationBehaviors:function(){this.get("contentBox").delegate("contextmenu",function(c){if(!this.get("navigationLocked")){var e=b.Widget.getByNode(c.target);b.instanceOf(e,b.Squarespace.ContentManager.NavigationItem)&&
(this.showConfigureNavigationItemDialog(e),c.halt())}},".sqs-navigation-item",this);this.get("contentBox").delegate("click",function(c){var e=b.Widget.getByNode(c.target);b.instanceOf(e,b.Squarespace.ContentManager.NavigationItem)&&(this.showConfigureNavigationItemDialog(e),c.halt())},".icon.icon-configure",this);this.get("contentBox").delegate("click",function(c){c.halt();c=b.Widget.getByNode(c.target);this.showDeleteNavigationItemConfirmation(c)},".icon.icon-delete",this);this._registerEvent(b.Squarespace.ContentCollectionCache.on("*:clonedExampleContent",
function(c){c=b.Widget.getByNode(this.get("boundingBox").one("#collection-"+c.target.get("id")));b.Lang.isValue(c)?this.showConfigureNavigationItemDialog(c):console.error("Could not find the navigation item widget!")},this))},_bindChildSelectedBehaviors:function(){var c=this.get("scrollableNode");this.on("*:isSelectedChange",function(b){if(b.newVal){b=b.target.get("boundingBox").getY();var d=c.get("scrollTop")+c.get("offsetHeight");b>d&&c.set("scrollTop",b)}},this);this._registerEvent(c.on("scroll",
function(){b.Array.each([this.navigationExternalLinkDialog,this.navigationPageDialog],function(b){b.get("visible")&&b.get("dialog")._updatePosition(!0)})},this))},showAddPageDialog:function(c,e){var d=this.addPageDialog.get("dialog");this._addPageDataChangeHandler&&this._addPageDataChangeHandler.detach();this._addPageDataChangeHandler=d.once("datachange",function(c){"newNavigationItemType"==c.getName()&&this._createNewNavigationItemType(b.Widget.getByNode(d.getAnchorEl()),c)},this);this.addPageDialog.setAttrs({model:e,
template:this.get("template"),anchorNode:c});this.addPageDialog.show()},_showSavingGuardEl:function(){var c=this.addPageDialog.get("dialog");this._savingGuardEl=b.Node.create('<div style="position:fixed;top:0;left:0;bottom:0;right:0;z-index:'+(c.zIndex-1)+';"></div>');this._savingGuardEl.on("click",function(b){b.halt();c.el.setStyles({transform:"scale(1)"});var d=c.el;d.transition({transform:"scale(1.04)",duration:0.2,easing:"ease-in",on:{end:function(){d.transition({transform:"scale(1)",duration:0.2,
easing:"ease-out"})}}})},this);b.one("body").appendChild(this._savingGuardEl)},_hideSavingGuardEl:function(){this._savingGuardEl.remove(!0)},showConfigureNavigationItemDialog:function(c,e){var d=c.get("item"),g=d.get("collection"),h=this.get("id");if(g)if(g.get("isDemoCollection"))(new b.Squarespace.Widgets.Confirmation({"strings.title":"Modifying Example Content","strings.message":"To edit example content, you must first make this page your own.","strings.confirm":"Make a Page Like This"})).on("confirm",
function(){g.cloneToNewCollection()});else{var h=this.get("root"),k=h.get("selectedCollection");!d.isFolder()&&(k!==g&&!b.Squarespace.Utils.isDamaskEnabled())&&h.set("selectedCollection",g);h=this.navigationPageDialog.get("dialog");this._navigationPageDialogRemoveHandle&&this._navigationPageDialogRemoveHandle.detach();this._navigationPageDialogRemoveHandle=h.on("remove-requested",function(){d.get("collection").once("destroy",function(){this.navigationPageDialog.hide()},this);this.showDeleteNavigationItemConfirmation(c)},
this);if(e){var l=!1,p=function(){l||d.destroy({remove:!0});l=!0},q=h.once(this.get("id")+"|cancel",p,this),r=b.once("target-closed",function(b){b.target.canClose&&b.target.canClose()&&p.call(this)},this);h.once([this.get("id")+"|button-setFront",this.get("id")+"|dismiss"],function(){q.detach();r.detach()})}this.navigationPageDialog.setAttrs({anchorNode:c.get("contentBox"),model:g,isNew:e});this.navigationPageDialog.show()}else if(d.get("externalLink"))k=this.navigationExternalLinkDialog.get("dialog"),
this._navigationExternalLinkDialogDataChangeHandle&&this._navigationExternalLinkDialogDataChangeHandle.detach(),this._navigationExternalLinkDialogDataChangeHandle=k.on("datachange",function(c){(c.getDialog?c.getDialog():c.get("dialog")).state==b.Squarespace.DialogStates.EDITING&&"title"==c.getName()&&d.set("externalLink.title",c.getValue())}),this._navigationExternalLinkDialogRemoveHandle&&this._navigationExternalLinkDialogRemoveHandle.detach(),this._navigationExternalLinkDialogRemoveHandle=k.on(h+
"|remove-requested",function(b){d.detach(this.get("id")+"|destroy");d.on(this.get("id")+"|destroy",function(){this.navigationExternalLinkDialog.hide()},this);this.showDeleteNavigationItemConfirmation(c)},this),this._navigationExternalLinkDialogCancelHandle&&this._navigationExternalLinkDialogCancelHandle.detach(),this._navigationExternalLinkDialogCancelHandle=k.on(h+"|cancel",function(){d.reset()}),this.navigationExternalLinkDialog.setAttrs({anchorNode:c.get("contentBox"),model:d}),this.navigationExternalLinkDialog.show();
else throw"Unknown entity trying to be configured.";},_createNewNavigationItemType:function(c,e){this._showSavingGuardEl();var d=this.addPageDialog.get("dialog");d.state=b.Squarespace.DialogStates.SAVING;d.updateTitle();d.showSaveOverlay();var g=b.bind(function(b){this._hideSavingGuardEl();this.showConfigureNavigationItemDialog(b,!0)},this),h;if(b.instanceOf(c,b.Squarespace.ContentManager.NavigationItemFolder))h=c.get("item").get("children");else if(b.instanceOf(c,b.Squarespace.ContentManager.Navigation))h=
c.get("navigation").get("itemList");else throw"Invalid anchorEl. Where did this dialog originate from?";var k={};b.Squarespace.Utils.isDamaskEnabled()&&(k.index=0);d=e.getValue();if("link"==d)c.onceAfter("addChild",function(b){g(b.child)},this),h.add({externalLink:{newWindow:!1,title:"",url:""}},k),h.save();else{var l=this.get("template").get("collectionConfigs."+d);if(!l)throw"No Collection Configuration found for type: "+d;b.Squarespace.ContentCollectionCache.create({title:"New "+l.get("title"),
navigationTitle:"New "+l.get("title"),typeName:d,type:l.get("collectionType"),ordering:l.get("ordering"),folder:l.get("folder"),folderBehavior:l.get("folderBehavior"),enabled:!0},b.bind(function(e,d){if(e)(new b.Squarespace.SystemError("Something Went Wrong",a,"json")).show();else{c.onceAfter("addChild",function(b){this.get("navigationLocked")||(this._detachDragAndDrop(),this._attachDragAndDrop());g(b.child)},this);var f=h.add({collectionId:d.id,typeName:d.typeName,urlId:d.urlId,title:d.navigationTitle,
folder:d.folder,enabled:!0},k);f.isFolder()&&(f.get("children").setTemplateNavigation(h.getTemplateNavigation()),f.get("children").setNavigationItemList(h));h.save()}},this))}},showDeleteNavigationItemConfirmation:function(c){c.get("item");b.Squarespace.NavigationUIUtils.deleteNavigationItem(c.get("item"))},_attachDragAndDrop:function(){this._dd=new b.Squarespace.ContentManager.NavigationBarDD({contentBox:this.get("contentBox"),scrollableNode:this.get("scrollableNode")});this._dd.addTarget(this)},
_detachDragAndDrop:function(){this._dd.destroy()},destructor:function(){this.get("navigationLocked")||this._detachDragAndDrop();this.addPageDialog.destroy();this.navigationExternalLinkDialog.destroy();this.navigationPageDialog.destroy()}},{CSS_PREFIX:"sqs-navigation-bar",HANDLEBARS_TEMPLATE:"navigation-bar.html",ATTRS:{strings:{value:{title:"Pages",description:"Pages lets you add, remove, position and edit the pages on your site."}},template:{valueFn:function(){return b.Squarespace.Singletons.Template||
new b.Squarespace.Models.Template(Static.SQUARESPACE_CONTEXT.template)}},navigationLocked:{valueFn:function(){return this.get("navigationPermanentlyLocked")?!0:!b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)}},navigationPermanentlyLocked:{valueFn:function(){if(!b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE))return!0;var c=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","plan"]);return c&&c==
b.Squarespace.PlanIds.DOMAIN?!0:!1}},scrollableNode:{valueFn:function(){return b.one(".navigation-builder")||this.get("boundingBox")}}}})},"1.0",{requires:"squarespace-ss-widget squarespace-ui-base widget-parent widget-child squarespace-content-manager-navigation-item-folder squarespace-content-manager-navigation-item squarespace-content-manager-navigation squarespace-models-template squarespace-model-editor squarespace-navigation-bar-template squarespace-editor-navigation-external-link squarespace-editor-navigation-collection squarespace-content-manager-add-page-dialog squarespace-content-manager-navigation-bar-dd squarespace-configuration-panel-footer squarespace-content-manager-navigation-ui-utils squarespace-models-content-collection squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-widgets-model-list-header-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-model-list-header.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n      <div class="action-button" data-name="';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===q?f.apply(b):f);e+=r(f)+'">';(f=d.label)?f=f.call(b,{hash:{},data:c}):(f=b.label,f=typeof f===q?f.apply(b):f);return e+=r(f)+"</div>\n    "}this.compilerInfo=[4,
">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p,q="function",r=this.escapeExpression,s=this;b=""+('<div class="header-title">'+r((p=(p=c.strings,null==p||!1===p?p:p.title),typeof p===q?p.apply(c):p))+"</div>\n\n");if((p=d.unless.call(c,c.isSingleTab,{hash:{},inverse:s.noop,fn:s.program(1,function(b,c){return'\n  <div class="tab-select-container"></div>\n'},k),data:k}))||0===p)b+=p;b+="\n\n";if((p=d["if"].call(c,c.hasActionButtons,{hash:{},inverse:s.noop,fn:s.program(3,function(b,c){var e,f;e=
'\n  <div class="header-action-buttons">\n    ';if((f=d.each.call(b,b.actionButtons,{hash:{},inverse:s.noop,fn:s.program(4,l,c),data:c}))||0===f)e+=f;return e+"\n  </div>\n"},k),data:k}))||0===p)b+=p;return b+'\n\n<div class="tab-description"></div>\n<div class="header-controls"></div>\n'})})();b.Handlebars.registerPartial("widgets-model-list-header.html".replace("/","."),d.templates["widgets-model-list-header.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-content-html-editor",function(b){b.namespace("Squarespace.Content").HtmlEditor=b.Base.create("contentHtmlEditor",b.Squarespace.Content.HtmlEditorBase,[],{initializer:function(){this._cb.on("contextmenu",this._onContextMenu,this);this._cb.on("keyup",this._onKeyUp,this);this._cb.on("paste",this._onPaste,this)},_onContextMenu:function(b){b.stopPropagation();this.block.get("focusHandler").mouseUpPropagationStopped(b)},_onKeyUp:function(d){this._debounceSaveOnKeyUp||(this._debounceSaveOnKeyUp=
b.Squarespace.debounce(function(){this._save()},100));!{27:!0,16:!0,17:!0,18:!0,20:!0,36:!0,35:!0,33:!0,34:!0,37:!0,38:!0,39:!0,40:!0,112:!0,113:!0,114:!0,115:!0,116:!0,117:!0,118:!0,119:!0,120:!0,121:!0,122:!0,123:!0,45:!0,91:!0,144:!0}[d.keyCode]&&this._debounceSaveOnKeyUp();(13===d.keyCode||8===d.keyCode||46===d.keyCode)&&this._fireContentUpdate()},_onPaste:function(){b.soon(b.bind(function(){this._save();this._fireContentUpdate()},this))},initVisualEngine:function(){var d=this.get("host").get("parent"),
c=b.Squarespace.Wysiwyg.ToolbarTypes.LAYOUT_SMALL;d&&d.get("type")===b.Squarespace.BlockType.HTML&&(c=b.Lang.isValue(this._bb.ancestor(".sqs-locked-layout"))?b.Squarespace.Wysiwyg.ToolbarTypes.LOCKED_BLOCK:b.Squarespace.Wysiwyg.ToolbarTypes.BLOCK);this.visualEditor=new b.Squarespace.Wysiwyg.Editor({node:this._host.get("contentBox"),editorType:b.Squarespace.Wysiwyg.EditorTypes.INLINE,toolbarType:c});this.visualEditor.on("change",function(){this._save()},this);d&&(this.visualEditor.on("dataReady",function(){d.fire("widget:contentUpdate")},
this),this.visualEditor.on("blur",function(){d.get("editController").alignInsertPoints(this._bb.ancestor(".sqs-layout"))},this),this.visualEditor.on("removeBlock",b.bind(function(){var c=this._cb.ancestor(".sqs-block");c.addClass("sqs-confirmation-open");var f=new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Block","strings.message":"Are you sure you wish to remove this block?"});f.on("confirm",function(){c.removeClass("sqs-confirmation-open");this.block.queueForDestruction();d.get("editController").cleanGrids(this._bb.ancestor(".sqs-layout"))},
this);f.on("cancel",function(){c.removeClass("sqs-confirmation-open")},this)},this)));this.afterHostEvent("editableChange",function(b){this.visualEditor.set("editable",b.newVal)});this.afterHostEvent("focusedChange",function(b){!0===b.newVal&&this.visualEditor.giveEditorFocus()},this)},_getVisualEditorData:function(){return this.visualEditor.getEditorData()},_giveEditorFocus:function(){if(this.visualEditor)return this.visualEditor.giveEditorFocus()},_destroyVisualEditor:function(){b.Lang.isValue(this.visualEditor)&&
this.visualEditor.destroy()}},{NS:"contentEditor"})},"2.0",{requires:"base squarespace-edit-controller-web-app squarespace-enum squarespace-block-content-html-editor-base squarespace-widgets-confirmation squarespace-wysiwyg-editor".split(" ")});
YUI.add("squarespace-jobui",function(b){b.namespace("Squarespace");b.Squarespace.JobNotification=Class.extend(b.Squarespace.ConfirmationDialog,{initialize:function(d){d||(d={});d.className="jobnotification";d.autoHide=2E3;d.clickToClose=!0;d.escToCancel=!1;d.showScreenOverlay=!1;b.Squarespace.Alert.prototype.superclass.initialize.call(this,d);return this},getButtons:function(){return null}});b.Squarespace.JobUi=Class.create({initialize:function(){this.el=b.Node.create('<div class="progress"><div class="right"><div class="meterouter"><div class="meterinner"></div></div></div><div class="left"><div class="meterouter"><div class="meterinner"></div></div></div><div class="circle"></div></div>');
this.rightside=this.el.one(".right .meterouter");this.leftside=this.el.one(".left  .meterouter");this.anim=null;this.queue=[];this.jobIndices={};this.setRange(0);var d=b.later(50,this,function(){b.one(".config-panel.root")&&(d.cancel(),b.one(".config-panel.root").appendChild(this.el),"undefined"!=typeof Static.JOB_MANAGER?(Static.JOB_MANAGER.on("started",this.onStarted,this),Static.JOB_MANAGER.on("completed",this.onCompleted,this),Static.JOB_MANAGER.on("failed",this.onFailed,this)):this.test())},
"",!0);this.counter=0},activate:function(){this.el.addClass("active")},deactivate:function(){this.el.removeClass("active");this.setProgress(0);this.setRange(0)},onStarted:function(b){this.activate();this.addJobs(b);this.setProgress()},onCompleted:function(b){this.removeJob(b);this.setProgress();0===this.queue.length&&this.stop()},addJobs:function(d){b.Lang.isArray(d)||(d=[d]);d.forEach(function(b){this.jobIndices[b.id]=this.queue.push(b)-1},this);this.total+=d.length},removeJob:function(d){var c=
this.jobIndices[d.id];b.Lang.isUndefined(c)||(this.queue.splice(c,1),this.jobIndices[d.id]=void 0)},onFailed:function(b){console.error("jobs failed",b);this.removeJob(b);0===this.queue.length&&this.stop()},setRange:function(b){this.total=b;this.setMarkers(b)},setProgress:function(){var b=(this.total-this.queue.length)*(100/this.total),c=3.6*b;this.setMarkers();0<=b&&51>b?(this.rightside.setStyle("transform","rotate("+(-180+c)+"deg)"),this.leftside.setStyle("transform","rotate(-180deg)")):(b=-360+
c,this.rightside.setStyle("transform","rotate(0deg)"),this.leftside.setStyle("transform","rotate("+b+"deg)"))},stop:function(){b.later(1E3,this,function(){this.el.removeClass("active");b.later(400,this,function(){this.setProgress(0);this.total=0})})}})},"1.0",{requires:["squarespace-job-manager","squarespace-ui-base","node","event"]});
YUI.add("squarespace-content-item-types-base",function(b){function d(c,d,g){if(d){for(var h=[],k=d.get("fields"),l=0;l<k.length;l++){var p=k[l];switch(p.type){case "text":h.push({$include:["fields.title",{"config.name":"custom-"+p.name,"config.strings.title":p.title||"","config.strings.placeholder":""}]});break;case "checkbox":h.push({ctor:b.Squarespace.DialogFields.Check,config:{name:"custom-"+p.name,"strings.title":p.title}});break;case "wysiwyg":h.push({ctor:b.Squarespace.DialogFields.Description,
config:{title:p.title||""}});h.push({ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"custom-"+p.name,toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:227,classNames:"major"}});break;case "image":(function(c){h.push({$include:["fields.mainImage",{name:"custom-"+c.name,mode:b.Squarespace.UploadModes.CHILD,childType:b.Squarespace.RecordType.IMAGE,preflight:function(b){var e=g.get("model"),d=g.get("dialog").getField("custom-"+c.name);e.get("id")?b&&b():(e.once("save",function(){d.get("data").set("parentId",
e.get("id"));d.refreshItemPostData();b&&b()}),g.autoSave())}}]})})(p);break;case "gallery":(function(c){h.push({ctor:b.Squarespace.DialogFields.Description,config:{title:c.title||""}});h.push({$include:["fields.childItemsGrid",{"config.width":null,"config.height":170,"config.name":"custom-"+c.name,"config.uploadPreflight":function(b){var e=g.get("model"),d=g.get("dialog").getField("custom-"+c.name).get("data");e.get("id")?(d.set("id",e.get("id")),b()):(e.once("save",function(){d.set("id",e.get("id"));
b()},e),g.autoSave())}}]})})(p)}}d={tabTitle:d.get("title"),name:d.get("name"),scroll:!0,fields:h};c.tabs.push(d)}}b.namespace("Squarespace.ContentItemEditor");var c=b.Squarespace.ContentItemEditor.Base=b.Base.create("ContentItemEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){if(this.constructor===c)throw"You cannot instantiate the BaseContentItemEditor.";var e=this.get("dialog"),d=this.get("model");e.on("button-saveAndPublish",this._saveAndPublish,this);e.on("remove-requested",
this._confirmAndRemoveItem,this);e.on("ready",this._dialogOnReady,this);(this._isNew=d.isNew())&&this.plug(b.Squarespace.ModelEditorPlugins.AutoSave)},_saveAndPublish:function(c){c.halt();c=this.get("dialog");this.get("model").set("workflowState",b.Squarespace.WorkflowStates.PUBLISHED);var d=c.getField("workflow"),g=d.getValue(),h=(new Date).getTime();"draft"!==g.state&&(h=g.date);d.setValue({state:"published",date:h});c.saveAndClose()},_dialogOnReady:function(){var c=this.get("dialog");this.get("model");
this._bindFileUploadBehaviors("mainImage");var d=c.getField("workflow");if(d)d.on("dataChange",function(d){d=b.Squarespace.ObjectBuilder.make({buttons:this.get("dialogConfig.buttons")},this.get("dialogConfigContext"),{id:this._isNew?null:this.get("model").get("id"),workflowState:this._getWorkflowStateForString(d.newVal.state)});c.setButtons(d.buttons)},this)},_bindFileUploadBehaviors:function(b){var c=this.get("dialog").getField(b),d=this.get("model");c&&c.after("dataChange",function(){if(c.get("data")){var b=
c.get("data").get("id");d.get("id")!=b&&d.set("id",b)}else d.get("id")&&d.clearFileData()},this)},_confirmAndRemoveItem:function(c){var d;d=this.getPresentationName();var g=this.get("model");this._isNew?(c="Discard "+d,d="Are you sure you wish to discard this "+d.toLowerCase()+"?"):(c="Remove "+d,d="Are you sure you wish to remove this "+d.toLowerCase()+"?");(new b.Squarespace.Widgets.Confirmation({"strings.title":c,"strings.message":d})).on("confirm",function(){g.destroy({remove:!0});this.destroy()},
this)},getDialogData:function(){var e=c.superclass.getDialogData.call(this);e.mainImage=this.get("model");e.workflow={state:b.Squarespace.ContentItemUtils.getWorkflowStateIdentifier(e.workflowState),date:e.publishOn};e.commenting={state:b.Squarespace.ContentItemUtils.getCommentStateIdentifier(e.commentState),date:e.commentDisableOn};e.gallery=this.get("model");e.clickthroughUrl&&(e.clickthroughUrl={url:e.clickthroughUrl});var d=this.getCustomTypeConfiguration();if(d)for(var d=d.get("fields"),g=0;g<
d.length;g++){var h=d[g].type,k=d[g].name,l=b.Object.getValue(e,["customContent",k]);switch(h){case "text":case "wysiwyg":e["custom-"+k]=l;break;case "checkbox":e["custom-"+k]=l;break;case "image":b.Lang.isValue(l)?e["custom-"+k]=new b.Squarespace.Models.ContentItem(b.merge(l,{collectionId:this.get("model").get("collectionId"),parentId:this.get("model").get("id"),recordType:b.Squarespace.RecordType.IMAGE})):e["custom-"+k]=new b.Squarespace.Models.ContentItem({collectionId:this.get("model").get("collectionId"),
parentId:this.get("model").get("id"),recordType:b.Squarespace.RecordType.IMAGE});break;case "gallery":h=new b.Squarespace.Models.ContentItem({id:this.get("model").get("id"),collectionId:this.get("model").get("collectionId"),recordType:b.Squarespace.RecordType.IMAGE});b.Lang.isValue(l)&&h.get("items").add(l);e["custom-"+k]=h;break;default:b.Squarespace.Logger.log("Custom Type Saving Error",{message:"Could not find any data to set for field.",field:d[g]})}}return e},sanitizeDialogData:function(c){delete c.author;
delete c.mainImage;delete c.mediaProcessingState;for(var d="addedOn publishOn updatedOn commentDisableOn startDate endDate".split(" "),g=0;g<d.length;g++)b.Lang.isDate(c[d[g]])?c[d[g]]=c[d[g]].getTime():b.Lang.isNumber(c[d[g]])&&console.warn(d[g]+" should really be a date. Should fix this.");c.commentState=b.Squarespace.CommentStates["allow"==c.commenting.state?"ENABLED":"DISABLED"];c.commentDisableOn=c.commenting.date;delete c.commenting;c.workflowState=this._getWorkflowStateForString(c.workflow.state);
c.publishOn=c.workflow.date;delete c.workflow;c.tags=c.tags||[];c.categories=c.categories||[];delete c.id;delete c.gallery;b.Lang.isObject(c.clickthroughUrl)&&(c.clickthroughUrl=c.clickthroughUrl.url);if(g=this.getCustomTypeConfiguration()){d=g.get("fields");b.Lang.isObject(c.customContent)||(c.customContent={customType:g.get("name")});for(g=0;g<d.length;g++){var h=d[g],k=h.name;switch(h.type){case "text":case "wysiwyg":case "checkbox":c.customContent[k]=c["custom-"+k];delete c["custom-"+k];break;
case "image":c["custom-"+k].get("hasFileData")?c.customContent[k]=c["custom-"+k].getAttrs():delete c.customContent[k];delete c["custom-"+k];break;case "gallery":c.customContent[k]=this.get("dialog").getField("custom-"+k).get("data").get("items").toJSON();delete c["custom-"+k];break;default:b.Squarespace.Logger.log("Custom Type Saving Error",{message:"Could not find anything for field.",field:h})}}}return c},_getWorkflowStateForString:function(c){if("published"==c)return b.Squarespace.WorkflowStates.PUBLISHED;
if("scheduled"==c)return b.Squarespace.WorkflowStates.SCHEDULED;if("needsreview"==c)return b.Squarespace.WorkflowStates.NEEDS_REVIEW;if("draft"==c)return b.Squarespace.WorkflowStates.DRAFT},_getTemplateContext:function(){var c=this.get("model").toJSON(),d=this.get("model").get("collectionId");b.Squarespace.ContentCollectionCache.getCollectionById(d,function(b){c.urlPrefix="/"+b.get("urlId")+"/"});c.presentationName=this.getPresentationName();c.model=this.get("model");c.editor=this;return c},getTemplateContext:function(){var b=
this._getTemplateContext(),c=this.getCustomTypeConfiguration();c&&(b.presentationName=c.get("title"));return b},getPresentationName:function(){var c=this.get("model").get("recordType");return b.Squarespace.Enums.RecordType.titleForValue(c)},getCustomTypeConfiguration:function(){var c=this.get("model").get("customContent.customType");return c&&(c=b.Squarespace.Singletons.Template.get("customTypes."+c))?c:null},_getDialogConfig:function(){var c=b.clone(this.get("editorConfiguration"));d(c,this.getCustomTypeConfiguration(),
this);return c=b.merge({initialDataByReference:!0},c)}},{ATTRS:{editorConfiguration:{value:{}},dialogConfig:{getter:"_getDialogConfig"},dialogConfigContext:{value:b.Squarespace.ContentItemEditorSettings},collection:{}}})},"1.0",{requires:"squarespace-content-item-types-settings squarespace-enum squarespace-model-editor squarespace-content-item-types-enum-record-type squarespace-models-content-collection squarespace-models-content-item squarespace-models-template squarespace-dialog-description squarespace-content-item-utils squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-settings-advanced-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-advanced.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b='\x3c!--<div class="panel-description">';if((d=(l=(l=c.strings,null==l||!1===l?l:l.description),"function"===typeof l?l.apply(c):l))||0===d)b+=d;b+='</div>--\x3e\n<div class="help">\n  <div class="domain-notice">\n    <p>Squarespace\'s URL mappings allow you to change the location of certain URLs on your site. The rules will only be applied when no real mapping is found. Mappings below should be listed individually with one mapping per line in the\n    format:</p>\n\n    <pre><strong>&lt;original url&gt; -&gt; &lt;new url&gt; &lt;redirect type&gt;</strong></pre>\n\n    <p>Example:</p>\n\n    <pre><strong>/journal/[name] -&gt; /blog/[name] 301</strong></pre>\n\n    <p>Where:</p>\n  </div>\n\n  <dl class="url-map-tokens">\n    <dt>&lt;original url&gt;</dt>\n    <dd>Refers to the original URL that a user would type into their browser on your\n      site. Can contain [id] to refer numeric portions of the old url pattern or [name]\n      to refer to name of the item</dd>\n\n    <dt>&lt;new url&gt;</dt>\n    <dd>Refers to the new location for the original content on your site.</dd>\n\n    <dt>&lt;redirect type&gt;</dt>\n    <dd>Either a 301 or 302 redirect. <a target="new" href="';
if((d=(l=(l=c.strings,null==l||!1===l?l:l["help-redirect-types-href"]),"function"===typeof l?l.apply(c):l))||0===d)b+=d;b+='">What is the difference?</a></dd>\n  </dl>\n\n  <p><a target="new" href="';if((d=(l=(l=c.strings,null==l||!1===l?l:l["help-url-mappings-href"]),"function"===typeof l?l.apply(c):l))||0===d)b+=d;b+='">Click here for more help regarding URL mappings.</a></p>\n\n</div>\n<div class="loading-message">';if((d=(l=(l=c.strings,null==l||!1===l?l:l.loadingMessage),"function"===typeof l?
l.apply(c):l))||0===d)b+=d;return b+'</div>\n\n<div class="settings-panel-fields"></div>'})})();b.Handlebars.registerPartial("settings-advanced.html".replace("/","."),d.templates["settings-advanced.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-form-pre-submit-topic",function(b){var d={EMPTY:1,SUB_TOPICS:2,CONTENT:3};b.namespace("Squarespace");var c=b.Squarespace.FormPreSubmitTopic=b.Base.create("FormPreSubmitTopic",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{initializer:function(){this.publish("removeClicked",{emitFacade:!0});this.publish("titleFieldEnter",{emitFacade:!0});var c=this.get("topic");this._titleField=new b.Squarespace.DialogFields.Text({name:"topicTitle",data:c.get("title")});this._labelField=new b.Squarespace.DialogFields.LabeledText({name:"topicLabel",
data:c.get("label"),className:"thin","strings.placeholder":"Label"});this._subTopicsField=new b.Squarespace.DialogFields.PreSubmitBuilder({name:"subTopics",isSubTopics:!0,data:c.get("subTopics")});this._contentField=new b.Squarespace.DialogFields.ContentItemListBuilder({name:"content",collectionType:b.Squarespace.CollectionTypes.GENERIC,recordType:b.Squarespace.Enums.RecordType.KBARTICLE,allowClear:!this.get("isSubTopic"),data:c.get("relatedContentItems")})},destructor:function(){this.blur();this._titleField.destroy();
this._labelField.destroy();this._subTopicsField.destroy();this._contentField.destroy()},renderUI:function(){c.superclass.renderUI.call(this);var e=this.get("contentBox");this._editButton=e.one("> .topic-control-bar > .topic-controls > .edit-topic");var d=this._topicChildrenNode=e.one("> .topic-children");d.plug(b.Squarespace.Animations.Expandable,{duration:0.2});d.hide(!0);this._titleField.render(e.one("> .topic-control-bar > .topic-title"));this._labelField.render(d.one("> .topic-label"));this._subTopicsField.render(d.one("> .topic-sub-topics"));
this._contentField.render(d.one("> .topic-content"))},bindUI:function(){c.superclass.bindUI.call(this);this.get("topic").after("destroy",this.destroy,this);this.after(["editingChange","editingModeChange"],this.syncUI,this);this._contentField.on("contentCleared",function(){this._set("editingMode",d.EMPTY)},this);this._bindTitleField();this._bindEditButton();this._bindRemoveButton();this._bindLabelField();this._bindTopicChildControls()},syncUI:function(){c.superclass.syncUI.call(this);this._toggleEditingModeClasses();
this.get("editing")?this._setEditingState():this._setClosedState()},openEdit:function(){this._set("editing",!0)},closeEdit:function(){this._set("editing",!1)},focusAndSelect:function(){var b=this._titleField;b.focus();b.select()},_bindTitleField:function(){var b=this._titleField,c=this.get("topic");b.after("dataChange",function(b){c.set("title",b.newVal)},this);b._textField.on("key",function(){this.fire("titleFieldEnter")},"down:13",this)},_bindEditButton:function(){this._editButton.on("click",function(){this.get("animating")||
(this.get("editing")?this.closeEdit():this.openEdit())},this)},_bindRemoveButton:function(){this.get("contentBox").one("> .topic-control-bar .topic-controls > .remove-topic").on("click",function(b){b.halt();this.fire("removeClicked")},this)},_bindLabelField:function(){var b=this.get("topic");this._labelField.after("dataChange",function(c){b.set("label",c.newVal)})},_bindTopicChildControls:function(){var b=this._topicChildrenNode,c=this.get("topic").get("subTopics");b.one("> .topic-child-controls > .topic-child-control-wrapper > .add-sub-topics").on("click",
this._initializeSubTopics,this);b.one("> .topic-child-controls > .topic-child-control-wrapper > .add-content").on("click",this._initializeRelatedContent,this);this._registerEvent(c.after("remove",function(){c.isEmpty()&&this._set("editingMode",d.EMPTY)},this))},_setEditingState:function(){this._editButton.setContent(this.get("strings.doneText"));var b=this._topicChildrenNode,c=this.get("editingMode")===d.CONTENT,g=this._contentField;b.hasClass("expandable-hidden")?(b.once("opened",function(){this._set("animating",
!1);c&&g.focus()},this),this._set("animating",!0),b.show()):c&&g.focus()},_setClosedState:function(){this._editButton.setContent(this.get("strings.editText"));var b=this._topicChildrenNode;b.hasClass("expandable-hidden")||(b.once("closed",function(){this._subTopicsField.closeChildren();this._contentField.clear();this._set("animating",!1)},this),this._set("animating",!0),b.hide())},_toggleEditingModeClasses:function(){var b=this.get("contentBox");switch(this.get("editingMode")){case d.EMPTY:b.removeClass("editing-mode-sub-topics");
b.removeClass("editing-mode-content");b.addClass("editing-mode-empty");break;case d.SUB_TOPICS:b.removeClass("editing-mode-empty");b.removeClass("editing-mode-content");b.addClass("editing-mode-sub-topics");break;case d.CONTENT:b.removeClass("editing-mode-empty"),b.removeClass("editing-mode-sub-topics"),b.addClass("editing-mode-content")}},_initializeSubTopics:function(){var c=this.get("topic").get("subTopics");this._set("editingMode",d.SUB_TOPICS);c.add(new b.Squarespace.Models.FormPreSubmitTopic({title:"New Subtopic"}))},
_initializeRelatedContent:function(){this._set("editingMode",d.CONTENT)}},{CSS_PREFIX:"sqs-form-pre-submit-topic",HANDLEBARS_TEMPLATE:"form-pre-submit-topic.html",ATTRS:{strings:{getter:function(){return{editText:this.get("isSubTopic")?"+ Content":"Edit",doneText:"Done"}}},topic:{valueFn:function(){return new b.Squarespace.Models.FormPreSubmitTopic},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.FormPreSubmitTopic),writeOnce:"initOnly"},editing:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,
readOnly:!0},editingMode:{valueFn:function(){var b=this.get("topic");return this.get("isSubTopic")?d.CONTENT:b.get("subTopics").isEmpty()?b.get("relatedContentItems").isEmpty()?d.EMPTY:d.CONTENT:d.SUB_TOPICS},validator:function(c){if(b.Object.hasValue(d,c))return!0;console.error("FormPreSubmitTopic: Invalid editingMode. Must be a value in the EDITING_MODES enum.");return!1},readOnly:!0},isSubTopic:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},animating:{value:!1,
validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0}}})},"1.0",{requires:"base widget-child squarespace-animations squarespace-attr-validators squarespace-content-item-types-enum-record-type squarespace-dialog-auto-complete squarespace-dialog-content-item-list-builder squarespace-dialog-pre-submit-builder squarespace-dialog-text squarespace-enum squarespace-form-pre-submit-topic-template squarespace-models-content-item-list squarespace-models-form-pre-submit-topic squarespace-ss-widget".split(" ")});
YUI.add("squarespace-social-share-toggle-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["social-share-toggle.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+('<div class="activated">\n  <div class="title">'+b((l=(l=c.strings,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'</div>\n  <div class="icon"></div>\n</div>\n<div class="deactivated">\n  <div class="title">'+
b((l=(l=c.strings,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'</div>\n  <div class="icon"></div>\n</div>\n')})})();b.Handlebars.registerPartial("social-share-toggle.html".replace("/","."),d.templates["social-share-toggle.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-contribution-summary-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-contribution-summary.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e="\n    ";(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===u?f.apply(b):f);e+=v(f)+"<br />\n    ";(f=d.email)?f=f.call(b,{hash:{},data:c}):(f=b.email,f=typeof f===u?f.apply(b):f);e+=v(f)+"<br />\n    ";if((f=d["with"].call(b,b.address,{hash:{},inverse:w.noop,
fn:w.program(3,p,c),data:c}))||0===f)e+=f;e+="\n\n    ";if((f=d["if"].call(b,b.phone,{hash:{},inverse:w.noop,fn:w.program(6,r,c),data:c}))||0===f)e+=f;return e+"\n\n  "}function p(b,c){var e,f;e="\n      ";(f=d.address1)?f=f.call(b,{hash:{},data:c}):(f=b.address1,f=typeof f===u?f.apply(b):f);e+=v(f)+"<br />\n      ";if((f=d["if"].call(b,b.address2,{hash:{},inverse:w.noop,fn:w.program(4,q,c),data:c}))||0===f)e+=f;e+="\n      ";(f=d.city)?f=f.call(b,{hash:{},data:c}):(f=b.city,f=typeof f===u?f.apply(b):
f);e+=v(f)+", ";(f=d.state)?f=f.call(b,{hash:{},data:c}):(f=b.state,f=typeof f===u?f.apply(b):f);e+=v(f)+", ";(f=d.zip)?f=f.call(b,{hash:{},data:c}):(f=b.zip,f=typeof f===u?f.apply(b):f);e+=v(f)+"<br />\n      ";(f=d.country)?f=f.call(b,{hash:{},data:c}):(f=b.country,f=typeof f===u?f.apply(b):f);return e+=v(f)+"<br />\n    "}function q(b,c){var e,f;e="\n        ";(f=d.address2)?f=f.call(b,{hash:{},data:c}):(f=b.address2,f=typeof f===u?f.apply(b):f);return e+=v(f)+"<br />\n      "}function r(b,c){var e,
f;e="\n      ";(f=d.phone)?f=f.call(b,{hash:{},data:c}):(f=b.phone,f=typeof f===u?f.apply(b):f);return e+=v(f)+"\n    "}function s(b,c){var e,f;e='\n    <div class="title">Additional Information</div>\n    <div class="content">\n      ';if((f=d.each.call(b,b.resolvedFormSubmission,{hash:{},inverse:w.noop,fn:w.program(9,t,c),data:c}))||0===f)e+=f;return e+"\n    </div>\n  "}function t(b,c){var e,f;e="\n      <div><b>";(f=d.rawTitle)?f=f.call(b,{hash:{},data:c}):(f=b.rawTitle,f=typeof f===u?f.apply(b):
f);e+=v(f)+"</b>: ";(f=d.value)?f=f.call(b,{hash:{},data:c}):(f=b.value,f=typeof f===u?f.apply(b):f);return e+=v(f)+"</div>\n      "}this.compilerInfo=[2,">= 1.0.0-rc.3"];d=d||b.helpers;k=k||{};var u="function",v=this.escapeExpression,w=this;b='<div class="dialog-contribution-summary">\n';if((c=d["with"].call(c,c.data,{hash:{},inverse:w.noop,fn:w.program(1,function(b,c){var e,f;e="\n\n  <h2>Contribution to ";(f=d.donationTitle)?f=f.call(b,{hash:{},data:c}):(f=b.donationTitle,f=typeof f===u?f.apply(b):
f);e+=v(f)+'</h2>\n  <br />\n  <br />\n  <div class="title">Amount</div>\n  <div class="content contribution-amount"></div>\n\n  <br />\n\n  <div class="title">Donor</div>\n  <div class="content">\n  ';if((f=d["with"].call(b,b.donor,{hash:{},inverse:w.noop,fn:w.program(2,l,c),data:c}))||0===f)e+=f;e+="\n  </div>\n\n  <br />\n\n  ";if((f=d["if"].call(b,b.resolvedFormSubmission,{hash:{},inverse:w.noop,fn:w.program(8,s,c),data:c}))||0===f)e+=f;return e+"\n\n"},k),data:k}))||0===c)b+=c;return b+"\n</div>"})})();
b.Handlebars.registerPartial("dialog-contribution-summary.html".replace("/","."),d.templates["dialog-contribution-summary.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-range-table",function(b){b.namespace("Squarespace");var d={from:0,to:1,priceCents:150};b.Squarespace.DialogFields.RangeTable=b.Base.create("rangeTable",b.Squarespace.DialogField2,[],{initializer:function(c){this.set("strings.title",c.title);this.set("strings.description",c.description);this.set("strings.dimensionLabel","Weight ("+(Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.measurementStandard===b.Squarespace.MeasurementStandard.IMPERIAL?"lbs":"kg")+")")},
renderUI:function(){b.Squarespace.DialogFields.RangeTable.superclass.renderUI.call(this);this.get("contentBox")},bindUI:function(){b.Squarespace.DialogFields.RangeTable.superclass.bindUI.call(this);var c=this.get("contentBox");this.subscribe("dataChanged",b.bind(this._handleChange,this));c.delegate("change",b.bind(function(){this.fire("dataChanged")},this),"input.toValue");c.delegate("valuechange",b.bind(function(){this.fire("dataChanged")},this),"input.rangeValue");c.delegate("click",b.bind(this._insertNewRangeRow,
this),".add-row");c.delegate("click",b.bind(function(b){this._removeRangeRow(b);this.fire("dataChanged")},this),".remove-row")},syncUI:function(){this.get("data")?this._populateTable(this.get("data")):this._populateTable();this.fire("dataChanged")},_populateTable:function(c){if(void 0===c)this._addLastRangeRow({}),this._addRangeRow(d);else{this._addLastRangeRow(c[c.length-1]);for(var e=0;e<c.length-1;e++)this._addRangeRow(c[e])}c=this.get("contentBox");c.all('input[name="toWeight"]').plug(b.Squarespace.Plugin.NumericFormatter);
c.all('input[name="priceCents"]').plug(b.Squarespace.Plugin.MoneyFormatter)},_handleChange:function(){this._autocorrect();var b=JSON.parse(this.getValue()),b=this._propagateUpdates(b);this._updateInputs(b)},_autocorrect:function(){this.get("contentBox").all("input.toValue").each(function(){b.Squarespace.InputUtils.correctNumericField(this)})},_updateInputs:function(c){for(var e=this.get("contentBox").all(".range-row"),d=0;d<c.length;d++){var g=e.item(d),h=c[d];g.one(".fromValue").setContent(h.from.toFixed(2));
g.one(".toValue").set("value",h.to.toFixed(2));b.Lang.isValue(g.one(".toValue").numericFormatterPlugin)&&g.one(".toValue").numericFormatterPlugin.set("data",h.to);g.one(".rangeValue").set("data",h.priceCents)}},_removeRangeRow:function(b){var e=b.currentTarget.ancestor(".range-row");if(this.get("contentBox").all(".range-row").item(0)==e)throw"Should not be able to delete this row.";e.remove();b.stopPropagation()},_insertNewRangeRow:function(){var b=JSON.parse(this.getValue()),e=b[b.length-2].to+0.01;
this._addRangeRow({from:e,to:Math.floor(e+1),priceCents:b[b.length-2].priceCents});this.fire("dataChanged");this.get("contentBox").one(".add-row").scrollIntoView()},_addRangeRow:function(c){var e=this.get("contentBox"),d=this.get("strings.weightUnit");c.weightUnit=d;c=b.Node.create(b.Handlebars.render(this.getProperty("ROW_TEMPLATE"),c));c.one('input[name="toWeight"]').plug(b.Squarespace.Plugin.NumericFormatter,{displayFormatter:function(b){return b.toFixed(2)}});c.one('input[name="priceCents"]').plug(b.Squarespace.Plugin.MoneyFormatter);
e.one("tbody .range-row-last").insert(c,"before")},_addLastRangeRow:function(c){var e=this.get("contentBox");c.weightUnit=this.get("strings.weightUnit");c=b.Node.create(b.Handlebars.render(this.getProperty("LAST_ROW_TEMPLATE"),c));c.one('input[name="priceCents"]').plug(b.Squarespace.Plugin.MoneyFormatter);e.one("tbody").append(c)},_propagateUpdates:function(b){var e=function(b,c){var d;if(0!==b.length){if(void 0===c)return d=b[0],d.to<=d.from&&(d.to=d.from+0.01),e(b.slice(1),b[0]);d=b[0];d.from!=
c.to+0.01&&(d.from=c.to+0.01);d.to<=d.from&&(d.to=Math.floor(d.from+1));return e(b.slice(1),d)}};e(b);return b},getValue:function(){var c=[];this.get("contentBox").one("tbody").all(".range-row").each(b.bind(function(b){var d;d=b.hasClass("range-row-last")?Number(b.one(".toValue").get("value")):b.one('input[name="toWeight"]').numericFormatterPlugin.get("data");c.push({from:Number(b.one(".fromValue").get("text")),to:d,priceCents:b.one('input[name="priceCents"]').moneyFormatterPlugin.get("data")})},
this));return JSON.stringify(c)}},{CSS_PREFIX:"sqs-range-table",HANDLEBARS_TEMPLATE:"dialog-range-table.html",ROW_TEMPLATE:'<tr class="range-row"><td><span class="fromValue">{{from}}</span>&nbsp;to&nbsp;<input name="toWeight" type="text" class="toValue" value="{{to}}" /></td><td><input type="text" class="rangeValue" name="priceCents" value="{{priceCents}}" /></td><td class="remove"><div class="remove-row"></div></td></tr>',LAST_ROW_TEMPLATE:'<tr class="range-row range-row-last"><td><span class="fromValue">{{from}}</span>&nbsp;to&nbsp;<span class="toValue infinite">\u221e</span></td><td><input type="text" class="rangeValue" name="priceCents" value="{{priceCents}}" /></td></tr>',
ATTRS:{strings:{value:{}}}})},"1.0",{requires:"base json squarespace-animations squarespace-input-utils squarespace-dialog-field-2 squarespace-dialog-range-table-template squarespace-plugin-money-formatter squarespace-plugin-numeric-formatter".split(" ")});
YUI.add("squarespace-block-twitter",function(b){var d=b.namespace("Squarespace.Block").Twitter=b.Base.create("block-twitter",b.Squarespace.Block.SocialSummaryBase,[],{_renderSuccess:function(c){d.superclass._renderSuccess.call(this,c);c&&b.Squarespace.FollowButtonUtils.renderAll()},_getDefaultContent:function(){var c=d.superclass._getDefaultContent.call(this);return b.merge(c,{showAvatar:!0,showUsername:!0,followButton:!1})}},{CSS_PREFIX:"sqs-block-twitter",MODEL:b.Squarespace.ContentModel.TwitterBlock,
ATTRS:{editor:{value:b.Squarespace.Block.Editor.Twitter},type:{value:b.Squarespace.BlockType.TWITTER}}})},"1.0",{requires:"base squarespace-enum squarespace-follow-buttons squarespace-block-social-summary squarespace-block-twitter-editor squarespace-block-twitter-model".split(" ")});
YUI.add("squarespace-settings-activity-referrers",function(b){b.namespace("Squarespace.Settings.Activity");b.Squarespace.Settings.Activity.Referrers=b.Base.create("ActivityManagerReferrers",b.Squarespace.Settings.Activity.BaseManager,[b.Squarespace.Settings.Activity.MixinSpinnerfied,b.Squarespace.Settings.Activity.MixinAccordion],{_isDataEmpty:function(d){return!b.Lang.isArray(d.summaries)||0===d.summaries.length},_renderSuccess:function(b){this.renderChartAccordionPanel(b,{panelTitle:"Referrers",
countTitle:"Count",countAttr:"count",descriptionTitle:"Referrer",descriptionAttr:"domain",subCountAttr:"count",subDescriptionAttr:"path",chartFn:this.renderReferrersChart})},renderReferrersChart:function(d,c){this.renderStandardPieChart(d.summaries,c,b.bind(function(b){return b.domain},this))}},{CSS_PREFIX:"sqs-activity-manager-referrers",ATTRS:{activeTab:{value:"week"},strings:{value:{title:"Referrers"}},tabs:{value:[{key:"1day",label:"1 Day"},{key:"2days",label:"2 Days"},{key:"3days",label:"3 Days"},
{key:"week",label:"Week"},{key:"month",label:"Month"}]},requestParams:{getter:function(){return{name:"referrer",numberOfDays:this._periodToDays(this.get("activeTab")),verbose:!1}}}}})},"1.0",{requires:["base","squarespace-settings-activity-base-manager","squarespace-settings-activity-mixin-accordion","squarespace-settings-activity-mixin-spinnerfied"]});
YUI.add("squarespace-dialog-business-hours",function(b){var d=b.namespace("Squarespace.DialogFields").BusinessHours=b.Base.create("businessHoursDialog",b.Squarespace.DialogField2,[],{initializer:function(){this._inputs=[]},renderUI:function(){d.superclass.renderUI.call(this);this._renderDays()},bindUI:function(){d.superclass.bindUI.call(this);b.Array.each(this._inputs,function(b){b.after("multipleTimeRangeChange",this._updateData,this)},this)},_getErrors:function(){var c=[];b.Array.some(this._inputs,
function(b){c=b.get("errors");if(0<c.length)return this.showError(c[0]),!0},this);return c},_updateData:function(c){var e=c.target;c=e.get("name");var d=this.get("data"),e=e.get("multipleTimeRange");b.Lang.isNull(d)&&(d={});e&&!e.text?delete d[c]:d[c]=e;this.set("data",d)},_renderDays:function(){var c=this.get("strings.days"),e=this.get("data"),d,g;b.Object.each(c,function(c,k){d=b.Object.getValue(e,[k,"text"]);g=new b.Squarespace.DialogFields.TimeRange({name:k,data:d,className:"thin","strings.label":c});
this.add(g);this._inputs.push(g)},this)}},{CSS_PREFIX:"sqs-dialog-business-hours",ATTRS:{data:{value:null},strings:{value:{days:b.Squarespace.DateUtils.LANG.days.full}}}})},"1.0",{requires:["base","node","squarespace-date-utils","squarespace-dialog-field-2","squarespace-dialog-time-range"]});
YUI.add("squarespace-block-soundcloud-editor",function(b){b.namespace("Squarespace.Block.Editor").SoundCloud=b.Base.create("soundcloud-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.SoundCloud")}},{NS:"blockEditor",ATTRS:{blockName:{value:"SoundCloud"},resizable:{value:!0},resizeNode:{valueFn:function(){return this.get("host").get("boundingBox")}}}});b.namespace("Squarespace.Block.ModelEditorDialog").SoundCloud=
b.Base.create("blockSoundCloudEditor",b.Squarespace.ModelEditorDialog,[],{getDialogData:function(){return{embed:this.get("model").toJSON()}},sanitizeDialogData:function(c){return b.merge(c.embed,{showArtwork:c.showArtwork,useVisualPlayer:c.useVisualPlayer})}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:470,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit SoundCloud Embed",icon:"/universal/images-v6/icons/skelecon-soundcloud-16-light.png",
scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.Oembed,name:"embed",config:{"strings.description":"<strong>Paste the URL</strong> of the SoundCloud set or track you'd like to embed, and Squarespace will attempt to locate content at this URL and format it for your site.","strings.inputPlaceholder":"Enter a SoundCloud URL here"}}]}]}},"1.0",{requires:["base","squarespace-block-editor-dialog","squarespace-damask-context-globals","squarespace-dialog-oembed","squarespace-model-editor"]});
YUI.add("squarespace-newsletters-manager",function(b){b.namespace("Squarespace").NewslettersManager=Class.extend(b.Squarespace.PanelManager,{initialize:function(){b.Squarespace.NewslettersGroupsList=new b.Squarespace.Models.SiteUserGroupList;b.Squarespace.NewslettersGroupsList.load();this.superclass.initialize.apply(this,arguments)},getTitle:function(){return"Newsletters"},getDescription:function(){return"This area allows you to compose and manage your newsletters."},getName:function(){return"newsletters"},
getMenuItems:function(){return[{name:"getting-started",title:"Getting Started",hidden:Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted&&Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["newsletters-tutorial-checklist"],ctor:b.Squarespace.Widgets.NewslettersTutorialPanel,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_NEWSLETTER_WRITE_SETTINGS},{name:"newsletters-messages",title:"Messages",ctor:b.Squarespace.Widgets.NewslettersMessagesManager,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_NEWSLETTER_READ_MESSAGE},
{name:"subscribers-list",title:"Subscribers",ctor:b.Squarespace.Widgets.NewslettersSubscribersListsManager,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_NEWSLETTER_READ_SUBSCRIBER},{name:"newsletters-settings",title:"Settings",ctor:b.Squarespace.Widgets.NewslettersSettingsPanel,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_NEWSLETTER_WRITE_SETTINGS}]}});b.namespace("Squarespace.ConfigurationPanelRenderers").newsletters=b.Squarespace.NewslettersManager},"1.0",{requires:"node oop anim json squarespace-dombuilder squarespace-panel-manager squarespace-newsletters-tutorial-panel squarespace-settings-newsletters-messages squarespace-settings-newsletters-settings squarespace-widgets-newsletters-subscribers-list-manager squarespace-models-site-user-group-list squarespace-models-site-user-group squarespace-models-site-user-list squarespace-models-site-user squarespace-newsletters-message".split(" ")});
YUI.add("squarespace-models-billing-contact-list",function(b){b.namespace("Squarespace.Models.Billing");b.Squarespace.Models.Billing.ContactList=b.Base.create("billingContactList",b.ModelList,[],{model:b.Squarespace.Models.Billing.Contact})},"1.0",{requires:["base","model-list","squarespace-models-billing-contact"]});
YUI.add("squarespace-help-videos",function(b){b.namespace("Squarespace").HelpVideos=[{title:"Welcome to Squarespace",shortTitle:"Welcome",id:"je86uvu37s",description:"Learn about the basics of managing a website using Squarespace 6 - creating a page, setting your site name and logo, adding content, and changing your site's style.",duration:"2:31"},{title:"Blogging System",shortTitle:"Blogging",id:"5ubthoqlu5",description:"Learn about the basics of managing a website using Squarespace 6 - creating a page, setting your site name and logo, adding content, and changing your site's style.",
duration:"1:40"},{title:"LayoutEngine Page Creation",shortTitle:"Layout Engine",description:"Only Squarespace comes with a completely custom page builder, letting you create complex, grid-based page layouts with columns, mixed media and more.",id:"4x96kf18u3",duration:"1:44"},{title:"Image Galleries",shortTitle:"Adding A Gallery",description:"This video shows how to manage a gallery of images on Squarespace 6. From creating a gallery, uploading images, arranging and deleting images, to viewing your created gallery.",
id:"sqftxada2u",duration:"0:49"}]},"1.0",{});YUI.add("squarespace-block-spacer-editor",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.Spacer=b.Base.create("blockSpacerEditor",b.Squarespace.Block.Editor.Base,[],{},{NS:"blockEditor",ATTRS:{resizable:{value:!0},resizeNode:{valueFn:function(){return this.get("host").get("boundingBox")}}}})},"1.0",{requires:["base","squarespace-block-plugin-resizable","squarespace-block-editor-base"]});
YUI.add("squarespace-content-item-types-event",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.Event=b.Base.create("EventContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{initializer:function(){var b=this.get("dialog");b.on("ready",function(){b.getField("startDate").after("dataChange",this._adjustEndDate,this)},this)},getDialogData:function(){var b=d.superclass.getDialogData.call(this),e=b.structuredContent;b.startDate=e.startDate;b.endDate=
e.endDate;return b},sanitizeDialogData:function(b){b=d.superclass.sanitizeDialogData.call(this,b);b.structuredContent={startDate:b.startDate,endDate:b.endDate};return b},_adjustEndDate:function(b){var e=this.get("dialog").getField("endDate"),d=parseInt(b.prevVal,10);b=parseInt(b.newVal,10);d=e.get("data")-d;e.set("data",(new Date(b+d)).getTime(),{autoUpdate:!0})},_getTemplateContext:function(){var b=d.superclass._getTemplateContext.call(this);b.enableFeatured=!0;b.enableExcerpt=!0;return b}},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",
width:720,name:"event-post-editor",verticalHeight:"full",overlay:0.5,initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.event"]},{$include:"tabs.options.default"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-dialog-google-docs-service-connect",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.GoogleDocsServiceConnect=b.Base.create("googleDocsServiceConnect",b.Squarespace.DialogFields.OauthServiceConnect,[],{initializer:function(){this.get("contentBox").addClass("sqs-oauth-service-connect-content");this._spreadsheetField=new b.Squarespace.DialogFields.Text({name:"spreadsheet",className:"thin","strings.title":"Spreadsheet Name",data:this.get("data.spreadsheetName")})},
renderUI:function(){d.superclass.renderUI.call(this);var b=this._spreadsheetField;b.render(this.get("contentBox").one(".fields"));this._spreadsheetFieldInput=b.get("contentBox").one("input")},bindUI:function(){d.superclass.bindUI.call(this);this._spreadsheetField.after("dataChange",function(b){var e=this.get("data")||{};e.spreadsheetName=b.newVal;this.set("data",e)},this)},_getErrors:function(){var c=[],e=this.get("data.spreadsheetName");if(this.get("data.connected")&&(!b.Lang.isValue(e)||""===e))this._set("errorFlyoutAnchor",
this._spreadsheetField.get("contentBox").one("input")),c.push("Spreadsheet Name required.");return c},_completeAuthentication:function(){var c=this._spreadsheetField,e=c.get("data");(!b.Lang.isValue(e)||""===e)&&c.set("data",this.get("getSpreadsheetName")());this.set("connectionInProgress",!1)},_getConnectedMessageUsername:function(){return this.get("data.username")}},{CSS_PREFIX:"sqs-google-docs-service-connect",ATTRS:{serviceProvider:{value:b.Squarespace.ExternalServiceProviders.GOOGLEDOCS2},formStorageBackendType:{value:b.Squarespace.FormStorageBackendType.GOOGLE},
strings:{value:{title:"Google Docs",connectedMessage:"As"}},getSpreadsheetName:{value:function(){return"New Spreadsheet"}}}})},"1.0",{requires:["base","squarespace-enum","squarespace-dialog-oauth-service-connect","squarespace-dialog-text"]});
YUI.add("squarespace-dialog-auto-complete",function(b){var d=b.Squarespace.DialogFields.AutoComplete=b.Base.create("AutoComplete",b.Squarespace.DialogFields.Text,[],{destructor:function(){var b=this.get("acWidget");b&&b.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox");new b.Squarespace.Spinner({color:"dark",render:c});c=new b.Squarespace.Widgets.ScrollingAutoCompleteList(b.merge({inputNode:this._textField},this.get("acConfig")));this._set("acWidget",c);
c.render()},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox"),e=this.get("acWidget");e.on("query",function(){b.addClass("querying")},this);e.on("results",function(){b.removeClass("querying")},this);this.get("requireListEntry")&&e.after("select",this._afterSelect,this)},syncUI:function(){d.superclass.syncUI.call(this);this._textField.set("value",this.get("data"))},focus:function(){this._textField.focus()},clear:function(){this.set("data",null);this._textField.set("value",
"");this.get("acWidget")._onInputValueChange({newVal:""})},_afterSelect:function(c){c=c.result.raw;var e=this.get("responseDataProperty");b.Lang.isValue(e)?(this.set("data",c[e]),this._set("dataObject",c)):this.set("data",c);this.fire("select",{data:this.get("data")})},_afterDataChange:noop,_afterValueChange:function(b){this.get("requireListEntry")||d.superclass._afterValueChange.call(this,b)},_afterBlur:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.set("allowContextMenu",!1)}},{CSS_PREFIX:"sqs-auto-complete",
ATTRS:{data:{value:null,validator:function(b){return!0}},acConfig:{value:null,setter:function(c){if(!b.Lang.isValue(c.source))throw"No data source provided for AutoComplete";return b.merge({activateFirstItem:!0,resultHighlighter:"phraseMatch"},c)},validator:b.Squarespace.AttrValidators.isNullOrObject,writeOnce:"initOnly"},acWidget:{value:null,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Widgets.ScrollingAutoCompleteList),readOnly:!0,writeOnce:!0},requireListEntry:{value:!1,
validator:b.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},responseDataProperty:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},dataObject:{value:null,validator:b.Squarespace.AttrValidators.isNullOrObject,readOnly:!0}}})},"1.0",{requires:["base","squarespace-dialog-text","squarespace-spinner","squarespace-scrolling-auto-complete-list","squarespace-attr-validators"]});
YUI.add("squarespace-object-builder",function(b){function d(){var c=Array.prototype.slice.call(arguments),e=c.shift(),d=c[c.length-1],f="prependArrays"==d;"prependArrays"==d||"appendArrays"==d?c.pop():d=null;for(var g=0,r=c.length;g<r;g++)if(c[g])for(var s in c[g])d&&c[g][s]&&b.Lang.isArray(c[g][s])?e[s]=(f?c[g][s]:e[s]||[]).concat((f?e[s]:c[g][s])||[]):e[s]=c[g][s];return e}function c(b,e){for(var d in b)if(Object.prototype.hasOwnProperty.call(b,d)){for(var f=b[d],g=0;g<e.length;g++){if("undefined"===
typeof e[g].test||e[g].test(b[d],d,b))e[g].each&&e[g].each(b[d],d,b),e[g].map&&(b[d]=e[g].map(b[d],d,b));if("undefined"===typeof b[d])break}null!==b[d]&&("object"===typeof b[d]&&!f.$dontRecurse)&&c(b[d],e);if(b[d]instanceof Array)for(f=0;f<e.length;f++)if("undefined"===typeof e[f].postTest||e[f].postTest(b[d]))e[f].post&&(b[d]=e[f].post(b[d],d,b))}return b}function e(e,f,g){var p={include:{test:function(b){return b&&b.$include},map:function(c){var e,f=c.$include;!b.Lang.isArray(f)&&!b.Lang.isObject(f[0])&&
(f=[f]);for(var h=0,k=f.length;h<k;h++){var p=f[h],w;if("string"===typeof p){var y=p.split(".");w=g;for(var z=0,B=y.length;z<B;z++)if(w[y[z]])w=b.clone(w[y[z]]);else throw"Bad path `"+p+"`: `"+y[z]+"` not found.";}else{if("object"===typeof p)for(var A in p)if("string"==typeof A&&-1!==A.indexOf(".")){y=A.split(".");for(z=w;0!==y.length;)if(B=y.shift(),0===y.length){z[B]=p[A];break}else{var K=[B].concat(y).join(".");z.hasOwnProperty(K)?y=[K]:(z.hasOwnProperty(B)||(z[B]={}),z=z[B])}delete p[A]}w=p}e=
d(e||(b.Lang.isArray(w)?[]:{}),w,"prependArrays")}c.$update&&(e.$update=c.$update);c.$concat&&(e.$concat=c.$concat);c.$when&&(e.$when=c.$when);return e}},update:{test:function(b){return b&&b.$update},each:function(e){function d(b,c){return function(e,d){return d===b&&e===c}}function f(c){return function(e,d,f){b.mix(f,c,!0)}}var g=[],h=e.$update;delete e.$update;for(var k in h)"."==k[0]?g.push({test:d("name",k.slice(1)),each:f(h[k])}):g.push({test:d("type",k),each:f(h[k])});return c(e,g)}},when:{test:function(b){return b&&
b.$when},map:function(c){if(b.Lang.isFunction(c.$when)&&c.$when(g)){if(c.$value)return c.$value;delete c.$when;return c}}},value:{test:function(b){return b&&b.$value},map:function(b){return g[b.$value]}},valueFn:{test:function(b){return b&&b.$valueFn},map:function(b){return b.$valueFn(g)}},template:{test:function(c,e,d){return b.Squarespace.StringTemplate&&"string"===typeof c&&!d.$escape},map:function(c){return b.Squarespace.StringTemplate.template(c,g)}},concat:{postTest:function(b){var c=!1;if(b&&
b instanceof Array)for(var e=0;e<b.length;e++)b[e]&&(b[e]instanceof Array&&b[e].$concat)&&(c=c||b[e].$concat);return c},post:function(b,c,e){c=[];for(e=0;e<b.length;e++)b[e]&&b[e]instanceof Array&&b[e].$concat?c=c.concat(b[e]):c.push(b[e]);return c}},trim:{postTest:function(c){return b.Lang.isArray(c)},post:function(c,e,d){e=c.filter(function(c){return!b.Lang.isUndefined(c)});c.$concat&&(e.$concat=c.$concat);return e}}};return c(b.merge(f),e.map(function(b){return p[b]}))}var f=b.namespace("Squarespace.StringTemplate");
f.filters={lower:function(b){return(b||"").toLowerCase()},capitalize:function(b){return 1>=b.length?b:b.charAt(0).toUpperCase()+b.slice(1)}};f.template=function(c,e,d){d=b.merge(f.filters,d);return c.replace(/\{(\s*)([^\s|]+)((?:\|[^}]+)?)(\s*)\}/g,function(b,c,f,g,h){var u=e[f],v=!1;"undefined"==typeof u&&(v=!0);if(g){g=g.split("|").filter(function(b){return b});for(var w=0,y=g.length;w<y;w++){var z=g[w].split(/[:,\s]+/g),B=z.shift();if(B)if(d[B])u=d[B](u,z,e);else if("'"==B[0]&&"'"===B[B.length-
1]||'"'==B[9]&&'"'===B[B.length-1])u||(u=B.slice(1,-1));else throw"Unknown filter: `"+B+'` in "'+b+'"';}}v&&!u&&console.warn("Template var `"+f+'` not found in context. String: "'+b+'" Context:',e);return c+(u||"")+h})};var g=b.namespace("Squarespace.ObjectBuilder");g.operations="include update when value template concat trim".split(" ");g.walkObject=c;g.build=e;g.make=function(b,c,d){b=e(["include","update"],b,c);return b=e("when value valueFn template concat trim".split(" "),b,d)}},"1.0",{requires:["oop"]});
YUI.add("squarespace-dialog-smugmug-sync-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-smugmug-sync.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n    <div class="error-message">';(f=d.error)?f=f.call(b,{hash:{},data:c}):(f=b.error,f=typeof f===u?f.apply(b):f);return e+=v(f)+"</div>\n  "}function p(b,c){var e,f;e="\n    ";if((f=d["if"].call(b,b.data,{hash:{},inverse:w.program(10,s,c),fn:w.program(7,q,c),data:c}))||0===f)e+=f;
return e+"\n  "}function q(b,c){var e,f;e='\n      <div class="control-col">\n        <div class="collection-group-title">Albums</div>\n        <ul class="albums">\n          ';if((f=d.each.call(b,b.data,{hash:{},inverse:w.noop,fn:w.program(8,r,c),data:c}))||0===f)e+=f;return e+"\n        </ul>\n      </div>\n    "}function r(b,c){var e,f;e='\n            <li class="collection-wrapper album picker-btn" data-albumID=';(f=d.albumID)?f=f.call(b,{hash:{},data:c}):(f=b.albumID,f=typeof f===u?f.apply(b):
f);e+=v(f)+'>\n              <div class="collection collection-icon-gallery">\n                <div class="collection-title">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=typeof f===u?f.apply(b):f);return e+=v(f)+"</div>\n              </div>\n            </li>\n          "}function s(b,c){return'\n      <div class="empty-warning">No albums found.  Add some albums <a href="http://smugmug.com/" target="new">SmugMug</a> to sync them with your Squarespace site.</div>\n    '}this.compilerInfo=
[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var t,u="function",v=this.escapeExpression,w=this;if((c=d["if"].call(c,(t=c.state,null==t||!1===t?t:t.loading),{hash:{},inverse:w.program(3,function(b,c){var e,f;e="\n  ";if((f=d["if"].call(b,b.error,{hash:{},inverse:w.program(6,p,c),fn:w.program(4,l,c),data:c}))||0===f)e+=f;return e+"\n"},k),fn:w.program(1,function(b,c){return'\n  <div class="loading">\n    <div class="sqs-spin light large"></div>\n    <div class="message">Loading albums...</div></div>\n  </div>\n'},
k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("dialog-smugmug-sync.html".replace("/","."),d.templates["dialog-smugmug-sync.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-gallery",function(b){var d=b.namespace("Squarespace.Block").Gallery=b.Base.create("block-gallery",b.Squarespace.Block.ModelSyncBase,[b.Squarespace.Block.Mixin.AspectRatio],{bindUI:function(){this.get("model").after("change",this._afterModelChange,this);this.after("resized",this.syncUI,this);this.after("widgetContentChange",this._setWidgetContent,this)},_afterModelChange:function(b){this._renderBlock(b)},show:function(){d.superclass.show.call(this,arguments);this._setWidgetContent()},
_renderBlock:function(b){this.get("boundingBox").setData("block",this.get("model").getAttrs());this._shouldGetWidgetRendering(b)?(this.requestingContent=!0,d.superclass._renderBlock.call(this)):this.fire("widget:contentUpdate")},_renderSuccess:function(b){this.requestingContent=!1;this.set("widgetContent",b.html);this._setWidgetContent()},_setWidgetContent:function(){if(!this.requestingContent){var c=b.Node.create(this.get("widgetContent")),e=this.get("contentBox");e.setHTML(c);this.get("model").get("aspectRatio")&&
e.one(".sqs-state-message")&&e.one(".sqs-state-message").wrap("<div></div>");this._updateAspectRatio();b.Squarespace.GalleryManager.initializeBlock(e)}},_shouldGetWidgetRendering:function(c){return!b.Lang.isValue(c)||!b.Object.hasKey(c,"changed")?!0:!b.Squarespace.Block.Utils.checkWhitelist(this.get("modelWhiteList"),c.changed)}},{ATTRS:{editor:{value:b.Squarespace.Block.Editor.Gallery},modelWhiteList:{setter:function(c){return b.Lang.isArray(c)?c:b.Lang.isString(c)?[c]:[]},value:"padding methodOption transientGallery autoplay lightbox vSize aspectRatio thumbnail-strip-height thumbnail-strip-margin".split(" ")},
type:{value:b.Squarespace.BlockType.GALLERY},vSize:{valueFn:function(){return"slider"===this.get("model").get("design")?10:null}},widgetContent:{value:""}},CSS_PREFIX:"sqs-block-gallery",MODEL:b.Squarespace.ContentModel.GalleryBlock})},"1.0",{requires:"base model squarespace-block-base-modelsync squarespace-block-gallery-editor squarespace-block-gallery-model squarespace-block-gallery-model-editor squarespace-block-mixin-aspect-ratio squarespace-block-utils squarespace-dialog-content-item-grid squarespace-dialog-content-selector squarespace-dialog-fields squarespace-dialog-gallery-options squarespace-dialog-multi-frame squarespace-dialog-multi-option squarespace-models-content-collection".split(" ")});
YUI.add("squarespace-settings-site-domains",function(b){var d=".com .org .net .biz .info .mobi".split(" "),c=b.namespace("Squarespace.Settings.Site").Domains=b.Base.create("newDomainsSettings",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){this.publish("domain-registration-success",{defaultFn:this._consumeDomainCredit})},hasUnsavedChanges:function(){return!1},_consumeDomainCredit:function(){this.get("siteContext").domainCredits&&this.get("siteContext").domainCredits--},_refundDomainCredit:function(){this.get("siteContext").domainCredits++;
this._renderButtons()},bindUI:function(){c.superclass.bindUI.call(this);this.on("fields-rendered",function(){var b=this.getField("domains");b.after("dataStateChange",function(c){c.newVal==b.getProperty("DATA_STATES").LOADED&&(this._endLoading(),b.on("domain-removed",function(b){b.domain.get("data.managed")&&this._refundDomainCredit()},this),b.checkDomainStatuses(),b.syncUI())},this);this._beginLoading()})},_beginLoading:function(){this.set("dataState",this.getProperty("DATA_STATES").LOADING)},_endLoading:function(){this.set("dataState",
this.getProperty("DATA_STATES").LOADED)},addItem:function(){this._headerTray.set("loading",!0);var c=b.bind(function(){this._headerTray.set("loading",!1)},this),d=b.bind(function(b){c();throw b;},this);b.Squarespace.Singletons.DomainLinker.link().then(b.bind(this.addNewDomain,this)).then(c,d).then(b.Squarespace.Fluent.Information({"strings.title":"Domain Linked","strings.message":"Domain sucessfully linked."}))},addNewDomain:function(c,d){var g=this.getField("domains"),h=g.addItem(b.merge(c,{primary:!1}));
g.syncUI();var k;g.each(function(b){b.get("data.name")===h.get("data.name")&&(k=b)});k&&k.get("dataState")!==this.getProperty("DATA_STATES").LOADING&&k.checkDomainStatus();return k},_showDomainRegisterUpgradeInfo:function(){(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not now","strings.confirm":"Upgrade","strings.title":"Upgrade Required","strings.message":"Please upgrade to a yearly Squarespace account to claim your free domain."})).on("confirm",function(){b.Squarespace.ACTIVE_MANAGER.getHistory().replace({module:"settings",
"settings-subpanelName":"billing-settings"})},this)},_transferV5Domain:function(){var e=new b.Squarespace.EditingDialog(c.TRANSFER_DOMAIN_DIALOG_CONFIG);e.on("send-requested",function(){e.getData();b.Data.sendForm(e,{url:"/api/domains/TransferV5Domain",success:function(c){c.domainError?(e.close(),new b.Squarespace.Widgets.Information({"strings.title":"Domain Transfer Failed","strings.message":"Domain transfer failed. Please try again or contact customer support."})):(this.addNewDomain(c.domain),e.close())}},
this)});e.show()},_transferDomain:function(){var c=new b.Squarespace.EditingDialog({overlay:0.5,width:300,height:120,name:"transfer-source",title:"Select Transfer Source",closeOthers:!1,tabs:[{icon:"/universal/images-v6/icons/icon-domains-18-light.png",fields:[{ctor:b.Squarespace.DialogFields.MultiOption,name:"source",config:{numeric:!1,className:"icon20 round",options:[{value:"external",title:"External",icon:"external-domain"},{value:"five",title:"V5",icon:"v5"}]}}]}]});c.show();var d=c.getField("source");
d.after("dataChange",function(b){c.close();b=d.get("data");this._initiateTransferWorkflow(b)},this)},_initiateTransferWorkflow:function(b){"five"===b?this._transferV5Domain():"external"===b&&this._transferExternalDomain()},_transferExternalDomain:function(){var e=new b.Squarespace.EditingDialog(c.TRANSFER_EXTERNAL_DOMAIN_DIALOG_CONFIG);e.on("send-requested",function(){b.Data.sendForm(e,{url:b.Squarespace.REST_API_ROOT+"domains/transfers",success:function(){var b=e.getData().domain;this.addNewDomain({name:b,
transferStatus:"pending-customer-approval"});e.close()}},this)},this);e.show()},_registerDomain:function(){var c,d=b.Squarespace.Singletons.DomainRegistrar.once("registration-start",function(b){c=this.addNewDomain({name:b.domain,dataState:"loading",managed:!0})},this);b.Squarespace.Singletons.DomainRegistrar.register().then(function(d){new b.Squarespace.Widgets.Information({"strings.title":"Domain Registered","strings.message":"Domain successfully registered."});c.set("data",d.domain);c.set("dataState",
"loaded");c.checkDomainStatus()},function(g){d.detach();b.Lang.isValue(c)&&c.destroy();b.Lang.isString(g.message)&&new b.Squarespace.Widgets.Alert({"strings.title":"Domain Registration Failed","strings.message":g.message})})},_findWidgetByName:function(b){return this.getField("domains").find(function(c){return c.get("data.name")===b})}},{CSS_PREFIX:"sqs-domain-settings",CONFIRM_DOMAIN_DIALOG_CONFIG:{name:"addDomain",style:"flyout",savingText:"Registering Domain...",overlay:0.5,width:370,closeOthers:!1,
discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Register"}],tabs:[{title:"Register Free",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{}},{ctor:b.Squarespace.DialogFields.HTML,config:{content:'<div class="domain-tos">By registering a domain through Squarespace, you are agreeing to the Squarespace <a href="http://www.squarespace.com/domains-tos/" target="new">Domains Terms of Service.</a></div>'}}]}]},
TRANSFER_EXTERNAL_DOMAIN_DIALOG_CONFIG:{name:"transferExtDomain",overlay:0.5,width:370,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Transfer"}],tabs:[{title:"Transfer External Domain",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.SuffixText,required:!0,name:"domain",config:{affixes:d}}]}]},TRANSFER_DOMAIN_DIALOG_CONFIG:{name:"transferDomain",style:"flyout",savingText:"Transferring Domain...",
overlay:0.5,width:370,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Transfer"}],tabs:[{title:"Transfer Squarespace 5 Domain",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.SuffixText,required:!0,name:"domain",config:{affixes:d}},{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Account Login.</strong> Your Squarespace 5 account credentials."}},{ctor:b.Squarespace.DialogFields.Text,
config:{required:!0,name:"identifier","strings.placeholder":"Login",saveOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Text,config:{required:!0,type:"password",name:"password","strings.placeholder":"Password",saveOnEnter:!0}}]}]},REGISTER_DOMAIN_DIALOG_CONFIG:{name:"registerDomain",style:"flyout",savingText:"Checking Domain...",overlay:0.5,width:370,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Add"}],tabs:[{title:"Register Free",icon:"/universal/images-v6/icons/icon-plus-16-light.png",
fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Choose a free domain below.</strong> This domain will be registered to your account.  <br/><br/> <strong>You will be the owner of this domain.</strong>  If you choose to leave Squarespace in the future, you will be given the transfer key for this domain so you can take it with you.",padding:[0,15]}},{ctor:b.Squarespace.DialogFields.SuffixText,required:!0,name:"domain",config:{affixes:d}}]}]},TLDOptions:d,ATTRS:{siteContext:{getter:function(){return Static.SQUARESPACE_CONTEXT}},
buttons:{getter:function(){var c=[{type:"add",label:"Link Existing"}],d=this.get("siteContext.domainCredits");b.Lang.isValue(d)&&0<d?c.unshift({label:"Register Free",action:this._registerDomain}):this.get("siteContext.canRegisterDomains")||c.unshift({label:"Register Free",action:this._showDomainRegisterUpgradeInfo});b.Squarespace.Utils.isBetaFeatureEnabled()?c.unshift({label:"Transfer",action:this._transferDomain}):c.unshift({label:"Transfer Squarespace 5 Domain",action:this._transferV5Domain});return c}},
"strings.description":{value:b.Lang.sub("Custom domain settings provide a way for you to completely hide the squarespace.com domain from your site visitors. For example, instead of having your site appear at http://{websiteIdentifier}.{appDomain}/, you could point your own domain to Squarespace, and have your visitors go directly to http://www.mysite.com/.",{websiteIdentifier:b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"]),appDomain:b.Object.getValue(Static,["SQUARESPACE_CONTEXT",
"appDomain"])})},"strings.title":{value:"Domains"},fields:{value:[{ctor:b.Squarespace.DialogFields.DomainsList,config:{name:"domains"}}]}}})},"1.0",{requires:"squarespace-dialog-domains-list squarespace-dialog-suffix-text squarespace-dialog-html squarespace-dialog-description squarespace-domain-registrar squarespace-domain-linker squarespace-fluent-confirmation squarespace-settings-panel squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dialog-timezone",function(b){var d=b.namespace("Squarespace.DialogFields").TimeZone=b.Base.create("timeZone",b.Squarespace.DialogField2,[],{initializer:function(b){},renderUI:function(){b.Squarespace.DialogFields.TimeZone.superclass.renderUI.call(this);var c=b.Squarespace.UITemplates.render(d.TEMPLATE_NAME,this._getTemplateDataModel());this.get("contentBox").append(c)},bindUI:function(){this.after(this.get("id")+"|locationDataChange",this._onDataSetChange,this);this.after(this.get("id")+
"|dataChange",this._onDataChange,this);this.after(this.get("id")+"|timezoneInfoChange",this._onTimezoneInfoChange,this);b.delegate("click",this._onMapClick,this.get("contentBox"),".timezone-mousefield",this);b.delegate("change",this._onDropDownSelect,this.get("contentBox"),".timezone-select",this);this.timer=b.later(1E3,this,this._updateTime,null,!0)},syncUI:function(){var c=this._getTemplateDataModel();c.isLoading?(c=b.Node.create(b.Squarespace.UITemplates.render(d.TEMPLATE_NAME,c)),this.get("contentBox").insert(c,
"replace"),this.addDragSupport()):(this.get("contentBox").one(".timezone-marker").setStyle("left",c.dotLocation.x-d.IMAGE_INFO.markerwidth/2+"px"),this.get("contentBox").one(".timezone-marker").setStyle("top",c.dotLocation.y-d.IMAGE_INFO.markerwidth/2+"px"),this.get("contentBox").one(".timezone-highlight").setStyle("left",c.highlightOffset+"px"),c=b.Node.create(b.Squarespace.UITemplates.render(d.TEMPLATE_NAME,c)),this.get("contentBox").one(".timezone-datafield").replace(c.one(".timezone-datafield")))},
addDragSupport:function(){this.dd&&this.dd.destroy();this.dd=new b.DD.Drag({node:"#marker"});this.dd.plug(b.Plugin.DDConstrained,{constrain2node:"#mapCanvas"});this.dd.plug(b.Plugin.DDProxy);this.dd.on("drag:end",this._onDragEnd,this)},_getTemplateDataModel:function(){var b={value:this.get("data"),isLoading:!0},e=this.get("timezoneOptions"),d=this.get("locationData");if(e&&d){for(var g=0;g<e.length;g++)e[g].data=d[e[g].key];e[0].selected=!0;b.options=e;b.selected=d[b.value];b.dotLocation=this._getLocationXY(b.value);
b.highlightOffset=this._getHighlightOffset(b.value);b.timezoneInfo=this.get("timezoneInfo");b.isLoading=!1}return b},_onDataChange:function(){var c=this.get("data"),c=this.get("locationData")[c];b.Lang.isUndefined(c)?this.set("data","America/New_York"):(c=this._lookup(c.location.latitude,c.location.longitude),this._requestTimezoneInfo(),this.set("timezoneOptions",c.slice(0,10)),this.syncUI(),this._updateTime())},_updateTime:function(){var c=this.get("timezoneInfo");if(c){var e=new Date,d=this.get("contentBox");
e.setMinutes(e.getMinutes()+e.getTimezoneOffset()+parseInt(c.offset,10));d.one(".timezone-datafield-top").setHTML(b.DataType.Date.format(e,{format:"%l:%M:%S %p"})+" "+c.abbr);d.one(".timezone-datafield-bottom").setHTML(b.DataType.Date.format(e,{format:"%A, %B %d, %Y"}))}},_onDataSetChange:function(){this._onDataChange();this.syncUI()},_onMapClick:function(b){if(b=this._getCoordinates(b))b=this._lookup(b.lat,b.lon),this.set("data",b[0].key)},_onDragEnd:function(b){console.log("drag end",b);var e=this.get("contentBox").one(".timezone-mousefield"),
f=b.pageX-e.getX();b=b.pageY-e.getY();f=this._toLon(f-d.IMAGE_INFO.mapCenter.x);b=this._toLat(b-d.IMAGE_INFO.mapCenter.y);f=this._lookup(b,f);this.set("data",f[0].key)},_onDropDownSelect:function(b){this.set("data",b.target.get("value"))},_requestTimezoneInfo:function(){this.set("timezoneInfo",null);b.Data.get({url:"/api/commondata/GetTimeZoneInfo",data:{timezone:this.get("data")},success:function(b){this.set("timezoneInfo",b)},failure:function(b){console.warn("Failed to get timezone info");this.set("timezoneInfo",
null)}},this)},_onTimezoneInfoChange:function(){this.get("timezoneInfo")?(this.get("contentBox").one(".timezone-time-block").removeClass("loading"),this._updateTime()):this.get("contentBox").one(".timezone-time-block").addClass("loading")},_getCoordinates:function(c){var e=c.target;if(e.getX()&&e.getY()){var f=c.clientX-e.getX()+b.DOM.docScrollX();c=c.clientY-e.getY()+b.DOM.docScrollY();var e=this._toLon(f-d.IMAGE_INFO.mapCenter.x),g=this._toLat(c-d.IMAGE_INFO.mapCenter.y);return{lon:e,lat:g,x:f,
y:c}}return null},_lookup:function(b,e){var d=[],g=this.get("locationData"),h;for(h in g){var k=g[h].location;if(k){var l=b-k.latitude,k=Math.sqrt(Math.pow(e-k.longitude,2)+Math.pow(l,2));d.push({key:h,dist:k})}}d.sort(function(b,c){return b.dist-c.dist});return d},_getLocationXY:function(b){if(b=this.get("locationData")[b]){var e={};e.x=this._toX(b.location.longitude)+d.IMAGE_INFO.mapCenter.x;e.y=this._toY(b.location.latitude)+d.IMAGE_INFO.mapCenter.y;return e}},_getHighlightOffset:function(b){b=
this.get("locationData")[b];return Math.floor((b.minoffset+720)%1500*d.IMAGE_INFO.width/1440-d.IMAGE_INFO.highlightWidth/2)},_toX:function(b){b=b*Math.PI/180;return Math.floor((b-d.LAMBDA)*d.R)},_toLon:function(b){return Math.floor(100*(180*(b/d.R+d.LAMBDA)/Math.PI))/100},_toY:function(b){b=b*Math.PI/180;return-1*Math.floor(d.R*Math.log((Math.sin(b)+1)/Math.cos(b)))},_toLat:function(b){b=Math.atan(this._sinh(-1*b/d.R));return Math.floor(100*(180*b/Math.PI))/100},_sinh:function(b){var e=Math.pow(Math.E,
b);b=Math.pow(Math.E,-b);return(e-b)/2},destructor:function(){this.timer.cancel()}},{TEMPLATE_NAME:"timezone-dialog-field.html",R:700/(2*Math.PI),LAMBDA:0,IMAGE_INFO:{height:551,width:710,highlightWidth:42,markerwidth:12,mapCenter:{x:356,y:228}},ATTRS:{locationData:{value:null},timezoneOptions:{value:null},timezoneInfo:{value:null}}})},"1.0",{requires:["squarespace-dialog-field-2","dd-constrain","squarespace-timezone-dialog-field-template"]});
YUI.add("squarespace-content-manager-widgets-blog-list",function(b){b.namespace("Squarespace.Blog");var d=b.Squarespace.Blog.List=b.Base.create("BlogList",b.Squarespace.Widgets.DataWidget,[b.WidgetChild,b.WidgetParent,b.Squarespace.Mixins.ContentCollectionBulkActionable],{initializer:function(){this._itemToWidgetMap={};this.get("stickyHeadersEnabled")&&this._plugStickyHeaders()},bindUI:function(){this.on(this.get("id")+"|selectionChange",this.updateActionTray,this);this._registerEvent(this.get("items").after("add",
function(b){"reorder"!=b.source&&this._addItemWidget(b.model)},this));this.after(this.get("id")+"|itemsChange",this.syncUI,this);this._registerEvent(b.on(this.get("id")+"|click",this.deselectAll,".page-background-column",this))},syncUI:function(){d.superclass.syncUI.call(this);this._syncListItems()},destructor:function(){this.get("stickyHeadersEnabled")&&this._unplugStickyHeaders()},setSelected:function(b,e){this.each(function(d){d.set("isSelected",d===b,e)})},getSelectedWidget:function(){return b.Array.find(this.toJSON(),
function(b){return b.get("isSelected")})},_plugStickyHeaders:function(){var c=this.get("itemStates");this.get("contentBox");this.plug(b.Squarespace.Plugin.StickyHeader,{states:c,key:"workflowState"})},_unplugStickyHeaders:function(){this.unplug(b.Squarespace.Plugin.StickyHeader)},_syncListItems:function(){var c=this.get("items");if(b.Lang.isValue(c)){this.setLoadedState();var e=[];this.each(function(b){b.set("selected",0);e.push(b)});b.Array.each(e,function(b){b.destroy()});b.Lang.isArray(c)||(c=
c.toArray());b.Array.each(c,this._addItemWidget,this);this.fire("syncComplete",{itemSize:c.length})}},getWidgetForItem:function(b){return this._itemToWidgetMap[b.get("clientId")]},_addItemWidget:function(c,e){var d=this.add(b.merge({item:c},e)).item(0);this._itemToWidgetMap[c.get("clientId")]=d}},{CSS_PREFIX:"sqs-blog-list",ATTRS:{collection:{},defaultChildType:{value:b.Squarespace.Blog.Item},itemStates:{readOnly:!0,valueFn:function(){var c=[];b.Object.each(b.Squarespace.WorkflowStates,function(b,
d){c.push({index:b,label:d.toLowerCase().replace("_"," ").capitalize(),name:d.toLowerCase().replace("_","-")})},this);c=b.Array.filter(c,b.Lang.isValue);c.sort(function(b,c){return c-b});return c}},multiple:{value:!0},root:{},items:{},model:{getter:function(){return this.get("collection")}},moveable:{value:!0},stickyHeadersEnabled:{value:!0}}})},"1.0",{requires:"squarespace-ss-widget squarespace-content-manager-widgets-blog-item squarespace-content-manager-plugin-sticky-header widget-child widget-parent base-build".split(" ")});
YUI.add("squarespace-widgets-inventory-header",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.InventoryHeader=b.Base.create("InventoryHeader",b.Squarespace.Widgets.ModelListHeader,[],{initializer:function(){var c=b.Squarespace.Models.Inventory.SORT_TYPES;this._sorter=new b.Squarespace.Widgets.Sorter({sortable:this.get("models"),sortFieldConfigs:[{name:"Item",type:c.ITEM},{name:"Price",type:c.PRICE},{name:"Stock",type:c.STOCK}],visible:!1})},destructor:function(){this._sorter.destroy()},
renderUI:function(){d.superclass.renderUI.call(this);this._sorter.render(this.get("contentBox").one(".header-controls"))},_updateControlsVisibility:function(){this._sorter.set("visible",!this.get("models").isEmpty())}},{CSS_PREFIX:"sqs-inventory-header",ATTRS:{tabs:{value:[{name:"inventory",title:"Inventory",description:'Here, you can manage inventory across your entire store. To manage how products are presented to your customers, manage your products via collections directly in the "Content Manager".  If you have products on other sites, try <a href="#module=settings&settings-subpanelName=importing-settings">importing them directly</a> into Squarespace.'}]},
actionButtons:{valueFn:function(){return[{name:"addProduct",label:"Add Product",action:b.bind(b.Squarespace.Commerce.addProductToWebsite,this,this.get("models"))}]}},strings:{value:{title:"Inventory"}}}})},"1.0",{requires:"base promise squarespace-commerce-utils squarespace-content-item-types-editor squarespace-content-item-types-selector squarespace-enum squarespace-models-content-item squarespace-ui-base squarespace-util squarespace-widgets-model-list-header squarespace-widgets-sorter".split(" ")});
YUI.add("squarespace-block-posts-by-model-editor-base",function(b){b.namespace("Squarespace.Block.ModelEditorDialog").PostsBy=b.Base.create("blockPostsByEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var d=this.get("dialog"),c=b.Squarespace.ContentCollectionCache;this._dialogReady=!1;(this._collectionsLoaded=0===c.size())&&c.load(b.bind(this._onCollectionsLoaded,this));b.Lang.isValue(d)&&d.after("ready",this._onDialogLoaded,this)},_getDefaultAndProductCollections:function(){var d=
b.Squarespace.ContentCollectionCache.filter(function(c){if(c=c.getTemplateConfiguration()){var e=c.get("collectionType");return(e==b.Squarespace.CollectionTypes.PRODUCT||e==b.Squarespace.CollectionTypes.GENERIC)&&!1===c.get("folder")}return!1});return this._filterOutCalendarCollections(d)},_filterOutCalendarCollections:function(d){return b.Array.filter(d,function(c){return c.getTemplateConfiguration().get("ordering")===b.Squarespace.CollectionOrdering.CALENDAR?!1:!0})},_onDialogLoaded:function(b){this._dialogReady=
!0;this._collectionsLoaded&&this._setCollections()},_onCollectionsLoaded:function(b){this._collectionsLoaded=!0;this._dialogReady&&this._setCollections()},_setCollections:function(){var d=this.get("dialog"),c=this._getDefaultAndProductCollections(),c=b.Squarespace.ContentCollectionUtils.groupCollectionsByTypeName(c);d.getField("collectionId").set("collectionGroups",c)},_getDefaultDialogConfiguration:function(){var d=this.get("strings.description");return{name:"groupby",title:"Edit List",width:300,
height:450,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:this.get("strings.title"),icon:"/universal/images-v6/icons/icon-tagcloud-16-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:d,text:"",padding:[0,0]}},{ctor:b.Squarespace.DialogFields.ContentIdSelector,config:{name:"collectionId",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionFilter:{folder:!1}}}]}]}}},{NS:"postsByEditor",
ATTRS:{dialogConfig:{valueFn:"_getDefaultDialogConfiguration",validator:b.Lang.isObject},strings:{value:{title:"Index",description:"Select a collection below."}}}})},"1.0",{requires:["base","squarespace-block-posts-by-model","squarespace-models-content-collection","squarespace-dialog-description","squarespace-dialog-content-selector"]});
YUI.add("squarespace-block-tourdates-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");b.Squarespace.Block.ModelEditorDialog.TourDates=b.Base.create("TourDatesModelEditorDialog",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this.get("dialog").on("ready",function(){this._toggleDateRangePickerVisibility();this.get("dialog").el.addClass("dialog-edittourdatesblock-ready")},this);this.get("model").after("timeframeChange",this._toggleDateRangePickerVisibility,this)},
_toggleDateRangePickerVisibility:function(){var b=this.get("dialog"),c="dateRange"===this.get("model").get("timeframe");b.getField("startDate").set("visible",c);b.getField("endDate").set("visible",c)},_getDefaultDialogConfig:function(){return{title:"Bandsintown",width:410,height:260,name:"editTourDatesBlock",closeOthers:!1,style:"standard",flyoutPointerDirection:"hidden",draggable:9!==b.UA.ie&&10!==b.UA.ie,loadingText:"Editing Tour Dates Block &hellip;",initialDataByReference:!0,buttons:[{type:"cancel",
title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{tabTitle:"Bandsintown",icon:"/universal/images-v6/icons/icon-bandsintown-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{"strings.placeholder":"Ziggy Stardust","strings.title":"Band Name","strings.description":"Enter your band's name as it appears within your Bandsintown account.","strings.requiredFieldEmptyMessage":"Please enter a band name.",name:"artistId",className:"thin",required:!0}},
{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Timeframe to Show",name:"timeframe",className:"thin dark",defaultValue:"upcoming",options:[{value:"upcoming",label:"Upcoming"},{value:"dateRange",label:"Date Range"}]}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.DateTimePicker,config:{"strings.title":"Tour begins on",name:"startDate",dateFormat:"%b %d, %Y",timePickerEnabled:!1}},{ctor:b.Squarespace.DialogFields.DateTimePicker,config:{"strings.title":"and ends","strings.errorMessage":"End date needs to be later than start date.",
name:"endDate",dateFormat:"%b %d, %Y",timePickerEnabled:!1,validator:function(b){var c=this.get("dialog").getField("startDate").get("data");return null===b||b>=c}}}]}]}]}}},{ATTRS:{dialogConfig:{valueFn:"_getDefaultDialogConfig",validator:b.Lang.isObject}}})},"1.0",{requires:"base model squarespace-dialog-text squarespace-dialog-select squarespace-dialog-datetime-picker squarespace-model-editor".split(" ")});
YUI.add("squarespace-newsletters-message",function(b){var d=b.Base.create("NewsletterMessage",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.REST_API_ROOT+"newsletters/messages/{id}",root:b.Squarespace.REST_API_ROOT+"newsletters/messages"},{ATTRS:{id:{value:null,validator:b.Lang.isString},addedOn:{value:null,validator:b.Lang.isNumber},updatedOn:{value:null,validator:b.Lang.isNumber},sentOn:{value:null,validator:b.Lang.isNumber},status:{value:null,validator:b.Lang.isNumber},testEmailVerified:{value:!1,
validator:b.Lang.isBoolean},toGroups:{value:[],validator:b.Lang.isArray},toEmails:{value:[],validator:b.Lang.isArray},toTestEmails:{value:[],validator:b.Lang.isArray},subject:{value:null,validator:b.Lang.isString},header:{value:null,validator:b.Lang.isObject},body:{value:null,validator:b.Lang.isObject},footer:{value:null,validator:b.Lang.isObject},totalRecipients:{value:null,validator:b.Lang.isNumber},totalRecipientsSent:{value:null,validator:b.Lang.isNumber}}}),c=b.Base.create("NewsletterMessageList",
b.ModelList,[b.Squarespace.ModelSync.REST],{model:d,initializer:function(){this.load()},_compare:function(b,c){return b<c?1:b>c?-1:0},comparator:function(b){return b.get("addedOn")},getDrafts:function(){return this.filter(function(c){return c.get("status")!==b.Squarespace.NewsletterMessageStatus.SENT})},getSent:function(){return this.filter(function(c){return c.get("status")===b.Squarespace.NewsletterMessageStatus.SENT})}});b.namespace("Squarespace.Models").NewsletterMessageList=c;b.namespace("Squarespace.Models").NewsletterMessage=
d},"1.0",{requires:["base","model-list","squarespace-model-sync-rest","squarespace-enum"]});
YUI.add("squarespace-models-contribution",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.Contribution=b.Base.create("Contribution",b.Model,[b.Squarespace.ModelSync.REST],{root:"/api/rest/commerce/contributions"},{ATTRS:{amountCents:{value:null},donor:{value:null},submittedOn:{value:null},currency:{value:null},testMode:{value:null},message:{value:null},customForm:{value:null}}});b.Squarespace.Models.ContributionList=b.Base.create("Contributions",b.ModelList,[b.Squarespace.ModelSync.REST],
{url:"/api/rest/commerce/contributions?offset={offset}&limit={limit}",parse:function(d){d=b.JSON.parse(d);this.set("pagination",d.pagination);this.set("testCount",d.testCount);return d.contributions}},{ATTRS:{offset:{value:0},limit:{value:10},pagination:{value:null},testCount:{value:null}}})},"1.0",{requires:["node","oop","json","model","squarespace-model-sync-rest"]});
YUI.add("squarespace-models-checkout-page-form",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.CheckoutPageForm=b.Base.create("checkoutPageForm",b.Squarespace.Models.Form,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.API_ROOT+"settings/store-settings/checkout-form",url:b.Squarespace.API_ROOT+"settings/store-settings/checkout-form"})},"1.0",{requires:["base","squarespace-models-form","squarespace-model-sync-rest"]});
YUI.add("squarespace-dialog-check-link",function(b){var d=b.namespace("Squarespace.DialogFields").CheckLink=b.Base.create("checkLink",b.Squarespace.DialogFields.Check,[],{initializer:function(){this._bb=this.get("boundingBox")},renderUI:function(){d.superclass.renderUI.call(this);this._link=this._bb.one(".title a");this._toggleLink()},bindUI:function(){b.Squarespace.DialogFields.Check.superclass.bindUI.call(this);this.after("dataChange",this._toggleLink,this);this._bb.on("click",this._onClick,this)},
_onClick:function(b){b=b.target.get("tagName");var e=this.get("onClick");"A"!==b&&this._toggleActive();e()},_toggleLink:function(){if(this.get("toggle")){var b=this.get("data"),e=this.getClassName("hidden-link");b?this._bb.removeClass(e):this._bb.addClass(e)}}},{CSS_PREFIX:"sqs-check",HANDLEBARS_TEMPLATE:"dialog-check-link.html",ATTRS:{label:{value:null},url:{value:null},onClick:{value:noop,validator:b.Lang.isFunction},toggle:{value:!0}}})},"1.0",{requires:["base","node","squarespace-dialog-check",
"squarespace-dialog-check-link-template"]});
YUI.add("squarespace-settings-activity-base-manager",function(b){b.namespace("Squarespace.Settings.Activity");var d=b.Squarespace.Settings.Activity.BaseManager=b.Base.create("activityManager",b.Squarespace.Widgets.SSWidget,[b.WidgetParent],{initializer:function(){this._initHeaderTray()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox"),e=this.get("contentBody");b.addClass("sqs-activity-manager-content");this._headerTray.show();this.get("boundingBox").addClass("settings clear sqs-settings-panel");
b.append(e)},bindUI:function(){d.superclass.bindUI.call(this);this.after("activeTabChange",this._handleStateChange,this);this.after("dataChange",this._handleDataChange,this);this.requestData()},syncUI:function(){d.superclass.syncUI.call(this);this.clearElements();var b=this.get("data");null!==b&&(this._hasDataErrors(b)||this._isDataEmpty(b)?this._renderEmptyOrError(b):this._renderSuccess(b))},clearElements:function(){this.get("contentBody").empty()},_handleStateChange:function(b){this.get("rendered")&&
this.requestData()},_handleDataChange:function(b){this.get("rendered")&&this.syncUI()},_tabClicked:function(b){b=b.target;b.get("boundingBox");b.get("active")||this.set("activeTab",b.get("name"))},_initHeaderTray:function(){var c=this._mapToDialogTabs(this.get("tabs"));this._headerTray=this.add({childType:b.Squarespace.Widgets.TabbedHeaderTray,"strings.title":this.get("strings.title"),render:this.get("contentBox"),buttons:c,defaultTab:this.get("activeTab")}).item(0)},_mapToDialogTabs:function(c){return b.Array.map(c,
function(b){return{action:this._tabClicked,context:this,name:b.key,label:b.label,className:"view-period"}},this)},_renderSuccess:function(b){console.warn("_renderSuccess should be implemeneted on the child.");this._renderEmptyOrError(b)},_renderEmptyOrError:function(b){this._renderError(b)},_renderError:function(b){b=b.error?"error":"large";this.get("contentBody").append(this.getNoDataEl(b))},getNoDataEl:function(c,e){var d="error"===c?"Statistics Server Unavailable":"No Data Available";e=e||"Please try again in a moment.";
var g=b.Node.create('<div class="no-data '+c+'">'),h=b.Node.create('<div class="container '+c+'">'),d=b.Node.create('<div class="title">'+d+"</div>"),k=this._getIconEl(c);h.append(k);h.append(d);e&&h.append('<div class="description">'+e+"</div>");g.append(h);return g},_isDataEmpty:function(c){return!b.Lang.isValue(c)},_hasDataErrors:function(c){return b.Lang.isValue(b.Object.getValue(c,"errors"))},_requestDataFailure:function(b){this.set("data",b)},_requestDataSuccess:function(b){this.set("data",
b)},requestData:function(){b.Data.get({url:this.get("url"),data:this.get("requestParams"),success:this._requestDataSuccess,failure:this._requestDataFailure},this)},_getIconEl:function(c){return"small"===c?b.Node.create('<img class="icon small" src="/universal/images-v6/configuration/stats-nodata-small.png">'):"large"===c?b.Node.create('<img class="icon large" src="/universal/images-v6/configuration/stats-nodata-large.png">'):"error"===c?b.Node.create('<img class="icon large" src="/universal/images-v6/configuration/stats-no-server.png">'):
b.Node.create('<img class="icon" src="/universal/images-v6/configuration/stats-nodata.png">')},_getTabName:function(c){var e=b.Array.find(this.get("tabs"),function(b){return b.key===c});return b.Object.hasKey(e,"label")?e.label:c},renderSummary:function(c,e,d,g,h){if(!h&&0===c)return null;h=b.Node.create('<div class="item clear">');c=b.Node.create('<div class="clear"><div class="big-number float-left">'+this.formatNumber(c)+"</div></div>");h.append(c);null!==e&&0!==e&&(e=b.Node.create('<div class="float-left average"><div class="text tiny">'+
d+'</div><div class="small-number">/'+this.formatNumber(e)+"</div></div>"),c.append(e));h.append('<div class="text">'+g+"</div>");return h},renderAnalysis:function(c,e,d,g){function h(b,c){return c.count-b.count}var k=b.Node.create('<div class="analysis clear">');return e.summaries&&0<e.summaries.length?((new b.Squarespace.WeightedList({data:e.summaries.sort(h),key:"percentage",label:d,valueLabel:!1===g?null:"count",range:[14,22],formatter:function(b){return b.percentage.toFixed(2)+"%"},title:c})).render(k),
k):null},renderStandardPieChart:function(c,e,d){(new b.Squarespace.PieChart({data:c.slice(0,10),key:"percentage",formatter:d,radius:100,range:["#222","#eee"]})).render(e)},formatNumber:function(c){return 0===c?"-":b.DataType.Number.format(c,{thousandsSeparator:",",decimalSeparator:"."})},formatShortDate:function(b,e){if("month"===e||"week"===e){var d=b.timePeriodShort.split(" ");return{primary:d[1],secondary:d[0]}}if("day"===e){var d=b.timePeriodShort.split(":")[0],g=b.timePeriodShort.split(" ")[1];
return{primary:d,secondary:g}}return"year"===e?(d=b.timePeriodLong.split(" ")[1],{primary:b.timePeriodShort,secondary:d}):{primary:b.timePeriodShort}},parseTargetName:function(b){var e=/\((\w+)\)/.exec(b);return e&&2<=e.length&&e.index?{title:b.substring(0,e.index),collectionType:e[1].capitalize()}:{title:b,collectionType:""}},trimEnd:function(b,e){e=e||50;return b.length>e?b.substring(0,e)+"...":b},_periodToDays:function(b){switch(b){case "1day":return 1;case "2days":return 2;case "3days":return 3;
case "week":return 7;case "month":return 31;default:return 7}}},{CSS_PREFIX:"sqs-activity-manager",ATTRS:{activeTab:{value:"month"},baseURL:{value:"/api/census/"},contentBody:{valueFn:function(){return b.Node.create('<div class="statistics sqs-activity-manager-content-body"></div>')}},data:{value:null},requestParams:{value:{}},strings:{value:{title:"Default Panel"}},tabs:{value:[{label:"Hourly",key:"day"},{label:"Daily",key:"month"},{label:"Weekly",key:"week"},{label:"Monthly",key:"year"}]},url:{getter:function(){return this.get("baseURL")+
"GetReport"}}}})},"1.0",{requires:"base node widget-parent datatype-number squarespace-weighted-list squarespace-pie-chart squarespace-ss-widget squarespace-tray".split(" ")});
YUI.add("squarespace-widgets-music-album-track",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.MusicAlbumTrack=b.Base.create("MusicAlbumTrack",b.Squarespace.Widgets.Model,[b.WidgetChild,b.Squarespace.Mixins.EditableModel],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox"),e=b.one(".meta");this._titleNode=b.one(".music-track .title");this._artistNameNode=e.one(".artist-name");this._durationNode=e.one(".duration");this._utilsNode=b.one(".utils")},
bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("model").get("structuredContent");this._registerEvent(b.after("change",this.syncUI,this));this.get("contentBox").on(["click","contextmenu"],function(b){b.shiftKey?this._toggleSelected():b.target.ancestor(".remove",!0)?this._confirmAndDestroy():this._edit()},this)},syncUI:function(){d.superclass.syncUI.call(this);this._syncMediaProcessingState();var c=this.get("model"),e=c.get("title")||"No Title",f=c.get("structuredContent"),c=f.get("artistName")||
"Unknown Artist",f=f.get("lengthInMilliSeconds"),f=b.Lang.isValue(f)?b.Squarespace.DateUtils.humanizeDuration(f):"N/A";this._titleNode.setHTML(e);this._artistNameNode.setHTML(c);this._durationNode.setHTML(f)},_toggleSelected:function(){this.set("selected",0===this.get("selected")?1:0)},_confirmAndDestroy:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Track","strings.message":"Are you sure you wish to remove this track?"})).on("confirm",function(){this.get("model").destroy({remove:!0})},
this)},_syncMediaProcessingState:function(){var c=this.get("contentBox").one(".processing-wrapper");c&&c.remove(!0);c=this.get("model");switch(c.get("mediaProcessingState")){case b.Squarespace.MediaProcessingState.QUEUED:case b.Squarespace.MediaProcessingState.PROCESSING:this._showProcessingStatus("Processing...",!0);break;case b.Squarespace.MediaProcessingState.READY:this.set("className",this.getClassName("ready"));break;default:c.get("mediaIsUploading")?this._showProcessingStatus("Uploading...",
!0):c.get("systemDataId")?(this.set("className",this.getClassName("error")),this._showProcessingStatus("Error Processing",!1)):(this.set("className",this.getClassName("error")),this._showProcessingStatus("No Audio Asset",!1))}},_showProcessingStatus:function(c,e){this.set("className",this.getClassName("processing"));var d=this._utilsNode.appendChild('<div class="processing-wrapper"></div>');e&&new b.Squarespace.Spinner({render:d,color:"dark"});d.append("<span>"+c+"</span>")}},{CSS_PREFIX:"sqs-music-album-track",
HANDLEBARS_TEMPLATE:"widgets-music-album-track.html",ATTRS:{editorCtor:{value:b.Squarespace.ContentItemEditor.Audio},model:{valueFn:function(){return new b.Squarespace.Models.ContentItem({recordType:b.Squarespace.RecordType.Audio})},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ContentItem)},item:{getter:function(){return this.get("model")},readOnly:!0}}})},"1.0",{requires:"base widget-child squarespace-content-item-types-audio squarespace-date-utils squarespace-enum squarespace-mixins-editable-model squarespace-spinner squarespace-ui-base squarespace-widgets-model squarespace-widgets-music-album-track-template squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-content-manager-navigation-item-folder",function(b){var d=b.namespace("Squarespace.ContentManager").NavigationItemFolder=b.Base.create("ContentNavigationItemFolder",b.Squarespace.ContentManager.NavigationItem,[b.WidgetChild,b.WidgetParent],{renderUI:function(){d.superclass.renderUI.call(this);this.get("item").get("children").each(this._uiAddNavigationItem,this)},bindUI:function(){var c=this.get("item"),e=c.get("collection"),d=this.get("id"),g=b.Squarespace.ContentCollectionUtils.isIndex(e),
h=this.get("contentBox");if(g)h.on("click",function(b){b.target.ancestor(".title",!0)==h.one("> .folder-item-wrapper > .title")&&(this.get("isSelected")||this.get("root").set("selectedCollection",this.get("item").get("collection")),b.halt())},this);h.on(g?"dblclick":"click",function(b){b.target.ancestor(".title",!0)==h.one("> .folder-item-wrapper > .title")&&(this.set("expanded",!this.get("expanded")),b.halt())},this);this._registerEvent(this.get("template").after("homepageCollectionIdChange",this.syncUI,
this));this._registerEvent(e.on(d+"|navigationTitleChange",function(b){h.one(".title").setContent(b.newVal||"&nbsp;")},this));this._registerEvent(e.on(d+"|destroy",this.hideAndDestroy,this));this.on("expandedChange",function(c){c.stopPropagation();var d=b.StorageLite.getItem("navigation-collapsedFolders",!0)||[];d[c.newVal?"remove":"push"](e.get("id"));b.StorageLite.setItem("navigation-collapsedFolders",d,!0);this[c.newVal?"_uiExpand":"_uiCollapse"]()},this);this._registerEvent(c.get("children").on(d+
"|add",function(b){"dd"!=b.source&&this._uiAddNavigationItem(b.model,!0)},this));this._registerEvent(c.get("children").after([d+"|add",d+"|remove"],this.syncUI,this));this._registerEvent(e.after("enabledChange",this.syncUI,this));this._registerEvent(e.after("idChange",this.syncUI,this));this.after("*:isSelectedChange",function(b){b.newVal&&!this.get("expanded")&&this.set("expanded",!0)},this);this._bindIsSelectedBehavior()},syncUI:function(){var c=this.get("item"),e=this.get("boundingBox");this.get("expanded")||
this._uiCollapse(!0);var d=this.get("item").get("children").isEmpty();e.toggleClass(this.getClassName("empty"),d);b.Lang.isValue(c.get("collectionId"))&&(d=c.get("collection").get("id"),e.setAttribute("id","collection-"+d),c=c.get("collection"),e.toggleClass(this.getClassName("disabled"),!c.get("enabled")),e.toggleClass(this.getClassName("homepage"),this.get("template").get("homepageCollectionId")==d),e.toggleClass(this.getClassName("index"),b.Squarespace.ContentCollectionUtils.isIndex(c)))},_uiAddChild:function(b,
e){this.get("contentBox").one(".items").appendChild(b.get("boundingBox"))},_destroyChildren:function(){this._hDestroyChild.detach();this.each(function(b){this.get("boundingBox").contains(b.get("boundingBox"))?b.destroy():b.set("parent",this.get("parent"))},this)},_uiExpand:function(b){var e=this.get("boundingBox"),d=e.one(".items-wrapper"),g=d.get("offsetHeight");d.setStyles({height:null});d.removeClass("collapsed");var h=d.get("offsetHeight");d.setStyles({height:g});e.addClass("collapsed");d.addClass("collapsed");
b?(e.removeClass("collapsed"),d.removeClass("collapsed"),d.setStyles({height:null})):d.anim({height:h},{end:function(){d.setStyles({height:null});d.removeClass("collapsed");e.removeClass("collapsed")}}).run()},_uiCollapse:function(b){var e=this.get("boundingBox"),d=e.one(".items-wrapper"),g=d.get("offsetHeight");d.setStyles({height:g});e.addClass("collapsed");d.addClass("collapsed");b?d.setStyles({height:0}):d.anim({height:0}).run()},_uiAddNavigationItem:function(c,e){var d=this.add({childType:c.isFolder()?
b.Squarespace.ContentManager.NavigationItemFolder:b.Squarespace.ContentManager.NavigationItem,item:c,render:this.get("contentBox").one(".items")});if(b.Lang.isBoolean(e)&&e){var d=d.item(0),g=d.get("contentBox");d.get("boundingBox").setStyles({overflow:"hidden"});g.setStyles({position:"relative",top:-1*g.get("offsetHeight"),left:0});g.anim({top:0}).run()}},_getHBTemplateContext:function(){var b=this.constructor.superclass._getHBTemplateContext.call(this),e=this.get("collectionConfiguration");b.addText=
e?e.get("addText"):"Add Page";b.emptyMessage=e&&e.get("emptyMessage")?e.get("emptyMessage"):"Empty folder.";return b}},{CSS_PREFIX:"sqs-navigation-item-folder",HANDLEBARS_TEMPLATE:"navigation-item-folder.html",ATTRS:{expanded:{valueFn:function(){var c=b.StorageLite.getItem("navigation-collapsedFolders",!0)||[],e=this.get("item").get("collection").get("id");return-1==c.indexOf(e)}}}})},"1.0",{requires:["squarespace-content-manager-navigation-item","squarespace-navigation-item-folder-template","squarespace-storage-lite"]});
YUI.add("squarespace-widgets-configuration-footer",function(b){var d=b.Squarespace.Widgets.ConfigurationFooter=b.Base.create("configurationFooter",b.Squarespace.Widgets.SSWidget,[],{bindUI:function(){d.superclass.bindUI.call(this);this._footerNode.on("click",function(b){b=b.target;(b.ancestor(".site-chooser-glyph",!0)||b.ancestor(".site-title-text",!0)||b.ancestor(".user-id",!0))&&this._toggleAccountMenu()},this)},renderUI:function(){d.superclass.renderUI.call(this);this._renderFooter()},_toggleAccountMenu:function(c){this._accountMenu||
(this._accountMenu=new b.Squarespace.Widgets.AccountMenu({render:!0,visible:!1}));this._accountMenu.get("visible")?this._accountMenu.hide():this._accountMenu.show()},_renderFooter:function(){var c=this._footerNode=b.Node.create('<div class="footer"></div>').appendTo(this.get("contentBox"));c.append(['<span class="link site-title">','<span class="site-title-text">'+b.Escape.html(Static.SQUARESPACE_CONTEXT.website.siteTitle)+"</span>",'<div class="site-chooser-glyph"></div></span><span class="link user-id">',
'<span><span class="user-display-name">'+b.Escape.html(this.get("memberAccount").get("displayName"))+"</span></span>","</span>"].join(""));c.append(this._renderBetaTag())},_renderBetaTag:function(){var c=Static.SQUARESPACE_CONTEXT.website.siteStatus.value,e;c===b.Squarespace.StatusConstants.TRIAL?e=b.Squarespace.Singletons.Template.isTemplateOwner()?"SANDBOX":"TRIAL":c===b.Squarespace.StatusConstants.EXPIRED?e="EXPIRED":c===b.Squarespace.StatusConstants.INTERNAL&&(e="INTERNAL");return e?'<span class="link beta-tag"><span>'+
e+"</span></span>":null}},{CSS_PREFIX:"sqs-footer",ATTRS:{memberAccount:{value:null}}})},"1.0",{requires:"base node squarespace-account-menu squarespace-common squarespace-enum squarespace-ss-widget".split(" ")});YUI.add("squarespace-content-manager-widgets-gallery-css",function(b){},"1.0",{requires:[]});
YUI.add("squarespace-admin-models-member-account",function(b){var d=b.namespace("Squarespace.Models.Admin").MemberAccount=b.Base.create("adminAccount",b.Squarespace.Models.MemberAccount,[],{url:b.Squarespace.REST_API_ROOT+"admin/member-accounts/{id}",root:b.Squarespace.REST_API_ROOT+"admin/member-accounts",serialize:function(){var c=this._getServerRelevantFields(),e=this.get("roles");b.Lang.isValue(e)&&(c.roles=b.Array.filter(b.Object.keys(e),function(b){return e[b]}));return b.JSON.stringify(c)},
changeEmail:function(c){return new b.Promise(b.bind(function(e,d){b.Data.put({url:this.getURL("update")+"/email",data:{email:c},success:function(){this.set("email",c);e(this)},failure:d},this)},this))},resetPassword:function(){return new b.Promise(b.bind(function(c,e){b.Data.post({url:this.getURL("update")+"/password-resets",success:c,failure:e})},this))},hasRole:function(c){if(!b.Lang.isValue(c))return!1;b.Lang.isNumber(c)&&(c=b.Squarespace.Utils.reverseMap(b.Squarespace.MemberAccountRole)[c]);var e=
this.get("roles");return e&&!!e[b.Squarespace.MemberAccountRole[c]]}});b.namespace("Squarespace.Models.Admin").MemberAccountList=b.Base.create("adminAccountList",b.Squarespace.Models.ModelList,[b.Squarespace.ModelSync.REST,b.Squarespace.ModelListParse,b.Squarespace.Mixins.PaginatedModelList],{model:d,url:b.Squarespace.REST_API_ROOT+"admin/member-accounts?roles={roles}"},{ATTRS:{roles:{getter:function(c){return b.Lang.isValue(c)?c.join():""},setter:function(b){return b}},fields:{value:"displayName id email createdOn lastLoginOn roles avatarAssetUrl".split(" ")},
paginator:{valueFn:function(){return new b.Squarespace.Models.OffsetPaginator({models:this,limit:20,orderBy:"email"})}}}})},"1.0",{requires:"base json model promise squarespace-enum squarespace-model-sync-rest squarespace-models-member-account squarespace-models-model-list squarespace-models-offset-paginator squarespace-mixins-paginated-model-list squarespace-mixins-field-filter".split(" ")});
YUI.add("squarespace-dialog-oembed",function(b){var d=b.namespace("Squarespace.DialogFields").Oembed=b.Base.create("oembed",b.Squarespace.DialogField2,[],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._input=b.one(".input");this._manual=b.one(".manual");this._status=b.one(".status");this._updateStatus(!0)},bindUI:function(){this._input.on("contextmenu",function(b){b.stopImmediatePropagation()});this._input.on("valuechange",this._onChange,this);if(this._manual)this._manual.on("click",
this._setManually,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("boundingBox").toggleClass("has-title",b.Lang.isValue(this.get("strings.title")))},focus:function(){this._input.focus()},didDataChange:function(){return this.get("edited")},_saveDefaultThumbnail:function(){b.Data.post({url:"/api/commondata/SaveMedia",data:{fileUrl:this.get("data.thumbnailUrl"),replaceItemId:this.get("item").get("id"),collectionId:this.get("collection").get("id"),process:!0,systemDataOrigin:this.get("data.thumbnailUrl")},
success:function(c){c=new b.Squarespace.ImageProcessingJob(b.merge(c.job,{started:!0}));c.on("complete",function(){this.get("dialog").fire("save-item");this.set("edited",!1)},this);c.on("failure",function(){this.get("dialog").fire("save-item");this.set("edited",!1)},this);Static.JOB_MANAGER.addJob(c)}},this)},_updateStatus:function(c,e){if("manual"==this.get("data.resolvedBy"))this._input.set("value",""),this._setStatus(!1,"Embed data has been manually set.");else{var d;c?(d=this.get("data.url"),
this.set("lastUrl",this.get("data.url"))):d=this.get("processingUrl");d?this.get("data.resolved")||this.get("data.resolvedBy")?(d=this.get("data.resolvedObject")?this.get("data.resolveObject")+" Successfully Located.":"Successfully Located.",this._setStatus(!1,d)):b.Lang.isString(e)?this._setStatus(!1,e):this._setStatus(!1,"URL is not embeddable."):this._setStatus(!1,this.get("strings.description"))}},_onChange:function(){var c=this._input.get("value");if(c!=this.get("lastUrl")){this.set("processingUrl",
c);this.set("lastUrl",this.get("processingUrl"));this.set("edited",!0);if(""!==this.get("processingUrl")){var e=this.get("processingUrl");0!==e.search(/^https?:\/\//)&&(e="http://"+e.replace(/^\/\//,""));var d=function(c,d){d!=e?(this._clear(),this._updateStatus()):c?(this.set("data",b.merge(this.get("data"),c)),this._updateStatus(),this._sendAnalyticsInfo("Success")):(this._clear(),this._updateStatus(),this._sendAnalyticsInfo("Empty"))},g=function(b,c){this._clear();this._updateStatus();this._sendAnalyticsInfo("Failure")},
h=function(b,c){this._clear();this._updateStatus(null,"The request to resolve this URL timed out, please try again. ");this._sendAnalyticsInfo("Timeout")};b.Object.some(b.Squarespace.oEmbedResolvers,function(b){if(b.canProcess(e,this.get("filter")))return this._setStatus(!0,"Locating content at that URL..."),b.process(e,{onSuccess:d,onFailure:g,onTimeout:h},this),!0},this)}this._clear();this._updateStatus()}},_sendAnalyticsInfo:function(c){b.Squarespace.Analytics.trackInternal("system_oembed",{result:c})},
_setStatus:function(c,e){this._status.empty(!0);c&&(new b.Squarespace.Spinner({render:this._status})).get("boundingBox").setStyles({"float":"left",marginRight:"9px"});this._status.append(b.Node.create(e))},_setManually:function(){var c=new b.Squarespace.EditingDialog({style:"flyout",name:"edit-embed",closeOthers:!1,overlay:0.5,width:460,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Set"}],primaryTabs:[{title:"Edit Embed Data",icon:"/universal/images-v6/icons/icon-embed-16-light-solid.png",
fields:[{ctor:b.Squarespace.DialogFields.TextArea,config:{name:"html","strings.placeholder":"Paste a custom embed code here.",height:200}}]}]});c.on("send-requested",function(){var b={html:c.getData().html,resolvedBy:"manual",resolved:!0};this.set("data",b);this.set("lastUrl",null);this.set("edited",!0);this._updateStatus();c.close()},this);"manual"==this.get("data.resolvedBy")&&c.setInitialData({html:this.get("data.html")});this.get("dialog").addChildDialog(c);b.later(0,this,function(){c.show()})},
_clear:function(){this.set("data",{url:this._input.get("value")})}},{CSS_PREFIX:"sqs-oembed",HANDLEBARS_TEMPLATE:"dialog-oembed.html",ASYNC_DATA:!0,ATTRS:{strings:{value:{title:"",description:"",inputPlaceholder:"Enter an embeddable URL here"}},collection:{value:null},contentItem:{value:null},data:{value:{}},edited:{value:!1},filter:{},item:{value:null},lastUrl:{value:null},manual:{value:!0},processingUrl:{value:null}}})},"1.0",{requires:"base base-build event-valuechange squarespace-dialog-field-2 squarespace-dialog-check squarespace-dialog-file-image squarespace-oembed-resolvers squarespace-dialog-oembed-template squarespace-job-manager squarespace-jobs squarespace-spinner".split(" ")});
YUI.add("squarespace-widgets-google-apps-user-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-google-apps-user.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l;b=this.escapeExpression;b=""+('<div class="icon"></div>\n<div class="info">\n  <div class="name">'+b((l=(l=c.model,null==l||!1===l?l:l.name),"function"===typeof l?l.apply(c):l))+'</div>\n  <div class="email">'+b((l=(l=c.model,null==
l||!1===l?l:l.email),"function"===typeof l?l.apply(c):l))+"</div>\n</div>\n\n");if((c=d["if"].call(c,(l=c.model,null==l||!1===l?l:l.lastLogin),{hash:{},inverse:this.program(3,function(b,c){return'\n  <div class="re-send-invitation">Re-Send Invitation</div>\n'},k),fn:this.program(1,function(b,c){return'\n  <div class="reset-password">Reset Password</div>\n'},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("widgets-google-apps-user.html".replace("/","."),d.templates["widgets-google-apps-user.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-summary-v2-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");b.Squarespace.Block.ModelEditorDialog.SummaryV2=b.Base.create("SummaryV2ModelEditorDialog",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this.dialog=this.get("dialog");this.model=this.get("model");this.collectionId=this._getCollectionId();this.collectionClassification=this._getCollectionClassification(this.collectionId);this.dialog.on("ready",function(){this._updateLayoutFields();
this._updateDisplayFields();this._updateMetadataDropdowns();this._updateAutocomplete();this.dialog.getField("collectionId").after("dataChange",function(){this._resetMetadataDropdowns();this._resetEventTimeframeDropdown()},this)},this);this.model.after("collectionIdChange",function(){this.collectionId=this._getCollectionId();this.collectionClassification=this._getCollectionClassification(this.collectionId);this._updateDisplayFields();this._updateMetadataDropdowns();this._updateAutocomplete()},this);
this.model.after("designChange",this._updateLayoutFields,this);this.model.after("showExcerptChange",this._updateReadMoreLinkField,this);this.model.on("save",this._setLightboxMode,this);this.dialog.on(["shown","tab-focused"],function(){this.dialog.getField("pageSize").refreshWidth();this.dialog.getField("listImageSize").refreshWidth();this.dialog.getField("slidesPerRow").refreshWidth()},this)},_setLightboxMode:function(){this.model.set("lightbox","gallery"===this.collectionClassification)},_updateLayoutFields:function(){var b=
this.model.get("design");this.dialog.el.all(".sqs-dialog-field.layout").each(function(c){c.toggleClass("hidden",!c.hasClass(b))},this)},_updateDisplayFields:function(){this.dialog.el.all(".sqs-dialog-field.display").each(function(b){b.toggleClass("hidden",!b.hasClass(this.collectionClassification))},this)},_updateReadMoreLinkField:function(){"blog"===this.collectionClassification&&this.dialog.getField("showReadMoreLink").get("boundingBox").toggleClass("hidden",!this.model.get("showExcerpt"))},_updateMetadataDropdowns:function(){var b=
[],b="gallery"===this.collectionClassification?b.concat([this._createSelectOption("none","None"),this._createSelectOption("date","Date Posted"),this._createSelectOption("cats","Category"),this._createSelectOption("tags","Tags"),this._createSelectOption("author","Author"),this._createSelectOption("location","Location")]):"events"===this.collectionClassification?b.concat([this._createSelectOption("none","None"),this._createSelectOption("date","Event Date"),this._createSelectOption("event-time","Event Time"),
this._createSelectOption("cats","Category"),this._createSelectOption("tags","Tags"),this._createSelectOption("location","Location")]):"products"===this.collectionClassification?b.concat([this._createSelectOption("none","None"),this._createSelectOption("cats","Category"),this._createSelectOption("tags","Tags")]):b.concat([this._createSelectOption("none","None"),this._createSelectOption("date","Date Posted"),this._createSelectOption("cats","Category"),this._createSelectOption("tags","Tags"),this._createSelectOption("author",
"Author"),this._createSelectOption("location","Location"),this._createSelectOption("comments","Comments")]);this.dialog.getField("primaryMetadata").set("options",b);this.dialog.getField("secondaryMetadata").set("options",b)},_resetMetadataDropdowns:function(){var b="date";"products"===this.collectionClassification&&(b="none");this.dialog.getField("primaryMetadata").set("data",b);this.dialog.getField("secondaryMetadata").set("data","none")},_resetEventTimeframeDropdown:function(){this.dialog.getField("showPastOrUpcomingEvents").set("data",
"Upcoming")},_updateAutocomplete:function(){var d=this._getCollectionId(),c=this.dialog.getField("filter");if(b.Lang.isString(d)&&""!==d&&b.Lang.isValue(c)){var e=c.get("tagField"),f=c.get("categoryField"),d={collectionId:d};b.Lang.isValue(c)&&(this._getNewAutoCompleteData(e,"/api/commondata/GetAutoCompleteTags",d),this._getNewAutoCompleteData(f,"/api/commondata/GetAutoCompleteCategories",d))}},_getNewAutoCompleteData:function(d,c,e){b.Data.get({url:c,data:e,success:function(c){var e=d.get("acWidget");
b.Lang.isValue(e)&&e.set("source",c)}})},_createSelectOption:function(b,c){return{value:b,label:c}},_getCollectionId:function(){return this.model.get("collectionId")||""},_getCollectionClassification:function(d){if(!d||!b.Squarespace.ContentCollectionCache.getById(d))return"";d=b.Squarespace.ContentCollectionCache.getById(d).get("typeName");d=b.Squarespace.Singletons.Template.get("collectionConfigs."+d).get("acceptTypes");var c;1===d.length?"text"===d[0]?c="blog":"image"===d[0]?c="gallery":"event"===
d[0]?c="events":"store_item"===d[0]&&(c="products"):c=2===d.length&&("image"===d[0]&&"video"===d[1]||"video"===d[0]&&"image"===d[1])?"gallery":"unknown";return c},_getDefaultDialogConfig:function(){return{title:"Edit Summary",width:400,height:440,name:"editSummaryV2Block",closeOthers:!1,style:"standard",flyoutPointerDirection:"hidden",draggable:9!==b.UA.ie&&10!==b.UA.ie,loadingText:"Editing Summary Block &hellip;",initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},
{type:"saveAndClose",title:"Save"}],tabs:[{tabTitle:"Content",icon:"/universal/images-v6/icons/icon-summary-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:'<span class="title">Collection</span> <span class="description">Select a collection from  which to feature items.</span>'}},{ctor:b.Squarespace.DialogFields.ContentIdSelector,config:{name:"collectionId",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionFilter:{collectionType:[b.Squarespace.CollectionTypes.PRODUCT,
b.Squarespace.CollectionTypes.GENERIC],ordering:[b.Squarespace.CollectionOrdering.USER,b.Squarespace.CollectionOrdering.CHRONOLOGICAL,b.Squarespace.CollectionOrdering.CALENDAR],folder:!1}}}]},{tabTitle:"Layout",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Design",name:"design",className:"layout autogrid list autocolumns carousel thin dark",defaultValue:"autogrid",options:[{value:"autogrid",label:"Grid"},{value:"list",label:"List"},{value:"carousel",label:"Carousel"},
{value:"autocolumns",label:"Autocolumns"}]}},{ctor:b.Squarespace.DialogFields.Text,config:{"strings.title":"Header Text",name:"headerText",className:"layout carousel thin",defaultValue:""}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Text Size",name:"textSize",className:"layout autogrid list autocolumns carousel thin dark",defaultValue:"medium",options:[{value:"extralarge",label:"Extra Large"},{value:"large",label:"Large"},{value:"medium",label:"Medium"},{value:"small",label:"Small"}]}},
{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Aspect Ratio",name:"imageAspectRatio",className:"layout autogrid list carousel thin dark",defaultValue:1.5,options:[{value:"Auto",label:"Auto"},{value:1,label:"1:1 Square"},{value:1.5,label:"3:2 Standard"},{value:2/3,label:"2:3 Standard (Vertical)"},{value:4/3,label:"4:3 Four-Three"},{value:0.75,label:"3:4 Three-Four (Vertical)"},{value:16/9,label:"16:9 Widescreen"},{value:2.4,label:"2.40 Anamorphic Widescreen"}]}},{ctor:b.Squarespace.DialogFields.Description,
config:{text:'<span class="title">Column Width</span> <span class="description">Specify a minimum width columns should be. The number of columns displayed will vary depending on the width of your site.',className:"layout autogrid autocolumns"}},{ctor:b.Squarespace.DialogFields.Slider,required:!1,config:{name:"columnWidth",range:[50,600],labelWidth:15,submitOnEnter:!0,className:"layout autogrid autocolumns"}},{ctor:b.Squarespace.DialogFields.Description,config:{text:'<span class="title">Gutter Width</span> <span class="description">Specify the distance between items.',
className:"layout autogrid autocolumns"}},{ctor:b.Squarespace.DialogFields.Slider,required:!1,config:{name:"gutter",range:[0,100],labelWidth:15,submitOnEnter:!0,className:"layout autogrid autocolumns"}},{ctor:b.Squarespace.DialogFields.Description,config:{text:'<span class="title">Image Size</span> <span class="description">Specify how wide the image should be in relation to the text.',className:"layout list"}},{ctor:b.Squarespace.DialogFields.Slider,required:!1,config:{name:"listImageSize",range:[10,
80],"strings.suffix":"%",pluralize:!1,labelWidth:20,submitOnEnter:!0,className:"layout list"}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Image Alignment",name:"listImageAlignment",className:"layout list thin dark",defaultValue:"left",options:[{value:"left",label:"Left"},{value:"right",label:"Right"}]}},{ctor:b.Squarespace.DialogFields.Description,config:{text:'<span class="title">Items Per Row</span> <span class="description">Specify how many items should be visible at a time.',
className:"layout carousel"}},{ctor:b.Squarespace.DialogFields.Slider,required:!1,config:{name:"slidesPerRow",range:[1,5],labelWidth:5,submitOnEnter:!0,className:"layout carousel"}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Text Alignment",name:"textAlignment",className:"layout autogrid list autocolumns carousel thin dark",defaultValue:"left",options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]}},{ctor:b.Squarespace.DialogFields.Select,
config:{"strings.title":"Metadata Position",name:"metadataPosition",className:"display blog gallery events products unknown thin dark",defaultValue:"below-content",options:[{value:"above-title",label:"Above Title"},{value:"below-title",label:"Below Title"},{value:"below-content",label:"Below Content"}]}}]},{tabTitle:"Display",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:'<span class="title">Number of Items</span> <span class="description">Select the number of items to display.',
className:"display blog gallery events products unknown"}},{ctor:b.Squarespace.DialogFields.Slider,required:!0,config:{name:"pageSize",range:[1,30],labelWidth:10,submitOnEnter:!0,className:"display blog gallery events products unknown"}},{ctor:b.Squarespace.DialogFields.Description,config:{text:'<span class="title">Primary Information to Display</span>'}},{ctor:b.Squarespace.DialogFields.Check,name:"showTitle",config:{"strings.title":"Title"},className:"display blog gallery events products unknown"},
{ctor:b.Squarespace.DialogFields.Check,name:"showThumbnail",config:{"strings.title":"Thumbnail"},className:"display blog gallery events products unknown"},{ctor:b.Squarespace.DialogFields.Check,name:"showExcerpt",config:{"strings.title":"Excerpt"},className:"display blog gallery events products unknown"},{ctor:b.Squarespace.DialogFields.Check,name:"showReadMoreLink",config:{"strings.title":"Read More Link"},className:"display blog unknown"},{ctor:b.Squarespace.DialogFields.Check,name:"showPrice",
config:{"strings.title":"Price"},className:"display products"},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Event Timeframe",name:"showPastOrUpcomingEvents",className:"display events thin dark",defaultValue:"upcoming",options:[{value:"upcoming",label:"Upcoming"},{value:"past",label:"Past"}]}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Primary Metadata",name:"primaryMetadata",className:"display blog gallery events products unknown thin dark",defaultValue:"none",
options:[]}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Secondary Metadata",name:"secondaryMetadata",className:"display blog gallery events products unknown thin dark",defaultValue:"none",options:[]}},{ctor:b.Squarespace.DialogFields.SummaryFilter,name:"filter"}]}]}}},{ATTRS:{dialogConfig:{valueFn:"_getDefaultDialogConfig",validator:b.Lang.isObject}}})},"1.0",{requires:"base model squarespace-dialog-check squarespace-dialog-content-selector squarespace-dialog-select squarespace-dialog-slider squarespace-dialog-summary-filter squarespace-dialog-text squarespace-model-editor squarespace-models-content-collection".split(" ")});
YUI.add("squarespace-content-item-types-settings",function(b){var d=b.namespace("Squarespace").ContentItemEditorSettings={};d.fields={};b.Squarespace.Utils.isDamaskEnabled()?d.fields.url={ctor:b.Squarespace.DialogFields.Url,config:{name:"urlId",prefix:"{urlPrefix}",filter:"url-slug-with-slash","strings.title":"Post URL","strings.description":"While Squarespace generates URLs for your posts automatically, you can optionally create a custom URL for this post above.","strings.placeholder":"..."}}:d.fields.url=
{type:"text",name:"urlId",prefix:"{urlPrefix}",title:"Post URL",description:"While Squarespace generates URLs for your posts automatically, you can optionally create a custom URL for this post above.",filter:"url-slug-with-slash",style:"thin",icon:"link"};d.fields.author={ctor:b.Squarespace.DialogFields.Select,config:{name:"authorId",prefix:"","strings.title":"Author",className:"thin dark",icon:"user",options:{$valueFn:function(b){var e=[];if(Static.SQUARESPACE_CONTEXT.memberAccountNames)for(var d in Static.SQUARESPACE_CONTEXT.memberAccountNames)e.push({value:d,
label:Static.SQUARESPACE_CONTEXT.memberAccountNames[d].displayName});else e.push({value:0,label:"Automatic"});b.authorId&&!Static.SQUARESPACE_CONTEXT.memberAccountNames[b.authorId]&&(b.author?e.push({label:b.author.displayName,value:b.authorId}):e.push({value:b.authorId,label:""}));return e}},defaultValue:{$valueFn:function(){return Static.SQUARESPACE_CONTEXT.authenticatedAccount.id}}}};d.fields.sourceUrl={ctor:b.Squarespace.DialogFields.Text,config:{name:"sourceUrl",strings:{title:"Source URL",placeholder:"http://...",
description:"Source URLs are often displayed below a blog post, to provide attribution or further reading."},className:"thin"}};d.fields.wysiwyg={ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"body",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:227,classNames:"major"}};d.fields.layout={$when:function(b){return!b.disableLayout},ctor:b.Squarespace.DialogFields.Layout,config:{name:"body",contentItem:{$valueFn:function(b){return b.model},$dontRecurse:!0},itemClass:{$valueFn:function(b){return b.model.name}}}};
d.fields.excerpt={ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"excerpt",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.FULL,editorHeight:147,classNames:"major",title:"Excerpt",description:"Excerpts are used most often on the blog list page."}};d.fields.mainImage={ctor:b.Squarespace.DialogFields.FileImage,contentType:"image",name:"mainImage",width:250,height:250,square:!0,mode:b.Squarespace.UploadModes.ITEM,strings:{title:"Thumbnail Image"}};d.fields.clickthroughUrl={ctor:b.Squarespace.DialogFields.CreateLink,
config:{name:"clickthroughUrl","strings.title":"Clickthrough URL",disableNewWindow:!0}};d.fields.title={ctor:b.Squarespace.DialogFields.Text,countHeight:!0,config:{name:"title",className:"large","strings.placeholder":"Enter a {presentationName|lower} title...","strings.title":{$when:b.Squarespace.Utils.isDamaskEnabled,$value:"Title"}},$when:function(b){return!b.disableTitle}};d.fields.childItemsGrid={ctor:b.Squarespace.DialogFields.ContentItemGrid,config:{name:"gallery",width:300,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?
388:340}},contentItemImageOptions:{showWorkflowState:!1,showActionOverlay:!0,actionOverlayButtons:[b.Squarespace.ActionOverlayButtons.EDIT_IMAGE,b.Squarespace.ActionOverlayButtons.REMOVE_IMAGE]},acceptTypes:["image","video"],uploadPreflight:{$valueFn:function(b){var e=b.model;return function(d){e.get("id")?d():(e.once("save",function(){d()},e),b.editor.autoSave())}}}}};d.fields.tags={ctor:b.Squarespace.DialogFields.Stringset,config:{mode:"input",requestUrl:"/api/commondata/GetAutoCompleteTags",name:"tags",
title:"",maxMemberChars:b.Squarespace.MaxTagLength,addText:"Click to add tags.",emptyText:"No tags added.",memberClass:"tag",editorLabel:"Add Tags",description:"Click to edit tags.",existingMembers:null,collectionId:"{collectionId}"}};d.fields.categories={ctor:b.Squarespace.DialogFields.Stringset,config:{mode:"select",name:"categories",title:"",requestUrl:"/api/commondata/GetCollectionCategories",maxMemberChars:b.Squarespace.MaxCategoryLength,addText:"Click to add categories.",emptyText:"No categories added.",
memberClass:"category",editorLabel:"Pick Categories",description:"Click to choose categories.",existingMembers:null,canAddMembers:!0,addMemberText:"Create Category",collectionId:"{collectionId}"}};d.fields.productVariantsPricingPlaceholder={ctor:b.Squarespace.DialogFields.VariantsPricingPlaceholder,config:{name:"pricingPlaceholder"}};d.fields.productDigitalPricingPlaceholder={ctor:b.Squarespace.DialogFields.DigitalPricingPlaceholder,config:{name:"pricingPlaceholder"}};d.fields.featured={ctor:b.Squarespace.DialogFields.Check,
name:"starred",config:{"strings.title":"Featured Post","strings.description":"Some templates and blocks will highlight posts flagged as featured."}};d.fields.passthrough={ctor:b.Squarespace.DialogFields.Check,name:"passthrough",config:{"strings.title":"Post Title should link to Source URL"}};d.groups={type:"splitter"};d.groups.tagging={type:"stack",fields:[{$include:"fields.tags"},{$include:"fields.categories"}]};d.groups.publishingWorkflow=[{ctor:b.Squarespace.DialogFields.Stateflow,config:{name:"commenting",
allowNever:!0,states:{allow:{title:"Comments On",optionDesc:"Comments are allowed on this entry.",stateDesc:"Disable comments [DURATION]."},disable:{title:"Comments Off",optionDesc:"No comments allowed.",stateDesc:"No comments allowed."}},stateOrder:["allow","disable"]}},{ctor:b.Squarespace.DialogFields.Stateflow,config:{name:"workflow",states:{published:{title:"Published",optionDesc:"Publish this entry now.",stateDesc:"Published on [DATE]."},scheduled:{title:"Scheduled",optionDesc:"Publish this entry in the future.",
stateDesc:"Publish [DURATION]."},needsreview:{title:"Needs Review",optionDesc:"Mark this entry for review.",stateDesc:"Post will be added to review queue."},draft:{title:"Draft",optionDesc:"Save this entry for later editing.",stateDesc:"This post will not be visible."}},stateOrder:["published","scheduled","needsreview","draft"]}}];d.tabs={};d.tabs.primary={};d.tabs.primary.base={fields:[{type:"splitter",countHeight:!0,fields:[{$include:["groups.tagging",{width:0.36}],$update:{tags:{style:"thin"}}},
{$include:"groups.publishingWorkflow",$concat:!0,$update:{".commenting":{width:0.29},".workflow":{width:0.35},statepicker:{direction:"up",style:"minor"}}}]}]};d.tabs.primary.text={icon:b.Squarespace.Rendering.getIconUrl("text",24,"light-solid"),fields:[{$include:"fields.title"},{$include:["fields.layout",{verticalSpan:!0}]}]};d.tabs.primary.image={icon:b.Squarespace.Rendering.getIconUrl("image",24,"light-solid"),fields:[{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.FileImage,disableEdit:{$valueFn:function(c){return b.Lang.isValue(c.model.get("proxyForId"))}},
height:248,constrainMethod:"contain",contentType:"image",mode:b.Squarespace.UploadModes.ITEM,width:0.35,name:"mainImage",uploadMessage:"Click here or drag and drop to add a thumbnail image.",title:"",description:""},{type:"stack",width:0.65,fields:[{$include:["fields.title",{"config.strings.placeholder":"Enter an image title..."}]},{$include:"fields.wysiwyg"}]}]}]};d.tabs.primary.quote={icon:b.Squarespace.Rendering.getIconUrl("quote",24,"light-solid"),fields:[{type:"textarea",height:140,countHeight:!0,
name:"quote",title:"Enter a quote...",titleStyle:"inline",style:"title"},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"body",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.FULL,editorHeight:227,classNames:"major"}}]};d.tabs.primary.link={icon:b.Squarespace.Rendering.getIconUrl("link",24,"light-solid"),fields:[{$include:["fields.title",{"config.strings.placeholder":"Enter a link title..."}]},{$include:["fields.title",{"config.name":"url","config.strings.placeholder":"Enter a link URL..."}]},
{$include:["fields.layout",{verticalSpan:!0}]}]};d.tabs.primary.video={icon:b.Squarespace.Rendering.getIconUrl("video",24,"light-solid"),fields:[{type:"splitter",fields:[{type:"stack",width:0.3,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{name:"customThumbDescription",text:"<strong>Custom Thumbnail</strong> Upload an image to be used with the image overlay."}},{$include:["fields.mainImage",{"strings.title":"",height:220,contentLabel:"video thumbnail"}]},{ctor:b.Squarespace.DialogFields.Description,
config:{name:"automaticThumbDescription",text:""}},{name:"overlay",ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Use Thumbnail"}}]},{type:"stack",width:0.7,fields:[{ctor:b.Squarespace.DialogFields.Oembed,config:{name:"oembed",filter:"video","strings.description":"<strong>Paste the URL</strong> of a video (Vimeo, YouTube, Animoto, Wistia, etc.) you'd like to embed, and Squarespace will attempt to locate and format this video for your site."}},{$include:"fields.title"},{$when:function(b){return d.tabs.primary.video.isLayoutField(b.body)},
$include:["fields.layout",{height:190}]},{$when:function(b){return!d.tabs.primary.video.isLayoutField(b.body)},$include:["fields.wysiwyg",{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"body",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:217,classNames:"major"}}]}]}]}],isLayoutField:function(c){return b.Lang.isValue(c)&&b.Lang.isValue(c.layout)||"4fa14d3ce4b08a53fa26468e"===Static.SQUARESPACE_CONTEXT.website.id}};d.tabs.primary.event={icon:b.Squarespace.Rendering.getIconUrl("event",
32,"light-solid"),fields:[{$include:["fields.title",{title:"Enter a event title.."}]},{type:"splitter",countHeight:!0,fields:[{ctor:b.Squarespace.DialogFields.DateTimePicker,config:{name:"startDate",direction:"down",width:0.5,"strings.title":"","strings.description":"Start on [DATE].",dateFormat:"%a, %b %d %Y at %I:%M%p"}},{ctor:b.Squarespace.DialogFields.DateTimePicker,config:{name:"endDate",direction:"down",width:0.5,dateFormat:"%a, %b %d %Y at %I:%M%p","strings.title":"","strings.description":"End on [DATE].",
"strings.errorMessage":"End time must be later than start time.",validator:function(b){var e=this.get("dialog").getField("startDate").get("data");return null===b?!0:b<e?!1:!0}}}]},{$include:["fields.layout",{verticalSpan:!0}]}]};d.tabs.primary.gallery={icon:b.Squarespace.Rendering.getIconUrl("gallery",24,"light-solid"),fields:[{$include:"fields.title"},{$include:["fields.childItemsGrid",{"config.width":739,"config.height":135}]},{$include:["fields.layout",{height:150}]}]};d.tabs.primary.audio={icon:b.Squarespace.Rendering.getIconUrl("audio",
24,"light-solid"),fields:[{type:"splitter",height:600,fields:[{type:"stack",width:0.35,fields:[{ctor:b.Squarespace.DialogFields.FileAudio,disableEdit:{$valueFn:function(c){return b.Lang.isValue(c.model.get("proxyForId"))}},height:248,constrainMethod:"contain",contentType:"audio",mode:b.Squarespace.UploadModes.ITEM,name:"audioTrack",uploadMessage:"Click here or drag and drop to add an audio track."},{$include:["fields.title",{"config.name":"artistName","config.strings.title":"Artist Name","config.strings.placeholder":"Enter an artist name...",
"config.className":"thin","config.submitOnEnter":!0}]}]},{type:"stack",width:0.65,height:600,fields:[{$include:["fields.title",{"config.submitOnEnter":!0,"config.strings.placeholder":"Enter an {presentationName|lower} title..."}]},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"body",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:300,classNames:"major"}}]}]}]};d.tabs.panel={};d.tabs.panel.primary={fields:[{$include:"fields.tags"},{$include:"fields.categories"},{ctor:b.Squarespace.DialogFields.StateManager,
config:{name:"commenting",allowNever:!0,states:{allow:{title:"Comments On",optionDesc:"Comments are allowed on this entry.",stateDesc:"Disable comments [DURATION]."},disable:{title:"Comments Off",optionDesc:"No comments allowed.",stateDesc:"No comments allowed."}},stateOrder:["allow","disable"]}},{ctor:b.Squarespace.DialogFields.StateManager,config:{name:"workflow",states:{published:{title:"Published",optionDesc:"Publish this entry now.",stateDesc:"Published on [DATE]."},scheduled:{title:"Scheduled",
optionDesc:"Publish this entry in the future.",stateDesc:"Publish [DURATION]."},needsreview:{title:"Needs Review",optionDesc:"Mark this entry for review.",stateDesc:"Post will be added to review queue."},draft:{title:"Draft",optionDesc:"Save this entry for later editing.",stateDesc:"This post will not be visible."}},stateOrder:["published","scheduled","needsreview","draft"]}}]};d.tabs.primary.product={};d.tabs.primary.product.base={icon:b.Squarespace.Rendering.getIconUrl("products",32,"light"),fields:[{type:"splitter",
fields:[{type:"stack",width:0.38,verticalSpan:!0,fields:[{$include:"fields.childItemsGrid"}]},{type:"stack",width:0.62,verticalSpan:!0,fields:[{$include:["fields.title",{"config.strings.placeholder":"Enter a {presentationName|lower} name..."}]},{name:"pricingPlaceholder"},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"excerpt",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.FULL,editorHeight:185,classNames:"major",title:"Brief Description"}}]}]},{type:"splitter",fields:[{$include:["groups.tagging",
{width:0.39}]},{ctor:b.Squarespace.DialogFields.Stateflow,direction:"up",style:"minor",name:"workflow",width:0.5,states:{published:{title:"Available",optionDesc:"This product is currently available for sale.",stateDesc:"Released on [DATE]."},scheduled:{title:"Scheduled",optionDesc:"This product is scheduled to become available later.",stateDesc:"For sale [DURATION]."},draft:{title:"Not Listed",optionDesc:"Hide this from being listed in your store.",stateDesc:"This product will not be available for purchase."}},
stateOrder:["published","scheduled","draft"]}]}]};d.tabs.product={};d.tabs.product.variantsPhysical={tabTitle:"Pricing & Variants",name:"variants_tab",fields:[{ctor:b.Squarespace.DialogFields.VariantsTable,config:{name:"variants",isPhysical:!0,measurementStandard:{$valueFn:function(b){return Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.measurementStandard}}}}]};d.tabs.product.variantsService={tabTitle:"Pricing & Variants",name:"variants_tab",fields:[{ctor:b.Squarespace.DialogFields.VariantsTable,
config:{name:"variants",isPhysical:!1}}]};d.tabs.product.upload={tabTitle:"Pricing & Upload",name:"variants_tab",fields:[{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.File,config:{name:"digitalGoods",title:"Digital Goods",contentType:"file",recordType:b.Squarespace.RecordType.DIGITALGOOD,childAsset:!0,mode:b.Squarespace.UploadModes.CHILD,maxSize:300,childType:b.Squarespace.ChildGroups.DIGITAL_GOODS,constrainMethod:"contain",height:200,width:0.27,description:"Customers will receive this file after purchase.",
preflight:{$valueFn:function(c){var e=c.model;return function(d){var g=c.editor,h=g.get("dialog").getField("digitalGoods"),k=h.get("data"),l=function(){k.set("parentId",e.get("id"));h.refreshItemPostData()};e.get("id")?(b.Lang.isValue(k)&&!k.get("parentId")&&l(),e.clearChildGroup("digitalGoods",d)):(e.once("save",function(){l();d&&d()}),g.autoSave())}}}}},{type:"stack",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.MoneyText,width:0.5,name:"priceCents","strings.title":"Price"},{ctor:b.Squarespace.DialogFields.MoneyText,
width:0.5,name:"salePriceCents","strings.title":"Sale Price"},{ctor:b.Squarespace.DialogFields.Check,width:0.5,name:"onSale",config:{"strings.title":"On Sale","strings.description":"Charge customers the sale price."}}]}]}]};d.tabs.product.additionalInfo={tabTitle:"Additional Info",name:"additionalInfo",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Additional Info",text:"Put additional info on your product page: a longer description, videos, or other content.",padding:[0,10]}},
{$include:["fields.layout",{height:310}]}]};d.tabs.product.workflow={tabTitle:"Workflow",name:"workflow",fields:[{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{width:0.5,name:"additionalInformationDescription",title:"Collect Additional Information",text:"Use this area to create a custom checkout workflow. Selecting a form to the right will require users to fill out that form when adding this product to their cart. Forms created here can be used across multiple products."}},
{ctor:b.Squarespace.DialogFields.FormSelector,config:{width:0.5,name:"additionalFieldsFormId",formType:b.Squarespace.FormType.PRODUCT}}]}]};d.tabs.options={};d.tabs.options["default"]={tabTitle:"Options",name:"options",scroll:!0,fields:[{type:"splitter",countHeight:!0,fields:[{$include:["fields.mainImage",{width:0.4}]},{type:"stack",width:0.6,fields:[{$include:"fields.url"},{$include:"fields.author"},{$include:"fields.sourceUrl"},{$include:"fields.passthrough",$when:function(b){return b.enablePassthrough}}]}]},
{$include:"fields.excerpt",$when:function(b){return b.enableExcerpt}},{$include:"fields.featured",$when:function(b){return b.enableFeatured}}]};d.tabs.options.image=b.merge(d.tabs.options["default"],{fields:[{type:"stack",fields:[{type:"splitter",fields:[{$include:["fields.url",{width:0.6}]},{$include:["fields.author",{width:0.4}]}]},{type:"splitter",fields:[{$include:["fields.sourceUrl",{"config.width":0.6}]},{$include:["fields.clickthroughUrl",{"config.width":284}]}]}]}]});d.tabs.options.video=
d.tabs.options.audio=b.merge(d.tabs.options["default"],{fields:[{type:"stack",fields:[{type:"splitter",fields:[{$include:["fields.url",{width:0.6}]},{$include:["fields.author",{width:0.4}]}]},{$include:"fields.sourceUrl"},{$include:"fields.excerpt"}]}]});d.tabs.options.product=b.merge(d.tabs.options["default"],{fields:[{type:"splitter",fields:[{$include:["fields.mainImage",{width:0.35}]},{type:"stack",width:0.65,fields:[{$include:["fields.url",{title:"Product URL"}]},{ctor:b.Squarespace.DialogFields.Check,
config:{name:"useCustomAddButtonText","strings.title":"Use Custom Add Button Label","strings.description":'Default button label is "Add To Cart" and "Purchase" when express checkout is enabled.'}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"customAddButtonText"}},{ctor:b.Squarespace.DialogFields.Check,name:"starred",config:{"strings.title":"Featured Product","strings.description":'Some templates and blocks will highlight products marked as "featured".'}}]}]}]});d.tabs.location={tabTitle:"Location",
name:"Location",fields:[{ctor:b.Squarespace.DialogFields.Map,config:{name:"location",title:"Enter a location...",titleStyle:"inline",height:400}}]};d.tabs.social={tabTitle:"Social",name:"social",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Social",text:"Select the accounts below you would like to update when you post this item.",padding:[0,10]}},{name:"shareStates",ctor:b.Squarespace.DialogFields.ItemPush,config:{pushedServices:{$valueFn:function(b){return b.pushedServices}},
published:{$valueFn:function(c){return c.workflowState===b.Squarespace.WorkflowStates.PUBLISHED}},pendingPushedServices:{$valueFn:function(b){return b.pendingPushedServices}},models:{$valueFn:function(){return b.Squarespace.Singletons.ConnectedAccounts},$dontRecurse:!0}}}]};d.buttons=[{type:"cancel",title:"Cancel"},{type:"remove",title:"Delete"},{$value:{type:"duplicate",title:"Duplicate"},$when:function(c){var e=c.productType;return!c.unsaved&&c.recordType==b.Squarespace.Enums.RecordType.STORE_ITEM&&
(e==b.Squarespace.ProductTypes.PHYSICAL||e===b.Squarespace.ProductTypes.SERVICE)}},{type:"saveAndClose",title:"Save"},{$value:{type:"saveAndPublish",className:"saveAndPublish",title:"Save & Publish"},$when:function(c){return-1!==[b.Squarespace.WorkflowStates.DRAFT,b.Squarespace.WorkflowStates.NEEDS_REVIEW].indexOf(c.workflowState)}}]},"1.0",{requires:"squarespace-dialog-fields squarespace-dialog-fields-generators squarespace-dialog-stateflow squarespace-dialog-stringset squarespace-dialog-datetime-picker squarespace-dialog-content-item-grid squarespace-dialog-text squarespace-dialog-create-link squarespace-dialog-map squarespace-dialog-html squarespace-external-link-tab squarespace-tab-view squarespace-file-manager-tab squarespace-existing-content-link-tab squarespace-dialog-file-image squarespace-dialog-file-audio squarespace-block-base squarespace-dialog-digital-pricing-placeholder squarespace-dialog-variants-pricing-placeholder squarespace-dialog-pricing-placeholder squarespace-dialog-variants-table squarespace-dialog-item-push squarespace-models-connected-accounts squarespace-dialog-form-builder squarespace-dialog-form-preview squarespace-dialog-check squarespace-dialog-select squarespace-dialog-form-selector squarespace-dialog-description squarespace-dialog-layout squarespace-dialog-oembed squarespace-dialog-state-manager squarespace-dialog-wysiwyg squarespace-enum".split(" ")});
YUI.add("squarespace-block-foursquare-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");b.namespace("Squarespace.Block.Editor").Foursquare=b.Base.create("foursquare-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Foursquare")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Foursquare"}}});b.Squarespace.Block.ModelEditorDialog.Foursquare=b.Base.create("FoursquareSummaryModelEditorDialog",
b.Squarespace.Block.ModelEditorDialog.SocialSummary,[],{},{ATTRS:{icon:{value:"foursquare"},type:{value:b.Squarespace.BlockType.FOURSQUARE},socialAccountType:{value:b.Squarespace.ExternalServiceProviders.FOURSQUARE},collectionType:{value:b.Squarespace.CollectionTypes.FOURSQUARE},strings:{value:{name:"Foursquare",itemTypePlural:"Check-ins",itemType:"Check-in"}}}})},"1.0",{requires:"base model squarespace-block-foursquare-model squarespace-block-summary-model-editor squarespace-damask-context-globals squarespace-dialog-select squarespace-dialog-button squarespace-dialog-slider squarespace-model-editor".split(" ")});
YUI.add("squarespace-settings-activity-mixin-accordion",function(b){b.namespace("Squarespace.Settings.Activity");b.Squarespace.Settings.Activity.MixinAccordion=b.Base.create("mixinAccordion",b.Base,[],{initializer:function(){b.Do.before(this._destroyAccordion,this,"clearElements",this)},destructor:function(){this._destroyAccordion()},_destroyAccordion:function(){b.Lang.isValue(this.accordionWidget)&&(this.accordionWidget.destroy(),this.accordionWidget=null)},renderChartAccordionPanel:function(d,c){var e=
this.get("contentBody"),f=b.Node.create('<div class="chart-container clear">'),g=b.Node.create('<div class="summary pie clear">'),h=b.Node.create('<div class="detail padtop sub-stats-accordion">'),k=this.renderSummary(d.totalCount,null,null,"Total Page Views");c=b.merge({panelTitle:"",countTitle:"",countAttr:"",descriptionTitle:"",descriptionAttr:"",subCountAttr:"",subDescriptionAttr:"",chartFn:function(){}},b.Lang.isObject(c)?c:{});this._isDataEmpty(d)||this._addAccordion(d.summaries,c,h);g.append(k);
e.append(f).append(g).append(h);c.chartFn.apply(this,[d,f])},_addAccordion:function(d,c,e){this.accordionWidget=new b.Squarespace.Accordion;var f=b.Node.create(b.Lang.sub('<div class="table"><div class="head"><div class="row clear"><div class="cell first-column data">{firstCellText}</div><div class="cell">{lastCellText}</div></div></div></div>',{firstCellText:c.countTitle,lastCellText:c.descriptionTitle}));b.Array.each(d,function(e,d){var k=b.Node.create('<div class="accordion-container"></div>'),
l=b.Node.create('<div class="accordion-header"></div>'),p=b.Node.create('<div class="accordion-body"></div>'),q=b.Node.create('<div class="body"></div>'),r=b.Node.create(b.Lang.sub('<div class="row clear"><div class="cell first-column data">{firstCellText}</div><div class="cell text">{lastCellText}</div></div>',{firstCellText:this.formatNumber(e[c.countAttr]),lastCellText:e[c.descriptionAttr]})),s;q.append(r);f.append(q);if("Direct"===e.domain)r.one(".text").addClass("direct");else{b.Lang.isString(e.domain)||
(e.domain="");s=b.Node.create('<div class="sub-body" id="referrerSource-'+d+'"></div>');if(b.Lang.isArray(e.subStatistics)){b.Array.each(e.subStatistics,function(b){s.append(this._getSubRow(b,c,e.domain))},this);for(var t="",u=Math.min(e.subStatistics.length,4);0<u;--u)t+="&bull;";r.append(b.Node.create('<div class="cell indicator">'+t+"</div>"))}l.append(q);p.append(s);k.append(l);k.append(p);this.accordionWidget.add(k)}},this);e.append(f);this.accordionWidget.render(f)},_getSubRow:function(d,c,
e){return b.Node.create(b.Lang.sub('<div class="row clear"><div class="cell first-column data">{count}</div><div class="cell text" colspan="2"><span>&bull;<a href="{href}" target="_blank">{link}</a></span></div></div>',{count:d[c.subCountAttr],href:"http://"+e+d[c.subDescriptionAttr],link:"http://"+e+this.trimEnd(d[c.subDescriptionAttr])}))}},{})},"1.0",{requires:["base","squarespace-accordion"]});
YUI.add("squarespace-dialog-cancel-order-restock",function(b){b.namespace("Squarespace.DialogFields");b.Squarespace.DialogFields.CancelOrderRestock=b.Base.create("order-history",b.Squarespace.DialogField2,[],{renderUI:function(){b.Squarespace.DialogFields.CancelOrderRestock.superclass.renderUI.call(this);var d=this.get("contentBox");b.Lang.isValue(d.one(".missing"))&&(this.missingToolTip=new b.Squarespace.ToolTip({target:".missing",title:"Product Missing",body:"This product no longer exists in your inventory and cannot be restocked.",
hoverToShow:!0,alwaysEnable:!0,dialogTooltip:!0}));b.Lang.isValue(d.one(".unlimited"))&&(this.unlimitedToolTip=new b.Squarespace.ToolTip({target:".unlimited",title:"Unlimited Inventory",body:"This product has unlimited inventory and cannot be restocked.",hoverToShow:!0,alwaysEnable:!0,dialogTooltip:!0}))},destructor:function(){b.Lang.isValue(this.missingToolTip)&&this.missingToolTip.destroy();b.Lang.isValue(this.unlimitedToolTip)&&this.unlimitedToolTip.destroy()},_getHBTemplateContext:function(){return b.Array.map(this.get("data").order.purchasedCart.entries,
this._createRestockListItem,this)},_createRestockListItem:function(b){return{productName:b.title,variantDescription:this._variantDescriptionFormat(b.chosenVariant),restockQuantity:this._restockQuantityFormat(b),nonRestockableReason:this._nonRestockableReason(b),nonRestockableIndicatorClass:this._nonRestockableReason(b)}},_variantDescriptionFormat:function(d){return b.Lang.isValue(d)?b.Squarespace.Commerce.variantFormat(d):null},_restockQuantityFormat:function(b){return"+"+b.quantity},_nonRestockableReason:function(b){return!0===
b.restockableStatus.missing?"missing":!0===b.restockableStatus.unlimited?"unlimited":null}},{CSS_PREFIX:"sqs-cancel-order-restock",HANDLEBARS_TEMPLATE:"dialog-cancel-order-restock.html"})},"1.0.0",{requires:["squarespace-dialog-field-2","squarespace-util","squarespace-commerce-utils","squarespace-dialog-cancel-order-restock-template"]});
YUI.add("squarespace-block-product",function(b){var d=b.namespace("Squarespace.Block").Product=b.Base.create("block-product",b.Squarespace.Block.ModelSyncBase,[],{_renderSuccess:function(b){d.superclass._renderSuccess.call(this,b);this._plugImageLoader()}},{CSS_PREFIX:"sqs-block-product",MODEL:b.Squarespace.ContentModel.ProductBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Product},type:{value:b.Squarespace.BlockType.PRODUCT}}})},"1.0",{requires:["squarespace-enum","squarespace-image-loader",
"squarespace-block-base-modelsync","squarespace-block-product-model","squarespace-block-product-editor"]});
YUI.add("squarespace-markdown-editor",function(b){b.namespace("Squarespace");b.Squarespace.MarkdownEditor=b.Base.create("markdownEditor",b.Squarespace.TextEditor,[],{initializer:function(){this._editorNode=b.one(this.editor.getWrapperElement());this._initializeLinkFlyout()},execCommand:function(b,c){var e=!0;switch(b){case "bold":this._toggleSurroundSelection("**");break;case "link":this._showLinkFlyout(this._findLinkId(),!0);e=!1;break;case "italic":this._toggleSurroundSelection("*");break;case "heading":this._toggleHeading(c);
break;case "insertorderedlist":this._toggleSurroundSelection("1. ","",!0);break;case "insertunorderedlist":this._toggleSurroundSelection("* ","",!0);break;case "blockquote":this._toggleSurroundSelection("> ","",!0)}e&&this.editor.focus()},_initializeLinkFlyout:function(){this._linkEdit=new b.Squarespace.Flyout.LinkEdit({disableNewWindow:!0,panedlAnimDuration:0});this._linkEdit._editPanel.get("boundingBox").setStyle("position","fixed");this._linkEdit._promptPanel.get("boundingBox").setStyle("position",
"fixed");this._linkEdit.on("dataChange",function(d){d=d.newVal;b.Lang.isUndefined(d.linkUrl)||this._cmLink(d.linkId||0,d.linkUrl)},this);this._linkEdit.on("unlink",function(b){this._cmLink(b.linkId||0,"")},this);this._editorNode.after("mouseup",b.bind(function(b){var c=this._findLinkId();"0"!==c&&this._lastSeenLinkId!==c?(b.halt(),this._lastSeenLinkId=c,this._showLinkFlyout(c,!1)):(this._lastSeenLinkId="",this._linkEdit.close(!0))},this))},_findLinkId:function(){var d=b.clone(this.editor.getCursor()),
c=b.clone(this.editor.getTokenAt(d));if("link"===c.className){for(;"]"!==(!c.string?c.string:c.string.substring(c.string.length-1));)c=this.editor.getTokenAt({line:d.line,ch:c.end+1});c=this.editor.getTokenAt({line:d.line,ch:c.end+1});if("string"===c.className&&/\[([^\[]+)\]/.test(c.string))return RegExp.$1}return"0"},_showLinkFlyout:function(d,c){var e=b.one(".field-wysiwyg-control"),f;if(d){var g=this.editor.getValue();RegExp("\\n\\s*\\["+d+"\\]\\s*:\\s*([^'\"(\\n]+)[^\\n]*").test(g)&&(f=RegExp.$1)}c?
this._linkEdit.openEdit(e,f,d):this._linkEdit.openPrompt(e,f,d)},_cmHeading:function(d){var c=b.clone(this.editor.getCursor(!0)),e;this.editor.somethingSelected()?(e=this.editor.getSelection(),e=e.split(/[\r\n]{1,2}/)[0]):(e=this.editor.getLine(c.line),c.ch=0,this.editor.setSelection(c,{line:c.line,ch:1E6}));d=["_","=","-","`"][d];d=Array(Math.max(e.length+1,3)).join(d);0<c.ch?(this.editor.replaceSelection("\n\n"+e+"\n"+d+"\n"),this.editor.setSelection({line:c.line+2,ch:0},{line:c.line+2,ch:1E6})):
(this.editor.replaceSelection(e+"\n"+d+"\n"),this.editor.setSelection({line:c.line,ch:0},{line:c.line,ch:1E6}))},_cmUnheading:function(){var d=b.clone(this.editor.getCursor(!0)).line;if(/^[=\-]{3,}/.test(this.editor.getLine(d+1))){var c=/^\w*$/.test(this.editor.getLine(d+2));this.editor.setSelection({line:d,ch:1E6},{line:d+1+c,ch:1E6});this.editor.replaceSelection("");this.editor.setSelection({line:d,ch:0},{line:d,ch:1E6});return!0}return!1},_toggleHeading:function(b){this._cmUnheading()||this._cmHeading(b)},
_cmSurround:function(d,c,e){c=b.Lang.isUndefined(c)?d:c;var f=b.clone(this.editor.getCursor(!0)),g=b.clone(this.editor.getCursor(!1)),h=this.editor.getSelection();if(e){if(f.line!==g.line){e=f.line;for(h=g.line+1;e<h;e++)this.editor.setSelection({line:e,ch:0}),this._cmSurround(d,c,!0);this.editor.setSelection({line:f.line,ch:0},{line:g.line,ch:1E6});return}e=this.editor.getLine(f.line);var h=b.clone(this.editor.getCursor(!0)),k=b.clone(this.editor.getCursor(!1));h.ch=Math.max(e.search(/\S/),0);k.ch=
e.length;this.editor.setSelection(h,k);h=e.substr(Math.max(0,h.ch))}f.ch+=d.length;g.ch+=d.length;this.editor.replaceSelection(d+h+c);this.editor.setSelection(f,g)},_cmUnsurround:function(d,c,e){c=b.Lang.isUndefined(c)?d:c;var f=b.clone(this.editor.getCursor(!0)),g=b.clone(this.editor.getCursor(!1));if(e){if(f.line!==g.line){e=!1;for(var h,k=f.line,l=g.line+1;k<l;k++)this.editor.setSelection({line:k,ch:0},{line:k,ch:0}),e=(h=this._cmUnsurround(d,c,!0))||e;this.editor.setSelection({line:f.line,ch:0},
{line:g.line,ch:1E6});return e}e=this.editor.getLine(f.line);f.ch=e.search(/\W/);g.ch=e.length}f.ch=Math.max(0,f.ch-d.length);g.ch+=c.length;e=this.editor.getRange(f,g);h=e.length-c.length;return e.slice(0,d.length)==d&&e.slice(h)==c?(this.editor.setSelection(f,g),this.editor.replaceSelection(e.slice(d.length,h)),!0):!1},_toggleSurroundSelection:function(b,c,e){this._cmUnsurround(b,c,e)||this._cmSurround(b,c,e)},_cmLink:function(d,c){var e=!1,f=b.clone(this.editor.getCursor(!0)),g=b.clone(this.editor.getCursor(!1)),
h,k;if(c)if("0"===d){this._cmSurround("[","][0]");f.ch++;g.ch++;e=g.line;h="\n[0]: "+c;do if(e++,k=this.editor.getLine(e),b.Lang.isUndefined(k)){this.editor.replaceRange("\n"+h,{line:e,ch:0});break}else if(b.Squarespace.StringUtils.isBlank(k)){(k=this.editor.getLine(e+1))&&(k[0]&&"["!==k[0])&&(h+="\n");this.editor.replaceRange(h,{line:e,ch:0});break}while(k);h=this.editor.getValue();e=!0}else k=RegExp("(\\n\\s*\\["+d+"\\]\\s*:\\s*)[^'\"(\\n]+([^\\n]*)"),h=this.editor.getValue(),h=h.replace(k,"$1"+
c+"$2");else k=RegExp("(?:\\[([^\\]]+)\\]\\s*\\["+d+"\\])|(?:^\\s*\\["+d+"\\]\\s*:.*$(?:\\n$)?)","gm"),h=this.editor.getValue(),h=h.replace(k,"$1"),f.ch--,g.ch--,e=!0;if(e){var l=0,p={};h.replace(/\]\s*\[(\d{1,3})\]/g,function(b,c){p[c]||(l+=1,p[""+c]=l);return b});h=h.replace(/\[(\d{1,3})\]/g,function(b,c){return"["+(p[c]||c)+"]"});"0"===d&&this._linkEdit.set("linkId",p[d])}this.editor.setValue(h);this.editor.setSelection(f,g)}},{ATTRS:{mode:{value:"code"},height:{value:-1}}})},"1.0",{requires:["squarespace-string-utils",
"squarespace-text-editor"]});
YUI.add("squarespace-models-member-invite",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.MemberInvite=b.Base.create("MemberInvite",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.REST_API_ROOT+"member-invites",url:b.Squarespace.REST_API_ROOT+"member-invites/{id}",toJSON:function(){var c=d.superclass.toJSON.call(this);c.permissions=b.Object.keys(c.permissions);return c}},{ATTRS:{id:{value:null,validator:b.Lang.isString},inviteCode:{value:null,validator:b.Lang.isString},
name:{value:null,validator:b.Lang.isString},email:{value:null,validator:b.Lang.isString},permissions:{value:{},validator:b.Lang.isObject},createdOn:{value:null,validator:b.Lang.isNumber},lastSentOn:{value:null,validator:b.Lang.isNumber}}});b.Squarespace.Models.MemberInviteList=b.Base.create("MemberInviteList",b.ModelList,[b.Squarespace.ModelSync.REST],{model:b.Squarespace.Models.MemberInvite})},"1.0",{require:["base","model","model-list","squarespace-model-sync-rest","squarespace-util"]});
YUI.add("squarespace-models-navigation",function(b){var d=b.Base.create("NavigationItem",b.Model,[],{initializer:function(){if(this.get("collection"))this.get("collection").on("navigationTitleChange",function(b){this.set("title",b.newVal)},this)},sync:function(b,c,e){console.log(this.name+" | sync called with action "+b+" and options ",c);"delete"==b?this.get("collection")?this.get("collection").destroy({remove:!0}):this.getNavigationItemList().save(c,e):("create"==b||"save"==b)&&this.getNavigationItemList().save(c,
e)},destroy:function(c,e){var d=this;"function"===typeof c&&(e=c,c=null);d.onceAfter("destroy",function(){function k(e){e||b.Array.each(d.lists.concat(),function(b){b.remove(d,c)})}c&&(c.remove||c["delete"])?(k(),d.sync("delete",c,function(){e&&e.apply(null,arguments)})):(k(),e&&e.apply(null,arguments))});return this.constructor.superclass.destroy.call(d)},toJSON:function(b){var c=this.constructor.superclass.toJSON.call(this);b?delete c.collection:c.collection&&(c.collection=c.collection.toJSON());
c.children&&(c.items=c.children.toJSON(b),delete c.children);return c},isFolder:function(){if(this.get("collectionId")&&!this.get("children").isEmpty())return!0;if(this.get("collection")){var b=this.get("collection").getTemplateConfiguration();return b&&b.get("folder")?!0:!1}},_setChildren:function(c){if(c){this.get("collectionId")&&(this.get("collection")&&this.get("collection").get("type")==b.Squarespace.CollectionTypes.TEMPLATE_PAGE)&&(c=[]);var d;b.Lang.isArray(c)?d=new e:b.instanceOf(c,e)&&(d=
c,d.setTemplateNavigation(this.getNavigationItemList().getTemplateNavigation()));d&&this._navigationItemList&&(d.setTemplateNavigation(this._navigationItemList.getTemplateNavigation()),d.setNavigationItemList(this._navigationItemList));if(!d)throw"Can't set navigation that isn't an instanceOf FolderItemList.";b.Lang.isArray(c)&&0!==c.length&&(d.setTemplateNavigation(this.getNavigationItemList().getTemplateNavigation()),b.Array.each(c,function(b){var c=b.children;c&&delete b.children;b=d.add(b);c&&
b.set("children",c)}));return d}},setNavigationItemList:function(b){if("NavigationItemList"!==b.name)throw"Cant set a navigationitemlist that isnt actually a navigationitemlist";var c=this.get("children");c&&c.setNavigationItemList(b);this._navigationItemList=b},getNavigationItemList:function(){var b=this._navigationItemList;if(!b)throw"No NavigationItemList found. Possible errors with wrapping data.";return b},setFolderItemList:function(c){if(!b.instanceOf(c,e)&&!b.Lang.isNull(c))throw"Cant set a folder ItemList that isn't a folder.";
this._folderItemList=c},getFolderItemList:function(){return this._folderItemList}},{ATTRS:{title:{value:""},collection:{valueFn:function(c){if(this._getAttr("collectionId"))return b.Squarespace.ContentCollectionCache.getCollectionFromData({id:this._getAttr("collectionId"),navigationTitle:this._getAttr("title"),urlId:this._getAttr("urlId"),typeName:this._getAttr("typeName"),enabled:this._getAttr("enabled"),type:this._getAttr("collectionType")})}},icon:{valueFn:function(){return this.get("collectionId")?
b.Squarespace.ContentCollectionUtils.getIconClassNames(this.get("collection")):this.get("externalLink")?"external-link":""}},children:{value:[],lazyAdd:!1,setter:"_setChildren"}}}),c=b.Base.create("NavigationItemList",b.ModelList,[],{model:d,add:function(b,e){return c.superclass.add.apply(this,arguments)},sync:function(c,e,d){console.log(this.name+" | sync called with action "+c+" and options ",e);"update"===c||"create"===c?b.Data.post({json:!0,url:"/api/widget/UpdateNavigation",data:{fieldName:this.getTemplateNavigation().get("name"),
navigation:{items:this.toJSON(!0)},templateId:b.Squarespace.Singletons.Template.get("id")},success:function(b){console.log("response!",b);d&&d()},failure:function(c){(new b.Squarespace.SystemError("Something Went Wrong",c,"json")).show()}}):"function"===typeof d&&d()},initializer:function(){this.each(function(b){this._bootstrapReference(b)},this);this.on(["create","add"],function(b){this._bootstrapReference(b.model)},this)},save:function(c,e){this.sync("update",c,b.bind(function(){this.fire("save");
b.Lang.isFunction(e)&&e()},this))},_bootstrapReference:function(b){b.setNavigationItemList(this)},setTemplateNavigation:function(b){this._templateNavigation=b},getTemplateNavigation:function(){var b=this._templateNavigation;if(!b)throw"TemplateNavigation not found! Possible errors with wrapping data.";return b},toJSON:function(b){return this.map(function(c){return c.toJSON(b)})}}),e=b.Base.create("FolderItemList",c,[],{_bootstrapReference:function(b){b.setNavigationItemList(this.getNavigationItemList());
b.setFolderItemList(this)},sync:function(b,c,e){this.getNavigationItemList().sync(b,c,e)},setNavigationItemList:function(b){if("NavigationItemList"!==b.name)throw"Cant set a navigationitemlist that isnt actually a navigationitemlist";this._navigationItemList=b},getNavigationItemList:function(){var b=this._navigationItemList;if(!b)throw"No NavigationItemList found. Possible errors with wrapping data.";return b}});b.namespace("Squarespace.Models").NavigationItemList=c;b.namespace("Squarespace.Models").NavigationFolderItemList=
e},"1.0",{requires:["squarespace-models-content-collection","squarespace-content-collection-utils"]});
YUI.add("squarespace-model-session",function(b){b.namespace("Squarespace.Models");var d=b.Base.create("Session",b.Model,[],{initializer:function(){},sync:function(b,e,d){switch(b){case "create":console.error("create not implemented.");break;case "delete":this.remove(e,d);break;case "read":console.error("read not implemented.");break;case "update":console.error("update not implemented.")}},remove:function(c,e){b.Data.post({url:"/api/commondata/RemoveSession",data:{uuid:this.get("uuid")},success:function(b){e()},
failure:function(b){e("Failed to remove session id: "+this.get("id"))}},this)}},{ATTRS:{id:{value:null,validator:b.Lang.isString},createdOn:{value:null,validator:b.Lang.isNumber},lastedUsed:{value:null,validator:b.Lang.isNumber},browserDisplayName:{value:null,validator:b.Lang.isString},osDisplayName:{value:null,validator:b.Lang.isString},uuid:{value:null,validator:b.Lang.isString},remoteIP:{value:null,validator:b.Lang.isString},currentSession:{value:null,validator:b.Lang.isBoolean}}});b.Squarespace.Models.SessionList=
b.Base.create("SessionList",b.ModelList,[],{model:d,comparator:function(b){return-1*parseInt(b.get("createdOn"),10)},sync:function(c,e,d){"read"===c?b.Data.get({url:"/api/commondata/GetSessions",success:function(b){d(null,b)},failure:function(b){}}):d("Unsupported sync action: "+c)}})},"2.1",{requires:["base","model-list"]});
YUI.add("squarespace-tiny-social-account",function(b){var d={facebook:"/universal/images-v6/icons/icon-facebook-18-color.png",instagram:"/universal/images-v6/icons/icon-instagram-18-color.png",twitter:"/universal/images-v6/icons/icon-twitter-18-color.png",dropbox:"/universal/images-v6/icons/icon-dropbox-18-color.png",googleauth2:"/universal/images-v6/icons/icon-google-18-color.png",google:"/universal/images-v6/icons/icon-google-18-color.png",tumblr:"/universal/images-v6/icons/icon-tumblr-18-color.png",
flickr:"/universal/images-v6/icons/icon-flickr-18-color.png",foursquare:"/universal/images-v6/icons/icon-foursquare-18-color.png",vimeo:"/universal/images-v6/icons/icon-vimeo-18-color.png",youtube:"/universal/images-v6/icons/icon-youtube-18-color.png",linkedin:"/universal/images-v6/icons/icon-linkedin-18-color.png",smugmug:"/universal/images-v6/icons/icon-smugmug-16-color.png",dribbble:"/universal/images-v6/icons/icon-dribbble-16-color.png",fivehundredpix:"/universal/images-v6/icons/icon-fivehundredpix-16-color.png",
pinterest:"/universal/images-v6/icons/icon-pinterest-16-color.png",email:"/universal/images-v6/icons/icon-email-16-light.png",github:"/universal/images-v6/icons/icon-github-16-light.png"},c={facebook:"Facebook",instagram:"Instagram",twitter:"Twitter",dropbox:"Dropbox",google:"Google",googleauth2:"Google",tumblr:"Tumblr",flickr:"Flickr",foursquare:"Foursquare",vimeo:"Vimeo",youtube:"Youtube",linkedin:"LinkedIn",smugmug:"SmugMug",dribbble:"Dribbble",pinterest:"Pinterest",fivehundredpix:"500px",email:"Email",
github:"Github"};b.Handlebars.registerHelper("icon-url",function(b){return d[b.serviceName]});b.Handlebars.registerHelper("service-display-name",function(b){var d=c[b.serviceName];d||(d=b.screenname);return d});b.namespace("Squarespace.Widgets").TinySocialAccount=b.Base.create("tinySocialAccount",b.Squarespace.Widgets.SSWidget,[],{},{ATTRS:{account:{}},CSS_PREFIX:"sqs-tiny-social-account",HANDLEBARS_TEMPLATE:"tiny-social-account.html"})},"1.0",{requires:["base-build","handlebars-base","squarespace-ss-widget",
"squarespace-tiny-social-account-template"]});
YUI.add("squarespace-widgets-inventory-product-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-inventory-product.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f,h;h={hash:{},data:c};e='\n            <span class="sale-price">'+(r((f=d["money-string"]||b["money-string"],f?f.call(b,b.salePrice,h):s.call(b,"money-string",b.salePrice,h)))+'&nbsp;</span>\n            <span class="price original-price">');h={hash:{},data:c};return e+=r((f=
d["money-string"]||b["money-string"],f?f.call(b,b.price,h):s.call(b,"money-string",b.price,h)))+"</span>\n          "}function p(b,c){var e,f;e={hash:{},data:c};return e='\n            <span class="price">'+(r((f=d["money-string"]||b["money-string"],f?f.call(b,b.price,e):s.call(b,"money-string",b.price,e)))+"</span>\n          ")}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var q,r=this.escapeExpression,s=d.helperMissing,t=this;b='<div class="product-thumbnail">\n  <img src="';
(h=d.imageSrc)?h=h.call(c,{hash:{},data:k}):(h=c.imageSrc,h="function"===typeof h?h.apply(c):h);b+=r(h)+'?format=100w" />\n</div>\n\n<div class="product-body">\n\n  <div class="product-heading">\n    <div class="product-title">'+r((h=(h=c.model,null==h||!1===h?h:h.title),"function"===typeof h?h.apply(c):h))+'</div>\n    <div class="product-status">\n      ';if((q=d["if"].call(c,c.notListed,{hash:{},inverse:t.noop,fn:t.program(1,function(b,c){return'\n        <div class="status not-listed">Not Listed</div>\n      '},
k),data:k}))||0===q)b+=q;b+="\n\n      ";if((q=d["if"].call(c,c.soldOut,{hash:{},inverse:t.noop,fn:t.program(3,function(b,c){return'\n        <div class="status sold-out">Sold Out</div>\n      '},k),data:k}))||0===q)b+=q;b+="\n\n      ";if((q=d["if"].call(c,c.missingDigitalAsset,{hash:{},inverse:t.noop,fn:t.program(5,function(b,c){return'\n        <div class="status missing-digital-asset">Missing Digital Asset</div>\n      '},k),data:k}))||0===q)b+=q;b+="\n\n      ";if((q=d["if"].call(c,c.unsaved,
{hash:{},inverse:t.noop,fn:t.program(7,function(b,c){return'\n        <div class="status unsaved">Unsaved</div>\n      '},k),data:k}))||0===q)b+=q;b+='\n    </div>\n  </div>\n\n  <div class="product-variants">\n\n    <div class="variant-names">\n      ';if((q=d.each.call(c,c.variantNames,{hash:{},inverse:t.noop,fn:t.program(9,function(b,c){var e;return e=""+('\n        <div class="variant-name">'+r("function"===typeof b?b.apply(b):b)+"</div>\n      ")},k),data:k}))||0===q)b+=q;b+='\n    </div>\n\n    <div class="variant-prices">\n      ';
if((q=d.each.call(c,c.variantPrices,{hash:{},inverse:t.noop,fn:t.program(11,function(b,c){var e,f;e='\n        <div class="variant-price">\n          ';if((f=d["if"].call(b,b.onSale,{hash:{},inverse:t.program(14,p,c),fn:t.program(12,l,c),data:c}))||0===f)e+=f;return e+"\n        </div>\n      "},k),data:k}))||0===q)b+=q;b+='\n    </div>\n\n    <div class="variant-stocks">\n      ';if((q=d.each.call(c,c.variantStocks,{hash:{},inverse:t.noop,fn:t.program(16,function(b,c){var e;return e=""+('\n        <div class="variant-stock">'+
r("function"===typeof b?b.apply(b):b)+"</div>\n      ")},k),data:k}))||0===q)b+=q;return b+='\n    </div>\n\n  </div>\n\n</div>\n\n<div class="product-preview-control">\n  <a href="'+r((h=(h=c.model,null==h||!1===h?h:h.fullUrl),"function"===typeof h?h.apply(c):h))+'">\n    <div class="preview-icon-container">\n      <div class="preview-icon"></div>\n    </div>\n  </a>\n</div>'})})();b.Handlebars.registerPartial("widgets-inventory-product.html".replace("/","."),d.templates["widgets-inventory-product.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-editor-collection-settings",function(b){var d=b.namespace("Squarespace").CollectionEditorSettings={};d.fields={};d.fields.navigationTitle={ctor:b.Squarespace.DialogFields.Text,config:{required:!0,submitOnEnter:!0,name:"navigationTitle","strings.title":"Navigation Title","strings.description":"The name for this page, as it appears in navigations.",className:"large"}};d.fields.title={ctor:b.Squarespace.DialogFields.Text,config:{required:!0,submitOnEnter:!0,name:"title","strings.title":"Page Title",
"strings.description":"The name of this page, as it appears in the top of the browser window."}};d.fields.pageLayout={ctor:b.Squarespace.DialogFields.Select,config:{name:"regionName",required:!0,className:"thin dark",options:{$valueFn:function(){var c=[],d=b.Squarespace.Singletons.Template.get("layouts"),g;for(g in d)c.push({label:d[g].name,value:g});return c}},"strings.title":"Page Layout","strings.description":"Page the overall layout for this page."}};d.fields.pageSize={ctor:b.Squarespace.DialogFields.Slider,
required:!0,config:{name:"pageSize",range:[1,20],"strings.suffix":"Post","strings.title":"Posts Per Page","strings.description":"Pick the number of posts that display per page.",pluralize:!0,labelWidth:70,submitOnEnter:!0}};d.fields.description={ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"description",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:187,title:"Description",description:"<strong>Optional.</strong>  A description that will be displayed in search engine listings if this page is indexed by a search engine.",
classNames:"major"}};b.Squarespace.Utils.isDamaskEnabled()?d.fields.urlId={ctor:b.Squarespace.DialogFields.Url,config:{name:"urlId",prefix:"/",filter:"url-slug-with-slash","strings.title":"URL","strings.description":"The unique location slug for this page."}}:d.fields.urlId={type:"text",name:"urlId",prefix:"/",title:"URL",description:"The unique location slug for this page.",fieldStyle:"normal",titleStyle:"top",filter:"url-slug-with-slash",style:"thin",icon:"link"};d.fields.password={ctor:b.Squarespace.DialogFields.Text,
config:{required:!1,password:!0,name:"password","strings.title":"Password","strings.description":"A password required to access this page. Note that certain contributor permissions (Administrator, Content Editor) automatically bypass this password."}};d.fields.mainImage={ctor:b.Squarespace.DialogFields.FileImage,required:!1,height:250,width:250,square:!0,name:"mainImage",autoSaveFocalPoint:!0,contentLabel:"thumbnail image",strings:{title:"Thumbnail Image"},description:"The image to be used to represent this page if it is placed within an index",
fieldStyle:"normal",titleStyle:"top"};d.fields.postByEmailAddress={ctor:b.Squarespace.DialogFields.PostByEmailAddress,config:{name:"postByEmailAddress","strings.title":"Post By Email Address","strings.description":"Emails sent to this address will be posted to the collection. If you need a new email address, press the refresh button on the right of this field.",collection:{$dontRecurse:!0,$valueFn:function(b){return b}},readOnly:!0}};d.fields.bookmarklet={ctor:b.Squarespace.DialogFields.Description,
config:{title:"Quickpost Bookmarklet",padding:[10,0],text:{$valueFn:function(c){return'<div>Drag this link to your browser\'s bookmarks bar to quickly post to this collection:</div> <a class="bookmarklet" href="'+b.Squarespace.Utils.getBookmarkletUrl(c)+'">Post to Squarespace</a>'}},$escape:!0}};d.fields.tags={ctor:b.Squarespace.DialogFields.ContentStatManager,config:{name:"tagcloud",className:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?"light":"dark"}},title:"Tags",maxLength:b.Squarespace.MaxTagLength,
collectionId:{$valueFn:function(b){return b.get("id")}},mode:"tag"}};d.fields.categories={ctor:b.Squarespace.DialogFields.ContentStatManager,config:{name:"tagcloud",className:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?"light":"dark"}},title:"Categories",maxLength:b.Squarespace.MaxCategoryLength,collectionId:{$valueFn:function(b){return b.get("id")}},mode:"category"}};var c=[];c.push({value:b.Squarespace.EventView.LIST,label:"List"});c.push({value:b.Squarespace.EventView.CALENDAR,
label:"Calendar"});d.fields.eventView={ctor:b.Squarespace.DialogFields.Select,config:{name:"eventView","strings.title":"Default Event View",titleStyle:"top",className:"thin dark",defaultValue:b.Squarespace.EventView.LIST,options:c}};d.fields.enabled={ctor:b.Squarespace.DialogFields.Check,config:{name:"enabled",strings:{title:"Enabled",description:"If this page is not enabled, it will not be accessible to non-admin users. It is useful to disable a page while it is being worked on."}}};d.fields.homepage=
{ctor:b.Squarespace.DialogFields.Button,config:{name:"setAsHomepage",strings:{text:"Set as Homepage"}}};d.fields.duplicate={ctor:b.Squarespace.DialogFields.Button,config:{name:"duplicate",strings:{text:"Duplicate Page",description:"Duplicating a Page allows you to quickly generate Pages on your site with the same layout and Content Blocks as the original Page."}}};d.groups={};d.groups.tagsAndCategories=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Manage Tags/Categories",text:"You can use these controls to bulk edit the tags and categories that apply to this collection."}},
{$include:"fields.tags"},{$include:"fields.categories"}];d.groups.categories=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Manage Categories",text:"You can use these controls to bulk edit the categories that apply to this collection."}},{$include:"fields.categories"}];d.groups.codeInjection=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Page Header Code Injection",text:"Enter the code that will be injected onto the header for this page.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.HtmlCode,
config:{name:"headerInjectCode"}},{$value:{ctor:b.Squarespace.DialogFields.Description,config:{title:"Post Blog Item Code Injection",text:"Enter the code that will be injected onto the page immediately after each blog content block (but before the blog post's footer block, if any).  You can use the <strong>{permalink}</strong> variable to access the permalink for each item.",$escape:!0,padding:[15,0]}},$when:function(c){return b.Squarespace.ContentCollectionUtils.hasSupportForInjectableCodePerItem(c)}},
{$value:{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"postItemInjectCode"}},$when:function(c){return b.Squarespace.ContentCollectionUtils.hasSupportForInjectableCodePerItem(c)}}];d.groups.pageControls=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Page Controls",text:{$valueFn:function(c){return c.get("type")==b.Squarespace.CollectionTypes.PAGE?"Use the controls below to either duplicate this page, or mark it as your homepage.":"Use the controls below to mark this page as your homepage."}},
$escape:!0,padding:[15,0]}},{$include:"fields.homepage"},{$include:"fields.duplicate",$when:function(c){return c.get("type")==b.Squarespace.CollectionTypes.PAGE}}];d.tabs={};d.tabs.primary={title:{$valueFn:function(c){return(c=b.Squarespace.Singletons.Template.get("collectionConfigs."+c.get("typeName")))?"Configure "+c.get("title"):"Configure Page"}},tabTitle:"Basic",icon:"/universal/images-v6/content/icon-settings-32-light.png",fields:[{$include:"fields.navigationTitle"},{$include:"fields.title"},
{$include:"fields.enabled",$when:function(){return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)}},{$include:"fields.eventView",$when:function(c){var d=b.Squarespace.Singletons.Template.get("collectionConfigs."+c.get("typeName"));return d?c.get("ordering")==b.Squarespace.CollectionOrdering.CALENDAR&&!d.get("forceEventView"):c.get("ordering")==b.Squarespace.CollectionOrdering.CALENDAR}},{$include:"fields.pageLayout",$when:function(){return 1<b.Object.keys(b.Squarespace.Singletons.Template.get("layouts")).length}},
{$include:"fields.pageSize",$when:function(c){return!b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)?!1:b.Squarespace.ContentCollectionUtils.isAdjustablePageSizeCollection(c)}},{$include:"fields.description"},{$include:"fields.urlId"},{$include:"fields.password"},{$include:"fields.mainImage"},{$include:"fields.postByEmailAddress",$when:function(c){return b.Squarespace.ContentCollectionUtils.isPostableByEmailAddress(c)}},{$include:"fields.bookmarklet",
$when:function(c){return b.Squarespace.ContentCollectionUtils.isSupportedByBookmarklet(c)}},{$include:"groups.pageControls",$concat:!0,$when:function(){return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)}}]};d.tabs.advanced={tabTitle:"Advanced",fields:[{$include:"groups.tagsAndCategories",$concat:!0,$when:function(c){return c.get("ordering")!=b.Squarespace.CollectionOrdering.CUSTOM&&c.get("type")==b.Squarespace.CollectionTypes.GENERIC||c.get("type")==
b.Squarespace.CollectionTypes.PRODUCT}},{$include:"groups.codeInjection",$concat:!0,$when:function(){return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)}}]};d.tabs.syndication={tabTitle:"Syndication",name:"syndication",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"rssFeedReplacementUrl",maxLength:300,"strings.title":"RSS Feed Replacement URL","strings.description":"An alternative feed (eg. Feedburner) that will be served for this collection."}},
{ctor:b.Squarespace.DialogFields.Check,config:{name:"iTunesEnabled","strings.title":"Enable iTunes RSS Tags","strings.description":"This will allow you to specify iTunes specific RSS tags."}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"iTunesDescription",title:"iTunes / Podcasting Setup",text:"Squarespace includes full support for podcasting and syndicating your shows to iTunes.  Fill in the tags below to augment your RSS feed with the information required to be listed in the iTunes directory.  After you have filled out the fields below, adding a Audio block to any of your posts will automatically attach it as a podcast.",
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesAuthor",maxLength:100,"strings.title":"iTunes Author","strings.description":"The author of this podcast."}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesSubtitle",maxLength:300,"strings.title":"iTunes Subtitle","strings.description":"A brief description of your show."}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesSummary",maxLength:4E3,"strings.title":"iTunes Summary","strings.description":"When the 'i' information icon is clicked, more detailed information about your show in iTunes."}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesKeywords",maxLength:100,"strings.title":"iTunes Search Keywords","strings.description":"A comma delimited list of keywords describing your podcast.  Not visible in the iTunes interface, but assists when your show is searched for."}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesCategories",maxLength:100,"strings.title":"iTunes Category","strings.description":"Shown in the category column and in iTunes Store Browse."}},{type:"splitter",
fields:[{ctor:b.Squarespace.DialogFields.Text,config:{width:0.5,name:"iTunesOwner",maxLength:100,"strings.title":"iTunes Owner","strings.description":"The owner of this podcast. Not visible in the iTunes interface."}},{ctor:b.Squarespace.DialogFields.Text,config:{width:0.5,name:"iTunesOwnerEmail",maxLength:100,"strings.title":"iTunes Owner Email","strings.description":"The owner email for this podcast.  Not visible in the iTunes interface."}}]},{ctor:b.Squarespace.DialogFields.FileImage,config:{contentType:"image",
source:"item",noFocalPoint:!0,name:"iTunesImage",transientStore:!0,height:250,square:!0,contentLabel:"cover art image",strings:{title:"iTunes Cover Art Image",description:""}}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"iTunesImageDescription",text:"Add an iTunes cover art image. iTunes prefers square .jpg images that are at least 1400x1400 pixels formatted as a .jpg file.",width:224}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"iTunesExplicit","strings.title":"Explicit Content",
"strings.description":"Your show contains explicit content."}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"iTunesNewFeedUrl",maxLength:4E3,"strings.title":"Changing Your Feed URL","strings.description":"This will add the &ltitunes:new-feed-url&gt tag to your feed, and will cause iTunes to update to this URL."}}]};d.buttons=[{type:"cancel",title:"Cancel"},{type:"remove",title:"Delete",$when:function(c){return!b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)?
!1:c.get("type")!=b.Squarespace.CollectionTypes.TEMPLATE_PAGE}},{type:"saveAndClose",title:"Save"}]},"1.0",{requires:"oop squarespace-dialog-content-stat-manager squarespace-dialog-description squarespace-dialog-code squarespace-dialog-select squarespace-dialog-wysiwyg squarespace-dialog-file-image squarespace-dialog-text squarespace-dialog-post-by-email squarespace-dialog-slider".split(" ")});
YUI.add("squarespace-block-instagram-editor",function(b){b.namespace("Squarespace.Block.Editor").Instagram=b.Base.create("instagram-block-editor-dialog",b.Squarespace.Block.Editor.Gallery,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Instagram")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Instagram"}}});b.namespace("Squarespace.Block.ModelEditorDialog");b.Squarespace.Block.ModelEditorDialog.Instagram=b.Base.create("InstagramModelEditorDialog",
b.Squarespace.Block.ModelEditorDialog.SummaryGallery,[],{},{ATTRS:{icon:{value:"instagram"},type:{value:b.Squarespace.BlockType.INSTAGRAM},socialAccountType:{value:b.Squarespace.ExternalServiceProviders.INSTAGRAM},collectionType:{value:b.Squarespace.CollectionTypes.INSTAGRAM},strings:{value:{name:"Instagram",itemTypePlural:"Photos",itemType:"Photo"}}}})},"1.0",{requires:"base squarespace-block-summary-gallery-model-editor squarespace-block-instagram-model squarespace-damask-context-globals squarespace-enum squarespace-util".split(" ")});
YUI.add("squarespace-connected-account-widget",function(b){b.Handlebars.registerHelper("serviceNameForDisplay",function(b){b=b.serviceName;return"fivehundredpix"===b?"500px":b});b.Handlebars.registerHelper("screenNameForDisplay",function(d){if("tumblr"===d.serviceName&&d.metaData&&d.metaData.primaryBlog){var c=b.Array.find(d.metaData.blogs,function(b){return b.primary});if(c)return d.screenname+" ("+c.title+")"}return d.screenname});b.namespace("Squarespace.Widgets").ConnectedAccount=b.Base.create("connectedAccountWidget",
b.Widget,[b.WidgetChild],{initializer:function(){this._editor=b.Squarespace.ConnectedAccountEditors.create(this.get("model"));this._bindEditorEvents(this._editor);this.publish("reauthenticate",{emitFacade:!0})},destructor:function(){this._editor.destroy();this._modelChangeHandle&&this._modelChangeHandle.detach()},_bindEditorEvents:function(b){b=b.get("dialog");b.on("button-reset",this._resetSubscription,this);b.on("remove-requested",this._remove,this)},_remove:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Disconnect Account",
"strings.message":"Are you sure you want to disconnect this account?"})).on("confirm",function(){this.get("model").destroy({remove:!0},b.bind(function(b){b||this.destroy()},this))},this)},_resetSubscription:function(){this.get("model").resetSubscription();new b.Squarespace.Widgets.Information({"strings.title":"Account Reset","strings.message":"Your connected account has been reset. Social blocks are being populated with the latest activity. This may take a few minutes."})},bindUI:function(){var b=
this.get("model");b&&(this._modelChangeHandle=b.after("change",this.syncUI,this));this.get("boundingBox").on("click",function(){this.get("editable")&&this._edit()},this);this.get("contentBox").delegate("click",this._reauthenticate,".reauthenticate",this)},syncUI:function(){this.get("contentBox").setContent(b.Squarespace.UITemplates.renderAsNodeOrDocFrag("connected-account.html",this.get("model").getAttrs()))},_reauthenticate:function(b){b.halt();this.fire("reauthenticate")},_edit:function(){this._editor.show()}},
{CSS_PREFIX:"sqs-connected-account",ATTRS:{model:{},editable:{value:!0,validator:b.Lang.isBoolean}}})},"1.0",{requires:"base widget widget-child squarespace-ui-templates squarespace-connected-account-editors squarespace-connected-account-template squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-widgets-model-list",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.ModelList=b.Base.create("ModelList",b.Squarespace.Widgets.SSWidget,[b.WidgetParent,b.Squarespace.Mixins.Loadable],{destructor:function(){this._loadingTimer&&this._loadingTimer.cancel()},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("models");b.after("add",function(e){1===b.size()&&this._empty();this._addWidgetForModel(e.model)},this);b.after("remove",function(e){this._removeWidgetForModel(e.model);
b.isEmpty()&&this._renderEmptyState()},this);b.after("reset",this._renderLoadedState,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("loading")?this._renderLoadingState():this._renderLoadedState()},_renderLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=b.later(500,this,function(){this._empty();new b.Squarespace.Spinner({render:this.get("contentBox"),size:44,color:"dark"})})},_renderLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();
this._empty();var b=this.get("models");b.isEmpty()?this._renderEmptyState():b.each(this._addWidgetForModel,this)},_renderEmptyState:function(){var c=this.get("emptyStateIconSrc"),e=this.get("strings.modelName")+"s",d=b.Node.create('<div class="no-models"></div>');b.Lang.isValue(c)&&""!==c&&d.append('<img class="icon large" src="'+c+'" />');d.append('<div class="no-models-text">There are no '+e+".</div>");this.get("contentBox").append(d)},_empty:function(){this.removeAll().each(function(b){b.destroy()});
this._childrenContainer.empty()},_addWidgetForModel:function(b){var e=this.get("models").indexOf(b);this.add({model:b},e)},_removeWidgetForModel:function(b){var e;this.some(function(d){if(d.get("model")===b)return e=d,!0})&&e.destroy()}},{CSS_PREFIX:"sqs-model-list",ATTRS:{models:{valueFn:function(){return new b.Squarespace.Models.ModelList},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ModelList),writeOnce:"initOnly"},emptyStateIconSrc:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString,
writeOnce:"initOnly"},loadable:{getter:function(){return this.get("models")},readOnly:!0},strings:{value:{modelName:"model"},validator:function(c){return!b.Lang.isObject(c)?(console.error('ModelList: Invalid "strings" attribute. Must be an object.'),!1):!b.Object.hasKey(c,"modelName")?(console.error('ModelList: Invalid "strings" attribute. Must have key "modelName".'),!1):!0},writeOnce:"initOnly"},defaultChildType:{value:b.Squarespace.Widgets.Model,writeOnce:"initOnly"}}})},"1.0",{requires:"base event-custom squarespace-attr-validators squarespace-mixins-loadable squarespace-models-model-list squarespace-spinner squarespace-ss-widget squarespace-widgets-model widget-parent".split(" ")});
YUI.add("squarespace-widgets-commerce-coupon-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-commerce-coupon.html"]=b(function(b,c,d,h,k){function l(b,c){return'\n      <div class="status-tag invalid">invalid</div>\n    '}function p(b,c){var e,f,h;e=" ";if((h=d["if"].call(b,(f=b.model,null==f||!1===f?f:f.expired),{hash:{},inverse:s.noop,fn:s.program(9,q,c),data:c}))||0===h)e+=h;return e+" "}function q(b,c){return'\n      <div class="status-tag expired">expired</div>\n    '}
this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var r,s=this;r=this.escapeExpression;b='<div class="commerce-coupon-content';if((h=d["if"].call(c,c.isInactiveOrExpired,{hash:{},inverse:s.noop,fn:s.program(1,function(b,c){return" inactive-or-expired"},k),data:k}))||0===h)b+=h;b+='">\n\n  <div class="name">'+r((h=(h=c.model,null==h||!1===h?h:h.name),"function"===typeof h?h.apply(c):h))+'</div>\n\n  <div class="info">\n\n    <div class="promo-code">'+r((h=(h=c.model,null==h||!1===
h?h:h.promoCode),"function"===typeof h?h.apply(c):h))+"</div>\n\n    ";if((r=d.unless.call(c,(h=c.model,null==h||!1===h?h:h.active),{hash:{},inverse:s.program(5,function(b,c){var e,f,h;e=" ";if((h=d.unless.call(b,(f=b.model,null==f||!1===f?f:f.isValid),{hash:{},inverse:s.program(8,p,c),fn:s.program(6,l,c),data:c}))||0===h)e+=h;return e+" "},k),fn:s.program(3,function(b,c){return'\n      <div class="status-tag inactive">inactive</div>\n    '},k),data:k}))||0===r)b+=r;b+='\n\n  </div>\n  <ul class="description">\n    <li>\n      ';
(r=d.couponSummary)?r=r.call(c,{hash:{},data:k}):(r=c.couponSummary,r="function"===typeof r?r.apply(c):r);if(r||0===r)b+=r;b+="\n    </li>\n    <li>\n      Starts ";(r=d.startDate)?r=r.call(c,{hash:{},data:k}):(r=c.startDate,r="function"===typeof r?r.apply(c):r);if(r||0===r)b+=r;b+="\n    </li>\n    <li>\n      Ends ";(r=d.endDate)?r=r.call(c,{hash:{},data:k}):(r=c.endDate,r="function"===typeof r?r.apply(c):r);if(r||0===r)b+=r;return b+"\n    </li>\n  </ul>\n\n</div>\n"})})();b.Handlebars.registerPartial("widgets-commerce-coupon.html".replace("/",
"."),d.templates["widgets-commerce-coupon.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-xero-connected-account",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.XeroConnectedAccount=b.Base.create("xeroConnectedAccount",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.REST_API_ROOT+"xero-connected-account",root:b.Squarespace.REST_API_ROOT+"xero-connected-account",initializer:function(){this.publish("load-requested")},load:function(d){this.fire("load-requested");b.Squarespace.Models.XeroConnectedAccount.superclass.load.call(this,d)}},
{ATTRS:{lastExportFmt:{validator:b.Squarespace.AttrValidators.isString},nextExportFmt:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base","model","squarespace-model-sync-rest","squarespace-attr-validators"]});
YUI.add("squarespace-dialog-slider",function(b){b.namespace("Squarespace.DialogFields").Slider=b.Base.create("slider",b.Squarespace.DialogField2,[],{initializer:function(){this.unplug(b.Plugin.WidgetAnim);b.Lang.isValue(this._initialData)||(this._initialData=this.get("data"))},renderUI:function(){b.Squarespace.DialogFields.Slider.superclass.renderUI.call(this);this.slider=new b.Slider({axis:"x"});var d=this.get("contentBox").one(".slider-container"),c=this.get("range");this.slider.setAttrs({thumbUrl:this.get("thumbUrl"),
min:c[0],max:c[1],value:this.get("data")});this.slider.render(d);this._updateDisplayFromSliderValue();this.refreshWidth()},show:function(){var d=this.get("visible");b.Squarespace.DialogFields.Slider.superclass.show.call(this);d||this.refreshWidth()},refreshWidth:function(){var b=this.get("contentBox");this.slider.set("length",b.one(".slider-container").get("offsetWidth"))},bindUI:function(){b.Squarespace.DialogFields.Slider.superclass.bindUI.call(this);this.slider.after("thumbMove",this._updateDataFromSlider,
this);this.slider.after("thumbMove",this._updateDisplayFromSliderValue,this);this.after("dataChange",this._updateSliderFromData,this)},_getDisplayValue:function(){var b=this.get("strings.suffix"),c=this.get("strings.zeroLabel"),e=this.get("data"),f=this.get("pluralize");return 0===e&&c?c:b?e+"&nbsp;"+b+(1!==e&&f?"s":""):e},_updateDisplayFromSliderValue:function(){this.get("contentBox").one(".numeric-display").setContent(this._getDisplayValue(this.get("data")))},_updateDataFromSlider:function(){this.set("data",
this.slider.get("value"))},_updateSliderFromData:function(){this.slider.set("value",this.get("data"))},destructor:function(){this.slider&&this.slider.destroy()}},{CSS_PREFIX:"sqs-slider",HANDLEBARS_TEMPLATE:"dialog-slider.html",ATTRS:{data:{value:null,getter:function(d){return b.Lang.isValue(d)?d:this.get("range")[0]},validator:b.Lang.isNumber},displayFormatter:{value:function(){return this._getDisplayValue(this.get("data"))}},range:{validator:function(d){var c=d[0];d=d[1];return b.Lang.isNumber(c)&&
b.Lang.isNumber(d)&&c<d},value:[0,100]},labelWidth:{value:20},pluralize:{value:!0},disabled:{value:!1},thumbUrl:{value:"/universal/images-v6/dialog/slider-thumb-dark.png"}}})},"1.0",{requires:["base","base-build","squarespace-dialog-field-2","squarespace-dialog-slider-template"]});
YUI.add("squarespace-stats-block-sparkline-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["stats-block-sparkline.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="sqs-sparkline">\n  <div class="description">\n    <div class="datametric">';(h=d.dataMetric)?h=h.call(c,{hash:{},data:k}):(h=c.dataMetric,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n    <div class="timeframe">';
(h=d.timeFrame)?h=h.call(c,{hash:{},data:k}):(h=c.timeFrame,h="function"===typeof h?h.apply(c):h);return b+=l(h)+'</div>\n  </div>\n\n  <div class="graphic"></div>\n</div>'})})();b.Handlebars.registerPartial("stats-block-sparkline.html".replace("/","."),d.templates["stats-block-sparkline.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-settings-locale-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-locale.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n  <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p="function",q=this;if((c=d["with"].call(c,c.strings,
{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e="\n  ";if((f=d["if"].call(b,b.description,{hash:{},inverse:q.noop,fn:q.program(2,l,c),data:c}))||0===f)e+=f;e+='\n  <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n"},k),data:k}))||0===c)b+=c;return b+'\n\n<div class="settings-panel-fields">\n  <div data-field-name="time-zone-description"></div>\n  <div data-field-name="timeZone"></div>\n\n  <div class="language">\n    <div data-field-name="language-description"></div>\n    <div data-field-name="language"></div>\n  </div>\n  <div class="geography">\n    <div data-field-name="geography-description"></div>\n    <div data-field-name="locale"></div>\n  </div>\n</div>'})})();
b.Handlebars.registerPartial("settings-locale.html".replace("/","."),d.templates["settings-locale.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-tagcloud-editor",function(b){b.namespace("Squarespace.Block.Editor").Tagcloud=b.Base.create("tagcloud-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Tagcloud")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Tagcloud"}}});var d=b.namespace("Squarespace.Block.ModelEditorDialog").Tagcloud=b.Base.create("blockTagcloudEditor",b.Squarespace.ModelEditorDialog,
[],{_showDialog:function(){d.superclass._showDialog.call(this);var b=this.get("dialog").getField("collectionIds");b.set("collectionGroups",this._getCollectionGroups());b.syncUI()},_getCollectionGroups:function(){var c=b.Squarespace.ContentCollectionUtils,e=b.Squarespace.ContentCollectionCache.filter(c.isGenericOrProduct),e=b.Array(e).filter(c.isNotCalendar);return c.groupCollectionsByTypeName(e)},_getDialogConfig:function(){return{width:300,height:450,closeOthers:!1,draggable:!0,flyoutPointerDirection:"hidden",
style:"flyout",initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Tag Cloud",icon:"/universal/images-v6/icons/icon-tagcloud-16-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Select,config:{name:"type","strings.title":"Display Type",className:"dark thin",defaultValue:"tag",options:[{value:"tag",label:this.get("strings").tag},{value:"category",label:this.get("strings").category}]}},
{ctor:b.Squarespace.DialogFields.Select,config:{name:"sortby","strings.title":"Sort By",defaultValue:"az",className:"thin dark",options:[{value:"az",label:this.get("strings").az},{value:"weight",label:this.get("strings").weight},{value:"activity",label:this.get("strings").activity}]}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Tag Limit",text:"",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Slider,required:!0,config:{name:"count",range:[5,100],"strings.suffix":"Tag","strings.description":"Pick the number of tags to show in the cloud.",
pluralize:!0,labelWidth:50,submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.ContentIdArraySelector,config:{name:"collectionIds",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionGroups:[]}}]}]}}},{ATTRS:{dialogConfig:{getter:"_getDialogConfig"},strings:{value:{az:"A-Z",weight:"Weight",activity:"Activity",tag:"Tags",category:"Categories",author:"Author",fontsize:"Font Size",color:"Color",flat:"Flat"}}}})},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-content-collection-utils squarespace-damask-context-globals squarespace-dialog-content-item-grid squarespace-dialog-gallery-options squarespace-dialog-multi-option squarespace-dialog-multi-frame squarespace-gallery-option-synchronizer squarespace-models-content-collection squarespace-plugin-actionoverlay".split(" ")});
YUI.add("squarespace-models-site-user-group",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.SiteUserGroup=b.Base.create("SiteUserGroup",b.Model,[b.Squarespace.ModelSync.REST],{root:"/api/site-user-groups",url:"/api/site-user-groups/{id}"},{ATTRS:{id:{value:null,validator:b.Squarespace.AttrValidators.isString},name:{value:null,validator:b.Squarespace.AttrValidators.isString},groupType:{validator:b.Squarespace.AttrValidators.isNumber}}})},"1.0",{requires:["base","model","squarespace-attr-validators",
"squarespace-model-sync-rest"]});
YUI.add("datatype-number-parse",function(b,d){var c=b.Escape.regex;b.mix(b.namespace("Number"),{_buildParser:b.cached(function(b,d,g,h){var k=[],l;b&&k.push("^\\s*"+c(b)+"\\s*");d&&k.push("\\s*"+c(d)+"\\s*$");g&&k.push(c(g)+"(?=\\d)");l=RegExp("(?:"+k.join("|")+")","g");"."===h&&(h=null);return function(b){b=b.replace(l,"");return h?b.replace(h,"."):b}}),parse:function(c,d){var g;d&&"string"===typeof c&&(g=this._buildParser(d.prefix,d.suffix,d.thousandsSeparator,d.decimalSeparator),c=g(c));"string"===
typeof c&&""!==b.Lang.trim(c)&&(c=+c);if("number"!==typeof c||!isFinite(c))c=null;return c}});b.namespace("Parsers").number=b.Number.parse;b.namespace("DataType");b.DataType.Number=b.Number},"3.17.2",{requires:["escape"]});
YUI.add("squarespace-block-fivehundredpix",function(b){b.namespace("Squarespace.Block").Fivehundredpix=b.Base.create("block-fivehundredpix",b.Squarespace.Block.SummaryGallery,[],{},{CSS_PREFIX:"sqs-block-fivehundredpix",MODEL:b.Squarespace.ContentModel.FivehundredpixBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Fivehundredpix},type:{value:b.Squarespace.BlockType.FIVEHUNDREDPIX}}})},"1.0",{requires:["base","squarespace-enum","squarespace-block-summary-gallery","squarespace-block-fivehundredpix-editor",
"squarespace-block-fivehundredpix-model"]});
YUI.add("squarespace-layout-insert-block-menu-web-app",function(b){b.namespace("Squarespace.Layout").InsertBlockMenuWebApp=b.Base.create("layoutInsertBlockMenu",b.Squarespace.Layout.InsertBlockMenuWebBase,[],{_getInsertableBlockItems:function(){return[{label:"Basic",items:[b.Squarespace.BlockType.HTML,b.Squarespace.BlockType.MARKDOWN,b.Squarespace.BlockType.QUOTE,b.Squarespace.BlockType.IMAGE,b.Squarespace.BlockType.GALLERY,b.Squarespace.BlockType.VIDEO,b.Squarespace.BlockType.AUDIO,b.Squarespace.BlockType.EMBED]},
{label:"Commerce",items:[b.Squarespace.BlockType.PRODUCT,b.Squarespace.BlockType.AMAZON,b.Squarespace.BlockType.DONATION]},{label:"More",items:[b.Squarespace.BlockType.FORM,b.Squarespace.BlockType.NEWSLETTER,b.Squarespace.BlockType.MAP,b.Squarespace.BlockType.CODE,b.Squarespace.BlockType.MENU,b.Squarespace.BlockType.CALENDAR,b.Squarespace.BlockType.OPENTABLE,b.Squarespace.BlockType.TOURDATES]},{label:"Layout",items:[b.Squarespace.BlockType.SPACER,b.Squarespace.BlockType.HORIZONTAL_RULE]},{label:"Content",
items:[b.Squarespace.BlockType.SEARCH,b.Squarespace.BlockType.COLLECTION_LINK,b.Squarespace.BlockType.BUTTON,b.Squarespace.BlockType.SUMMARY_V2,b.Squarespace.BlockType.TAGCLOUD,b.Squarespace.BlockType.POSTS_BY_TAG,b.Squarespace.BlockType.POSTS_BY_AUTHOR,b.Squarespace.BlockType.POSTS_BY_CATEGORY,b.Squarespace.BlockType.POSTS_BY_MONTH]},{label:"Social",items:[b.Squarespace.BlockType.TWITTER,b.Squarespace.BlockType.FOURSQUARE,b.Squarespace.BlockType.SOCIAL_ACCOUNT_LINKS_V2,b.Squarespace.BlockType.RSS,
b.Squarespace.BlockType.FIVEHUNDREDPIX,b.Squarespace.BlockType.INSTAGRAM,b.Squarespace.BlockType.FLICKR,b.Squarespace.BlockType.SOUNDCLOUD]}]}},{CSS_PREFIX:"sqs-layout-insert-block-menu",ATTRS:{editMode:{readOnly:!0,value:b.Squarespace.Layout.EditMode.WEB_APP}}})},"1.0",{requires:["base","squarespace-enum","squarespace-layout-insert-block-menu-web-base","squarespace-layout-renderable-blocks-web-app"]});
YUI.add("resize-base",function(b,d){function c(){c.superclass.constructor.apply(this,arguments)}var e=b.Lang,f=e.isArray,g=e.isBoolean,h=e.isNumber,k=e.isString,l=b.Array,p=e.trim,q=l.indexOf,e=function(){return Array.prototype.slice.call(arguments).join(" ")},r=function(b){return Math.round(parseFloat(b))||0},s=function(c){return c instanceof b.Node},t=b.cached(function(b){return b.substring(0,1).toUpperCase()+b.substring(1)}),u=b.cached(function(){var b=[],c=l(arguments,0,!0);l.each(c,function(c,
e){0<e&&(c=t(c));b.push(c)});return b.join("")}),v=b.ClassNameManager.getClassName,w=v("resize"),y=v("resize","handle"),z=v("resize","handle","active"),B=v("resize","handle","inner"),A=v("resize","handle","inner","{handle}"),K=v("resize","handle","{handle}"),O=v("resize","hidden","handles"),E=v("resize","handles","wrapper"),F=v("resize","wrapper");b.mix(c,{NAME:"resize",ATTRS:{activeHandle:{value:null,validator:function(c){return b.Lang.isString(c)||b.Lang.isNull(c)}},activeHandleNode:{value:null,
validator:s},autoHide:{value:!1,validator:g},defMinHeight:{value:15,validator:h},defMinWidth:{value:15,validator:h},handles:{setter:"_setHandles",value:"all"},handlesWrapper:{readOnly:!0,setter:b.one,valueFn:"_valueHandlesWrapper"},node:{setter:b.one},resizing:{value:!1,validator:g},wrap:{setter:"_setWrap",value:!1,validator:g},wrapTypes:{readOnly:!0,value:/^canvas|textarea|input|select|button|img|iframe|table|embed$/i},wrapper:{readOnly:!0,valueFn:"_valueWrapper",writeOnce:!0}},RULES:{b:function(b,
c,e){b.info.offsetHeight=b.originalInfo.offsetHeight+e},l:function(b,c){var e=b.info,d=b.originalInfo;e.left=d.left+c;e.offsetWidth=d.offsetWidth-c},r:function(b,c){b.info.offsetWidth=b.originalInfo.offsetWidth+c},t:function(b,c,e){c=b.info;b=b.originalInfo;c.top=b.top+e;c.offsetHeight=b.offsetHeight-e},tr:function(){this.t.apply(this,arguments);this.r.apply(this,arguments)},bl:function(){this.b.apply(this,arguments);this.l.apply(this,arguments)},br:function(){this.b.apply(this,arguments);this.r.apply(this,
arguments)},tl:function(){this.t.apply(this,arguments);this.l.apply(this,arguments)}},capitalize:u});b.Resize=b.extend(c,b.Base,{ALL_HANDLES:"t tr r br b bl l tl".split(" "),REGEX_CHANGE_HEIGHT:/^(t|tr|b|bl|br|tl)$/i,REGEX_CHANGE_LEFT:/^(tl|l|bl)$/i,REGEX_CHANGE_TOP:/^(tl|t|tr)$/i,REGEX_CHANGE_WIDTH:/^(bl|br|l|r|tl|tr)$/i,HANDLES_WRAP_TEMPLATE:'<div class="'+E+'"></div>',WRAP_TEMPLATE:'<div class="'+F+'"></div>',HANDLE_TEMPLATE:'<div class="'+e(y,K)+'"><div class="'+e(B,A)+'">&nbsp;</div></div>',
totalHSurrounding:0,totalVSurrounding:0,nodeSurrounding:null,wrapperSurrounding:null,changeHeightHandles:!1,changeLeftHandles:!1,changeTopHandles:!1,changeWidthHandles:!1,delegate:null,info:null,lastInfo:null,originalInfo:null,initializer:function(){this._eventHandles=[];this.renderer()},renderUI:function(){this._renderHandles()},bindUI:function(){this._createEvents();this._bindDD();this._bindHandle()},syncUI:function(){this.get("node").addClass(w);this._setHideHandlesUI(this.get("autoHide"))},destructor:function(){var c=
this,e=c.get("node"),d=c.get("wrapper"),f=d.get("parentNode");b.each(c._eventHandles,function(b){b.detach()});c._eventHandles.length=0;c.eachHandle(function(b){c.delegate.dd.destroy();b.remove(!0)});c.delegate.destroy();c.get("wrap")&&(c._copyStyles(d,e),f&&f.insertBefore(e,d),d.remove(!0));e.removeClass(w);e.removeClass(O)},renderer:function(){this.renderUI();this.bindUI();this.syncUI()},eachHandle:function(c){var e=this;b.each(e.get("handles"),function(b,d){var f=e.get("handle"+b.toUpperCase());
c.apply(e,[f,b,d])})},_bindDD:function(){this.delegate=new b.DD.Delegate({bubbleTargets:this,container:this.get("handlesWrapper"),dragConfig:{clickPixelThresh:0,clickTimeThresh:0,useShim:!0,move:!1},nodes:"."+y,target:!1});this._eventHandles.push(this.on("drag:drag",this._handleResizeEvent),this.on("drag:dropmiss",this._handleMouseUpEvent),this.on("drag:end",this._handleResizeEndEvent),this.on("drag:start",this._handleResizeStartEvent))},_bindHandle:function(){var c=this.get("wrapper");this._eventHandles.push(c.on("mouseenter",
b.bind(this._onWrapperMouseEnter,this)),c.on("mouseleave",b.bind(this._onWrapperMouseLeave,this)),c.delegate("mouseenter",b.bind(this._onHandleMouseEnter,this),"."+y),c.delegate("mouseleave",b.bind(this._onHandleMouseLeave,this),"."+y))},_createEvents:function(){var b=this,c=function(c,e){b.publish(c,{defaultFn:e,queuable:!1,emitFacade:!0,bubbles:!0,prefix:"resize"})};c("resize:start",this._defResizeStartFn);c("resize:resize",this._defResizeFn);c("resize:align",this._defResizeAlignFn);c("resize:end",
this._defResizeEndFn);c("resize:mouseUp",this._defMouseUpFn)},_renderHandles:function(){var b=this.get("wrapper"),c=this.get("handlesWrapper");this.eachHandle(function(b){c.append(b)});b.append(c)},_buildHandle:function(c){return b.Node.create(b.Lang.sub(this.HANDLE_TEMPLATE,{handle:c}))},_calcResize:function(){var c=this.handle,e=this.info,d=this.originalInfo,f=e.actXY[0]-d.actXY[0],e=e.actXY[1]-d.actXY[1];if(c&&b.Resize.RULES[c])b.Resize.RULES[c](this,f,e)},_checkSize:function(b,c){var e=this.info,
d=this.originalInfo,f="offsetHeight"===b?"top":"left";e[b]=c;if("left"===f&&this.changeLeftHandles||"top"===f&&this.changeTopHandles)e[f]=d[f]+d[b]-c},_copyStyles:function(c,e){var d=c.getStyle("position").toLowerCase(),f=this._getBoxSurroundingInfo(c);"static"===d&&(d="relative");d={position:d,left:c.getComputedStyle("left"),top:c.getComputedStyle("top")};b.mix(d,f.margin);b.mix(d,f.border);e.setStyles(d);c.setStyles({border:0,margin:0});e.sizeTo(c.get("offsetWidth")+f.totalHBorder,c.get("offsetHeight")+
f.totalVBorder)},_extractHandleName:b.cached(function(b){return(b=b.get("className").match(RegExp(v("resize","handle","(\\w{1,2})\\b"))))?b[1]:null}),_getInfo:function(b,c){var e=[0,0],d=c.dragEvent.target,f=b.getXY(),g=f[0],f=f[1],h=b.get("offsetHeight"),k=b.get("offsetWidth");c&&(e=d.actXY.length?d.actXY:d.lastXY);return{actXY:e,bottom:f+h,left:g,offsetHeight:h,offsetWidth:k,right:g+k,top:f}},_getBoxSurroundingInfo:function(c){var e={padding:{},margin:{},border:{}};s(c)&&b.each(["top","right","bottom",
"left"],function(b){var d=u("padding",b),f=u("margin",b),g=u("border",b,"width"),h=u("border",b,"color");b=u("border",b,"style");e.border[h]=c.getComputedStyle(h);e.border[b]=c.getComputedStyle(b);e.border[g]=c.getComputedStyle(g);e.margin[f]=c.getComputedStyle(f);e.padding[d]=c.getComputedStyle(d)});e.totalHBorder=r(e.border.borderLeftWidth)+r(e.border.borderRightWidth);e.totalHPadding=r(e.padding.paddingLeft)+r(e.padding.paddingRight);e.totalVBorder=r(e.border.borderBottomWidth)+r(e.border.borderTopWidth);
e.totalVPadding=r(e.padding.paddingBottom)+r(e.padding.paddingTop);return e},_syncUI:function(){var c=this.info,e=this.wrapperSurrounding,d=this.get("wrapper"),f=this.get("node");d.sizeTo(c.offsetWidth,c.offsetHeight);(this.changeLeftHandles||this.changeTopHandles)&&d.setXY([c.left,c.top]);d.compareTo(f)||f.sizeTo(c.offsetWidth-e.totalHBorder,c.offsetHeight-e.totalVBorder);b.UA.webkit&&f.setStyle("resize","none")},_updateChangeHandleInfo:function(b){this.changeHeightHandles=this.REGEX_CHANGE_HEIGHT.test(b);
this.changeLeftHandles=this.REGEX_CHANGE_LEFT.test(b);this.changeTopHandles=this.REGEX_CHANGE_TOP.test(b);this.changeWidthHandles=this.REGEX_CHANGE_WIDTH.test(b)},_updateInfo:function(b){this.info=this._getInfo(this.get("wrapper"),b)},_updateSurroundingInfo:function(){var b=this.get("node"),c=this.get("wrapper"),b=this._getBoxSurroundingInfo(b),c=this._getBoxSurroundingInfo(c);this.nodeSurrounding=b;this.wrapperSurrounding=c;this.totalVSurrounding=b.totalVPadding+c.totalVBorder;this.totalHSurrounding=
b.totalHPadding+c.totalHBorder},_setActiveHandlesUI:function(b){var c=this.get("activeHandleNode");c&&(b?(this.eachHandle(function(b){b.removeClass(z)}),c.addClass(z)):c.removeClass(z))},_setHandles:function(c){var e=this,d=[];f(c)?d=c:k(c)&&("all"===c.toLowerCase()?d=e.ALL_HANDLES:b.each(c.split(","),function(b){b=p(b);-1<q(e.ALL_HANDLES,b)&&d.push(b)}));return d},_setHideHandlesUI:function(b){var c=this.get("wrapper");this.get("resizing")||(b?c.addClass(O):c.removeClass(O))},_setWrap:function(b){var c=
this.get("node").get("nodeName");this.get("wrapTypes").test(c)&&(b=!0);return b},_defMouseUpFn:function(){this.set("resizing",!1)},_defResizeFn:function(b){this._resize(b)},_resize:function(b){this._handleResizeAlignEvent(b.dragEvent);this._syncUI()},_defResizeAlignFn:function(b){this._resizeAlign(b)},_resizeAlign:function(b){var c,e;this.lastInfo=this.info;this._updateInfo(b);b=this.info;this._calcResize();this.con||(c=this.get("defMinHeight")+this.totalVSurrounding,e=this.get("defMinWidth")+this.totalHSurrounding,
b.offsetHeight<=c&&this._checkSize("offsetHeight",c),b.offsetWidth<=e&&this._checkSize("offsetWidth",e))},_defResizeEndFn:function(b){this._resizeEnd(b)},_resizeEnd:function(b){b.dragEvent.target.actXY=[];this._syncUI();this._setActiveHandlesUI(!1);this.set("activeHandle",null);this.set("activeHandleNode",null);this.handle=null},_defResizeStartFn:function(b){this._resizeStart(b)},_resizeStart:function(b){var c=this.get("wrapper");this.handle=this.get("activeHandle");this.set("resizing",!0);this._updateSurroundingInfo();
this.originalInfo=this._getInfo(c,b);this._updateInfo(b)},_handleMouseUpEvent:function(b){this.fire("resize:mouseUp",{dragEvent:b,info:this.info})},_handleResizeEvent:function(b){this.fire("resize:resize",{dragEvent:b,info:this.info})},_handleResizeAlignEvent:function(b){this.fire("resize:align",{dragEvent:b,info:this.info})},_handleResizeEndEvent:function(b){this.fire("resize:end",{dragEvent:b,info:this.info})},_handleResizeStartEvent:function(b){this.get("activeHandle")||this._setHandleFromNode(b.target.get("node"));
this.fire("resize:start",{dragEvent:b,info:this.info})},_onWrapperMouseEnter:function(){this.get("autoHide")&&this._setHideHandlesUI(!1)},_onWrapperMouseLeave:function(){this.get("autoHide")&&this._setHideHandlesUI(!0)},_setHandleFromNode:function(b){var c=this._extractHandleName(b);this.get("resizing")||(this.set("activeHandle",c),this.set("activeHandleNode",b),this._setActiveHandlesUI(!0),this._updateChangeHandleInfo(c))},_onHandleMouseEnter:function(b){this._setHandleFromNode(b.currentTarget)},
_onHandleMouseLeave:function(){this.get("resizing")||this._setActiveHandlesUI(!1)},_valueHandlesWrapper:function(){return b.Node.create(this.HANDLES_WRAP_TEMPLATE)},_valueWrapper:function(){var c=this.get("node"),e=c.get("parentNode"),d=c;this.get("wrap")&&(d=b.Node.create(this.WRAP_TEMPLATE),e&&e.insertBefore(d,c),d.append(c),this._copyStyles(c,d),c.setStyles({position:"static",left:0,top:0}));return d}});b.each(b.Resize.prototype.ALL_HANDLES,function(c){b.Resize.ATTRS["handle"+c.toUpperCase()]=
{setter:function(){return this._buildHandle(c)},value:null,writeOnce:!0}})},"3.17.2",{requires:"base widget event oop dd-drag dd-delegate dd-drop".split(" "),skinnable:!0});
YUI.add("squarespace-dialog-code",function(b){var d=b.namespace("Squarespace.DialogFields").Code=b.Base.create("codeEditor",b.Squarespace.DialogField2,[],{initializer:function(c){var d;b.Lang.isObject(c)&&(d=this.get("editorConfig"),this.set("editorConfig",b.merge(d,c)))},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox").one(".code-editor-seed"),f=this.get("editorConfig"),g=this.get("data");b.Lang.isString(g)||(g="");this._editor=CodeMirror.fromTextArea(c.getDOMNode(),
f);this._editor.setValue(g)},bindUI:function(){d.superclass.bindUI.call(this);this._editor.on("change",b.bind(this._updateData,this));this.on("visibleChange",this._refreshEditor,this)},_refreshEditor:function(c){this._editor&&b.Lang.isFunction(this._editor.refresh)&&this._editor.refresh()},_updateData:function(c){c=b.Lang.trim(this._editor.getValue());this.set("data",c)},loadValue:function(b){this.set("data",b);this._editor.setValue(b)}},{CSS_PREFIX:"sqs-code",TEMPLATE:'<textarea class="code-editor-seed"></textarea>',
ATTRS:{data:{validator:b.Lang.isString},editorConfig:{value:{mode:"htmlmixed",theme:"squarespace-light",lineNumbers:!0,indentUnit:2,tabMode:"indent",lineWrapping:!0,onChange:b.bind(this._updateData,this),autoCloseTags:!0,matchTags:!0}},visible:{value:!0}}}),c=b.namespace("Squarespace.DialogFields").HtmlCode=b.Base.create("htmlCode",b.Squarespace.DialogFields.Code,[],{isValid:function(){var c=b.Lang.trim(this.get("data"));return""===c?!0:b.Lang.isValue(c)},_getErrors:function(){return!this.isValid()?
[this.get("strings.htmlError")]:[]},loadValue:function(b){this.set("data",b);this._editor.setValue(b)},didDataChange:function(){var e=c.superclass.didDataChange.call(this);!b.Lang.isValue(this._initialData)&&""===this.get("data")&&(e=!1);return e}},{CSS_PREFIX:"sqs-html-code",ATTRS:{strings:{value:{htmlError:"Invalid HTML"}},data:{value:"",validator:b.Lang.isString}}});b.namespace("Squarespace.DialogFields").UrlMappings=b.Base.create("urlMappings",b.Squarespace.DialogFields.Code,[],{isValid:function(){return!0}},
{CSS_PREFIX:"sqs-url-mapping",ATTRS:{}});b.namespace("Squarespace.DialogFields").jsonTemplateCode=b.Base.create("urlMappings",b.Squarespace.DialogFields.Code,[],{_getErrors:function(){var c=this.get("data"),d=this.get("sampleData");try{return b.JSONTemplate.evaluateJsonTemplate(c,d),[]}catch(g){return[g.name+": "+g.message]}}},{CSS_PREFIX:"sqs-json-template-code",ATTRS:{strings:{},height:{readOnly:!0,value:{}},sampleData:{}}})},"1.0",{requires:["base","node","squarespace-dialog-field-2","thirdparty-codemirror"]});
YUI.add("squarespace-smugmug-sync-plugin",function(b){function d(b){d.superclass.constructor.apply(this,arguments)}d.NAME="smugMugSyncPlugin";d.NS="smugMugSync";var c={style:"flyout",flyoutPointerDirection:"centered",overlay:0.5,height:450,width:420,name:"smugmug-sync-settings",savingText:"Importing albums...",closeOthers:!1,tabs:[{title:"Import SmugMug Albums",icon:"/universal/images-v6/icons/icon-plus-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Choose which of your SmugMug albums you wish to import to your Squarespace site.",
padding:[0,10]}},{ctor:b.Squarespace.DialogFields.SmugmugSync,config:{name:"albums"}}]}],buttons:[{type:"cancel",title:"Cancel"}]};b.extend(d,b.Plugin.Base,{initializer:function(){var c=this.get("host");b.Do.after(this._renderSyncButton,c,"syncUI",this)},_renderSyncButton:function(){this.get("host").get("contentBox").one(".smugmug").append('<div class="sync"><input class="sync-button" type="button" value="Import Albums to Squarespace" /></div>');this.get("host").get("contentBox").one(".sync-button").on("click",
function(b){b.halt();this._showSyncOptions()},this)},_showSyncOptions:function(){var e=b.clone(c);e.tabs[0].fields[1].config.account=this.get("host").get("model");var d=new b.Squarespace.EditingDialog(e);d.show();d.getField("albums").once("gallery-imported",function(){d.close()})}});b.namespace("Squarespace.Plugins").SmugMugSync=d},"1.0",{requires:["plugin","squarespace-dialog-description","squarespace-dialog-smugmug-sync"]});
YUI.add("squarespace-editor-base",function(b){function d(){this.time=0;this.done=[];this.undone=[]}var c=/^[\u200b\s]*$/;d.prototype={addChange:function(b){this.undone.length=0;this.done.push(b)}};b.mix(b.Node.DOM_EVENTS,{paste:!0});b.namespace("Squarespace");var e=b.Squarespace.Range,f={UL:["LI"],OL:["LI"]},g={LI:["UL","OL"]},h=b.Squarespace.EditorBase=b.Base.create("Squared",b.Plugin.Base,[],{_root:null,_listeners:null,_initialValue:null,initializer:function(c){c=this._root=this.get("host");for(var e=
b.Array(c._node.childNodes),f=0,g=e.length;f<g;f++)3===e[f].nodeType&&0===e[f].textContent.replace(/\s+/g,"").length&&c.removeChild(e[f]);e=c.get("innerHTML");this.get("keepEmptyBlocks")&&(e=e.replace(/>&nbsp;</g,">\u200b<"),c.setContent(e));this._initialValue=e;c.set("contentEditable",this.get("editable"));this._history=new d;this.set("keyMap",this.get("keyMap"));c.on(["keyup","mouseup"],this._containerHandler,this);c.on("paste",this._onPaste,this);c.on("focus",this._ensureBlock,this);this.publish("pasteRaw",
{emitFacade:!0,defaultFn:b.bind(this._pasteRaw,this)});this.publish("pasteCooked",{defaultFn:b.bind(this._pasteCooked,this)});return this},destructor:function(){this._root.set("contentEditable",!1).removeAttribute("contentEditable");for(var b=0,c=this._listeners.length;b<c;b++)this._listeners[b].detach();this._listeners=[];this._root.setContent(this.getValue())},reset:function(){this._root.set("content",this._initialValue);this._history=new d},execute:function(b,c,d){var f=this._root,g=this.get("blockElementsWithHeadings"),
h=e.fromSelection({root:f}),t=h.get("container"),u=h.collapsed(),v,w=h.get("offsets"),y=h.cloneContents().all(g),z=h.get("endContainer").ancestor(g,!0),B=null;this._addChange(this._root.get("innerHTML"));z.next()?(B=z.next(),z="before"):(B=z.get("parentNode"),z="after");y.size()?t.all(g).each(function(f){0===f.all(g).size()&&(v=(new e).selectNodeContents(f).intersection(h))&&(c?b(v,c.cloneNode(),d):b(v))},this):b(h,c,d);d&&(B&&B.get("parentNode")&&"none"!=B.getStyle("display")?!B.compareTo(this._root)&&
this._canBeSiblings(B.get("tagName"),d.get("tagName"))?B.insert(d,z):B.append(d):f.append(d),this._mergeWithNeighboringNodes(d),0===t.get("children").size()&&t.remove());if(u&&c&&""===c.get("text")&&c.get("parentNode"))c.set("text","\u200b"),h.selectNodeContents(c);else if(u&&c&&!c.get("parentNode")){if(h.set("offsets",w),t=h.get("endContainer").ancestor("*",!0),t._node.nextSibling||t.insert("\u200b","after"),t=t._node.nextSibling)""===t.textContent&&(t.textContent="\u200b"),h.selectNodeContents(t).collapse()}else h.set("offsets",
w);h.toSelection();f.focus();this.fire("commandExecuted");return c},_canBeSiblings:function(b,c){return!(("LI"==b||"LI"==c)&&b!=c)},wrapFromHtml:function(c){var e=this._root;c=b.Node.create(c);c=c.one(":first-child")||c;var d=c.ancestor(function(b){return!b.parentNode||b.parentNode._node===e});d&&("OL"==d.get("tagName")||"UL"==d.get("tagName"))&&d.get("childNodes").remove();return this.wrap(c,d)},wrap:function(c,e){var d=this.execute(b.bind(this._wrapWithinBlock,this),c,e);this._containerHandler();
return d},_wrapWithinBlock:function(b,d,f){var q,r,s;r=this._root;var t=this.get("blockElements"),u=b.get("container").ancestor(t,!0);(r=r===u)&&(u=b.get("container"));if(d.test(t)||f&&f.test(t))this.get("inlineOnly")||(f?(d.setContent(u.get("innerHTML")),f.appendChild(d),u.remove()):3==b.get("container").get("nodeType")&&!b.collapsed()&&!g[u.get("tagName")]?(r=b.cloneRange(),s=b.cloneRange(),q=b.cloneRange().selectNodeContents(u).shrink(),r.setStart(q.get("startContainer"),q.get("startOffset")).setEnd(b.get("startContainer"),
b.get("startOffset")).shrink(),s.setStart(b.get("endContainer"),b.get("endOffset")).setEnd(q.get("endContainer"),q.get("endOffset")).shrink(),r.collapsed()?(f=b.extractContents(),u.insert(d.setContent(f),"before")):s.collapsed()?(f=b.extractContents(),u.insert(d.setContent(f),"after")):(u.insert(u.cloneNode().setContent(s.extractContents()),"after"),u.insert(d.setContent(b.extractContents()),"after")),0===u.get("children").size()&&c.test(u.get("text"))&&u.remove()):g[u.get("tagName")]?this.unwrapBlock(u.get("parentNode").get("tagName"),
d.get("tagName"),d):(r?d.setContent(u.get("outerHTML")):d.setContent(u.get("innerHTML")),u.insert(d,"before"),u.remove()));else{r=h._innerOuterToSelector(d,f);var u=r.replace(/[\s>]+/g,","),v=b.shrink().get("container").ancestor(r+","+t,!0);s=v.test(r);var t=r.split(">").length-1,w=v;r=r.replace(/h[1-6]/i,"h1, h2, h3, h4, h5, h6");u=u.replace(/h[1-6]/i,"h1, h2, h3, h4, h5, h6");f||(f=d);if(s){q=(new e({root:this._root})).selectNode(v);r=q.cloneRange();s=q.cloneRange();r.setEnd(b.get("startContainer"),
b.get("startOffset"));s.setStart(b.get("endContainer"),b.get("endOffset"));r.collapsed()||(b=h._innerOuterClone(d,f),r.surroundContents(b.innerNode,b.outerNode),b.innerNode.all(u).each(function(b){h.unwrap(b)}));s.collapsed()||(b=h._innerOuterClone(d,f),s.surroundContents(b.innerNode,b.outerNode),b.innerNode.all(u).each(function(b){h.unwrap(b)}));for(;t--;)w=v.get("parentNode");h.unwrap(v,w)}else if(t=b.cloneRange(),w=b.get("startContainer").ancestor(r),s=b.get("endContainer").ancestor(r),w&&(b=b.union(t.selectNode(w))),
s&&(b=b.union(t.selectNode(s))),b.surroundContents(d,f),d.all(u).each(function(b){h.unwrap(b)}),d.get("parentNode").test("p")&&d.test("h1, h2, h3, h4, h5, h6")&&d.unwrap(),d.test("h1, h2, h3, h4, h5, h6")&&d.get("parentNode").get("childNodes").each(function(b){3===b._node.nodeType&&""!==b._node.textContent&&b.wrap("<p></p>")}),r!==u){f=r.split(">");b=function(b){return b===v};r=0;for(t=f.length;r<t;r++)if(u=d.ancestor(f[r]+" "+f[r],!0,b))d._node===u._node&&(d=d.get("parentNode")),h.unwrap(u)}}},unwrap:function(b,
c,e){this._addChange(this._root.get("innerHTML"));if(!(this._root.compareTo(b)||this._root.compareTo(c)&&!e))return b=h.unwrap(b,c,e),this._containerHandler(),b},unwrapBlock:function(c,d,f){this._addChange(this._root.get("innerHTML"));var g=this;c=this._root;var h=this.get("blockElementsWithHeadings"),s=e.fromSelection({root:this._root}),t=s.get("offsets"),u=s.get("startContainer").ancestor(h,!0),v=this._root===u,w=c;v||(f=w=u.get("parentNode"));var y=new b.NodeList,z=new e,B=[];d=b.Node.create("<"+
(d?d:this.get("defaultBlockElement"))+">");u===c&&console.log("congratulation: your day just got more interesting!");z.selectNode(w);s.iterate(function(c){c._node||(c=new b.Node(c));1===c.get("nodeType")&&c.test(h)&&y.push(c)},u._node);z.intersection(s).isEqual(z)&&!z.isEqual(s)?y.each(function(b){g._splitBlockNodes(b,b,B)}):g._splitBlockNodes(w,f,B);for(f=0;f<B.length;f++)this._containsSubtree(y,B[f])&&(u=d.cloneNode(),w=(w=B[f].one(h))?w.get("innerHTML"):B[f].get("innerHTML"),u.setContent(w),B[f].replace(u),
B[f]=u);if(!v){var A;for(f=0;f<B.length;f++)if(A)if(B[f].get("tagName")!=d.get("tagName")&&B[f].get("tagName")==A.get("tagName")){for(v=0;v<B[f].get("children").size();v++)A.appendChild(B[f].get("children").item(v));B[f].remove();B[f]=null}else A=B[f];else A=B[f]}s.set("offsets",t).toSelection();c.focus();this._containerHandler()},unwrapBlocks:function(){this._addChange(this._root.get("innerHTML"));var c=this.get("blockElementsWithHeadings"),d=e.fromSelection({root:this._root}),f=d.get("startContainer").ancestor(c,
!0),g=[];if(!d.collapsed()){d.iterate(function(e){e._node||(e=new b.Node(e));1==e.get("nodeType")&&(e.test(c)&&!e.test("ul, ol, li"))&&g.push(e)},f._node);for(d=0;d<g.length;d++)this._existsInDom(g[d]._node)&&((new e).selectNodeContents(g[d]).shrink().toSelection(),this.unwrapBlock(g[d].get("tagName")))}},_mergeWithNeighboringNodes:function(b){if(f[b.get("tagName")]){var c=b.previous(),e=b.next(),d=c;d||(d=b);c&&c.get("tagName")==b.get("tagName")&&(b.get("children").each(function(b){d.appendChild(b)}),
b.remove());e&&e.get("tagName")==b.get("tagName")&&(e.get("children").each(function(b){d.appendChild(b)}),e.remove())}},_existsInDom:function(b){for(b=b.parentNode;b;){if(b==document)return!0;b=b.parentNode}return!1},_containsSubtree:function(b,c){var e=this.get("blockElementsWithHeadings");if(0<c.all(e).size()){var d=!1;c.all(e).each(function(c){-1<b.indexOf(c)&&(d=!0)});return d}return-1<b.indexOf(c)},_splitBlockNodes:function(c,e,d){var h=this.get("blockElementsWithHeadings"),r=this,s=c.get("tagName").toUpperCase(),
t=c==this._root,u=f[s]&&0<f[s].length&&0<c.all(h).size();t?c.all(h).each(function(b){r._splitBlockNodes(b,b,d)}):u?(c.all(h).each(function(c){var f=b.Node.create("<"+s+">");f.appendChild(c);e.insert(f,"before");d&&-1==d.indexOf(f)&&d.push(f);0<c.all(h).size()&&r._splitBlockNodes(c,e,d)}),0===c.all(h).size()&&c.remove()):c.test(h)&&(g[s]&&c.get("parentNode")&&-1<g[s].indexOf(c.get("parentNode").get("tagName"))?0<c.siblings().size()?r._splitBlockNodes(c.get("parentNode"),c.get("parentNode"),d):d&&-1==
d.indexOf(c.get("parentNode"))&&d.push(c.get("parentNode")):d&&-1==d.indexOf(c)&&d.push(c))},clear:function(c){return this.execute(b.bind(this._clear,this,c))},_clear:function(c,e){e.shrink();var d=this.get("blockElementsWithHeadings");e.get("container");for(var d=e.get("container").ancestor(d,!0),d=b.one(e.grow(d).extractContents()),f=/<(\/)?(\w+)(?:.+(href="(?:\\.|[^"\\])*?"))?.*?>/gi,g=function(b,e,d,f){return!c&&("a"==d||"A"==d)?"<"+(e?e:"")+d+" "+(f?f:"")+">":""},h=d._node.childNodes,t=0,u=h.length;t<
u;t++)if(1==h[t].nodeType){var v=b.Node.create(h[t].outerHTML.replace(f,g))._node;d._node.replaceChild(v,h[t])}e.insertNode(d._node);return this},_ensureBlock:function(){var c=this._root,d=e.fromSelection({root:c}),f=this.get("blockElementsWithHeadings");if(this.get("requireBlocks")&&!c.one(f)){var g=b.Node.create("<"+this.get("defaultBlockElement")+"/>");c.get("childNodes").size()&&!c.get("firstChild").test("br")?g.setContent(c.get("childNodes")):g.set("text","\u200b");c.empty().appendChild(g)}d.collapsed()&&
d.get("container").compareTo(c)&&(g=c.one(f),f=g.siblings(f),f=f.item(f.size()-1)||g,f.get("text")||f.set("text","\u200b"),d.selectNodeContents(f).collapse(f.compareTo(c.get("children").item(0))).toSelection());c.focus()},_updateKeyMap:function(c){function e(b,c,d,f,g,h){return function(e){e.keyCode==c&&(d==e.ctrlKey&&f==e.metaKey&&g==e.shiftKey&&h==e.altKey)&&b.call(this,e)}}var d,f,g,h;if(this._listeners){d=0;for(g=this._listeners.length;d<g;d++)this._listeners[d].detach()}this._listeners=[];for(f in c)if(c.hasOwnProperty(f)){h=
c[f];"string"===typeof h&&(h=this[h]);d=f.split(",");for(var t=0,u=d.length;t<u;t++)g=d[t].split("+"),this._listeners.push(this._root.on("keydown",e(h,g[0],0<g.indexOf("ctrl")||0<g.indexOf("CMD")&&"macintosh"!==b.UA.os,0<g.indexOf("meta")||0<g.indexOf("CMD")&&"macintosh"===b.UA.os,0<g.indexOf("shift"),0<g.indexOf("alt")),this))}return c},_setEditable:function(b){this._root.setAttribute("contentEditable",b?"true":"false");return b},_onBackspace:function(d){var f=this._root,g=e.fromSelection({root:f}),
h=f._node.textContent;if(g.empty()){var r=g.get("container"),s=g.get("startOffset");3===r._node.nodeType&&(r=r.get("parentNode"));"\u200b"===r.get("text")&&(r.set("text",""),g.selectNodeContents(r).collapse().toSelection(),d.halt());0===s&&r.test("ol>li, ul>li")&&(this._addChange(this._root.get("innerHTML")),g=r.previous("li"),s=r.get("parentNode"),g&&!c.test(g.get("text"))&&(d.halt(),(new e({root:f})).selectNodeContents(r),this.unwrapBlock(s.get("tagName"))));if(!h||"\u200b"===h||"\n"===h)return d.halt(),
this._ensureBlock()}else g.cloneRange().shrink().toSelection(),g.cloneRange().selectNodeContents(f).shrink().isEqual(g)&&this._addChange(this._root.get("innerHTML"));b.onceAfter("keyup",this._ensureBlock,this)},_onEnter:function(d){if(d.shiftKey&&!b.UA.safari)return!0;d.halt();if(!this.get("inlineOnly")){var f=this._root,g=e.fromSelection({root:f}),h=this.get("blockElementsWithHeadings"),r=g.get("startContainer").ancestor(h,!0,function(b){return b.compareTo(f)}),s=(new e({root:f})).selectNodeContents(r),
t=g.get("container"),u=t.get("parentNode").compareTo(f)&&!t.test(h),v=s.cloneRange();d.shiftKey&&520<b.UA.safari?(this._addChange(f.get("innerHTML")),r=b.config.doc.createTextNode("\u200b"),g.insertNode(r).insertNode(b.Node.create("<br/>")),g.selectNodeContents(r).collapse().toSelection()):u&&this.get("requireBlocks")?(h=this.get("defaultBlockElement"),r=b.Node.create("<"+h+"/>").set("text",t.get("text")),t.insert(r,"after"),g.setStart(r.get("firstChild"),g.get("startOffset")).collapse(!0),g.toSelection(),
t.remove()):(this._addChange(f.get("innerHTML")),g.collapsed()||g.deleteContents(),s.setEnd(g.get("startContainer"),g.get("startOffset")),v.setStart(g.get("startContainer"),g.get("startOffset")),v.collapsed()?(t=r.get("text").replace("\u200b",""),r.test("blockquote, h1, h2, h3")?(h=(s=r.previous(h.replace(/(?:blockquote)|(?:h\d)/gi,"")))&&s.get("tagName")||"p",s=s&&s.get("className")||""):c.test(t)&&r.test("li")&&!r.next("li")?(t=r.ancestor("ol, ul"),r.remove(),h=(s=t.previous(h.replace(/(?:[ou]l)|(?:h\d),/g,
"")))&&s.get("tagName")||"p",s=s&&s.get("className")||"",r=t):(h=r.get("tagName"),s=r.get("className")||""),s&&(s=' class="'+s+'"'),r=r.insert(b.Node.create("<"+h+s+">\u200b</"+h+">"),"after").next(),g.setStart(r,0).setEnd(r,0).toSelection(),f.focus()):s.collapsed()&&r.test("blockquote, h1, h2, h3")?(h=this.get("defaultBlockElement"),s=r.insert(b.Node.create("<"+h+">\u200b</"+h+">"),"before").previous(),g.setStart(s,0).setEnd(s,0).toSelection(),f.focus()):(g=r.cloneNode(!0).empty(),s.surroundContents(g),
0===g.get("text").length&&g.set("text","\u200b"),r.insert(g,"before").previous().removeAttribute("id")))}},_containerHandler:function(){var c,e,d;if(this._containerTests){var f=this._root;c=(new b.Squarespace.Range({root:f})).fromSelection().get("container");3===c._node.nodeType&&(c=c.get("parentNode"));var g={},h=!1,t=c.ancestors(function(b){return!(h=h||b.compareTo(f))},!0);c=0;for(e=t.size();c<e;c++){var u=t.item(c);for(d in this._containerTests)u.test(this._containerTests[d])&&(g[d]=u)}this.set("containers",
g)}},_setOnlyOnContainerChange:function(c,e){for(var d=this.get(e),f=Object.keys(d||{}),g=Object.keys(c||{}),h=0,t=Math.max(f.length,g.length);h<t;h++){if(f[h]!==g[h])return c;var u=d[f[h]],v=c[g[h]];if(u._node&&v._node&&u._node.href!==v._node.href)return c}return b.Attribute.INVALID_VALUE},registerContainer:function(c,e){this._containerTests||(this._containerTests={});1==arguments.length?this._containerTests=b.mix(this._containerTests,c,!0):this._containerTests[c]=e},_onPaste:function(c){this.pasting||
(this.pasting=!0,c=this.get("pasteWhitelist"),c||(c=this.get("pasteBaseWhitelist")+","+this.get("blockElementsWithHeadings"),c+=","+this._uniqueNodesInRoot(),this.set("pasteWhitelist",c)),this._pasteHolder=this._root.get("innerHTML"),this._pasteOffsets=e.fromSelection({root:this._root}).get("offsets"),this._addChange(this._pasteHolder),b.later(0,this,this._afterPaste))},_afterPaste:function(b){this.pasting&&(this.pasting=!1,(b=this._removeCommonText(this._pasteHolder,this._root.get("innerHTML")))&&
this.fire("pasteRaw",{content:b,_orig:b}))},_pasteRaw:function(c){var d=this._root,f=c._orig,g=this.get("blockElementsWithHeadings"),h=this.get("defaultBlockElement"),s={start:this._pasteOffsets.start,end:this._pasteOffsets.end},t=f.replace(/<[^>]+>/g,"").replace(/&\w+;/g," ").length,u;0===t&&null!==f.match(/<[^>]+>/g)?this.undo():(u=c.content.split(/\s*<br[^>]*>\s*<br[^>]*>\s*/gi),1<u.length&&(c.content="<"+h+">"+u.join("</"+h+"><"+h+">")+"</"+h+">"),this._pasteHolder="",this._pasteOffsets=null,
s.end=s.start+t+b.one(b.Node.create(f)).all("img").size(),t=e.fromOffsets(this._root,s),t.grow(t.get("container").ancestor(g,!0,function(b){return!b.compareTo(d)})||d),c.content===c._orig?(f=t.extractContents(),this.get("requireBlocks")&&!d.one(g)&&(c=b.Node.create("<"+h+"></"+h+">"),c.setContent(f),f=c)):(t.extractContents(),f=b.Node.create(c.content),s.end=s.start+c.content.replace(/<[^>]+>/g,"").length),this.fire("pasteCooked",{content:f,offsets:s,range:t}))},_pasteCooked:function(e){function d(c){if(c&&
1===c.get("nodeType")){for(var e=c._node.attributes,g=c.getAttribute("className").replace(/(?:\bApple-style-span\b)|(?:\brow\b)|(?:\bcol\b)|(?:\bsqsp-[^ ]+)/g,""),k=c.getAttribute("href");e.length;)c.removeAttribute(e[0].name);"div"===c._node.tagName.toLowerCase()&&(e=u.cloneNode().setContent(c.get("childNodes")),c.replace(e),c=e);c.get("childNodes").each(function(b){d(b)});c.test(t)?(g&&c.setAttribute("className",g),k&&c.setAttribute("href",k)):g?(e=f.compareTo(c.get("parentNode"))?b.Node.create('<div class="'+
g+'"/>'):b.Node.create('<span class="'+g+'"/>'),e.setContent(c.get("childNodes")),c.replace(e),c=e):1<c.get("parentNode").get("nodeType")?(e=u.cloneNode(),e.setContent(c.getContent()),c.replace(e)):h.unwrap(c)}}var f=this._root,g=e.content,r=e.offsets;e=e.range;var s=this.get("blockElementsWithHeadings"),t=this.get("pasteWhitelist"),u=b.Node.create("<"+this.get("defaultBlockElement")+"/>");g.all("b[id]").each(function(b){h.unwrap(b)});for(var v=g.one(".Apple-style-span, div > div, p > p, div > h3, div > h2, div > h1"),
w;v;)v.hasClass("Apple-style-span")||(v=v.get("parentNode")),w=v.get("parentNode"),v.get("childNodes").each(function(b){3===b._node.nodeType&&(b=u.cloneNode().setContent(b));w.insertBefore(b,v)}),v.remove(),v=g.one(".Apple-style-span, div > div, p > p, div > h3, div > h2, div > h1");g.all("b, i").each(function(c){var e=b.Node.create("b"==c.get("tagName").toLowerCase()?"<strong/>":"<em/>"),d=c.get("childNodes");e.setContent(d.size()?d:"");c.replace(e)});if(g.get("tagName")&&g.one(g.get("tagName"))){for(var y=
g.get("parentNode")||b.one(document.createDocumentFragment()),z=g.get("firstChild");z;)y.appendChild(z),z=g.get("firstChild");g=y}this.get("requireBlocks")&&(0===g.all(s).size()&&c.test(this._root.get("text")))&&(g=u.cloneNode().setContent(g));g.get("childNodes").each(function(b){d(b)});g.all(s).each(function(b){c.test(b.get("text"))&&b.remove()});g.all("div+br, p+br").remove();if((y=e.get("startContainer").previous(s)||e.get("startContainer"))&&!y.compareTo(this._root)&&c.test(y.get("text")))e.set("startContainer",
y.next(s)),y.remove();e.collapse(!0);e.insertNode(g);e.set("offsets",r).collapse().toSelection();this.pasting=!1},_uniqueNodesInRoot:function(){var b={br:1};this._root.all("*").each(function(c){var e=c.getAttribute("className").split(" ").join(".");b[c.get("tagName")+(e?"."+e:"")]=1});return Object.keys(b).join(",")},_removeCommonText:function(b,c){var e=0,d=0;if(b===c)return"";for(var f=0,g=Math.min(b.length,c.length);f<g;f++)if(b[f]===c[f])e++;else{"<"===b[f-1]&&e--;break}f=0;for(g=Math.min(b.length,
c.length)-e;f<g;f++)if(b[b.length-f]!==c[c.length-f]){for(d=f-1;c.lastIndexOf("<",c.length-1-d)>c.lastIndexOf(">",c.length-1-d);)d--;break}f===g&&(d=f);return d?c.slice(e,-d):c.slice(e)},getValue:function(){var b=this._root;e.fromSelection({root:b}).get("container");b.all(this.get("blockElementsWithHeadings")).size();var b=this._root.get("innerHTML"),c=this.get("keepWhitespaceRuns"),d=this.get("keepEmptyBlocks");return b=b.replace(/(?:[ ]{2})|(?:\s{0,20}id="yui[^"]+")|(?:(\w?)\u200b(\w?))/g,function(b,
e,f){return c&&"  "==b?"\u00a0 ":"\u200b"===b[b.length-1]||"\u200b"===b[b.length-2]?e||f||(d?"\u00a0":""):""})},_onUndo:function(b){var c=this,d=c._root,f=d.get("innerHTML"),g;0<c._history.done.length&&(g=e.fromSelection({root:this._root}).get("offsets"),setTimeout(function(){d.get("innerHTML")===f?(c.undo(),c._undoing=!1):(c._undoing=!0,c._history.undone.push({value:f,offset:g}))},0))},_onRedo:function(b){0!==this._history.undone.length&&(b.preventDefault(),this.redo())},_addChange:function(b){this.fire("change");
this._history.addChange({value:b,offset:e.fromSelection({root:this._root}).get("offsets")})},undo:function(){this._undoHelper(this._history.done,this._history.undone)},redo:function(){this._undoHelper(this._history.undone,this._history.done)},_undoHelper:function(b,c){var d=b.pop(),f,g;d&&(f=this._root.get("innerHTML"),g=e.fromSelection({root:this._root}).get("offsets"),this._root.setContent(d.value),e.fromOffsets(this._root,d.offset).toSelection(),this._root.focus(),c.push({value:f,offset:g}))}},
{NS:"editor",ATTRS:{blockElements:{valueFn:function(){return"p,li,ul,ol,dd,dt,dl,pre,figcaption,blockquote,section,div"}},blockElementsWithHeadings:{valueFn:function(){return"p,ul,ol,li,dd,dt,dl,pre,figcaption,blockquote,section,div,h1,h2,h3,h4,h5,h6"}},keyMap:{value:{8:"_onBackspace",46:"_onBackspace","13, 13+shift":"_onEnter","86+CMD, 45+shift":"_onPaste","90+CMD":"_onUndo","90+CMD+shift, 89+CMD":"_onRedo"},setter:"_updateKeyMap"},value:{getter:"getValue"},defaultBlockElement:{value:"p"},requireBlocks:{value:!0},
inlineOnly:{value:!1},keepWhitespaceRuns:{value:!0},keepEmptyBlocks:{value:!0},pasteBaseWhitelist:{value:"b,i,em,strong,a,pre"},pasteWhitelist:{value:""},editable:{value:!0,setter:"_setEditable"},containers:{value:{},setter:"_setOnlyOnContainerChange"}},_innerOuterClone:function(c,e){function d(b,e){if(e===c)return g=b,!0;e=e.firstChild;for(b=b.firstChild;e;){if(d(b,e))return!0;e=e.nextSibling;b=b.nextSibling}}c=c._node||c;var f=e.cloneNode(!0),g=f._node;d(f._node,e._node||e);return{outerNode:f,innerNode:b.one(g)}},
_innerOuterToSelector:function(b,c,e){e||(e=b._node||b);c||(c=b);var d=e.tagName,f=e.className?"."+(""+e.className).split(/\s+/g).join("."):"",g=e.id&&!/^yui/.test(e.id)?"#"+e.id:"";return!e.parentNode||e===c._node||e===c?d+g+f:h._innerOuterToSelector(b,c,e.parentNode)+">"+d+g+f},unwrap:function(c,e,d,f){c=c._node||c;e=e&&e._node||e||c;e=d?e:e.parentNode||e;if(!e)return c;for(;c!==e;){d=c.parentNode;var g=c.childNodes,s=c.previousSibling,t=c.nextSibling,u=null,v=null;if(d){for(;g.length;)u=c.firstChild,
v?v.appendChild(u.parentNode.removeChild(u)):(d.insertBefore(u,c),b.one(c).test("h1, h2, h3, h4, h5, h6")&&b.one(c.parentNode).test("div")&&(b.one(u).wrap("<p></p>"),v=u.parentNode));d.removeChild(c);if(!b.one(c).test("h1, h2, h3, h4, h5, h6")){if(!f&&t&&t.previousSibling)if(3===t.nodeType&&3==t.previousSibling.nodeType)t.previousSibling.textContent+=t.textContent,d.removeChild(t);else if(h._innerOuterToSelector(t)===h._innerOuterToSelector(t.previousSibling)){for(;t.childNodes.length;)t.previousSibling.appendChild(t.firstChild);
d.removeChild(t)}if(!f&&s&&s.nextSibling)if(3===s.nodeType&&3==s.nextSibling.nodeType)s.textContent+=s.nextSibling.textContent,d.removeChild(s.nextSibling);else if(h._innerOuterToSelector(s)===h._innerOuterToSelector(s.nextSibling)){for(;s.nextSibling.childNodes.length;)s.appendChild(s.nextSibling.lastChild);d.removeChild(s.nextSibling)}}}c=d}return c}})},"0.12.0",{requires:["plugin","base","node","squarespace-range"]});
YUI.add("resize-constrain",function(b,d){function c(){c.superclass.constructor.apply(this,arguments)}var e=b.Lang,f=e.isNumber,g=e.isString,h=b.Resize.capitalize,k=function(b){return parseFloat(b)||0};b.mix(c,{NAME:"resizeConstrained",NS:"con",ATTRS:{constrain:{setter:function(c){if(c&&(c instanceof b.Node||g(c)||c.nodeType))c=b.one(c);return c}},minHeight:{value:15,validator:f},minWidth:{value:15,validator:f},maxHeight:{value:Infinity,validator:f},maxWidth:{value:Infinity,validator:f},preserveRatio:{value:!1,
validator:e.isBoolean},tickX:{value:!1},tickY:{value:!1}}});b.extend(c,b.Plugin.Base,{constrainSurrounding:null,initializer:function(){var c=this.get("host");c.delegate.dd.plug(b.Plugin.DDConstrained,{tickX:this.get("tickX"),tickY:this.get("tickY")});c.after("resize:align",b.bind(this._handleResizeAlignEvent,this));c.on("resize:start",b.bind(this._handleResizeStartEvent,this))},_checkConstrain:function(b,c,e){var d,f,g=this.get("host").info;f=this.constrainSurrounding.border;var u=this._getConstrainRegion();
u&&(d=g[b]+g[e],c=u[c]-k(f[h("border",c,"width")]),d>=c&&(g[e]-=d-c),d=g[b],f=u[b]+k(f[h("border",b,"width")]),d<=f&&(g[b]+=f-d,g[e]-=f-d))},_checkHeight:function(){var b=this.get("host"),c=b.info,e=this.get("maxHeight")+b.totalVSurrounding,d=this.get("minHeight")+b.totalVSurrounding;this._checkConstrain("top","bottom","offsetHeight");c.offsetHeight>e&&b._checkSize("offsetHeight",e);c.offsetHeight<d&&b._checkSize("offsetHeight",d)},_checkRatio:function(){var c=this.get("host"),e=c.info,d=c.originalInfo,
g=d.offsetWidth,h=d.offsetHeight,t=d.top,u=d.left,v=d.bottom,d=d.right,w=c.changeHeightHandles,y,z;this.get("constrain")&&(c.changeHeightHandles&&c.changeWidthHandles)&&(y=this._getConstrainRegion(),w=this.constrainSurrounding.border,v=y.bottom-k(w.borderBottomWidth)-v,z=u-(y.left+k(w.borderLeftWidth)),d=y.right-k(w.borderRightWidth)-d,w=t-(y.top+k(w.borderTopWidth)),w=c.changeLeftHandles&&c.changeTopHandles?w<z:c.changeLeftHandles?v<z:c.changeTopHandles?w<d:v<d);w?(e.offsetWidth=g*(e.offsetHeight/
h),this._checkWidth(),e.offsetHeight=h*(e.offsetWidth/g)):(e.offsetHeight=h*(e.offsetWidth/g),this._checkHeight(),e.offsetWidth=g*(e.offsetHeight/h));c.changeTopHandles&&(e.top=t+(h-e.offsetHeight));c.changeLeftHandles&&(e.left=u+(g-e.offsetWidth));b.each(e,function(b,c){f(b)&&(e[c]=Math.round(b))})},_checkRegion:function(){var c=this.get("host"),e=this._getConstrainRegion();return b.DOM.inRegion(null,e,!0,c.info)},_checkWidth:function(){var b=this.get("host"),c=b.info,e=this.get("maxWidth")+b.totalHSurrounding,
d=this.get("minWidth")+b.totalHSurrounding;this._checkConstrain("left","right","offsetWidth");c.offsetWidth<d&&b._checkSize("offsetWidth",d);c.offsetWidth>e&&b._checkSize("offsetWidth",e)},_getConstrainRegion:function(){var c=this.get("host").get("node"),e=this.get("constrain"),d=null;e&&(d="view"===e?c.get("viewportRegion"):e instanceof b.Node?e.get("region"):e);return d},_handleResizeAlignEvent:function(){var b=this.get("host");this._checkHeight();this._checkWidth();this.get("preserveRatio")&&this._checkRatio();
this.get("constrain")&&!this._checkRegion()&&(b.info=b.lastInfo)},_handleResizeStartEvent:function(){var b=this.get("constrain");this.constrainSurrounding=this.get("host")._getBoxSurroundingInfo(b)}});b.namespace("Plugin");b.Plugin.ResizeConstrained=c},"3.17.2",{requires:["plugin","resize-base"]});
YUI.add("squarespace-timer-mixin",function(b){b.namespace("Squarespace");b.Squarespace.TimerMixin=b.Base.create("TimerMixin",b.Base,[],{_timer:function(b,c){this._timers||(this._timers={});c=c||"generic";this._timers[c]=this._timers[c]||[];this._timers[c].push(b);return b},destructor:function(){for(var b in this._timers)for(;0!==this._timers[b].length;)this._timers[b].shift().cancel()}})},"1.0",{requires:["base"]});
YUI.add("squarespace-dialog-stringset",function(b){var d=b.namespace("Squarespace.DialogFields").Stringset=b.Base.create("stringset-field",b.Squarespace.DialogField2,[b.WidgetParent,b.Squarespace.Mixins.StringSetUtils],{initializer:function(c){var e=this.get("mode"),d="input"===e,g=b.Lang.isValue(c.existingMembers),h=c.allowOnlyExistingMembers,k=b.Lang.isValue(c.requestUrl),d=d&&!g&&!h&&k;b.Lang.isValue(c.existingMembers)||this.set("existingMembers",[]);c.panel&&(this.panel=c.panel);!b.Lang.isNumber(c.maxMemberChars)&&
b.Lang.isNumber(parseInt(c.maxMemberChars,10))&&this.set("maxMemberChars",parseInt(c.maxMemberChars,10));d?this._requestMemberData(this._loadInputMembersSuccess):"select"===e&&(k||this.set("requestUrl","/api/commondata/GetCollectionCategories"),this._requestMemberData(this._loadSelectMembersSuccess));this.get("boundingBox").addClass(this.get("style"))},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox"),e=c.one(this._setFieldWrapper),f=this.get("style"),g=this.get("description"),
h=this.get("title")||"",k=b.Object.hasKey(this.PARTIALS,f)?f:"thin",h=b.Node.create(b.Lang.sub(this.PARTIALS[k],{title:h}));h.one(this._inputWrapperSelector).append(this.memberControl);b.Lang.isValue(g)&&(g=b.Node.create(b.Lang.sub(this.PARTIALS.descTemplate,{desc:g})),h.append(g));e.addClass(f);e.append(h);this.memberControl=c.one(this._memberContainerSelector);this.flyoutTarget=c.one(this._flyoutTargetSelector);this._renderSetMembers()},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",
this.handleWidgetClick,this);this.memberControl.on("mouseenter",this.recalcMeasurements,this);this.memberControl.on("mouseover",this.blurInactiveMember,this);this.memberControl.on("mouseout",this.resetViewportAnimation,this);this.memberControl.on("mousemove",this.mapViewportToMousePosition,this);this.on("activeMemberChange",this._animateActiveMember,this);this.on("dataChange",this.afterDataChange,this);this.on("removingMemberChange",this._tryAddPlaceholder,this)},syncUI:function(){d.superclass.syncUI.call(this);
this._updateMeasurements()},afterDataChange:function(c){var e=c.newVal,d=b.Lang.isArray(c.prevVal)?c.prevVal:[],g="_injectNewMemberList",h=[];b.Lang.isArray(c.newVal)&&e.length!==d.length&&(0===d.length&&this.memberControl.empty(),e.length<d.length&&(g="_ejectMemberList"),h=this.diffStringSets(e,d),this[g](h));this.flyout&&this.flyout.set("data",e)},handleWidgetClick:function(b){b.halt();b=b.target;var e=this.get("mode");if(b.hasClass("x"))(b=b.ancestor("."+this.get("memberClass")))&&this._destroyMember(b.getData("data"));
else if(!this._isFlyoutOpen()&&("input"===e||"select"===e))this.panel&&this.panel.setActiveFlyout({constraintClasses:".workflow-flyout",field:this}),this.showFlyout()},recalcMeasurements:function(c){b.Lang.isNumber(this.get("memberContainerWidth"))&&this._updateMeasurements()},blurInactiveMember:function(b){this._cancelTimers();if(!(b.target==this.get("activeMember")||b.target==this.get("removingMember"))&&b.target.hasClass("tag"))this._blurMember(),this.set("activeMember",b.target)},resetViewportAnimation:function(c){c=
c.target.hasClass("x");var e=!b.Lang.isNull(this._blurTimer);!c&&!e&&(this.snapBackTimer||(this.snapBackTimer=b.later(150,this,this._nudgeViewportTo,0)),this.blurTimer=b.later(50,this,this._blurMember))},mapViewportToMousePosition:function(b){var e=this.get("contentBox").one(this._inputWrapperSelector),d=e.get("offsetWidth");0<this._getViewportOverhang()&&(b=(b.clientX-e.getX())/d,this._nudgetViewportToPercent(b))},_updateData:function(c){var e=this.get("data"),d=c.newVal;c.type.indexOf("removeMember");
c=this.get("existingMembers");if(b.Lang.isString(d)||b.Lang.isArray(d))b.Lang.isString(d)&&(d=[d]),c=c.concat(d),this.set("existingMembers",b.Array.dedupe(c)),b.Array.each(d,function(b){this._hasTag(b)?e.splice(e.indexOf(b),1):e.push(b)},this),this.set("data",e)},_tryAddPlaceholder:function(c){b.Lang.isNull(c.newVal)&&0===this.get("data").length&&this._addPlaceholder()},showFlyout:function(){if(this.flyout)this.closeFlyout(b.bind(this.showFlyout,this));else{var c=this._getMemberEditorWidget();this._initFlyout(c,
{alignment:"tl",animateOpacity:!0});0===this.get("data").length&&this._addPlaceholder()}},closeFlyout:function(c,e){var d=this.flyoutPlugin,g=this.flyoutTarget,h=b.Lang.isValue(g)&&g.hasPlugin(d.NS);this.flyout&&(h&&(b.Lang.isValue(this.flyout)&&b.Lang.isFunction(this.flyout.hide)&&this.flyout.hide(),g[d.NS].on("hidden",this._cleanUpFlyout,this,c,e),g[d.NS].hide()),0===this.get("data").length&&this._addPlaceholder(!1))},_getMemberEditorWidget:function(){switch(this.get("mode")){case "input":return new b.Squarespace.DialogFields.InputEditor({allowOnlyExistingMembers:this.get("allowOnlyExistingMembers"),
autoCompleteIndex:-1,data:this.get("data"),editorLabel:this.get("editorLabel"),existingMembers:this.get("existingMembers"),memberClass:this.get("memberClass"),visible:!1});case "select":return new b.Squarespace.DialogFields.SelectEditor({addMemberText:this.get("addMemberText"),canAddMembers:this.get("canAddMembers"),collectionId:this.get("collectionId"),editorLabel:this.get("editorLabel"),data:this.get("data"),maxLength:this.get("maxMemberChars"),memberClass:this.get("memberClass"),options:this.get("existingMembers")});
default:console.warn("Unsupported mode.")}},_animate:function(c){if(!this.get("destroyed"))return c=new b.Anim(c),this._anims.add(c),c},_getViewportOverhang:function(){var b=this.get("contentBox").one(this._inputWrapperSelector).get("offsetWidth");return(this.get("memberContainerWidth")||0)-b},_nudgetViewportToPercent:function(b){var e=this._getViewportOverhang();if(0<e){if(0.04>b||0.96<b)b=Math.min(Math.round(b),1);this.get("contentBox").one(this._memberContainerSelector).setStyle("left",-1*e*b)}},
_nudgeViewportTo:function(c){var e=this._memberContainerSelector,e=this.get("contentBox").one(e);this.get("destroyed")||(this.snapBackAnim&&this.snapBackAnim.stop(),this.snapBackAnim=this._animate({node:e,duration:0.3,easing:b.Easing.easeOutStrong,to:{left:c}}),this.snapBackAnim.run(),this.snapBackTimer=null)},_blurMember:function(){var c,e;this.get("destroyed")||(c=this.get("activeMember"),b.Lang.isValue(c)&&(b.Object.hasKey(c,"anim")&&c.anim.stop(),(e=c.one(":last-child"))&&e.remove(),c.setStyle("paddingRight",
this.get("activeMemberPadding")+"px"),c.anim=this._animate({node:c,duration:0.25,easing:b.Easing.easeOutStrong,to:{paddingRight:this.get("defaultMemberPadding")}}),c.anim.run(),this.set("activeMember",null)))},_animateActiveMember:function(c){b.Lang.isNull(c.newVal)||(c=c.newVal,c.anim=this._animate({node:c,duration:0.25,easing:b.Easing.easeOutStrong,to:{paddingRight:this.get("activeMemberPadding")+"px"}}),c.anim.on("end",function(){var c=this.get("node"),d=b.Node.create('<span class="x">&times;</span>');
c.append(d);c.setStyle("paddingRight","2px")}),c.anim.run())},_cancelTimers:function(){this.blurTimer&&(this.blurTimer.cancel(),this.blurTimer=null);this.snapBackTimer&&(this.snapBackTimer.cancel(),this.snapBackTimer=null)},_updateMeasurements:function(c){var e=this.get("contentBox");b.Lang.isNumber(c)||(c=0);0<this.get("data").length&&(c=e.one(this._memberContainerSelector).get("offsetWidth")+c+this.get("defaultMemberPadding"),this.set("memberContainerWidth",c))},_renderSetMembers:function(){var c=
this.get("data");this.memberControl.empty();b.Lang.isArray(c)&&0<c.length?b.Array.each(c,function(b,c){this.memberControl.append(this._createMemberNode(b))},this):this._addPlaceholder()},_addPlaceholder:function(c){b.Lang.isUndefined(c)&&(c=this._isFlyoutOpen());b.Lang.isValue(this.memberControl)||(this.memberControl=this.get("contentBox").one(this._memberContainerSelector));this.memberControl.empty();c=b.Lang.sub('<div class="text dialog-element">{label}</div>',{label:c?this.get("emptyText"):'<div class="add-header">'+
this.get("addText")+"</div>"});this.memberControl.append(c)},_initFlyout:function(c,e){var d=this.flyoutPlugin,g=this.get("contentBox").one(this._flyoutTargetSelector);if(!b.Lang.isObject(c))throw"Flyout widget is missing.";this.flyout=this.add(c).item(0);g.hasPlugin(d.NS)&&g.unplug(d.NS);e=b.merge(e,{host:this,node:this.flyout.get("flyoutNode")});g.plug(d,{duration:0.2});g[d.NS].setAttrs(e);g[d.NS].show();this.flyout.after(["addMember","removeMember"],this._updateData,this)},_cleanUpFlyout:function(c,
e,d){var g=this.flyoutPlugin,h=this.get("contentBox").one(this._flyoutTargetSelector);this.removeAll();this.flyout.destroy(!0);this.flyout=null;h.unplug(g.NS);b.Lang.isFunction(e)&&e.apply(d||this,arguments)},_createMemberNode:function(c){var e;e=b.Node.create('<div class="tag"></div>');e.set("text",c);e.addClass(this.get("memberClass"));e.setData("data",c);return e},_destroyMember:function(b){var e=[];this.get("contentBox").all("."+this.get("memberClass")).each(function(d){d=d.getData("data");d!==
b&&e.push(d)});this.set("data",e)},_injectNewMember:function(c){var e=0,d=0,g=0;c=this._createMemberNode(c);c.setStyle("opacity",0);this.memberControl.append(c);e=c.get("offsetWidth");g=c.getStyle("paddingLeft");d=c.getStyle("paddingRight");c.setStyles({width:0,paddingLeft:0,opacity:1});var h={node:c,duration:0.25,easing:b.Easing.easeOutStrong},h=b.merge(h,{to:{width:e-20,paddingRight:d,paddingLeft:g}});c.anim=this._animate(h);c.anim.on("end",function(){this.get("node").setStyle("width","")});c.anim.run()},
_injectNewMemberList:function(c){b.Array.each(c,function(b,c){this._injectNewMember(b)},this)},_ejectMember:function(c){var e=[],d;this.get("contentBox").all(".tag."+this.get("memberClass")).each(function(b,d){b.getData("data")===c&&e.push(b)});e.length&&(d=e[0],d==this.get("activeMember")&&(this.set("activeMember",null),this.set("removingMember",d)),b.Object.hasKey(d,"anim")&&d.anim.stop(),d.anim=this._animate({node:d,duration:0.22,easing:b.Easing.easeOutStrong,to:{width:0,paddingRight:0,paddingLeft:0,
marginRight:0}}),d.anim.on("end",b.bind(function(b){d.anim.get("node").remove(!0);this.set("removingMember",null)},this)),d.anim.run())},_ejectMemberList:function(c){b.Array.each(c,function(b){this._ejectMember(b)},this)},_isFlyoutOpen:function(){var c=this.flyoutPlugin,e=this.flyoutTarget;return b.Lang.isValue(e)?!!e.hasPlugin(c.NS):!1},_hasTag:function(c,e){b.Lang.isUndefined(e)&&(e=this.get("data"));return b.Lang.isArray(e)?this.memberInSet(e,c):!1},_loadInputMembersSuccess:function(b){this.set("existingMembers",
b)},_loadSelectMembersSuccess:function(c){var e=[];b.Object.each(c,function(b,c){e.push(b.name)},this);this.set("existingMembers",e)},_requestMemberData:function(c){var e={collectionId:this.get("collectionId")},d=this.get("requestUrl");b.Data.get({url:d,data:e,success:b.bind(c,this)},this)},_memberContainerSelector:".tag-field-container",_flyoutTargetSelector:".field-input-wrapper",_setFieldWrapper:".tag-field-wrapper",_inputWrapperSelector:".field-input-wrapper",_snapBackTimer:null,_blurTimer:null,
flyoutPlugin:b.Squarespace.Animations.Flyout,PARTIALS:{thin:'<div class="field-lhs title">{title}</div><div class="field-rhs"><div class="field-input-wrapper"><div class="tag-field clear"><div class="tag-field-container"></div></div></div></div>',minor:'<div class="field-rhs"><div class="field-lhs title">{title}</div><div class="field-input-wrapper"><div class="tag-field clear"><div class="tag-field-container"></div></div></div></div>',descTemplate:'<div class="field-description-wrapper"><div class="field-description">{desc}</div></div>'}},
{CSS_PREFIX:"sqs-stringset",TEMPLATE:'<div class="field-wrapper tag-field-wrapper clear"></div>',ATTRS:{activeMember:{},addText:{value:"Click to add tags."},addMemberText:{value:"Create tag"},activeMemberPadding:{value:18},allowOnlyExistingMembers:{value:!1},canAddMembers:{value:!1},collectionId:{},data:{value:[],setter:function(c){return b.Lang.isArray(c)?c:[]},getter:function(b){return b.concat([])}},defaultMemberPadding:{value:6},description:{},editorLabel:{},emptyText:{},existingMembers:{value:[],
validator:b.Lang.isArray},memberClass:{value:"tag"},mode:{value:"input",validator:function(b){return-1!==["input","select"].indexOf(b)}},maxMemberChars:{value:null},removingMember:{},requestUrl:{},style:{value:"thin",validator:b.Lang.isString,getter:function(b){return b.toLowerCase()}},memberContainerWidth:{},title:{},visible:{value:!0}}})},"1.0.0",{requires:"base squarespace-dialog-field-2 squarespace-dialog-stringset-input-editor squarespace-dialog-stringset-select-editor squarespace-node-flyout squarespace-stringset-utils-mixin".split(" ")});
YUI.add("squarespace-dialog-slider-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-slider.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var l,p=this.escapeExpression;if((h=d["if"].call(c,(l=c.strings,null==l||!1===l?l:l.title),{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,d;return e=""+('\n<div class="title">'+p((d=(d=b.strings,null==d||!1===d?d:d.title),"function"===
typeof d?d.apply(b):d))+"</div>\n")},k),data:k}))||0===h)b+=h;b+='\n<div class="slider">\n  <div class="numeric-display" ';if((h=d["if"].call(c,c.labelWidth,{hash:{},inverse:this.noop,fn:this.program(3,function(b,c){var e,f;e='style="width: ';(f=d.labelWidth)?f=f.call(b,{hash:{},data:c}):(f=b.labelWidth,f="function"===typeof f?f.apply(b):f);return e+=p(f)+"px"},k),data:k}))||0===h)b+=h;b+='"></div>\n  <div class="slider-container" ';if((h=d["if"].call(c,c.labelWidth,{hash:{},inverse:this.noop,fn:this.program(5,
function(b,c){var e,f;e='style="margin-left: ';(f=d.labelWidth)?f=f.call(b,{hash:{},data:c}):(f=b.labelWidth,f="function"===typeof f?f.apply(b):f);return e+=p(f)+"px"},k),data:k}))||0===h)b+=h;return b+='"></div>\n</div>\n<div class="description">'+p((l=(l=c.strings,null==l||!1===l?l:l.description),"function"===typeof l?l.apply(c):l))+"</div>\n"})})();b.Handlebars.registerPartial("dialog-slider.html".replace("/","."),d.templates["dialog-slider.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-content-manager-widgets-calendar",function(b){b.namespace("Squarespace.ContentManagerWidgets");var d=b.Squarespace.ContentManagerWidgets.Calendar=b.Base.create("ContentManagerCalendar",b.Squarespace.ContentManagerWidgets.Blog,[],{bindUI:function(){d.superclass.bindUI.call(this);this.get("items")&&this._registerEvent(this.get("items").after(["*:save","*:remove","*:destroy"],this.refreshPage,this))},syncUI:function(){d.superclass.syncUI.call(this);var b=this.get("collection").get("itemCount");
this._emptyPlaceholderWidget.set("visible",0===b);this._listWidget.set("visible",0!==b)}},{LIST_WIDGET:b.Squarespace.Blog.CalendarList,PAGINATION_WIDGET:b.Squarespace.Widgets.Pagination,CSS_PREFIX:"sqs-content-manager-calendar",ATTRS:{pageSize:{value:20},searchFilterEnabled:{value:!1},"strings.emptyTitle":{value:"Add Event"},"strings.emptyDescription":{value:"There are no events. Click here to add your first item."},multiple:{value:!0}}})},"1.0",{requires:"base squarespace-ss-widget squarespace-content-manager-widgets-base squarespace-content-manager-widgets-placeholder squarespace-content-manager-blog-item-template squarespace-content-item-types-selector squarespace-content-item-types-base squarespace-content-manager-widgets-calendar-list".split(" ")});
YUI.add("squarespace-model-list-parse",function(b){function d(){}d.prototype={parse:function(c){c=this.constructor.superclass.parse.call(this,c);return b.Lang.isObject(c)&&b.Lang.isArray(c.results)?c.results:c}};b.namespace("Squarespace").ModelListParse=d},"1.0",{requires:[]});
YUI.add("button-plugin",function(b,d){function c(){c.superclass.constructor.apply(this,arguments)}b.extend(c,b.ButtonCore,{_afterNodeGet:function(c){var d=this.constructor.ATTRS;if(d=d[c]&&d[c].getter&&this[d[c].getter])return new b.Do.AlterReturn("get "+c,d.call(this))},_afterNodeSet:function(b,c){var d=this.constructor.ATTRS;(d=d[b]&&d[b].setter&&this[d[b].setter])&&d.call(this,c)},_initNode:function(c){this._host=c=c.host;b.Do.after(this._afterNodeGet,c,"get",this);b.Do.after(this._afterNodeSet,
c,"set",this)},destroy:function(){}},{ATTRS:b.merge(b.ButtonCore.ATTRS),NAME:"buttonPlugin",NS:"button"});c.createNode=function(c,d){var g;if(c&&!d&&!c.nodeType&&!(c.getDOMNode||"string"===typeof c))d=c,c=d.srcNode;d=d||{};g=d.template||b.Plugin.Button.prototype.TEMPLATE;c=c||d.srcNode||b.DOM.create(g);return b.one(c).plug(b.Plugin.Button,d)};b.namespace("Plugin").Button=c},"3.17.2",{requires:["button-core","cssbutton","node-pluginhost"]});
YUI.add("squarespace-dialog-html",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.HTML=b.Base.create("html",b.Squarespace.DialogField2,[],{bindUI:function(){d.superclass.bindUI.call(this);this._registerEvent(this.after("contentChange",this.syncUI,this))},syncUI:function(){d.superclass.syncUI.call(this);this.get("contentBox").setHTML(this.get("content"))},focus:null,blur:null,enable:null,disable:null},{CSS_PREFIX:"sqs-html",ATTRS:{content:{value:""},focusable:{value:!1}}})},
"1.0",{requires:["base","squarespace-dialog-field-2"]});
YUI.add("squarespace-content-item-types-gallery",function(b){b.namespace("Squarespace.ContentItemEditor").Gallery=b.Base.create("GalleryContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",width:800,height:450,overlay:0.5,initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.gallery"]},{$include:"tabs.options.default"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},
"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-domain-registrar",function(b){var d=b.Squarespace.Promises,c=b.Base.create("domainRegistrar",b.Base,[],{initializer:function(){this.publish("registration-start")},register:function(){return d.chainFns([this._getDomainNameFromUser,this._confirmSelection,this._performRegistration],this)()},_getDomainNameFromUser:function(){return d.submitDialog(c.DOMAIN_NAME_DIALOG_CONFIG,function(b){var c=b.domain;return this._checkAvailability(c).then(function(){return c},function(b){var c=b;
b.available||(c={errors:{domain:"This domain is unavailable."}});return d.rejectWith(c)})},this)},_confirmSelection:function(b){var c=this._getConfirmDomainDialogConfig(b);return d.getDialogData(c).then(function(){return b})},_getConfirmDomainDialogConfig:function(e){var d=b.clone(c.CONFIRM_DOMAIN_DIALOG_CONFIG);d.tabs[0].fields[0].text='<strong>Congratulations! The domain you have requested to link is not registered yet!<br/><br/>  Squarespace allows you to register up to one domain per yearly account for free.</strong> Are you sure you wish to register: <div class="domain-to-register">'+
e+"</div>";return d},_checkAvailability:function(c){return d.create(function(d,g){b.Data.post({url:"/api/domains/CheckDomainAvailability",data:{domain:c},success:function(b){b.available?d(c):g(b)},failure:g})},this)},_performRegistration:function(c){this.fire("registration-start",{domain:c});return d.create(function(d,g){b.Data.post({url:"/api/domains/RegisterDomain",data:{domain:c},success:function(c){b.Lang.isString(c.errorMsg)?g({message:c.errorMsg}):d(c)},failure:g})},this)}},{DOMAIN_NAME_DIALOG_CONFIG:{name:"registerDomain",
style:"flyout",savingText:"Checking Domain...",overlay:0.5,width:370,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Add"}],tabs:[{title:"Register Domain",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Choose a free domain below.</strong> This domain will be registered to your account.  <br/><br/> <strong>You will be the owner of this domain.</strong>  If you choose to leave Squarespace in the future, you will be given the transfer key for this domain so you can take it with you.",
padding:[0,15]}},{ctor:b.Squarespace.DialogFields.SuffixText,required:!0,name:"domain",config:{affixes:".com .org .net .biz .info .mobi".split(" ")}}]}]},CONFIRM_DOMAIN_DIALOG_CONFIG:{name:"addDomain",style:"flyout",savingText:"Registering Domain...",overlay:0.5,width:370,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Register"}],tabs:[{title:"Register Domain",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,
config:{}},{ctor:b.Squarespace.DialogFields.HTML,config:{content:'<div class="domain-tos">By registering a domain through Squarespace, you are agreeing to the Squarespace <a href="http://www.squarespace.com/domains-tos/" target="new">Domains Terms of Service.</a></div>'}}]}]}});b.namespace("Squarespace.Singletons").DomainRegistrar=new c},"1.0",{requires:["base","squarespace-attr-validators","squarespace-dialog-suffix-text","squarespace-dialog-promises","squarespace-promises"]});
YUI.add("squarespace-member-permission-utils",function(b){b.namespace("Squarespace");b.Squarespace.MemberPermissionUtils={createReplaceAndRemoveDialog:function(d,c,e){var f=c.get("pseudonymAccount"),g=f?"author":"contributor",h=c.get("email"),h=f?"":h?h:" - ",k=new b.Squarespace.MemberSelectDialog({title:"Remove "+g.capitalize(),description:b.Lang.sub("<strong>{displayName} {email}</strong> may be listed as the author of content on your site. To remove this author, please select an author to re-assign ownership to.",
{displayName:b.Escape.html(c.get("displayName")),email:h}),saveButtonText:"Replace and Remove",icon:"/universal/images-v6/icons/icon-trash-12-light.png",selectPlaceholder:"New Author",confirmationText:{title:"Remove "+g.capitalize(),body:"Are you sure you wish to remove this "+g+" and re-assign all authored entries to someone else? This cannot be undone."},showConfirmation:!0,filter:function(c){return c.get("id")===d.get("id")||b.Object.isEmpty(c.get("permissions"))?!1:!0}});k.on("member-chosen",
function(h){h=h.memberAccount.get("id");c.replaceAuthor(h,function(h){if(h)new b.Squarespace.Widgets.Alert({"strings.title":"Error Replacing Authors","strings.message":"We were unable to replace authors."}),k.allowEditing();else{var l=function(){delete Static.SQUARESPACE_CONTEXT.memberAccountNames[c.get("id")];k.close();e.destroy()};f?c.destroy({remove:!0},function(){d.destroy({remove:!0},function(){new b.Squarespace.Widgets.Information({"strings.title":g.capitalize()+" Removed","strings.message":"The specified "+
g+"has been removed."});l()})}):d.destroy({remove:!0},function(){(new b.Squarespace.Information({position:"top-right"})).show(g.capitalize()+" Removed","The specified "+g+"has been removed.");l()})}})});k.show()}}},"1.0",{requires:"base squarespace-member-select-dialog squarespace-models-website-settings squarespace-ui-base squarespace-widgets-alert squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dialog-stringset-input-editor",function(b){var d,c=function(){return 0},e=function(e){if(b.Lang.isString(e)&&0<e.length){var d=e[0];return function(b,c){var e=b.toLocaleLowerCase().indexOf(d.toLocaleLowerCase()),f=c.toLocaleLowerCase().indexOf(d.toLocaleLowerCase());return e>f?1:e<f?-1:0}}return c};d=b.namespace("Squarespace.DialogFields").InputEditor=b.Base.create("InputEditor",b.Squarespace.DialogField2,[b.WidgetChild,b.Squarespace.Mixins.StringSetUtils],{initializer:function(c){b.Lang.isValue(c.existingMembers)||
this.set("existingMembers",[]);b.Lang.isValue(c.data)||this.set("data",[])},destructor:function(){this._autoCompleteEl.remove(!0);this._autoCompleteSuggestionsEl&&this._autoCompleteSuggestionsEl.remove(!0)},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox"),e=this.PARTIALS.AC_TEMPLATE;c.one(".workflow-flyout").setStyle("width",this.get("width")+"px");c.one(".flyout-title").set("text",this.get("editorLabel"));this._editorControlEl=c.one("input");this._autoCompleteEl=
b.Node.create(e);this._autoCompleteSuggestionsEl=this._autoCompleteEl.one(".workflow-flyout-autocomplete");b.one(document.body).append(this._autoCompleteEl);this._autoCompleteEl.focus();this._autoCompleteAnim=this._anim({node:this._autoCompleteSuggestionsEl,duration:0.25,easing:b.Easing.easeOutStrong})},bindUI:function(){d.superclass.bindUI.call(this);this._editorControlEl.on("keydown",this.handleTextInput,this);this._editorControlEl.on("keyup",this.haltEvent,this);this._editorControlEl.on("valuechange",
this._displayAutoComplete,this);this._autoCompleteEl.on("click",this.handleAutoCompleteClick,this);this.after("selectedIndexChange",this.highlightSelection,this);this.before("destroy",function(){this._autoCompleteEl.remove(!0)},this);this._autoCompleteAnim.after("end",this._cleanUpHideFlyoutAnim,this)},haltEvent:function(b){b.halt()},handleTextInput:function(b){var c=b.keyCode,e=this.get("selectedIndex"),d=this.get("autoCompleteMatches");switch(c){case 13:case 188:if(-1===e)c=this._editorControlEl.get("value");
else if(c=this._autoCompleteSuggestionsEl.all(".match").item(e))c=c.getData("data");else{b.halt();break}this.addMember(c);b.halt();break;case 38:case 40:if(!d.length)break;38===c&&0<e?e--:40===c&&e<d.length-1&&e++;this.set("selectedIndex",e);b.halt();break;default:this.set("selectedIndex",-1),b.stopPropagation()}},highlightSelection:function(b){b=b.newVal;var c;this._autoCompleteSuggestionsEl&&(c=this._autoCompleteSuggestionsEl.all(".match"),c.removeClass("selected"),(match=c.item(b))&&match.addClass("selected"))},
handleAutoCompleteClick:function(b){if(b.target.hasClass("match")&&!b.target.hasClass("disabled")){b.stopPropagation();b=b.target.getData("data");if(b=this.currentMatches(b))this._displayAutoComplete(),this.addMember(b);this.resetControl();this._editorControlEl.focus();this._displayAutoComplete()}},resetControl:function(){this._editorControlEl.set("value","")},hide:function(){this._autoCompleteSuggestionsEl.hide()},alreadyHasMember:function(b){var c=this.get("data");return this.memberInSet(c,b+"")},
currentMatches:function(c){var e=this.get("autoCompleteMatches");return(e=b.Array.find(e,function(b,e){return b.value.toLowerCase()===c.toLowerCase()}))?e.value:!1},addMember:function(c){var e=this.get("existingMembers"),d=this.get("allowOnlyExistingMembers");this.get("selectedIndex");c=this.cleanMember(c);if(!b.Lang.isString(c)||0===c.length||this.alreadyHasMember(c))this._displayAutoComplete();else if(this.memberInSet(e,c)||!d)d||(e.push(c),this.set("existingMembers",e)),this._createMember(c),this.resetControl(),
this.set("selectedIndex",-1),this._displayAutoComplete()},_createMember:function(c,e){b.Lang.isUndefined(e);this.alreadyHasMember(c)||this.fire("addMember",{newVal:c})},_highlightMatch:function(c,e){return b.Highlight.all(c,e)},_processSuggestions:function(c,d,h,k){var l=[];h.sort(e(d));b.Array.each(h,function(e,h){var r=this._highlightMatch(e,d);r===b.Escape.html(e)||(l.length>=k||this.alreadyHasMember(e))||(r=b.Node.create('<div class="match">'+r+"</div>"),r.setData("data",e),c.append(r),l.push({node:r,
value:e}))},this);c.setStyles({opacity:1,display:"block"});return l},_displayAutoComplete:function(){var b=this.cleanMember(this._editorControlEl.get("value")),c=this.get("existingMembers"),e=this.get("maxSuggestions");1>e||1>c.length||(this._autoCompleteSuggestionsEl.empty(),c=this._processSuggestions(this._autoCompleteSuggestionsEl,b,c,e),this.set("autoCompleteMatches",c),this._autoCompleteAnim&&this._autoCompleteAnim.stop(),c.length&&b?this._showAutoComplete():this._hideAutocomplete())},_showAutoComplete:function(){var b=
(this.get("autoCompleteMatches")||[]).length,c={display:"block",width:this._editorControlEl.get("offsetWidth")+"px",opacity:1,left:this._editorControlEl.getX()-this._editorControlEl.get("docScrollX")+"px",top:this._editorControlEl.getY()+this._editorControlEl.get("offsetHeight")-this._editorControlEl.get("docScrollY")+"px"};this._autoCompleteEl.setStyles(c);this._autoCompleteAnim.setAttrs({to:{height:23*b+"px"}});this._editorControlEl.setStyles({borderBottomLeftRadius:"0px",borderBottomRightRadius:"0px"});
this._autoCompleteAnim.run()},_hideAutocomplete:function(){this._autoCompleteAnim.setAttrs({to:{height:0}});this._autoCompleteAnim.run()},_cleanUpHideFlyoutAnim:function(b){b=this._autoCompleteAnim.get("node");var c=this.get("borderRadius");b&&1>b.get("clientHeight")&&(b.setStyle("display","none"),this._editorControlEl.setStyles({borderBottomLeftRadius:c,borderBottomRightRadius:c}))},_anim:function(c){if(!this.get("destroyed"))return c=new b.Anim(c),this._anims.add(c),c},PARTIALS:{AC_TEMPLATE:'<div class="workflow-flyout tight"><div class="workflow-flyout-autocomplete clear"></div></div>'}},
{CSS_PREFIX:"sqs-stringset-input-editor",TEMPLATE:'<div class="workflow-flyout tight"><div class="workflow-flyout-options clear"><div class="flyout-title"></div><input class="field-input" placeholder="Tags, comma separated"></div><div class="flyout-notch"></div></div>',ATTRS:{allowOnlyExistingMembers:{},autoCompleteMatches:{validator:b.Lang.isArray},borderRadius:{value:"3px"},canAddMembers:{},editorLabel:{value:""},data:{value:[]},emptyText:{value:""},existingMembers:{},flyoutNode:{getter:function(){return this.get("contentBox").one(".workflow-flyout")}},
maxMemberChars:{},maxSuggestions:{value:6},selectedIndex:{value:-1,setter:function(c){c=parseInt(c,10);return b.Lang.isNumber(c)&&-1<c?c:-1}},width:{value:250}}})},"1.0.0",{requires:["base","base-build","highlight","squarespace-stringset-utils-mixin","squarespace-dialog-field-2"]});
YUI.add("swfdetect",function(b,d){function c(b){g.isNumber(parseInt(b[0],10))&&(f.flashMajor=b[0]);g.isNumber(parseInt(b[1],10))&&(f.flashMinor=b[1]);g.isNumber(parseInt(b[2],10))&&(f.flashRev=b[2])}var e=0,f=b.UA,g=b.Lang,h,k,l;if(f.gecko||f.webkit||f.opera){if(e=navigator.mimeTypes["application/x-shockwave-flash"])if(e=e.enabledPlugin)h=e.description.replace(/\s[rd]/g,".").replace(/[A-Za-z\s]+/g,"").split("."),c(h)}else if(f.ie){try{k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6"),k.AllowScriptAccess=
"always"}catch(p){null!==k&&(e=6)}if(0===e)try{l=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),h=l.GetVariable("$version").replace(/[A-Za-z\s]+/g,"").split(","),c(h)}catch(q){}}b.SWFDetect={getFlashVersion:function(){return String(f.flashMajor)+"."+String(f.flashMinor)+"."+String(f.flashRev)},isFlashVersionAtLeast:function(b,c,e){var d=parseInt(f.flashMajor,10),g=parseInt(f.flashMinor,10),h=parseInt(f.flashRev,10);b=parseInt(b||0,10);c=parseInt(c||0,10);e=parseInt(e||0,10);return b===d?c===g?
e<=h:c<g:b<d}}},"3.17.2",{requires:["yui-base"]});
YUI.add("squarespace-content-item-types-product-service",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.ProductService=b.Base.create("ProductServiceContentItemEditor",b.Squarespace.ContentItemEditor.ProductVariants,[],{getDialogData:function(){var c=d.superclass.getDialogData.call(this);c.pricingPlaceholder={productType:b.Squarespace.ProductTypes.SERVICE,variants:c.variants.variants};return c},getPresentationName:function(){return"Service Product"}},{ATTRS:{editorConfiguration:{value:{name:"editProduct",
title:"Edit {presentationName}",width:850,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?550:420}},overlay:0.5,closeOthers:!1,initialDataByReference:!0,tabs:[{$include:"tabs.primary.product.base",$update:{".pricingPlaceholder":{$include:"fields.productVariantsPricingPlaceholder"}}},{$include:"tabs.product.variantsService"},{$include:"tabs.product.additionalInfo"},{$include:"tabs.product.workflow"},{$include:"tabs.options.product"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},
"1.0",{requires:["base","squarespace-util","squarespace-content-item-types-product-variants"]});
YUI.add("squarespace-models-attachments-list",function(b){var d=b.namespace("Squarespace.Models").AttachmentsList=b.Base.create("AttachmentsList",b.Squarespace.Models.ModelList,[b.Squarespace.Mixins.PaginatedModelList],{model:b.Squarespace.Models.ContentItem,url:b.Squarespace.API_ROOT+"content-items?recordType={recordType}"},{ATTRS:{paginator:{valueFn:function(){return new b.Squarespace.Models.RangePaginator({models:this,orderBy:"addedOn",orderDirection:b.Squarespace.OrderDirection.DESCENDING})}},
recordType:{value:b.Squarespace.RecordType.ATTACHMENT,readOnly:!0},pageSize:{validator:b.Lang.isNumber,value:20,setter:function(b){this.get("paginator").set("limit",b)}}}});b.namespace("Squarespace.Models").SearchedAttachmentsList=b.Base.create("SearchedAttachmentsList",d,[],{url:b.Squarespace.API_ROOT+"content-items/search?transient=true&recordType={recordType}&q={searchQuery}"},{ATTRS:{paginator:{valueFn:function(){return new b.Squarespace.Models.OffsetPaginator({models:this,orderBy:"addedOn",orderDirection:b.Squarespace.OrderDirection.DESCENDING})}},
searchQuery:{validator:b.Lang.isString,value:""}}})},"1.0",{requires:"squarespace-models-model-list squarespace-models-range-paginator squarespace-models-offset-paginator squarespace-models-content-item squarespace-model-sync-rest squarespace-mixins-paginated-model-list base".split(" ")});
YUI.add("squarespace-existing-content-link-tab",function(b){var d=b.namespace("Squarespace.Views").ExistingContentLinkTab=b.Base.create("ExistingContentLinkTab",b.Squarespace.View,[],{template:"existing-content-link-tab.html",initializer:function(c){d.superclass.initializer.apply(this,arguments);this._contentOptions=new b.Squarespace.DialogFields.ContentSelector({data:this.get("selectedContent")});this.get("disableNewWindow")||(this._newWindowField=new b.Squarespace.DialogFields.Check({name:"newWindow",
"strings.title":"Open in new window",data:this.get("newWindow")}))},render:function(){d.superclass.render.apply(this,arguments);var b=this.get("container");this._contentOptions.render(b.one(".content-options"));this.get("disableNewWindow")||this._newWindowField.render(b.one(".existing-content-link-tab"));this.bindUI()},bindUI:function(){this._contentOptions.on("dataChange",function(b){this.set("selectedContent",b.newVal);this._dataChanged()},this);this.get("disableNewWindow")||this._newWindowField.after("dataChange",
function(b){this.set("newWindow",b.newVal);this._dataChanged()},this)},reset:function(){this.set("selectedContent",null);this._contentOptions.clearSelected()},_dataChanged:function(){var c=this.get("onDataChange");if(b.Lang.isFunction(c)){var e=this.get("selectedContent"),d=this.get("newWindow");c(e,d)}}},{ATTRS:{onDataChange:{value:null},selectedContent:{value:null},disableNewWindow:{value:!1},newWindow:{value:!1}}})},"1.0",{requires:"base squarespace-dialog-check squarespace-dialog-content-selector squarespace-dialog-html squarespace-dialog-text squarespace-existing-content-link-tab-template squarespace-ui-base squarespace-view".split(" ")});
YUI.add("squarespace-content-item-image",function(b){b.namespace("Squarespace");b.Squarespace.ContentItemImage=b.Base.create("ContentItemImage",b.Squarespace.SSWidget,[b.WidgetChild,b.Squarespace.TimerMixin],{initializer:function(){this.publish("aviary-start",{emitFacade:!0});this.publish("aviary-finish",{emitFacade:!0});this.publish("remove",{emitFacade:!0})},destructor:function(){this.get("item").detach(this.get("id")+"|*")},renderUI:function(){var d=this.get("contentBox"),c=b.Squarespace.RecordTypeString[this.get("item").get("recordType")];
"store_item"===c&&(c="product");d.addClass("item-type-"+c);b.Cookie.get("SQUARESPACE_DEBUG_DISPLAY_INDEX")&&(d.appendChild(b.Node.create('<div class="index">'+this.get("item").get("displayIndex")+"</div>")),d.appendChild(b.Node.create('<div class="itemId">'+this.get("item").get("id")+"</div>")));d.appendChild(b.Node.create('<div class="inside"></div>'))},bindUI:function(){b.Cookie.get("SQUARESPACE_DEBUG_DISPLAY_INDEX")&&this.get("item").after("displayIndexChange",function(b){this.get("contentBox").one(".index").setHTML(b.newVal)},
this);var d=this.get("boundingBox"),c=this.get("contentBox"),e=this.get("id"),f=this.get("item"),g=f.get("items");this._registerEvent(f.after(["titleChange","workflowStateChange","save"],function(c){b.Lang.isValue(c.options)&&"mediaFocalPointChange"==c.options.source||this.syncUI()},this));if(this._useFirstChild()){this._currentSyncRequest=null;var h=b.bind(function(b){this._registerEvent(b.after(e+"|mediaProcessingStateChange",function(c){0===g.indexOf(b)&&this.syncUI()},this))},this);g.each(function(b){h(b)},
this);this._registerEvent(g.after(e+"|add",function(c){var e=c.model;0===c.index&&e.get("mediaProcessingState")===b.Squarespace.MediaProcessingState.READY&&this.syncUI();h(e)},this));this._registerEvent(g.after(e+"|remove",function(b){0===b.index&&this.syncUI()},this))}else this._registerEvent(f.after(e+"|mediaProcessingStateChange",this.syncUI,this));d.on("click",function(b){if(d.one("img")&&b.target.ancestor(".inside",!0)||!d.one("img"))this.set("selected",0!==this.get("selected")?0:1)},this);if(this.get("editable"))d.on(["dblclick",
"contextmenu"],function(b){b.halt();this.editItem()},this);this.get("animation")&&c.plug(this.get("animation"),{onlyUseOpacity:!0});this.on("animationChange",function(b){b.prevVal&&this.get("contentBox").unplug(b.prevVal);b.newVal&&this.get("contentBox").plug(b.newVal,{onlyUseOpacity:!0})},this);c.delegate("click",function(){this.fire("remove")},".image-processing-error a",this);this.after("preventLoadChange",this.syncUI,this)},syncUI:function(){if(!this.get("preventLoad")){var d=this.get("contentBox"),
c=this.get("contentBox").one(".inside"),e=b.bind(function(){this._hideProgressIndicator();c.empty()},this),f=b.bind(function(){var c=this.get("item"),e=this._getRenderingImageItem();switch(e?e.get("mediaProcessingState"):b.Squarespace.MediaProcessingState.READY){case b.Squarespace.MediaProcessingState.QUEUED:case b.Squarespace.MediaProcessingState.PROCESSING:this._showProgressIndicator();break;case b.Squarespace.MediaProcessingState.READY:this._showImage(e||c);this.get("showActionOverlay")&&this._showActionOverlay();
break;default:this._usePlaceholder()?(this._showImage(e||c),this.get("showActionOverlay")&&this._showActionOverlay()):this._showError()}},this);this.get("animation")?(d.plug(this.get("animation")),d.once("hidden",function(){this.get("destroyed")||(e(),f());this._timer(b.later(20+200*Math.random(),this,function(){this.get("destroyed")||d.show()}))},this),d.hide()):this.get("destroyed")||(e(),f())}},editItem:function(){var d=this.get("item"),d=new (b.Squarespace.ContentItemEditorFactory.getEditor(d,
this.get("itemEditorOptions")))({model:d,parentDialog:this.get("itemEditorOptions.parentDialog")});this.get("itemEditorOptions.anchorToImageWidget")&&d.set("anchorNode",this.get("boundingBox"));d.show();return d},_uiSetChildSelected:function(b){this.get("boundingBox")[b?"addClass":"removeClass"]("selected")},_showProgressIndicator:function(){var d=this.get("contentBox").one(".inside");d.addClass("processing");d.plug(b.Squarespace.Plugin.ProgressSpinner,{show:!0,showCancel:!0,spinnerSize:this.get("progressSpinnerSize")}).progress.once("cancel",
function(b){this.fire("remove")},this)},_hideProgressIndicator:function(){var d=this.get("contentBox").one(".inside");d&&d.hasClass("processing")&&(d.removeClass("processing"),d.unplug(b.Squarespace.Plugin.ProgressSpinner))},_showError:function(){var d=b.Node.create('<div class="image-processing-error"><p>Something went wrong.<br /><a href="#" class="remove">Remove</a></p></div>');d.one("p a.remove").once("click",function(b){b.halt();this.fire("remove")},this);this.get("contentBox").one(".inside").appendChild(d)},
_getRenderingImageItem:function(){return this._useFirstChild()?this.get("item").get("items").item(0):this.get("item")},_showImage:function(d){this.get("boundingBox");var c=this.get("contentBox"),e=b.Node.create('<img data-load="false" data-src="'+d.get("assetUrl")+'" data-image-dimensions="'+d.get("originalSize")+'" />');c.one(".inside").appendChild(e);e.setStyles({visibility:"hidden"});c.setStyles({backgroundImage:null,backgroundSize:null});d.get("hasFileData")&&this._showFocalPoint()&&(c=e.plug(b.Squarespace.Plugin.FocalPoint,
{focalPoint:d.get("mediaFocalPoint")}).focalPoint,c.on("focalPointChanged",function(b){d.set("mediaFocalPoint",b.focalPoint);d.save({fields:["mediaFocalPoint"],source:"mediaFocalPointChange"})},this),c.on("focalPointChange",function(b){d.set("mediaFocalPoint",b.newVal)}));var f=this._timer(b.later(1E3,this,function(){!this.get("destroyed")&&(e.getDOMNode()&&e.inDoc())&&this._showProgressIndicator()}));e.once("load",function(){f&&f.cancel();this._hideProgressIndicator();var c=this.get("animation");
c?this._timer(b.later(20+200*Math.random(),this,function(){!this.get("destroyed")&&(e.getDOMNode()&&e.inDoc())&&(e.setStyles({visibility:null}),c&&(e.plug(c),e.hide(!0),e.show(),this._showItemSpecificInformation()))})):e.setStyles({visibility:null})},this);e.once("error",function(){f&&f.cancel();e.setAttribute("src","/universal/images-v6/configuration/template-no-image.png")},this);e.loader||e.plug(b.Squarespace.Loader2,{mode:"fit",load:!0})},_showItemSpecificInformation:function(){var d=this.get("item"),
c=this.get("contentBox").one(".inside"),e=c.one("img"),f=e.get("width"),g=e.get("offsetLeft"),h=e.get("offsetTop"),k;switch(this.get("item").get("recordType")){case b.Squarespace.RecordType.STORE_ITEM:k=b.Node.create('<div class="information"><div class="title">'+this.get("item").get("title")+'</div><div class="price">'+b.Squarespace.Commerce.priceString(this.get("item").toJSON())+"</div></div>");k.setStyles({width:f,left:g,bottom:h});c.append(k);var l=k.one(".price").get("offsetWidth");k.one(".title").setStyle("width",
k.get("offsetWidth")-l-20);this.get("showWorkflowState")&&d.get("workflowState")!==b.Squarespace.WorkflowStates.PUBLISHED&&(d=b.Node.create('<div class="flag-wrapper"><div class="flag-text">Not Listed</div></div>'),d.setStyles({width:f,height:e.get("height"),left:g,top:h}),c.append(d));break;case b.Squarespace.RecordType.IMAGE:k=d.get("workflowState");this.get("showWorkflowState")&&k!==b.Squarespace.WorkflowStates.PUBLISHED&&(d=b.Node.create('<div class="flag-wrapper"><div class="flag-text">'+b.Squarespace.ContentItemUtils.getWorkflowStateCopy(k)+
"</div></div>"),d.setStyles({width:f,height:e.get("height"),left:g,top:h}),c.append(d));break;default:if(l=b.Node.create('<div class="type-icon"></div>'),l.setStyles({top:h+5,left:g+5}),c.append(l),d=d.get("workflowState"),this.get("showWorkflowState")&&d!==b.Squarespace.WorkflowStates.PUBLISHED&&(d=b.Node.create('<div class="flag-wrapper"><div class="flag-text">'+b.Squarespace.ContentItemUtils.getWorkflowStateCopy(k)+"</div></div>"),d.setStyles({width:f,height:e.get("height"),left:g,top:h}),c.append(d)),
e=this.get("item").get("title"))k=b.Node.create('<div class="information"><div class="title">'+e+"</div></div>"),k.setStyles({width:f,left:g,bottom:h}),c.append(k)}},_showActionOverlay:function(){this._actionOverlay&&this._actionOverlay.destroy();var d=this.get("contentBox");d.plug(b.Squarespace.Plugin.ActionOverlay,{buttons:this.get("actionOverlayButtons"),position:0.5<=this.get("item").get("mediaFocalPoint").y?"top":"bottom"});var c=this._actionOverlay=d.actionOverlay,e=b.Squarespace.ActionOverlayButtons.EDIT_IMAGE;
c.on("button-"+e,function(d){c.setLoadingState(e,!0);b.Aviary.once("ready",function(){c.setLoadingState(e,!1);this.fire("aviary-start")},this);b.Aviary.once("close",function(){this.fire("aviary-finish")},this);b.Aviary.launch(this.get("item"),b.Squarespace.UploadModes.ITEM)},this);c.on("button-"+b.Squarespace.ActionOverlayButtons.IMAGE_INFO,function(){this.editItem()},this);c.on("button-"+b.Squarespace.ActionOverlayButtons.REMOVE_IMAGE,function(){this.fire("remove")},this);if((d=d.one("img"))&&d.focalPoint)d.focalPoint.on("focalPointChanged",
function(b){c.set("position",0.5<=b.focalPoint.y?"top":"bottom")},this);c.render()},_usePlaceholder:function(){var d=b.Squarespace.RecordType;return-1!==[d.VIDEO,d.TEXT,d.STORE_ITEM].indexOf(this.get("item").get("recordType"))},_useFirstChild:function(){var d=b.Squarespace.RecordType;return-1!==[d.STORE_ITEM,d.GALLERY].indexOf(this.get("item").get("recordType"))},_showFocalPoint:function(){return this.get("item").get("recordType")===b.Squarespace.RecordType.IMAGE}},{CSS_PREFIX:"sqs-content-item-image",
ATTRS:{item:{validator:function(d){return b.instanceOf(d,b.Squarespace.Models.ContentItem)}},parentModel:{validator:function(d){return b.instanceOf(d,b.Squarespace.Models.ContentCollection)||b.instanceOf(d,b.Squarespace.Models.Contentitem)}},animation:{value:b.Squarespace.Animations.Fadeable},showActionOverlay:{value:!1},actionOverlayButtons:{value:[b.Squarespace.ActionOverlayButtons.EDIT_IMAGE,b.Squarespace.ActionOverlayButtons.IMAGE_INFO,b.Squarespace.ActionOverlayButtons.REMOVE_IMAGE]},showWorkflowState:{value:!0},
progressSpinnerSize:{value:30},editable:{value:!1},itemEditorOptions:{value:{}},preventLoad:{value:!1}}})},"1.0",{requires:"squarespace-animations squarespace-aviary squarespace-commerce-utils squarespace-content-item-utils squarespace-enum squarespace-image-loader squarespace-models-content-collection squarespace-models-content-item squarespace-plugin-actionoverlay squarespace-plugin-focalpoint squarespace-plugin-progress-spinner squarespace-ss-widget squarespace-timer-mixin squarespace-util widget-child".split(" ")});
YUI.add("squarespace-settings-site-templates",function(b){var d=b.namespace("Squarespace.Settings.Site").Templates=b.Base.create("templateSettings",b.Squarespace.Widgets.SettingsPanel,[],{isAllowedToTemplateSwitch:function(){return!b.Squarespace.Singletons.Template.isTemplateOwner()},initializer:function(){this.isAllowedToTemplateSwitch()?(this.set("strings.title","Template"),this.set("strings.description",'Use this area to switch the look and feel of your Squarespace website. <strong>You can switch templates at any time.</strong> To preview a new template, install it using the button on the upper right. Previewing a template below will allow you to see what your site will look like without changing how your visitors see your site. <a target="new" href="'+
b.Squarespace.HelpLinks.TEMPLATES+'">Click here for more help regarding templates.</a>'),this._installedTemplates=b.Squarespace.Singletons.TemplateInstallationListCache,this._registerEvent(this._installedTemplates.once("load",function(){this.setLoadedState();this.syncUI()},this)),this.setLoadingState(),this._installedTemplates.load()):(this.set("strings.title","Templates (Disabled)"),this.set("strings.description","<strong>Your site has Developer Mode enabled, template switching is disabled.</strong> "))},
renderUI:function(){d.superclass.renderUI.call(this);this.isAllowedToTemplateSwitch()&&this.get("contentBox").append('<div class="active-template"></div>').append('<div class="templates clearfix"></div>')},bindUI:function(){d.superclass.bindUI.call(this);if(this.isAllowedToTemplateSwitch()){this._registerEvent(this._installedTemplates.on("add",function(e){var d;this.each(function(e,f){e instanceof c&&(e.get("boundingBox").plug(b.Squarespace.PositionAnimator).positionAnimator.hold(),b.Lang.isValue(d)||
(d=e))});e=this._renderInstalledTemplate(e.model);b.Lang.isValue(d)&&d.get("boundingBox").insert(e.get("boundingBox"),"after");this.each(function(b){b instanceof c&&b.positionAnimator.release()})},this));var e=Static.SQUARESPACE_CONTEXT.website.templateId;this._registerEvent(b.Squarespace.Singletons.Template.on("idChange",function(){this.each(function(b){b instanceof c&&b.syncUI()});var d=Static.SQUARESPACE_CONTEXT.website.templateId;if(e!=d){var g;this.each(function(e){e instanceof c&&(e.get("boundingBox").plug(b.Squarespace.PositionAnimator).positionAnimator.hold(),
e.get("model").get("templateId")==d&&(g=e))});this.get("contentBox").one(".templates").prepend(g.get("boundingBox"));this.each(function(b){b instanceof c&&b.get("boundingBox").positionAnimator.release()});e=d}},this))}},syncUI:function(){d.superclass.syncUI.call(this);if(this.isAllowedToTemplateSwitch()){var e=[];this.each(function(b){b instanceof c&&e.push(b)});b.Array.each(e,function(b){this.remove(this.indexOf(b))},this);this.isAllowedToTemplateSwitch()&&this.loadedSuccessfully()&&this._installedTemplates.sort().each(function(b){this._renderInstalledTemplate(b)},
this)}},_renderInstalledTemplate:function(b){return this.add({childType:c,model:b,render:this.get("contentBox").one(".templates"),damask:this.get("damask")}).item(0)},addItem:function(){var c=new b.Squarespace.TemplatePicker({render:!0});c.once("install-template",function(d){c.destroy();b.Squarespace.Models.TemplateInstallation.createWithTemplateWebsiteIdentifier(d.identifier).then(b.bind(function(c){new b.Squarespace.Widgets.Information({"strings.title":"Installation Successful","strings.message":"The requested template has been successfully installed."});
this._installedTemplates.add(c)},this),b.bind(function(c){new b.Squarespace.Widgets.Alert({"strings.title":"Cannot Install Template","strings.message":c.error})}))},this)},_uiAddChild:function(b,f){if(b instanceof c){f=this.get("contentBox").one(".templates");var g=b.get("boundingBox");f.contains(g)||f.appendChild(b.get("boundingBox"))}else d.superclass._uiAddChild.apply(this,arguments)}},{CSS_PREFIX:"sqs-template-settings",ATTRS:{damask:{},buttons:{valueFn:function(){return b.Squarespace.Singletons.Template.isTemplateOwner()?
[]:[{label:"Install Template",type:"add"}]}}}}),c=b.Base.create("InstalledTemplateView",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{renderUI:function(){var c=this.get("contentBox");c.appendChild(b.Node.create('<div class="thumbnail-wrapper"></div>')).appendChild(b.Node.create('<div class="button-wrapper"></div>')).appendChild(b.Node.create('<div class="buttons"></div>')).append(b.Node.create('<div class="button button-edit" data-action="preview">Preview</div>')).append(b.Node.create('<div class="button button-remove" data-action="remove">Uninstall</div>')).append(b.Node.create('<div class="button button-enable" data-action="enable">Set as Live Template</div>')).append(b.Node.create('<div class="button button-cancel-preview" data-action="cancel-preview">Cancel Preview</div>'));
c.appendChild(b.Node.create('<div class="meta-wrapper"></div>')).append(b.Node.create('<div class="header"></div>').append('<div class="title"></div>').append('<div class="indicator"></div>')).append(b.Node.create('<div class="installed-on"></div>'))},bindUI:function(){this.get("model");this.get("contentBox").one(".buttons").delegate("click",function(b){b=b.target.getAttribute("data-action");"preview"==b?this._setAsPreviewTemplate():"remove"==b?this._removeTemplate():"enable"==b?this._enableTemplate():
"cancel-preview"==b&&this._cancelPreview()},"div[data-action]",this)},syncUI:function(){var c=this.get("model"),d=this.get("boundingBox"),g=this.get("contentBox"),h=g.one(".header");h.one(".title").setContent(c.get("displayName"));h.one(".indicator").addClass("hidden");d.removeClass("active-template");d.removeClass("preview-template");c.get("isActiveTemplate")?(h.one(".indicator").removeClass("hidden").setContent("Live"),d.addClass("active-template")):c.get("isPreviewTemplate")&&(h.one(".indicator").removeClass("hidden").setContent("Previewing"),
d.addClass("preview-template"));g.one(".thumbnail-wrapper").setStyles({backgroundImage:"url("+c.getThumbnailAssetUrl("500w")+")"});g.one(".installed-on").setContent("Installed "+b.Squarespace.DateUtils.humanizeDate(new Date(c.get("installedOn")))+".")},_setAsPreviewTemplate:function(){var e=this.get("model"),d=this.get("contentBox").one(".button-wrapper"),g=this.get("boundingBox");d.plug(b.Squarespace.Plugins.LoadingOverlay);g.addClass("show-overlay");b.Squarespace.Singletons.TemplateInstallationListCache.setPreviewInstallation(e).then(b.bind(function(){d.unplug(b.Squarespace.Plugins.LoadingOverlay);
if(!b.Squarespace.Utils.isDamaskEnabled()){var e=this.get("parent");e.each(function(e){e instanceof c&&e.get("boundingBox").plug(b.Squarespace.PositionAnimator).positionAnimator.hold()});e.get("boundingBox").one(".templates").prepend(this.get("boundingBox"));e.each(function(b){b instanceof c&&b.get("boundingBox").positionAnimator.release(!0)})}g.removeClass("show-overlay");b.Squarespace.Utils.isDamaskEnabled()?this.get("damask").get("previewFrame").requestRefresh():window.CONFIG_PANEL.showSite({targetUrl:"/?source=preview"})},
this),b.bind(function(c){(new b.Squarespace.SystemError("",c.responseJSON,"json")).show()}))},_removeTemplate:function(){var e=this.get("model"),d=this.get("boundingBox");d.addClass("show-overlay");var g=new b.Squarespace.Widgets.Confirmation({"strings.title":"Uninstall Template","strings.message":"Are you sure you wish to uninstall the template <strong>"+e.get("displayName")+"</strong>?"});g.on("confirm",function(){e.destroy({remove:!0},b.bind(function(){d.removeClass("show-overlay");var e=this.get("parent");
e.each(function(e){e instanceof c&&e.get("boundingBox").plug(b.Squarespace.PositionAnimator).positionAnimator.hold()});this.destroy();e.each(function(b){b instanceof c&&b.get("boundingBox").positionAnimator.release(!0)})},this))},this);g.on("cancel",function(){d.removeClass("show-overlay")},this)},_enableTemplate:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Enable Template","strings.message":"Are you sure you wish to make this template live for all of your website visitors?"})).on("confirm",
function(){var c=this.get("model");b.Squarespace.Singletons.TemplateInstallationListCache.setActiveInstallation(c).then(function(){new b.Squarespace.Widgets.Information({"strings.title":"Live Template Updated","strings.message":"You have successfully updated your live template. Your website visitors will now see your new design."})})},this)},_cancelPreview:function(){b.Squarespace.Singletons.TemplateInstallationListCache.setPreviewInstallation(null).then(b.bind(function(){b.Squarespace.Utils.isDamaskEnabled()&&
this.get("damask").get("previewFrame").requestRefresh();new b.Squarespace.Widgets.Information({"strings.title":"Preview Canceled","strings.message":"You are no longer previewing the requested template."})},this))}},{CSS_PREFIX:"sqs-installed-template",ATTRS:{model:{},damask:{}}})},"1.0",{requires:"squarespace-date-utils squarespace-ss-widget squarespace-settings-panel model-sync-rest squarespace-template-picker squarespace-template-install squarespace-models-template-installation promise parallel squarespace-plugin-loading-overlay squarespace-models-member-website-settings squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-configuration-panel-footer",function(b){b.namespace("Squarespace").ConfigurationPanelFooter=b.Base.create("ConfigurationPanelFooter",b.Squarespace.SSWidget,[b.WidgetChild],{renderUI:function(){var d=Static.SQUARESPACE_CONTEXT,c=d.website.siteStatus.value,e=b.Squarespace.StatusConstants,f=c===e.EXPIRED,e=c===e.TRIAL,g=d.billingStatus===b.Squarespace.BillingStatus.SUBSCRIBED,c=this.get("contentBox"),d=!1;c.appendChild('<div class="shadow"></div>');var h=b.Squarespace.Singletons.TemplateInstallationListCache.getPreviewInstallation();
b.Lang.isValue(h)&&(d=!0,this._renderTemplatePreview(h));!g&&f?(d=!0,f=b.Node.create(this.constructor.EXPIRED_ACCT_UPGRADE_BTN_TEMPLATE),f.on("click",function(){document.location.href="/config/upgrade"}),c.appendChild(f)):!g&&e&&(d=!0,f=b.Node.create(this.constructor.TRIAL_ACCT_UPGRADE_BTN_TEMPLATE),f.on("click",function(){document.location.href="/config/upgrade"}),c.appendChild(f));this.set("visible",d);(f=this.get("scrollingNode"))&&f.setStyles({bottom:d?this.get("boundingBox").get("offsetHeight"):
0})},bindUI:function(){var d=this.get("scrollingNode");d&&(this._registerEvent(b.on("resize",this._uiSyncShadow,b.config.win,this)),this._registerEvent(d.on("scroll",this._uiSyncShadow,this)));this._registerEvent(b.Squarespace.Singletons.AuthenticatedMemberWebsiteSettings.after("previewInstallationIdChange",function(b){var e=this.get("boundingBox");e.anim({bottom:-20,opacity:0},{end:function(){this.get("contentBox").empty();this.renderUI();this.syncUI();e.anim({bottom:0,opacity:1}).run()}},this).run()},
this))},syncUI:function(){this._uiSyncShadow()},_uiSyncShadow:function(){var b=this.get("scrollingNode");if(b){var c=b.get("offsetHeight"),e=b.get("scrollHeight"),b=b.get("scrollTop"),c=e-c,c=0<c?1-b/c:0,e=this.get("contentBox");e.one(".shadow").setStyles({opacity:c});e.toggleClass("fully-scrolled",0===c)}},_renderTemplatePreview:function(b){this.get("contentBox").appendChild('<div class="sqs-preview-template-indicator"></div>').append('<div class="sqs-preview-template-indicator-header"><strong>You are currently previewing '+
b.get("displayName")+".</strong>This template is only visible to you. Changes to your navigation will not affect your live website.</div>").append('<div class="sqs-preview-template-indicator-action"><a href="#module=settings&settings-subpanelName=template-settings">Manage Templates</a></div>')}},{CSS_PREFIX:"sqs-configuration-panel-footer",EXPIRED_ACCT_UPGRADE_BTN_TEMPLATE:'<button class="activate-button expired">Expired Account &mdash; Upgrade Now</button>',TRIAL_ACCT_UPGRADE_BTN_TEMPLATE:'<button class="activate-button expired">Trial Account &mdash; Upgrade Now</button>',
ATTRS:{linkNodes:{value:[]},scrollingNode:{}}})},"1.0",{requires:["base","squarespace-ss-widget","squarespace-models-template-installation"]});
YUI.add("squarespace-block-social-account-links-legacy-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog").LegacySocialAccountLinks=b.Base.create("SocialAccountLinksLegacyModelEditor",b.Squarespace.Block.ModelEditorDialog.SocialAccountLinks,[],{initializer:function(){var d=this.get("dialogConfig"),c=d.tabs[0];c.fields=b.Array.filter(c.fields,function(b){return"ordering-desc"!==b.config.name});d.tabs.unshift({tabTitle:"Links",title:"Edit Social Links",icon:"/universal/images-v6/icons/icon-social-18-light.png",
scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.SocialAccountPicker,name:"accountIds",config:{accounts:{$include:"socialAccountPickerAccounts"}}}]})}})},"1.0",{requires:["base","squarespace-dialog-social-account-picker","squarespace-block-social-account-links-model-editor"]});
YUI.add("squarespace-navigation-bar-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["navigation-bar.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+('<div class="navigation-title">'+b((l=(l=c.strings,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'</div>\n<div class="search-icon sqs-search-ui-button"></div>\n<div class="navigation-description">\n\t<p>'+
b((l=(l=c.strings,null==l||!1===l?l:l.description),"function"===typeof l?l.apply(c):l))+'</p>\n</div>\n\n<div class="navigations"></div>')})})();b.Handlebars.registerPartial("navigation-bar.html".replace("/","."),d.templates["navigation-bar.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-stats-block-pie",function(b){var d=b.namespace("Squarespace.Views.Stats").Pie=b.Base.create("pie",b.Squarespace.Views.Stats.Summary,[],{template:"stats-block-pie.html",_bindUI:function(){d.superclass._bindUI.apply(this,arguments);var b=this.get("id");this.after(b+"|dataChange",this._renderChart,this)},_renderDefaultState:function(b){d.superclass._renderDefaultState.apply(this,arguments);this.set("data",b)},_renderChart:function(){var b=this.get("data"),e=this.get("container"),
d=e.one(".graphic"),g=d.get("offsetWidth")||e.get("offsetWidth"),e=d.get("offsetHeight")||e.get("offsetHeight"),h=Math.min(g-15,e-15)/2-10,d=d3.select(d.getDOMNode()).append("svg"),h=d3.svg.arc().outerRadius(h);d.datum(b).attr("width",g).attr("height",e).attr("pie chart");d.append("g").attr("transform","translate("+g/2+","+e/2+")").append("path").attr("class","full").attr("d",h.startAngle(0).endAngle(2*Math.PI))}},{CSS_PREFIX:"sqs-pie",ATTR:{data:{value:null}}})},"1.0",{requires:["base-base","squarespace-stats-block-view",
"squarespace-stats-block-pie-template","thirdparty-d3"]});
YUI.add("squarespace-block-spacer",function(b){b.namespace("Squarespace.ContentModel").Spacer=b.Base.create("SpacerBlockModel",b.Model,[],{},{ATTRS:{vSize:{value:1},aspectRatio:{value:null}}});b.namespace("Squarespace.Block").Spacer=b.Base.create("block-spacer",b.Squarespace.Block.Base,[b.Squarespace.Block.Mixin.AspectRatio],{},{CSS_PREFIX:"sqs-block-spacer",MODEL:b.Squarespace.ContentModel.Spacer,ATTRS:{editor:{valueFn:function(){return b.Squarespace.Block.Editor.Spacer}},mobileEditor:{valueFn:function(){return b.Squarespace.Block.Editor.Spacer}},
emailEditor:{valueFn:function(){return b.Squarespace.Block.Editor.SpacerEmail}},type:{value:b.Squarespace.BlockType.SPACER},classNames:{value:"spacer-block"},floatable:{value:!1}}})},"1.0",{requires:"base squarespace-block-base squarespace-block-mixin-aspect-ratio squarespace-block-spacer-editor squarespace-enum squarespace-ss-widget".split(" ")});
YUI.add("squarespace-dialog-range-table-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-range-table.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;return(b=d["with"].call(c,c.strings,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n\n  <div class="field-lhs top">\n    ';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f="function"===typeof f?
f.apply(b):f);e+=l(f)+'\n  </div>\n  <div class="field-rhs">\n    <div class="field-description-wrapper">\n      <div class="field-description">\n        ';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f="function"===typeof f?f.apply(b):f);e+=l(f)+"\n      </div>\n    </div>\n\n    <table>\n      <thead>\n        <tr>\n          <th>\n            ";(f=d.dimensionLabel)?f=f.call(b,{hash:{},data:c}):(f=b.dimensionLabel,f="function"===typeof f?f.apply(b):f);return e+=l(f)+'\n          </th>\n          <th>\n            Cost\n          </th>\n        </tr>\n      </thead>\n      <tbody class="range-table-body">\n      </tbody> \n\n    </table>\n\n    <div class="add-row">\n      <img src="/universal/images-v6/standard/icon_add_11_light.png" />\n    </div>\n\n  </div>\n'},
k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("dialog-range-table.html".replace("/","."),d.templates["dialog-range-table.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-digital-pricing-placeholder",function(b){b.namespace("Squarespace");b.Squarespace.DialogFields.DigitalPricingPlaceholder=b.Base.create("digitalPricingPlaceholder",b.Squarespace.DialogFields.PricingPlaceholder,[],{initializer:function(){}},{CSS_PREFIX:"sqs-digital-pricing-placeholder",ATTRS:{}})},"1.0",{requires:["squarespace-dialog-pricing-placeholder"]});
YUI.add("squarespace-stats-timeline-nav",function(b){var d=b.namespace("Squarespace.Stats.Widgets").TimelineNav=b.Base.create("statsTimelineNavigation",b.Squarespace.Widgets.SSWidget,[],{renderUI:function(){d.superclass.renderUI.apply(this,arguments);var b=this.get("contentBox");this._renderContentFilters();this._selectedTimespanEl=b.one(".selected-timespan");this._renderTimespanFilters();this._applyFilters()},bindUI:function(){d.superclass.bindUI.apply(this,arguments);var b=this.get("contentBox"),
e=this.get("model"),f=this.get("stackGraph");e.on("extentChange",function(b){this._changeExtent(b.newVal)},this);e.on("normalizedDataChange",function(){var b=e.get("extent");this._changeExtent(b)},this);e.on("isLoadingChange",function(b){this._toggleLoading(b.newVal)},this);f.on("drilldownKeyChange",function(b){this._drilldownUpdate(b.newVal)},this);this.after("filtersChange",this._applyFilters,this);b.delegate("click",this._onFilterClick,".filter-button",this);b.delegate("click",this._onDrilldownReturnClick,
".drilldown-return",this)},clearActiveTimespans:function(){this.get("contentBox").all(".timespan-filters .filter-button").removeClass("active");this._customTimespan=!0},_selectedTimespanEl:null,_spinner:null,_customTimespan:!1,_renderTimespanFilters:function(){var c=this.get("contentBox").one(".timespan-filters .filters-inside"),e=this.get("timespans");b.Array.each(e,function(e){c.append(b.Node.create(b.Lang.sub('<span class="filter-button" data-filter-type="timespan" data-filter-id="{timespanId}">{timespanName}</span>',
{timespanId:e,timespanName:b.Squarespace.StatsTimeFrameLabels[e]})))})},_changeExtent:function(b){this._selectedTimespanEl.setHTML(this._formatDate(b[0])+" &mdash; "+this._formatDate(b[1]))},_onFilterClick:function(b){b=b.target;var e=this.get("filters"),d=b.getData("filter-type"),g=b.getData("filter-id"),h=this.get("model");"timespan"===d&&(this._customTimespan=!1);if("timespan"===d||"dataType"===d||"dataMetric"===d){if(e[d]=g,"dataType"===d||"dataMetric"===d)"dataMetric"===d&&(h.setDataMetric(g),
h.loadTotals()),b.ancestor("ul").all("li").removeClass("active"),b.addClass("active"),b.ancestor(".filter-selector").one(".filter-label").setHTML(b.getData("filter-label"))}else if("all"===d){g=g.split(",");e.dataMetric=g[0];e.dataType=g[1];var k=this.get("contentOptions"),l=this._getContentFilterOptionByType(k.MAIN.STACK_GRAPHS.options,g[0]),p=this._getContentFilterOptionByType(k.SUB,g[1]);b.ancestor(".content-filters").all("ul li").removeClass("active");b.ancestor(".content-filters").one(".filter-selector.main-filter").all("ul li").each(function(){this.getHTML()===
l.label&&(this.addClass("active"),this.ancestor(".filter-selector").one(".filter-label").setHTML(l.shortLabel||l.label))});b.ancestor(".content-filters").one(".filter-selector.sub-filter").all("ul li").each(function(){this.getHTML()===p.label&&(this.addClass("active"),this.ancestor(".filter-selector").one(".filter-label").setHTML(p.shortLabel||p.label))});h.setDataMetric(g[0]);h.loadTotals()}this.set("filters",e);("dataType"===d||"dataMetric"===d||"all"===d)&&this._updateRecentContentFilters()},_applyFilters:function(){var c=
this.get("contentBox"),e=this.get("filters");this._customTimespan||c.all(".timespan-filters .filter-button").each(function(){this.getData("filter-id")===e.timespan?this.addClass("active"):this.removeClass("active")});var d=this.get("timespanGranularities"),c=this.get("model"),g=b.Squarespace.StatsTimeFrameFns[e.timespan]();g.dataType=b.Squarespace.CensusDataType[e.dataType];g.dataMetric=b.Squarespace.CensusDataMetric[e.dataMetric];g.granularity=d[e.timespan];d=new Date;d=new Date(d.getFullYear(),
d.getMonth(),d.getDate()+1);g.end>d&&(g.end=d);c.set("extent",[new Date(g.start),new Date(g.end)],{silent:!0});c.load(g)},_formatDate:function(c){return b.Date.format(c,{format:"%b %d, %Y"})},_renderContentFilters:function(){var c=this.get("contentBox"),e=c.one(".content-filters .filter-selector.main-filter .filter-selector-options"),d=c.one(".content-filters .filter-selector.sub-filter .filter-selector-options"),g=this.get("contentOptions"),h=b.Node.create('<div class="options-inside single"></div>');
e.append(h);this._addContentOptions(h,g.MAIN.STACK_GRAPHS,"stack");h=b.Node.create('<div class="options-inside multiple"></div>');e.append(h);e=b.Node.create('<div class="multi-top"></div>');h.append(e);this._addContentOptions(e,g.MAIN.POPULAR,"all");e=b.Node.create('<div class="recent"></div>');h.append(e);this._addContentOptions(e,g.MAIN.RECENT,"all");h=b.Node.create('<div class="options-inside sub"></div>');d.append(h);this._addContentOptions(h,g.SUB,"sub");var k=this;c.all(".content-filters .filter-selector").on("hover",
function(){this.hasClass("main-filter")?this.one(".filter-selector-options .tooltip-extension").setStyle("left",60+this.get("offsetWidth")/2):this.one(".filter-selector-options").setStyle("left",this.get("offsetLeft")+this.get("offsetWidth")/2-this.one(".filter-selector-options").get("offsetWidth")/2);k._transitionFilterSelector(this,!0)},function(){k._transitionFilterSelector(this,!1)})},_addContentOptions:function(c,e,d){var g;if("stack"===d||"sub"===d){var h=c.ancestor(".filter-selector").one(".filter-label").getHTML();
"stack"===d?(g='<li class="filter-button" data-filter-type="dataMetric" data-filter-label="{contentOptionLabel}" data-filter-id="{contentOptionType}">{contentOption}</li>',c.append(b.Node.create(b.Lang.sub('<span class="filter-option-header">{contentHeader}</span><ul>{contentOptions}</ul>',{contentHeader:e.label,contentOptions:b.Array.reduce(e.options,"",function(c,e){var d=e.shortLabel?e.shortLabel:e.label;return c+b.Lang.sub(d===h?g.replace('class="','class="active '):g,{contentOption:e.label,contentOptionLabel:d,
contentOptionType:e.type})})})))):"sub"===d&&(g='<li class="filter-button" data-filter-type="dataType" data-filter-label="{contentOptionLabel}" data-filter-id="{contentOptionType}">{contentOption}</li>',c.append(b.Node.create("<ul></ul>").append(b.Array.reduce(e,"",function(c,e){var d=e.shortLabel?e.shortLabel:e.label;return c+b.Lang.sub(d===h?g.replace('class="','class="active '):g,{contentOption:e.label,contentOptionLabel:d,contentOptionType:e.type})}))))}else"all"===d?(g='<li class="filter-button" data-filter-type="all" data-filter-id="{contentOptionType}">{contentOption}</li>',
c.append(b.Node.create(b.Lang.sub('<span class="filter-option-header">{contentHeader}</span><ul>{contentOptions}</ul>',{contentHeader:e.label,contentOptions:b.Array.reduce(e.options,"",function(c,e){return c+b.Lang.sub(g,{contentOption:e.label,contentOptionType:e.dataMetric+","+e.dataType})})})))):(g="<li>{contentOption}</li>",c.append(b.Node.create(b.Lang.sub('<span class="filter-option-header">{contentHeader}</span><ul>{contentOptions}</ul>',{contentHeader:e.label,contentOptions:b.Array.reduce(e.options,
"",function(c,e){return c+b.Lang.sub(g,{contentOption:e})})}))))},_getContentFilterOptionByType:function(b,e){for(var d=0;d<b.length;d++)if(b[d].type===e)return b[d]},_updateRecentContentFilters:function(){for(var b=this.get("contentBox").one(".content-filters .recent"),e=this.get("filters"),d=this.get("contentOptions"),g=d.MAIN.RECENT,h=!1,k=0;k<g.options.length;k++)if(g.options[k].dataMetric===e.dataMetric&&g.options[k].dataType===e.dataType){g.options.unshift(g.options.splice(k,1)[0]);h=!0;break}h||
(h=this._getContentFilterOptionByType(d.MAIN.STACK_GRAPHS.options,e.dataMetric),d=this._getContentFilterOptionByType(d.SUB,e.dataType),d="Show "+(h.shortLabel||h.label)+" by "+(d.shortLabel||d.label),g.options.pop(),g.options.unshift({label:d,dataMetric:e.dataMetric,dataType:e.dataType}));b.empty();this._addContentOptions(b,g,"all")},_transitionFilterSelector:function(b,e){b.one(".filter-selector-options").transition({easing:"ease-out",duration:0.25,opacity:e?1:0,visibility:"visible"},function(){e||
this.setStyle("visibility","hidden")})},_toggleLoading:function(c){this._spinner&&this._spinner.destroy();c&&(this._spinner=new b.Squarespace.Spinner({color:"dark",size:"large",render:this.get("contentBox").one(".spinner-cont")}))},_drilldownUpdate:function(b){var e=this.get("contentBox").one(".drilldown"),d=e.one(".drilldown-title"),g=this.get("stackGraph");if(b){e.removeClass("hidden");e="";if(g=g.get("streams"))for(var h=0;h<g.length;h++)if(g[h].key===b){e=g[h].title?g[h].title:g[h].key;break}d.setHTML(e)}else e.addClass("hidden"),
d.setHTML("")},_onDrilldownReturnClick:function(){this.get("stackGraph").set("drilldownKey",null)}},{CSS_PREFIX:"sqs-stats-timeline-nav",TEMPLATE:'<div class="content-filters">Show <span class="filter-selector main-filter"><span class="filter-label">visits</span><div class="filter-selector-options main-options"><div class="tooltip-extension"></div></div></span> by <span class="filter-selector sub-filter"><span class="filter-label">content (URL)</span><div class="filter-selector-options sub-options"><div class="tooltip-extension"></div></div></span></div><div class="spinner-cont"></div><div class="timespan-filters"><div class="selected-timespan"></div><div class="filters-inside"></div></div><div class="drilldown hidden"><span class="drilldown-return"></span><span class="drilldown-title"></span></div>',
ATTRS:{model:{value:null},stackGraph:{value:null},width:{value:800},height:{value:100},filters:{valueFn:function(){return{timespan:"LAST_7_DAYS",dataType:"PAGE_URL",dataMetric:"VISITS"}}},timespans:{value:["LAST_24_HOURS","LAST_7_DAYS","LAST_30_DAYS"]},contentOptions:{value:{MAIN:{STACK_GRAPHS:{label:"Stack Graphs",options:[{label:"Visitors",shortLabel:"visitors",type:"VISITORS"},{label:"Visits",shortLabel:"visits",type:"VISITS"},{label:"Pageviews",shortLabel:"pageviews",type:"VIEWS"},{label:"Social Sharing",
shortLabel:"social sharing",type:"SOCIAL"},{label:"Comments",shortLabel:"comments",type:"COMMENTS"},{label:"RSS Subscribers",shortLabel:"RSS subscribers",type:"RSS"},{label:"Search Engine Traffic",shortLabel:"search traffic",type:"SEARCH"}]},LINE_GRAPHS:{label:"Line Graphs",options:["All Views"]},POPULAR:{label:"Popular",options:[{label:"Show visitors by content (URL)",dataType:"PAGE_URL",dataMetric:"VISITORS"},{label:"Show visits by OS",dataType:"OS",dataMetric:"VISITS"},{label:"Show pageviews by content (URL)",
dataType:"PAGE_URL",dataMetric:"VIEWS"}]},RECENT:{label:"Recent",options:[{label:"Show visits by content (URL)",dataType:"PAGE_URL",dataMetric:"VISITS"},{label:"Show visitors by browser",dataType:"BROWSER",dataMetric:"VISITORS"},{label:"Show pageviews by OS",dataType:"OS",dataMetric:"VIEWS"}]}},SUB:[{label:"Content (URL)",shortLabel:"content (URL)",type:"PAGE_URL"},{label:"Operating System",shortLabel:"OS",type:"OS"},{label:"Source (Referrer)",shortLabel:"referrer",type:"REFERRER"},{label:"Browser",
shortLabel:"browser",type:"BROWSER"},{label:"Country",shortLabel:"country",type:"COUNTRY"}]}},timespanGranularities:{value:{LAST_24_HOURS:b.Squarespace.CensusGranularity.HOURLY,LAST_7_DAYS:b.Squarespace.CensusGranularity.DAILY,LAST_30_DAYS:b.Squarespace.CensusGranularity.DAILY}}}})},"1.0",{requires:"base-base datatype-date squarespace-enum squarespace-ss-widget squarespace-attr-validators squarespace-stats-timeframes".split(" ")});
YUI.add("squarespace-block-audio",function(b){var d=b.Base.create("AudioBlockModel",b.Model,[],{},{ATTRS:{designStyle:{getter:function(c){return!b.Squarespace.Utils.isBetaFeatureEnabled()||!b.Lang.isValue(c)?"classic":c}}}}),c=b.namespace("Squarespace.Block").Audio=b.Base.create("block-audio",b.Squarespace.Block.ModelSyncBase,[],{_renderSuccess:function(e){c.superclass._renderSuccess.call(this,e);e=this.get("contentBox").one(".sqs-audio-embed");if(b.Lang.isValue(e))if(b.Squarespace.Widgets.AudioPlayer)switch(this.get("model").get("designStyle")){case "minimal":new b.Squarespace.Widgets.AudioPlayerMinimal({render:e});
break;default:new b.Squarespace.Widgets.AudioPlayer({render:e})}else Squarespace&&Squarespace.addLoadTrigger&&Squarespace.addLoadTrigger(".sqs-audio-embed",["squarespace-audio-player"])}},{CSS_PREFIX:"sqs-block-audio",MODEL:d,ATTRS:{type:{value:b.Squarespace.BlockType.AUDIO},editor:{value:b.Squarespace.Block.Editor.Audio},defaultContentModel:{value:{designStyle:"minimal"}}}})},"1.0",{requires:["base","model","squarespace-enum","squarespace-block-base-modelsync","squarespace-block-audio-editor"]});
YUI.add("squarespace-widgets-commerce-coupon-list",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.CommerceCouponList=b.Base.create("CommerceCouponList",b.Squarespace.Widgets.ModelList,[],{_addWidgetForModel:function(b){var c=new (this.get("modelWidgetCtor"))({model:b,validCouponCategories:this.get("validCouponCategories")});this.add(c,this.get("models").indexOf(b))}},{CSS_PREFIX:"sqs-commerce-coupon-list",ATTRS:{modelWidgetCtor:{value:b.Squarespace.Widgets.CommerceCoupon},strings:{value:{modelName:"coupon"}},
emptyStateIconSrc:{value:"/universal/images-v6/configuration/no-coupons.png"},validCouponCategories:{value:[],writeOnce:"initOnly"}}})},"1.0",{requires:["base","squarespace-widgets-commerce-coupon","squarespace-widgets-model-list"]});
YUI.add("squarespace-settings-commerce-manager",function(b){b.namespace("Squarespace").CommerceManager=Class.extend(b.Squarespace.PanelManager,{getTitle:function(){return"Commerce"},getDescription:function(){return"The commerce area allows you to create and manage an online store."},getName:function(){return"commerce"},renderMenu:function(){this._super(name);b.Lang.isUndefined(Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted)&&(Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted=
{});Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["commerce-welcome"]||(b.Squarespace.Help.showCommerceWelcome().on("hidden",function(){b.Data.post({url:"/api/config/MarkWebsiteTutorialCompleted",data:{tutorial:"commerce-welcome"}},this)},this),Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["commerce-welcome"]=!0)},getMenuItems:function(){return[{name:"getting-started",title:"Getting Started",hidden:Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted&&Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["commerce-tutorial-checklist"],
ctor:b.Squarespace.Settings.Commerce.Tutorial,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_STORE_SETTINGS},{name:"orders",title:"Orders",ctor:b.Squarespace.Widgets.OrderListManager,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_ORDERS},{name:"inventory",title:"Inventory",ctor:b.Squarespace.Widgets.InventoryManager,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_INVENTORY},{name:"donations",title:"Donations",ctor:b.Squarespace.Settings.Commerce.Donations,
requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_DONATIONS},{name:"shipping",title:"Shipping",ctor:b.Squarespace.Settings.Commerce.Shipping,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_SHIPPING},{name:"coupons",title:"Coupons",ctor:b.Squarespace.Widgets.CommerceCouponListManager,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_COUPONS},{name:"taxes",title:"Taxes",ctor:b.Squarespace.Settings.Commerce.Taxes,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_TAXES},
{name:"accounting",title:"Accounting",ctor:b.Squarespace.Settings.Commerce.Accounting,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_ACCOUNTING},{name:"email-settings",title:"Email Settings",ctor:b.Squarespace.Settings.Commerce.Email,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_EMAIL_NOTIFICATIONS},{name:"store-settings",title:"Store Settings",ctor:b.Squarespace.Settings.Commerce.Store,requiredPermission:b.Squarespace.AccessPermissions.CONFIG_COMMERCE_STORE_SETTINGS}]}});
b.namespace("Squarespace.ConfigurationPanelRenderers").commerce=b.Squarespace.CommerceManager},"1.0",{requires:"anim json node oop squarespace-dombuilder squarespace-help squarespace-panel-manager squarespace-settings-commerce-accounting squarespace-settings-commerce-donations squarespace-settings-commerce-email squarespace-settings-commerce-email squarespace-settings-commerce-shipping squarespace-settings-commerce-store squarespace-settings-commerce-taxes squarespace-settings-commerce-tutorial squarespace-widgets-commerce-coupon-list-manager squarespace-widgets-inventory-manager squarespace-widgets-order-list-manager".split(" ")});
YUI.add("squarespace-dialog-domain",function(b){var d={title:"Your domain is being transferred to Squarespace.",message:"This process may take many days."},c={title:"Your new domain is almost ready.",message:"Domains can take as little as 15-30 minutes to resolve, but in some cases mapping a new custom domain can take up to 72 hours."},e={title:"Please wait while your domain's DNS records are updated.",message:'Changes to your domain\'s DNS settings can sometimes take up to 30 minutes to propagate worldwide. Some visitors might have difficulty accessing your site during this time. <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/413088-mapping-a-domain-general-instructions-">Click here for more information about setting up a custom domain.</a>'},
f={title:"Pending email verification",message:'You have been sent an email to <em>{email}</em> to verify this domain. This domain needs to be verified within 15 days or it will be temporarily suspended. You can resend the verification email at anytime during or after this grace period. If you are having any issues, please refer to <a href="http://help.squarespace.com/guides/verifying-your-squarespace-managed-domain" target="_blank">this help article</a>'},g={title:"Domain suspended",message:'Your domain has been temporarily suspended. You need to verify your email address (<em>{email}</em>) for this domain by resending the email verification. If you are having any issues, please refer to <a href="http://help.squarespace.com/guides/verifying-your-squarespace-managed-domain" target="_blank">this help article</a>'};
b.Handlebars.registerHelper("ifNakedDomain",function(b,c){return 2==b.split(".").length?c.fn(this):c.inverse(this)});b.Handlebars.registerHelper("domain-name",function(b){var c=(b.wwwOn?"www.":"")+b.name.toLowerCase();b.primary&&(c+=" (Primary Domain)");b.applicationSuppliedDomain&&(c+=" (Built In)");return c});b.Handlebars.registerHelper("ifAllowWwwToggle",function(b,c){return b.status&&b.status.allowWwwToggle?c.fn(this):c.inverse(this)});b.Handlebars.registerHelper("status-class",function(c){return c.managed&&
!c.dnsActive?"managed-inactive":c.withinPropagationWindow&&(!b.Lang.isObject(c.status)||!c.status.resolves||c.status.errors.length)?"propagating":c.status&&(c.status.errors.length||!c.status.resolves)?"errors":"valid"});b.Handlebars.registerHelper("type-class",function(c,e){var d;b.Object.each(b.Squarespace.DomainTypes,function(b,e){c.type===b&&(d=e.toLowerCase())});return d});b.namespace("Squarespace.DialogFields").Domain=b.Base.create("domain",b.Squarespace.DialogField2,[],{initializer:function(b){this.publish("remove-domain",
{preventable:!0,defaultFn:this.destroy});this.publish("domain-status-check-success",{preventable:!0,defaultFn:this._onDomainStatusCheck});b.data.dataState&&this.set("dataState",b.data.dataState);this._unlockKeyPromise=null},_loadUnlockKey:function(){b.Lang.isValue(this._unlockKeyPromise)||(this._unlockKeyPromise=new b.Promise(b.bind(this._retrieveUnlockKey,this)));return this._unlockKeyPromise},_retrieveUnlockKey:function(c,e){(new b.Squarespace.Models.Domain(this.get("data"))).getUnlockKey().then(c,
e)},_isTransferInProgress:function(c){return b.Array.some(["pending-loser-approval","pending-customer-approval","pending-winner-approval"],function(b){return b===c})},_getHBTemplateContext:function(){var c=b.Squarespace.DialogFields.Domain.superclass._getHBTemplateContext.call(this),e=c.data;this._isTransferInProgress(e.transferStatus)&&(e.transferring=!0);c.data.betaFeatures=b.Squarespace.Utils.isBetaFeatureEnabled();return c},bindUI:function(){b.Squarespace.DialogFields.Domain.superclass.bindUI.call(this);
var c=this.get("contentBox");c.delegate("click",this._onHeaderClick,".header",this);c.delegate("click",this._initiateRemoveDomain,".remove",this);c.delegate("click",this._initiateSendEmail,".send-email",this);c.delegate("click",this._initiateUnlink,".unlink",this);c.delegate("click",this._initiateRename,".rename, .rename-button button",this);c.delegate("click",this._initiateWWWToggle,".www-toggle",this);c.delegate("click",this._initiateMakePrimary,".make-primary",this);c.delegate("click",this._initiateGappsRemoval,
".remove-googleapps-file",this);c.delegate("click",this._lockTogglePrompt,".lock-toggle",this);c.delegate("click",this._navigateToEmail,".configure-email",this);c.delegate("click",this._initiateTransferKeyGet,".get-transfer-key",this)},_navigateToEmail:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.getHistory().replace({module:"settings","settings-subpanelName":"google-apps-email-settings"})},_lockTogglePrompt:function(c){c.halt();if((new b.Squarespace.Models.Domain(this.get("data"))).get("locked")){var e=
new b.Squarespace.OptionConfirmationDialog({width:250,optionConfig:{padding:["15px","0px"]}});e.show("Unlock your domain?","Warning: You should only unlock a domain if you are preparing to transfer it to a new provider. If you'd like to continue using this domain with your Squarespace site, click Cancel",function(){e.getValue()&&this._initiateLockToggle()},this)}else this._initiateLockToggle()},_initiateLockToggle:function(){var c=new b.Squarespace.Models.Domain(this.get("data")),e=c.get("locked");
c.set("locked",!e);this.set("dataState","loading");c.save(b.bind(function(d,f){this.set("dataState","loaded");if(d)new b.Squarespace.Widgets.Alert({"strings.title":(e?"Unlock ":"Lock ")+"Failed","strings.message":"Please try again."});else{var g=c.toJSON();e?new b.Squarespace.Widgets.Information({"strings.title":"Domain Unlocked","strings.message":"You have successfully unlocked your domain."}):(this._unlockKeyPromise=g.unlockKey=null,new b.Squarespace.Widgets.Information({"strings.title":"Domain Locked",
"strings.message":"You have successfully locked your domain."}));this.set("data",g)}},this))},_initiateGappsRemoval:function(b){b.halt();this.removeGoogleAppsFile()},_initiateMakePrimary:function(c){c.halt();(new b.Squarespace.Widgets.Confirmation({"strings.title":"Make Primary Domain","strings.message":"Are you sure you want to make this domain primary? It will be used system-wide when your site URL is requested."})).on("confirm",this.makePrimaryDomain,this)},_initiateWWWToggle:function(b){b.halt();
this.toggleWWW()},_initiateRename:function(b){b.halt();this.renameBuiltinDomain()},_initiateUnlink:function(c){c.halt();(new b.Squarespace.Widgets.Confirmation({"strings.title":"Unlink Domain","strings.message":"Are you sure you want to unlink this domain?"})).on("confirm",this.removeDomain,this)},_initiateSendEmail:function(c){c.halt();(new b.Squarespace.Widgets.Confirmation({"strings.title":"Advanced Domain Settings","strings.message":"To manage additional domain settings, confirm below to have your access information and instructions emailed to you."})).on("confirm",
this.sendEmail,this)},_initiateRemoveDomain:function(c){c.halt();(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Domain","strings.message":"Are you sure you want to remove this domain?"})).on("confirm",this.removeDomain,this)},syncUI:function(){b.Squarespace.DialogFields.Domain.superclass.syncUI.apply(this,arguments);var c=this.get("contentBox");c.setHTML(this.renderTemplate());var e=c.one(".body");e.plug(b.Squarespace.Animations.Expandable);this._isOpen||e.hide(!0);e.one(".googleapps-upload-button")&&
(this._uploader=new b.Squarespace.Uploader({uploadURL:"/api/domains/UploadGoogleAppsFile?domainId="+this.get("data.id"),selectButtonLabel:"Upload Google HTML File",width:190,autoUpload:!0}),this._uploader.after("uploadcomplete",function(){this.set("data.googleAppsFilename",!0)},this),this._uploader.render(e.one(".googleapps-upload-button")));this._renderErrorWidgets(e);c.one(".header");this.get("data.managed")&&(this._websiteToggle=new b.Squarespace.Widgets.ToggleButton({active:this.get("data.dnsActive")}),
c=e.one(".website-toggle"),b.Lang.isValue(c)&&(this._websiteToggle.render(e.one(".website-toggle")),this._websiteToggle.after(this.get("id")+"|activeChange",function(b){b.halt();this.toggleWebsiteDNS()},this)),this._googleAppsToggle=new b.Squarespace.Widgets.ToggleButton({active:this.get("data.googleDnsActive")}),e=e.one(".googleapps-toggle"),b.Lang.isValue(e)&&(this._googleAppsToggle.render(e),this._googleAppsToggle.after(this.get("id")+"|activeChange",function(b){b.halt();this.toggleGoogleAppsDNS()},
this)))},_renderErrorWidgets:function(c){var e=this.get("data.unlockKey");b.Lang.isValue(e)&&(new b.Squarespace.Widgets.DomainPropagationWarning({title:"Transfer Key",message:'<div class="unlock-key-msg">The transfer key for your domain is: </div><div class="unlock-key">'+b.Escape.html(e)+"</div>"})).render(c.one(".errors"));e=this._getErrorWidgets();b.Array.each(e,function(b){b.render(c.one(".errors"))})},_getErrorWidgets:function(){var c=this.get("data"),f=[];if(!b.Lang.isValue(c.status))return f;
this._isTransferInProgress(c.transferStatus)&&f.push(new b.Squarespace.Widgets.DomainWarning(d));if(c.withinPropagationWindow&&(!b.Lang.isObject(c.status)||!c.status.resolves||c.status.errors.length))f.push(this._getPropagationWidget(c.managed));else if(0<c.status.errors.length)f.push(this._getDomainErrorWidget(c.status.errors));else if(!c.status.resolves){var g=new b.Squarespace.Widgets.DomainError(e);g.on("check-domain-status",this._refreshDomainStatus,this);f.push(g)}c.managed&&(c.status.verificationInfo.status===
b.Squarespace.DomainVerificationStatus.PENDING?f.push(this._getVerificationPending(c.status)):c.status.verificationInfo.status===b.Squarespace.DomainVerificationStatus.SUSPENDED&&f.push(this._getVerificationSuspended(c.status)));return f},_getPropagationWidget:function(d){d=d?new b.Squarespace.Widgets.DomainPropagationWarning(c):new b.Squarespace.Widgets.LinkedDomainPropagationWarning(e);d.on("check-domain-status",this._refreshDomainStatus,this);return d},_getDomainErrorWidget:function(c){c=new b.Squarespace.Widgets.DomainError({title:"This domain is not correctly pointing to Squarespace.",
message:'You must change these records to point to Squarespace within your domain registrar\'s interface. <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/413088-mapping-a-domain-general-instructions-?">Click here for more information.</a><br/><br/>Please note, if you have recently used our <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/413088">guide</a> to map your custom domain, it can take up to 72 hours for changes to DNS settings to resolve.',
errors:c});c.on("check-domain-status",this._refreshDomainStatus,this);return c},_getVerificationPending:function(c){f.message=b.Lang.sub(f.message,{days:c.verificationInfo.daysToSuspend,email:c.domainInfo.ownerEmail});c=new b.Squarespace.Widgets.DomainVerificationPending(f);c.set("domain",this.get("data"));return c},_getVerificationSuspended:function(c){g.message=b.Lang.sub(g.message,{email:c.domainInfo.ownerEmail});c=new b.Squarespace.Widgets.DomainVerificationSuspended(g);c.set("domain",this.get("data"));
return c},_refreshDomainStatus:function(){var c=this.get("contentBox").one(".body .errors");c.plug(b.Squarespace.Animations.Expandable);this.once("domain-status-check-success",function(b){b.preventDefault();c.show();this.set("data.status",b.response.domainStatus,{noSyncUI:!0})});c.once("closed",function(){this.checkDomainStatus()},this);c.hide()},_onDomainStatusCheck:function(b){this.set("data.status",b.response.domainStatus)},checkDomainStatus:function(){b.Data.post({url:"/api/domains/CheckDomain",
data:{domainId:this.get("data.id")},success:function(b){this.fire("domain-status-check-success",{response:b})},failure:function(b){this.fire("domain-status-check-failure",{response:b})}},this)},toggleWWW:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Toggle WWW","strings.message":"Toggling this setting will control if the server will prefer to display your primary domain with or without a preceeding www."})).on("confirm",function(){this.set("data.wwwOn",!this.get("data.wwwOn"));
b.Data.put({url:"/api/rest/websites/primary-domain",data:{primaryDomain:this.getFullDomainName()},failure:function(){this.set("data.wwwOn",!this.get("data.wwwOn"))}},this)},this)},makePrimaryDomain:function(){this.set("data.primary",!0);this.set("data.wwwOn",!0);this.fire("primary-domain-set")},makeNonPrimaryDomain:function(){this.set("data.primary",!1)},removeGoogleAppsFile:function(){b.Data.post({url:"/api/domains/RemoveGoogleAppsFile",data:{domainId:this.get("data.id")},success:function(){this.set("data.googleAppsFilename",
null);this.set("data.googleAppsContent",null)},failure:function(){new b.Squarespace.Widgets.Information({"strings.title":"Problem Removing Google Apps File"})}},this)},toggleWebsiteDNS:function(c){this.set("dataState","loading");this._websiteToggle.set("enabled",!1);b.Data.post({url:"/api/domains/ToggleDns",data:{domainId:this.get("data.id")},success:function(){this.set("dataState","loaded");this.set("data.dnsActive",!this.get("data.dnsActive"));this._websiteToggle.set("enabled",!0)},failure:function(){this._websiteToggle.set("enabled",
!0)}},this)},toggleGoogleAppsDNS:function(){this.set("dataState","loading");this._googleAppsToggle.set("enabled",!1);b.Data.post({url:"/api/domains/ToggleGoogleRecords",data:{domainId:this.get("data.id")},success:function(){this.set("dataState","loaded");this._googleAppsToggle.set("enabled",!0);this.set("data.googleDnsActive",!this.get("data.googleDnsActive"))},failure:function(){this._googleAppsToggle.set("enabled",!0)}},this)},sendEmail:function(){b.Data.post({url:"/api/domains/SendPasswordEmail",
data:{domainId:this.get("data.id")},success:function(c){new b.Squarespace.Widgets.Information({"strings.title":"Password Email Sent"})},failure:function(c){new b.Squarespace.Widgets.Information({"strings.title":"Sending Password Email Failed","strings.message":"Please contact Customer Care."})}},this)},renameBuiltinDomain:function(){this.fire("rename-domain")},removeDomain:function(){this.fire("remove-domain")},_fetchUnlockKey:function(){return new b.Promise(b.bind(function(c,e){var d=b.later(300,
this,function(){this.set("dataState","loading")});this._loadUnlockKey().then(b.bind(function(b){this.set("data.unlockKey",b)},this)).then(b.bind(function(){d.cancel();this.set("dataState","loaded")},this)).then(c,e)},this))},_appendUnlockKey:function(c){var e=this.get("contentBox");b.Lang.isValue(e.one(".unlock-key"))||(c=b.Escape.html(c),e.one(".body").append('<div class="unlock-key">Transfer Key: <span class="key">'+c+"</span></div>"))},_onHeaderClick:function(b){b.target.test("a")||this.get("dataState")===
this.getProperty("DATA_STATES").LOADING||this._openBodyContainer()},_initiateTransferKeyGet:function(c){c.halt();this._fetchUnlockKey().then(b.bind(function(){this.isOpen()||this._openBodyContainer()},this))},_openBodyContainer:function(b){this.get("contentBox").one(".body").hasClass("expandable-hidden")?this.open():this.close()},isOpen:function(){return this._isOpen},open:function(){var b=this.get("contentBox").one(".body");this.get("boundingBox").addClass("open");b.show();this._isOpen=!0;this.fire("open")},
close:function(){var b=this.get("contentBox").one(".body");this.get("boundingBox").removeClass("open");b.hide();this._isOpen=!1;this.fire("close")},getFullDomainName:function(){return this.get("data.wwwOn")?"www."+this.get("data.name"):this.get("data.name")},_isOpen:!1},{CSS_PREFIX:"sqs-domain",HANDLEBARS_TEMPLATE:"dialog-domain.html"})},"1.0",{requires:"promise squarespace-dialog-domain-template squarespace-domain-errors squarespace-animations squarespace-toggle squarespace-models-domain squarespace-uploader squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dd-superproxy",function(b){b.namespace("Squarespace.Plugin").DDSuperProxy=b.Base.create("DDSuperProxy",b.Plugin.DDProxy,[],{_init:function(){var d=b.DD.DDM;if(d._proxy){this._hands||(this._hands=[]);var c,e,f=this.get("host");f.get("dragNode").compareTo(f.get("node"))&&d._proxy&&f.set("dragNode",d._proxy);b.each(this._hands,function(b){b.detach()});c=d.on("ddm:start",b.bind(function(){d.activeDrag===f&&f.get("node").inDoc()&&d._setFrame(f)},this));e=d.on("ddm:end",b.bind(function(){f.get("dragging")&&
(this.get("flyBack")?this._flyBackAndCleanupProxy():(this.get("moveOnEnd")&&f.get("node").setXY(f.lastXY),this._cleanupProxy()))},this));this._hands=[c,e]}else d._createFrame(),b.on("domready",b.bind(this._init,this))},clone:function(){var d=this.get("host"),c=d.get("node"),e=c.cloneNode(!0);delete e._yuid;e.setAttribute("id",b.guid());e.setStyle("position","absolute");this.get("cloneClass")&&e.addClass(this.get("cloneClass"));this.get("containerNode").appendChild(e);d.set("dragNode",e);this.get("hideOriginalNode")&&
(this._originalHostVisiblity=c.getStyle("visibility"),c.setStyles({visibility:"hidden"}));return e},_cleanupProxy:function(){var d=this.get("host"),c=d.get("node"),e=d.get("dragNode");this.get("hideOnEnd")?e.setStyle("display","none"):this.get("hideOriginalNode")&&c.setStyles({visibility:this._originalHostVisiblity||null});this.get("cloneNode")&&(e.remove(),d.set("dragNode",b.DD.DDM._proxy))},_flyBackAndCleanupProxy:function(){var d=this.get("host"),c=d.get("node"),e=d.get("dragNode"),f=c.getXY(),
f={top:c.get("offsetTop"),left:c.get("offsetLeft")};f.top-=parseInt(c.getStyle("marginTop"),10);f.left-=parseInt(c.getStyle("marginLeft"),10);e.setStyles({opacity:1,display:"block"});f=new b.Anim({node:e,to:{top:f.top,left:f.left},duration:this.get("flyBackDuration"),easing:b.Easing.easeOutStrong});f.on("start",function(){e.addClass("proxy-animating-back");c.addClass("proxy-animating-back");this.get("movingClass")&&c.addClass(this.get("movingClass"))});f.on("end",function(){e.removeClass("proxy-animating-back");
c.removeClass("proxy-animating-back");this.get("hideOriginalNode")&&!this.get("hideOnEnd")&&c.setStyles({visibility:null});this.get("movingClass")&&c.removeClass(this.get("movingClass"));e.remove();d.set("dragNode",b.DD.DDM._proxy);c.fire("proxy-destroyed")},this);e.get("parentNode")!=c.get("parentNode")?(c.get("parentNode").append(e),f.fire("end"),b.later(300,this,function(){c.fire("proxy-destroyed")})):f.run()}},{NS:"proxy",ATTRS:{cloneNode:{value:!0},hideOriginalNode:{value:!0},cloneClass:{value:null},
movingClass:{value:null},flyBack:{value:!0},flyBackDuration:{value:0.3},moveOnEnd:{value:!0},hideOnEnd:{value:!1},containerNode:{getter:function(b){return b||this.get("host").get("node").get("parentNode")}}}})},"1.0",{requires:["dd-proxy","anim"]});YUI.add("squarespace-block-quote-model",function(b){b.namespace("Squarespace.ContentModel").Quote=b.Base.create("QuoteBlockModel",b.Model,[],{},{ATTRS:{quote:{value:""},source:{value:""}}})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-dialog-oauth-service-connect",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.OauthServiceConnect=b.Base.create("oauthServiceConnect",b.Squarespace.DialogFields.ServiceConnect,[],{initializer:function(){if(this.constructor===d)throw"DialogFields.ServiceConnect: This is an abstract class and is not meant to be used on its own.";this.get("contentBox").addClass("sqs-service-connect-content");this._externalAuthentication=new b.Squarespace.ExternalAuthentication},
renderUI:function(){d.superclass.renderUI.call(this);this._messageEl=this.get("contentBox").one(".text .message")},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",function(b){var e=this.get("data.connected");e&&b.target.hasClass("icon")?this._disconnect():e||this._connect()},this);this._externalAuthentication.after("completed",this._continueAuthentication,this)},_setInProgressState:function(){d.superclass._setInProgressState.call(this);this._messageEl.setContent("Connecting...")},
_setConnectedState:function(){d.superclass._setConnectedState.call(this);this._messageEl.setContent(this.get("strings.connectedMessage")+" "+this._getConnectedMessageUsername())},_setDisconnectedState:function(){d.superclass._setDisconnectedState.call(this);this._messageEl.setContent("Click to connect")},_connect:function(){var c=this.get("serviceProvider"),e=this.get("oauthOwner");if(!b.Lang.isValue(c))throw"DialogFields.OauthServiceConnect: The serviceProvider attribute must be defined.";this.set("connectionInProgress",
!0);this._externalAuthentication.openPopupWindow(this.get("serviceProvider"),e.name+"Id",e.getId())},_disconnect:function(){var b=this.get("data")||{};b.username=null;b.connected=!1;this.set("data",b)},_continueAuthentication:function(){var c=this.get("oauthOwner");if(!this.get("formStorageBackendType"))throw"DialogFields.OauthServiceConnect: The formStorageBackendType attributed must be defined.";var e={formStorageBackendType:this.get("formStorageBackendType")};e[c.name+"Id"]=c.getId();b.Data.get({url:"/api/commondata/GetSocialConfig",
data:e,success:function(c){c=c.socialConfig;var e=this.get("data")||{},d=!1,k=e.socialConfig;k&&k.externalAuthenticationId==c.externalAuthenticationId&&(d=!0);!d&&c&&!c.oauthError&&c.serviceProviderEnum===this.get("serviceProvider")?(e.socialConfig=c,e.username=c.profileUserName,e.connected=!0,this.set("data",e),this._completeAuthentication()):(e.username=null,this.set("data",e),this.get("contentBox"),c=c&&c.oauthError?c.oauthErrorMessage:"Error authenticating with external service.",new b.Squarespace.Widgets.Alert({position:b.Squarespace.Widgets.Alert.ANCHOR.ELEMENT,
anchor:this.get("contentBox"),"strings.title":"External Authentication Error","strings.message":c}),this.set("connectionInProgress",!1))},failure:function(c){new b.Squarespace.Widgets.Alert({position:b.Squarespace.Widgets.Alert.ANCHOR.ELEMENT,anchor:this.get("contentBox"),"strings.title":"External Authentication Error","strings.message":c.error});this.set("connectionInProgress",!1)}},this)},_completeAuthentication:function(){},_getConnectedMessageUsername:function(){throw"DialogFields.OauthServiceConnect: _getConnectedMessageUsername must be implemented by the extending class.";
}},{CSS_PREFIX:"sqs-oauth-service-connect",HANDLEBARS_TEMPLATE:"dialog-oauth-service-connect.html",ATTRS:{strings:{value:{title:"Oauth Service",connectedMessage:"As"}},serviceProvider:{value:null},formStorageBackendType:{value:null},oauthOwner:{value:{name:"collection",getId:function(){}}}}})},"1.0",{requires:"base squarespace-ui-base squarespace-dialog-service-connect squarespace-external-authentication squarespace-dialog-oauth-service-connect-template squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-dialog-map-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-map.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+('<div class="field-wrapper text-field-wrapper clear major">\n  <div class="map-address-fields">\n    <input class="field-input map-address-title" type="text" placeholder="'+b((l=(l=c.strings,null==l||!1===l?l:l.placeholderAddressTitle),
"function"===typeof l?l.apply(c):l))+'" spellcheck="false" style="font-weight: bold;"/>\n    <input class="field-input map-address-line1" type="text" placeholder="'+b((l=(l=c.strings,null==l||!1===l?l:l.placeholderAddress1),"function"===typeof l?l.apply(c):l))+'" spellcheck="false" />\n    <input class="field-input map-address-line2" type="text" placeholder="'+b((l=(l=c.strings,null==l||!1===l?l:l.placeholderAddress2),"function"===typeof l?l.apply(c):l))+'" spellcheck="false" />\n    <input class="field-input map-address-country" type="text" placeholder="'+
b((l=(l=c.strings,null==l||!1===l?l:l.placeholderAddressCountry),"function"===typeof l?l.apply(c):l))+'" spellcheck="false" />\n  </div>\n</div>')})})();b.Handlebars.registerPartial("dialog-map.html".replace("/","."),d.templates["dialog-map.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-stats-block-numbit-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["stats-block-numbit.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p,q=d.helperMissing;h=this.escapeExpression;p={hash:{},data:k};b='<div class="sqs-numbit">\n  <div class="amount">'+(h((l=d["4CharFit"]||c["4CharFit"],l?l.call(c,c.total,p):q.call(c,"4CharFit",c.total,p)))+'</div>\n  <div class="percent-change">');
p={hash:{},data:k};b+=h((l=d.pctChange||c.pctChange,l?l.call(c,c.percentChange,p):q.call(c,"pctChange",c.percentChange,p)))+'</div>\n  <div class="average">';p={hash:{},data:k};b+=h((l=d["4CharFit"]||c["4CharFit"],l?l.call(c,c.average,p):q.call(c,"4CharFit",c.average,p)))+'</div>\n\n  <div class="description">\n    <div class="datametric">';(l=d.dataMetric)?l=l.call(c,{hash:{},data:k}):(l=c.dataMetric,l="function"===typeof l?l.apply(c):l);b+=h(l)+'</div>\n    <div class="timeframe">';(l=d.timeFrame)?
l=l.call(c,{hash:{},data:k}):(l=c.timeFrame,l="function"===typeof l?l.apply(c):l);return b+=h(l)+"</div>\n  </div>\n</div>"})})();b.Handlebars.registerPartial("stats-block-numbit.html".replace("/","."),d.templates["stats-block-numbit.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-help",function(b){b.namespace("Squarespace");var d,c,e,f;f=new b.JSONTemplate.Template('<div class="video {.section helpButtons}hasButtons{.end}" data-sectionName="{name}"><div class="player"></div><div class="meta"><div class="info"><div class="title">{title}</div><div class="description">{description}</div></div>{.section helpButtons}<div class="buttons"><div class="knowledge-base"><a target="_blank" href="{kbUrl}">Knowledge Base</a></div><div class="ticket"><a href="#">Open a Ticket</a></div></div>{.end}</div></div>');e=
new b.JSONTemplate.Template('<div class="help-video {name}" data-sectionName="{name}"><div class="thumbnail {name}"></div><div class="play">&nbsp;</div><div class="meta"><div class="title">{title}</div><div class="length">{duration}</div></div></div>');b.Squarespace.HelpLinks={BASIC_INFO:"http://help.squarespace.com/guides/configuring-basic-information-settings",META_DESCRIPTION:"http://help.squarespace.com/guides/how-do-i-increase-my-site-visibility-to-search-engines",GENERAL:"http://help.squarespace.com/guides/configuring-general-settings",
TEMPLATES:"http://help.squarespace.com/guides/?category=Templates",BILLING:"http://help.squarespace.com/guides/?category=Billing",CONTRIBUTORS:"http://help.squarespace.com/guides/adding-and-managing-contributors",CONNECTED_ACCOUNTS:"http://help.squarespace.com/guides/connecting-social-accounts",SHARE_BUTTONS:"http://help.squarespace.com/guides/configuring-sharing-services",FACEBOOK_PAGE:"http://help.squarespace.com/guides/using-facebook-with-squarespace",IMPORT_EXPORT:"http://help.squarespace.com/guides/importing-and-exporting-content",
CODE_INJECTION:"http://help.squarespace.com/guides/using-code-injection",URL_MAPPINGS:"http://help.squarespace.com/guides/how-do-i-create-url-shortcuts-or-mappings",REDIRECT_TYPES:"http://help.squarespace.com/guides/what-is-the-difference-between-a-301-and-302-redirect",DOMAINS_POINTING:"http://help.squarespace.com/guides/mapping-a-domain-general-instructions",DOMAINS_EMAIL:"https://help.squarespace.com/guides/how-do-i-set-up-google-apps-for-my-domain",GENERAL_GA:"http://help.squarespace.com/guides/using-google-analytics-with-squarespace",
GENERAL_TYPEKIT:"http://help.squarespace.com/guides/using-typekit-with-squarespace",HIDDEN_FORM_FIELD:"http://help.squarespace.com/guides/how-do-i-track-referral-sources-for-form-block-submissions"};d=b.Base.create("help",b.Overlay,[],{initializer:function(c){this.set("zIndex",1E5);c=this.get("tray");this.plug(b.Plugin.WidgetAnim,{duration:0.3});this.anim.get("animShow").set("easing",b.Easing.easeOutStrong);this.anim.get("animHide").set("easing",b.Easing.easeOutStrong);c.setAttrs({sections:{welcome:{title:"Welcome to Squarespace",
description:"Learn about the basics of managing a website using Squarespace 6 &mdash; creating a page, setting your site name and logo, adding content, and changing your site's style.",video:this.getWistiaEmbed("nmriqqfa2z"),duration:"2:23",helpButtons:!1},gallery:{title:"Image Galleries",description:"This video shows how to manage a gallery of images on Squarespace 6.  From creating a gallery, uploading images, arranging and deleting images, to viewing your created gallery.",video:this.getWistiaEmbed("sqftxada2u"),
duration:"0:49",helpButtons:!0},blog:{title:"The Blogging System",description:"Squarespace's blogging platform is simple enough for a quick stream of images, and robust enough for a demanding company blog.  This video teaches you the basics of blogging on Squarespace.",video:this.getWistiaEmbed("5ubthoqlu5"),duration:"1:40",helpButtons:!0},page:{title:"LayoutEngine Page Creation",description:"Only Squarespace comes with a completely custom page builder, letting you create complex, grid-based page layouts with columns, mixed media, and more.",
video:this.getWistiaEmbed("4x96kf18u3"),duration:"1:44",helpButtons:!0}}})},getWistiaEmbed:function(b){return'<iframe src="http://fast.wistia.com/embed/iframe/'+b+'?controlsVisibleOnLoad=true&playButton=false&playerColor=000000&version=v1&videoHeight=360&videoWidth=640&volumeControl=true" allowtransparency="true" frameborder="0" scrolling="no" class="wistia_embed" name="wistia_embed" width="800" height="450"></iframe>'},renderUI:function(){this.get("contentBox").append(b.Node.create('<div class="close"></div>'));
this.get("contentBox").append(b.Node.create('<div class="overlay"></div>'));this.setStdModContent(b.WidgetStdMod.BODY,'<div class="body"></div>');var c=this.get("tray");1<b.Object.keys(c.get("sections")).length?(this.setStdModContent(b.WidgetStdMod.FOOTER,'<div class="footer"></div>'),c.render(this.getStdModNode(b.WidgetStdMod.FOOTER).one(".footer"))):this.get("contentBox").one(".body").addClass("single")},bindUI:function(){var b=this.get("tray"),c=this.get("contentBox");b.after("sectionChange",this.syncUI,
this);c.one(".overlay").on(this.get("id")+"|click",this._onOverlayClick,this);c.one(".close").on(this.get("id")+"|click",this._onCloseClick,this);c.delegate(this.get("id")+"|click",this._onOpenTicketClick,".ticket",this)},syncUI:function(){var c=this.get("tray"),e=this.get("contentBox").one(".body");if((c=c.get("sections")[this.get("section")])&&c!==e.getAttribute("data-sectionname"))e.setContent(f.expand(b.merge(c,{kbUrl:b.Squarespace.V6FAQUrl}))),this.get("visible")&&this._renderVideo()},_renderVideo:function(){var c=
this.get("tray").get("sections")[this.get("section")];this.get("contentBox").one(".player").append(b.Node.create(c.video));b.Squarespace.Analytics.trackInternal("help_video_view",{section:this.get("section")})},_removeVideo:function(){var b=this.get("contentBox").one(".player");b&&b.empty()},showWelcome:function(){var c=new b.Squarespace.Lightbox({content:'<div class="wrapper"><div class="title"><img src="/universal/images-v6/welcome-to-squarespace.png" width="363" height="40" title="Welcome to Squarespace."></div><div class="body">We\'ve set up your new website at a temporary URL while you build it with Squarespace.  <br/><br/> <strong>Once you\'re ready to launch your website, you can customize this address with a free custom domain name from Squarespace (with annual purchase) or a domain of your own.</strong></div><div class="mock-browser"><div class="browserBar"><div class="controls"></div><div class="urlBar">'+
Static.SQUARESPACE_CONTEXT.website.authenticUrl+'</div></div><div class="browserWindow"></div></div><div class="button-wrapper"><input type="button" class="saveAndClose" value="Start Building"/></div></div>',zIndex:200100,transition:"scale",name:"welcome-box",theme:"white",opacity:0.9,margin:0});c.show();return c},showTemplatePreviewWelcome:function(c){(new b.Squarespace.Lightbox({content:'<div class="wrapper commerce-welcome template-preview-welcome"><div class="title">Preview Mode</div><div class="body">You are now previewing the template <strong>'+
c.templateName+'</strong>. <ul class="disclaimer"><li class="point">We have loaded this template with a set of demo content that will give you an idea of how to best set up this template.</li><li class="point">Your live site will not be affected by changes you make to the style or the navigation order.</li><li class="point">In this preview, your existing pages have been moved to the <strong>Not Linked</strong> section within the content manager and can be moved into the active navigation as you setup this template.</li></ul>More information is available on our <a href="http://help.squarespace.com/customer/portal/articles/438017" target="_blank">help site</a>.</div><div class="button-wrapper"><input type="button" class="saveAndClose" value="Close"/></div></div>',
zIndex:200100,transition:"scale",name:"welcome-box",theme:"white",opacity:0.9,clickAnywhereToExit:!0,disableNormalClose:!1,margin:0})).show()},showLayoutEngine2Welcome:function(c){var e=new b.Squarespace.Lightbox({content:'<div class="wrapper le2-welcome"><div class="title"><h1>Introducing LayoutEngine 2</h1><h2>A new set of editing controls for your site.</h2></div><div class="body"><video autoplay loop><source src="https://d342grh1myn7qf.cloudfront.net/le2/le2-intro.m4v" type="video/mp4" /><source src="https://d342grh1myn7qf.cloudfront.net/le2/le2-intro.ogv" type="video/ogg" /></video></div><div class="button-wrapper"><span class="button"><a target="_blank" href="http://help.squarespace.com/customer/portal/articles/1394549">Learn More</a></span><span class="button ok"><a>Ok, I understand</a></span></div></div>',
zIndex:200100,transition:"scale",name:"welcome-box",opacity:0.7,clickAnywhereToExit:!1,disableNormalClose:!0,margin:0});e.show();e.getContentEl().on("click",function(b){b.halt()});e.getContentEl().all(".button").each(function(b){b.on("click",function(b){b.stopPropagation();b.target.ancestor(".ok",!0)&&e.hide()})});return e},showCommerceWelcome:function(){var c=new b.Squarespace.Lightbox({content:'<div class="wrapper commerce-welcome"><div class="title">Welcome to Commerce</div><div class="body">We are pleased to welcome you to <b>Squarespace Commerce</b>, a completely integrated way to sell physical and digital goods and services from your website. You can try Squarespace Commerce and start building your store for free.</div><div><b>However, in order to accept payments, you must:</b></div> <ul class="disclaimer"><li class="point">Create a free <b>Stripe</b> account and be a merchant based in the United States, Canada, the United Kingdom, or Ireland.</li><li class="point">Be a paying subscriber of any Squarespace package.</li></ul> <div class="button-wrapper"><input type="button" class="saveAndClose" value="Get Started with Commerce"/></div></div>',
zIndex:200100,transition:"scale",name:"welcome-box",opacity:0.9,clickAnywhereToExit:!1,disableNormalClose:!0,margin:0});c.show();new b.Squarespace.ToolTip({target:".commerce-welcome .footnote.fee",title:"Business Plan",body:"The Squarespace Business Plan is $24/mo with a Yearly subscription.",clickToShow:!0});c.contentEl.one(".saveAndClose").on("click",function(){c.hide()});return c},showNewslettersWelcome:function(){var c=new b.Squarespace.Lightbox({content:'<div class="wrapper newsletters-welcome"><div class="title">Welcome to Newsletters</div><div class="body">We are pleased to welcome you to <b>Squarespace Newsletters</b>, a completely integrated way to easily send newsletters to a mailing list from your website.</div><div class="button-wrapper"><input type="button" class="saveAndClose" value="Get Started with Newsletters"/></div></div>',
zIndex:200100,transition:"scale",name:"welcome-box",opacity:0.9,clickAnywhereToExit:!1,disableNormalClose:!0,margin:0});c.show();c.contentEl.one(".saveAndClose").on("click",function(){c.hide()});return c},show:function(c){b.Squarespace.EscManager.addTarget(this);this.set("section",c);this.get("rendered")||this.render();var e=this.get("tray");b.later(300,this,function(){this.get("visible")&&e.show()},this);b.later(600,this,function(){this.get("visible")&&this._renderVideo()},this);this.constructor.superclass.show.apply(this,
arguments)},hide:function(){this.get("contentBox").one("iframe")&&this._removeVideo();b.later(300,this,function(){this.get("tray").hide();this.constructor.superclass.hide.apply(this,arguments)})},close:function(){this.hide()},_onOverlayClick:function(b){b.halt();this.hide()},_onCloseClick:function(b){b.halt();this.hide()},_onKnowledgeBaseClick:function(c){b.Squarespace.Analytics.trackInternal("help_knowledgebase_click",{fromSection:this.get("section")});window.open("http://support.squarespace.com/",
"squarespace-help")},_onOpenTicketClick:function(c){b.Squarespace.Analytics.trackInternal("help_go_to_support_panel",{fromSection:this.get("section"),location:"help (overlay)",implementor:"dbrito",inApp:!0});this._popupToSupport()},_popupToSupport:function(){window.open("http://help.squarespace.com/open-a-ticket")}},{ATTRS:{align:{value:{points:[b.WidgetPositionAlign.TL,b.WidgetPositionAlign.TL]}},zIndex:{},tray:{valueFn:function(){return new c({visible:!1})}},section:{getter:function(){return this.get("tray").get("section")||
b},setter:function(b){this.get("tray").set("section",b)},validator:function(b){return!!this.get("tray").get("sections")[b]}}},CSS_PREFIX:"sqs-help"});c=b.Base.create("helpTray",b.Widget,[],{initializer:function(){this.plug(b.Plugin.WidgetAnim);this.anim.get("animShow").setAttrs({"from.marginTop":15,"to.marginTop":0,easing:b.Easing.easeOutStrong,duration:0.2});this.anim.get("animHide").setAttrs({"to.marginTop":15,easing:b.Easing.easeOutStrong,duration:0.1})},renderUI:function(){b.each(this.get("sections"),
this._renderVideoThumbnail,this)},bindUI:function(){this.get("contentBox").delegate(this.get("id")+"|click",this._onVideoClick,".help-video",this);this.after("sectionChange",this.syncUI,this)},_renderVideoThumbnail:function(b,c){b.name=c;this.get("contentBox").append(e.expand(b))},_onVideoClick:function(b){var c=b.target.ancestor(".help-video",!0).getAttribute("data-sectionname");b.halt();c&&this.set("section",c)},syncUI:function(){var b=this.get("contentBox");b.all(".help-video.active").removeClass("active");
b.one('.help-video[data-sectionname="'+this.get("section")+'"]').addClass("active")}},{ATTRS:{sections:{},section:{getter:function(c){return c||b.Object.keys(this.get("sections"))[0]}}},CSS_PREFIX:"sqs-help-tray"});b.Squarespace.HelpTray=c;b.Squarespace.Help=new d({visible:!1})},"1.0",{requires:["node","squarespace-json-template","squarespace-dombuilder","overlay","widget-anim"]});
YUI.add("squarespace-storage-lite",function(b){var d=b.config.doc,c=b.config.win,e=b.JSON,f=b.namespace("StorageLite"),g={},h,k;try{k=c.localStorage?1:c.globalStorage?2:c.openDatabase&&-1===navigator.userAgent.indexOf("Chrome")?3:5<=b.UA.ie?4:0}catch(l){k=0}b.StorageFullError=function(c){b.StorageFullError.superclass.constructor.call(c);this.name="StorageFullError";this.message=c||"Maximum storage capacity reached";b.UA.ie&&(this.description=this.message)};b.extend(b.StorageFullError,Error);b.augment(f,
b.EventTarget,!0,null,{emitFacade:!0,prefix:"storage-lite",preventable:!1});f.publish("ready",{fireOnce:!0});b.mix(f,{clear:function(){},getItem:function(b,c){return null},length:function(){return 0},removeItem:function(b){},setItem:function(b,c){}});1===k||2===k?(b.mix(f,{length:function(){return h.length},removeItem:function(b){h.removeItem(b)},setItem:function(b,c,d){h.setItem(b,d?e.stringify(c):c)}},!0),1===k?(h=c.localStorage,b.mix(f,{clear:function(){h.clear()},getItem:function(b,c){try{return c?
e.parse(h.getItem(b)):h.getItem(b)}catch(d){return null}}},!0)):2===k&&(h=c.globalStorage[c.location.hostname],b.mix(f,{clear:function(){for(var b in h)h.hasOwnProperty(b)&&(h.removeItem(b),delete h[b])},getItem:function(b,c){try{return c?e.parse(h[b].value):h[b].value}catch(d){return null}}},!0)),f.fire("ready")):3===k||4===k?(b.mix(f,{clear:function(){g={};f._save()},getItem:function(b,c){return g.hasOwnProperty(b)?g[b]:null},length:function(){var b=0,c;for(c in g)g.hasOwnProperty(c)&&(b+=1);return b},
removeItem:function(b){delete g[b];f._save()},setItem:function(b,c,e){g[b]=c;f._save()}},!0),3===k?(h=c.openDatabase("yui_storage_lite","1.0","YUI StorageLite data",1048576),b.mix(f,{_save:function(){h.transaction(function(b){b.executeSql("REPLACE INTO yui_storage_lite (name, value) VALUES ('data', ?)",[e.stringify(g)])})}},!0),h.transaction(function(b){b.executeSql("CREATE TABLE IF NOT EXISTS yui_storage_lite(name TEXT PRIMARY KEY, value TEXT NOT NULL)");b.executeSql("SELECT value FROM yui_storage_lite WHERE name = 'data'",
[],function(b,c){if(c.rows.length)try{g=e.parse(c.rows.item(0).value)}catch(d){g={}}f.fire("ready")})})):4===k&&(h=d.createElement("span"),h.addBehavior("#default#userData"),b.mix(f,{_save:function(){var c=e.stringify(g);try{h.setAttribute("data",c),h.save("yui_storage_lite")}catch(d){throw new b.StorageFullError;}}},!0),b.on("domready",function(){d.body.appendChild(h);h.load("yui_storage_lite");try{g=e.parse(h.getAttribute("data")||"{}")}catch(b){g={}}f.fire("ready")}))):f.fire("ready")},"1.0.0",
{requires:["event-base","event-custom","event-custom-complex","json"]});
YUI.add("squarespace-block-focus-handler",function(b){var d=b.namespace("Squarespace.Block").BlockFocusHandler=b.Base.create("BlockFocusHandler",b.Base,[],{initializer:function(){var c=b.Squarespace._hDocFocus;this._ensureDefaultFocusIsRemoved();c||(c=b.Squarespace._hDocFocus=b.one(b.config.doc).on("gesturemovestart",b.bind(this._onDocMouseDown,this)),c.listeners={count:0});c.listeners[b.stamp(this,!0)]=!0;c.listeners.count++},mouseMoveThreshold:10,mouseUpPropagationStopped:function(b){this.fire("mouseUpStopped",
b)},_onDocMouseDown:function(c){var e=b.one(b.config.doc);this._touchPos={x:c.pageX,y:c.pageY};this._detachMouseEvents();this._ensureDefaultFocusIsRemoved();this._hDocMouseMove=e.on("gesturemove",b.bind(this._onDocMouseMove,this));this._hDocMouseUp=e.on("gesturemoveend",b.bind(this._onDocMouseUp,this));this._preventedMouseup=this.on("mouseUpStopped",this._onMouseUpStopped,this)},_onDocMouseMove:function(b){var e=this._touchPos,d=this.mouseMoveThreshold,g=Math.abs(e.x-b.pageX),e=Math.abs(e.y-b.pageY);
if(g>d||e>d)b&&b.target.ancestor(".sqs-block-html .sqs-wysiwyg-editor",!0)?this._onDocMouseUp(b):this._detachMouseEvents()},_ensureDefaultFocusIsRemoved:function(){b.Widget._hDocFocus&&b.Widget._hDocFocus.detach()},_onDocMouseUp:function(b){this._detachMouseEvents();this._onDocFocus(b)},_onMouseUpStopped:function(b){b.target=b.details[0].target;this._onDocMouseUp(b)},preventBlockFocus:function(){this._detachMouseEvents()},_onDocFocus:function(c){var e=this._getBlockFromEvent(c),f=d._activeBlock;d._activeTarget=
c?c.target:null;this._shouldBlockFocusChange(f,e,c)?f&&this._isDialogOpen(f)?this._handleDialogOpenFocusChange(f,e,c):this._handleBlockFocusChange(f,e,c):this._handleContentItemFocusChange(c);b.UA.mobile||this._handleBlockSelectionChange(e,c)},giveBlockSyntheticFocus:function(b){var e=d._activeBlock;if(e===b)return!1;this._handleBlockFocusChange(e,b)},_shouldBlockFocusChange:function(b,e,d){return b===e||d&&d.target.ancestor(".sqs-prevent-block-focus-change, .sqsp-tooltip, .dialog-screen-overlay, .cke_dialog, .cke_toolbar, .dialog-choose-image-picker-url, .dialog-content-type.flyout, .dialog-minimal-video-editor.flyout, .sqs-image-picker, .sqs-widgets-confirmation-overlay, .sqs-widgets-confirmation, .workflow-flyout",
!0)||this._wasDialogClicked(b,d)||this._isSelectEvent(d)?!1:!0},_shouldBlockContentItemFocusChange:function(c,e,d){return void 0===d?!0:d.target.ancestor(".sqs-prevent-block-focus-change, .sqsp-tooltip, .dialog-screen-overlay, .cke_dialog, .cke_toolbar, .dialog-choose-image-picker-url, .dialog-content-type.flyout, .dialog-minimal-video-editor.flyout, .sqs-image-picker, .sqs-widgets-confirmation-overlay, .sqs-widgets-confirmation, .workflow-flyout",!0)||c===e||!b.Lang.isValue(c)&&!b.Lang.isValue(e)?
!1:!0},_handleContentItemFocusChange:function(b){var e=this._getContentItemFromEvent(b),f=d._activeContentItem;this._shouldBlockContentItemFocusChange(e,f,b)&&(f&&this._blurChild(f),e&&this._focusChild(e))},_handleDialogOpenFocusChange:function(c,e,d){var g=this._getBlockConfigDialog(c).get("dialog");this._onDialogClose(g,b.bind(function(){e&&this._focusBlock(e,d);this._blurBlock(c)},this));g.close(d,!1)},_handleBlockFocusChange:function(b,e,f){e&&this._focusBlock(e,f);b&&(this._blurBlock(b),e||(d._activeBlock=
null))},_focusBlock:function(c,e){c._domFocus=!0;c._set("focused",!0,{src:"ui"});if(c.get("isWidgetParent")&&b.Lang.isValue(e)){var f=this._getContentItemFromEvent(e);this._shouldBlockContentItemFocusChange(f,d._activeContentItem,e)&&this._focusChild(f)}d._activeBlock=c},_focusChild:function(b){b&&(b._domFocus=!0,b._set("focused",!0,{src:"ui"}),b.get("boundingBox").addClass("sqs-content-item-focused"),d._activeContentItem=b)},_blurChild:function(b){b._domFocus=!1;var e=b.get("boundingBox");!b.get("destroyed")&&
e.getDOMNode()?(b._set("focused",!1,{src:"ui"}),e.removeClass("sqs-content-item-focused")):console.warn("Not bluring ... childWidget is either destroyed or its boudningBox no longer exists.");d._activeContentItem===b&&(d._activeContentItem=null)},_blurBlock:function(b){b._domFocus=!1;b.get("boundingBox").getDOMNode()?b._set("focused",!1,{src:"ui"}):console.warn("Not bluring ... block boundingBox no longer exists.");b.get("isWidgetParent")&&b.each(this._blurChild,this)},blurBlock:function(b){this._blurBlock(b);
d._activeBlock===b&&(d._activeBlock=null)},blurAllBlocks:function(){this._onDocFocus()},_handleBlockSelectionChange:function(c,e){var d=this._isSelectEvent(e),g=b.Lang.isValue(c)&&0<c.get("selected");!d&&!g&&this._deselectAllSelectedBlocks();(d||!g)&&this._toggleBlockSelected(c)},_toggleBlockSelected:function(c){b.Lang.isValue(c)&&(0<c.get("selected")?(c.get("focused")&&this._blurBlock(c),c._set("selected",0,{src:"ui"})):c._set("selected",1,{src:"ui"}))},_deselectAllSelectedBlocks:function(){var c=
b.all(".sqs-selected.sqs-block");0<c.size()&&c.each(function(c){c=b.Widget.getByNode(c);this._toggleBlockSelected(c)},this)},_isSelectEvent:function(c){return!c?!1:"macintosh"===b.UA.os&&c.metaKey||"macintosh"!==b.UA.os&&c.ctrlKey},_isDialogOpen:function(b){return this._doesBlockHaveDialogEditor(b)&&this._getBlockConfigDialog(b).get("visible")},_onDialogClose:function(b,e){var d,g;d=b.once("dismiss",function(){e();g.detach()},this);g=b.once("cancel-close",function(){d.detach()})},_wasDialogClicked:function(b,
e){if(this._isDialogOpen(b)&&e)for(var d=this._getBlockConfigDialog(b).get("dialog"),d=[d].concat(d.childDialogs),g=0;g<d.length;g++){var h=d[g];if(h.el&&(h.el===e.target||h.el.contains(e.target)))return!0}return!1},_doesBlockHaveDialogEditor:function(b){return b&&b.blockEditor&&b.blockEditor.configDialog},_getBlockConfigDialog:function(b){return b.blockEditor.configDialog},_getBlockFromEvent:function(c){return c?b.Widget.getByNode(c.target.ancestor(".sqs-block",!0)):null},_getContentItemFromEvent:function(c){return(c=
c?c.target.ancestor(".sqs-widget",!0):!1)&&!c.hasClass("sqs-block")?b.Widget.getByNode(c):null},getCurrentlyFocused:function(){return{block:d._activeBlock,content:d._activeContentItem,target:d._activeTarget}},_detachMouseEvents:function(){this._hDocMouseMove&&this._hDocMouseMove.detach();this._hDocMouseUp&&this._hDocMouseUp.detach();this._preventedMouseup&&this._preventedMouseup.detach()},destructor:function(){b.Widget.prototype._unbindDOM.call(this);this._detachMouseEvents()}});b.namespace("Squarespace.Singletons").BlockFocusHandler=
new d},"1.0",{requires:"base model event squarespace-ss-widget widget-parent squarespace-util squarespace-enum squarespace-block-editor-base".split(" ")});
YUI.add("squarespace-widgets-blog-list",function(b){b.namespace("Squarespace.Widgets.Blog");var d=b.Squarespace.Widgets.Blog.List=b.Base.create("BlogList",b.Squarespace.Widgets.DataWidget,[b.WidgetChild,b.WidgetParent],{initializer:function(b){this._itemToWidgetMap={};this.publish("contentLoaded");this.get("loadOnInit")&&this._loadPage()},renderUI:function(){d.superclass.renderUI.call(this);this._addHeader()},bindUI:function(){d.superclass.bindUI.call(this);this._registerEvent(this.get("items").after("add",
function(b){"reorder"!=b.source&&b.model.get("workflowState")===this.get("options").workflowState&&(this._addItemWidget(b.model),this._syncHeight())},this));var b=this.get("contentItemList");this._registerEvent(b.after("load add remove create bulk-remove move-items".split(" "),function(e){"ContentItemList:add"!==e.type&&this.syncUI();this.fire("syncComplete",{itemSize:b.size()})},this));this.get("contentBox").delegate("click",this._getMoreItems,"."+this.getClassName("more"),this)},syncUI:function(){d.superclass.syncUI.call(this);
this.set("visible",0!==this.get("contentItemList").size());this._syncListItems();this._syncMoreLink();this._syncHeight()},_syncHeight:function(){var b=0,e=this.get("boundingBox");0!==this.visibleItemCount()?b=this.get("contentBox").get("offsetHeight"):this.hasMorePages()&&(b=this._moreLinkEl.get("offsetHeight"),b+=this._titleEl.get("offsetHeight"));e.setStyle("height",b)},loadNextPage:function(c){if(this.hasMorePages()){this._startSpinner();var e={pageAction:b.Squarespace.PageAction.NEXT,start:this.get("nextPageStart")},
d=b.bind(function(){this.hasSpinner()&&this._stopSpinner();b.Lang.isFunction(c)&&c()},this);this._loadPage(e,d)}},_loadPage:function(c,e){var d=b.merge(this.get("options"),c||{}),g=new b.Squarespace.Models.ContentItemList({parent:this.get("collection")}),h=b.bind(function(c,d){var f=g.get("pagination").nextPageStart||null;this.set("nextPageStart",f);this.get("contentItemList").add(g,{silent:!0});this.get("items").add(g,{silent:!0});this._syncMoreLink();this._syncHeight();this.fire("contentLoaded");
b.Lang.isFunction(e)&&e()},this);g.load(d,h)},hasMorePages:function(){return b.Lang.isValue(this.get("nextPageStart"))},visibleItemCount:function(){var b=0;this.each(function(e){e.get("visible")&&b++});return b},getWidgetForItem:function(b){return this._itemToWidgetMap[b.get("clientId")]},setSelected:function(b,e){this.each(function(d){d.set("isSelected",d===b,e);d.set("selected",0)},this)},_addHeader:function(){this._titleEl=b.Node.create('<div class="'+this.getClassName("header")+'"><div class="title">'+
this.get("strings.title")+"</div></div>");this.get("contentBox").append(this._titleEl)},_addItemWidget:function(b){var e=this.add({item:b}).item(0);this._itemToWidgetMap[b.get("clientId")]=e},_syncMoreLink:function(){if(!b.Lang.isValue(this._moreLinkEl)){var c=this.getClassName("more");this._moreLinkEl=b.Node.create('<div class="'+c+'"><div class="'+c+'-content">+</div></div>')}this.get("contentBox").append(this._moreLinkEl);this._toggleMoreLink(!this.hasMorePages())},_toggleMoreLink:function(b){this._moreLinkEl&&
this._moreLinkEl.toggleClass(this.getClassName("hidden"),!!b)},_getMoreItems:function(b){this.hasMorePages()&&this.loadNextPage()},_syncListItems:function(){var c=this._modelListToSortedArr(this._getFilteredList());this._destroyChildren();b.Lang.isValue(c)&&0<c.length&&(this.setLoadedState(),b.Array.each(c,this._addItemWidget,this),this.fire("syncComplete",{itemSize:c.length}))},_modelListToSortedArr:function(c){return b.Lang.isValue(c)&&0<c.size()?(c=c.toArray().sort(function(b,c){return b.get("addedOn")-
c.get("addedOn")}).reverse(),c=c.slice(0,this.get("contentItemList").size())):[]},_getFilteredList:function(){var b=this.get("options").workflowState;this.get("contentItemList").size();return this.get("items").filter({asList:!0},function(e){return e.get("workflowState")===b},this)},_startSpinner:function(){this._stopSpinner();var c=new b.Squarespace.Spinner({color:"dark"}),e=b.Node.create('<div class="spinner-container"></div>'),d=b.later(1,this,function(){c.render(e)});this._moreLinkEl.one("."+this.getClassName("more")+
"-content").hide();this._moreLinkEl.append(e);this._currentSpinHandle={cancel:function(){c.get("rendered")||d.cancel();c.destroy();e.remove(!0)}}},getSelectedWidget:function(){return b.Array.find(this.toJSON(),function(b){return b.get("isSelected")})},_stopSpinner:function(){this.hasSpinner()&&(this._currentSpinHandle.cancel(),this._currentSpinHandle=null);this._moreLinkEl&&this._moreLinkEl.one("."+this.getClassName("more")+"-content").show()},hasSpinner:function(){return b.Lang.isValue(this._currentSpinHandle)},
_destroyChildren:function(){var c=[];this.each(function(b){b.set("selected",0);c.push(b)},this);b.Array.each(c,function(b){b.destroy()})}},{CSS_PREFIX:"sqs-blog-list",ATTRS:{collection:{},contentItemList:{value:null,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ContentItemList)},defaultChildType:{value:b.Squarespace.Blog.Item},items:{},loadOnInit:{value:!0},model:{getter:function(){return this.get("collection")}},moveable:{value:!0},nextPageStart:{value:!0},options:{value:{}},
strings:{value:{title:"Default State"}},threshold:{value:5,validator:b.Lang.isNumber}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-content-manager-plugin-sticky-header squarespace-content-manager-widgets-blog-item squarespace-models-content-item-list squarespace-ss-widget squarespace-spinner widget-child widget-parent".split(" ")});
YUI.add("squarespace-settings-site-contributors",function(b){b.namespace("Squarespace.Widgets");var d=b.namespace("Squarespace.Settings.Site").Contributors=b.Base.create("contributorSettings",b.Squarespace.Widgets.SettingsPanel,[],{bindUI:function(){d.superclass.bindUI.apply(this,arguments);b.Squarespace.Context.getInstance().get("websiteSettings").after("ownerIdChange",this._loadInitialPanelData,this)},_syncRenderedFields:function(){d.superclass._syncRenderedFields.call(this);this._toggleFieldVisibility()},
_loadInitialPanelData:function(){this._ownerPermissionList=new b.Squarespace.Models.MemberPermissionList;this._invites=new b.Squarespace.Models.MemberInviteList;this._activePermissions=new b.Squarespace.Models.MemberPermissionList;this._passivePermissions=new b.Squarespace.Models.MemberPermissionList;this._pseudonymPermissions=new b.Squarespace.Models.MemberPermissionList;this._loadInvitesAndPermissions()},_loadInvitesAndPermissions:function(){var c=this._ownerPermissionList,e=this._invites,d=this._activePermissions,
g=this._passivePermissions,h=this._pseudonymPermissions,k=new b.Squarespace.Models.MemberPermissionList,l=new b.Squarespace.MultiLoader({loadables:[e,k]});l.after("load",function(){var l=b.Array.find(k.toArray(),function(b){return b.isOwner()});b.Lang.isValue(l)&&c.add(k.remove(l));d.add(k.getActive());this._sortActive(d);g.add(k.getPassive());h.add(k.getPseudonym());this._bindPermissions();this.set("dataState",this.getProperty("DATA_STATES").LOADED);this.set("data",{ownerPermission:c,invites:e,activePermissions:d,
passivePermissions:g,pseudonymPermissions:h})},this);l.load()},_inviteContributor:function(){var c=new b.Squarespace.Models.MemberInvite;c.onceAfter("save",function(){this._invites.add(c)},this);(new b.Squarespace.Editor.MemberInvite({model:c})).show()},_addBasicAuthor:function(){var c=new b.Squarespace.Models.MemberAccount({pseudonymAccount:!0}),e=new b.Squarespace.Models.MemberPermission({memberAccount:c});e.onceAfter("save",function(){this._pseudonymPermissions.add(e);Static.SQUARESPACE_CONTEXT.memberAccountNames[c.get("id")]=
{displayName:c.get("displayName")}},this);c.onceAfter("save",function(){e.set("memberAccountId",c.get("id"));e.save(function(c){c&&new b.Squarespace.Widgets.Alert({"strings.title":"Error Saving Author","strings.message":c.message||"We were unable to save the author."})})},this);(new b.Squarespace.Editor.MemberAccount({model:c})).show()},_sortActive:function(){var c=this._activePermissions,e,d=[];c.each(function(c,h){c.isMe()?e=c:b.Object.hasKey(c.get("permissions"),b.Squarespace.WebsiteRole.ADMIN)&&
d.push(c)},this);c.add(c.remove(d),{index:0});b.Lang.isValue(e)&&c.add(c.remove(e),{index:0})},_bindPermissions:function(){var b=this._activePermissions,e=this._passivePermissions;this._registerEvent(b.after("*:save",this._checkActivePermissionSave,this));this._registerEvent(e.after("*:save",this._checkPasivePermissionSave,this));this._registerEvent(this._invites.after(["add","remove"],this._toggleFieldVisibility,this));this._registerEvent(b.after(["add","remove"],this._toggleFieldVisibility,this));
this._registerEvent(e.after(["add","remove"],this._toggleFieldVisibility,this));this._registerEvent(this._pseudonymPermissions.after(["add","remove"],this._toggleFieldVisibility,this))},_checkActivePermissionSave:function(c){c=c.target;b.Object.isEmpty(c.get("permissions"))&&this._passivePermissions.add(this._activePermissions.remove(c))},_checkPasivePermissionSave:function(c){c=c.target;b.Object.isEmpty(c.get("permissions"))||this._activePermissions.add(this._passivePermissions.remove(c))},_toggleFieldVisibility:function(){this.getField("invites").get("boundingBox").toggleClass("has-content",
0<this._invites.size());this.getField("ownerPermission").get("boundingBox").toggleClass("has-content",0<this._ownerPermissionList.size());this.getField("activePermissions").get("boundingBox").toggleClass("has-content",0<this._activePermissions.size());this.getField("passivePermissions").get("boundingBox").toggleClass("has-content",0<this._passivePermissions.size());this.getField("pseudonymPermissions").get("boundingBox").toggleClass("has-content",0<this._pseudonymPermissions.size())}},{CSS_PREFIX:"sqs-contributors-settings",
ATTRS:{initialDataUrl:{value:b.Squarespace.REST_API_ROOT+"member-permissions"},strings:{value:{title:"Permissions",description:'Here you can control who has access to which areas of the site. You can also add Basic Authors, who appear in name only and have no permissions. <a target="new" href="'+b.Squarespace.HelpLinks.CONTRIBUTORS+'">More help regarding contributors and permissions.</a>'}},buttons:{value:[{type:"add",label:"Invite",action:function(){if(this._activePermissions.size()>=Static.SQUARESPACE_CONTEXT.website.contributorLimit)(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Upgrade",
"strings.title":"Extra Contributors Not Available","strings.message":"Adding additional contributors is not available on your current plan. Upgrade to add more contributors."})).on("confirm",function(){b.config.win.CONFIG_PANEL.getHistory().replace({module:"settings","settings-subpanelName":"billing-settings"})},this);else this.fire("add-item"),this._inviteContributor()}},{type:"add",label:"Add Basic Author",action:function(){this.fire("add-item");this._addBasicAuthor()}}]},fields:{getter:function(){return[{ctor:b.Squarespace.DialogFields.MemberInviteList,
config:{name:"invites"}},{ctor:b.Squarespace.DialogFields.MemberPermissionList,config:{name:"ownerPermission","strings.title":"Website Owner",authenticatedAccount:{$dontRecurse:!0,$valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberAccount}}}},{ctor:b.Squarespace.DialogFields.MemberPermissionList,config:{name:"activePermissions","strings.title":"Contributors With Permissions",authenticatedAccount:{$dontRecurse:!0,$valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberAccount}}}},
{ctor:b.Squarespace.DialogFields.MemberPermissionList,config:{name:"passivePermissions","strings.title":"Contributors Without Permissions",authenticatedAccount:{$dontRecurse:!0,$valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberAccount}}}},{ctor:b.Squarespace.DialogFields.MemberPermissionList,config:{name:"pseudonymPermissions","strings.title":"Basic Authors",authenticatedAccount:{$dontRecurse:!0,$valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberAccount}}}}]}}}})},
"1.0",{requires:"base array-extras squarespace-enum squarespace-settings-panel squarespace-help squarespace-ui-base squarespace-util squarespace-editor-member-invite squarespace-editor-member-account squarespace-models-member-invite squarespace-models-member-permission squarespace-models-member-account squarespace-multi-loader squarespace-dialog-member-invite-list squarespace-dialog-member-permission-list squarespace-context squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-form-pre-submit-topic-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["form-pre-submit-topic.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+('<div class="topic-control-bar">\n  <div class="topic-drag-handle-wrapper">\n    <div class="topic-drag-handle"></div>\n  </div>\n\n  <div class="topic-title"></div>\n\n  <div class="topic-controls">\n    <div class="remove-topic">&times;</div>\n    <div class="edit-topic">'+
b((l=(l=c.strings,null==l||!1===l?l:l.editText),"function"===typeof l?l.apply(c):l))+'</div>\n  </div>\n</div>\n\n<div class="topic-children">\n\n  <div class="topic-label"></div>\n\n  <div class="topic-child-controls">\n\n    <div class="topic-child-control-wrapper">\n      <div class="topic-child-control add-sub-topics">Add Sub Topics</div>\n    </div>\n\n    <div class="topic-child-control-wrapper">\n      <div class="topic-child-control add-content">Add Content</div>\n    </div>\n\n  </div>\n\n  <div class="topic-sub-topics"></div>\n\n  <div class="topic-content"></div>\n</div>')})})();
b.Handlebars.registerPartial("form-pre-submit-topic.html".replace("/","."),d.templates["form-pre-submit-topic.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-member-permission",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.MemberPermission=b.Base.create("MemberPermission",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{initializer:function(){this._isPseudonymAccount=this.get("memberPermission").get("memberAccount").get("pseudonymAccount")},renderUI:function(){d.superclass.renderUI.call(this);this.get("contentBox")},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("contentBox");c.on("click",
function(b){!b.target.hasClass("button")&&this.get("editable")&&(b.target.ancestor(".activate",!0)?this._activate():this._edit())},this);var e=this.get("memberPermission");c.one(".transfer-owner-btn");c.delegate("click",function(c){c.halt(!0);(new b.Squarespace.OwnerTransferFlow).start()},".transfer-owner-btn",this);e.isMe()||this._isPseudonymAccount?this._registerEvent(e.get("memberAccount").after("save",this.syncUI,this)):this._registerEvent(e.after("save",this.syncUI,this))},syncUI:function(){d.superclass.syncUI.call(this);
var c=this.get("contentBox"),e=this.get("memberPermission"),f=e.get("memberAccount").get("externalId");c.setHTML(b.Squarespace.UITemplates.render(this.getProperty("TEMPLATE_NAME"),e.toJSON()));var g=b.Lang.isString(f)&&1<f.length;c.one(".overlay").addClass(g?f.split("_")[0]:"squarespace");c.toggleClass("me",e.isMe());c.toggleClass("owner",e.isOwner());c.toggleClass("pseudonym-account",this._isPseudonymAccount);c.toggleClass("editable",this.get("editable"))},_edit:function(){var c=this.get("memberPermission");
c.isMe()||this._isPseudonymAccount?(new b.Squarespace.Editor.MemberAccount({model:c.get("memberAccount"),attachedMemberPermission:c})).show():c.isOwner()?new b.Squarespace.Widgets.Alert({"strings.title":"Website Owner","strings.message":b.Lang.sub("The website owner's permissions cannot be changed. Have {name} transfer ownership to you, then try again.",{name:c.get("memberAccount").get("displayName")||"the owner"})}):(new b.Squarespace.Editor.MemberPermission({model:c})).show()},_activate:function(){var c=
this.get("memberPermission").get("memberAccount"),e=b.Lang.sub("{displayName} has not yet activated the account. This will send an email to <strong>{email}</strong> with instructions on how to activate the account.",{displayName:c.get("displayName"),email:c.get("email")});(new b.Squarespace.Widgets.Confirmation({"strings.title":"Send Activation Email","strings.message":e})).on("confirm",function(){c.requestActivation(b.bind(function(c){c?new b.Squarespace.Widgets.Alert({"strings.title":"Failed to Send Email",
"strings.message":c.message||"System error. Please try again later."}):new b.Squarespace.Widgets.Information({"strings.title":"Activation Requested","strings.message":"An email has been sent requesting that the specified account be activated."})},this))},this)}},{CSS_PREFIX:"sqs-member-permission",TEMPLATE_NAME:"member-permission.html",ATTRS:{memberPermission:{valueFn:function(){return new b.Squarespace.Models.MemberPermission},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberPermission)},
authenticatedAccount:{value:null},editable:{valueFn:function(){var c=this.get("memberPermission");return b.Lang.isValue(c)?c.isMe()||!c.isOwner():!0},validator:b.Lang.isBoolean}}})},"1.0",{requires:"base widget-child squarespace-ss-widget squarespace-member-permission-template squarespace-models-member-permission squarespace-editor-member-account squarespace-editor-member-permission squarespace-attr-validators squarespace-ui-templates squarespace-hb-humanizedate-format squarespace-hb-member-permission squarespace-hb-member-account-isowner squarespace-owner-transfer-dialog-flow squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-block-audio-player-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["block-audio-player.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="player">\n  <div class="action">\n    <div class="play">\n      <div class="play-button"></div>\n    </div>\n    <div class="pause">\n      <div class="pause-button"></div>\n    </div>\n  </div>\n  <div class="labels">\n    <div class="title-wrapper">\n      <div class="title" title="';
(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=l(h)+'" data-title="';(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=l(h)+'">';(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n    </div>\n    <div class="artistName" title="';(h=d.artistName)?h=h.call(c,{hash:{},data:k}):(h=c.artistName,h="function"===typeof h?h.apply(c):h);b+=l(h)+'">';(h=d.artistName)?
h=h.call(c,{hash:{},data:k}):(h=c.artistName,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n  </div>\n  <div class="secondary-controls">\n    <div class="time">\n      <span class="progress"></span>\n      <span class="total">';(h=d.duration)?h=h.call(c,{hash:{},data:k}):(h=c.duration,h="function"===typeof h?h.apply(c):h);return b+=l(h)+'</span>\n    </div>\n  </div>\n  <div class="track">\n    <span class="played"><span class="icon"></span></span>\n  </div>\n</div>\n'})})();b.Handlebars.registerPartial("block-audio-player.html".replace("/",
"."),d.templates["block-audio-player.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("resize-plugin",function(b,d){var c=function(e){e.node=b.Widget&&e.host instanceof b.Widget?e.host.get("boundingBox"):e.host;e.widget=e.host instanceof b.Widget?e.host:!1;c.superclass.constructor.call(this,e)};c.NAME="resize-plugin";c.NS="resize";c.ATTRS={node:{value:void 0},widget:{value:void 0}};b.extend(c,b.Resize,{initializer:function(b){this.set("node",b.node);this.set("widget",b.widget);this.on("resize:resize",function(b){this._correctDimensions(b)})},_correctDimensions:function(b){var c=
this.get("node"),d={old:c.getX(),cur:b.currentTarget.info.left},h={old:c.getY(),cur:b.currentTarget.info.top};this.get("widget")&&this._setWidgetProperties(b,d,h);this._isDifferent(d.old,d.cur)&&c.set("x",d.cur);this._isDifferent(h.old,h.cur)&&c.set("y",h.cur)},_setWidgetProperties:function(c,d,g){var h=this.get("widget"),k=h.get("height"),l=h.get("width"),p=c.currentTarget.info.offsetWidth-c.currentTarget.totalHSurrounding;c=c.currentTarget.info.offsetHeight-c.currentTarget.totalVSurrounding;this._isDifferent(k,
c)&&h.set("height",c);this._isDifferent(l,p)&&h.set("width",p);h.hasImpl&&h.hasImpl(b.WidgetPosition)&&(this._isDifferent(h.get("x"),d.cur)&&h.set("x",d.cur),this._isDifferent(h.get("y"),g.cur)&&h.set("y",g.cur))},_isDifferent:function(b,c){var d=!1;b!==c&&(d=c);return d}});b.namespace("Plugin");b.Plugin.Resize=c},"3.17.2",{requires:["resize-base","plugin"],optional:["resize-constrain"]});
YUI.add("squarespace-models-template",function(b){var d=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]),c=b.namespace("Squarespace.Utils").AcceptTypesHelpers={getDefaultPageAcceptTypes:function(c){c=c||{};var e=["subscription","gallery-block","template-page"],d=b.Squarespace.Singletons.Template.get("collectionConfigs");return b.Array.filter(b.Object.keys(d),function(b){return c.removeFolders&&d[b].get("folder")?!1:-1==e.indexOf(b)}).concat(["link"])}},e=b.Base.create("TemplateNavigation",
b.Model,[],{toJSON:function(){return this.constructor.superclass.toJSON.call(this)},_setItemList:function(c){b.Lang.isObject(c)&&(c=this.constructor.ATTRS.itemList.valueFn.call(this));var e=new b.Squarespace.Models.NavigationItemList;e.setTemplateNavigation(this);b.Array.forEach(c,function(c){var d=b.clone(c.children,!0);delete c.children;e.add(c).set("children",d||[])},this);return e},setTemplateNavigationList:function(b){this._templateNavigationList=b},getTemplateNavigationList:function(){return this._templateNavigationList}},
{ATTRS:{index:{validator:b.Lang.isBoolean},name:{},title:{},itemList:{lazyAdd:!1,value:[],valueFn:function(){var c=this.get("name"),e=b.Array.find(Static.SQUARESPACE_CONTEXT.siteLayout,function(b){if(b.identifier==c)return b});return e?e.links:[]},setter:"_setItemList"},acceptTypes:{valueFn:c.getDefaultPageAcceptTypes},emptyMessage:{valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?"This navigation does not contain any pages. Add one above, or drop one here.":"This navigation does not contain any pages. Drag one here or click Add Page below."}}}}),
f=b.Base.create("TemplateNavigationList",b.ModelList,[],{model:e,initializer:function(){this._hiddenNavigation=this.add({index:!1,name:b.Squarespace.Constants.hiddenNavigationName,title:"Not Linked",emptyMessage:"There are no unlinked pages. All of your pages are reachable through your navigation."});this.each(function(b){this._bootstrapReference(b)},this);this.on("add",function(b){this._bootstrapReference(b.model)},this)},_bootstrapReference:function(b){b.setTemplateNavigationList(this)},setTemplate:function(b){this._template=
b},getTemplate:function(){var b=this._template;if(!b)throw"No Template found for TemplateNavigationList. Possible errors with wrapping data.";return b},getHiddenNavigation:function(){return this._hiddenNavigation},_getNavigationItemForCollectionIdFromList:function(c,e){for(var d=c.toArray(),f=0;f<d.length;f++){if(d[f].get("collectionId")==e)return d[f];var g=d[f].get("children");if(g&&!g.isEmpty()&&(g=this._getNavigationItemForCollectionIdFromList(g,e),b.Lang.isValue(g)))return g}},getNavigationItemForCollectionId:function(c){for(var e=
this.toArray(),d=0;d<e.length;d++){var f=this._getNavigationItemForCollectionIdFromList(e[d].get("itemList"),c);if(b.Lang.isValue(f))return f}}}),g=b.namespace("Squarespace.Models").CollectionConfiguration=b.Base.create("CollectionConfiguration",b.Model,[],{initializer:function(c){b.Lang.isBoolean(c.index)&&c.index?this.set("folderBehavior",b.Squarespace.FolderBehavior.INDEX):b.Lang.isBoolean(c.folder)&&c.folder&&this.set("folderBehavior",b.Squarespace.FolderBehavior.NONE)}},{ATTRS:{collectionType:{value:b.Squarespace.CollectionTypes.GENERIC},
acceptTypes:{getter:function(b){this.get("folder")&&!b.length&&(b=c.getDefaultPageAcceptTypes({removeFolders:!0}));return b}},folder:{value:!1},folderBehavior:{},supported:{value:!0}}}),h=b.Base.create("TemplatePageConfiguration",b.Model,[],{},{ATTRS:{icon:{value:"template-page"},collectionType:{value:b.Squarespace.CollectionTypes.TEMPLATE_PAGE},supported:{value:!0}}}),k=b.Base.create("CustomTypeConfiguration",b.Model,[],{},{});b.namespace("Squarespace.Models").Template=b.Base.create("Template",b.Model,
[],{sync:function(b,c,e){switch(b){case "read":this._read(c,e)}},_read:function(c,e){b.Data.get({url:"/api/template/GetTemplate",data:{templateId:this.get("id")},success:function(b){Static.SQUARESPACE_CONTEXT.siteLayout=b.siteLayout;Static.SQUARESPACE_CONTEXT.demoCollections=b.demoCollections;this.set("homepageCollectionId",b.installation.homepageCollectionId);e(null,b.template)}},this)},_setNavigations:function(c){if(b.Lang.isArray(c))c=new f({items:c});else if(!b.instanceOf(c,f))throw"Can't set navigation that isn't an instanceOf TemplateNavigationList or a plain array.";
c.setTemplate(this);return c},_setCollectionConfigs:function(c){if(!b.Lang.isObject(c))throw"CollectionConfigs needs to be an object.";b.Lang.isValue(c.products)&&delete c.products;c=b.merge(this.constructor.DEFAULT_COLLECTION_CONFIGURATIONS,c);var e={},d;for(d in c)e[d]=new g(c[d]);return e},_setPageConfigs:function(c){if(!b.Lang.isObject(c))throw"PageConfigs needs to be an object.";var e={},d;for(d in c)e[d]=new h(c[d]);return e},_setCustomTypes:function(c){if(!b.Lang.isObject(c))throw"CustomTypes needs to be an object.";
for(var e={},d=0;d<c.length;d++)e[c[d].name]=new k(c[d]);return e},saveHomepageCollectionId:function(c){b.Data.post({url:"/api/template/SetHomepageCollection",data:{collectionId:this.get("homepageCollectionId")},success:function(b){c&&c(null,b)},failure:function(b){c&&c(b,null)}})},refreshNavigationList:function(){b.Data.get({url:"/api/commondata/GetSiteLayout",success:function(c){var e={};this.get("navigations").each(function(b){e[b.get("name")]=b});b.Array.forEach(c.layout,function(c){var d=e[c.identifier];
if(d){var f={};d.get("itemList").each(function(b){var c=b.get("collectionId");c?f[c]=b:f[b.get("externalLink.url")]=b});b.Array.forEach(c.links,function(c){(!b.Lang.isValue(c.collectionId)||!b.Object.hasKey(f,c.collectionId))&&(!b.Object.getValue(c,["externalLink","url"])||!b.Object.hasKey(f,c.externalLink.url))&&d.get("itemList").add(c)},this)}else b.Squarespace.Logger.log("Missing Navigation",{message:'Could not locate "'+c.identifier+'" in Y.Squarespace.Singletons.Template',action:"refreshNavigationList",
fileName:"models/template.js"})},this)}},this)},isTemplateOwner:function(){return this.get("ownerWebsiteId")==d}},{ATTRS:{navigations:{setter:"_setNavigations",lazyAdd:!1},collectionConfigs:{setter:"_setCollectionConfigs",value:{}},pageConfigs:{setter:"_setPageConfigs",value:{}},customTypes:{setter:"_setCustomTypes",value:{}},homepageCollectionId:{}},DEFAULT_COLLECTION_CONFIGURATIONS:{page:{collectionType:b.Squarespace.CollectionTypes.PAGE,typeName:"page",title:"Page",ordering:b.Squarespace.CollectionOrdering.CUSTOM,
icon:"page",addText:"Add Block"},"gallery-block":{collectionType:b.Squarespace.CollectionTypes.GALLERY_BLOCK,typeName:"gallery-block",title:"Gallery Block",ordering:b.Squarespace.CollectionOrdering.USER,acceptTypes:["image","video"]},products:{collectionType:b.Squarespace.CollectionTypes.PRODUCT,typeName:"products",title:"Products",pageSize:20,ordering:b.Squarespace.CollectionOrdering.USER,acceptTypes:["store_item"],view:b.Squarespace.CollectionView.PRODUCT_TABLE,icon:"products",addText:"Add Product"},
"template-page":{collectionType:b.Squarespace.CollectionTypes.TEMPLATE_PAGE,title:"Template Page",icon:"projects"},"splash-page":{collectionType:b.Squarespace.CollectionTypes.SPLASH_PAGE,typeName:"splash-page",title:"Splash Page",ordering:b.Squarespace.CollectionOrdering.CUSTOM,icon:"splash-page"},subscription:{collectionType:b.Squarespace.CollectionTypes.SUBSCRIPTION,typeName:"subscription",title:"Subscription",ordering:b.Squarespace.CollectionOrdering.CHRONOLOGICAL}}});Static&&(Static.SQUARESPACE_CONTEXT&&
Static.SQUARESPACE_CONTEXT.template)&&(e=b.merge(Static.SQUARESPACE_CONTEXT.template,{homepageCollectionId:Static.SQUARESPACE_CONTEXT.homepageCollectionId}),delete e.navigations,b.namespace("Squarespace.Singletons"),(b.Squarespace.Singletons.Template=new b.Squarespace.Models.Template(e)).set("navigations",Static.SQUARESPACE_CONTEXT.template.navigations))},"1.0",{requires:["base","model","squarespace-models-navigation"]});
YUI.add("squarespace-settings-newsletters-settings",function(b){var d=b.namespace("Squarespace.Widgets").NewslettersSettingsPanel=b.Base.create("newlettersSettingsPanel",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(b){this.set("strings.title","Settings");this.set("strings.description","The newsletters settings area allows you to control high-level details about your newsletters.")},_getSanitizedPanelData:function(){var c=d.superclass._getSanitizedPanelData.call(this);b.Array.each(["logoImage"],
function(b){c[b]?(c[b+"Id"]=c[b].get("id"),delete c[b]):delete c[b+"Id"]});return c}},{CSS_PREFIX:"sqs-newsletters-settings",ATTRS:{buttons:{value:[{type:"save",label:"Save Settings"}]},fields:{value:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Logo Image",text:"Your logo will appear at the top of your newsletter.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.FileImage,config:{name:"logoImage",contentLabel:"a logo",mode:b.Squarespace.UploadModes.TRANSIENT,height:200,width:0.6,
spinnerColor:"dark"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"companyName","strings.placeholder":"Company Name",submitOnEnter:!0,required:!0,maxLength:120}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"companyTagLine","strings.placeholder":"Tag Line",submitOnEnter:!0,maxLength:300}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Name",text:"By law it is required to specify a name",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{required:!1,name:"firstName",
title:"First Name",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"major"}},{ctor:b.Squarespace.DialogFields.Text,config:{required:!1,name:"lastName",title:"Last Name",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:!0,style:"major"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Address",text:"By law it is required to specify an address",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Map,config:{name:"location",title:"Enter a location...",titleStyle:"inline",
height:147,strings:{placeholderAddressTitle:"Company Name",placeholderAddress1:"Street Address",placeholderAddress2:"City, State, Zip",placeholderAddressCountry:"Country"}}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"From Email",text:"All emails to your subscribers will be sent from this address."}},{ctor:b.Squarespace.DialogFields.Text,config:{mailcheck:!0,name:"fromAddress",style:"major"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"From Display Name",text:"All emails to your subscribers will be sent displaying this name."}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"fromDisplayName",style:"major"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Reply To:",text:"Subscribers can reply to this address."}},{ctor:b.Squarespace.DialogFields.Text,config:{mailcheck:!0,name:"replyToAddress",style:"major"}}]},initialDataUrl:{readOnly:!0,getter:function(){return b.Squarespace.REST_API_ROOT+"newsletters/settings"}},postChangesAsJson:{value:!0},saveUrl:{readOnly:!0,getter:function(){return b.Squarespace.REST_API_ROOT+
"newsletters/settings"}}}})},"1.0",{requires:"anim base json node oop squarespace-dialog-description squarespace-dialog-file-image squarespace-dialog-map squarespace-dialog-text squarespace-settings-panel squarespace-tray squarespace-dombuilder squarespace-markdown".split(" ")});
YUI.add("squarespace-block-code",function(b){b.namespace("Squarespace.Block").Code=b.Base.create("block-code",b.Squarespace.Block.ModelSyncBase,[],{_setWidgetContent:function(){var b=this.get("contentBox");b.setHTML(this.get("widgetContent"));b.all("script").each(function(b){b.replace('<div class="sqs-state-message warning">Embedded Code: This block contains embedded code and will only be rendered on the front of your site.</div>')});this.get("model").get("aspectRatio")&&b.one(".sqs-state-message")&&
b.one(".sqs-state-message").wrap("<div></div>")}},{CSS_PREFIX:"sqs-block-code",ATTRS:{defaultContentModel:{value:{wysiwyg:{engine:"code",mode:"htmlmixed",isSource:!1,source:""},html:"<p>Hello, World!</p>"}},editor:{value:b.Squarespace.Block.Editor.Code}}})},"1.0",{requires:["squarespace-block-base-modelsync","squarespace-block-code-editor","squarespace-block-mixin-aspect-ratio"]});
YUI.add("squarespace-dialog-permissions",function(b){b.namespace("Squarespace.DialogFields");b.Squarespace.DialogFields.Permissions=b.Base.create("Permissions",b.Squarespace.DialogFields.MultiOptionArray,[],{initializer:function(){this.get("contentBox").addClass("sqs-multi-option-content")},_getErrors:function(){return!this.get("allowEmpty")&&0>=this.get("data").length?["Must select at least one permission."]:[]}},{CSS_PREFIX:"sqs-permissions",ATTRS:{className:{value:"left top round"},multi:{value:!0},
numeric:{value:!0},allowEmpty:{value:!0},options:{value:[{icon:"admin",title:"Administrator",description:"Have full permission to access everything on the website.",value:b.Squarespace.WebsiteRole.ADMIN},{icon:"content",title:"Content Editor",description:"Can edit content on the website, but cannot change settings.",value:b.Squarespace.WebsiteRole.EDITOR},{icon:"billing",title:"Billing",description:"Lets users update the credit card on file for this site.",value:b.Squarespace.WebsiteRole.BILLING},
{icon:"reporting",title:"Reporting",description:"Gives users access to your website's statistics.",value:b.Squarespace.WebsiteRole.REPORTING},{icon:"comment",title:"Comment Moderator",description:"Can edit comments and comment on your site.",value:b.Squarespace.WebsiteRole.MODERATOR},{icon:"trusted",title:"Trusted Commenter",description:"Can bypass comment moderation.",value:b.Squarespace.WebsiteRole.COMMENTER},{icon:"commerce-manager",title:"Store Manager",description:"Can receive store notifications, manage customer orders and edit content on website.",
value:b.Squarespace.WebsiteRole.STORE_MANAGER}]}}})},"1.0",{requires:["base","squarespace-dialog-multi-option-array","squarespace-enum"]});
YUI.add("squarespace-block-flickr-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");b.namespace("Squarespace.Block.Editor").Flickr=b.Base.create("flickr-block-editor-dialog",b.Squarespace.Block.Editor.Gallery,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Flickr")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Flickr"}}});b.Squarespace.Block.ModelEditorDialog.Flickr=b.Base.create("FlickrModelEditorDialog",
b.Squarespace.Block.ModelEditorDialog.SummaryGallery,[],{},{ATTRS:{icon:{value:"flickr"},type:{value:b.Squarespace.BlockType.FLICKR},socialAccountType:{value:b.Squarespace.ExternalServiceProviders.FLICKR},collectionType:{value:b.Squarespace.CollectionTypes.FLICKR},strings:{value:{name:"Flickr",itemTypePlural:"Photos",itemType:"Photo"}}}})},"1.0",{requires:"base squarespace-block-summary-gallery-model-editor squarespace-block-flickr-model squarespace-damask-context-globals squarespace-enum squarespace-util".split(" ")});
YUI.add("squarespace-settings-developer",function(b){function d(c,e){return b.Node.create('<div class="label-container labeled-entry '+b.Squarespace.Utils.slugify(c||"(not defined)")+(!e?"no-value":"")+'"></div>').append('<div class="label">'+c+"</div>").append('<div class="value">'+e+"</div>")}b.namespace("Squarespace");var c=b.Base.create("DeveloperTemplateDetails",b.Squarespace.DialogField2,[],{syncUI:function(){var c=this.get("contentBox"),e=this.get("data");!b.Lang.isValue(e)||e.template.ownerWebsiteId!=
Static.SQUARESPACE_CONTEXT.website.id?this.hide():(c.empty(),this._renderConnectivity(),this._renderConfiguration(e.template),c.appendChild('<div class="clear"></div>'),this._renderCollectionConfigurations(e.template),this._renderGitHistory(),c.appendChild('<div class="clear"></div>'),b.Squarespace.Utils.isSquarespaceAdmin()&&this._renderNumberOfWebsitesCreated({totalCount:e.numberOfWebsitesCreated,sample:e.websitesCreated}))},_renderConnectivity:function(){this.get("contentBox").appendChild(this._getRenderedList({},
"Connectivity Details",[{label:"SFTP Hostname",value:"dev.squarespace.com"},{label:"SFTP Port",value:"2030"},{label:"GIT Repository",value:"https://"+Static.SQUARESPACE_CONTEXT.website.identifier+"."+Static.SQUARESPACE_CONTEXT.appDomain+"/template.git"},{label:"Username",value:Static.SQUARESPACE_CONTEXT.authenticatedAccount.email},{label:"Password",value:"***********"}])).addClass("section-connectivity")},_renderConfiguration:function(c){this.get("contentBox").appendChild(this._getRenderedList(c,
"Template Configuration",[{label:"Template Name",key:"name"},{label:"Author",key:"author"},{label:"Last Updated On",value:b.Squarespace.DateUtils.dateFormat(new Date(c.updatedOn),{format:"%B %d, %Y %X"})},{label:"System Collections",value:b.Lang.isValue(c.systemCollections)?c.systemCollections.join(", "):"(none)"}])).addClass("section-configuration")},_renderCollectionConfigurations:function(c){var e=this.get("contentBox").appendChild(this._getRenderedList({},"Collections",[]));e.addClass("section-collection-configurations");
b.Object.each(c.collectionConfigs,function(b,c){e.append(this._getRenderedList(b,b.title||"(not defined)",[{label:"Filename",value:c+".conf"},{label:"PageSize",value:b.pageSize||"(not defined)"},{label:"Add Text",value:b.addText||"(not defined)"},{label:"Accept Types",value:b.acceptTypes||"(not defined)"},{label:"Ordering",value:b.ordering||"(not defined)"},{label:"Icon",value:b.icon||"(not defined)"},{label:"View",value:b.view||"(not defined)"},{label:"Promoted Blocks",value:b.promotedBlocks||"(not defined)"}]))},
this)},_renderGitHistory:function(){var c=this.get("contentBox").appendChild(this._getRenderedList({},"GIT History",[]));c.addClass("section-git-history");b.Data.get({url:"/api/git/GetCommits",success:function(e){b.Array.each(e.slice(0,25),function(e){c.appendChild('<div class="git-commit"></div>').append('<div class="message">'+e.message.replace(/\n\r?/g,"<br />")+"</div>").appendChild('<div class="meta"></div>').append('<span class="author">'+e.author.email+"</div>").append('<span class="date">'+
b.Squarespace.DateUtils.humanizeDate(e.date,!0)+"</div>")})}})},_renderNumberOfWebsitesCreated:function(c){var e=this.get("contentBox").appendChild(this._getRenderedList({},"Websites Created ("+c.totalCount+")"));e.addClass("section-websites-created");b.Array.each(c.sample,function(b){e.one(".label-group").append(d(b.siteTitle,'<a href="'+b.baseUrl+'" target="_blank">'+b.baseUrl+"</a>"))})},_getRenderedList:function(c,e,f){var l=b.Node.create('<div class="developer-section"></div>'),p=l.appendChild('<div class="section-header"></div>'),
q=l.appendChild('<div class="details"></div>');p.appendChild('<div class="section-title">'+e+"</div>");var r=q.appendChild('<div class="label-group clearfix"></div>');b.Array.each(f,function(e){r.append(d(e.label,b.Lang.isValue(e.value)?e.value:c[e.key]))});return l}},{CSS_PREFIX:"sqs-developer-template-details",ATTRS:{websitesCreated:{}}}),e=b.Base.create("DeveloperErrorsWidget",b.Squarespace.DialogField2,[],{bindUI:function(){e.superclass.bindUI.call(this);this.get("contentBox").delegate("click",
this._clearTemplateErrors,"a.clear-all-errors",this);this.after("dataChange",this.syncUI,this)},_clearTemplateErrors:function(){b.Data.post({url:"/api/template/ClearTemplateErrors",data:{templateId:this.get("templateId")},success:function(){this.get("boundingBox").anim({height:0,opacity:0},{end:function(){this.hide()}},this).run()}},this)},syncUI:function(){e.superclass.syncUI.call(this);var c=this.get("data");!b.Lang.isArray(c)||0===c.length?this.hide():(this._renderErrors(c),this.show())},_renderErrors:function(c){var e=
this.get("contentBox");e.empty();var f=e.appendChild('<div class="section-header"></div>'),l=e.appendChild('<div class="developer-errors"></div>');f.appendChild('<div class="section-title">Template Files Errors</div>');f.appendChild('<div class="section-action"><a class="clear-all-errors">Clear All</a></div>');b.Array.each(c,function(c){var e=c.message;c.type==b.Squarespace.TemplateErrorType.JSON_DESERIALIZE&&(e="Could not parse the file contents properly due to invalid JSON.");l.appendChild('<div class="label-group clearfix"></div>').append(d("Filename",
c.filename)).append(d("Date",(new Date(c.addedOn)).toRelativeTime())).append('<div class="message"><xmp>'+e+"</xmp></div>")})}},{CSS_PREFIX:"sqs-developer-errors"}),f=b.namespace("Squarespace.Widgets").DeveloperSettings=b.Base.create("developerSettings",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){this.toggleButton=new b.Squarespace.Widgets.ToggleButton({active:b.Squarespace.Singletons.Template.isTemplateOwner(),plugins:[b.Squarespace.ToggleDrag]});this._syncDeveloperStatus()},hasUnsavedChanges:function(){return!1},
renderUI:function(){f.superclass.renderUI.call(this);this.toggleButton.render();this.get("boundingBox").one(".buttons").insert(this.toggleButton.get("boundingBox"),"after")},bindUI:function(){f.superclass.bindUI.call(this);this._registerEvent(b.Squarespace.Singletons.AuthenticatedMemberAccount.after("developerAccountChange",this._syncDeveloperStatus,this));this.toggleButton.on("activeChange",this._handleDevToggleChange,this)},syncUI:function(){f.superclass.syncUI.call(this);this._developerModeAvailable()&&
!this._isPreviewingTemplate()?(this.toggleButton.show(),this.toggleButton.set("data",this.get("data.template.ownerWebsiteId")==Static.SQUARESPACE_CONTEXT.website.id)):this.toggleButton.hide()},showBigSpinner:function(){this._overlay||(this._overlay=new b.Squarespace.Lightbox({content:'<div class="squarespace-signup-spinner">&nbsp;</div>',zIndex:200100,transition:"scale",name:"billing-loading-indicator",margin:0,clickAnywhereToExit:!1}));this._overlay.show()},hideBigSpinner:function(){this._overlay.hide()},
_handleDevToggleChange:function(c){c.silent||b.later(300,this,function(){if(c.newVal){var e=new b.Squarespace.Widgets.Confirmation({extreme:!0,"strings.confirm":"Yes, I understand","strings.title":"Switch to Developer Template","strings.message":"Switching to Developer Mode will replace your current template with an editable developer template. In order to edit your developer template, you will need to use Git or SFTP to connect and edit your HTML. <strong>In addition, your template will no longer receive updates and bug fixes added by our team.</strong> Do you wish to continue?"});
e.on("confirm",function(){this.showBigSpinner();b.Data.post({url:"/api/template/SetDeveloperTemplate",success:b.bind(function(b){window.location.reload()},this)})},this);e.on("cancel",function(){this.toggleButton.set("active",!1,{silent:!0});b.Squarespace.Analytics.trackInternal("engagement_dev_enable_attempt")},this)}else e=new b.Squarespace.Widgets.Confirmation({extreme:!0,"strings.confirm":"Revert","strings.title":"Delete Template / Revert Site","strings.message":"Reverting back to your template willl <strong>delete</strong> your current development template and restore you to the default template you selected when you signed up for Squarespace.  <strong>This will drastically alter the appearance of your site.</strong>"}),
e.on("confirm",function(){this.showBigSpinner();b.Data.post({url:"/api/template/ClearDeveloperTemplate",success:function(b){window.location.reload()},failure:function(c){this.toggleButton.set("active",!0,{silent:!0});(new b.Squarespace.SystemError("Something Went Wrong",c,"json")).show()}},this)},this),e.on("cancel",function(){this.toggleButton.set("active",!0,{silent:!0})},this)})},_isPreviewingTemplate:function(){return b.Lang.isValue(b.Squarespace.Singletons.AuthenticatedMemberWebsiteSettings.get("previewInstallationId"))},
_developerModeAvailable:function(){var c=b.Squarespace.Singletons.AuthenticatedMemberAccount;return b.Squarespace.Singletons.Template.isTemplateOwner()||c.get("developerAccount")||b.Squarespace.Utils.isSquarespaceAdmin()},_syncDeveloperStatus:function(){var d="",f="",k=[];this._developerModeAvailable()?this._isPreviewingTemplate()?(d="Developer Mode",f="<p>Please exit preview mode before enabling developer mode.</p>"):(d="Developer Mode (Beta)",f='<p>The Squarespace developer platform enables access to all underlying template code for your site.  The developer platform is appropriate for web designers and developers needing to implement a custom site template. <a target="new" href="http://developers.squarespace.com/">Please visit the Squarespace Developer Center for more information.</a></p><p>Please note that developer access is limited to Unlimited and Business plans only.</p>',
Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.StatusConstants.TRIAL&&(f+='<div class="alert"><div class="header">This account is currently in Sandbox Mode.</div>  Developer accounts that are also trial accounts <strong>do not expire</strong>, but the public can not view your site without entering a CAPTCHA.  Sandbox accounts are for development only.  Squarespace reserves the right to shut down Sandbox Accounts used for other purposes.</div>'),k=[{ctor:e,config:{name:"developer-errors"}},
{ctor:c,config:{name:"developer-template-details"}}]):(d="Developer Mode",f='<p>The Squarespace developer platform enables access to all underlying template code for your site. <a target="new" href="http://developers.squarespace.com/">Please visit the Squarespace Developer Center for more information.</a></p><p>Please note that developer access is limited to Unlimited and Business plans only.</p>');this.set("fields",k);this.set("strings.title",d);this.set("strings.description",f);this.set("buttons",
[])},addItem:function(){var c=new b.Squarespace.EditingDialog({style:"flyout",width:500,closeOthers:!1,savingText:"Installing...",discardChangesConfirmation:!1,overlay:0.5,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Install"}],tabs:[{title:"Install Template",icon:"/universal/images-v6/icons/icon-import-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"url",submitOnEnter:!0,required:!0,"strings.placeholder":"http://"}},{ctor:b.Squarespace.DialogFields.Description,
config:{text:"<strong>Enter a template URL below.</strong>  Squarespace templates can be installed via a direct URL.  Installing a template from a remote URL will allow the template developer to provide you with periodic updates to the template you are installing."}},{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Warning.  Only install templates from trusted sources.</strong> Broken 3rd party templates can cause unrecoverable damage to your site, and will have complete access to your site data.",
padding:[0,10]}}]}]});c.on("send-requested",function(){b.Data.sendForm(c,{url:"/api/config/CheckTemplateUrl",data:{url:c.getField("url").getValue()},success:function(e){this.templateData=e;(new b.Squarespace.Widgets.Confirmation({"strings.title":"Install Template","strings.message":"You are about to install <strong>"+e.name+" v"+e.version+" by "+e.author+"</strong>?  This will overwrite your current template completely."})).on("confirm",function(){b.Data.sendForm(c,{url:"/api/config/InstallTemplateViaUrl",
data:{url:c.getField("url").getValue()},success:function(e){new b.Squarespace.Widgets.Information({"strings.title":"Template Installed","strings.message":this.templateData.name+" has been installed to your website."});c.close()}},this)},this)}},this)});c.setInitialData({url:""});c.show()},_syncRenderedFields:function(){f.superclass._syncRenderedFields.call(this);var b=this.getField("developer-errors");b&&b.setAttrs({data:this.get("data.errors"),templateId:this.get("data.template.id")});(b=this.getField("developer-template-details"))&&
b.setAttrs({data:this.get("data")})}},{CSS_PREFIX:"sqs-developer-settings",ATTRS:{initialDataUrl:{value:"/api/template/GetTemplate"},initialSendData:{valueFn:function(){return{templateId:b.Squarespace.Singletons.Template.get("id")}}},buttons:{value:[]}}})},"1.0",{requires:"node squarespace-util squarespace-date-utils squarespace-dialog-description squarespace-settings-panel squarespace-ss-widget squarespace-enum squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-block-markdown-editor",function(b){b.namespace("Squarespace.Block.Editor").Markdown=b.Base.create("markdown-block-editor-dialog",b.Squarespace.Block.Editor.Code,[b.Squarespace.Block.Mixin.Splitable,b.Squarespace.Block.Mixin.Coalesceable],{initializer:function(){this.placeholder=b.Node.create('<div class="sqs-placeholder">Double-click to edit...</div>');this._bb.appendChild(this.placeholder);this.on("editingChange",this._togglePlaceholder,this);this._togglePlaceholder();"markdown"!==
this._model.get("wysiwyg").mode&&(this._model.get("wysiwyg").mode="markdown")},insertContentIntoModel:function(c){c=c.replace(RegExp(' id="yui[^"]+"',"g"),"");this._model.get("wysiwyg").source=b.Squarespace.Lang.markdownFromHTML(c);this._model.set("html",c);this._togglePlaceholder()},_togglePlaceholder:function(c){var e=!1;b.Squarespace.StringUtils.isBlank(this._model.get("html"))&&(c?c.newVal||(e=!0):this.get("host").get("isNewBlock")||(e=!0));e?this.placeholder.show():this.placeholder.hide()},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Markdown")}},
{NS:"blockEditor",ATTRS:{blockName:{value:"Markdown"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Markdown=b.Base.create("block-markdown-editor",b.Squarespace.Block.ModelEditorDialog.Code,[],{initializer:function(){this.updateWysiwygHeightEvent=b.Do.after(this._updateWysiwygHeight,this.get("dialog"),"moveIntoView",this)},_updateWysiwygHeight:function(){var b=this.get("dialog"),e=b.getField("wysiwyg"),b=b.getBodyHeight()-b.bodyHeight,d=e.config.height;0<b&&(b=30+d-b,e.containerHeight=b,e.editor.set("height",
b+"px"))},destructor:function(){this.updateWysiwygHeightEvent.detach()}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:575,height:618,forcePosition:"fixed",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Markdown",icon:"/universal/images-v6/icons/icon-code-16-light.png",fields:[{type:"wysiwyg",height:550,width:525,countHeight:!0,name:"wysiwyg",titleStyle:"inline",engine:"markdown",menuConfig:"markdown",
preGenerateHTML:function(b){return b.replace(RegExp("<[^\\s/>]+","gm"),'$& data-preserve-html-node="true"')}}]}]}},"1.0",{requires:"base squarespace-block-code-editor squarespace-block-mixin-splitable squarespace-block-mixin-coalesceable squarespace-damask-context-globals squarespace-debounce squarespace-markdown-from-html squarespace-string-utils".split(" ")});
YUI.add("squarespace-block-flickr-model",function(b){b.namespace("Squarespace.ContentModel").FlickerBlock=b.Base.create("FlickerModel",b.Model,[],{},{})},"1.0",{requires:["base","model","squarespace-enum","squarespace-block-summary-gallery-model"]});
YUI.add("squarespace-drag-selection",function(b){b.namespace("Squarespace").DragSelection=b.Base.create("dragSelection",b.Base,[b.Squarespace.DragSelectionSelectorBlackList],{initializer:function(d){d=this.get("id");this._selectionNode=b.Node.create("<div></div>");this._selectionNode.addClass("squarespace-selection").setAttribute("data-selection-id",d);this._dragClassName="drag-selection-dragging";this.publish("selection-started",{preventable:!0,defaultFn:this._initSelection,context:this,broadcast:2});
this.on(d+"|nodeChange",this._bindUI,this);this._bindUI()},destructor:function(){this._hideAnimation&&this._hideAnimation.stop();this._selectionNode.remove(!0);this._selectionNode=null;b.detachAll(this.get("id")+"|*");this._activationSub&&(this._activationSub.detach(),this._activationSub=null)},_bindUI:function(){this._activationSub&&this._activationSub.detach();this._activationSub=this.get("node").on("mousedown",this._onMouseDown,this)},_onMouseDown:function(b){this.get("enabled")&&this.fire("selection-started",
{originalMousedown:b})},_initSelection:function(d){d=d.originalMousedown;this.get("dragging")||1!==d.button||(this._origin={x:d.pageX,y:d.pageY},this._pointInActivationRegion(this._origin.x,this._origin.y)&&this._mouseDownInValidRegion(d)&&(this._hideAnimation&&this._hideAnimation.stop(!0),this._selectionNode.setStyles({top:this._origin.y+1,left:this._origin.x+1,right:b.one("body").get("offsetWidth")-this._origin.x,bottom:b.one(b.config.win).get(".innerHeight")-this._origin.y}),b.one("body").addClass(this._dragClassName).appendChild(this._selectionNode),
b.one(b.config.win).once(this.get("id")+"|mouseup",this._endSelection,this),this._mouseMoveSubscription=b.one(b.config.win).on(this.get("id")+"|mousemove",this._dragSelection,this)))},_dragSelection:function(d){if(this.get("enabled")&&this._origin){d.halt();var c=this.get("boundingRegion"),e=this._origin,f=d.pageX,g=d.pageY,h=f>e.x?e.x:f,f=f>e.x?f:e.x,k=g>e.y?e.y:g,e=g>e.y?g:e.y;c&&(c.top&&(k=k<c.top?c.top:k),c.bottom&&(e=e>c.bottom?c.bottom:e),c.left&&(h=h<c.left?c.left:h),c.right&&(f=f>c.right?
c.right:f));this._selectionNode.setStyles({top:k+1,left:h+1,right:b.config.doc.body.offsetWidth-f,bottom:b.config.win.innerHeight-e});this.fire("selection-dragged",{region:this._selectionNode.get("region"),originalMousemove:d})}},_endSelection:function(d){d&&d.halt();this._mouseMoveSubscription&&(this._mouseMoveSubscription.detach(),delete this._mouseMoveSubscription);this._origin&&delete this._origin;b.one("body").removeClass(this._dragClassName);this.fire("selection-complete",{region:this._selectionNode.get("region"),
originalMouseup:d});this._selectionNode.ancestor("body")&&(this._hideAnimation=new b.Anim({node:this._selectionNode,to:{opacity:0},duration:0.3,easing:b.Easing.easeOutStrong}),this._hideAnimation.once(this.get("id")+"|end",function(){this._selectionNode.remove();this._selectionNode.setStyle("opacity",1);delete this._hideAnimation},this),this._hideAnimation.run())},_mouseDownInValidRegion:function(b){for(var c=this.get("invalidRegions"),e=0;e<c.length;e++){var f=c[e];if(f)if("string"===typeof f){if(b.target.ancestor(f,
!0))return!1}else if(f=this._getRegion(f),this._pointInRegion(this._origin.x,this._origin.y,f))return!1}return!0},_pointInActivationRegion:function(b,c){var e=this.get("activationRegion");return!e?!0:this._pointInRegion(b,c,e)},_pointInRegion:function(b,c,e){return e.top&&e.right&&e.bottom&&e.left?b>=e.left&&b<=e.right&&c>=e.top&&c<=e.bottom:e.left&&b<e.left||e.right&&b>e.right||e.top&&c<e.top||e.bottom&&c>e.bottom?!1:!0},_getRegion:function(d){return b.instanceOf(d,b.Node)?d.get("region"):d},_getNode:function(d){if(!d)throw this.name+
": The node attr is required.";if(!b.Lang.isString(d)&&!b.instanceOf(d,b.Node))throw this.name+": The node attr must be a Y.Node instance or selector string.";b.Lang.isString(d)&&(d=b.one(d));return d},_getDragging:function(){var d=b.one("body");return d?d.hasClass(this._dragClassName):!1},_setEnabled:function(d){this._activationSub&&this._activationSub.detach();d?this._bindUI():this.get("dragging")&&this._endSelection();b.one("body").addClass(d?"drag-selection-enabled":"drag-selection-disabled").removeClass(!d?
"drag-selection-enabled":"drag-selection-disabled");return d},enable:function(){this.set("enabled",!0)},disable:function(){this.set("enabled",!1)}},{ATTRS:{node:{value:null,getter:"_getNode",validator:function(d){if(!b.Lang.isString&&!(d instanceof b.Node))throw this.name+": node attr must be a node or selector string.";return!0}},boundingRegion:{value:null,getter:"_getRegion"},activationRegion:{value:null,getter:"_getRegion"},enabled:{value:!0,setter:"_setEnabled"},dragging:{value:!1,valueFn:"_getDragging",
getter:"_getDragging",readOnly:!0},invalidRegions:{value:[]}}})},"1.0",{requires:["base-build","node","anim","squarespace-drag-selection-selector-blacklist"]});
YUI.add("squarespace-layout-insert-block-menu-mixin",function(b){b.namespace("Squarespace.Layout").InsertBlockMenuMixin=b.Base.create("layout-insert-block-menu-mixin",b.Base,[],{initializer:function(){this._icons=[];this._bb=this.get("boundingBox");this._cb=this.get("contentBox");this._ec=this.get("editController");this._initDragDelegate(this._getDragDelegateConfig());this._initClickDelegate();this.on("focusedChange",this._onFocusedChange,this)},renderUI:function(){this._renderMenuIcons(this._getInsertableBlockItems())},
_getInsertableBlockItems:function(){return[]},_renderMenuIcons:function(b){console.warn("Unimplemented method _renderMenuIcons.")},_getDragDelegateConfig:function(){return null},_initDragDelegate:function(d){this.dragDelegate=new b.Squarespace.Layout.DragDelegate(b.merge({container:this._bb,nodes:this.get("nodes"),dragConfig:{groups:["blocks"],clickTimeThresh:200},useDragScroll:!0,scrollNode:this.get("scrollNode"),useDragProxy:!0,dragProxyConfig:{cloneNode:!0,hideOriginalNode:!1,moveOnEnd:!1,flyBack:!1,
containerNode:this._bb},extraSyncShims:!0,editController:this.get("editController")},d));this.dragDelegate.before("drag:start",this._ec.layoutBeforeDragStart,this._ec);this.dragDelegate.on("drag:start",this._dragStart,this);this.dragDelegate.on("drag:end",this._dragEnd,this);this.after("scrollNodeChange",function(b){this.dragDelegate.set("scrollNode",b.newVal)},this)},_initClickDelegate:function(){this.clickDelegate=b.delegate(b.UA.mobile?"tap":"click",this._onClick,this._bb,this.get("nodes"),this)},
_detachClickDelegate:function(){this.clickDelegate&&this.clickDelegate.detach()},destructor:function(){this.dragDelegate.destroy();this._detachClickDelegate()},_dragStart:function(b){this._detachClickDelegate();this._ec.set("selection",null);this._ec.set("dropInfo",null);this._ec.layoutDragStart(this.get("layoutNode"));this.hideMenu()},_dragEnd:function(d){this.blur();this.hide();this.createBlock(b.DD.DDM.activeDrag.get("node"));this._ec.layoutDragEnd();this._initClickDelegate()},_onClick:function(b){b.preventDefault();
this.hideMenu();this._ec.set("dropInfo",this._getDefaultDropInfo());this.createBlock(b.target)},_getDefaultDropInfo:function(){return null},createBlock:function(b){if(this._ec.get("dropInfo")&&(this.newBlock=this._instantiateNewBlock(b)))this.newBlock._trackEngagementCreate(),this._ec.set("selection",this.newBlock.get("boundingBox")),this._ec.insertBlockToLayout(),this._afterNewBlockInsert()},_instantiateNewBlock:function(d){if(d.hasClass("sqs-destroyme"))return d.removeClass("sqs-destroyme"),!1;
var c=this._ec.get("dropInfo").node,e;c&&(e=c.ancestor(".sqs-layout"));return new (b.Widget.getByNode(d).get("ctor"))({editable:!1,render:e||!0,visible:!1,isNewBlock:!0,editMode:this.get("editMode"),editController:this.get("editController")})},_afterNewBlockInsert:function(){this.newBlock.get("boundingBox").scrollIntoView();this.newBlock.set("editable",!0)},hideMenu:noop,_onFocusedChange:noop},{ATTRS:{nodes:{value:".sqs-blockicon"},scrollNode:{},layoutNode:{getter:function(){return b.one(".sqs-layout")}}}})},
"1.0",{requires:["base","squarespace-block-icon","squarespace-layout-drag"]});
YUI.add("squarespace-dialog-multi-option-array",function(b){b.namespace("Squarespace.DialogFields").MultiOptionArray=b.Base.create("multiOption",b.Squarespace.DialogFields.MultiOption,[],{initializer:function(b){this._selectedOptionList=[]},_optionMatchesData:function(d){return this.get("numeric")?-1!==this.get("data").indexOf(b.Number.parse(d.getAttribute("data-value"))):-1!==this.get("data").indexOf(d.getAttribute("data-value"))},_markSelected:function(b){var c=this._selectedOptionList.indexOf(b);
b.hasClass("selected")&&-1!==c?(b.removeClass("selected"),this._selectedOptionList.splice(c,1)):(b.addClass("selected"),this._selectedOptionList.push(b))},_selectOption:function(d){this._markSelected(d);var c=[],e=this.get("numeric");this.get("contentBox").all(".option.selected").each(function(d){d=d.getAttribute("data-value");e?(d=parseInt(d,10),b.Lang.isNumber(d)&&c.push(d)):c.push(d)});this.set("data",c)}},{CSS_PREFIX:"sqs-multi-option",ATTRS:{data:{value:[],validator:b.Lang.isArray,setter:function(d){return b.Array.map(d,
function(c){return this.get("numeric")?b.Number.parse(c):c},this)}}}})},"1.0",{requires:["base","datatype-number-parse","squarespace-dialog-multi-option"]});
YUI.add("squarespace-image",function(b){var d=b.Squarespace.Image=b.Base.create("image",b.Base,[],{initializer:function(b){this._initImg();this.get("loadOnSrcChange")&&this.load();b=this.get("id");this.after(b+"|srcChange",function(b){this._initImg();this.get(loadOnSrcChange)&&this.load()},this)},destructor:function(){this._img=null;b.detach(this.get("id")+"|*")},load:function(){if(this.get("src"))this._img.src=this.get("src");else throw this.name+": This image has no URL specified.";},_initImg:function(){this._setAttrs({loadComplete:d.ATTRS.loadComplete.value,
loadFailed:d.ATTRS.loadFailed.value});var c=this._img=new Image;c.onload=b.bind(function(b){this._set("loadComplete",!0)},this);c.onerror=b.bind(function(b){this._set("loadFailed",!0);this._set("loadComplete",!0)},this)},_getWidth:function(){return this._getDim("width")},_getHeight:function(){return this._getDim("height")},_getDim:function(b){var e=null;this._img&&(this.get("loadComplete")&&!this.get("loadFailed"))&&(e=this._img[b]);return e}},{ATTRS:{src:{value:null},width:{value:null,readOnly:!0,
getter:"_getWidth"},height:{value:null,readOnly:!0,getter:"_getHeight"},loadOnSrcChange:{value:!1},loadFailed:{value:!1,readOnly:!0},loadComplete:{value:!1,readOnly:!0}}})},"1.0",{requires:["base","base-build"]});
YUI.add("squarespace-wistia-player-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["wistia-player.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var l=this.escapeExpression;if((c=d["if"].call(c,c.video,{hash:{},inverse:this.program(3,function(b,c){return'\n  <div class="empty">No video provided.</div>\n'},k),fn:this.program(1,function(b,c){var e,d,f;e=""+('\n  <header class="title">'+l((d=(d=
b.video,null==d||!1===d?d:d.title),"function"===typeof d?d.apply(b):d))+'</header>\n  <section class="video">\n    <div class="play-overlay"></div>\n    <div class="controls">\n      <div class="play-button-bg"></div>\n      <div class="play-triangle"></div>\n      <div class="seeker"></div>\n      <div class="volume"></div>\n      <div class="fullscreen">\n        <div class="fullscreen-inner"></div>\n      </div>\n      <div class="trackbar-bg"></div>\n    </div>\n    <div class="embed">');if((f=
(d=(d=b.video,null==d||!1===d?d:d.embedHTML),"function"===typeof d?d.apply(b):d))||0===f)e+=f;return e+='</div>\n  </section>\n  <footer class="description">'+l((d=(d=b.video,null==d||!1===d?d:d.description),"function"===typeof d?d.apply(b):d))+"</footer>\n"},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("wistia-player.html".replace("/","."),d.templates["wistia-player.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-settings-site-social-accounts",function(b){var d=b.namespace("Squarespace.Settings.Site").SocialAccounts=b.Base.create("socialAccountSettings",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){this.set("strings.title","Connected Accounts");this.set("strings.description",'Connecting to social services will enable you to push or pull data, and allow users to connect with you via those services. <a target="new" href="'+b.Squarespace.HelpLinks.CONNECTED_ACCOUNTS+'">Read more</a>.');
this._settings=new b.Squarespace.Models.WebsiteSettings(Static.SQUARESPACE_CONTEXT.websiteSettings);this._connectedAccountList=new b.Squarespace.Widgets.ConnectedAccountsList({displayOrder:this._settings.get("socialAccountDisplayOrder")});this._socialAuthenticator=new b.Squarespace.SocialAuthenticator;this._socialAuthenticator.after("account-added",function(){this.getConnectedAccounts().load();b.Squarespace.Utils.isDamaskEnabled()&&this.get("damask").get("previewFrame").requestRefresh()},this)},getConnectedAccounts:function(){return b.Squarespace.Singletons.ConnectedAccounts},
destructor:function(){this._socialAuthenticator.destroy();this._connectedAccountList.destroy()},renderUI:function(){d.superclass.renderUI.call(this);this._connectedAccountList.set("models",this.getConnectedAccounts());this._connectedAccountList.render(this.get("contentBox"))},bindUI:function(){d.superclass.bindUI.call(this);this._connectedAccountList.on("*:reauthenticate",function(b){this._reauthenticate(b.target.get("model"))},this);this._connectedAccountList.after("displayOrderChange",this._saveListOrder,
this);b.Squarespace.Utils.isDamaskEnabled()&&this._registerEvent(this.getConnectedAccounts().after("remove",function(){this.get("damask").get("previewFrame").requestRefresh()},this))},_reauthenticate:function(c){this._socialAuthenticator.once("oauth-completed",function(){c.set("accountState",b.Squarespace.AccountStates.ACTIVE)},this);this._socialAuthenticator.reauthenticate(c.get("serviceName"),c.get("id"))},addItem:function(){this._socialAuthenticator.addAccount()},_saveListOrder:function(){this._settings.set("socialAccountDisplayOrder",
this._connectedAccountList.get("displayOrder"));this._connectedAccountList.set("orderLocked",!0);this._settings.save(b.bind(function(c,e){this._connectedAccountList.set("orderLocked",!1);b.Squarespace.Utils.isDamaskEnabled()&&this.get("damask").get("previewFrame").requestRefresh()},this))}},{CSS_PREFIX:"sqs-social-account-settings",ATTRS:{buttons:{value:[{type:"add",label:"Add"}]},damask:{}}})},"1.0",{requires:["base","squarespace-models-website-settings","squarespace-social-authenticator","squarespace-settings-panel",
"squarespace-connected-accounts-list"]});
YUI.add("squarespace-dialog-text-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-text.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var l,p=this.escapeExpression;if((h=d["if"].call(c,(l=c.strings,null==l||!1===l?l:l.title),{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,d;return e=""+('\n  <div class="title">'+p((d=(d=b.strings,null==d||!1===d?d:d.title),"function"===
typeof d?d.apply(b):d))+"</div>\n")},k),data:k}))||0===h)b+=h;b+='\n\n<input type="text" ';if((h=d["if"].call(c,c.maxLength,{hash:{},inverse:this.noop,fn:this.program(3,function(b,c){var e,f;e='maxlength="';(f=d.maxLength)?f=f.call(b,{hash:{},data:c}):(f=b.maxLength,f="function"===typeof f?f.apply(b):f);return e+=p(f)+'"'},k),data:k}))||0===h)b+=h;b+="\n       ";if((h=d["if"].call(c,c.readOnly,{hash:{},inverse:this.noop,fn:this.program(5,function(b,c){return'readonly="readonly"'},k),data:k}))||0===
h)b+=h;b+="\n       ";if((h=d["if"].call(c,c.selectAllOnFocus,{hash:{},inverse:this.noop,fn:this.program(7,function(b,c){return'onClick="this.select()"'},k),data:k}))||0===h)b+=h;b+="/>\n\n";if((h=d["if"].call(c,(l=c.strings,null==l||!1===l?l:l.description),{hash:{},inverse:this.noop,fn:this.program(9,function(b,c){var e,d,f;e='\n\n\t<div class="description">\n    ';if((f=(d=(d=b.strings,null==d||!1===d?d:d.description),"function"===typeof d?d.apply(b):d))||0===f)e+=f;return e+"\n  </div>\n\n"},k),
data:k}))||0===h)b+=h;return b+"\n"})})();b.Handlebars.registerPartial("dialog-text.html".replace("/","."),d.templates["dialog-text.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-commerce-coupon-summary",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.CommerceCouponSummary=b.Base.create("CommerceCouponSummary",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.API_ROOT+"commerce/coupons/summary",parse:function(b){b=d.superclass.parse.call(this,b);var e=b.coupons;this._set("categories",b.categories);this.get("coupons").reset(e);delete b.categories;delete b.coupons;return b}},{ATTRS:{categories:{value:[],validator:b.Squarespace.AttrValidators.isArray,
readOnly:!0},coupons:{valueFn:function(){return new b.Squarespace.Models.CommerceCouponList},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.CommerceCouponList)}}})},"1.0",{requires:["base","model","squarespace-attr-validators","squarespace-model-sync-rest","squarespace-models-commerce-coupon-list"]});
YUI.add("squarespace-content-manager-widgets-blog",function(b){b.namespace("Squarespace.ContentManagerWidgets");var d=b.Squarespace.ContentManagerWidgets.Blog=b.Base.create("ContentManagerBlog",b.Squarespace.ContentManagerWidgets.Base,[b.Squarespace.Mixins.AddContentItemHandlerMixin],{initializer:function(){this._addListWidget();this.get("searchFilterEnabled")&&this._initSearchFilter();this._paginationWidget=this.headerTray.add({childType:this.getProperty("PAGINATION_WIDGET"),pageSize:this.get("pageSize"),
filter:this.get("filter"),totalPages:0,currentPage:0}).item(0);this._emptyPlaceholderWidget=this.add({childType:b.Squarespace.ContentManagerWidgets.PlaceHolderWidget,icon:"add",strings:{title:this.get("strings.emptyTitle"),description:this.get("strings.emptyDescription")},visible:!1,onClickHandler:b.bind(this.handleAddContentRequest,this)}).item(0);this.loadPage()},destructor:function(){b.one("body").removeClass("sqs-content-manager-blog-active");this.get("collection").items.detach(this.get("id")+
"|*");this._listWidget.destroy();b.Lang.isValue(this._scroller)&&this._scroller.unplug(b.Plugin.ScrollInfo)},renderUI:function(){d.superclass.renderUI.call(this);b.one("body").addClass("sqs-content-manager-blog-active");var c=this.get("contentBox");this.get("searchFilterEnabled")&&this._searchFilter.render(c);b.Squarespace.Utils.isDamaskEnabled()&&this._listWidget.set("actionTrayRelativePositionFixedNode",this.get("boundingBox"));this._listWidget.render(c);b.Lang.isUndefined(this.get("collection").get("itemCount"))&&
this.get("collection").load(b.bind(this.syncUI,this))},bindUI:function(){d.superclass.bindUI.call(this);var c=b.one(b.config.doc.body),e=this.get("collection").items;this._registerEvent(e.after(["add","create","remove","bulk-remove","move-items"],this._refreshPagingAfterEditing,this));this._registerEvent(e.after("load",this._updatePagingAfterItemLoad,this));this._registerEvent(c.on("keydown",this._changeCurrentPage,this));this.after("activeFilterChange",this.runActiveFilters,this);this.after("paginationChange",
this._updatePagingWidgets,this);this.after("*:editingComplete",function(b){this._listWidget.syncUI()},this);this._paginationWidget.on("pageRequested",this._loadPageAndScrollTop,this);this._paginationWidget.on("filterChange",function(b){this.set("filter",b.newVal);this.refreshPage()},this);this.after("*:contentLoaded",this.runActiveFilters,this);this.get("searchFilterEnabled")&&this._bindSearchFilterUI();this.hasNewList()&&this._bindScrollEvents()},syncUI:function(){d.superclass.syncUI.call(this);
var c=this.get("contentBox");this.get("pagination");var e=0!==this.get("collection").get("itemCount");this._emptyPlaceholderWidget.set("visible",!e);this._listWidget.set("visible",e);"all"!==this.get("filter")&&this._paginationWidget.toggleNav(e);b.Lang.isValue(this._noItemsFoundPlaceholder)&&(e=0!==c.all(".sqs-blog-item:not(.sqs-blog-item-hidden)").size(),c=0!==c.all(".sqs-blog-item-hidden").size(),this._noItemsFoundPlaceholder.set("visible",c&&!e))},getSelectedContentItem:function(){var b=this._listWidget.getSelectedWidget();
return b?b.get("item"):null},_addListWidget:function(){this.hasNewListAndBlog()?this._listWidget=new b.Squarespace.Widgets.Blog.ListManager({collection:this.get("collection"),items:this.get("collection").items}):this._listWidget=new (this.getProperty("LIST_WIDGET"))({collection:this.get("collection"),items:this.get("collection").items});this._listWidget.addTarget(this)},_bindScrollEvents:function(){var c=this.get("collection").items;this._registerEvent(c.after(["*:save","create","remove","bulk-remove",
"move-items"],this._routeCrudToLists,this));this._scroller=b.one(this._getClosestScrollingAncestor());this._scroller.plug(b.Plugin.ScrollInfo);this._scroller.scrollInfo.on("scrollDown",b.Squarespace.debounce(function(c){65>Math.ceil(100*c.scrollBottom/c.scrollHeight)||(b.instanceOf(this._listWidget,b.Squarespace.Widgets.Blog.ListManager)?this._listWidget.tryToLoadMore():this.addPage("next"))},50),this)},_routeCrudToLists:function(c){var e=c.source,d=["Item:save","bulk-remove","upload","reorder",this.name];
c=this._getModelFromEvent(c);e=!(b.Lang.isValue(e)&&-1!==b.Array.indexOf(d,e)||!this.hasNewListAndBlog());d=b.Lang.isValue(c);e&&d&&this._listWidget.routeItem(c);this.get("searchFilterEnabled")&&this.runActiveFilters()},_getModelFromEvent:function(b){return"Item:save"===b.type?b.target:b.model},_refreshPagingAfterEditing:function(c){c=c.source;var e=["bulk-remove","upload","reorder",this.name];b.Lang.isValue(c)&&-1!==b.Array.indexOf(e,c)||this.refreshPage()},_updatePagingAfterItemLoad:function(c){c=
this.get("pagination");if(b.Lang.isValue(c)){var e=this.get("allItemsSize");c.totalItems=e?e:c.totalItems;this.set("pagination",b.merge(c,{totalItems:e?e:c.totalItems}))}},_loadPageAndScrollTop:function(c){var e="next"===c.direction;c={limit:this.get("pageSize"),pageAction:e?b.Squarespace.PageAction.NEXT:b.Squarespace.PageAction.PREVIOUS,start:c.start};this.loadPage(c)},_changeCurrentPage:function(c){b.Squarespace.OPEN_DIALOGS.length||(37==c.keyCode?this._paginationWidget.nextPage():39==c.keyCode&&
this._paginationWidget.prevPage())},refreshPage:function(){b.instanceOf(this._listWidget,b.Squarespace.Widgets.Blog.ListManager)?(this._listWidget.refreshPages(),this.get("searchFilterEnabled")&&this.runActiveFilters(),this.syncUI()):this.hasNewList()?this._listWidget.syncUI():this.loadPage()},loadPage:function(c){c=c||{};var e=this.get("collection").items,d=this.get("filter");e.onceAfter(this.get("id")+"|load",this._updatePages,this,e);var g={};"all"!==d&&(d=b.Squarespace.WorkflowStates[d.toUpperCase()],
b.Lang.isValue(d)&&(g.workflowState=d));e.load(b.merge(g,c))},addPage:function(c){var e=new b.Squarespace.Models.ContentItemList({parent:this.get("collection")});c="next"===c;this.get("collection");var d=this.get("nextPageStart");d&&!this._addingPage&&(this._addingPage=!0,c={limit:this.get("pageSize"),pageAction:c?b.Squarespace.PageAction.NEXT:b.Squarespace.PageAction.PREVIOUS,start:d},e.load(c,b.bind(function(b){b=e.get("pagination").nextPageStart||null;this.set("nextPageStart",b);this.get("collection").items.add(e,
{silent:!0});this._listWidget.syncUI();this._addingPage=!1},this)))},_updatePages:function(c,e){var d=e.get("pagination");this._listWidget.set("items",e);this.set("pagination",b.merge(d,{}))},_updatePagingWidgets:function(c){var e;b.Object.hasKey(c,"newVal")&&b.Lang.isValue(c.newVal)&&(e=c.newVal);this._paginationWidget.update(e);this.get("searchFilterEnabled")&&this._updateContentItemFilter();this.set("nextPageStart",e.nextPageStart);this.set("page",e.currentPage);this.syncUI()},_initSearchFilter:function(){this._searchFilter=
this.add({childType:this.getProperty("FILTER_WIDGET"),listSource:this._listWidget,collection:this.get("collection"),threshold:this.get("pageSize"),totalPage:0}).item(0);this._noItemsFoundPlaceholder=this.add({childType:b.Squarespace.ContentManagerWidgets.PlaceHolderWidget,icon:"no-matches",strings:{title:"End of Results",description:"There are no more matching results."},visible:!1,onClickHandler:b.bind(this._searchFilter.focusInput,this._searchFilter)}).item(0);this.headerTray.set("shadowMinScrollTop",
50)},_bindSearchFilterUI:function(){this.get("collection");this._searchFilter.after("filterFnChange",function(b){this.set("activeFilter",b.newVal)},this);this._registerEvent(this.get("collection").after("load",this._updatePagingAfterItemLoad,this))},_updateContentItemFilter:function(){var b=this.get("collection").getAttrs(["itemCount","pageSize"]);this._searchFilter.update(b)},runActiveFilters:function(){var c=this.get("activeFilter");this.get("searchFilterEnabled")&&b.Lang.isFunction(c)&&(this.hasNewListAndBlog()?
(this._listWidget.filterChildWidgets(c),this._searchFilter.syncUI()):this.get("collection").items.each(function(e){var d=this._listWidget.getWidgetForItem(e);b.Lang.isValue(d)&&d.set("visible",c(e))},this),this.syncUI())},_getClosestScrollingAncestor:function(){for(var b=this.get("boundingBox");b&&!b.test("body")&&"auto"!=b.getStyle("overflow");)b=b.get("parentNode");return b},scrollToTop:function(){for(var b=this.get("contentBox");b.get("parentNode");){if(0<b.get("scrollTop")){b.anim({scroll:[0,
0]}).run();break}b=b.get("parentNode")}},hasNewListAndBlog:function(){return this.hasNewList()&&this.getProperty("LIST_WIDGET")===b.Squarespace.Blog.List},hasNewList:function(){return b.Squarespace.Utils.isDamaskEnabled()},hasUnsavedChanges:function(){return!1}},{LIST_WIDGET:b.Squarespace.Blog.List,FILTER_WIDGET:b.Squarespace.Widgets.SearchFilter,PAGINATION_WIDGET:b.Squarespace.Widgets.BlogListPagination,CSS_PREFIX:"sqs-content-manager-blog",ATTRS:{activeFilter:{value:!1},allItemsSize:{getter:function(){return this.get("collection").get("itemCount")}},
filter:{value:"all"},helpSectionIdentifier:{value:"blog"},page:{value:1},pageSize:{value:20},pagination:{value:void 0},multiple:{value:!0},"strings.emptyTitle":{value:"Add Post"},"strings.emptyDescription":{value:"This blog contains no items. Click here to add your first item."},paginationEnabled:{value:b.Squarespace.Utils.isDamaskEnabled()},searchFilterEnabled:{readOnly:!b.Squarespace.Utils.isBetaFeatureEnabled(),valueFn:"hasNewList"}}})},"1.0",{requires:"base node-scroll-info squarespace-blog-list-pagination squarespace-content-item-filter squarespace-content-item-types-base squarespace-content-item-types-selector squarespace-content-manager-blog-item-template squarespace-content-manager-widgets-base squarespace-content-manager-widgets-blog-list squarespace-content-manager-widgets-placeholder squarespace-debounce squarespace-models-content-item-list squarespace-pagination squarespace-ss-widget squarespace-widgets-blog-list-manager".split(" ")});
YUI.add("autocomplete-filters",function(b,d){var c=b.Array,e=b.Object,f=b.Text.WordBreak,g=b.mix(b.namespace("AutoCompleteFilters"),{charMatch:function(b,e,d){if(!b)return e;var f=c.unique((d?b:b.toLowerCase()).split(""));return c.filter(e,function(b){b=b.text;d||(b=b.toLowerCase());return c.every(f,function(c){return-1!==b.indexOf(c)})})},charMatchCase:function(b,c){return g.charMatch(b,c,!0)},phraseMatch:function(b,e,d){if(!b)return e;d||(b=b.toLowerCase());return c.filter(e,function(c){return-1!==
(d?c.text:c.text.toLowerCase()).indexOf(b)})},phraseMatchCase:function(b,c){return g.phraseMatch(b,c,!0)},startsWith:function(b,e,d){if(!b)return e;d||(b=b.toLowerCase());return c.filter(e,function(c){return 0===(d?c.text:c.text.toLowerCase()).indexOf(b)})},startsWithCase:function(b,c){return g.startsWith(b,c,!0)},subWordMatch:function(b,e,d){if(!b)return e;var g=f.getUniqueWords(b,{ignoreCase:!d});return c.filter(e,function(b){var e=d?b.text:b.text.toLowerCase();return c.every(g,function(b){return-1!==
e.indexOf(b)})})},subWordMatchCase:function(b,c){return g.subWordMatch(b,c,!0)},wordMatch:function(b,d,g){if(!b)return d;var p={ignoreCase:!g},q=f.getUniqueWords(b,p);return c.filter(d,function(b){var d=c.hash(f.getUniqueWords(b.text,p));return c.every(q,function(b){return e.owns(d,b)})})},wordMatchCase:function(b,c){return g.wordMatch(b,c,!0)}})},"3.17.2",{requires:["array-extras","text-wordbreak"]});
YUI.add("squarespace-block-amazon-editor",function(b){b.namespace("Squarespace.Block.Editor").Amazon=b.Base.create("amazon-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Amazon")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Amazon"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Amazon=b.Base.create("blockAmazonEditor",b.Squarespace.ModelEditorDialog,[],{},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});
var d={width:420,name:"editAmazonBlock",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],primaryTabs:[{title:"Edit Amazon Item",icon:"/universal/images-v6/icons/icon-amazon-16-light.png",scroll:!1,fields:[{ctor:b.Squarespace.DialogFields.ProductChooser,name:"amazonProduct",mode:"amazon",maxResults:3},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Alignment",name:"alignment",description:"Select alignment for this block.",className:"thin dark",
defaultValue:"left",options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showImage",strings:{title:"Show Image",description:"Show a thumbnail image of this product."}}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showTitle",strings:{title:"Show Title",description:"Show the title of this product."}}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showAuthor",strings:{title:"Show Author",
description:"Show the author of this product."}}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showPrice",strings:{title:"Show Price",description:"Display the current price of this product from Amazon."}}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"showBuyButton",strings:{title:"Add Buy Button",description:"Add a button below this product to buy it on Amazon.com."}}}]}]}},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-product-chooser squarespace-dialog-select".split(" ")});
YUI.add("squarespace-block-form",function(b){var d=b.namespace("Squarespace.Models").BlockFormModel=b.Base.create("BlockFormModel",b.Model,[],{initializer:function(){this._formModel=this._createFormModel()},_saveFormModel:function(c){if(this._saveInProgress)this.onceAfter("save",c);else this._saveInProgress=!0,this._formModel.save(b.bind(function(){this.set("formId",this._formModel.get("id"));this._formModel.saveStorageBackends({googleDocs:this.get("googleDocsConnect"),mailchimp:this.get("mailchimpConnect"),
email:this.get("emailConnect"),siteUser:this.get("siteUserConnect")},function(b){this._saveInProgress=!1;if(b){var d=b.googleDocsConnect,g=b.mailchimpConnect,h=b.emailConnect;b=b.message;var k="Form Storage Connection Failure",l="Unable to connect to form storage backend. Please try again.";d?(k="Google Docs Connection Failure",l=d):g?(k="Mailchimp Connection Failure",l=g):h?(k="Email Connection Failure",l=h):b&&(k="Storage Connection Failure",l=b);c({title:k,message:l,src:"storageBackends"})}else c()},
this)},this))},sync:function(c,e,d){if("read"==c)c=this.get("formId"),b.Lang.isValue(c)?(this._formModel.set("id",c),this._formModel.load(function(){d()})):this._saveFormModel(d);else if("create"==c||"update"==c)b.Array.each(this.constructor.FORM_MODEL_FIELDS,function(b){this._formModel.set(b,this.get(b))},this),this._saveFormModel(d)},validate:function(b,e){this.getAttrs();-1==[this.get("googleDocsConnect.connected"),this.get("mailchimpConnect.connected"),this.get("siteUserConnect.connected"),this.get("emailConnect.connected")].indexOf(!0)?
e({title:"No Storage Backends Connected",message:"You have not connected your form to a storage backend. Please connect at least one storage backend before saving",src:"validate"}):e()},toJSON:function(){return{formId:this.get("formId"),useLightbox:this.get("useLightbox"),lightboxHandleText:this.get("lightboxHandleText"),buttonAlignment:this.get("buttonAlignment"),hSize:this.get("hSize"),vSize:this.get("vSize"),floatDir:this.get("floatDir")}},_createFormModel:function(){return new b.Squarespace.Models.Form({id:null,
name:"New Form",fields:[{type:"name",id:null,locked:!1,title:"Name",description:"",required:!0,name:!0},{type:"email",id:null,locked:!1,title:"Email Address",description:"",placeholder:"",required:!0,email:!0},{type:"text",id:null,locked:!1,title:"Subject",description:"",placeholder:"",required:!0,text:!0},{type:"textarea",id:null,locked:!1,title:"Message",description:"",placeholder:"",required:!0,textarea:!0}],submitButtonText:"Submit",submissionMessage:{html:"Thank you!"}})},getFormModel:function(){return this._formModel}},
{FORM_MODEL_FIELDS:"name fields submitButtonText submissionMessage submissionHTML usePreSubmit preSubmitTopics".split(" "),ATTRS:{emailConnect:{valueFn:function(){if(!b.Lang.isValue(this.get("formId")))return{connected:!0,email:Static.SQUARESPACE_CONTEXT.authenticatedAccount.email}}},siteUserConnect:{valueFn:function(){if(!b.Lang.isValue(this.get("formId")))return{connected:b.Squarespace.Utils.isNewslettersEnabled()}}}}});b.namespace("Squarespace.Block").Form=b.Base.create("block-form",b.Squarespace.Block.ModelSyncBase,
[],{initializer:function(){this._formPreview=new b.Squarespace.Widgets.FormPreview({form:this.get("model").getFormModel()})},renderUI:function(){this.get("model").load(b.bind(this._renderBlock,this))},bindUI:function(){var b=this.get("model");b.after("change",this._renderBlock,this);b.after("save",this.syncUI,this)},syncUI:function(b){b=this.get("model");this._formPreview.set("useLightbox",b.get("useLightbox"));this._formPreview.set("lightboxHandleText",b.get("lightboxHandleText"));this._formPreview.set("buttonAlignment",
b.get("buttonAlignment"));this._formPreview.syncUI()},_renderBlock:function(){var c=this.get("model");this._formPreview.get("rendered")?b.Lang.isUndefined(c.get("fields"))||(c._formModel.set("fields",c.get("fields")),this.syncUI()):this._formPreview.render(this.get("contentBox"));this.fire("widget:contentUpdate")}},{CSS_PREFIX:"sqs-block-form",MODEL:d,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Form},type:{value:b.Squarespace.BlockType.FORM}}})},"1.0",{requires:["model","squarespace-block-form-editor",
"squarespace-form-preview","squarespace-models-form","squarespace-util"]});YUI.add("lang/autocomplete-list",function(b){b.Intl.add("autocomplete-list","",{item_selected:"{item} selected.",items_available:"Suggestions are available. Use the up and down arrow keys to select suggestions."})},"3.17.2");
YUI.add("squarespace-models-site-user",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.SiteUser=b.Base.create("SiteUser",b.Model,[b.Squarespace.ModelSync.REST],{root:"/api/site-users",url:"/api/site-users/{id}"},{ATTRS:{id:{value:null},email:{value:null,validator:b.Squarespace.AttrValidators.isString},createdOn:{value:null},updatedOn:{value:null},firstName:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},lastName:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},
isEmailVerified:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},groups:{value:[],validator:b.Squarespace.AttrValidators.isArray},attributes:{value:[],validator:b.Squarespace.AttrValidators.isArray},subscriber:{value:{},validator:b.Squarespace.AttrValidators.isObject}}})},"1.0",{requires:["base","model","squarespace-attr-validators","squarespace-model-sync-rest"]});
YUI.add("squarespace-block-horizontal-rule-editor",function(b){b.namespace("Squarespace.Block.Editor").HorizontalRule=b.Base.create("horizontal-rule-block-editor-dialog",b.Squarespace.Block.Editor.Base,[],{},{NS:"blockEditor",ATTRS:{blockName:{value:"HorizontalRule"}}})},"1.0",{requires:["base","squarespace-block-editor-base"]});
YUI.add("squarespace-widgets-order-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-order.html"]=b(function(b,c,d,h,k){function l(b,c){return'\n        <div class="shipped-state shipped">Digitally Delivered</div>\n      '}function p(b,c){var e,f;e='\n        <div class="shipped-state shipped">Completed</div>\n        <div class="shippedDate">';(f=d.shippedDate)?f=f.call(b,{hash:{},data:c}):(f=b.shippedDate,f=typeof f===t?f.apply(b):f);return e+=
u(f)+"</div>\n      "}function q(b,c){return'\n        <div class="shipped-state cancelled">Cancelled</div>\n      '}function r(b,c){return'\n        <div class="shipped-state waiting">Pending</div>\n      '}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var s,t="function",u=this.escapeExpression,v=this,w=d.helperMissing;b='<div class="order-selector"></div>\n\n<div class="order-content">\n\n  <div class="order-summary">\n\n    <div class="total">\n      <span class="money-total">\n        ';
(h=d.currencySymbol)?h=h.call(c,{hash:{},data:k}):(h=c.currencySymbol,h=typeof h===t?h.apply(c):h);b+=u(h);s={hash:{},data:k};b+=u((h=d["money-format"]||c["money-format"],h?h.call(c,(h=c.model,null==h||!1===h?h:h.grandTotalCents),s):w.call(c,"money-format",(h=c.model,null==h||!1===h?h:h.grandTotalCents),s)))+"\n        ";if((s=d["if"].call(c,c.showCurrencyCode,{hash:{},inverse:v.noop,fn:v.program(1,function(b,c){var e,d;return e=" "+u((d=(d=b.model,null==d||!1===d?d:d.currencyCode),typeof d===t?d.apply(b):
d))},k),data:k}))||0===s)b+=s;b+='\n      </span>&nbsp;-&nbsp;<span class="item-count">';(s=d.itemCountString)?s=s.call(c,{hash:{},data:k}):(s=c.itemCountString,s=typeof s===t?s.apply(c):s);b+=u(s)+'</span>\n    </div>\n\n    <div class="order-id">Order # '+u((h=(h=c.model,null==h||!1===h?h:h.displayId),typeof h===t?h.apply(c):h))+'</div>\n\n    <div class="placed-by">\n      placed by\n      <span class="customer">'+u((h=(h=(h=c.model,null==h||!1===h?h:h.customer),null==h||!1===h?h:h.name),typeof h===
t?h.apply(c):h))+'</span>\n      (<span class="customer-email">'+u((h=(h=(h=c.model,null==h||!1===h?h:h.customer),null==h||!1===h?h:h.email),typeof h===t?h.apply(c):h))+'</span>)\n      <span class="placed">';(s=d.orderDate)?s=s.call(c,{hash:{},data:k}):(s=c.orderDate,s=typeof s===t?s.apply(c):s);b+=u(s)+'</span>\n    </div>\n\n  </div>\n\n  <div class="order-state">\n\n    ';if((s=d["if"].call(c,c.stateRefunded,{hash:{},inverse:v.program(5,function(b,c){return'\n      <div class="paid-state"></div>\n    '},
k),fn:v.program(3,function(b,c){return'\n      <div class="paid-state refunded">Refunded</div>\n    '},k),data:k}))||0===s)b+=s;b+="\n\n    ";if((s=d["if"].call(c,c.stateShipped,{hash:{},inverse:v.program(12,function(b,c){var e,f;e="\n      ";if((f=d["if"].call(b,b.stateCancelled,{hash:{},inverse:v.program(15,r,c),fn:v.program(13,q,c),data:c}))||0===f)e+=f;return e+"\n    "},k),fn:v.program(7,function(b,c){var e,f,h;e="\n      ";if((h=d["if"].call(b,(f=b.model,null==f||!1===f?f:f.isPurelyDigital),
{hash:{},inverse:v.program(10,p,c),fn:v.program(8,l,c),data:c}))||0===h)e+=h;return e+"\n    "},k),data:k}))||0===s)b+=s;b+="\n\n  </div>\n\n</div>\n\n";if((s=d["if"].call(c,(h=c.model,null==h||!1===h?h:h.testMode),{hash:{},inverse:v.noop,fn:v.program(17,function(b,c){return'\n  <div class="status-text-wrapper"><div class="status-text">TEST</div></div>\n'},k),data:k}))||0===s)b+=s;return b+"\n"})})();b.Handlebars.registerPartial("widgets-order.html".replace("/","."),d.templates["widgets-order.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-amazon",function(b){var d=b.Base.create("AmazonModel",b.Model,[],{},{ATTRS:{alignment:{value:"left"},showImage:{validator:b.Lang.isBoolean,value:!0},showTitle:{validator:b.Lang.isBoolean,value:!0},showAuthor:{validator:b.Lang.isBoolean,value:!0}}});b.namespace("Squarespace.Block").Amazon=b.Base.create("block-amazon",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-amazon",MODEL:d,ATTRS:{type:{value:b.Squarespace.BlockType.AMAZON},editor:{value:b.Squarespace.Block.Editor.Amazon}}})},
"1.0",{requires:["base","model","squarespace-block-base-modelsync","squarespace-block-amazon-editor","squarespace-enum"]});
YUI.add("squarespace-dialog-button",function(b){var d=b.namespace("Squarespace.DialogFields").Button=b.namespace("Squarespace.Widgets").Button=b.Base.create("button",b.Squarespace.DialogField2,[],{initializer:function(b){this.get("contentBox").addClass(this.get("alignment"));this.publish("click")},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",this._handleClick,this);this.on("stringsChange",this._updateStringElements,this);this.after("waitingChange",function(b){this._toggleWaitingSpinner(b.newVal)},
this)},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("boundingBox"),e=this._anchorNode=this.get("contentBox").one("a"),f=this.get("name");e.set("value",this.get("data"));e.set("name",f);c.setAttribute("title",this.get("strings.text"));this._renderButtonText();this._renderSpinner();this._toggleActive(this.get("active")&&b.Lang.isValue(f))},syncUI:function(){d.superclass.syncUI.call(this);this._toggleWaitingSpinner(this.get("waiting"))},setText:function(b){this.set("strings.text",
b)},getText:function(){return this.get("strings.text")},setOnClick:function(c,e){b.Lang.isFunction(c)&&this.set("onClick",c);b.Lang.isValue(e)&&this.set("context",e)},disable:function(){this.toggleDisabled(!0)},enable:function(){this.toggleDisabled(!1)},showWaiting:function(){this._toggleWaitingSpinner(!0);this.set("waiting",!0)},hideWaiting:function(){this._toggleWaitingSpinner(!1);this.set("waiting",!1)},toggleDisabled:function(b){this.set("disabled",b);this.get("contentBox").toggleClass("disabled",
b)},_toggleActive:function(b){this.set("active",b);this.get("contentBox").toggleClass("active",b)},_toggleWaitingSpinner:function(b){b?this._waiting.show():this._waiting.hide()},_handleClick:function(c){var e=this._anchorNode;this.get("disabled")?c.halt():(c=this.get("href"))?this.get("newWindow")?window.open(c):window.location=c:b.Lang.isFunction(this.get("onClick"))?this.get("onClick").call(this.get("context")):e.fire("click",this.get("active"))},_animateTextChange:function(c){var e=new b.Anim({node:this._anchorNode,
from:{opacity:0},to:{opacity:1},duration:0.2,easing:"easeOut"});c=new b.Anim({node:this._anchorNode,from:{opacity:1},to:{opacity:0},duration:0.2,easing:"easeIn"});e.on("end",b.bind(function(){this._toggleActive(!0)},this));c.on("end",b.bind(function(){this._renderButtonText();b.Lang.isNull(this._anchorNode)||e.run()},this));this._toggleActive(!1);this._registerAnim(e);this._registerAnim(c);c.run()},_updateStringElements:function(b){"strings.text"===b.subAttrName&&this._animateTextChange(b.newVal.text)},
_renderIcon:function(){this.get("icon")&&this._button.append('<div class="icon"></div>')},_renderButtonText:function(){var c=this.get("strings.text");b.Lang.isString(c)&&0<c.length&&this._anchorNode.setHTML(c)},_renderSpinner:function(){this._waiting=b.Node.create('<div class="waiting"></div>');this.get("contentBox").append(this._waiting);this._waiting.hide()}},{CSS_PREFIX:"sqs-button",TEMPLATE:"<a></a>",ATTRS:{active:{},alignment:{value:"",validator:b.Lang.isString},className:{value:"normal-button"},
context:{value:this},data:{},disabled:{setter:function(b){return!!b}},icon:{},name:{},onClick:{validator:b.Lang.isFunction},strings:{value:{title:"",text:""}},waiting:{value:!1},href:{validator:b.Lang.isString},newWindow:{value:!1,validator:b.Lang.isBoolean}}})},"1.0",{requires:"base node anim squarespace-dialog-field-2 squarespace-dialog squarespace-util".split(" ")});
YUI.add("squarespace-block-form-editor",function(b){var d=b.namespace("Squarespace.Block.Editor").Form=b.Base.create("form-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_enableEditing:function(b){b&&"contextmenu"===b.type&&b.preventDefault();d.superclass._enableEditing.call(this)},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Form")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Form"}}}),c=b.namespace("Squarespace.Block.ModelEditorDialog").Form=
b.Base.create("blockFormEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this.get("dialog").on("ready",function(){this._bindDialogFields()},this);this.plug(b.Squarespace.ModelEditorPlugins.LoadBeforeShowing)},_bindDialogFields:function(){var b=this.get("dialog"),c=this.get("model");b.getField("fields").after("change",function(b){c.fire("change",{changed:{fields:{prevVal:b.prevVal,newVal:b.newVal}}})},this)},getDialogData:function(){var c=this.get("model"),e=c.getFormModel();return b.merge({useLightbox:c.get("useLightbox"),
lightboxHandleText:c.get("lightboxHandleText"),buttonAlignment:c.get("buttonAlignment"),name:e.get("name"),fields:e.get("fields"),submitButtonText:e.get("submitButtonText"),submissionMessage:e.get("submissionMessage"),submissionHTML:e.get("submissionHTML"),usePreSubmit:e.get("usePreSubmit"),preSubmitTopics:e.get("preSubmitTopics")},this._getConnectFieldInitialData())},_saveResponseHandler:function(e,d,f,l,p){var q=this.get("dialog");e&&("validate"==e.src||"storageBackends"==e.src)?(q.allowEditing(),
new b.Squarespace.Widgets.Alert({"strings.title":e.title,"strings.message":e.message})):c.superclass._saveResponseHandler.call(this,e,d,f,l,p)},_getConnectFieldInitialData:function(){var c={},e=this.get("model"),d=e.getFormModel(),f=d.get("connectedBackends");f&&b.Array.each(f,function(d){var f=d.backendId;if(b.Lang.isValue(f)){var k=d.socialConfig;switch(d.backendType){case b.Squarespace.FormStorageBackendType.EMAIL:c.emailConnect={connected:!0,email:f};break;case b.Squarespace.FormStorageBackendType.SITE_USER:c.siteUserConnect=
{connected:!0};break;case b.Squarespace.FormStorageBackendType.GOOGLE:f=d.config.spreadsheetName;b.Lang.isValue(f)||(f=e.get("googleDocsConnect.spreadsheetName"));c.googleDocsConnect={connected:!0,username:k.profileUserName,socialConfig:k,spreadsheetName:f};break;case b.Squarespace.FormStorageBackendType.MAILCHIMP:d=k.profileUserName;b.Lang.isValue(d)||(d=e.get("mailchimpConnect.username"));c.mailchimpConnect={connected:!0,username:d,socialConfig:k,list:f};break;default:b.Squarespace.Logger.log("Unrecognized Connected Backend Type",
{storageBackend:d})}}},this);!c.emailConnect&&!b.Lang.isValue(d.get("id"))&&(c.emailConnect={connected:!0,email:Static.SQUARESPACE_CONTEXT.authenticatedAccount.email});return c}},{ATTRS:{dialogConfig:{valueFn:function(){return f}},dialogConfigContext:{valueFn:function(){return e}}}}),e={primaryFieldConfigs:[{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"name","strings.label":"Form Name",submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Drag and drop</strong> the fields below to manipulate the structure of your form. <strong>Click</strong> on any field to edit it."}},
{ctor:b.Squarespace.DialogFields.FormBuilder,config:{name:"fields",allowMultipleEmailFields:{$valueFn:function(b){return b.get("mailchimpConnect")?!b.get("mailchimpConnect.connected"):!0}}}}],connectFieldConfigsByName:{email:{ctor:b.Squarespace.DialogFields.EmailServiceConnect,config:{name:"emailConnect"}},googleDocs:{ctor:b.Squarespace.DialogFields.GoogleDocsServiceConnect,config:{name:"googleDocsConnect",getSpreadsheetName:{$valueFn:function(b){return function(){return b.getFormModel().get("name")}}},
oauthOwner:{name:"form",getId:{$valueFn:function(b){return function(){return b.getFormModel().get("id")}}}}}},mailchimp:{ctor:b.Squarespace.DialogFields.MailChimpServiceConnect,config:{name:"mailchimpConnect",oauthOwner:{name:"form",getId:{$valueFn:function(b){return function(){return b.getFormModel().get("id")}}}}}},siteUser:{ctor:b.Squarespace.DialogFields.SiteUserServiceConnect,config:{name:"siteUserConnect"}}},connectFieldConfigs:[{$include:"connectFieldConfigsByName.email"},{$include:"connectFieldConfigsByName.googleDocs"},
{$include:"connectFieldConfigsByName.mailchimp"},{ctor:b.Squarespace.DialogFields.Description,config:{name:"mailchimpAccountCreation",text:'<a href="http://www.mailchimp.com/signup?utm_source=squarespace1&utm_medium=partnerships&utm_campaign=pid&pid=squarespace&source=website" target="_blank">Don\'t have a MailChimp account? Click here to sign up.</a>'}}],submissionFieldConfigs:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"submitButtonText",className:"thin","strings.title":"Submit Button Label",
"strings.placeholder":"Submit"}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"buttonAlignment","strings.title":"Button Alignment",defaultValue:"left",className:"thin dark",options:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"submissionMessageDescription",title:"Post-Submit Message",text:"Display this message to users after they submit your form."}},{ctor:b.Squarespace.DialogFields.Wysiwyg,
config:{name:"submissionMessage",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:175,classNames:"submissionMessage"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"submissionHTMLDescription",title:"Post-Submit HTML",text:"HTML to be rendered in addition to the Post-Submit Message."}},{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"submissionHTML"}}],lightboxFieldConfigs:[{ctor:b.Squarespace.DialogFields.Description,config:{name:"lightboxModeDescription",
title:"Lightbox Mode",text:"Replace this form with a button. Open the form in a lightbox when this button is pressed, rather than embedding it in the page. Great for long forms."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"useLightbox","strings.title":"Enable Lightbox Mode"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"lightboxHandleDescription"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"lightboxHandleText",className:"thin","strings.title":"Open Button Label",
"strings.description":"Display this text on the button to open this form.","strings.placeholder":"Open Form"}}],workflowFieldConfigs:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Pre-Submit Settings",text:"Provide users with links to content related to their inquiry before displaying the form. If they are not able to find a helpful link, they will be directed to the form."}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"usePreSubmit","strings.title":"Enable Pre-Submit","strings.description":"Enable the pre-submit workflow for this form."}},
{ctor:b.Squarespace.DialogFields.PreSubmitBuilder,config:{name:"preSubmitTopics"}}]},f={name:"editFormBlock",loadingText:"Editing Form...",closeOthers:!1,style:"standard",flyoutPointerDirection:"hidden",width:470,height:525,title:"Edit Form",initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],primaryTabs:[{title:"Edit Form",icon:"/universal/images-v6/standard/icon_form_42_light.png",tabTitle:"Build",scroll:!0,fields:{$include:"primaryFieldConfigs"}}],
secondaryTabs:[{tabTitle:"Storage",fields:{$include:"connectFieldConfigs"}},{tabTitle:"Advanced",scroll:!0,fields:[{$include:"submissionFieldConfigs",$concat:!0},{$include:"lightboxFieldConfigs",$concat:!0}]},{tabTitle:"Workflow",scroll:!0,fields:{$include:"workflowFieldConfigs"},$when:function(){return b.Squarespace.Utils.isBetaFeatureEnabled()}}]}},"1.0",{requires:"model squarespace-damask-context-globals squarespace-dialog-check squarespace-dialog-code squarespace-dialog-description squarespace-dialog-email-service-connect squarespace-dialog-google-docs-service-connect squarespace-dialog-mailchimp-service-connect squarespace-dialog-pre-submit-builder squarespace-dialog-site-user-service-connect squarespace-dialog-wysiwyg squarespace-models-form squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-dialog-warning-banner",function(b){b.namespace("Squarespace");var d=b.Squarespace.DialogFields.WarningBanner=b.Base.create("warningBanner",b.Squarespace.DialogField2,[],{initializer:function(b){this.set("strings.warn",this.get("connectWarn"))},syncUI:function(){d.superclass.syncUI.call(this);this.get("contentBox");this.set("visible",this.get("data"))},bindUI:function(){d.superclass.bindUI.call(this);if(b.Lang.isValue(this.get("moreInfo"))){var c=this.get("moreInfo");this._tooltip=
new b.Squarespace.ToolTip({target:c.target,title:c.title,body:c.body,clickToShow:!0})}this.get("contentBox").delegate("click",function(){var c=this.get("linkAction");b.Lang.isFunction(c)&&c()},".link-action",this)},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this.get("boundingBox");b.append('<div class="warning-wrapper"><div class="warn-msg"><img src="/universal/images-v6/dialog/tiny-alert.png"><div class="message-text"></div></div>');b.one(".message-text").setContent(this.get("strings.warningMessage"));
!1===this.get("data")&&this.set("visible",!1)},destroy:function(){d.superclass.destroy.call(this);b.Lang.isValue(this._tooltip)&&this._tooltip.destroy()}},{CSS_PREFIX:"sqs-warning-banner",ATTRS:{moreInfo:{value:null},strings:{warningMessage:{value:null}},linkAction:{validator:b.Squarespace.AttrValidators.isFunctionOrNull}}})},"1.0",{requires:["squarespace-util","squarespace-enum","squarespace-attr-validators"]});
YUI.add("squarespace-navigation-item-list-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["navigation-item-list.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);var l;b=this.escapeExpression;return c=""+("<header>"+b((l=(l=c.navigation,null==l||!1===l?l:l.title),"function"===typeof l?l.apply(c):l))+'</header>\n<div class="items"></div>\n<div class="empty-message">\n  '+b((l=(l=c.navigation,null==l||!1===l?l:l.emptyMessage),
"function"===typeof l?l.apply(c):l))+'\n</div>\n<footer>\n  <div class="add-page">\n    <div class="icon icon-add"></div>\n    <div class="title">Add Page</div>\n  </div>\n</footer>')})})();b.Handlebars.registerPartial("navigation-item-list.html".replace("/","."),d.templates["navigation-item-list.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-weighted-list",function(b){b.namespace("Squarespace");var d=b.Base.create("weightedList",b.Squarespace.DataBackedWidget,[],{renderUI:function(){this.buildScale();this.renderList()},bindUI:function(){this.after("dataChange",this.onDataChange,this)},renderList:function(){var b=d3.select(this.get("contentBox").getDOMNode()).select(".weighted-list");b.empty()&&(b=this.initializeList());this.renderText(b)},initializeList:function(){return d3.select(this.get("contentBox").getDOMNode()).append("div").attr("class",
"list")},renderText:function(c){var e=this._sizeScale,d=this.get("data"),g=this.get("title"),h=this.get("valueLabel"),k=this.get("label"),l=this.get("key"),p=this.get("formatter"),q;g&&c.append("div").attr("class","title").text(g);c.selectAll(".weighted-text").data(d).enter().append("div").attr("class","list-item").each(function(c,d){q=d3.select(this);q.append("div").text(function(b){return p?p(b):b[l]}).attr("class","weighted-text "+l).style("font-size",function(b){return e(b[l])+"px"});h&&q.append("div").attr("class",
"value-label").text(function(){var e=c[h];return b.Lang.isNumber(e)?d3.format(",")(e):c[h]});k&&q.append("div").attr("class","label").text(function(){return c[k]})})},parseValues:function(){var b=this.get("data"),e=this.get("key");b.forEach(function(b){b[e]=parseFloat(b[e])||0})},buildScale:function(){var c=this.get("data"),e=this.get("key"),d=this.get("range"),g=d[0],d=d[1],h=Number.MAX_VALUE,k=Number.MIN_VALUE;b.Lang.isString(c[0][e])&&this.parseValues();c.forEach(function(b){k=Math.max(b[e],k);
h=Math.min(b[e],h)});this._sizeScale=d3.scale.linear().domain([h,k]).range([g,d])},onDataChange:function(){},initializer:function(b){this._sizeScale={}}},{ATTRS:{range:{value:[0,0],validator:function(b){return b[0]<=b[1]}},label:{setter:function(b){return""+b},validator:function(c){var e=this.get("data")[0];return b.Object.hasKey(e,c)}},formatter:{validator:b.Lang.isFunction},valueLabel:{setter:function(b){return""+b},validator:function(c){var e=this.get("data")[0];return b.Object.hasKey(e,c)}}}});
b.Squarespace.WeightedList=d},"1.0",{requires:["squarespace-data-backed-widget","base"]});YUI.add("squarespace-block-instagram-model",function(b){b.namespace("Squarespace.ContentModel").InstagramBlock=b.Base.create("InstagramModel",b.Squarespace.ContentModel.SummaryGalleryBlock,[],{},{})},"1.0",{requires:["base","model","squarespace-enum","squarespace-block-summary-gallery-model"]});
YUI.add("squarespace-event-dbltap",function(b){b.Event.define("dbltap",{on:function(d,c,e){this._clear(c);c._handle=d.on("tap",function(d){c._timer&&c._timer.cancel();2===++c._counter?(this._clear(c),e.fire(d)):c._timer=b.later(300,this,this._clear,[c])},null,this)},detach:function(b,c,e){c._handle.detach();c._timer&&c._timer.cancel()},_clear:function(b){b._counter=0;b._timer=null}})},"1.0",{requires:["event","event-tap","event-synthetic"]});
YUI.add("squarespace-block-summary-v2-editor",function(b){b.namespace("Squarespace.Block.Editor").SummaryV2=b.Base.create("summary-v2-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.SummaryV2")},afterLayoutDrag:function(){this._host.fire("resized")}},{NS:"blockEditor",ATTRS:{blockName:{value:"SummaryV2"}}})},"1.0",{requires:["base","squarespace-block-editor-dialog","squarespace-block-summary-v2-model-editor",
"squarespace-damask-context-globals","squarespace-model-editor"]});
YUI.add("squarespace-widgets-google-apps-user-list",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.GoogleAppsUserList=b.Base.create("GoogleAppsUserList",b.Squarespace.Widgets.ModelList,[],{},{CSS_PREFIX:"sqs-google-apps-user-list",ATTRS:{strings:{value:{modelName:"user"}},defaultChildType:{value:b.Squarespace.Widgets.GoogleAppsUser}}})},"1.0",{requires:["base","squarespace-models-google-apps-user-list","squarespace-widgets-google-apps-user","squarespace-widgets-model-list"]});
YUI.add("squarespace-widgets-google-apps-inactive-subscription",function(b){b.namespace("Squarespace.GoogleApps");b.Squarespace.Widgets.GoogleApps.InactiveSubscription=b.Base.create("googleAppsInactiveSubscription",b.Squarespace.Widgets.Model,[],{initializer:function(){this.publish("activated",{emitFacade:!0})},bindUI:function(){this.get("contentBox").one(".activation-btn").on("click",this._activateSubscription,this)},_activateSubscription:function(){var d=this._buildSubscription();d.once("save",
function(){this.fire("activated")},this);var c=new b.Squarespace.Editor.GoogleApps.Subscription({model:d}),e=d.onceAfter("error",function(){new b.Squarespace.Widgets.Alert({"strings.title":"Failed to Subscribe","strings.message":"Failed to subscribe to Google Apps"})},this);c.after(["visibleChange","destroy"],function(){e.detach()});c.show()},_buildSubscription:function(){var d=this.get("user"),c=this.get("model"),e=this.get("website"),f=this.get("websiteSettings"),g=e.get("location")||{},h=d.get("location")||
{},k=b.merge(g,h),g=b.Squarespace.Localities.countryCodeFromName(k.addressCountry),h=k.addressLine1,k=k.addressLine2;return new b.Squarespace.Models.GoogleAppsSubscription({customerId:c.get("name"),customer:new b.Squarespace.Models.GoogleAppsCustomer({domain:c.get("name"),alternateEmail:d.get("email"),contactName:d.get("displayName"),phoneNumber:f.get("contactPhoneNumber"),addressLine1:h,addressLine2:k,orgName:e.get("siteTitle"),country:g})})}},{CSS_PREFIX:"sqs-google-apps-inactive-subscription",
TEMPLATE:'<div class="activation-btn">Subscribe to Google Apps</div>',ATTRS:{model:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.Domain)},user:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberAccount),writeOnce:"initOnly"},website:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.Website),writeOnce:"initOnly"},websiteSettings:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.WebsiteSettings),
writeOnce:"initOnly"}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-editor-google-apps-subscription squarespace-fluent-confirmation squarespace-models-google-apps-subscription squarespace-models-google-apps-customer squarespace-models-member-account squarespace-models-website squarespace-models-website-settings squarespace-promises squarespace-widgets-alert squarespace-widgets-model".split(" ")});
YUI.add("squarespace-models-template-installation",function(b){var d=b.namespace("Squarespace.Models").TemplateInstallation=b.Base.create("TemplateInstallation",b.Model,[b.Squarespace.ModelSync.REST],{url:"/api/template-installations/{id}",root:"/api/template-installations",getThumbnailAssetUrl:function(c){var e=this.get("templateWebsiteTaxonomy.thumbnailAssetUrl");return e=b.Lang.isValue(e)?e+("?format="+c):"/universal/images-v6/configuration/no-image.png"}},{ATTRS:{templateId:{validator:b.Lang.isString},
displayName:{valueFn:function(){var c=this.get("templateWebsiteTaxonomy.displayName");b.Lang.isValue(c)||(c=this.get("templateWebsite.siteTitle"));return c}},isPreviewTemplate:{getter:function(){b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]);return b.Squarespace.Singletons.AuthenticatedMemberWebsiteSettings.get("previewInstallationId")==this.get("id")}},isActiveTemplate:{getter:function(){var c=Static.SQUARESPACE_CONTEXT.website.installationId;if(b.Lang.isValue(c))return this.get("id")==
c;c=Static.SQUARESPACE_CONTEXT.website.templateWebsiteId;return b.Lang.isValue(c)?this.get("sourceWebsiteId")==c:this.get("templateId")==Static.SQUARESPACE_CONTEXT.website.templateId}}},createWithTemplateWebsiteIdentifier:function(c){return new b.Promise(function(e,h){b.Data.post({url:"/api/template-installations/addTemplate",data:{templateWebsiteIdentifier:c},success:function(b){e(new d(b))},failure:function(b){h(b)}})})}}),c=b.Base.create("TemplateInstallationList",b.ModelList,[b.ModelSync.REST],
{model:d,url:"/api/template-installations",initializer:function(){},setPreviewInstallation:function(c){return new b.Promise(b.bind(function(e,d){var k=this.get("memberWebsiteSettings");k.set("previewInstallationId",c?c.get("id"):null);k.save(b.bind(function(k){k?d():b.Squarespace.Singletons.Template.set("id",c?c.get("templateId"):this.getActiveInstallation().get("templateId")).load(e)},this))},this))},setActiveInstallation:function(c){return new b.Promise(b.bind(function(e,d){b.Data.post({url:"/api/template/SetTemplate",
data:{installationId:c.get("id")},success:function(){this.get("memberWebsiteSettings").set("previewInstallationId",null);Static.SQUARESPACE_CONTEXT.website.templateId=c.get("templateId");Static.SQUARESPACE_CONTEXT.website.installationId=c.get("id");b.Squarespace.Singletons.Template.set("id",c.get("templateId")).load(e)}},this)},this))},sort:function(){var c=this.toArray(),e=b.Array.find(c,function(b){return b.get("isPreviewTemplate")});e&&(c.remove(e),c.unshift(e));if(e=b.Array.find(c,function(b){return b.get("isActiveTemplate")}))c.remove(e),
c.unshift(e);this._defResetFn({models:c,src:"sort"});return this},getActiveInstallation:function(){var c=Static.SQUARESPACE_CONTEXT.website.templateId;return b.Array.find(this.toArray(),function(b){return b.get("templateId")==c})},getPreviewInstallation:function(){b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]);var c=this.get("memberWebsiteSettings").get("previewInstallationId");return this.getById(c)}},{ATTRS:{memberWebsiteSettings:{valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberWebsiteSettings}}}}),
e=[];Static.SQUARESPACE_CONTEXT&&(e.push(new d(Static.SQUARESPACE_CONTEXT.templateInstallation)),Static.SQUARESPACE_CONTEXT.previewTemplateInstallation&&e.push(new d(Static.SQUARESPACE_CONTEXT.previewTemplateInstallation)));b.namespace("Squarespace.Singletons").TemplateInstallationListCache=new c({items:e})},"1.0",{requires:["base","model","promise","squarespace-model-sync-rest","squarespace-models-member-website-settings"]});
YUI.add("squarespace-mixins-loadable",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.Loadable=b.Base.create("Loadable",b.Base,[],{initializer:function(){var d=this.get("loadable"),c=this.get("loadOnInitialize");b.Lang.isValue(d)?(this._bindLoadable(),c&&d.load()):c&&console.error("Squarespace.Mixins.Loadable: You set loadOnInitialize to true, but the loadable was not defined in the initializer.");this.after("loadableChange",this._bindLoadable,this)},_bindLoadable:function(){var d=
this.get("loadable");b.Do.before(function(){this._set("loading",!0)},d,"load",this);d.after("load",function(){this._set("loading",!1)},this);b.Do.after(function(){this.after("loadingChange",this.syncUI,this)},this,"bindUI",this)}},{ATTRS:{loadable:{value:null},loading:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0},loadOnInitialize:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"}}})},"1.0",{requires:["base","event-custom","squarespace-attr-validators"]});
YUI.add("squarespace-block-mixin-gallery-option-sync",function(b){b.namespace("Squarespace.Block.Mixins").Gallery=b.Base.create("GalleryManagment",b.Base,[],{_defaultGalleryOptions:function(){var d,c;d=b.Squarespace.GalleryOptions;c=b.Array.map(b.Object.values(d),function(b){return b.defaultValue});d=b.Object.keys(d);return b.Array.hash(d,c)},_getGalleryOptions:function(){var d=b.clone(b.Squarespace.GalleryOptions),c=this.get("model");b.Object.each(d,function(b,d){var g=c.get(d);void 0!==g?(b.data=
g,b.defaultValue=g):b.defaultValue=g||b.defaultValue},this);return d},syncGalleryOptions:function(b,c){var e=this.get("dialog").getField("options"),f=this.get("model"),g={};g[b]=e.get("data")[b];if("design"===b){var h=null;"slider"===g.design&&(h=f.get("aspectRatio")||75);f.set("aspectRatio",h,{silent:!0})}void 0===e.get("data")[b]?f.setAttrs(g,{silent:!0}):f.setAttrs(g)},unsetVSize:function(){this.get("model").set("vSize",null)},renderGridCSS:function(d,c){var e=d.one(".sqs-gallery-container");if(!b.Lang.isNull(e)){var f=
this._getDefaultContent(),g=e.get("className").split(" "),g=b.Array.find(g,function(b){return b.startsWith("sqs-gallery-thumbnails-per-row-")}),h=c.padding,k=c["thumbnails-per-row"];b.Lang.isValue(k)||(k=f.thumbsPerRow);b.Lang.isValue(h)||(h=f.padding);var l=".sqs-block-content#"+d.get("id"),f=d.one("#design-grid-css"),h=l+" .sqs-gallery-design-grid { margin-right: -"+h+"px; } "+l+" .sqs-gallery-design-grid .sqs-gallery-design-grid-slide .margin-wrapper { margin-right: "+h+"px; margin-bottom: "+h+
"px; };";g&&e.removeClass(g);e.addClass("sqs-gallery-thumbnails-per-row-"+k);f&&f.setContent(h)}},renderSlideshowCSS:function(d,c){var e=d.one(".sqs-gallery-thumbnails"),f;e&&(f=this._getDefaultContent(),b.Lang.isNumber(c["thumbnail-strip-height"])||(c["thumbnail-strip-height"]=f["thumbnail-strip-height"]),b.Lang.isNumber(c["thumbnail-strip-margin"])||(c["thumbnail-strip-margin"]=f["thumbnail-strip-margin"]),e.setStyles({marginTop:c["thumbnail-strip-margin"],height:c["thumbnail-strip-height"]}),e.getData("gallery")["gallery-design"].syncUI())}},
{ATTRS:{NS:"gallerySynchronizer"}})},"1.0",{requires:["base","base-build","plugin","squarespace-dialog-gallery-options"]});
YUI.add("squarespace-widgets-order",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.Order=b.Base.create("Order",b.Squarespace.Widgets.Model,[b.Squarespace.Mixins.EditableModel],{initializer:function(){this.publish("orderStateChange");this._selector=new b.Squarespace.DialogFields.Check({name:"orderSelector",data:0!==this.get("selected"),className:"dark"})},destructor:function(){this._selector.destroy()},renderUI:function(){d.superclass.renderUI.call(this);this._selector.render(this.get("contentBox").one(".order-selector"))},
bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",function(){this.get("model").load(b.bind(function(){this._edit()},this))},this);var c=this._selector;this.after("selectedChange",function(b){c.set("data",0!==b.newVal,{silent:!0})});c.after("dataChange",function(b){b.silent||this.set("selected",b.newVal?1:0)},this)},_bindEditor:function(b){b.after("saved",function(){this.fire("orderStateChange")},this)},_getHBTemplateContext:function(){var c=d.superclass._getHBTemplateContext.call(this),
e=c.model,f=e.currency,g=b.Squarespace.CurrencySymbol[f],h=e.itemCount,k=e.state,l=e.refundTotalCents,p=b.Squarespace.DateUtils.dateFormat(e.submittedOn,{format:"%m/%d/%Y %l:%M %p"}),e=e.completedOn,e=b.Lang.isUndefined(e)?"":b.Squarespace.DateUtils.dateFormat(e,{format:"%m/%d/%Y %l:%M %p"});return b.merge(c,{currencySymbol:g,showCurrencyCode:b.Squarespace.Commerce.showCurrencyCodeForCurrency(f),itemCountString:h+(1!==h?" items":" item"),stateShipped:k===b.Squarespace.OrderStates.SHIPPED,stateCancelled:k===
b.Squarespace.OrderStates.CANCELLED,stateRefunded:l&&0<l,orderDate:p,shippedDate:e})}},{CSS_PREFIX:"sqs-order",HANDLEBARS_TEMPLATE:"widgets-order.html",ATTRS:{editorCtor:{value:b.Squarespace.Editor.Order}}})},"1.0",{requires:"base squarespace-commerce-utils squarespace-date-utils squarespace-dialog-check squarespace-editor-order squarespace-enum squarespace-mixins-editable-model squarespace-util squarespace-widgets-model squarespace-widgets-order-template".split(" ")});
YUI.add("squarespace-dialog-file-manager-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-file-manager.html"]=b(function(b,c,d,h,k){function l(b,c){return"selected"}function p(b,c){return'\n  <div class="empty empty-search">\n    <div class="text">No results found&hellip;</div>\n  </div>\n  '}function q(b,c){return'\n  <div class="empty empty-files">\n    <div class="icon"></div>\n    <div class="text">You have not uploaded any files yet</div>\n  </div>\n  '}
this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var r=this,s=d.helperMissing,t=this.escapeExpression;if((c=d.each.call(c,c.attachments,{hash:{},inverse:r.program(4,function(b,c){var e,f;e="\n  ";if((f=d["if"].call(b,b.searchQuery,{hash:{},inverse:r.program(7,q,c),fn:r.program(5,p,c),data:c}))||0===f)e+=f;return e+"\n"},k),fn:r.programWithDepth(1,function(b,c,e){var f,h,k;f='\n<div class="attachment ';k={hash:{compare:b.urlId},inverse:r.noop,fn:r.program(2,l,c),data:c};if((e=
(h=d.if_eq||b.if_eq,h?h.call(b,e.selectedUrlId,k):s.call(b,"if_eq",e.selectedUrlId,k)))||0===e)f+=e;f+='" data-urlId="';(e=d.urlId)?e=e.call(b,{hash:{},data:c}):(e=b.urlId,e="function"===typeof e?e.apply(b):e);f+=t(e)+'" data-id="';(e=d.id)?e=e.call(b,{hash:{},data:c}):(e=b.id,e="function"===typeof e?e.apply(b):e);f+=t(e)+'">\n  <div class="filename">\n    <span class="filename-text">';(e=d.filename)?e=e.call(b,{hash:{},data:c}):(e=b.filename,e="function"===typeof e?e.apply(b):e);f+=t(e)+'</span>\n    <input class="filename-editable" type="text" value="';
(e=d.filename)?e=e.call(b,{hash:{},data:c}):(e=b.filename,e="function"===typeof e?e.apply(b):e);return f+=t(e)+'" />\n  </div>\n  <div class="buttons">\n    <div class="edit"><img src="/universal/images-v6/icons/icon-edit-12-dark.png" /></div>\n    <div class="remove"><img src="/universal/images-v6/icons/icon-close-9-dark.png" /></div>\n  </div>\n</div>\n'},k,c),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("dialog-file-manager.html".replace("/","."),d.templates["dialog-file-manager.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-rss-editor",function(b){b.namespace("Squarespace.Block.Editor").Rss=b.Base.create("rss-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Rss")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Rss"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Rss=b.Base.create("blockRssEditor",b.Squarespace.ModelEditorDialog,[],{_getDefaultDialogConfig:function(){return{width:350,
height:320,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],primaryTabs:[{title:"RSS Block",icon:"/universal/images-v6/icons/icon-rss-16-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Squarespace automatically embeds your RSS feeds on blog and blog post pages. This block allows you to provide an additional, explicit link to your blog's RSS feed."}},{ctor:b.Squarespace.DialogFields.ContentIdSelector,
config:{name:"collectionId",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionFilter:{collectionType:b.Squarespace.CollectionTypes.GENERIC,ordering:b.Squarespace.CollectionOrdering.CHRONOLOGICAL,folder:!1}}}]}]}}},{NS:"rssEditor",ATTRS:{dialogConfig:{valueFn:"_getDefaultDialogConfig",validator:b.Lang.isObject}}})},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-content-collection-utils squarespace-damask-context-globals squarespace-dialog-content-selector squarespace-dialog-description squarespace-dialog-fields-generators squarespace-models-content-collection squarespace-models-template".split(" ")});
YUI.add("squarespace-social-share-toggle",function(b){b.namespace("Squarespace.Widgets").SocialShareToggle=b.Base.create("socialShareToggle",b.Squarespace.DialogField2,[],{initializer:function(){this.publish("toggle-active",{defaultFn:this._toggleActive,preventable:!0})},bindUI:function(){b.Squarespace.Widgets.SocialShareToggle.superclass.bindUI.call(this);this.get("boundingBox").on(this.get("id")+"|click",function(){this.fire("toggle-active")},this);this.after(this.get("id")+"|activeChange",this.syncUI,
this)},syncUI:function(){b.Squarespace.Widgets.SocialShareToggle.superclass.syncUI.call(this);this.get("active")?this.get("boundingBox").addClass("active"):this.get("boundingBox").removeClass("active")},_toggleActive:function(){this.set("active",!this.get("active"))}},{ATTRS:{title:{validator:b.Lang.isString},active:{validator:b.Lang.isBoolean},className:{validator:b.Lang.isString}},CSS_PREFIX:"sqs-social-share-toggle",HANDLEBARS_TEMPLATE:"social-share-toggle.html"});b.namespace("Squarespace.Widgets").ActivationConfirmationPlugin=
b.Base.create("confrimationActivationPlugin",b.Plugin.Base,[],{initializer:function(){this._activationEvent=this.get("host").on("toggle-active",this._onActivation,this)},_onActivation:function(b){this.get("host").get("active")||(b.preventDefault(),this._confirmActivation())},_confirmActivation:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":this.get("strings.title"),"strings.message":this.get("strings.body")})).on("confirm",function(){this.get("host").set("active",!0)},this)}},
{NS:"confActivation",ATTRS:{strings:{value:{title:"Activate Share Option",body:"Are you sure you want to activate?"}}}})},"1.0",{requires:"base base-build plugin squarespace-dialog-field-2 squarespace-social-share-toggle-template squarespace-widgets-confirmation".split(" ")});
!function(b){if("object"==typeof exports&&"object"==typeof module)module.exports=b();else{if("function"==typeof define&&define.amd)return define([],b);this.CodeMirror=b()}}(function(){function b(c,e){if(!(this instanceof b))return new b(c,e);this.options=e=e||{};jc(Kd,e,!1);t(e);var f=e.value;"string"==typeof f&&(f=new Lc(f,e.mode));this.doc=f;var g=this.display=new d(c,f);g.wrapper.CodeMirror=this;p(this);k(this);e.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");e.autofocus&&!Tb&&
ob(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,draggingText:!1,highlight:new we};Dc&&setTimeout(Cc(la,this,!0),20);Gc(this);lf||(xb(),lf=!0);var h=this;Ia(this,function(){h.curOp.forceUpdate=!0;L(h,f);e.autofocus&&!Tb||Pc()==g.input?setTimeout(Cc(Pb,h),20):gd(h);for(var b in Yc)Yc.hasOwnProperty(b)&&Yc[b](h,e[b],wd);for(b=0;b<Kc.length;++b)Kc[b](h)})}function d(b,c){var e=this.input=Ea("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");
ac?e.style.width="1000px":e.setAttribute("wrap","off");Wa&&(e.style.border="1px solid black");e.setAttribute("autocorrect","off");e.setAttribute("autocapitalize","off");e.setAttribute("spellcheck","false");this.inputDiv=Ea("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");this.scrollbarH=Ea("div",[Ea("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");this.scrollbarV=Ea("div",[Ea("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");this.scrollbarFiller=
Ea("div",null,"CodeMirror-scrollbar-filler");this.gutterFiller=Ea("div",null,"CodeMirror-gutter-filler");this.lineDiv=Ea("div",null,"CodeMirror-code");this.selectionDiv=Ea("div",null,null,"position: relative; z-index: 1");this.cursorDiv=Ea("div",null,"CodeMirror-cursors");this.measure=Ea("div",null,"CodeMirror-measure");this.lineMeasure=Ea("div",null,"CodeMirror-measure");this.lineSpace=Ea("div",[this.measure,this.lineMeasure,this.selectionDiv,this.cursorDiv,this.lineDiv],null,"position: relative; outline: none");
this.mover=Ea("div",[Ea("div",[this.lineSpace],"CodeMirror-lines")],null,"position: relative");this.sizer=Ea("div",[this.mover],"CodeMirror-sizer");this.heightForcer=Ea("div",null,null,"position: absolute; height: "+kd+"px; width: 1px;");this.gutters=Ea("div",null,"CodeMirror-gutters");this.lineGutter=null;this.scroller=Ea("div",[this.sizer,this.heightForcer,this.gutters],"CodeMirror-scroll");this.scroller.setAttribute("tabIndex","-1");this.wrapper=Ea("div",[this.inputDiv,this.scrollbarH,this.scrollbarV,
this.scrollbarFiller,this.gutterFiller,this.scroller],"CodeMirror");ec&&(this.gutters.style.zIndex=-1,this.scroller.style.paddingRight=0);Wa&&(e.style.width="0px");ac||(this.scroller.draggable=!0);ge&&(this.inputDiv.style.height="1px",this.inputDiv.style.position="absolute");ec&&(this.scrollbarH.style.minHeight=this.scrollbarV.style.minWidth="18px");b.appendChild?b.appendChild(this.wrapper):b(this.wrapper);this.viewFrom=this.viewTo=c.first;this.view=[];this.externalMeasured=null;this.lastSizeC=this.viewOffset=
0;this.lineNumWidth=this.lineNumInnerWidth=this.lineNumChars=this.updateLineNumbers=null;this.prevInput="";this.pollingFast=this.alignWidgets=!1;this.poll=new we;this.cachedCharWidth=this.cachedTextHeight=this.cachedPaddingH=null;this.inaccurateSelection=!1;this.maxLine=null;this.maxLineLength=0;this.maxLineChanged=!1;this.wheelDX=this.wheelDY=this.wheelStartX=this.wheelStartY=null;this.shift=!1;this.selForContextMenu=null}function c(c){c.doc.mode=b.getMode(c.options,c.doc.modeOption);e(c)}function e(b){b.doc.iter(function(b){b.stateAfter&&
(b.stateAfter=null);b.styles&&(b.styles=null)});b.doc.frontier=b.doc.first;xa(b,100);b.state.modeGen++;b.curOp&&ja(b)}function f(b){var c=bb(b.display),e=b.options.lineWrapping,d=e&&Math.max(5,b.display.scroller.clientWidth/fb(b.display)-3);return function(f){if(Qd(b.doc,f))return 0;var g=0;if(f.widgets)for(var h=0;h<f.widgets.length;h++)f.widgets[h].height&&(g+=f.widgets[h].height);return e?g+(Math.ceil(f.text.length/d)||1)*c:g+c}}function g(b){var c=b.doc,e=f(b);c.iter(function(b){var c=e(b);c!=
b.height&&$c(b,c)})}function h(b){var c=Ac[b.options.keyMap].style;b.display.wrapper.className=b.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(c?" cm-keymap-"+c:"")}function k(b){b.display.wrapper.className=b.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+b.options.theme.replace(/(^|\s)\s*/g," cm-s-");Xa(b)}function l(b){p(b);ja(b);setTimeout(function(){y(b)},20)}function p(b){var c=b.display.gutters,e=b.options.gutters;Oc(c);for(var d=0;d<e.length;++d){var f=e[d],g=c.appendChild(Ea("div",
null,"CodeMirror-gutter "+f));"CodeMirror-linenumbers"==f&&(b.display.lineGutter=g,g.style.width=(b.display.lineNumWidth||1)+"px")}c.style.display=d?"":"none";q(b)}function q(b){var c=b.display.gutters.offsetWidth;b.display.sizer.style.marginLeft=c+"px";b.display.scrollbarH.style.left=b.options.fixedGutter?c+"px":0}function r(b){if(0==b.height)return 0;for(var c,e=b.text.length,d=b;c=Pd(d,!0);)c=c.find(0,!0),d=c.from.line,e+=c.from.ch-c.to.ch;for(d=b;c=Pd(d,!1);)c=c.find(0,!0),e-=d.text.length-c.from.ch,
d=c.to.line,e+=d.text.length-c.to.ch;return e}function s(b){var c=b.display;b=b.doc;c.maxLine=pa(b,b.first);c.maxLineLength=r(c.maxLine);c.maxLineChanged=!0;b.iter(function(b){var e=r(b);e>c.maxLineLength&&(c.maxLineLength=e,c.maxLine=b)})}function t(b){var c=Nb(b.gutters,"CodeMirror-linenumbers");-1==c&&b.lineNumbers?b.gutters=b.gutters.concat(["CodeMirror-linenumbers"]):-1<c&&!b.lineNumbers&&(b.gutters=b.gutters.slice(0),b.gutters.splice(c,1))}function u(b){var c=b.display.scroller;return{clientHeight:c.clientHeight,
barHeight:b.display.scrollbarV.clientHeight,scrollWidth:c.scrollWidth,clientWidth:c.clientWidth,barWidth:b.display.scrollbarH.clientWidth,docHeight:Math.round(b.doc.height+(b.display.mover.offsetHeight-b.display.lineSpace.offsetHeight))}}function v(b,c){c||(c=u(b));var e=b.display,d=c.docHeight+kd,f=c.scrollWidth>c.clientWidth,g=d>c.clientHeight;if(g?(e.scrollbarV.style.display="block",e.scrollbarV.style.bottom=f?Wb(e.measure)+"px":"0",e.scrollbarV.firstChild.style.height=Math.max(0,d-c.clientHeight+
(c.barHeight||e.scrollbarV.clientHeight))+"px"):(e.scrollbarV.style.display="",e.scrollbarV.firstChild.style.height="0"),f?(e.scrollbarH.style.display="block",e.scrollbarH.style.right=g?Wb(e.measure)+"px":"0",e.scrollbarH.firstChild.style.width=c.scrollWidth-c.clientWidth+(c.barWidth||e.scrollbarH.clientWidth)+"px"):(e.scrollbarH.style.display="",e.scrollbarH.firstChild.style.width="0"),f&&g?(e.scrollbarFiller.style.display="block",e.scrollbarFiller.style.height=e.scrollbarFiller.style.width=Wb(e.measure)+
"px"):e.scrollbarFiller.style.display="",f&&b.options.coverGutterNextToScrollbar&&b.options.fixedGutter?(e.gutterFiller.style.display="block",e.gutterFiller.style.height=Wb(e.measure)+"px",e.gutterFiller.style.width=e.gutters.offsetWidth+"px"):e.gutterFiller.style.display="",!b.state.checkedOverlayScrollbar&&0<c.clientHeight)0===Wb(e.measure)&&(e.scrollbarV.style.minWidth=e.scrollbarH.style.minHeight=kc&&!Ga?"12px":"18px",d=function(c){(c.target||c.srcElement)!=e.scrollbarV&&(c.target||c.srcElement)!=
e.scrollbarH&&x(b,Hc)(c)},Za(e.scrollbarV,"mousedown",d),Za(e.scrollbarH,"mousedown",d)),b.state.checkedOverlayScrollbar=!0}function w(b,c,e){var d=e&&null!=e.top?e.top:b.scroller.scrollTop,d=Math.floor(d-b.lineSpace.offsetTop),f=e&&null!=e.bottom?e.bottom:d+b.wrapper.clientHeight,d=pb(c,d),f=pb(c,f);if(e&&e.ensure){var g=e.ensure.from.line;e=e.ensure.to.line;if(d>g)return{from:g,to:pb(c,vb(pa(c,g))+b.wrapper.clientHeight)};if(Math.min(e,c.lastLine())>=f)return{from:pb(c,vb(pa(c,e))-b.wrapper.clientHeight),
to:e}}return{from:d,to:f}}function y(b){var c=b.display,e=c.view;if(c.alignWidgets||c.gutters.firstChild&&b.options.fixedGutter){for(var d=z(c)-c.scroller.scrollLeft+b.doc.scrollLeft,f=c.gutters.offsetWidth,g=d+"px",h=0;h<e.length;h++)if(!e[h].hidden){b.options.fixedGutter&&e[h].gutter&&(e[h].gutter.style.left=g);var k=e[h].alignable;if(k)for(var l=0;l<k.length;l++)k[l].style.left=g}b.options.fixedGutter&&(c.gutters.style.left=d+f+"px")}}function z(b){return b.scroller.getBoundingClientRect().left-
b.sizer.getBoundingClientRect().left}function B(b,c,e){for(var d,f=b.display.viewFrom,g=b.display.viewTo,h=w(b.display,b.doc,c),k=!0;;k=!1){var l=b.display.scroller.clientWidth,p;a:{p=b;var r=h,s=e;e=p.display;var t=p.doc;if(e.wrapper.offsetWidth){if(s||!(r.from>=e.viewFrom&&r.to<=e.viewTo&&0==gc(p))){var y;y=p;if(y.options.lineNumbers){var x=y.doc,x=String(y.options.lineNumberFormatter(x.first+x.size-1+y.options.firstLineNumber)),z=y.display;if(x.length!=z.lineNumChars){var da=z.measure.appendChild(Ea("div",
[Ea("div",x)],"CodeMirror-linenumber CodeMirror-gutter-elt")),S=da.firstChild.offsetWidth,da=da.offsetWidth-S;y=(z.lineGutter.style.width="",z.lineNumInnerWidth=Math.max(S,z.lineGutter.offsetWidth-da),z.lineNumWidth=z.lineNumInnerWidth+da,z.lineNumChars=z.lineNumInnerWidth?x.length:-1,z.lineGutter.style.width=z.lineNumWidth+"px",q(y),!0)}else y=!1}else y=!1;y&&$a(p);y=K(p);S=t.first+t.size;x=Math.max(r.from-p.options.viewportMargin,t.first);z=Math.min(S,r.to+p.options.viewportMargin);e.viewFrom<x&&
20>x-e.viewFrom&&(x=Math.max(t.first,e.viewFrom));e.viewTo>z&&20>e.viewTo-z&&(z=Math.min(S,e.viewTo));cd&&(x=Ie(p.doc,x),z=Ye(p.doc,z));r=x!=e.viewFrom||z!=e.viewTo||e.lastSizeC!=e.wrapper.clientHeight;t=p;S=t.display;0==S.view.length||x>=S.viewTo||z<=S.viewFrom?(S.view=Ab(t,x,z),S.viewFrom=x):(S.viewFrom>x?S.view=Ab(t,x,S.viewFrom).concat(S.view):S.viewFrom<x&&(S.view=S.view.slice(za(t,x))),S.viewFrom=x,S.viewTo<z?S.view=S.view.concat(Ab(t,S.viewTo,z)):S.viewTo>z&&(S.view=S.view.slice(0,za(t,z))));
S.viewTo=z;e.viewOffset=vb(pa(p.doc,e.viewFrom));p.display.mover.style.top=e.viewOffset+"px";t=gc(p);if(r||0!=t||s){s=Pc();4<t&&(e.lineDiv.style.display="none");O(p,e.updateLineNumbers,y);4<t&&(e.lineDiv.style.display="");s&&Pc()!=s&&s.offsetHeight&&s.focus();Oc(e.cursorDiv);Oc(e.selectionDiv);r&&(e.lastSizeC=e.wrapper.clientHeight,xa(p,400));p=p.display;e=p.lineDiv.offsetTop;for(s=0;s<p.view.length;s++)if(r=p.view[s],!r.hidden&&(ec?(y=r.node.offsetTop+r.node.offsetHeight,t=y-e,e=y):(t=r.node.getBoundingClientRect(),
t=t.bottom-t.top),y=r.line.height-t,2>t&&(t=bb(p)),(0.001<y||-0.001>y)&&($c(r.line,t),A(r.line),r.rest)))for(t=0;t<r.rest.length;t++)A(r.rest[t]);p=!0;break a}}p=void 0}else p=($a(p),void 0)}if(!p)break;d=!0;b.display.maxLineChanged&&!b.options.lineWrapping&&(p=b,e=p.display,s=Ha(p,Ra(p,e.maxLine),e.maxLine.text.length,void 0).left,e.maxLineChanged=!1,s=Math.max(0,s+3),r=Math.max(0,e.sizer.offsetLeft+s+kd-e.scroller.clientWidth),e.sizer.style.minWidth=s+"px",r<p.doc.scrollLeft&&uc(p,Math.min(e.scroller.scrollLeft,
r),!0));p=u(b);T(b);e=b;s=p;e.display.sizer.style.minHeight=e.display.heightForcer.style.top=s.docHeight+"px";e.display.gutters.style.height=Math.max(s.docHeight,s.clientHeight-kd)+"px";v(b,p);ac&&b.options.lineWrapping&&(e=b,s=p,e.display.sizer.offsetWidth+e.display.gutters.offsetWidth<e.display.scroller.clientWidth-1&&(e.display.sizer.style.minHeight=e.display.heightForcer.style.top="0px",e.display.gutters.style.height=s.docHeight+"px"));if(k&&b.options.lineWrapping&&l!=b.display.scroller.clientWidth)e=
!0;else if(e=!1,c&&null!=c.top&&(c={top:Math.min(p.docHeight-kd-p.clientHeight,c.top)}),h=w(b.display,b.doc,c),h.from>=b.display.viewFrom&&h.to<=b.display.viewTo)break}return b.display.updateLineNumbers=null,d&&(ic(b,"update",b),(b.display.viewFrom!=f||b.display.viewTo!=g)&&ic(b,"viewportChange",b,b.display.viewFrom,b.display.viewTo)),d}function A(b){if(b.widgets)for(var c=0;c<b.widgets.length;++c)b.widgets[c].height=b.widgets[c].node.offsetHeight}function K(b){for(var c=b.display,e={},d={},f=c.gutters.firstChild,
g=0;f;f=f.nextSibling,++g)e[b.options.gutters[g]]=f.offsetLeft,d[b.options.gutters[g]]=f.offsetWidth;return{fixedPos:z(c),gutterTotalWidth:c.gutters.offsetWidth,gutterLeft:e,gutterWidth:d,wrapperWidth:c.wrapper.clientWidth}}function O(b,c,e){function d(c){var e=c.nextSibling;return ac&&kc&&b.display.currentWheelTarget==c?c.style.display="none":c.parentNode.removeChild(c),e}for(var f=b.display,g=b.options.lineNumbers,h=f.lineDiv,k=h.firstChild,l=f.view,f=f.viewFrom,p=0;p<l.length;p++){var q=l[p];if(!q.hidden)if(q.node){for(;k!=
q.node;)k=d(k);k=g&&null!=c&&f>=c&&q.lineNumber;q.changes&&(-1<Nb(q.changes,"gutter")&&(k=!1),E(b,q,f,e));k&&(Oc(q.lineNumber),q.lineNumber.appendChild(document.createTextNode(String(b.options.lineNumberFormatter(f+b.options.firstLineNumber)))));k=q.node.nextSibling}else{var r=aa(b,q,f,e);h.insertBefore(r,k)}f+=q.size}for(;k;)k=d(k)}function E(b,c,e,d){for(var f=0;f<c.changes.length;f++){var g=c.changes[f];if("text"==g){var g=c,h=g.text.className,k=U(b,g);g.text==g.node&&(g.node=k.pre);g.text.parentNode.replaceChild(k.pre,
g.text);g.text=k.pre;k.bgClass!=g.bgClass||k.textClass!=g.textClass?(g.bgClass=k.bgClass,g.textClass=k.textClass,H(g)):h&&(g.text.className=h)}else if("gutter"==g)G(b,c,e,d);else if("class"==g)H(c);else if("widget"==g){g=c;h=d;g.alignable&&(g.alignable=null);for(var k=void 0,l=g.node.firstChild;l;l=k)k=l.nextSibling,"CodeMirror-linewidget"==l.className&&g.node.removeChild(l);D(g,h)}}c.changes=null}function F(b){return b.node==b.text&&(b.node=Ea("div",null,null,"position: relative"),b.text.parentNode&&
b.text.parentNode.replaceChild(b.node,b.text),b.node.appendChild(b.text),ec&&(b.node.style.zIndex=2)),b.node}function U(b,c){var e=b.display.externalMeasured;return e&&e.line==c.line?(b.display.externalMeasured=null,c.measure=e.measure,e.built):wf(b,c)}function H(b){var c=b.bgClass?b.bgClass+" "+(b.line.bgClass||""):b.line.bgClass;if(c&&(c+=" CodeMirror-linebackground"),b.background)c?b.background.className=c:(b.background.parentNode.removeChild(b.background),b.background=null);else if(c){var e=F(b);
b.background=e.insertBefore(Ea("div",null,c),e.firstChild)}b.line.wrapClass?F(b).className=b.line.wrapClass:b.node!=b.text&&(b.node.className="");b.text.className=(b.textClass?b.textClass+" "+(b.line.textClass||""):b.line.textClass)||""}function G(b,c,e,d){c.gutter&&(c.node.removeChild(c.gutter),c.gutter=null);var f=c.line.gutterMarkers;if(b.options.lineNumbers||f){var g=F(c),g=c.gutter=g.insertBefore(Ea("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(b.options.fixedGutter?d.fixedPos:
-d.gutterTotalWidth)+"px"),c.text);if(!b.options.lineNumbers||f&&f["CodeMirror-linenumbers"]||(c.lineNumber=g.appendChild(Ea("div",String(b.options.lineNumberFormatter(e+b.options.firstLineNumber)),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+d.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+b.display.lineNumInnerWidth+"px"))),f)for(c=0;c<b.options.gutters.length;++c){e=b.options.gutters[c];var h=f.hasOwnProperty(e)&&f[e];h&&g.appendChild(Ea("div",[h],"CodeMirror-gutter-elt","left: "+
d.gutterLeft[e]+"px; width: "+d.gutterWidth[e]+"px"))}}}function aa(b,c,e,d){var f=U(b,c);return c.text=c.node=f.pre,f.bgClass&&(c.bgClass=f.bgClass),f.textClass&&(c.textClass=f.textClass),H(c),G(b,c,e,d),D(c,d),c.node}function D(b,c){if(M(b.line,b,c,!0),b.rest)for(var e=0;e<b.rest.length;e++)M(b.rest[e],b,c,!1)}function M(b,c,e,d){if(b.widgets){var f=F(c),g=0;for(b=b.widgets;g<b.length;++g){var h=b[g],k=Ea("div",[h.node],"CodeMirror-linewidget");h.handleMouseEvents||(k.ignoreEvents=!0);var l=h,p=
k,q=e;if(l.noHScroll){(c.alignable||(c.alignable=[])).push(p);var r=q.wrapperWidth;p.style.left=q.fixedPos+"px";l.coverGutter||(r-=q.gutterTotalWidth,p.style.paddingLeft=q.gutterTotalWidth+"px");p.style.width=r+"px"}l.coverGutter&&(p.style.zIndex=5,p.style.position="relative",l.noHScroll||(p.style.marginLeft=-q.gutterTotalWidth+"px"));d&&h.above?f.insertBefore(k,c.gutter||c.text):f.appendChild(k);ic(h,"redraw")}}}function I(b,c){return 0>ab(b,c)?c:b}function Q(b,c){return 0>ab(b,c)?b:c}function V(b,
c){this.ranges=b;this.primIndex=c}function C(b,c){this.anchor=b;this.head=c}function Z(b,c){var e=b[c];b.sort(function(b,c){return ab(b.from(),c.from())});c=Nb(b,e);for(e=1;e<b.length;e++){var d=b[e],f=b[e-1];if(0<=ab(f.to(),d.from())){var g=Q(f.from(),d.from()),h=I(f.to(),d.to()),d=f.empty()?d.from()==d.head:f.from()==f.head;c>=e&&--c;b.splice(--e,2,new C(d?h:g,d?g:h))}}return new V(b,c)}function N(b,c){return new V([new C(b,c||b)],0)}function ca(b,c){if(c.line<b.first)return ka(b.first,0);var e=
b.first+b.size-1;if(c.line>e)e=ka(e,pa(b,e).text.length);else var e=pa(b,c.line).text.length,d=c.ch,e=null==d||d>e?ka(c.line,e):0>d?ka(c.line,0):c;return e}function R(b,c){return c>=b.first&&c<b.first+b.size}function X(b,c,e,d){return b.cm&&b.cm.display.shift||b.extend?(b=c.anchor,d&&(c=0>ab(e,b),c!=0>ab(d,b)?(b=e,e=d):c!=0>ab(e,d)&&(e=d)),new C(b,e)):new C(d||e,e)}function ba(b,c,e,d){Y(b,new V([X(b,b.sel.primary(),c,e)],0),d)}function na(b,c,e){for(var d=[],f=0;f<b.sel.ranges.length;f++)d[f]=X(b,
b.sel.ranges[f],c[f],null);c=Z(d,b.sel.primIndex);Y(b,c,e)}function S(b,c,e,d){var f=b.sel.ranges.slice(0);f[c]=e;Y(b,Z(f,b.sel.primIndex),d)}function $(b,c){var e={ranges:c.ranges,update:function(c){this.ranges=[];for(var e=0;e<c.length;e++)this.ranges[e]=new C(ca(b,c[e].anchor),ca(b,c[e].head))}};return lc(b,"beforeSelectionChange",b,e),b.cm&&lc(b.cm,"beforeSelectionChange",b.cm,e),e.ranges!=c.ranges?Z(e.ranges,e.ranges.length-1):c}function ra(b,c,e){var d=b.history.done,f=ub(d);f&&f.ranges?(d[d.length-
1]=c,ta(b,c,e)):Y(b,c,e)}function Y(b,c,e){ta(b,c,e);c=b.sel;var d=b.cm?b.cm.curOp.id:0/0,f=b.history,g=e&&e.origin,h;if(!(h=d==f.lastOp))if(h=g)if(h=f.lastSelOrigin==g)if(!(h=f.lastModTime==f.lastSelTime&&f.lastOrigin==g)){h=ub(f.done);var k=g.charAt(0);h="*"==k||"+"==k&&h.ranges.length==c.ranges.length&&h.somethingSelected()==c.somethingSelected()&&new Date-b.history.lastSelTime<=(b.cm?b.cm.options.historyEventDelay:500)}h?f.done[f.done.length-1]=c:J(c,f.done);f.lastSelTime=+new Date;f.lastSelOrigin=
g;f.lastOp=d;e&&!1!==e.clearRedo&&Ne(f.undone)}function ta(b,c,e){(Ya(b,"beforeSelectionChange")||b.cm&&Ya(b.cm,"beforeSelectionChange"))&&(c=$(b,c));var d=0>ab(c.primary().head,b.sel.primary().head)?-1:1;Na(b,Oa(b,c,d,!0));e&&!1===e.scroll||!b.cm||ae(b.cm)}function Na(b,c){c.equals(b.sel)||(b.sel=c,b.cm&&(b.cm.curOp.updateInput=b.cm.curOp.selectionChanged=!0,kb(b.cm)),ic(b,"cursorActivity",b))}function Qa(b){Na(b,Oa(b,b.sel,null,!1),Md)}function Oa(b,c,e,d){for(var f,g=0;g<c.ranges.length;g++){var h=
c.ranges[g],k=fa(b,h.anchor,e,d),l=fa(b,h.head,e,d);(f||k!=h.anchor||l!=h.head)&&(f||(f=c.ranges.slice(0,g)),f[g]=new C(k,l))}return f?Z(f,c.primIndex):c}function fa(b,c,e,d){var f=!1,g=c,h=e||1;b.cantEdit=!1;a:for(;;){var k=pa(b,g.line);if(k.markedSpans)for(var l=0;l<k.markedSpans.length;++l){var p=k.markedSpans[l],q=p.marker;if((null==p.from||(q.inclusiveLeft?p.from<=g.ch:p.from<g.ch))&&(null==p.to||(q.inclusiveRight?p.to>=g.ch:p.to>g.ch))){if(d&&(lc(q,"beforeCursorEnter"),q.explicitlyCleared)){if(k.markedSpans){--l;
continue}break}if(q.atomic){l=q.find(0>h?-1:1);if(0==ab(l,g)&&(l.ch+=h,0>l.ch?l=l.line>b.first?ca(b,ka(l.line-1)):null:l.ch>k.text.length&&(l=l.line<b.first+b.size-1?ka(l.line+1,0):null),!l)){if(f)return d?(b.cantEdit=!0,ka(b.first,0)):fa(b,c,e,!0);f=!0;l=c;h=-h}g=l;continue a}}}return g}}function T(b){for(var c=b.display,e=b.doc,d=document.createDocumentFragment(),f=document.createDocumentFragment(),g=0;g<e.sel.ranges.length;g++){var h=e.sel.ranges[g],k=h.empty();if(k||b.options.showCursorWhenSelecting){var l=
b,p=d,q=db(l,h.head,"div"),r=p.appendChild(Ea("div","\u00a0","CodeMirror-cursor"));if(r.style.left=q.left+"px",r.style.top=q.top+"px",r.style.height=Math.max(0,q.bottom-q.top)*l.options.cursorHeight+"px",q.other)l=p.appendChild(Ea("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor")),l.style.display="",l.style.left=q.other.left+"px",l.style.top=q.other.top+"px",l.style.height=0.85*(q.other.bottom-q.other.top)+"px"}k||ia(b,h,f)}b.options.moveInputWithCursor&&(e=db(b,e.sel.primary().head,
"div"),g=c.wrapper.getBoundingClientRect(),h=c.lineDiv.getBoundingClientRect(),b=Math.max(0,Math.min(c.wrapper.clientHeight-10,e.top+h.top-g.top)),e=Math.max(0,Math.min(c.wrapper.clientWidth-10,e.left+h.left-g.left)),c.inputDiv.style.top=b+"px",c.inputDiv.style.left=e+"px");gb(c.cursorDiv,d);gb(c.selectionDiv,f)}function ia(b,c,e){function d(b,c,e,f){0>c&&(c=0);c=Math.round(c);f=Math.round(f);k.appendChild(Ea("div",null,"CodeMirror-selected","position: absolute; left: "+b+"px; top: "+c+"px; width: "+
(null==e?q-b:e)+"px; height: "+(f-c)+"px"))}function f(c,e,g){var k,l,r=pa(h,c),s=r.text.length;return Fd(ib(r),e||0,null==g?s:g,function(f,h,t){var u,ma,v=va(b,ka(c,f),"div",r,"left");if(f==h)u=v,t=ma=v.left;else{if(u=va(b,ka(c,h-1),"div",r,"right"),"rtl"==t)t=v,v=u,u=t;t=v.left;ma=u.right}null==e&&0==f&&(t=p);3<u.top-v.top&&(d(t,v.top,null,v.bottom),t=p,v.bottom<u.top&&d(t,v.bottom,null,u.top));null==g&&h==s&&(ma=q);(!k||v.top<k.top||v.top==k.top&&v.left<k.left)&&(k=v);(!l||u.bottom>l.bottom||u.bottom==
l.bottom&&u.right>l.right)&&(l=u);p+1>t&&(t=p);d(t,u.top,ma-t,u.bottom)}),{start:k,end:l}}var g=b.display,h=b.doc,k=document.createDocumentFragment(),l=Ua(b.display),p=l.left,q=g.lineSpace.offsetWidth-l.right,g=c.from();c=c.to();if(g.line==c.line)f(g.line,g.ch,c.ch);else{var r=pa(h,g.line),l=pa(h,c.line),l=Zc(r)==Zc(l),g=f(g.line,g.ch,l?r.text.length+1:null).end;c=f(c.line,l?0:null,c.ch).start;l&&(g.top<c.top-2?(d(g.right,g.top,null,g.bottom),d(p,c.top,c.left,c.bottom)):d(g.right,g.top,c.left-g.right,
g.bottom));g.bottom<c.top&&d(p,g.bottom,null,c.top)}e.appendChild(k)}function ea(b){if(b.state.focused){var c=b.display;clearInterval(c.blinker);var e=!0;c.cursorDiv.style.visibility="";0<b.options.cursorBlinkRate&&(c.blinker=setInterval(function(){c.cursorDiv.style.visibility=(e=!e)?"":"hidden"},b.options.cursorBlinkRate))}}function xa(b,c){b.doc.mode.startState&&b.doc.frontier<b.display.viewTo&&b.state.highlight.set(c,Cc(Aa,b))}function Aa(b){var c=b.doc;if(c.frontier<c.first&&(c.frontier=c.first),
!(c.frontier>=b.display.viewTo)){var e=+new Date+b.options.workTime,d=xd(c.mode,Ba(b,c.frontier));Ia(b,function(){c.iter(c.frontier,Math.min(c.first+c.size,b.display.viewTo+500),function(f){if(c.frontier>=b.display.viewFrom){var g=f.styles,h=af(b,f,d,!0);f.styles=h.styles;h.classes?f.styleClasses=h.classes:f.styleClasses&&(f.styleClasses=null);for(var h=!g||g.length!=f.styles.length,k=0;!h&&k<g.length;++k)h=g[k]!=f.styles[k];h&&Vb(b,c.frontier,"text");f.stateAfter=xd(c.mode,d)}else te(b,f.text,d),
f.stateAfter=0==c.frontier%5?xd(c.mode,d):null;return++c.frontier,+new Date>e?(xa(b,b.options.workDelay),!0):void 0})})}}function ya(b,c,e){for(var d,f,g=b.doc,h=e?-1:c-(b.doc.mode.innerMode?1E3:100);c>h;--c){if(c<=g.first)return g.first;var k=pa(g,c-1);if(k.stateAfter&&(!e||c<=g.frontier))return c;k=dd(k.text,null,b.options.tabSize);(null==f||d>k)&&(f=c-1,d=k)}return f}function Ba(b,c,e){var d=b.doc,f=b.display;if(!d.mode.startState)return!0;var g=ya(b,c,e),h=g>d.first&&pa(d,g-1).stateAfter;return h=
h?xd(d.mode,h):Ec(d.mode),d.iter(g,c,function(e){te(b,e.text,h);e.stateAfter=g==c-1||0==g%5||g>=f.viewFrom&&g<f.viewTo?xd(d.mode,h):null;++g}),e&&(d.frontier=g),h}function Ua(b){if(b.cachedPaddingH)return b.cachedPaddingH;var c=gb(b.measure,Ea("pre","x")),c=window.getComputedStyle?window.getComputedStyle(c):c.currentStyle,c={left:parseInt(c.paddingLeft),right:parseInt(c.paddingRight)};return isNaN(c.left)||isNaN(c.right)||(b.cachedPaddingH=c),c}function ha(b,c){if(c>=b.display.viewFrom&&c<b.display.viewTo)return b.display.view[za(b,
c)];var e=b.display.externalMeasured;return e&&c>=e.lineN&&c<e.lineN+e.size?e:void 0}function Ra(b,c){var e=qb(c),d=ha(b,e);d&&!d.text?d=null:d&&d.changes&&E(b,d,e,K(b));if(!d){var f;f=Zc(c);d=qb(f);f=b.display.externalMeasured=new jb(b.doc,f,d);f.lineN=d;d=f.built=wf(b,f);d=(f.text=d.pre,gb(b.display.lineMeasure,d.pre),f)}a:if(f=d,f.line==c)e={map:f.measure.map,cache:f.measure.cache};else{for(var g=0;g<f.rest.length;g++)if(f.rest[g]==c){e={map:f.measure.maps[g],cache:f.measure.caches[g]};break a}for(g=
0;g<f.rest.length;g++)if(qb(f.rest[g])>e){e={map:f.measure.maps[g],cache:f.measure.caches[g],before:!0};break a}e=void 0}return{line:c,view:d,rect:null,map:e.map,cache:e.cache,before:e.before,hasHeights:!1}}function Ha(b,c,e,d){c.before&&(e=-1);var f,g=e+(d||"");if(c.cache.hasOwnProperty(g))f=c.cache[g];else{c.rect||(c.rect=c.view.text.getBoundingClientRect());if(!c.hasHeights){var h=c.view,k=c.rect,l=b.options.lineWrapping,p=l&&b.display.scroller.clientWidth;if(!h.measure.heights||l&&h.measure.width!=
p){var q=h.measure.heights=[];if(l){h.measure.width=p;h=h.text.firstChild.getClientRects();for(l=0;l<h.length-1;l++){var p=h[l],r=h[l+1];2<Math.abs(p.bottom-r.bottom)&&q.push((p.bottom+r.top)/2-k.top)}}q.push(k.bottom-k.top)}c.hasHeights=!0}var k=d,s,t,u,q=c.map;for(d=0;d<q.length;d+=3){var v=q[d],w=q[d+1];if(v>e?(t=0,u=1,f="left"):w>e?(t=e-v,u=t+1):(d==q.length-3||e==w&&q[d+3]>e)&&(u=w-v,t=u-1,e>=w&&(f="right")),null!=t){if(s=q[d+2],v==w&&k==(s.insertLeft?"left":"right")&&(f=k),"left"==k&&0==t)for(;d&&
q[d-2]==q[d-3]&&q[d-1].insertLeft;)s=q[(d-=3)+2],f="left";if("right"==k&&t==w-v)for(;d<q.length-3&&q[d+3]==q[d+4]&&!q[d+5].insertLeft;)s=q[(d+=3)+2],f="right";break}}if(3==s.nodeType){for(;t&&ad(c.line.text.charAt(v+t));)--t;for(;w>v+u&&ad(c.line.text.charAt(v+u));)++u;if(Xb&&0==t&&u==w-v)e=s.parentNode.getBoundingClientRect();else if($b&&b.options.lineWrapping){var y=me(s,t,u).getClientRects();e=y.length?y["right"==k?y.length-1:0]:Sd}else e=me(s,t,u).getBoundingClientRect()||Sd}else 0<t&&(f=k="right"),
e=b.options.lineWrapping&&1<(y=s.getClientRects()).length?y["right"==k?y.length-1:0]:s.getBoundingClientRect();if(Xb&&!t&&(!e||!e.left&&!e.right))e=(s=s.parentNode.getClientRects()[0])?{left:s.left,right:s.left+fb(b.display),top:s.top,bottom:s.bottom}:Sd;s=(e.bottom+e.top)/2-c.rect.top;t=c.view.measure.heights;for(d=0;d<t.length-1&&!(s<t[d]);d++);b=d?t[d-1]:0;s=t[d];f={left:("right"==f?e.right:e.left)-c.rect.left,right:("left"==f?e.left:e.right)-c.rect.left,top:b,bottom:s};f=(e.left||e.right||(f.bogus=
!0),f);f.bogus||(c.cache[g]=f)}return{left:f.left,right:f.right,top:f.top,bottom:f.bottom}}function sa(b){if(b.measure&&(b.measure.cache={},b.measure.heights=null,b.rest))for(var c=0;c<b.rest.length;c++)b.measure.caches[c]={}}function eb(b){b.display.externalMeasure=null;Oc(b.display.lineMeasure);for(var c=0;c<b.display.view.length;c++)sa(b.display.view[c])}function Xa(b){eb(b);b.display.cachedCharWidth=b.display.cachedTextHeight=b.display.cachedPaddingH=null;b.options.lineWrapping||(b.display.maxLineChanged=
!0);b.display.lineNumChars=null}function zb(b,c,e,d){if(c.widgets)for(var f=0;f<c.widgets.length;++f)if(c.widgets[f].above){var g=ce(c.widgets[f]);e.top+=g;e.bottom+=g}if("line"==d)return e;d||(d="local");c=vb(c);if("local"==d?c+=b.display.lineSpace.offsetTop:c-=b.display.viewOffset,"page"==d||"window"==d)b=b.display.lineSpace.getBoundingClientRect(),c+=b.top+("window"==d?0:window.pageYOffset||(document.documentElement||document.body).scrollTop),d=b.left+("window"==d?0:window.pageXOffset||(document.documentElement||
document.body).scrollLeft),e.left+=d,e.right+=d;return e.top+=c,e.bottom+=c,e}function Pa(b,c,e){if("div"==e)return c;var d=c.left;c=c.top;if("page"==e)d-=window.pageXOffset||(document.documentElement||document.body).scrollLeft,c-=window.pageYOffset||(document.documentElement||document.body).scrollTop;else if("local"==e||!e)e=b.display.sizer.getBoundingClientRect(),d+=e.left,c+=e.top;b=b.display.lineSpace.getBoundingClientRect();return{left:d-b.left,top:c-b.top}}function va(b,c,e,d,f){return d||(d=
pa(b.doc,c.line)),zb(b,d,Ha(b,Ra(b,d),c.ch,f),e)}function db(b,c,e,d,f){function g(c,h){var k=Ha(b,f,c,h?"right":"left");return h?k.left=k.right:k.right=k.left,zb(b,d,k,e)}function h(b,c){var e=k[c],d=e.level%2;return b==(e.level%2?e.to:e.from)&&c&&e.level<k[c-1].level?(e=k[--c],b=Xc(e)-(e.level%2?0:1),d=!0):b==Xc(e)&&c<k.length-1&&e.level<k[c+1].level&&(e=k[++c],b=(e.level%2?e.to:e.from)-e.level%2,d=!1),d&&b==e.to&&b>e.from?g(b-1):g(b,d)}d=d||pa(b.doc,c.line);f||(f=Ra(b,d));var k=ib(d);c=c.ch;if(!k)return g(c);
var l=Zb(k,c),l=h(c,l);return null!=Mc&&(l.other=h(c,Mc)),l}function Ib(b,c){var e=0;c=ca(b.doc,c);b.options.lineWrapping||(e=fb(b.display)*c.ch);var d=pa(b.doc,c.line),f=vb(d)+b.display.lineSpace.offsetTop;return{left:e,right:e,top:f,bottom:f+d.height}}function Va(b,c,e,d){b=ka(b,c);return b.xRel=d,e&&(b.outside=!0),b}function Ta(b,c,e){var d=b.doc;if(e+=b.display.viewOffset,0>e)return Va(d.first,0,!0,-1);var f=pb(d,e),g=d.first+d.size-1;if(f>g)return Va(d.first+d.size-1,pa(d,g).text.length,!0,1);
0>c&&(c=0);for(d=pa(d,f);;){f=Ka(b,d,f,c,e);g=(d=Pd(d,!1))&&d.find(0,!0);if(!d||!(f.ch>g.from.ch||f.ch==g.from.ch&&0<f.xRel))return f;f=qb(d=g.to.line)}}function Ka(b,c,e,d,f){function g(d){d=db(b,ka(e,d),"line",c,p);return k=!0,h>d.bottom?d.left-l:h<d.top?d.left+l:(k=!1,d.left)}var h=f-vb(c),k=!1,l=2*b.display.wrapper.clientWidth,p=Ra(b,c),q=ib(c),r=c.text.length;f=qd(c);var s=rd(c),t=g(f),u=k,v=g(s),w=k;if(d>v)return Va(e,s,w,1);for(;;){if(q?s==f||s==td(c,f,1):1>=s-f){q=t>d||v-d>=d-t?f:s;for(d-=
q==f?t:v;ad(c.text.charAt(q));)++q;return Va(e,q,q==f?u:w,-1>d?-1:1<d?1:0)}var y=Math.ceil(r/2),x=f+y;if(q)for(var x=f,z=0;y>z;++z)x=td(c,x,1);z=g(x);z>d?(s=x,v=z,(w=k)&&(v+=1E3),r=y):(f=x,t=z,u=k,r-=y)}}function bb(b){if(null!=b.cachedTextHeight)return b.cachedTextHeight;if(null==Ub){Ub=Ea("pre");for(var c=0;49>c;++c)Ub.appendChild(document.createTextNode("x")),Ub.appendChild(Ea("br"));Ub.appendChild(document.createTextNode("x"))}gb(b.measure,Ub);c=Ub.offsetHeight/50;return 3<c&&(b.cachedTextHeight=
c),Oc(b.measure),c||1}function fb(b){if(null!=b.cachedCharWidth)return b.cachedCharWidth;var c=Ea("span","xxxxxxxxxx"),e=Ea("pre",[c]);gb(b.measure,e);c=c.getBoundingClientRect();c=(c.right-c.left)/10;return 2<c&&(b.cachedCharWidth=c),c||10}function wa(b){b.curOp={viewChanged:!1,startHeight:b.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++Jd};Ae++||(Ld=[])}function oa(b){var c=
b.curOp,e=b.doc,d=b.display;if(b.curOp=null,c.updateMaxLine&&s(b),c.viewChanged||c.forceUpdate||null!=c.scrollTop||c.scrollToPos&&(c.scrollToPos.from.line<d.viewFrom||c.scrollToPos.to.line>=d.viewTo)||d.maxLineChanged&&b.options.lineWrapping){var f=B(b,{top:c.scrollTop,ensure:c.scrollToPos},c.forceUpdate);b.display.scroller.offsetHeight&&(b.doc.scrollTop=b.display.scroller.scrollTop)}if(!f&&c.selectionChanged&&T(b),f||c.startHeight==b.doc.height||v(b),null!=c.scrollTop&&d.scroller.scrollTop!=c.scrollTop)f=
Math.max(0,Math.min(d.scroller.scrollHeight-d.scroller.clientHeight,c.scrollTop)),d.scroller.scrollTop=d.scrollbarV.scrollTop=e.scrollTop=f;null!=c.scrollLeft&&d.scroller.scrollLeft!=c.scrollLeft&&(f=Math.max(0,Math.min(d.scroller.scrollWidth-d.scroller.clientWidth,c.scrollLeft)),d.scroller.scrollLeft=d.scrollbarH.scrollLeft=e.scrollLeft=f,y(b));if(c.scrollToPos){a:{e=ca(b.doc,c.scrollToPos.from);d=ca(b.doc,c.scrollToPos.to);f=c.scrollToPos.margin;for(null==f&&(f=0);;){var g=!1,h=db(b,e),k=d&&d!=
e?db(b,d):h,k=Ce(b,Math.min(h.left,k.left),Math.min(h.top,k.top)-f,Math.max(h.left,k.left),Math.max(h.bottom,k.bottom)+f),l=b.doc.scrollTop,p=b.doc.scrollLeft;if(null!=k.scrollTop&&(tc(b,k.scrollTop),1<Math.abs(b.doc.scrollTop-l)&&(g=!0)),null!=k.scrollLeft&&(uc(b,k.scrollLeft),1<Math.abs(b.doc.scrollLeft-p)&&(g=!0)),!g){e=h;break a}}e=void 0}if(c.scrollToPos.isCursor&&b.state.focused&&(d=e,f=b.display,g=f.sizer.getBoundingClientRect(),e=null,0>d.top+g.top?e=!0:d.bottom+g.top>(window.innerHeight||
document.documentElement.clientHeight)&&(e=!1),null!=e&&!nb))d=Ea("div","\u200b",null,"position: absolute; top: "+(d.top-f.viewOffset-b.display.lineSpace.offsetTop)+"px; height: "+(d.bottom-d.top+kd)+"px; left: "+d.left+"px; width: 2px;"),b.display.lineSpace.appendChild(d),d.scrollIntoView(e),b.display.lineSpace.removeChild(d)}c.selectionChanged&&ea(b);b.state.focused&&c.updateInput&&la(b,c.typing);e=c.maybeHiddenMarkers;d=c.maybeUnhiddenMarkers;if(e)for(f=0;f<e.length;++f)e[f].lines.length||lc(e[f],
"hide");if(d)for(f=0;f<d.length;++f)d[f].lines.length&&lc(d[f],"unhide");var q;if(--Ae||(q=Ld,Ld=null),c.changeObjs&&lc(b,"changes",b,c.changeObjs),q)for(f=0;f<q.length;++f)q[f]();if(c.cursorActivityHandlers)for(f=0;f<c.cursorActivityHandlers.length;f++)c.cursorActivityHandlers[f](b)}function Ia(b,c){if(b.curOp)return c();wa(b);try{return c()}finally{oa(b)}}function x(b,c){return function(){if(b.curOp)return c.apply(b,arguments);wa(b);try{return c.apply(b,arguments)}finally{oa(b)}}}function cb(b){return function(){if(this.curOp)return b.apply(this,
arguments);wa(this);try{return b.apply(this,arguments)}finally{oa(this)}}}function La(b){return function(){var c=this.cm;if(!c||c.curOp)return b.apply(this,arguments);wa(c);try{return b.apply(this,arguments)}finally{oa(c)}}}function jb(b,c,e){for(var d=this.line=c,f;d=Pd(d,!1);)d=d.find(1,!0).line,(f||(f=[])).push(d);this.size=(this.rest=f)?qb(ub(this.rest))-e+1:1;this.node=this.text=null;this.hidden=Qd(b,c)}function Ab(b,c,e){var d,f=[];for(d=c;e>d;)c=new jb(b.doc,pa(b.doc,d),d),d+=c.size,f.push(c);
return f}function ja(b,c,e,d){null==c&&(c=b.doc.first);null==e&&(e=b.doc.first+b.doc.size);d||(d=0);var f=b.display;if(d&&e<f.viewTo&&(null==f.updateLineNumbers||f.updateLineNumbers>c)&&(f.updateLineNumbers=c),b.curOp.viewChanged=!0,c>=f.viewTo)cd&&Ie(b.doc,c)<f.viewTo&&$a(b);else if(e<=f.viewFrom)cd&&Ye(b.doc,e+d)>f.viewFrom?$a(b):(f.viewFrom+=d,f.viewTo+=d);else if(c<=f.viewFrom&&e>=f.viewTo)$a(b);else if(c<=f.viewFrom){var g=yb(b,e,e+d,1);g?(f.view=f.view.slice(g.index),f.viewFrom=g.lineN,f.viewTo+=
d):$a(b)}else if(e>=f.viewTo)(g=yb(b,c,c,-1))?(f.view=f.view.slice(0,g.index),f.viewTo=g.lineN):$a(b);else{var g=yb(b,c,c,-1),h=yb(b,e,e+d,1);g&&h?(f.view=f.view.slice(0,g.index).concat(Ab(b,g.lineN,h.lineN)).concat(f.view.slice(h.index)),f.viewTo+=d):$a(b)}(b=f.externalMeasured)&&(e<b.lineN?b.lineN+=d:c<b.lineN+b.size&&(f.externalMeasured=null))}function Vb(b,c,e){b.curOp.viewChanged=!0;var d=b.display,f=b.display.externalMeasured;if(f&&c>=f.lineN&&c<f.lineN+f.size&&(d.externalMeasured=null),!(c<
d.viewFrom||c>=d.viewTo))b=d.view[za(b,c)],null!=b.node&&(b=b.changes||(b.changes=[]),-1==Nb(b,e)&&b.push(e))}function $a(b){b.display.viewFrom=b.display.viewTo=b.doc.first;b.display.view=[];b.display.viewOffset=0}function za(b,c){if(c>=b.display.viewTo||(c-=b.display.viewFrom,0>c))return null;for(var e=b.display.view,d=0;d<e.length;d++)if(c-=e[d].size,0>c)return d}function yb(b,c,e,d){var f=za(b,c),g=b.display.view;if(!cd)return{index:f,lineN:e};for(var h=0,k=b.display.viewFrom;f>h;h++)k+=g[h].size;
if(k!=c){if(0<d){if(f==g.length-1)return null;c=k+g[f].size-c;f++}else c=k-c;e+=c}for(;Ie(b.doc,e)!=e;){if(f==(0>d?0:g.length-1))return null;e+=d*g[f-(0>d?1:0)].size;f+=d}return{index:f,lineN:e}}function gc(b){b=b.display.view;for(var c=0,e=0;e<b.length;e++){var d=b[e];d.hidden||d.node&&!d.changes||++c}return c}function Jb(b){b.display.pollingFast||b.display.poll.set(b.options.pollInterval,function(){rc(b);b.state.focused&&Jb(b)})}function Fb(b){function c(){rc(b)||e?(b.display.pollingFast=!1,Jb(b)):
(e=!0,b.display.poll.set(60,c))}var e=!1;b.display.pollingFast=!0;b.display.poll.set(20,c)}function rc(b){var c=b.display.input,e=b.display.prevInput,d=b.doc;if(!b.state.focused||cc(c)&&!e||hc(b)||b.options.disableInput)return!1;b.state.pasteIncoming&&b.state.fakedLastChar&&(c.value=c.value.substring(0,c.value.length-1),b.state.fakedLastChar=!1);var f=c.value;if(f==e&&!b.somethingSelected())return!1;if($b&&!Xb&&b.display.inputHasSelection===f)return la(b),!1;var g=!b.curOp;g&&wa(b);b.display.shift=
!1;8203!=f.charCodeAt(0)||d.sel!=b.display.selForContextMenu||e||(e="\u200b");for(var h=0,k=Math.min(e.length,f.length);k>h&&e.charCodeAt(h)==f.charCodeAt(h);)++h;for(var k=f.slice(h),l=Fc(k),p=b.state.pasteIncoming&&1<l.length&&d.sel.ranges.length==l.length,q=d.sel.ranges.length-1;0<=q;q--){var r=d.sel.ranges[q],s=r.from(),t=r.to();h<e.length?s=ka(s.line,s.ch-(e.length-h)):b.state.overwrite&&r.empty()&&!b.state.pasteIncoming&&(t=ka(t.line,Math.min(pa(d,t.line).text.length,t.ch+ub(l).length)));var u=
b.curOp.updateInput,t={from:s,to:t,text:p?[l[q]]:l,origin:b.state.pasteIncoming?"paste":b.state.cutIncoming?"cut":"+input"};if(Zd(b.doc,t),ic(b,"inputRead",b,t),k&&!b.state.pasteIncoming&&b.options.electricChars&&b.options.smartIndent&&100>r.head.ch&&(!q||d.sel.ranges[q-1].head.line!=r.head.line))if(s=b.getModeAt(r.head),s.electricChars)for(t=0;t<s.electricChars.length;t++){if(-1<k.indexOf(s.electricChars.charAt(t))){qe(b,r.head.line,"smart");break}}else s.electricInput&&(t=qc(t),s.electricInput.test(pa(d,
t.line).text.slice(0,t.ch))&&qe(b,r.head.line,"smart"))}return ae(b),b.curOp.updateInput=u,b.curOp.typing=!0,1E3<f.length||-1<f.indexOf("\n")?c.value=b.display.prevInput="":b.display.prevInput=f,g&&oa(b),b.state.pasteIncoming=b.state.cutIncoming=!1,!0}function la(b,c){var e,d,f=b.doc;b.somethingSelected()?(b.display.prevInput="",e=f.sel.primary(),d=(e=Yb&&(100<e.to().line-e.from().line||1E3<(d=b.getSelection()).length))?"-":d||b.getSelection(),b.display.input.value=d,b.state.focused&&yd(b.display.input),
$b&&!Xb&&(b.display.inputHasSelection=d)):c||(b.display.prevInput=b.display.input.value="",$b&&!Xb&&(b.display.inputHasSelection=null));b.display.inaccurateSelection=e}function ob(b){"nocursor"==b.options.readOnly||Tb&&Pc()==b.display.input||b.display.input.focus()}function Bc(b){b.state.focused||(ob(b),Pb(b))}function hc(b){return b.options.readOnly||b.doc.cantEdit}function Gc(b){function c(){b.state.focused&&setTimeout(Cc(ob,b),0)}function e(c){dc(b,c)||kf(c)}function d(c){if(b.somethingSelected())f.inaccurateSelection&&
(f.prevInput="",f.inaccurateSelection=!1,f.input.value=b.getSelection(),yd(f.input));else{for(var e="",g=[],h=0;h<b.doc.sel.ranges.length;h++){var k=b.doc.sel.ranges[h].head.line,k={anchor:ka(k,0),head:ka(k+1,0)};g.push(k);e+=b.getRange(k.anchor,k.head)}"cut"==c.type?b.setSelections(g,null,Md):(f.prevInput="",f.input.value=e,yd(f.input))}"cut"==c.type&&(b.state.cutIncoming=!0)}var f=b.display;Za(f.scroller,"mousedown",x(b,Hc));Dc?Za(f.scroller,"dblclick",x(b,function(c){if(!dc(b,c)){var e=ga(b,c);
e&&(!Lb(b,c,"gutterClick",!0,ic)&&!oc(b.display,c))&&(Nc(c),c=Ve(b.doc,e),ba(b.doc,c.anchor,c.head))}})):Za(f.scroller,"dblclick",function(c){dc(b,c)||Nc(c)});Za(f.lineSpace,"selectstart",function(b){oc(f,b)||Nc(b)});Rd||Za(f.scroller,"contextmenu",function(c){oe(b,c)});Za(f.scroller,"scroll",function(){f.scroller.clientHeight&&(tc(b,f.scroller.scrollTop),uc(b,f.scroller.scrollLeft,!0),lc(b,"scroll",b))});Za(f.scrollbarV,"scroll",function(){f.scroller.clientHeight&&tc(b,f.scrollbarV.scrollTop)});
Za(f.scrollbarH,"scroll",function(){f.scroller.clientHeight&&uc(b,f.scrollbarH.scrollLeft)});Za(f.scroller,"mousewheel",function(c){Bb(b,c)});Za(f.scroller,"DOMMouseScroll",function(c){Bb(b,c)});Za(f.scrollbarH,"mousedown",c);Za(f.scrollbarV,"mousedown",c);Za(f.wrapper,"scroll",function(){f.wrapper.scrollTop=f.wrapper.scrollLeft=0});Za(f.input,"keyup",x(b,fd));Za(f.input,"input",function(){$b&&!Xb&&b.display.inputHasSelection&&(b.display.inputHasSelection=null);Fb(b)});Za(f.input,"keydown",x(b,ed));
Za(f.input,"keypress",x(b,nc));Za(f.input,"focus",Cc(Pb,b));Za(f.input,"blur",Cc(gd,b));b.options.dragDrop&&(Za(f.scroller,"dragstart",function(c){var e=b;if($b&&(!e.state.draggingText||100>+new Date-pc))kf(c);else if(!dc(e,c)&&!oc(e.display,c)&&(c.dataTransfer.setData("Text",e.getSelection()),c.dataTransfer.setDragImage&&!fe)){var d=Ea("img",null,null,"position: fixed; left: 0; top: 0;");d.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";Vc&&(d.width=d.height=1,e.display.wrapper.appendChild(d),
d._top=d.offsetTop);c.dataTransfer.setDragImage(d,0,0);Vc&&d.parentNode.removeChild(d)}}),Za(f.scroller,"dragenter",e),Za(f.scroller,"dragover",e),Za(f.scroller,"drop",x(b,xc)));Za(f.scroller,"paste",function(c){oc(f,c)||(b.state.pasteIncoming=!0,ob(b),Fb(b))});Za(f.input,"paste",function(){if(ac&&!b.state.fakedLastChar&&!(200>new Date-b.state.lastMiddleDown)){var c=f.input.selectionStart,e=f.input.selectionEnd;f.input.value+="$";f.input.selectionStart=c;f.input.selectionEnd=e;b.state.fakedLastChar=
!0}b.state.pasteIncoming=!0;Fb(b)});Za(f.input,"cut",d);Za(f.input,"copy",d);ge&&Za(f.sizer,"mouseup",function(){Pc()==f.input&&f.input.blur();ob(b)})}function sc(b){var c=b.display;c.cachedCharWidth=c.cachedTextHeight=c.cachedPaddingH=null;b.setSize()}function oc(b,c){for(var e=c.target||c.srcElement;e!=b.wrapper;e=e.parentNode)if(!e||e.ignoreEvents||e.parentNode==b.sizer&&e!=b.mover)return!0}function ga(b,c,e,d){var f=b.display;if(!e&&(e=c.target||c.srcElement,e==f.scrollbarH||e==f.scrollbarV||
e==f.scrollbarFiller||e==f.gutterFiller))return null;var g,h,f=f.lineSpace.getBoundingClientRect();try{g=c.clientX-f.left,h=c.clientY-f.top}catch(k){return null}var l;c=Ta(b,g,h);if(d&&1==c.xRel&&(l=pa(b.doc,c.line).text).length==c.ch)d=dd(l,l.length,b.options.tabSize)-l.length,c=ka(c.line,Math.max(0,Math.round((g-Ua(b.display).left)/fb(b.display))-d));return c}function Hc(b){if(!dc(this,b)){var c=this.display;if(c.shift=b.shiftKey,oc(c,b))return ac||(c.scroller.draggable=!1,setTimeout(function(){c.scroller.draggable=
!0},100)),void 0;if(!Lb(this,b,"gutterClick",!0,ic)){var e=ga(this,b);switch(window.focus(),df(b)){case 1:e?Gb(this,b,e):(b.target||b.srcElement)==c.scroller&&Nc(b);break;case 2:ac&&(this.state.lastMiddleDown=+new Date);e&&ba(this.doc,e);setTimeout(Cc(ob,this),20);Nc(b);break;case 3:Rd&&oe(this,b)}}}}function Gb(b,c,e){setTimeout(Cc(Bc,b),0);var d,f=+new Date;Ic&&Ic.time>f-400&&0==ab(Ic.pos,e)?d="triple":rb&&rb.time>f-400&&0==ab(rb.pos,e)?(d="double",Ic={time:f,pos:e}):(d="single",rb={time:f,pos:e});
var f=b.doc.sel,g=kc?c.metaKey:c.ctrlKey;b.options.dragDrop&&wc&&!g&&!hc(b)&&"single"==d&&-1<f.contains(e)&&f.somethingSelected()?Kb(b,c,e):Qb(b,c,e,d,g)}function Kb(b,c,e){var d=b.display,f=x(b,function(g){ac&&(d.scroller.draggable=!1);b.state.draggingText=!1;Ad(document,"mouseup",f);Ad(d.scroller,"drop",f);10>Math.abs(c.clientX-g.clientX)+Math.abs(c.clientY-g.clientY)&&(Nc(g),ba(b.doc,e),ob(b),Dc&&!Xb&&setTimeout(function(){document.body.focus();ob(b)},20))});ac&&(d.scroller.draggable=!0);b.state.draggingText=
f;d.scroller.dragDrop&&d.scroller.dragDrop();Za(document,"mouseup",f);Za(d.scroller,"drop",f)}function Qb(b,c,e,d,f){function g(c){if(0!=ab(t,c))if(t=c,"rect"==d){var f=[],h=b.options.tabSize,k=dd(pa(p,e.line).text,e.ch,h),l=dd(pa(p,c.line).text,c.ch,h),u=Math.min(k,l),k=Math.max(k,l),l=Math.min(e.line,c.line);for(c=Math.min(b.lastLine(),Math.max(e.line,c.line));c>=l;l++){var v=pa(p,l).text,w=ef(v,u,h);u==k?f.push(new C(ka(l,w),ka(l,w))):v.length>w&&f.push(new C(ka(l,w),ka(l,ef(v,k,h))))}f.length||
f.push(new C(e,e));Y(p,Z(s.ranges.slice(0,r).concat(f),r),Wd)}else f=q,h=f.anchor,u=c,"single"!=d&&(c="double"==d?Ve(p,c):new C(ka(c.line,0),ca(p,ka(c.line+1,0))),0<ab(c.anchor,h)?(u=c.head,h=Q(f.from(),c.anchor)):(u=c.anchor,h=I(f.to(),c.head))),f=s.ranges.slice(0),f[r]=new C(ca(p,h),u),Y(p,Z(f,r),Wd)}function h(c){var e=++v,f=ga(b,c,!0,"rect"==d);if(f)if(0!=ab(f,t)){Bc(b);g(f);var k=w(l,p);(f.line>=k.to||f.line<k.from)&&setTimeout(x(b,function(){v==e&&h(c)}),150)}else{var q=c.clientY<u.top?-20:
c.clientY>u.bottom?20:0;q&&setTimeout(x(b,function(){v==e&&(l.scroller.scrollTop+=q,h(c))}),50)}}function k(c){v=1/0;Nc(c);ob(b);Ad(document,"mousemove",y);Ad(document,"mouseup",z);p.history.lastSelOrigin=null}var l=b.display,p=b.doc;Nc(c);var q,r,s=p.sel;(f&&!c.shiftKey?(r=p.sel.contains(e),q=-1<r?p.sel.ranges[r]:new C(e,e)):q=p.sel.primary(),c.altKey)?(d="rect",f||(q=new C(e,e)),e=ga(b,c,!0,!0),r=-1):"double"==d?(c=Ve(p,e),q=b.display.shift||p.extend?X(p,q,c.anchor,c.head):c):"triple"==d?(c=new C(ka(e.line,
0),ca(p,ka(e.line+1,0))),q=b.display.shift||p.extend?X(p,q,c.anchor,c.head):c):q=X(p,q,e);f?-1<r?S(p,r,q,Wd):(r=p.sel.ranges.length,Y(p,Z(p.sel.ranges.concat([q]),r),{scroll:!1,origin:"*mouse"})):(r=0,Y(p,new V([q],0),Wd),s=p.sel);var t=e,u=l.wrapper.getBoundingClientRect(),v=0,y=x(b,function(b){($b&&!Gd?b.buttons:df(b))?h(b):k(b)}),z=x(b,k);Za(document,"mousemove",y);Za(document,"mouseup",z)}function Lb(b,c,e,d,f){try{var g=c.clientX,h=c.clientY}catch(k){return!1}if(g>=Math.floor(b.display.gutters.getBoundingClientRect().right))return!1;
d&&Nc(c);d=b.display;var l=d.lineDiv.getBoundingClientRect();if(h>l.bottom||!Ya(b,e))return cf(c);h-=l.top-d.viewOffset;for(l=0;l<b.options.gutters.length;++l){var p=d.gutters.childNodes[l];if(p&&p.getBoundingClientRect().right>=g)return g=pb(b.doc,h),f(b,e,b,g,b.options.gutters[l],c),cf(c)}}function xc(b){var c=this;if(!dc(c,b)&&!oc(c.display,b)){Nc(b);$b&&(pc=+new Date);var e=ga(c,b,!0),d=b.dataTransfer.files;if(e&&!hc(c))if(d&&d.length&&window.FileReader&&window.File){var f=d.length,g=Array(f),
h=0;b=function(b,d){var k=new FileReader;k.onload=x(c,function(){if(g[d]=k.result,++h==f){e=ca(c.doc,e);var b={from:e,to:e,text:Fc(g.join("\n")),origin:"paste"};Zd(c.doc,b);ra(c.doc,N(e,qc(b)))}});k.readAsText(b)};for(var k=0;f>k;++k)b(d[k],k)}else{if(c.state.draggingText&&-1<c.doc.sel.contains(e))return c.state.draggingText(b),setTimeout(Cc(ob,c),20),void 0;try{if(g=b.dataTransfer.getData("Text")){var l=c.state.draggingText&&c.listSelections();if(ta(c.doc,N(e,e)),l)for(k=0;k<l.length;++k)Be(c.doc,
"",l[k].anchor,l[k].head,"drag");c.replaceSelection(g,"around","paste");ob(c)}}catch(p){}}}}function tc(b,c){2>Math.abs(b.doc.scrollTop-c)||(b.doc.scrollTop=c,Uc||B(b,{top:c}),b.display.scroller.scrollTop!=c&&(b.display.scroller.scrollTop=c),b.display.scrollbarV.scrollTop!=c&&(b.display.scrollbarV.scrollTop=c),Uc&&B(b),xa(b,100))}function uc(b,c,e){(e?c==b.doc.scrollLeft:2>Math.abs(b.doc.scrollLeft-c))||(c=Math.min(c,b.display.scroller.scrollWidth-b.display.scroller.clientWidth),b.doc.scrollLeft=
c,y(b),b.display.scroller.scrollLeft!=c&&(b.display.scroller.scrollLeft=c),b.display.scrollbarH.scrollLeft!=c&&(b.display.scrollbarH.scrollLeft=c))}function Bb(b,c){var e=c.wheelDeltaX,d=c.wheelDeltaY;null==e&&c.detail&&c.axis==c.HORIZONTAL_AXIS&&(e=c.detail);null==d&&c.detail&&c.axis==c.VERTICAL_AXIS?d=c.detail:null==d&&(d=c.wheelDelta);var f=b.display,g=f.scroller;if(e&&g.scrollWidth>g.clientWidth||d&&g.scrollHeight>g.clientHeight){if(d&&kc&&ac){var h=c.target,k=f.view;a:for(;h!=g;h=h.parentNode)for(var l=
0;l<k.length;l++)if(k[l].node==h){b.display.currentWheelTarget=h;break a}}if(e&&!Uc&&!Vc&&null!=bc)return d&&tc(b,Math.max(0,Math.min(g.scrollTop+d*bc,g.scrollHeight-g.clientHeight))),uc(b,Math.max(0,Math.min(g.scrollLeft+e*bc,g.scrollWidth-g.clientWidth))),Nc(c),f.wheelStartX=null,void 0;d&&null!=bc&&(h=d*bc,k=b.doc.scrollTop,l=k+f.wrapper.clientHeight,0>h?k=Math.max(0,k+h-50):l=Math.min(b.doc.height,l+h+50),B(b,{top:k,bottom:l}));20>Jc&&(null==f.wheelStartX?(f.wheelStartX=g.scrollLeft,f.wheelStartY=
g.scrollTop,f.wheelDX=e,f.wheelDY=d,setTimeout(function(){if(null!=f.wheelStartX){var b=g.scrollLeft-f.wheelStartX,c=g.scrollTop-f.wheelStartY,b=c&&f.wheelDY&&c/f.wheelDY||b&&f.wheelDX&&b/f.wheelDX;f.wheelStartX=f.wheelStartY=null;b&&(bc=(bc*Jc+b)/(Jc+1),++Jc)}},200)):(f.wheelDX+=e,f.wheelDY+=d))}}function hd(b,c,e){if("string"==typeof c&&(c=zc[c],!c))return!1;b.display.pollingFast&&rc(b)&&(b.display.pollingFast=!1);var d=b.display.shift,f=!1;try{hc(b)&&(b.state.suppressEdits=!0),e&&(b.display.shift=
!1),f=c(b)!=Ud}finally{b.display.shift=d,b.state.suppressEdits=!1}return f}function mc(b){var c=b.state.keyMaps.slice(0);return b.options.extraKeys&&c.push(b.options.extraKeys),c.push(b.options.keyMap),c}function Rb(b,c){var e=We(b.options.keyMap),d=e.auto;clearTimeout(Ma);d&&!vc(c)&&(Ma=setTimeout(function(){We(b.options.keyMap)==e&&(b.options.keyMap=d.call?d.call(null,b):d,h(b))},50));var f=lb(c,!0),g=!1;if(!f)return!1;var k=mc(b);return g=c.shiftKey?ua("Shift-"+f,k,function(c){return hd(b,c,!0)})||
ua(f,k,function(c){return("string"==typeof c?/^go[A-Z]/.test(c):c.motion)?hd(b,c):void 0}):ua(f,k,function(c){return hd(b,c)}),g&&(Nc(c),ea(b),ic(b,"keyHandled",b,f,c)),g}function ld(b,c,e){var d=ua("'"+e+"'",mc(b),function(c){return hd(b,c,!0)});return d&&(Nc(c),ea(b),ic(b,"keyHandled",b,"'"+e+"'",c)),d}function ed(b){if(Bc(this),!dc(this,b)){Dc&&27==b.keyCode&&(b.returnValue=!1);var c=b.keyCode;this.display.shift=16==c||b.shiftKey;var e=Rb(this,b);Vc&&(yc=e?c:null,!e&&88==c&&!Yb&&(kc?b.metaKey:
b.ctrlKey)&&this.replaceSelection("",null,"cut"));18!=c||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||md(this)}}function md(b){function c(b){18!=b.keyCode&&b.altKey||(id(e,"CodeMirror-crosshair"),Ad(document,"keyup",c),Ad(document,"mouseover",c))}var e=b.display.lineDiv;Ed(e,"CodeMirror-crosshair");Za(document,"keyup",c);Za(document,"mouseover",c)}function fd(b){dc(this,b)||16==b.keyCode&&(this.doc.sel.shift=!1)}function nc(b){if(!dc(this,b)){var c=b.keyCode,e=b.charCode;if(Vc&&
c==yc)return yc=null,Nc(b),void 0;if(!(Vc&&(!b.which||10>b.which)||ge)||!Rb(this,b))c=String.fromCharCode(null==e?c:e),ld(this,b,c)||($b&&!Xb&&(this.display.inputHasSelection=null),Fb(this))}}function Pb(b){"nocursor"!=b.options.readOnly&&(b.state.focused||(lc(b,"focus",b),b.state.focused=!0,Ed(b.display.wrapper,"CodeMirror-focused"),b.curOp||b.display.selForContextMenu==b.doc.sel||(la(b),ac&&setTimeout(Cc(la,b,!0),0))),Jb(b),ea(b))}function gd(b){b.state.focused&&(lc(b,"blur",b),b.state.focused=
!1,id(b.display.wrapper,"CodeMirror-focused"));clearInterval(b.display.blinker);setTimeout(function(){b.state.focused||(b.display.shift=!1)},150)}function oe(b,c){function e(){if(null!=f.input.selectionStart){var c=b.somethingSelected(),d=f.input.value="\u200b"+(c?f.input.value:"");f.prevInput=c?"":"\u200b";f.input.selectionStart=1;f.input.selectionEnd=d.length}}function d(){if(f.inputDiv.style.position="relative",f.input.style.cssText=k,Xb&&(f.scrollbarV.scrollTop=f.scroller.scrollTop=h),Jb(b),null!=
f.input.selectionStart){(!$b||Xb)&&e();var c=0,g=function(){f.selForContextMenu==b.doc.sel&&0==f.input.selectionStart?x(b,zc.selectAll)(b):10>c++?f.detectingSelectAll=setTimeout(g,500):la(b)};f.detectingSelectAll=setTimeout(g,200)}}if(!dc(b,c,"contextmenu")){var f=b.display;if(!oc(f,c)&&(!Ya(b,"gutterContextMenu")||!Lb(b,c,"gutterContextMenu",!1,lc))){var g=ga(b,c),h=f.scroller.scrollTop;if(g&&!Vc){b.options.resetSelectionOnContextMenu&&-1==b.doc.sel.contains(g)&&x(b,Y)(b.doc,N(g),Md);var k=f.input.style.cssText;
if(f.inputDiv.style.position="absolute",f.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(c.clientY-5)+"px; left: "+(c.clientX-5)+"px; z-index: 1000; background: "+($b?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",ob(b),la(b),b.somethingSelected()||(f.input.value=f.prevInput=" "),f.selForContextMenu=b.doc.sel,clearTimeout(f.detectingSelectAll),$b&&!Xb&&e(),Rd){kf(c);var l=
function(){Ad(window,"mouseup",l);setTimeout(d,20)};Za(window,"mouseup",l)}else setTimeout(d,50)}}}}function qa(b,c){if(0>ab(b,c.from))return b;if(0>=ab(b,c.to))return qc(c);var e=b.line+c.text.length-(c.to.line-c.from.line)-1,d=b.ch;return b.line==c.to.line&&(d+=qc(c).ch-c.to.ch),ka(e,d)}function da(b,c){for(var e=[],d=0;d<b.sel.ranges.length;d++){var f=b.sel.ranges[d];e.push(new C(qa(f.anchor,c),qa(f.head,c)))}return Z(e,b.sel.primIndex)}function Yd(b,c,e){return b.line==c.line?ka(e.line,b.ch-c.ch+
e.ch):ka(e.line+(b.line-c.line),b.ch)}function mf(b,c,e){c={canceled:!1,from:c.from,to:c.to,text:c.text,origin:c.origin,cancel:function(){this.canceled=!0}};return e&&(c.update=function(c,e,d,f){c&&(this.from=ca(b,c));e&&(this.to=ca(b,e));d&&(this.text=d);void 0!==f&&(this.origin=f)}),lc(b,"beforeChange",b,c),b.cm&&lc(b.cm,"beforeChange",b.cm,c),c.canceled?null:{from:c.from,to:c.to,text:c.text,origin:c.origin}}function Zd(b,c,e){if(b.cm){if(!b.cm.curOp)return x(b.cm,Zd)(b,c,e);if(b.cm.state.suppressEdits)return}if(!(Ya(b,
"beforeChange")||b.cm&&Ya(b.cm,"beforeChange"))||(c=mf(b,c,!0)))if(e=Id&&!e&&If(b,c.from,c.to))for(var d=e.length-1;0<=d;--d)Od(b,{from:e[d].from,to:e[d].to,text:d?[""]:c.text});else Od(b,c)}function Od(b,c){if(1!=c.text.length||""!=c.text[0]||0!=ab(c.from,c.to)){var e=da(b,c);Oe(b,c,e,b.cm?b.cm.curOp.id:0/0);$d(b,c,e,Ge(b,c));var d=[];Sa(b,function(b,e){e||-1!=Nb(d,b.history)||(yf(b.history,c),d.push(b.history));$d(b,c,null,Ge(b,c))})}}function W(b,c,e){if(!b.cm||!b.cm.state.suppressEdits){for(var d,
f=b.history,g=b.sel,h="undo"==c?f.done:f.undone,k="undo"==c?f.undone:f.done,l=0;l<h.length&&(d=h[l],e?!d.ranges||d.equals(b.sel):d.ranges);l++);if(l!=h.length){for(f.lastOrigin=f.lastSelOrigin=null;d=h.pop(),d.ranges;){if(J(d,k),e&&!d.equals(b.sel))return Y(b,d,{clearRedo:!1}),void 0;g=d}e=[];J(g,k);k.push({changes:e,generation:f.generation});f.generation=d.generation||++f.maxGeneration;f=Ya(b,"beforeChange")||b.cm&&Ya(b.cm,"beforeChange");for(l=d.changes.length-1;0<=l;--l){var p=d.changes[l];if(p.origin=
c,f&&!mf(b,p,!1))return h.length=0,void 0;e.push(ve(b,p));g=l?da(b,p,null):ub(h);$d(b,p,g,be(b,p));!l&&b.cm&&b.cm.scrollIntoView(p);var q=[];Sa(b,function(b,c){c||-1!=Nb(q,b.history)||(yf(b.history,p),q.push(b.history));$d(b,p,null,be(b,p))})}}}}function Te(b,c){if(0!=c&&(b.first+=c,b.sel=new V(Cd(b.sel.ranges,function(b){return new C(ka(b.anchor.line+c,b.anchor.ch),ka(b.head.line+c,b.head.ch))}),b.sel.primIndex),b.cm)){ja(b.cm,b.first,b.first-c,c);for(var e=b.cm.display,d=e.viewFrom;d<e.viewTo;d++)Vb(b.cm,
d,"gutter")}}function $d(b,c,e,d){if(b.cm&&!b.cm.curOp)return x(b.cm,$d)(b,c,e,d);if(c.to.line<b.first)return Te(b,c.text.length-1-(c.to.line-c.from.line)),void 0;if(!(c.from.line>b.lastLine())){if(c.from.line<b.first){var f=c.text.length-1-(b.first-c.from.line);Te(b,f);c={from:ka(b.first,0),to:ka(c.to.line+f,c.to.ch),text:[ub(c.text)],origin:c.origin}}f=b.lastLine();c.to.line>f&&(c={from:c.from,to:ka(f,pa(b,f).text.length),text:[c.text[0]],origin:c.origin});c.removed=Cb(b,c.from,c.to);e||(e=da(b,
c,null));b.cm?Gf(b.cm,c,d):Me(b,c,d);ta(b,e,Md)}}function Gf(b,c,e){var d=b.doc,g=b.display,h=c.from,k=c.to,l=!1,p=h.line;b.options.lineWrapping||(p=qb(Zc(pa(d,h.line))),d.iter(p,k.line+1,function(b){return b==g.maxLine?(l=!0,!0):void 0}));-1<d.sel.contains(c.from,c.to)&&kb(b);Me(d,c,e,f(b));b.options.lineWrapping||(d.iter(p,h.line+c.text.length,function(b){var c=r(b);c>g.maxLineLength&&(g.maxLine=b,g.maxLineLength=c,g.maxLineChanged=!0,l=!1)}),l&&(b.curOp.updateMaxLine=!0));d.frontier=Math.min(d.frontier,
h.line);xa(b,400);e=c.text.length-(k.line-h.line)-1;h.line!=k.line||1!=c.text.length||sb(b.doc,c)?ja(b,h.line,k.line+1,e):Vb(b,h.line,"text");e=Ya(b,"changes");if((d=Ya(b,"change"))||e)c={from:h,to:k,text:c.text,removed:c.removed,origin:c.origin},d&&ic(b,"change",b,c),e&&(b.curOp.changeObjs||(b.curOp.changeObjs=[])).push(c);b.display.selForContextMenu=null}function Be(b,c,e,d,f){if(d||(d=e),0>ab(d,e)){var g=d;d=e;e=g}"string"==typeof c&&(c=Fc(c));Zd(b,{from:e,to:d,text:c,origin:f})}function Ce(b,
c,e,d,f){var g=b.display,h=bb(b.display);0>e&&(e=0);var k=b.curOp&&null!=b.curOp.scrollTop?b.curOp.scrollTop:g.scroller.scrollTop,l=g.scroller.clientHeight-kd,p={},q=b.doc.height+(g.mover.offsetHeight-g.lineSpace.offsetHeight),r=h>e,h=f>q-h;k>e?p.scrollTop=r?0:e:f>k+l&&(e=Math.min(e,(h?q:f)-l),e!=k&&(p.scrollTop=e));b=b.curOp&&null!=b.curOp.scrollLeft?b.curOp.scrollLeft:g.scroller.scrollLeft;k=g.scroller.clientWidth-kd;c+=g.gutters.offsetWidth;d+=g.gutters.offsetWidth;g=g.gutters.offsetWidth;e=g+
10>c;return b+g>c||e?(e&&(c=0),p.scrollLeft=Math.max(0,c-10-g)):d>k+b-3&&(p.scrollLeft=d+10-k),p}function pe(b,c,e){(null!=c||null!=e)&&De(b);null!=c&&(b.curOp.scrollLeft=(null==b.curOp.scrollLeft?b.doc.scrollLeft:b.curOp.scrollLeft)+c);null!=e&&(b.curOp.scrollTop=(null==b.curOp.scrollTop?b.doc.scrollTop:b.curOp.scrollTop)+e)}function ae(b){De(b);var c=b.getCursor(),e=c,d=c;b.options.lineWrapping||(e=c.ch?ka(c.line,c.ch-1):c,d=ka(c.line,c.ch+1));b.curOp.scrollToPos={from:e,to:d,margin:b.options.cursorScrollMargin,
isCursor:!0}}function De(b){var c=b.curOp.scrollToPos;if(c){b.curOp.scrollToPos=null;var e=Ib(b,c.from),d=Ib(b,c.to),c=Ce(b,Math.min(e.left,d.left),Math.min(e.top,d.top)-c.margin,Math.max(e.right,d.right),Math.max(e.bottom,d.bottom)+c.margin);b.scrollTo(c.scrollLeft,c.scrollTop)}}function qe(b,c,e,d){var f,g=b.doc;null==e&&(e="add");"smart"==e&&(b.doc.mode.indent?f=Ba(b,c):e="prev");var h=b.options.tabSize,k=pa(g,c),l=dd(k.text,null,h);k.stateAfter&&(k.stateAfter=null);var p,q=k.text.match(/^\s*/)[0];
if(d||/\S/.test(k.text)){if("smart"==e&&(p=b.doc.mode.indent(f,k.text.slice(q.length),k.text),p==Ud)){if(!d)return;e="prev"}}else p=0,e="not";"prev"==e?p=c>g.first?dd(pa(g,c-1).text,null,h):0:"add"==e?p=l+b.options.indentUnit:"subtract"==e?p=l-b.options.indentUnit:"number"==typeof e&&(p=l+e);p=Math.max(0,p);d="";f=0;if(b.options.indentWithTabs)for(e=Math.floor(p/h);e;--e)f+=h,d+="\t";if(p>f&&(d+=Af(p-f)),d!=q)Be(b.doc,d,ka(c,0),ka(c,q.length),"+input");else for(e=0;e<g.sel.ranges.length;e++)if(b=
g.sel.ranges[e],b.head.line==c&&b.head.ch<q.length){f=ka(c,q.length);S(g,e,new C(f,f));break}k.stateAfter=null}function Ee(b,c,e,d){var f=c,g=c,h=b.doc;return"number"==typeof c?g=pa(h,Math.max(h.first,Math.min(c,h.first+h.size-1))):f=qb(c),null==f?null:(d(g,f)&&Vb(b,f,e),g)}function re(b,c){for(var e=b.doc.sel.ranges,d=[],f=0;f<e.length;f++){for(var g=c(e[f]);d.length&&0>=ab(g.from,ub(d).to);){var h=d.pop();if(0>ab(h.from,g.from)){g.from=h.from;break}}d.push(g)}Ia(b,function(){for(var c=d.length-
1;0<=c;c--)Be(b.doc,"",d[c].from,d[c].to,"+delete");ae(b)})}function Ue(b,c,e,d,f){function g(c){var d=(f?td:ee)(l,k,e,!0);if(null==d){c||(c=h+e,c=!(c<b.first||c>=b.first+b.size?p=!1:(h=c,l=pa(b,c))));if(c)return p=!1;k=f?(0>e?rd:qd)(l):0>e?l.text.length:0}else k=d;return!0}var h=c.line,k=c.ch;c=e;var l=pa(b,h),p=!0;if("char"==d)g();else if("column"==d)g(!0);else if("word"==d||"group"==d){var q=null;d="group"==d;for(var r=!0;!(0>e)||g(!r);r=!1){var s=l.text.charAt(k)||"\n",s=Qe(s)?"w":d&&"\n"==s?
"n":!d||/\s/.test(s)?null:"p";if(!d||r||s||(s="s"),q&&q!=s){0>e&&(e=1,g());break}if(s&&(q=s),0<e&&!g(!r))break}}c=fa(b,ka(h,k),c,!0);return p||(c.hitSide=!0),c}function nf(b,c,e,d){var f,g=b.doc,h=c.left;"page"==d?(d=Math.min(b.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),f=c.top+e*(d-(0>e?1.5:0.5)*bb(b.display))):"line"==d&&(f=0<e?c.bottom+3:c.top-3);for(;;){var k=Ta(b,h,f);if(!k.outside)break;if(0>e?0>=f:f>=g.height){k.hitSide=!0;break}f+=5*e}return k}
function Ve(b,c){var e=pa(b,c.line).text,d=c.ch,f=c.ch;if(e){(0>c.xRel||f==e.length)&&d?--d:++f;for(var g=e.charAt(d),g=Qe(g)?Qe:/\s/.test(g)?function(b){return/\s/.test(b)}:function(b){return!/\s/.test(b)&&!Qe(b)};0<d&&g(e.charAt(d-1));)--d;for(;f<e.length&&g(e.charAt(f));)++f}return new C(ka(c.line,d),ka(c.line,f))}function hb(c,e,d,f){b.defaults[c]=e;d&&(Yc[c]=f?function(b,c,e){e!=wd&&d(b,c,e)}:d)}function We(b){return"string"==typeof b?Ac[b]:b}function Bd(b,c,e,d,f){if(d&&d.shared)return Xe(b,
c,e,d,f);if(b.cm&&!b.cm.curOp)return x(b.cm,Bd)(b,c,e,d,f);var g=new Ob(b,f);f=ab(c,e);if(d&&jc(d,g,!1),0<f||0==f&&!1!==g.clearWhenEmpty)return g;if(g.replacedWith&&(g.collapsed=!0,g.widgetNode=Ea("span",[g.replacedWith],"CodeMirror-widget"),d.handleMouseEvents||(g.widgetNode.ignoreEvents=!0),d.insertLeft&&(g.widgetNode.insertLeft=!0)),g.collapsed){if(He(b,c.line,c,e,g)||c.line!=e.line&&He(b,e.line,c,e,g))throw Error("Inserting collapsed marker partially overlapping an existing one");cd=!0}g.addToHistory&&
Oe(b,{from:c,to:e,origin:"markText"},b.sel,0/0);var h,k=c.line,l=b.cm;if(b.iter(k,e.line+1,function(b){l&&g.collapsed&&!l.options.lineWrapping&&Zc(b)==l.display.maxLine&&(h=!0);g.collapsed&&k!=c.line&&$c(b,0);var d=new Fe(g,k==c.line?c.ch:null,k==e.line?e.ch:null);b.markedSpans=b.markedSpans?b.markedSpans.concat([d]):[d];d.marker.attachLine(b);++k}),g.collapsed&&b.iter(c.line,e.line+1,function(c){Qd(b,c)&&$c(c,0)}),g.clearOnEnter&&Za(g,"beforeCursorEnter",function(){g.clear()}),g.readOnly&&(Id=!0,
(b.history.done.length||b.history.undone.length)&&b.clearHistory()),g.collapsed&&(g.id=++Df,g.atomic=!0),l){if(h&&(l.curOp.updateMaxLine=!0),g.collapsed)ja(l,c.line,e.line+1);else if(g.className||g.title||g.startStyle||g.endStyle)for(d=c.line;d<=e.line;d++)Vb(l,d,"text");g.atomic&&Qa(l.doc);ic(l,"markerAdded",l,g)}return g}function Xe(b,c,e,d,f){d=jc(d);d.shared=!1;var g=[Bd(b,c,e,d,f)],h=g[0],k=d.widgetNode;return Sa(b,function(b){k&&(d.widgetNode=k.cloneNode(!0));g.push(Bd(b,ca(b,c),ca(b,e),d,f));
for(var l=0;l<b.linked.length;++l)if(b.linked[l].isParent)return;h=ub(g)}),new Vd(g,h)}function of(b){return b.findMarks(ka(b.first,0),b.clipPos(ka(b.lastLine())),function(b){return b.parent})}function Hf(b){for(var c=0;c<b.length;c++){var e=b[c],d=[e.primary.doc];Sa(e.primary.doc,function(b){d.push(b)});for(var f=0;f<e.markers.length;f++){var g=e.markers[f];-1==Nb(d,g.doc)&&(g.parent=null,e.markers.splice(f--,1))}}}function Fe(b,c,e){this.marker=b;this.from=c;this.to=e}function se(b,c){if(b)for(var e=
0;e<b.length;++e){var d=b[e];if(d.marker==c)return d}}function Ge(b,c){var e=R(b,c.from.line)&&pa(b,c.from.line).markedSpans,d=R(b,c.to.line)&&pa(b,c.to.line).markedSpans;if(!e&&!d)return null;var f=c.from.ch,g=c.to.ch,h=0==ab(c.from,c.to);if(e)for(var k,l=0;l<e.length;++l){var p=e[l],q=p.marker;if(null==p.from||(q.inclusiveLeft?p.from<=f:p.from<f)||p.from==f&&"bookmark"==q.type&&(!h||!p.marker.insertLeft)){var r=null==p.to||(q.inclusiveRight?p.to>=f:p.to>f);(k||(k=[])).push(new Fe(q,p.from,r?null:
p.to))}}e=k;if(d){var s;for(k=0;k<d.length;++k)if(l=d[k],p=l.marker,null==l.to||(p.inclusiveRight?l.to>=g:l.to>g)||l.from==g&&"bookmark"==p.type&&(!h||l.marker.insertLeft))q=null==l.from||(p.inclusiveLeft?l.from<=g:l.from<g),(s||(s=[])).push(new Fe(p,q?null:l.from-g,null==l.to?null:l.to-g))}d=s;h=1==c.text.length;s=ub(c.text).length+(h?f:0);if(e)for(g=0;g<e.length;++g)k=e[g],null==k.to&&((l=se(d,k.marker))?h&&(k.to=null==l.to?null:l.to+s):k.to=f);if(d)for(g=0;g<d.length;++g)k=d[g],(null!=k.to&&(k.to+=
s),null==k.from)?(l=se(e,k.marker))||(k.from=s,h&&(e||(e=[])).push(k)):(k.from+=s,h&&(e||(e=[])).push(k));e&&(e=pf(e));d&&d!=e&&(d=pf(d));f=[e];if(!h){var t,h=c.text.length-2;if(0<h&&e)for(g=0;g<e.length;++g)null==e[g].to&&(t||(t=[])).push(new Fe(e[g].marker,null,null));for(g=0;h>g;++g)f.push(t);f.push(d)}return f}function pf(b){for(var c=0;c<b.length;++c){var e=b[c];null!=e.from&&e.from==e.to&&!1!==e.marker.clearWhenEmpty&&b.splice(c--,1)}return b.length?b:null}function be(b,c){var e;if(e=c["spans_"+
b.id]){for(var d=0,f=[];d<c.text.length;++d)f.push(Lf(e[d]));e=f}else e=null;d=Ge(b,c);if(!e)return d;if(!d)return e;for(f=0;f<e.length;++f){var g=e[f],h=d[f];if(g&&h){var k=0;a:for(;k<h.length;++k){for(var l=h[k],p=0;p<g.length;++p)if(g[p].marker==l.marker)continue a;g.push(l)}}else h&&(e[f]=h)}return e}function If(b,c,e){var d=null;if(b.iter(c.line,e.line+1,function(b){if(b.markedSpans)for(var c=0;c<b.markedSpans.length;++c){var e=b.markedSpans[c].marker;!e.readOnly||d&&-1!=Nb(d,e)||(d||(d=[])).push(e)}}),
!d)return null;b=[{from:c,to:e}];for(c=0;c<d.length;++c){e=d[c];for(var f=e.find(0),g=0;g<b.length;++g){var h=b[g];if(!(0>ab(h.to,f.from)||0<ab(h.from,f.to))){var k=[g,1],l=ab(h.from,f.from),p=ab(h.to,f.to);(0>l||!e.inclusiveLeft&&!l)&&k.push({from:h.from,to:f.from});(0<p||!e.inclusiveRight&&!p)&&k.push({from:f.to,to:h.to});b.splice.apply(b,k);g+=k.length-1}}}return b}function qf(b){var c=b.markedSpans;if(c){for(var e=0;e<c.length;++e)c[e].marker.detachLine(b);b.markedSpans=null}}function rf(b,c){if(c){for(var e=
0;e<c.length;++e)c[e].marker.attachLine(b);b.markedSpans=c}}function sf(b,c){var e=b.lines.length-c.lines.length;if(0!=e)return e;var e=b.find(),d=c.find(),f=ab(e.from,d.from)||(b.inclusiveLeft?-1:0)-(c.inclusiveLeft?-1:0);return f?-f:(e=ab(e.to,d.to)||(b.inclusiveRight?1:0)-(c.inclusiveRight?1:0))?e:c.id-b.id}function Pd(b,c){var e,d=cd&&b.markedSpans;if(d)for(var f,g=0;g<d.length;++g)f=d[g],f.marker.collapsed&&null==(c?f.from:f.to)&&(!e||0>sf(e,f.marker))&&(e=f.marker);return e}function He(b,c,
e,d,f){b=pa(b,c);if(b=cd&&b.markedSpans)for(c=0;c<b.length;++c){var g=b[c];if(g.marker.collapsed){var h=g.marker.find(0),k=ab(h.from,e)||(g.marker.inclusiveLeft?-1:0)-(f.inclusiveLeft?-1:0),l=ab(h.to,d)||(g.marker.inclusiveRight?1:0)-(f.inclusiveRight?1:0);if(!(0<=k&&0>=l||0>=k&&0<=l)&&(0>=k&&0<(ab(h.to,e)||(g.marker.inclusiveRight?1:0)-(f.inclusiveLeft?-1:0))||0<=k&&0>(ab(h.from,d)||(g.marker.inclusiveLeft?-1:0)-(f.inclusiveRight?1:0))))return!0}}}function Zc(b){for(var c;c=Pd(b,!0);)b=c.find(-1,
!0).line;return b}function Ie(b,c){var e=pa(b,c),d=Zc(e);return e==d?c:qb(d)}function Ye(b,c){if(c>b.lastLine())return c;var e,d=pa(b,c);if(!Qd(b,d))return c;for(;e=Pd(d,!1);)d=e.find(1,!0).line;return qb(d)+1}function Qd(b,c){var e=cd&&c.markedSpans;if(e)for(var d,f=0;f<e.length;++f)if(d=e[f],d.marker.collapsed)if(null==d.from||!d.marker.widgetNode&&0==d.from&&d.marker.inclusiveLeft&&Ze(b,c,d))return!0}function Ze(b,c,e){if(null==e.to)return c=e.marker.find(1,!0),Ze(b,c.line,se(c.line.markedSpans,
e.marker));if(e.marker.inclusiveRight&&e.to==c.text.length)return!0;for(var d,f=0;f<c.markedSpans.length;++f)if(d=c.markedSpans[f],d.marker.collapsed&&!d.marker.widgetNode&&d.from==e.to&&(null==d.to||d.to!=e.from)&&(d.marker.inclusiveLeft||e.marker.inclusiveRight)&&Ze(b,c,d))return!0}function ce(b){if(null!=b.height)b=b.height;else{var c;a:{c=document.body;var e=b.node;if(c.contains)c=c.contains(e);else{for(;e=e.parentNode;)if(e==c){c=!0;break a}c=void 0}}b=(c||gb(b.cm.display.measure,Ea("div",[b.node],
null,"position: relative")),b.height=b.node.offsetHeight)}return b}function tf(b,c,e,d){var f=new Td(b,e,d);return f.noHScroll&&(b.display.alignWidgets=!0),Ee(b,c,"widget",function(c){var e=c.widgets||(c.widgets=[]);if(null==f.insertAt?e.push(f):e.splice(Math.min(e.length-1,Math.max(0,f.insertAt)),0,f),f.line=c,!Qd(b.doc,c))e=vb(c)<b.doc.scrollTop,$c(c,c.height+ce(f)),e&&pe(b,null,f.height),b.curOp.forceUpdate=!0;return!0}),f}function uf(b,c){if(b)for(;;){var e=b.match(/(?:^|\s+)line-(background-)?(\S+)/);
if(!e)break;b=b.slice(0,e.index)+b.slice(e.index+e[0].length);var d=e[1]?"bgClass":"textClass";null==c[d]?c[d]=e[2]:RegExp("(?:^|s)"+e[2]+"(?:$|s)").test(c[d])||(c[d]+=" "+e[2])}return b}function vf(c,e){if(c.blankLine)return c.blankLine(e);if(c.innerMode){var d=b.innerMode(c,e);return d.mode.blankLine?d.mode.blankLine(d.state):void 0}}function Je(b,c,e){e=b.token(c,e);if(c.pos<=c.start)throw Error("Mode "+b.name+" failed to advance stream.");return e}function $e(c,e,d,f,g,h,k){var l=d.flattenSpans;
null==l&&(l=c.options.flattenSpans);var p,q=0,r=null,s=new Fa(e,c.options.tabSize);for(""==e&&uf(vf(d,f),h);!s.eol();){if(s.pos>c.options.maxHighlightLength?(l=!1,k&&te(c,e,f,s.pos),s.pos=e.length,p=null):p=uf(Je(d,s,f),h),c.options.addModeClass){var t=b.innerMode(d,f).mode.name;t&&(p="m-"+(p?t+" "+p:t))}l&&r==p||(q<s.start&&g(s.start,r),q=s.start,r=p);s.start=s.pos}for(;q<s.pos;)c=Math.min(s.pos,q+5E4),g(c,r),q=c}function af(b,c,e,d){var f=[b.state.modeGen],g={};$e(b,c.text,b.doc.mode,e,function(b,
c){f.push(b,c)},g,d);for(e=0;e<b.state.overlays.length;++e){var h=b.state.overlays[e],k=1,l=0;$e(b,c.text,h.mode,!0,function(b,c){for(var e=k;b>l;){var d=f[k];d>b&&f.splice(k,1,b,f[k+1],d);k+=2;l=Math.min(b,d)}if(c)if(h.opaque)f.splice(e,k-e,b,"cm-overlay "+c),k=e+2;else for(;k>e;e+=2)d=f[e+1],f[e+1]=(d?d+" ":"")+"cm-overlay "+c},g)}return{styles:f,classes:g.bgClass||g.textClass?g:null}}function Ke(b,c){if(!c.styles||c.styles[0]!=b.state.modeGen){var e=af(b,c,c.stateAfter=Ba(b,qb(c)));c.styles=e.styles;
e.classes?c.styleClasses=e.classes:c.styleClasses&&(c.styleClasses=null)}return c.styles}function te(b,c,e,d){var f=b.doc.mode,g=new Fa(c,b.options.tabSize);g.start=g.pos=d||0;for(""==c&&vf(f,e);!g.eol()&&g.pos<=b.options.maxHighlightLength;)Je(f,g,e),g.start=g.pos}function ue(b,c){if(!b||/^\s*$/.test(b))return null;var e=c.addModeClass?hf:Nf;return e[b]||(e[b]=b.replace(/\S+/g,"cm-$&"))}function wf(b,c){var e=Ea("span",null,null,ac?"padding-right: .1px":null),e={pre:Ea("pre",[e]),content:e,col:0,
pos:0,cm:b};c.measure={};for(var d=0;d<=(c.rest?c.rest.length:0);d++){var f,g=d?c.rest[d-1]:c.line;e.pos=0;e.addToken=Jf;($b||ac)&&b.getOption("lineWrapping")&&(e.addToken=Kf(e.addToken));var h;if(null!=Re)h=Re;else{h=gb(b.display.measure,document.createTextNode("A\u062eA"));var k=me(h,0,1).getBoundingClientRect();h=k.left==k.right?!1:Re=3>me(h,1,2).getBoundingClientRect().right-k.right}h&&(f=ib(g))&&(e.addToken=nd(e.addToken,f));e.map=[];a:{h=e;var k=Ke(b,g),l=g.markedSpans,p=g.text,q=0;if(l)for(var r=
void 0,s=void 0,t=void 0,u=void 0,v=void 0,w=void 0,y=p.length,x=0,z=1,da="",S=0;;){if(S==x){for(var s=t=u=v="",w=null,S=1/0,A=[],B=0;B<l.length;++B){var G=l[B],D=G.marker;G.from<=x&&(null==G.to||G.to>x)?(null!=G.to&&S>G.to&&(S=G.to,t=""),D.className&&(s+=" "+D.className),D.startStyle&&G.from==x&&(u+=" "+D.startStyle),D.endStyle&&G.to==S&&(t+=" "+D.endStyle),D.title&&!v&&(v=D.title),D.collapsed&&(!w||0>sf(w.marker,D))&&(w=G)):G.from>x&&S>G.from&&(S=G.from);"bookmark"==D.type&&G.from==x&&D.widgetNode&&
A.push(D)}if(w&&(w.from||0)==x&&(Le(h,(null==w.to?y+1:w.to)-x,w.marker,null==w.from),null==w.to))break a;if(!w&&A.length)for(B=0;B<A.length;++B)Le(h,0,A[B])}if(x>=y)break;for(A=Math.min(y,S);;){if(da){B=x+da.length;w||(G=B>A?da.slice(0,A-x):da,h.addToken(h,G,r?r+s:s,u,x+G.length==S?t:"",v));if(B>=A){da=da.slice(A-x);x=A;break}x=B;u=""}da=p.slice(q,q=k[z++]);r=ue(k[z++],h.cm.options)}}else for(z=1;z<k.length;z+=2)h.addToken(h,p.slice(q,q=k[z]),ue(k[z+1],h.cm.options))}g.styleClasses&&(g.styleClasses.bgClass&&
(e.bgClass=Hb(g.styleClasses.bgClass,e.bgClass||"")),g.styleClasses.textClass&&(e.textClass=Hb(g.styleClasses.textClass,e.textClass||"")));0==e.map.length&&e.map.push(0,0,e.content.appendChild(xe(b.display.measure)));0==d?(c.measure.map=e.map,c.measure.cache={}):((c.measure.maps||(c.measure.maps=[])).push(e.map),(c.measure.caches||(c.measure.caches=[])).push({}))}return lc(b,"renderLine",b,c.line,e.pre),e}function Jf(b,c,e,d,f,g){if(c){var h=b.cm.options.specialChars,k=!1;if(h.test(c))for(var l=document.createDocumentFragment(),
p=0;;){h.lastIndex=p;var q=h.exec(c),r=q?q.index-p:c.length-p;if(r){var s=document.createTextNode(c.slice(p,p+r));Xb?l.appendChild(Ea("span",[s])):l.appendChild(s);b.map.push(b.pos,b.pos+r,s);b.col+=r;b.pos+=r}if(!q)break;(p+=r+1,"\t"==q[0])?(s=b.cm.options.tabSize,q=s-b.col%s,s=l.appendChild(Ea("span",Af(q),"cm-tab")),b.col+=q):(s=b.cm.options.specialCharPlaceholder(q[0]),Xb?l.appendChild(Ea("span",[s])):l.appendChild(s),b.col+=1);b.map.push(b.pos,b.pos+1,s);b.pos++}else b.col+=c.length,l=document.createTextNode(c),
b.map.push(b.pos,b.pos+c.length,l),Xb&&(k=!0),b.pos+=c.length;if(e||d||f||k)return c=e||"",d&&(c+=d),f&&(c+=f),d=Ea("span",[l],c),g&&(d.title=g),b.content.appendChild(d);b.content.appendChild(l)}}function Kf(b){function c(b){for(var e=" ",d=0;d<b.length-2;++d)e+=d%2?" ":"\u00a0";return e+" "}return function(e,d,f,g,h,k){b(e,d.replace(/ {3,}/g,c),f,g,h,k)}}function nd(b,c){return function(e,d,f,g,h,k){f=f?f+" cm-force-border":"cm-force-border";for(var l=e.pos,p=l+d.length;;){for(var q=0;q<c.length;q++){var r=
c[q];if(r.to>l&&r.from<=l)break}if(r.to>=p)return b(e,d,f,g,h,k);b(e,d.slice(0,r.to-l),f,g,null,k);g=null;d=d.slice(r.to-l);l=r.to}}}function Le(b,c,e,d){(e=!d&&e.widgetNode)&&(b.map.push(b.pos,b.pos+c,e),b.content.appendChild(e));b.pos+=c}function sb(b,c){return 0==c.from.ch&&0==c.to.ch&&""==ub(c.text)&&(!b.cm||b.cm.options.wholeLineUpdateBefore)}function Me(b,c,e,d){function f(b,e,g){var h=d;b.text=e;b.stateAfter&&(b.stateAfter=null);b.styles&&(b.styles=null);null!=b.order&&(b.order=null);qf(b);
rf(b,g);e=h?h(b):1;e!=b.height&&$c(b,e);ic(b,"change",b,c)}var g=c.from,h=c.to,k=c.text,l=pa(b,g.line),p=pa(b,h.line),q=ub(k),r=e?e[k.length-1]:null,s=h.line-g.line;if(sb(b,c)){for(var t=0,u=[];t<k.length-1;++t)u.push(new jd(k[t],e?e[t]:null,d));f(p,p.text,r);s&&b.remove(g.line,s);u.length&&b.insert(g.line,u)}else if(l==p)if(1==k.length)f(l,l.text.slice(0,g.ch)+q+l.text.slice(h.ch),r);else{u=[];for(t=1;t<k.length-1;++t)u.push(new jd(k[t],e?e[t]:null,d));u.push(new jd(q+l.text.slice(h.ch),r,d));f(l,
l.text.slice(0,g.ch)+k[0],e?e[0]:null);b.insert(g.line+1,u)}else if(1==k.length)f(l,l.text.slice(0,g.ch)+k[0]+p.text.slice(h.ch),e?e[0]:null),b.remove(g.line+1,s);else{f(l,l.text.slice(0,g.ch)+k[0],e?e[0]:null);f(p,q+p.text.slice(h.ch),r);t=1;for(u=[];t<k.length-1;++t)u.push(new jd(k[t],e?e[t]:null,d));1<s&&b.remove(g.line+1,s-1);b.insert(g.line+1,u)}ic(b,"change",b,c)}function tb(b){this.lines=b;this.parent=null;for(var c=0,e=0;c<b.length;++c)b[c].parent=this,e+=b[c].height;this.height=e}function Ca(b){this.children=
b;for(var c=0,e=0,d=0;d<b.length;++d){var f=b[d],c=c+f.chunkSize(),e=e+f.height;f.parent=this}this.size=c;this.height=e;this.parent=null}function Sa(b,c,e){function d(b,f,g){if(b.linked)for(var h=0;h<b.linked.length;++h){var k=b.linked[h];if(k.doc!=f){var l=g&&k.sharedHist;(!e||l)&&(c(k.doc,l),d(k.doc,b,l))}}}d(b,null,!0)}function L(b,e){if(e.cm)throw Error("This document is already in use.");b.doc=e;e.cm=b;g(b);c(b);b.options.lineWrapping||s(b);b.options.mode=e.modeOption;ja(b)}function pa(b,c){if(c-=
b.first,0>c||c>=b.size)throw Error("There is no line "+(c+b.first)+" in the document.");for(var e=b;!e.lines;)for(var d=0;;++d){var f=e.children[d],g=f.chunkSize();if(g>c){e=f;break}c-=g}return e.lines[c]}function Cb(b,c,e){var d=[],f=c.line;return b.iter(c.line,e.line+1,function(b){b=b.text;f==e.line&&(b=b.slice(0,e.ch));f==c.line&&(b=b.slice(c.ch));d.push(b);++f}),d}function de(b,c,e){var d=[];return b.iter(c,e,function(b){d.push(b.text)}),d}function $c(b,c){var e=c-b.height;if(e)for(var d=b;d;d=
d.parent)d.height+=e}function qb(b){if(null==b.parent)return null;var c=b.parent;b=Nb(c.lines,b);for(var e=c.parent;e;c=e,e=e.parent)for(var d=0;e.children[d]!=c;++d)b+=e.children[d].chunkSize();return b+c.first}function pb(b,c){var e=b.first;a:do{for(var d=0;d<b.children.length;++d){var f=b.children[d],g=f.height;if(g>c){b=f;continue a}c-=g;e+=f.chunkSize()}return e}while(!b.lines);for(d=0;d<b.lines.length;++d){f=b.lines[d].height;if(f>c)break;c-=f}return e+d}function vb(b){b=Zc(b);for(var c=0,e=
b.parent,d=0;d<e.lines.length;++d){var f=e.lines[d];if(f==b)break;c+=f.height}for(b=e.parent;b;e=b,b=e.parent)for(d=0;d<b.children.length;++d){f=b.children[d];if(f==e)break;c+=f.height}return c}function ib(b){var c=b.order;return null==c&&(c=b.order=Bf(b.text)),c}function wb(b){this.done=[];this.undone=[];this.undoDepth=1/0;this.lastModTime=this.lastSelTime=0;this.lastOrigin=this.lastSelOrigin=this.lastOp=null;this.generation=this.maxGeneration=b||1}function ve(b,c){var e={from:ka(c.from.line,c.from.ch),
to:qc(c),text:Cb(b,c.from,c.to)};return bf(b,e,c.from.line,c.to.line+1),Sa(b,function(b){bf(b,e,c.from.line,c.to.line+1)},!0),e}function Ne(b){for(;b.length&&ub(b).ranges;)b.pop()}function Oe(b,c,e,d){var f=b.history;f.undone.length=0;var g,h=+new Date;if((f.lastOp==d||f.lastOrigin==c.origin&&c.origin&&("+"==c.origin.charAt(0)&&b.cm&&f.lastModTime>h-b.cm.options.historyEventDelay||"*"==c.origin.charAt(0)))&&(g=f.lastOp==d?(Ne(f.done),ub(f.done)):f.done.length&&!ub(f.done).ranges?ub(f.done):1<f.done.length&&
!f.done[f.done.length-2].ranges?(f.done.pop(),ub(f.done)):void 0)){var k=ub(g.changes);0==ab(c.from,c.to)&&0==ab(c.from,k.to)?k.to=qc(c):g.changes.push(ve(b,c))}else{(g=ub(f.done))&&g.ranges||J(b.sel,f.done);g={changes:[ve(b,c)],generation:f.generation};for(f.done.push(g);f.done.length>f.undoDepth;)f.done.shift(),f.done[0].ranges||f.done.shift()}f.done.push(e);f.generation=++f.maxGeneration;f.lastModTime=f.lastSelTime=h;f.lastOp=d;f.lastOrigin=f.lastSelOrigin=c.origin;k||lc(b,"historyAdded")}function J(b,
c){var e=ub(c);e&&e.ranges&&e.equals(b)||c.push(b)}function bf(b,c,e,d){var f=c["spans_"+b.id],g=0;b.iter(Math.max(b.first,e),Math.min(b.first+b.size,d),function(e){e.markedSpans&&((f||(f=c["spans_"+b.id]={}))[g]=e.markedSpans);++g})}function Lf(b){if(!b)return null;for(var c,e=0;e<b.length;++e)b[e].marker.explicitlyCleared?c||(c=b.slice(0,e)):c&&c.push(b[e]);return c?c.length?c:null:b}function Sb(b,c,e){for(var d=0,f=[];d<b.length;++d){var g=b[d];if(g.ranges)f.push(e?V.prototype.deepCopy.call(g):
g);else{var g=g.changes,h=[];f.push({changes:h});for(var k=0;k<g.length;++k){var l,p=g[k];if(h.push({from:p.from,to:p.to,text:p.text}),c)for(var q in p)(l=q.match(/^spans_(\d+)$/))&&-1<Nb(c,Number(l[1]))&&(ub(h)[q]=p[q],delete p[q])}}}return f}function xf(b,c,e,d){for(var f=0;f<b.length;++f){var g=b[f],h=!0;if(g.ranges){g.copied||(g=b[f]=g.deepCopy(),g.copied=!0);for(var k=0;k<g.ranges.length;k++){var h=g.ranges[k].anchor,l=c;e<h.line?h.line+=d:l<h.line&&(h.line=l,h.ch=0);h=g.ranges[k].head;l=c;e<
h.line?h.line+=d:l<h.line&&(h.line=l,h.ch=0)}}else{for(k=0;k<g.changes.length;++k)if(l=g.changes[k],e<l.from.line)l.from=ka(l.from.line+d,l.from.ch),l.to=ka(l.to.line+d,l.to.ch);else if(c<=l.to.line){h=!1;break}h||(b.splice(0,f+1),f=0)}}}function yf(b,c){var e=c.from.line,d=c.to.line,f=c.text.length-(d-e)-1;xf(b.done,e,d,f);xf(b.undone,e,d,f)}function cf(b){return null!=b.defaultPrevented?b.defaultPrevented:0==b.returnValue}function df(b){var c=b.which;return null==c&&(1&b.button?c=1:2&b.button?c=
3:4&b.button&&(c=2)),kc&&b.ctrlKey&&1==c&&(c=3),c}function ic(b,c){function e(b){return function(){b.apply(null,f)}}var d=b._handlers&&b._handlers[c];if(d){var f=Array.prototype.slice.call(arguments,2);Ld||(++Ae,Ld=[],setTimeout(zf,0));for(var g=0;g<d.length;++g)Ld.push(e(d[g]))}}function zf(){--Ae;var b=Ld;Ld=null;for(var c=0;c<b.length;++c)b[c]()}function dc(b,c,e){return lc(b,e||c.type,b,c),cf(c)||c.codemirrorIgnore}function kb(b){var c=b._handlers&&b._handlers.cursorActivity;if(c){b=b.curOp.cursorActivityHandlers||
(b.curOp.cursorActivityHandlers=[]);for(var e=0;e<c.length;++e)-1==Nb(b,c[e])&&b.push(c[e])}}function Ya(b,c){var e=b._handlers&&b._handlers[c];return e&&0<e.length}function Mb(b){b.prototype.on=function(b,c){Za(this,b,c)};b.prototype.off=function(b,c){Ad(this,b,c)}}function we(){this.id=null}function ef(b,c,e){for(var d=0,f=0;;){var g=b.indexOf("\t",d);-1==g&&(g=b.length);var h=g-d;if(g==b.length||f+h>=c)return d+Math.min(h,c-f);if(f+=g-d,f+=e-f%e,d=g+1,f>=c)return d}}function Af(b){for(;le.length<=
b;)le.push(ub(le)+" ");return le[b]}function ub(b){return b[b.length-1]}function Nb(b,c){for(var e=0;e<b.length;++e)if(b[e]==c)return e;return-1}function Cd(b,c){for(var e=[],d=0;d<b.length;d++)e[d]=c(b[d],d);return e}function Da(b,c){var e;Object.create?e=Object.create(b):(e=function(){},e.prototype=b,e=new e);return c&&jc(c,e),e}function jc(b,c,e){c||(c={});for(var d in b)!b.hasOwnProperty(d)||!1===e&&c.hasOwnProperty(d)||(c[d]=b[d]);return c}function Cc(b){var c=Array.prototype.slice.call(arguments,
1);return function(){return b.apply(null,c)}}function Dd(b){for(var c in b)if(b.hasOwnProperty(c)&&b[c])return!1;return!0}function ad(b){return 768<=b.charCodeAt(0)&&Pf.test(b)}function Ea(b,c,e,d){b=document.createElement(b);if(e&&(b.className=e),d&&(b.style.cssText=d),"string"==typeof c)b.appendChild(document.createTextNode(c));else if(c)for(e=0;e<c.length;++e)b.appendChild(c[e]);return b}function Oc(b){for(var c=b.childNodes.length;0<c;--c)b.removeChild(b.firstChild);return b}function gb(b,c){return Oc(b).appendChild(c)}
function Pc(){return document.activeElement}function od(b){return RegExp("\\b"+b+"\\b\\s*")}function id(b,c){var e=od(c);e.test(b.className)&&(b.className=b.className.replace(e,""))}function Ed(b,c){od(c).test(b.className)||(b.className+=" "+c)}function Hb(b,c){for(var e=b.split(" "),d=0;d<e.length;d++)e[d]&&!od(e[d]).test(c)&&(c+=" "+e[d]);return c}function pd(b){if(document.body.getElementsByClassName)for(var c=document.body.getElementsByClassName("CodeMirror"),e=0;e<c.length;e++){var d=c[e].CodeMirror;
d&&b(d)}}function xb(){var b;Za(window,"resize",function(){null==b&&(b=setTimeout(function(){ne=b=null;pd(sc)},100))});Za(window,"blur",function(){pd(gd)})}function Wb(b){if(null!=ne)return ne;var c=Ea("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return gb(b,c),c.offsetWidth&&(ne=c.offsetHeight-c.clientHeight),ne||0}function xe(b){if(null==Pe){var c=Ea("span","\u200b");gb(b,Ea("span",[c,document.createTextNode("x")]));0!=b.firstChild.offsetHeight&&(Pe=1>=c.offsetWidth&&2<c.offsetHeight&&
!ec)}return Pe?Ea("span","\u200b"):Ea("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px")}function Fd(b,c,e,d){if(!b)return d(c,e,"ltr");for(var f=!1,g=0;g<b.length;++g){var h=b[g];(h.from<e&&h.to>c||c==e&&h.to==c)&&(d(Math.max(h.from,c),Math.min(h.to,e),1==h.level?"rtl":"ltr"),f=!0)}f||d(c,e,"ltr")}function Xc(b){return b.level%2?b.from:b.to}function qd(b){return(b=ib(b))?b[0].level%2?b[0].to:b[0].from:0}function rd(b){var c=ib(b);return c?Xc(ub(c)):b.text.length}function ye(b,
c){var e=pa(b.doc,c),d=Zc(e);d!=e&&(c=qb(d));d=(e=ib(d))?e[0].level%2?rd(d):qd(d):0;return ka(c,d)}function Zb(b,c){Mc=null;for(var e,d=0;d<b.length;++d){var f=b[d];if(f.from<c&&f.to>c)return d;if(f.from==c||f.to==c){if(null!=e){var g=f.level,h=b[e].level,k=b[0].level;return g==k||(h==k?0:h>g)?(f.from!=f.to&&(Mc=e),d):(f.from!=f.to&&(Mc=d),e)}e=d}}return e}function sd(b,c,e,d){if(!d)return c+e;do c+=e;while(0<c&&ad(b.text.charAt(c)));return c}function td(b,c,e,d){var f=ib(b);if(!f)return ee(b,c,e,
d);var g=Zb(f,c),h=f[g];for(c=sd(b,c,h.level%2?-e:e,d);;){if(c>h.from&&c<h.to)return c;if(c==h.from||c==h.to)return Zb(f,c)==g?c:(h=f[g+e],0<e==h.level%2?h.to:h.from);if(h=f[g+=e],!h)return null;c=0<e==h.level%2?sd(b,h.to,-1,d):sd(b,h.from,1,d)}}function ee(b,c,e,d){c+=e;if(d)for(;0<c&&ad(b.text.charAt(c));)c+=e;return 0>c||c>b.text.length?null:c}var Uc=/gecko\/\d/i.test(navigator.userAgent),Dc=/MSIE \d/.test(navigator.userAgent),ec=Dc&&(null==document.documentMode||8>document.documentMode),Xb=Dc&&
(null==document.documentMode||9>document.documentMode),Gd=Dc&&(null==document.documentMode||10>document.documentMode),ud=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent),$b=Dc||ud,ac=/WebKit\//.test(navigator.userAgent),Db=ac&&/Qt\/\d+\.\d+/.test(navigator.userAgent),vd=/Chrome\//.test(navigator.userAgent),Vc=/Opera\//.test(navigator.userAgent),fe=/Apple Computer/.test(navigator.vendor),ge=/KHTML\//.test(navigator.userAgent),Ga=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),nb=/PhantomJS/.test(navigator.userAgent),
Wa=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),Tb=Wa||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),kc=Wa||/Mac/.test(navigator.platform),ff=/win/i.test(navigator.platform),bd=Vc&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);bd&&(bd=Number(bd[1]));bd&&15<=bd&&(Vc=!1,ac=!0);var Hd=kc&&(Db||Vc&&(null==bd||12.11>bd)),Rd=Uc||$b&&!Xb,Id=!1,cd=!1,ka=b.Pos=function(b,c){return this instanceof ka?(this.line=b,this.ch=c,void 0):
new ka(b,c)},ab=b.cmpPos=function(b,c){return b.line-c.line||b.ch-c.ch};V.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(b){if(b==this)return!0;if(b.primIndex!=this.primIndex||b.ranges.length!=this.ranges.length)return!1;for(var c=0;c<this.ranges.length;c++){var e=this.ranges[c],d=b.ranges[c];if(0!=ab(e.anchor,d.anchor)||0!=ab(e.head,d.head))return!1}return!0},deepCopy:function(){for(var b=[],c=0;c<this.ranges.length;c++)b[c]=new C(ka(this.ranges[c].anchor.line,
this.ranges[c].anchor.ch),ka(this.ranges[c].head.line,this.ranges[c].head.ch));return new V(b,this.primIndex)},somethingSelected:function(){for(var b=0;b<this.ranges.length;b++)if(!this.ranges[b].empty())return!0;return!1},contains:function(b,c){c||(c=b);for(var e=0;e<this.ranges.length;e++){var d=this.ranges[e];if(0<=ab(c,d.from())&&0>=ab(b,d.to()))return e}return-1}};C.prototype={from:function(){return Q(this.anchor,this.head)},to:function(){return I(this.anchor,this.head)},empty:function(){return this.head.line==
this.anchor.line&&this.head.ch==this.anchor.ch}};var Ub,rb,Ic,Sd={left:0,right:0,top:0,bottom:0},Jd=0,pc=0,Jc=0,bc=null;$b?bc=-0.53:Uc?bc=15:vd?bc=-0.7:fe&&(bc=-1/3);var Ma,yc=null,qc=b.changeEnd=function(b){return b.text?ka(b.from.line+b.text.length-1,ub(b.text).length+(1==b.text.length?b.from.ch:0)):b.to};b.prototype={constructor:b,focus:function(){window.focus();ob(this);Fb(this)},setOption:function(b,c){var e=this.options,d=e[b];(e[b]!=c||"mode"==b)&&(e[b]=c,Yc.hasOwnProperty(b)&&x(this,Yc[b])(this,
c,d))},getOption:function(b){return this.options[b]},getDoc:function(){return this.doc},addKeyMap:function(b,c){this.state.keyMaps[c?"push":"unshift"](b)},removeKeyMap:function(b){for(var c=this.state.keyMaps,e=0;e<c.length;++e)if(c[e]==b||"string"!=typeof c[e]&&c[e].name==b)return c.splice(e,1),!0},addOverlay:cb(function(c,e){var d=c.token?c:b.getMode(this.options,c);if(d.startState)throw Error("Overlays may not be stateful.");this.state.overlays.push({mode:d,modeSpec:c,opaque:e&&e.opaque});this.state.modeGen++;
ja(this)}),removeOverlay:cb(function(b){for(var c=this.state.overlays,e=0;e<c.length;++e){var d=c[e].modeSpec;if(d==b||"string"==typeof b&&d.name==b)return c.splice(e,1),this.state.modeGen++,ja(this),void 0}}),indentLine:cb(function(b,c,e){"string"!=typeof c&&"number"!=typeof c&&(c=null==c?this.options.smartIndent?"smart":"prev":c?"add":"subtract");R(this.doc,b)&&qe(this,b,c,e)}),indentSelection:cb(function(b){for(var c=this.doc.sel.ranges,e=-1,d=0;d<c.length;d++){var f=c[d];if(f.empty())f.head.line>
e&&(qe(this,f.head.line,b,!0),e=f.head.line,d==this.doc.sel.primIndex&&ae(this));else for(var g=Math.max(e,f.from().line),e=f.to(),e=Math.min(this.lastLine(),e.line-(e.ch?0:1))+1;e>g;++g)qe(this,g,b)}}),getTokenAt:function(b,c){var e=this.doc;b=ca(e,b);for(var d=Ba(this,b.line,c),f=this.doc.mode,e=pa(e,b.line),e=new Fa(e.text,this.options.tabSize);e.pos<b.ch&&!e.eol();){e.start=e.pos;var g=Je(f,e,d)}return{start:e.start,end:e.pos,string:e.current(),type:g||null,state:d}},getTokenTypeAt:function(b){b=
ca(this.doc,b);var c,e=Ke(this,pa(this.doc,b.line)),d=0,f=(e.length-1)/2;b=b.ch;if(0==b)c=e[2];else for(;;){var g=d+f>>1;if((g?e[2*g-1]:0)>=b)f=g;else{if(!(e[2*g+1]<b)){c=e[2*g+2];break}d=g+1}}e=c?c.indexOf("cm-overlay "):-1;return 0>e?c:0==e?null:c.slice(0,e-1)},getModeAt:function(c){var e=this.doc.mode;return e.innerMode?b.innerMode(e,this.getTokenAt(c).state).mode:e},getHelper:function(b,c){return this.getHelpers(b,c)[0]},getHelpers:function(b,c){var e=[];if(!Wc.hasOwnProperty(c))return Wc;var d=
Wc[c],f=this.getModeAt(b);if("string"==typeof f[c])d[f[c]]&&e.push(d[f[c]]);else if(f[c])for(var g=0;g<f[c].length;g++){var h=d[f[c][g]];h&&e.push(h)}else f.helperType&&d[f.helperType]?e.push(d[f.helperType]):d[f.name]&&e.push(d[f.name]);for(g=0;g<d._global.length;g++)h=d._global[g],h.pred(f,this)&&-1==Nb(e,h.val)&&e.push(h.val);return e},getStateAfter:function(b,c){var e=this.doc;return b=Math.max(e.first,Math.min(null==b?e.first+e.size-1:b,e.first+e.size-1)),Ba(this,b+1,c)},cursorCoords:function(b,
c){var e,d=this.doc.sel.primary();return e=null==b?d.head:"object"==typeof b?ca(this.doc,b):b?d.from():d.to(),db(this,e,c||"page")},charCoords:function(b,c){return va(this,ca(this.doc,b),c||"page")},coordsChar:function(b,c){return b=Pa(this,b,c||"page"),Ta(this,b.left,b.top)},lineAtHeight:function(b,c){return b=Pa(this,{top:b,left:0},c||"page").top,pb(this.doc,b+this.display.viewOffset)},heightAtLine:function(b,c){var e=!1,d=this.doc.first+this.doc.size-1;b<this.doc.first?b=this.doc.first:b>d&&(b=
d,e=!0);d=pa(this.doc,b);return zb(this,d,{top:0,left:0},c||"page").top+(e?this.doc.height-vb(d):0)},defaultTextHeight:function(){return bb(this.display)},defaultCharWidth:function(){return fb(this.display)},setGutterMarker:cb(function(b,c,e){return Ee(this,b,"gutter",function(b){var d=b.gutterMarkers||(b.gutterMarkers={});return d[c]=e,!e&&Dd(d)&&(b.gutterMarkers=null),!0})}),clearGutter:cb(function(b){var c=this,e=c.doc,d=e.first;e.iter(function(e){e.gutterMarkers&&e.gutterMarkers[b]&&(e.gutterMarkers[b]=
null,Vb(c,d,"gutter"),Dd(e.gutterMarkers)&&(e.gutterMarkers=null));++d})}),addLineClass:cb(function(b,c,e){return Ee(this,b,"class",function(b){var d="text"==c?"textClass":"background"==c?"bgClass":"wrapClass";if(b[d]){if(RegExp("(?:^|\\s)"+e+"(?:$|\\s)").test(b[d]))return!1;b[d]+=" "+e}else b[d]=e;return!0})}),removeLineClass:cb(function(b,c,e){return Ee(this,b,"class",function(b){var d="text"==c?"textClass":"background"==c?"bgClass":"wrapClass",f=b[d];if(!f)return!1;if(null==e)b[d]=null;else{var g=
f.match(RegExp("(?:^|\\s+)"+e+"(?:$|\\s+)"));if(!g)return!1;var h=g.index+g[0].length;b[d]=f.slice(0,g.index)+(g.index&&h!=f.length?" ":"")+f.slice(h)||null}return!0})}),addLineWidget:cb(function(b,c,e){return tf(this,b,c,e)}),removeLineWidget:function(b){b.clear()},lineInfo:function(b){if("number"==typeof b){if(!R(this.doc,b))return null;var c=b;if(b=pa(this.doc,b),!b)return null}else if(c=qb(b),null==c)return null;return{line:c,handle:b,text:b.text,gutterMarkers:b.gutterMarkers,textClass:b.textClass,
bgClass:b.bgClass,wrapClass:b.wrapClass,widgets:b.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(b,c,e,d,f){var g=this.display;b=db(this,ca(this.doc,b));var h=b.bottom,k=b.left;if(c.style.position="absolute",g.sizer.appendChild(c),"over"==d)h=b.top;else if("above"==d||"near"==d){var l=Math.max(g.wrapper.clientHeight,this.doc.height),p=Math.max(g.sizer.clientWidth,g.lineSpace.clientWidth);("above"==d||b.bottom+c.offsetHeight>l)&&b.top>
c.offsetHeight?h=b.top-c.offsetHeight:b.bottom+c.offsetHeight<=l&&(h=b.bottom);k+c.offsetWidth>p&&(k=p-c.offsetWidth)}c.style.top=h+"px";c.style.left=c.style.right="";"right"==f?(k=g.sizer.clientWidth-c.offsetWidth,c.style.right="0px"):("left"==f?k=0:"middle"==f&&(k=(g.sizer.clientWidth-c.offsetWidth)/2),c.style.left=k+"px");e&&(b=Ce(this,k,h,k+c.offsetWidth,h+c.offsetHeight),null!=b.scrollTop&&tc(this,b.scrollTop),null!=b.scrollLeft&&uc(this,b.scrollLeft))},triggerOnKeyDown:cb(ed),triggerOnKeyPress:cb(nc),
triggerOnKeyUp:cb(fd),execCommand:function(b){return zc.hasOwnProperty(b)?zc[b](this):void 0},findPosH:function(b,c,e,d){var f=1;0>c&&(f=-1,c=-c);var g=0;for(b=ca(this.doc,b);c>g&&(b=Ue(this.doc,b,f,e,d),!b.hitSide);++g);return b},moveH:cb(function(b,c){var e=this;e.extendSelectionsBy(function(d){return e.display.shift||e.doc.extend||d.empty()?Ue(e.doc,d.head,b,c,e.options.rtlMoveVisually):0>b?d.from():d.to()},Nd)}),deleteH:cb(function(b,c){var e=this.doc;this.doc.sel.somethingSelected()?e.replaceSelection("",
null,"+delete"):re(this,function(d){var f=Ue(e,d.head,b,c,!1);return 0>b?{from:f,to:d.head}:{from:d.head,to:f}})}),findPosV:function(b,c,e,d){var f=1;0>c&&(f=-1,c=-c);var g=0;for(b=ca(this.doc,b);c>g;++g){var h=db(this,b,"div");if(null==d?d=h.left:h.left=d,b=nf(this,h,f,e),b.hitSide)break}return b},moveV:cb(function(b,c){var e=this,d=this.doc,f=[],g=!e.display.shift&&!d.extend&&d.sel.somethingSelected();if(d.extendSelectionsBy(function(h){if(g)return 0>b?h.from():h.to();var k=db(e,h.head,"div");null!=
h.goalColumn&&(k.left=h.goalColumn);f.push(k.left);var l=nf(e,k,b,c);return"page"==c&&h==d.sel.primary()&&pe(e,null,va(e,l,"div").top-k.top),l},Nd),f.length)for(var h=0;h<d.sel.ranges.length;h++)d.sel.ranges[h].goalColumn=f[h]}),toggleOverwrite:function(b){(null==b||b!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?Ed(this.display.cursorDiv,"CodeMirror-overwrite"):id(this.display.cursorDiv,"CodeMirror-overwrite"),lc(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return Pc()==
this.display.input},scrollTo:cb(function(b,c){(null!=b||null!=c)&&De(this);null!=b&&(this.curOp.scrollLeft=b);null!=c&&(this.curOp.scrollTop=c)}),getScrollInfo:function(){var b=this.display.scroller,c=kd;return{left:b.scrollLeft,top:b.scrollTop,height:b.scrollHeight-c,width:b.scrollWidth-c,clientHeight:b.clientHeight-c,clientWidth:b.clientWidth-c}},scrollIntoView:cb(function(b,c){if(null==b?(b={from:this.doc.sel.primary().head,to:null},null==c&&(c=this.options.cursorScrollMargin)):"number"==typeof b?
b={from:ka(b,0),to:null}:null==b.from&&(b={from:b,to:null}),b.to||(b.to=b.from),b.margin=c||0,null!=b.from.line)De(this),this.curOp.scrollToPos=b;else{var e=Ce(this,Math.min(b.from.left,b.to.left),Math.min(b.from.top,b.to.top)-b.margin,Math.max(b.from.right,b.to.right),Math.max(b.from.bottom,b.to.bottom)+b.margin);this.scrollTo(e.scrollLeft,e.scrollTop)}}),setSize:cb(function(b,c){function e(b){return"number"==typeof b||/^\d+$/.test(String(b))?b+"px":b}null!=b&&(this.display.wrapper.style.width=e(b));
null!=c&&(this.display.wrapper.style.height=e(c));this.options.lineWrapping&&eb(this);this.curOp.forceUpdate=!0;lc(this,"refresh",this)}),operation:function(b){return Ia(this,b)},refresh:cb(function(){var b=this.display.cachedTextHeight;ja(this);this.curOp.forceUpdate=!0;Xa(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);q(this);(null==b||0.5<Math.abs(b-bb(this.display)))&&g(this);lc(this,"refresh",this)}),swapDoc:cb(function(b){var c=this.doc;return c.cm=null,L(this,b),Xa(this),la(this),
this.scrollTo(b.scrollLeft,b.scrollTop),ic(this,"swapDoc",this,c),c}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};Mb(b);var Kd=b.defaults={},Yc=b.optionHandlers={},wd=b.Init={toString:function(){return"CodeMirror.Init"}};hb("value","",function(b,c){b.setValue(c)},!0);hb("mode",null,function(b,e){b.doc.modeOption=e;c(b)},
!0);hb("indentUnit",2,c,!0);hb("indentWithTabs",!1);hb("smartIndent",!0);hb("tabSize",4,function(b){e(b);Xa(b);ja(b)},!0);hb("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(b,c){b.options.specialChars=RegExp(c.source+(c.test("\t")?"":"|\t"),"g");b.refresh()},!0);hb("specialCharPlaceholder",function(b){var c=Ea("span","\u2022","cm-invalidchar");return c.title="\\u"+b.charCodeAt(0).toString(16),c},function(b){b.refresh()},!0);hb("electricChars",!0);hb("rtlMoveVisually",!ff);
hb("wholeLineUpdateBefore",!0);hb("theme","default",function(b){k(b);l(b)},!0);hb("keyMap","default",h);hb("extraKeys",null);hb("lineWrapping",!1,function(b){b.options.lineWrapping?(Ed(b.display.wrapper,"CodeMirror-wrap"),b.display.sizer.style.minWidth=""):(id(b.display.wrapper,"CodeMirror-wrap"),s(b));g(b);ja(b);Xa(b);setTimeout(function(){v(b)},100)},!0);hb("gutters",[],function(b){t(b.options);l(b)},!0);hb("fixedGutter",!0,function(b,c){b.display.gutters.style.left=c?z(b.display)+"px":"0";b.refresh()},
!0);hb("coverGutterNextToScrollbar",!1,v,!0);hb("lineNumbers",!1,function(b){t(b.options);l(b)},!0);hb("firstLineNumber",1,l,!0);hb("lineNumberFormatter",function(b){return b},l,!0);hb("showCursorWhenSelecting",!1,T,!0);hb("resetSelectionOnContextMenu",!0);hb("readOnly",!1,function(b,c){"nocursor"==c?(gd(b),b.display.input.blur(),b.display.disabled=!0):(b.display.disabled=!1,c||la(b))});hb("disableInput",!1,function(b,c){c||la(b)},!0);hb("dragDrop",!0);hb("cursorBlinkRate",530);hb("cursorScrollMargin",
0);hb("cursorHeight",1);hb("workTime",100);hb("workDelay",100);hb("flattenSpans",!0,e,!0);hb("addModeClass",!1,e,!0);hb("pollInterval",100);hb("undoDepth",200,function(b,c){b.doc.history.undoDepth=c});hb("historyEventDelay",1250);hb("viewportMargin",10,function(b){b.refresh()},!0);hb("maxHighlightLength",1E4,e,!0);hb("moveInputWithCursor",!0,function(b,c){c||(b.display.inputDiv.style.top=b.display.inputDiv.style.left=0)});hb("tabindex",null,function(b,c){b.display.input.tabIndex=c||""});hb("autofocus",
null);var he=b.modes={},Qc=b.mimeModes={};b.defineMode=function(c,e){if(b.defaults.mode||"null"==c||(b.defaults.mode=c),2<arguments.length){e.dependencies=[];for(var d=2;d<arguments.length;++d)e.dependencies.push(arguments[d])}he[c]=e};b.defineMIME=function(b,c){Qc[b]=c};b.resolveMode=function(c){if("string"==typeof c&&Qc.hasOwnProperty(c))c=Qc[c];else if(c&&"string"==typeof c.name&&Qc.hasOwnProperty(c.name)){var e=Qc[c.name];"string"==typeof e&&(e={name:e});c=Da(e,c);c.name=e.name}else if("string"==
typeof c&&/^[\w\-]+\/[\w\-]+\+xml$/.test(c))return b.resolveMode("application/xml");return"string"==typeof c?{name:c}:c||{name:"null"}};b.getMode=function(c,e){e=b.resolveMode(e);var d=he[e.name];if(!d)return b.getMode(c,"text/plain");d=d(c,e);if(Rc.hasOwnProperty(e.name)){var f=Rc[e.name],g;for(g in f)f.hasOwnProperty(g)&&(d.hasOwnProperty(g)&&(d["_"+g]=d[g]),d[g]=f[g])}if(d.name=e.name,e.helperType&&(d.helperType=e.helperType),e.modeProps)for(g in e.modeProps)d[g]=e.modeProps[g];return d};b.defineMode("null",
function(){return{token:function(b){b.skipToEnd()}}});b.defineMIME("text/plain","null");var Rc=b.modeExtensions={};b.extendMode=function(b,c){var e=Rc.hasOwnProperty(b)?Rc[b]:Rc[b]={};jc(c,e)};b.defineExtension=function(c,e){b.prototype[c]=e};b.defineDocExtension=function(b,c){Lc.prototype[b]=c};b.defineOption=hb;var Kc=[];b.defineInitHook=function(b){Kc.push(b)};var Wc=b.helpers={};b.registerHelper=function(c,e,d){Wc.hasOwnProperty(c)||(Wc[c]=b[c]={_global:[]});Wc[c][e]=d};b.registerGlobalHelper=
function(c,e,d,f){b.registerHelper(c,e,f);Wc[c]._global.push({pred:d,val:f})};var xd=b.copyState=function(b,c){if(!0===c)return c;if(b.copyState)return b.copyState(c);var e={},d;for(d in c){var f=c[d];f instanceof Array&&(f=f.concat([]));e[d]=f}return e},Ec=b.startState=function(b,c,e){return b.startState?b.startState(c,e):!0};b.innerMode=function(b,c){for(;b.innerMode;){var e=b.innerMode(c);if(!e||e.mode==b)break;c=e.state;b=e.mode}return e||{mode:b,state:c}};var zc=b.commands={selectAll:function(b){b.setSelection(ka(b.firstLine(),
0),ka(b.lastLine()),Md)},singleSelection:function(b){b.setSelection(b.getCursor("anchor"),b.getCursor("head"),Md)},killLine:function(b){re(b,function(c){if(c.empty()){var e=pa(b.doc,c.head.line).text.length;return c.head.ch==e&&c.head.line<b.lastLine()?{from:c.head,to:ka(c.head.line+1,0)}:{from:c.head,to:ka(c.head.line,e)}}return{from:c.from(),to:c.to()}})},deleteLine:function(b){re(b,function(c){return{from:ka(c.from().line,0),to:ca(b.doc,ka(c.to().line+1,0))}})},delLineLeft:function(b){re(b,function(b){return{from:ka(b.from().line,
0),to:b.from()}})},undo:function(b){b.undo()},redo:function(b){b.redo()},undoSelection:function(b){b.undoSelection()},redoSelection:function(b){b.redoSelection()},goDocStart:function(b){b.extendSelection(ka(b.firstLine(),0))},goDocEnd:function(b){b.extendSelection(ka(b.lastLine()))},goLineStart:function(b){b.extendSelectionsBy(function(c){return ye(b,c.head.line)},Nd)},goLineStartSmart:function(b){b.extendSelectionsBy(function(c){var e=ye(b,c.head.line),d=b.getLineHandle(e.line),f=ib(d);return!f||
0==f[0].level?(d=Math.max(0,d.text.search(/\S/)),ka(e.line,c.head.line==e.line&&c.head.ch<=d&&c.head.ch?0:d)):e},Nd)},goLineEnd:function(b){b.extendSelectionsBy(function(c){c=c.head.line;for(var e,d=pa(b.doc,c);e=Pd(d,!1);)d=e.find(1,!0).line,c=null;e=(e=ib(d))?e[0].level%2?qd(d):rd(d):d.text.length;return ka(null==c?qb(d):c,e)},Nd)},goLineRight:function(b){b.extendSelectionsBy(function(c){c=b.charCoords(c.head,"div").top+5;return b.coordsChar({left:b.display.lineDiv.offsetWidth+100,top:c},"div")},
Nd)},goLineLeft:function(b){b.extendSelectionsBy(function(c){c=b.charCoords(c.head,"div").top+5;return b.coordsChar({left:0,top:c},"div")},Nd)},goLineUp:function(b){b.moveV(-1,"line")},goLineDown:function(b){b.moveV(1,"line")},goPageUp:function(b){b.moveV(-1,"page")},goPageDown:function(b){b.moveV(1,"page")},goCharLeft:function(b){b.moveH(-1,"char")},goCharRight:function(b){b.moveH(1,"char")},goColumnLeft:function(b){b.moveH(-1,"column")},goColumnRight:function(b){b.moveH(1,"column")},goWordLeft:function(b){b.moveH(-1,
"word")},goGroupRight:function(b){b.moveH(1,"group")},goGroupLeft:function(b){b.moveH(-1,"group")},goWordRight:function(b){b.moveH(1,"word")},delCharBefore:function(b){b.deleteH(-1,"char")},delCharAfter:function(b){b.deleteH(1,"char")},delWordBefore:function(b){b.deleteH(-1,"word")},delWordAfter:function(b){b.deleteH(1,"word")},delGroupBefore:function(b){b.deleteH(-1,"group")},delGroupAfter:function(b){b.deleteH(1,"group")},indentAuto:function(b){b.indentSelection("smart")},indentMore:function(b){b.indentSelection("add")},
indentLess:function(b){b.indentSelection("subtract")},insertTab:function(b){b.replaceSelection("\t")},insertSoftTab:function(b){for(var c=[],e=b.listSelections(),d=b.options.tabSize,f=0;f<e.length;f++){var g=e[f].from(),g=dd(b.getLine(g.line),g.ch,d);c.push(Array(d-g%d+1).join(" "))}b.replaceSelections(c)},defaultTab:function(b){b.somethingSelected()?b.indentSelection("add"):b.execCommand("insertTab")},transposeChars:function(b){Ia(b,function(){for(var c=b.listSelections(),e=0;e<c.length;e++){var d=
c[e].head,f=pa(b.doc,d.line).text;0<d.ch&&d.ch<f.length-1&&b.replaceRange(f.charAt(d.ch)+f.charAt(d.ch-1),ka(d.line,d.ch-1),ka(d.line,d.ch+1))}})},newlineAndIndent:function(b){Ia(b,function(){for(var c=b.listSelections().length,e=0;c>e;e++){var d=b.listSelections()[e];b.replaceRange("\n",d.anchor,d.head,"+input");b.indentLine(d.from().line+1,null,!0);ae(b)}})},toggleOverwrite:function(b){b.toggleOverwrite()}},Ac=b.keyMap={};Ac.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",
End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};Ac.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft",
"Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};Ac.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo",
"Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft","Cmd-U":"undoSelection",
"Shift-Cmd-U":"redoSelection",fallthrough:["basic","emacsy"]};Ac.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};Ac["default"]=kc?Ac.macDefault:Ac.pcDefault;var ua=b.lookupKey=
function(b,c,e){function d(c){c=We(c);var f=c[b];if(!1===f)return"stop";if(null!=f&&e(f))return!0;if(c.nofallthrough)return"stop";c=c.fallthrough;if(null==c)return!1;if("[object Array]"!=Object.prototype.toString.call(c))return d(c);for(f=0;f<c.length;++f){var g=d(c[f]);if(g)return g}return!1}for(var f=0;f<c.length;++f){var g=d(c[f]);if(g)return"stop"!=g}},vc=b.isModifierKey=function(b){b=Eb[b.keyCode];return"Ctrl"==b||"Alt"==b||"Shift"==b||"Mod"==b},lb=b.keyName=function(b,c){if(Vc&&34==b.keyCode&&
b["char"])return!1;var e=Eb[b.keyCode];return null==e||b.altGraphKey?!1:(b.altKey&&(e="Alt-"+e),(Hd?b.metaKey:b.ctrlKey)&&(e="Ctrl-"+e),(Hd?b.ctrlKey:b.metaKey)&&(e="Cmd-"+e),!c&&b.shiftKey&&(e="Shift-"+e),e)};b.fromTextArea=function(c,e){function d(){c.value=p.getValue()}if(e||(e={}),e.value=c.value,!e.tabindex&&c.tabindex&&(e.tabindex=c.tabindex),!e.placeholder&&c.placeholder&&(e.placeholder=c.placeholder),null==e.autofocus){var f=Pc();e.autofocus=f==c||null!=c.getAttribute("autofocus")&&f==document.body}if(c.form&&
(Za(c.form,"submit",d),!e.leaveSubmitMethodAlone)){var g=c.form,h=g.submit;try{var k=g.submit=function(){d();g.submit=h;g.submit();g.submit=k}}catch(l){}}c.style.display="none";var p=b(function(b){c.parentNode.insertBefore(b,c.nextSibling)},e);return p.save=d,p.getTextArea=function(){return c},p.toTextArea=function(){d();c.parentNode.removeChild(p.getWrapperElement());c.style.display="";c.form&&(Ad(c.form,"submit",d),"function"==typeof c.form.submit&&(c.form.submit=h))},p};var Fa=b.StringStream=function(b,
c){this.pos=this.start=0;this.string=b;this.tabSize=c||8;this.lineStart=this.lastColumnPos=this.lastColumnValue=0};Fa.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||void 0},next:function(){return this.pos<this.string.length?this.string.charAt(this.pos++):void 0},eat:function(b){var c=this.string.charAt(this.pos);return("string"==typeof b?c==b:c&&(b.test?b.test(c):b(c)))?(++this.pos,
c):void 0},eatWhile:function(b){for(var c=this.pos;this.eat(b););return this.pos>c},eatSpace:function(){for(var b=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>b},skipToEnd:function(){this.pos=this.string.length},skipTo:function(b){b=this.string.indexOf(b,this.pos);return-1<b?(this.pos=b,!0):void 0},backUp:function(b){this.pos-=b},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=dd(this.string,this.start,this.tabSize,this.lastColumnPos,
this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?dd(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return dd(this.string,null,this.tabSize)-(this.lineStart?dd(this.string,this.lineStart,this.tabSize):0)},match:function(b,c,e){if("string"!=typeof b)return(b=this.string.slice(this.pos).match(b))&&0<b.index?null:(b&&!1!==c&&(this.pos+=b[0].length),b);var d=this.string.substr(this.pos,b.length);return(e?d.toLowerCase():d)==(e?b.toLowerCase():
b)?(!1!==c&&(this.pos+=b.length),!0):void 0},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(b,c){this.lineStart+=b;try{return c()}finally{this.lineStart-=b}}};var Ob=b.TextMarker=function(b,c){this.lines=[];this.type=c;this.doc=b};Mb(Ob);Ob.prototype.clear=function(){if(!this.explicitlyCleared){var b=this.doc.cm,c=b&&!b.curOp;if(c&&wa(b),Ya(this,"clear")){var e=this.find();e&&ic(this,"clear",e.from,e.to)}for(var d=e=null,f=0;f<this.lines.length;++f){var g=
this.lines[f],h=se(g.markedSpans,this);b&&!this.collapsed?Vb(b,qb(g),"text"):b&&(null!=h.to&&(d=qb(g)),null!=h.from&&(e=qb(g)));for(var k=g,l=g.markedSpans,p=h,q=void 0,s=0;s<l.length;++s)l[s]!=p&&(q||(q=[])).push(l[s]);k.markedSpans=q;null==h.from&&this.collapsed&&!Qd(this.doc,g)&&b&&$c(g,bb(b.display))}if(b&&this.collapsed&&!b.options.lineWrapping)for(f=0;f<this.lines.length;++f)g=Zc(this.lines[f]),h=r(g),h>b.display.maxLineLength&&(b.display.maxLine=g,b.display.maxLineLength=h,b.display.maxLineChanged=
!0);null!=e&&b&&this.collapsed&&ja(b,e,d+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,b&&Qa(b.doc));b&&ic(b,"markerCleared",b,this);c&&oa(b);this.parent&&this.parent.clear()}};Ob.prototype.find=function(b,c){null==b&&"bookmark"==this.type&&(b=1);for(var e,d,f=0;f<this.lines.length;++f){var g=this.lines[f],h=se(g.markedSpans,this);if(null!=h.from&&(e=ka(c?g:qb(g),h.from),-1==b))return e;if(null!=h.to&&(d=ka(c?g:qb(g),h.to),1==b))return d}return e&&
{from:e,to:d}};Ob.prototype.changed=function(){var b=this.find(-1,!0),c=this,e=this.doc.cm;b&&e&&Ia(e,function(){var d=b.line,f=qb(b.line),f=ha(e,f);if(f&&(sa(f),e.curOp.selectionChanged=e.curOp.forceUpdate=!0),e.curOp.updateMaxLine=!0,!Qd(c.doc,d)&&null!=c.height)f=c.height,c.height=null,(f=ce(c)-f)&&$c(d,d.height+f)})};Ob.prototype.attachLine=function(b){if(!this.lines.length&&this.doc.cm){var c=this.doc.cm.curOp;c.maybeHiddenMarkers&&-1!=Nb(c.maybeHiddenMarkers,this)||(c.maybeUnhiddenMarkers||
(c.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(b)};Ob.prototype.detachLine=function(b){if(this.lines.splice(Nb(this.lines,b),1),!this.lines.length&&this.doc.cm)b=this.doc.cm.curOp,(b.maybeHiddenMarkers||(b.maybeHiddenMarkers=[])).push(this)};var Df=0,Vd=b.SharedTextMarker=function(b,c){this.markers=b;this.primary=c;for(var e=0;e<b.length;++e)b[e].parent=this};Mb(Vd);Vd.prototype.clear=function(){if(!this.explicitlyCleared){this.explicitlyCleared=!0;for(var b=0;b<this.markers.length;++b)this.markers[b].clear();
ic(this,"clear")}};Vd.prototype.find=function(b,c){return this.primary.find(b,c)};var Td=b.LineWidget=function(b,c,e){if(e)for(var d in e)e.hasOwnProperty(d)&&(this[d]=e[d]);this.cm=b;this.node=c};Mb(Td);Td.prototype.clear=function(){var b=this.cm,c=this.line.widgets,e=this.line,d=qb(e);if(null!=d&&c){for(var f=0;f<c.length;++f)c[f]==this&&c.splice(f--,1);c.length||(e.widgets=null);var g=ce(this);Ia(b,function(){var c=-g;vb(e)<(b.curOp&&b.curOp.scrollTop||b.doc.scrollTop)&&pe(b,null,c);Vb(b,d,"widget");
$c(e,Math.max(0,e.height-g))})}};Td.prototype.changed=function(){var b=this.height,c=this.cm,e=this.line;this.height=null;var d=ce(this)-b;d&&Ia(c,function(){c.curOp.forceUpdate=!0;vb(e)<(c.curOp&&c.curOp.scrollTop||c.doc.scrollTop)&&pe(c,null,d);$c(e,e.height+d)})};var jd=b.Line=function(b,c,e){this.text=b;rf(this,c);this.height=e?e(this):1};Mb(jd);jd.prototype.lineNo=function(){return qb(this)};var Nf={},hf={};tb.prototype={chunkSize:function(){return this.lines.length},removeInner:function(b,c){for(var e=
b,d=b+c;d>e;++e){var f=this.lines[e];this.height-=f.height;var g=f;g.parent=null;qf(g);ic(f,"delete")}this.lines.splice(b,c)},collapse:function(b){b.push.apply(b,this.lines)},insertInner:function(b,c,e){this.height+=e;this.lines=this.lines.slice(0,b).concat(c).concat(this.lines.slice(b));for(b=0;b<c.length;++b)c[b].parent=this},iterN:function(b,c,e){for(c=b+c;c>b;++b)if(e(this.lines[b]))return!0}};Ca.prototype={chunkSize:function(){return this.size},removeInner:function(b,c){this.size-=c;for(var e=
0;e<this.children.length;++e){var d=this.children[e],f=d.chunkSize();if(f>b){var g=Math.min(c,f-b),h=d.height;if(d.removeInner(b,g),this.height-=h-d.height,f==g&&(this.children.splice(e--,1),d.parent=null),0==(c-=g))break;b=0}else b-=f}if(25>this.size-c&&(1<this.children.length||!(this.children[0]instanceof tb)))e=[],this.collapse(e),this.children=[new tb(e)],this.children[0].parent=this},collapse:function(b){for(var c=0;c<this.children.length;++c)this.children[c].collapse(b)},insertInner:function(b,
c,e){this.size+=c.length;this.height+=e;for(var d=0;d<this.children.length;++d){var f=this.children[d],g=f.chunkSize();if(g>=b){if(f.insertInner(b,c,e),f.lines&&50<f.lines.length){for(;50<f.lines.length;)b=f.lines.splice(f.lines.length-25,25),b=new tb(b),f.height-=b.height,this.children.splice(d+1,0,b),b.parent=this;this.maybeSpill()}break}b-=g}},maybeSpill:function(){if(!(10>=this.children.length)){var b=this;do{var c=b.children.splice(b.children.length-5,5),c=new Ca(c);if(b.parent){b.size-=c.size;
b.height-=c.height;var e=Nb(b.parent.children,b);b.parent.children.splice(e+1,0,c)}else e=new Ca(b.children),e.parent=b,b.children=[e,c],b=e;c.parent=b.parent}while(10<b.children.length);b.parent.maybeSpill()}},iterN:function(b,c,e){for(var d=0;d<this.children.length;++d){var f=this.children[d],g=f.chunkSize();if(g>b){g=Math.min(c,g-b);if(f.iterN(b,g,e))return!0;if(0==(c-=g))break;b=0}else b-=g}}};var ie=0,Lc=b.Doc=function(b,c,e){if(!(this instanceof Lc))return new Lc(b,c,e);null==e&&(e=0);Ca.call(this,
[new tb([new jd("",null)])]);this.first=e;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.cleanGeneration=1;this.frontier=e;e=ka(e,0);this.sel=N(e);this.history=new wb(null);this.id=++ie;this.modeOption=c;"string"==typeof b&&(b=Fc(b));Me(this,{from:e,to:e,text:b});Y(this,N(e),Md)};Lc.prototype=Da(Ca.prototype,{constructor:Lc,iter:function(b,c,e){e?this.iterN(b-this.first,c-b,e):this.iterN(this.first,this.first+this.size,b)},insert:function(b,c){for(var e=0,d=0;d<c.length;++d)e+=c[d].height;
this.insertInner(b-this.first,c,e)},remove:function(b,c){this.removeInner(b-this.first,c)},getValue:function(b){var c=de(this,this.first,this.first+this.size);return!1===b?c:c.join(b||"\n")},setValue:La(function(b){var c=ka(this.first,0),e=this.first+this.size-1;Zd(this,{from:c,to:ka(e,pa(this,e).text.length),text:Fc(b),origin:"setValue"},!0);Y(this,N(c))}),replaceRange:function(b,c,e,d){c=ca(this,c);e=e?ca(this,e):c;Be(this,b,c,e,d)},getRange:function(b,c,e){b=Cb(this,ca(this,b),ca(this,c));return!1===
e?b:b.join(e||"\n")},getLine:function(b){return(b=this.getLineHandle(b))&&b.text},getLineHandle:function(b){return R(this,b)?pa(this,b):void 0},getLineNumber:function(b){return qb(b)},getLineHandleVisualStart:function(b){return"number"==typeof b&&(b=pa(this,b)),Zc(b)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(b){return ca(this,b)},getCursor:function(b){var c=this.sel.primary();return null==b||
"head"==b?c.head:"anchor"==b?c.anchor:"end"==b||"to"==b||!1===b?c.to():c.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:La(function(b,c,e){b=ca(this,"number"==typeof b?ka(b,c||0):b);Y(this,N(b,null),e)}),setSelection:La(function(b,c,e){var d=ca(this,b);b=ca(this,c||b);Y(this,N(d,b),e)}),extendSelection:La(function(b,c,e){ba(this,ca(this,b),c&&ca(this,c),e)}),extendSelections:La(function(b,c){for(var e=[],d=0;d<
b.length;d++)e[d]=ca(this,b[d]);na(this,e)}),extendSelectionsBy:La(function(b,c){na(this,Cd(this.sel.ranges,b),c)}),setSelections:La(function(b,c,e){if(b.length){for(var d=0,f=[];d<b.length;d++)f[d]=new C(ca(this,b[d].anchor),ca(this,b[d].head));null==c&&(c=Math.min(b.length-1,this.sel.primIndex));Y(this,Z(f,c),e)}}),addSelection:La(function(b,c,e){var d=this.sel.ranges.slice(0);d.push(new C(ca(this,b),ca(this,c||b)));Y(this,Z(d,d.length-1),e)}),getSelection:function(b){for(var c,e=this.sel.ranges,
d=0;d<e.length;d++){var f=Cb(this,e[d].from(),e[d].to());c=c?c.concat(f):f}return!1===b?c:c.join(b||"\n")},getSelections:function(b){for(var c=[],e=this.sel.ranges,d=0;d<e.length;d++){var f=Cb(this,e[d].from(),e[d].to());!1!==b&&(f=f.join(b||"\n"));c[d]=f}return c},replaceSelection:function(b,c,e){for(var d=[],f=0;f<this.sel.ranges.length;f++)d[f]=b;this.replaceSelections(d,c,e||"+input")},replaceSelections:La(function(b,c,e){for(var d=[],f=this.sel,g=0;g<f.ranges.length;g++){var h=f.ranges[g];d[g]=
{from:h.from(),to:h.to(),text:Fc(b[g]),origin:e}}if(g=c)if(g="end"!=c){g=[];e=b=ka(this.first,0);for(f=0;f<d.length;f++){var k=d[f],h=Yd(k.from,b,e),l=Yd(qc(k),b,e);(b=k.to,e=l,"around"==c)?(k=this.sel.ranges[f],k=0>ab(k.head,k.anchor),g[f]=new C(k?l:h,k?h:l)):g[f]=new C(h,h)}g=new V(g,this.sel.primIndex)}c=g;for(g=d.length-1;0<=g;g--)Zd(this,d[g]);c?ra(this,c):this.cm&&ae(this.cm)}),undo:La(function(){W(this,"undo")}),redo:La(function(){W(this,"redo")}),undoSelection:La(function(){W(this,"undo",
!0)}),redoSelection:La(function(){W(this,"redo",!0)}),setExtending:function(b){this.extend=b},getExtending:function(){return this.extend},historySize:function(){for(var b=this.history,c=0,e=0,d=0;d<b.done.length;d++)b.done[d].ranges||++c;for(d=0;d<b.undone.length;d++)b.undone[d].ranges||++e;return{undo:c,redo:e}},clearHistory:function(){this.history=new wb(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(b){return b&&(this.history.lastOp=
this.history.lastOrigin=null),this.history.generation},isClean:function(b){return this.history.generation==(b||this.cleanGeneration)},getHistory:function(){return{done:Sb(this.history.done),undone:Sb(this.history.undone)}},setHistory:function(b){var c=this.history=new wb(this.history.maxGeneration);c.done=Sb(b.done.slice(0),null,!0);c.undone=Sb(b.undone.slice(0),null,!0)},markText:function(b,c,e){return Bd(this,ca(this,b),ca(this,c),e,"range")},setBookmark:function(b,c){var e={replacedWith:c&&(null==
c.nodeType?c.widget:c),insertLeft:c&&c.insertLeft,clearWhenEmpty:!1,shared:c&&c.shared};return b=ca(this,b),Bd(this,b,b,e,"bookmark")},findMarksAt:function(b){b=ca(this,b);var c=[],e=pa(this,b.line).markedSpans;if(e)for(var d=0;d<e.length;++d){var f=e[d];(null==f.from||f.from<=b.ch)&&(null==f.to||f.to>=b.ch)&&c.push(f.marker.parent||f.marker)}return c},findMarks:function(b,c,e){b=ca(this,b);c=ca(this,c);var d=[],f=b.line;return this.iter(b.line,c.line+1,function(g){if(g=g.markedSpans)for(var h=0;h<
g.length;h++){var k=g[h];f==b.line&&b.ch>k.to||null==k.from&&f!=b.line||f==c.line&&k.from>c.ch||e&&!e(k.marker)||d.push(k.marker.parent||k.marker)}++f}),d},getAllMarks:function(){var b=[];return this.iter(function(c){if(c=c.markedSpans)for(var e=0;e<c.length;++e)null!=c[e].from&&b.push(c[e].marker)}),b},posFromIndex:function(b){var c,e=this.first;return this.iter(function(d){d=d.text.length+1;return d>b?(c=b,!0):(b-=d,++e,void 0)}),ca(this,ka(e,c))},indexFromPos:function(b){b=ca(this,b);var c=b.ch;
return b.line<this.first||0>b.ch?0:(this.iter(this.first,b.line,function(b){c+=b.text.length+1}),c)},copy:function(b){var c=new Lc(de(this,this.first,this.first+this.size),this.modeOption,this.first);return c.scrollTop=this.scrollTop,c.scrollLeft=this.scrollLeft,c.sel=this.sel,c.extend=!1,b&&(c.history.undoDepth=this.history.undoDepth,c.setHistory(this.getHistory())),c},linkedDoc:function(b){b||(b={});var c=this.first,e=this.first+this.size;null!=b.from&&b.from>c&&(c=b.from);null!=b.to&&b.to<e&&(e=
b.to);c=new Lc(de(this,c,e),b.mode||this.modeOption,c);b.sharedHist&&(c.history=this.history);(this.linked||(this.linked=[])).push({doc:c,sharedHist:b.sharedHist});c.linked=[{doc:this,isParent:!0,sharedHist:b.sharedHist}];b=of(this);for(e=0;e<b.length;e++){var d=b[e],f=d.find(),g=c.clipPos(f.from),f=c.clipPos(f.to);ab(g,f)&&(g=Bd(c,g,f,d.primary,d.primary.type),d.markers.push(g),g.parent=d)}return c},unlinkDoc:function(c){if(c instanceof b&&(c=c.doc),this.linked)for(var e=0;e<this.linked.length;++e)if(this.linked[e].doc==
c){this.linked.splice(e,1);c.unlinkDoc(this);Hf(of(this));break}if(c.history==this.history){var d=[c.id];Sa(c,function(b){d.push(b.id)},!0);c.history=new wb(null);c.history.done=Sb(this.history.done,d);c.history.undone=Sb(this.history.undone,d)}},iterLinkedDocs:function(b){Sa(this,b)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});Lc.prototype.eachLine=Lc.prototype.iter;var jf=["iter","insert","remove","copy","getEditor"],ze;for(ze in Lc.prototype)Lc.prototype.hasOwnProperty(ze)&&
0>Nb(jf,ze)&&(b.prototype[ze]=function(b){return function(){return b.apply(this.doc,arguments)}}(Lc.prototype[ze]));Mb(Lc);var Ld,Nc=b.e_preventDefault=function(b){b.preventDefault?b.preventDefault():b.returnValue=!1},Of=b.e_stopPropagation=function(b){b.stopPropagation?b.stopPropagation():b.cancelBubble=!0},kf=b.e_stop=function(b){Nc(b);Of(b)},Za=b.on=function(b,c,e){b.addEventListener?b.addEventListener(c,e,!1):b.attachEvent?b.attachEvent("on"+c,e):(b=b._handlers||(b._handlers={}),(b[c]||(b[c]=
[])).push(e))},Ad=b.off=function(b,c,e){if(b.removeEventListener)b.removeEventListener(c,e,!1);else if(b.detachEvent)b.detachEvent("on"+c,e);else if(b=b._handlers&&b._handlers[c])for(c=0;c<b.length;++c)if(b[c]==e){b.splice(c,1);break}},lc=b.signal=function(b,c){var e=b._handlers&&b._handlers[c];if(e)for(var d=Array.prototype.slice.call(arguments,2),f=0;f<e.length;++f)e[f].apply(null,d)},Ae=0,kd=30,Ud=b.Pass={toString:function(){return"CodeMirror.Pass"}},Md={scroll:!1},Wd={origin:"*mouse"},Nd={origin:"+move"};
we.prototype.set=function(b,c){clearTimeout(this.id);this.id=setTimeout(c,b)};var dd=b.countColumn=function(b,c,e,d,f){null==c&&(c=b.search(/[^\s\u00a0]/),-1==c&&(c=b.length));d=d||0;for(f=f||0;;){var g=b.indexOf("\t",d);if(0>g||g>=c)return f+(c-d);f+=g-d;f+=e-f%e;d=g+1}},le=[""],yd=function(b){b.select()};Wa?yd=function(b){b.selectionStart=0;b.selectionEnd=b.value.length}:$b&&(yd=function(b){try{b.select()}catch(c){}});[].indexOf&&(Nb=function(b,c){return b.indexOf(c)});[].map&&(Cd=function(b,c){return b.map(c)});
var me,Ef=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,Qe=b.isWordChar=function(b){return/\w/.test(b)||"\u0080"<b&&(b.toUpperCase()!=b.toLowerCase()||Ef.test(b))},Pf=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;
me=document.createRange?function(b,c,e){var d=document.createRange();return d.setEnd(b,e),d.setStart(b,c),d}:function(b,c,e){var d=document.body.createTextRange();return d.moveToElementText(b.parentNode),d.collapse(!0),d.moveEnd("character",e),d.moveStart("character",c),d};Dc&&(Pc=function(){try{return document.activeElement}catch(b){return document.body}});var ne,Pe,Re,lf=!1,wc=function(){if(Xb)return!1;var b=Ea("div");return"draggable"in b||"dragDrop"in b}(),Fc=b.splitLines=3!="\n\nb".split(/\n/).length?
function(b){for(var c=0,e=[],d=b.length;d>=c;){var f=b.indexOf("\n",c);-1==f&&(f=b.length);var g=b.slice(c,"\r"==b.charAt(f-1)?f-1:f),h=g.indexOf("\r");-1!=h?(e.push(g.slice(0,h)),c+=h+1):(e.push(g),c=f+1)}return e}:function(b){return b.split(/\r\n?|\n/)},cc=window.getSelection?function(b){try{return b.selectionStart!=b.selectionEnd}catch(c){return!1}}:function(b){try{var c=b.ownerDocument.selection.createRange()}catch(e){}return c&&c.parentElement()==b?0!=c.compareEndPoints("StartToEnd",c):!1},Yb=
function(){var b=Ea("div");return"oncopy"in b?!0:(b.setAttribute("oncopy","return;"),"function"==typeof b.oncopy)}(),Eb={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",
220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};b.keyNames=Eb;(function(){for(var b=0;10>b;b++)Eb[b+48]=Eb[b+96]=String(b);for(b=65;90>=b;b++)Eb[b]=String.fromCharCode(b);for(b=1;12>=b;b++)Eb[b+111]=Eb[b+63235]="F"+b})();var Mc,Bf=function(){function b(c){return 247>=c?e.charAt(c):1424<=c&&1524>=c?"R":1536<=c&&1773>=c?d.charAt(c-1536):1774<=c&&2220>=c?"r":8192<=c&&8203>=c?"w":8204==
c?"b":"L"}function c(b,e,d){this.level=b;this.from=e;this.to=d}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",d="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm",
f=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,g=/[stwN]/,h=/[LRr]/,k=/[Lb1n]/,l=/[1n]/;return function(e){if(!f.test(e))return!1;for(var d,p=e.length,q=[],r=0;p>r;++r)q.push(b(e.charCodeAt(r)));for(var r=0,s="L";p>r;++r)d=q[r],"m"==d?q[r]=s:s=d;r=0;for(s="L";p>r;++r)d=q[r],"1"==d&&"r"==s?q[r]="n":h.test(d)&&(s=d,"r"==d&&(q[r]="R"));r=1;for(s=q[0];p-1>r;++r)d=q[r],"+"==d&&"1"==s&&"1"==q[r+1]?q[r]="1":","!=d||s!=q[r+1]||"1"!=s&&"n"!=s||(q[r]=s),s=d;for(r=0;p>r;++r)if(d=q[r],","==d)q[r]="N";else if("%"==
d){for(s=r+1;p>s&&"%"==q[s];++s);var t=r&&"!"==q[r-1]||p>s&&"1"==q[s]?"1":"N";for(d=r;s>d;++d)q[d]=t;r=s-1}r=0;for(s="L";p>r;++r)d=q[r],"L"==s&&"1"==d?q[r]="L":h.test(d)&&(s=d);for(r=0;p>r;++r)if(g.test(q[r])){for(s=r+1;p>s&&g.test(q[s]);++s);d="L"==(p>s?q[s]:"L");t="L"==(r?q[r-1]:"L")||d?"L":"R";for(d=r;s>d;++d)q[d]=t;r=s-1}for(var u,s=[],r=0;p>r;)if(k.test(q[r])){d=r;for(++r;p>r&&k.test(q[r]);++r);s.push(new c(0,d,r))}else{var v=r,t=s.length;for(++r;p>r&&"L"!=q[r];++r);for(d=v;r>d;)if(l.test(q[d])){d>
v&&s.splice(t,0,new c(1,v,d));v=d;for(++d;r>d&&l.test(q[d]);++d);s.splice(t,0,new c(2,v,d));v=d}else++d;r>v&&s.splice(t,0,new c(1,v,r))}return 1==s[0].level&&(u=e.match(/^\s+/))&&(s[0].from=u[0].length,s.unshift(new c(0,0,u[0].length))),1==ub(s).level&&(u=e.match(/\s+$/))&&(ub(s).to-=u[0].length,s.push(new c(0,p-u[0].length,p))),s[0].level!=ub(s).level&&s.push(new c(s[0].level,p,p)),s}}();return b.version="4.1.1",b});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b){for(var c={},e=0;e<b.length;++e)c[b[e]]=!0;return c}function c(b,c){for(var e,d=!1;null!=(e=b.next());){if(d&&"/"==e){c.tokenize=null;break}d="*"==e}return["comment","comment"]}function e(b,c){return b.skipTo("--\x3e")?(b.match("--\x3e"),c.tokenize=null):b.skipToEnd(),["comment","comment"]}
b.defineMode("css",function(c,e){function d(b,c){var e=b.next();if(u[e]){var h=u[e](b,c);if(!1!==h)return h}"@"==e?(b.eatWhile(/[\w\\\-]/),e=(r=b.current(),"def")):e="="==e||("~"==e||"|"==e)&&b.eat("=")?(r="compare",null):'"'==e||"'"==e?(c.tokenize=f(e),c.tokenize(b,c)):"#"==e?(b.eatWhile(/[\w\\\-]/),r="hash","atom"):"!"==e?(b.match(/^\s*\w*/),r="important","keyword"):/\d/.test(e)||"."==e&&b.eat(/\d/)?(b.eatWhile(/[\w.%]/),r="unit","number"):"-"!==e?/[,+>*\/]/.test(e)?(r="select-op",null):"."==e&&
b.match(/^-?[_a-z][_a-z0-9-]*/i)?(r="qualifier","qualifier"):/[:;{}\[\]\(\)]/.test(e)?(r=e,null):"u"==e&&b.match("rl(")?(b.backUp(1),c.tokenize=g,r="word","property"):/[\w\\\-]/.test(e)?(b.eatWhile(/[\w\\\-]/),r="word","property"):(r=null,null):/[\d.]/.test(b.peek())?(b.eatWhile(/[\w.%]/),r="unit","number"):b.match(/^[^-]+-/)?(r="meta","meta"):void 0;return e}function f(b){return function(c,e){for(var f,g=!1;null!=(f=c.next());){if(f==b&&!g){")"==b&&c.backUp(1);break}g=!g&&"\\"==f}return(f==b||!g&&
")"!=b)&&(e.tokenize=null),c.pos==c.start?d(c,e):(r="string","string")}}function g(b,c){return b.next(),c.tokenize=b.match(/\s*[\"\')]/,!1)?null:f(")"),r="(",null}function h(b,c,e){this.type=b;this.indent=c;this.prev=e}function k(b,c,e){return b.context=new h(e,c.indentation()+t,b.context),e}function l(b){return b.context=b.context.prev,b.context.type}function p(b,c,e,d){for(d=d||1;0<d;d--)e.context=e.context.prev;return R[e.context.type](b,c,e)}function q(b){b=b.current().toLowerCase();s=Z.hasOwnProperty(b)?
"atom":C.hasOwnProperty(b)?"keyword":"variable"}e.propertyKeywords||(e=b.resolveMode("text/css"));var r,s,t=c.indentUnit,u=e.tokenHooks,v=e.mediaTypes||{},I=e.mediaFeatures||{},Q=e.propertyKeywords||{},V=e.nonStandardPropertyKeywords||{},C=e.colorKeywords||{},Z=e.valueKeywords||{},N=e.fontProperties||{},ca=e.allowNested,R={};return R.top=function(b,c,e){if("{"==b)return k(e,c,"block");if("}"==b&&e.context.prev)return l(e);if("@media"==b)return k(e,c,"media");if("@font-face"==b)return"font_face_before";
if(/^@(-(moz|ms|o|webkit)-)?keyframes$/.test(b))return"keyframes";if(b&&"@"==b.charAt(0))return k(e,c,"at");if("hash"==b)s="builtin";else if("word"==b)s="tag";else{if("variable-definition"==b)return"maybeprop";if("interpolation"==b)return k(e,c,"interpolation");if(":"==b)return"pseudo";if(ca&&"("==b)return k(e,c,"params")}return e.context.type},R.block=function(b,c,e){return"word"==b?(b=c.current().toLowerCase(),Q.hasOwnProperty(b)?(s="property","maybeprop"):V.hasOwnProperty(b)?(s="string-2","maybeprop"):
ca?(s=c.match(/^\s*:/,!1)?"property":"tag","block"):(s+=" error","maybeprop")):"meta"==b?"block":ca||"hash"!=b&&"qualifier"!=b?R.top(b,c,e):(s="error","block")},R.maybeprop=function(b,c,e){return":"==b?k(e,c,"prop"):R[e.context.type](b,c,e)},R.prop=function(b,c,e){if(";"==b)return l(e);if("{"==b&&ca)return k(e,c,"propBlock");if("}"==b||"{"==b)return p(b,c,e);if("("==b)return k(e,c,"parens");if("hash"!=b||/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/.test(c.current()))if("word"==b)q(c);else{if("interpolation"==
b)return k(e,c,"interpolation")}else s+=" error";return"prop"},R.propBlock=function(b,c,e){return"}"==b?l(e):"word"==b?(s="property","maybeprop"):e.context.type},R.parens=function(b,c,e){return"{"==b||"}"==b?p(b,c,e):")"==b?l(e):"parens"},R.pseudo=function(b,c,e){return"word"==b?(s="variable-3",e.context.type):R[e.context.type](b,c,e)},R.media=function(b,c,e){if("("==b)return k(e,c,"media_parens");if("}"==b)return p(b,c,e);if("{"==b)return l(e)&&k(e,c,ca?"block":"top");"word"==b&&(b=c.current().toLowerCase(),
s="only"==b||"not"==b||"and"==b?"keyword":v.hasOwnProperty(b)?"attribute":I.hasOwnProperty(b)?"property":"error");return e.context.type},R.media_parens=function(b,c,e){return")"==b?l(e):"{"==b||"}"==b?p(b,c,e,2):R.media(b,c,e)},R.font_face_before=function(b,c,e){return"{"==b?k(e,c,"font_face"):R[e.context.type](b,c,e)},R.font_face=function(b,c,e){return"}"==b?l(e):"word"==b?(s=N.hasOwnProperty(c.current().toLowerCase())?"property":"error","maybeprop"):"font_face"},R.keyframes=function(b,c,e){return"word"==
b?(s="variable","keyframes"):"{"==b?k(e,c,"top"):R[e.context.type](b,c,e)},R.at=function(b,c,e){return";"==b?l(e):"{"==b||"}"==b?p(b,c,e):("word"==b?s="tag":"hash"==b&&(s="builtin"),"at")},R.interpolation=function(b,c,e){return"}"==b?l(e):"{"==b||";"==b?p(b,c,e):("variable"!=b&&(s="error"),"interpolation")},R.params=function(b,c,e){return")"==b?l(e):"{"==b||"}"==b?p(b,c,e):("word"==b&&q(c),"params")},{startState:function(b){return{tokenize:null,state:"top",context:new h("top",b||0,null)}},token:function(b,
c){if(!c.tokenize&&b.eatSpace())return null;var e=(c.tokenize||d)(b,c);return e&&"object"==typeof e&&(r=e[1],e=e[0]),s=e,c.state=R[c.state](r,b,c),s},indent:function(b,c){var e=b.context,d=c&&c.charAt(0),f=e.indent;return"prop"==e.type&&"}"==d&&(e=e.prev),!e.prev||("}"!=d||"block"!=e.type&&"top"!=e.type&&"interpolation"!=e.type&&"font_face"!=e.type)&&(")"!=d||"parens"!=e.type&&"params"!=e.type&&"media_parens"!=e.type)&&("{"!=d||"at"!=e.type&&"media"!=e.type)||(f=e.indent-t),f},electricChars:"}",blockCommentStart:"/*",
blockCommentEnd:"*/",fold:"brace"}});var f="all aural braille handheld print projection screen tty tv embossed".split(" "),g=d(f),h="width min-width max-width height min-height max-height device-width min-device-width max-device-width device-height min-device-height max-device-height aspect-ratio min-aspect-ratio max-aspect-ratio device-aspect-ratio min-device-aspect-ratio max-device-aspect-ratio color min-color max-color color-index min-color-index max-color-index monochrome min-monochrome max-monochrome resolution min-resolution max-resolution scan grid".split(" "),
k=d(h),l="align-content align-items align-self alignment-adjust alignment-baseline anchor-point animation animation-delay animation-direction animation-duration animation-fill-mode animation-iteration-count animation-name animation-play-state animation-timing-function appearance azimuth backface-visibility background background-attachment background-clip background-color background-image background-origin background-position background-repeat background-size baseline-shift binding bleed bookmark-label bookmark-level bookmark-state bookmark-target border border-bottom border-bottom-color border-bottom-left-radius border-bottom-right-radius border-bottom-style border-bottom-width border-collapse border-color border-image border-image-outset border-image-repeat border-image-slice border-image-source border-image-width border-left border-left-color border-left-style border-left-width border-radius border-right border-right-color border-right-style border-right-width border-spacing border-style border-top border-top-color border-top-left-radius border-top-right-radius border-top-style border-top-width border-width bottom box-decoration-break box-shadow box-sizing break-after break-before break-inside caption-side clear clip color color-profile column-count column-fill column-gap column-rule column-rule-color column-rule-style column-rule-width column-span column-width columns content counter-increment counter-reset crop cue cue-after cue-before cursor direction display dominant-baseline drop-initial-after-adjust drop-initial-after-align drop-initial-before-adjust drop-initial-before-align drop-initial-size drop-initial-value elevation empty-cells fit fit-position flex flex-basis flex-direction flex-flow flex-grow flex-shrink flex-wrap float float-offset flow-from flow-into font font-feature-settings font-family font-kerning font-language-override font-size font-size-adjust font-stretch font-style font-synthesis font-variant font-variant-alternates font-variant-caps font-variant-east-asian font-variant-ligatures font-variant-numeric font-variant-position font-weight grid grid-area grid-auto-columns grid-auto-flow grid-auto-position grid-auto-rows grid-column grid-column-end grid-column-start grid-row grid-row-end grid-row-start grid-template grid-template-areas grid-template-columns grid-template-rows hanging-punctuation height hyphens icon image-orientation image-rendering image-resolution inline-box-align justify-content left letter-spacing line-break line-height line-stacking line-stacking-ruby line-stacking-shift line-stacking-strategy list-style list-style-image list-style-position list-style-type margin margin-bottom margin-left margin-right margin-top marker-offset marks marquee-direction marquee-loop marquee-play-count marquee-speed marquee-style max-height max-width min-height min-width move-to nav-down nav-index nav-left nav-right nav-up opacity order orphans outline outline-color outline-offset outline-style outline-width overflow overflow-style overflow-wrap overflow-x overflow-y padding padding-bottom padding-left padding-right padding-top page page-break-after page-break-before page-break-inside page-policy pause pause-after pause-before perspective perspective-origin pitch pitch-range play-during position presentation-level punctuation-trim quotes region-break-after region-break-before region-break-inside region-fragment rendering-intent resize rest rest-after rest-before richness right rotation rotation-point ruby-align ruby-overhang ruby-position ruby-span shape-inside shape-outside size speak speak-as speak-header speak-numeral speak-punctuation speech-rate stress string-set tab-size table-layout target target-name target-new target-position text-align text-align-last text-decoration text-decoration-color text-decoration-line text-decoration-skip text-decoration-style text-emphasis text-emphasis-color text-emphasis-position text-emphasis-style text-height text-indent text-justify text-outline text-overflow text-shadow text-size-adjust text-space-collapse text-transform text-underline-position text-wrap top transform transform-origin transform-style transition transition-delay transition-duration transition-property transition-timing-function unicode-bidi vertical-align visibility voice-balance voice-duration voice-family voice-pitch voice-range voice-rate voice-stress voice-volume volume white-space widows width word-break word-spacing word-wrap z-index clip-path clip-rule mask enable-background filter flood-color flood-opacity lighting-color stop-color stop-opacity pointer-events color-interpolation color-interpolation-filters color-rendering fill fill-opacity fill-rule image-rendering marker marker-end marker-mid marker-start shape-rendering stroke stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-rendering baseline-shift dominant-baseline glyph-orientation-horizontal glyph-orientation-vertical text-anchor writing-mode".split(" "),
p=d(l),q="scrollbar-arrow-color scrollbar-base-color scrollbar-dark-shadow-color scrollbar-face-color scrollbar-highlight-color scrollbar-shadow-color scrollbar-3d-light-color scrollbar-track-color shape-inside searchfield-cancel-button searchfield-decoration searchfield-results-button searchfield-results-decoration zoom".split(" "),q=d(q),r="aliceblue antiquewhite aqua aquamarine azure beige bisque black blanchedalmond blue blueviolet brown burlywood cadetblue chartreuse chocolate coral cornflowerblue cornsilk crimson cyan darkblue darkcyan darkgoldenrod darkgray darkgreen darkkhaki darkmagenta darkolivegreen darkorange darkorchid darkred darksalmon darkseagreen darkslateblue darkslategray darkturquoise darkviolet deeppink deepskyblue dimgray dodgerblue firebrick floralwhite forestgreen fuchsia gainsboro ghostwhite gold goldenrod gray grey green greenyellow honeydew hotpink indianred indigo ivory khaki lavender lavenderblush lawngreen lemonchiffon lightblue lightcoral lightcyan lightgoldenrodyellow lightgray lightgreen lightpink lightsalmon lightseagreen lightskyblue lightslategray lightsteelblue lightyellow lime limegreen linen magenta maroon mediumaquamarine mediumblue mediumorchid mediumpurple mediumseagreen mediumslateblue mediumspringgreen mediumturquoise mediumvioletred midnightblue mintcream mistyrose moccasin navajowhite navy oldlace olive olivedrab orange orangered orchid palegoldenrod palegreen paleturquoise palevioletred papayawhip peachpuff peru pink plum powderblue purple red rosybrown royalblue saddlebrown salmon sandybrown seagreen seashell sienna silver skyblue slateblue slategray snow springgreen steelblue tan teal thistle tomato turquoise violet wheat white whitesmoke yellow yellowgreen".split(" "),
s=d(r),t="above absolute activeborder activecaption afar after-white-space ahead alias all all-scroll alternate always amharic amharic-abegede antialiased appworkspace arabic-indic armenian asterisks auto avoid avoid-column avoid-page avoid-region background backwards baseline below bidi-override binary bengali blink block block-axis bold bolder border border-box both bottom break break-all break-word button button-bevel buttonface buttonhighlight buttonshadow buttontext cambodian capitalize caps-lock-indicator caption captiontext caret cell center checkbox circle cjk-earthly-branch cjk-heavenly-stem cjk-ideographic clear clip close-quote col-resize collapse column compact condensed contain content content-box context-menu continuous copy cover crop cross crosshair currentcolor cursive dashed decimal decimal-leading-zero default default-button destination-atop destination-in destination-out destination-over devanagari disc discard document dot-dash dot-dot-dash dotted double down e-resize ease ease-in ease-in-out ease-out element ellipse ellipsis embed end ethiopic ethiopic-abegede ethiopic-abegede-am-et ethiopic-abegede-gez ethiopic-abegede-ti-er ethiopic-abegede-ti-et ethiopic-halehame-aa-er ethiopic-halehame-aa-et ethiopic-halehame-am-et ethiopic-halehame-gez ethiopic-halehame-om-et ethiopic-halehame-sid-et ethiopic-halehame-so-et ethiopic-halehame-ti-er ethiopic-halehame-ti-et ethiopic-halehame-tig ew-resize expanded extra-condensed extra-expanded fantasy fast fill fixed flat footnotes forwards from geometricPrecision georgian graytext groove gujarati gurmukhi hand hangul hangul-consonant hebrew help hidden hide higher highlight highlighttext hiragana hiragana-iroha horizontal hsl hsla icon ignore inactiveborder inactivecaption inactivecaptiontext infinite infobackground infotext inherit initial inline inline-axis inline-block inline-table inset inside intrinsic invert italic justify kannada katakana katakana-iroha keep-all khmer landscape lao large larger left level lighter line-through linear lines list-item listbox listitem local logical loud lower lower-alpha lower-armenian lower-greek lower-hexadecimal lower-latin lower-norwegian lower-roman lowercase ltr malayalam match media-controls-background media-current-time-display media-fullscreen-button media-mute-button media-play-button media-return-to-realtime-button media-rewind-button media-seek-back-button media-seek-forward-button media-slider media-sliderthumb media-time-remaining-display media-volume-slider media-volume-slider-container media-volume-sliderthumb medium menu menulist menulist-button menulist-text menulist-textfield menutext message-box middle min-intrinsic mix mongolian monospace move multiple myanmar n-resize narrower ne-resize nesw-resize no-close-quote no-drop no-open-quote no-repeat none normal not-allowed nowrap ns-resize nw-resize nwse-resize oblique octal open-quote optimizeLegibility optimizeSpeed oriya oromo outset outside outside-shape overlay overline padding padding-box painted page paused persian plus-darker plus-lighter pointer polygon portrait pre pre-line pre-wrap preserve-3d progress push-button radio read-only read-write read-write-plaintext-only rectangle region relative repeat repeat-x repeat-y reset reverse rgb rgba ridge right round row-resize rtl run-in running s-resize sans-serif scroll scrollbar se-resize searchfield searchfield-cancel-button searchfield-decoration searchfield-results-button searchfield-results-decoration semi-condensed semi-expanded separate serif show sidama single skip-white-space slide slider-horizontal slider-vertical sliderthumb-horizontal sliderthumb-vertical slow small small-caps small-caption smaller solid somali source-atop source-in source-out source-over space square square-button start static status-bar stretch stroke sub subpixel-antialiased super sw-resize table table-caption table-cell table-column table-column-group table-footer-group table-header-group table-row table-row-group telugu text text-bottom text-top textarea textfield thai thick thin threeddarkshadow threedface threedhighlight threedlightshadow threedshadow tibetan tigre tigrinya-er tigrinya-er-abegede tigrinya-et tigrinya-et-abegede to top transparent ultra-condensed ultra-expanded underline up upper-alpha upper-armenian upper-greek upper-hexadecimal upper-latin upper-norwegian upper-roman uppercase urdu url vertical vertical-text visible visibleFill visiblePainted visibleStroke visual w-resize wait wave wider window windowframe windowtext x-large x-small xor xx-large xx-small".split(" "),
u=d(t),v=d("font-family src unicode-range font-variant font-feature-settings font-stretch font-weight font-style".split(" ")),f=f.concat(h).concat(l).concat(q).concat(r).concat(t);b.registerHelper("hintWords","css",f);b.defineMIME("text/css",{mediaTypes:g,mediaFeatures:k,propertyKeywords:p,nonStandardPropertyKeywords:q,colorKeywords:s,valueKeywords:u,fontProperties:v,tokenHooks:{"<":function(b,c){return b.match("!--")?(c.tokenize=e,e(b,c)):!1},"/":function(b,e){return b.eat("*")?(e.tokenize=c,c(b,
e)):!1}},name:"css"});b.defineMIME("text/x-scss",{mediaTypes:g,mediaFeatures:k,propertyKeywords:p,nonStandardPropertyKeywords:q,colorKeywords:s,valueKeywords:u,fontProperties:v,allowNested:!0,tokenHooks:{"/":function(b,e){return b.eat("/")?(b.skipToEnd(),["comment","comment"]):b.eat("*")?(e.tokenize=c,c(b,e)):["operator","operator"]},":":function(b){return b.match(/\s*{/)?[null,"{"]:!1},$:function(b){return b.match(/^[\w-]+/),b.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2",
"variable"]},"#":function(b){return b.eat("{")?[null,"interpolation"]:!1}},name:"css",helperType:"scss"});b.defineMIME("text/x-less",{mediaTypes:g,mediaFeatures:k,propertyKeywords:p,nonStandardPropertyKeywords:q,colorKeywords:s,valueKeywords:u,fontProperties:v,allowNested:!0,tokenHooks:{"/":function(b,e){return b.eat("/")?(b.skipToEnd(),["comment","comment"]):b.eat("*")?(e.tokenize=c,c(b,e)):["operator","operator"]},"@":function(b){return b.match(/^(charset|document|font-face|import|(-(moz|ms|o|webkit)-)?keyframes|media|namespace|page|supports)\b/,
!1)?!1:(b.eatWhile(/[\w\\\-]/),b.match(/^\s*:/,!1)?["variable-2","variable-definition"]:["variable-2","variable"])},"&":function(){return["atom","atom"]}},name:"css",helperType:"less"})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],b):b(CodeMirror)})(function(b){b.defineMode("htmlmixed",function(d,c){function e(b,c){var e=c.htmlState.tagName,d=k.token(b,c.htmlState);if("script"==e&&/\btag\b/.test(d)&&">"==b.current()){(e=(e=b.string.slice(Math.max(0,
b.pos-100),b.pos).match(/\btype\s*=\s*("[^"]+"|'[^']+'|\S+)[^<]*$/i))?e[1]:"")&&/[\"\']/.test(e.charAt(0))&&(e=e.slice(1,e.length-1));for(var f=0;f<p.length;++f){var q=p[f];if("string"==typeof q.matches?e==q.matches:q.matches.test(e)){q.mode&&(c.token=g,c.localMode=q.mode,c.localState=q.mode.startState&&q.mode.startState(k.indent(c.htmlState,"")));break}}}else"style"==e&&/\btag\b/.test(d)&&">"==b.current()&&(c.token=h,c.localMode=l,c.localState=l.startState(k.indent(c.htmlState,"")));return d}function f(b,
c,e){var d=b.current(),f=d.search(c);return-1<f?b.backUp(d.length-f):d.match(/<\/?$/)&&(b.backUp(d.length),b.match(c,!1)||b.match(d)),e}function g(b,c){return b.match(/^<\/\s*script\s*>/i,!1)?(c.token=e,c.localState=c.localMode=null,e(b,c)):f(b,/<\/\s*script\s*>/,c.localMode.token(b,c.localState))}function h(b,c){return b.match(/^<\/\s*style\s*>/i,!1)?(c.token=e,c.localState=c.localMode=null,e(b,c)):f(b,/<\/\s*style\s*>/,l.token(b,c.localState))}var k=b.getMode(d,{name:"xml",htmlMode:!0,multilineTagIndentFactor:c.multilineTagIndentFactor,
multilineTagIndentPastTag:c.multilineTagIndentPastTag}),l=b.getMode(d,"css"),p=[],q=c&&c.scriptTypes;if(p.push({matches:/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^$/i,mode:b.getMode(d,"javascript")}),q)for(var r=0;r<q.length;++r){var s=q[r];p.push({matches:s.matches,mode:s.mode&&b.getMode(d,s.mode)})}return p.push({matches:/./,mode:b.getMode(d,"text/plain")}),{startState:function(){var b=k.startState();return{token:e,localMode:null,localState:null,htmlState:b}},copyState:function(c){if(c.localState)var e=
b.copyState(c.localMode,c.localState);return{token:c.token,localMode:c.localMode,localState:e,htmlState:b.copyState(k,c.htmlState)}},token:function(b,c){return c.token(b,c)},indent:function(c,e){return!c.localMode||/^\s*<\//.test(e)?k.indent(c.htmlState,e):c.localMode.indent?c.localMode.indent(c.localState,e):b.Pass},innerMode:function(b){return{state:b.localState||b.htmlState,mode:b.localMode||k}}}},"xml","javascript","css");b.defineMIME("text/html","htmlmixed")});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.defineMode("javascript",function(d,c){function e(b,c,e){return Xa=b,zb=e,c}function f(b,c){var d=b.next();if('"'==d||"'"==d)return c.tokenize=g(d),c.tokenize(b,c);if("."==d&&b.match(/^\d+(?:[eE][+\-]?\d+)?/))return e("number","number");if("."==d&&b.match(".."))return e("spread","meta");if(/[\[\]{}\(\),;\:\.]/.test(d))return e(d);
if("="==d&&b.eat(">"))return e("=>","operator");if("0"==d&&b.eat(/x/i))return b.eatWhile(/[\da-f]/i),e("number","number");if(/\d/.test(d))return b.match(/^\d*(?:\.\d*)?(?:[eE][+\-]?\d+)?/),e("number","number");if("/"==d){if(b.eat("*"))d=(c.tokenize=h,h(b,c));else if(b.eat("/"))d=(b.skipToEnd(),e("comment","comment"));else if("operator"==c.lastType||"keyword c"==c.lastType||"sof"==c.lastType||/^[\[{}\(,;:]$/.test(c.lastType)){a:for(var f=!1,l=!1;null!=(d=b.next());){if(!f){if("/"==d&&!l)break a;"["==
d?l=!0:l&&"]"==d&&(l=!1)}f=!f&&"\\"==d}d=(b.eatWhile(/[gimy]/),e("regexp","string-2"))}else d=(b.eatWhile(Ka),e("operator","operator",b.current()));return d}if("`"==d)return c.tokenize=k,k(b,c);if("#"==d)return b.skipToEnd(),e("error","error");if(Ka.test(d))return b.eatWhile(Ka),e("operator","operator",b.current());b.eatWhile(/[\w\$_]/);d=b.current();return(f=Ta.propertyIsEnumerable(d)&&Ta[d])&&"."!=c.lastType?e(f.type,f.style,d):e("variable","variable",d)}function g(b){return function(c,d){var g,
h=!1;if(db&&"@"==c.peek()&&c.match(bb))return d.tokenize=f,e("jsonld-keyword","meta");for(;null!=(g=c.next())&&(g!=b||h);)h=!h&&"\\"==g;return h||(d.tokenize=f),e("string","string")}}function h(b,c){for(var d,g=!1;d=b.next();){if("/"==d&&g){c.tokenize=f;break}g="*"==d}return e("comment","comment")}function k(b,c){for(var d,g=!1;null!=(d=b.next());){if(!g&&("`"==d||"$"==d&&b.eat("{"))){c.tokenize=f;break}g=!g&&"\\"==d}return e("quasi","string-2",b.current())}function l(b,c){c.fatArrowAt&&(c.fatArrowAt=
null);var e=b.string.indexOf("=>",b.start);if(!(0>e)){for(var d=0,f=!1,e=e-1;0<=e;--e){var g=b.string.charAt(e),h=fb.indexOf(g);if(0<=h&&3>h){if(!d){++e;break}if(0==--d)break}else if(3<=h&&6>h)++d;else if(/[$\w]/.test(g))f=!0;else if(f&&!d){++e;break}}f&&!d&&(c.fatArrowAt=e)}}function p(b,c,e,d,f,g){this.indented=b;this.column=c;this.type=e;this.prev=f;this.info=g;null!=d&&(this.align=d)}function q(){for(var b=arguments.length-1;0<=b;b--)oa.cc.push(arguments[b])}function r(){return q.apply(null,arguments),
!0}function s(b){function e(c){for(;c;c=c.next)if(c.name==b)return!0;return!1}var d=oa.state;if(d.context){if(!(oa.marked="def",e(d.localVars)))d.localVars={name:b,next:d.localVars}}else e(d.globalVars)||c.globalVars&&(d.globalVars={name:b,next:d.globalVars})}function t(){oa.state.context={prev:oa.state.context,vars:oa.state.localVars};oa.state.localVars=Ia}function u(){oa.state.localVars=oa.state.context.vars;oa.state.context=oa.state.context.prev}function v(b,c){var e=function(){var e=oa.state,
d=e.indented;"stat"==e.lexical.type&&(d=e.lexical.indented);e.lexical=new p(d,oa.stream.column(),b,null,e.lexical,c)};return e.lex=!0,e}function w(){var b=oa.state;b.lexical.prev&&(")"==b.lexical.type&&(b.indented=b.lexical.indented),b.lexical=b.lexical.prev)}function y(b){function c(e){return e==b?r():";"==b?q():r(c)}return c}function z(b,c){return"var"==b?r(v("vardef",c.length),ba,y(";"),w):"keyword a"==b?r(v("form"),B,z,w):"keyword b"==b?r(v("form"),z,w):"{"==b?r(v("}"),ca,w):";"==b?r():"if"==
b?("else"==oa.state.lexical.info&&oa.state.cc[oa.state.cc.length-1]==w&&oa.state.cc.pop()(),r(v("form"),B,z,w,Y)):"function"==b?r(T):"for"==b?r(v("form"),ta,z,w):"variable"==b?r(v("stat"),M):"switch"==b?r(v("form"),B,v("}","switch"),y("{"),ca,w,w):"case"==b?r(B,y(":")):"default"==b?r(y(":")):"catch"==b?r(v("form"),t,y("("),ia,y(")"),z,w,u):"module"==b?r(v("form"),t,ya,u,w):"class"==b?r(v("form"),ea,Aa,w):"export"==b?r(v("form"),Ba,w):"import"==b?r(v("form"),Ua,w):q(v("stat"),B,y(";"),w)}function B(b){return K(b,
!1)}function A(b){return K(b,!0)}function K(b,c){if(oa.state.fatArrowAt==oa.stream.start){var e=c?D:aa;if("("==b)return r(t,v(")"),Z(na,")"),w,y("=>"),e,u);if("variable"==b)return q(t,na,y("=>"),e,u)}e=c?U:F;return wa.hasOwnProperty(b)?r(e):"function"==b?r(T,e):"keyword c"==b?r(c?E:O):"("==b?r(v(")"),O,eb,y(")"),w,e):"operator"==b||"spread"==b?r(c?A:B):"["==b?r(v("]"),Ha,w,e):"{"==b?N(Q,"}",null,e):"quasi"==b?q(H,e):r()}function O(b){return b.match(/[;\}\)\],]/)?q():q(B)}function E(b){return b.match(/[;\}\)\],]/)?
q():q(A)}function F(b,c){return","==b?r(B):U(b,c,!1)}function U(b,c,e){var d=0==e?F:U,f=0==e?B:A;return"=>"==c?r(t,e?D:aa,u):"operator"==b?/\+\+|--/.test(c)?r(d):"?"==c?r(B,y(":"),f):r(f):"quasi"==b?q(H,d):";"!=b?"("==b?N(A,")","call",d):"."==b?r(I,d):"["==b?r(v("]"),O,y("]"),w,d):void 0:void 0}function H(b,c){return"quasi"!=b?q():"${"!=c.slice(c.length-2)?r(H):r(B,G)}function G(b){return"}"==b?(oa.marked="string-2",oa.state.tokenize=k,r(H)):void 0}function aa(b){return l(oa.stream,oa.state),"{"==
b?q(z):q(B)}function D(b){return l(oa.stream,oa.state),"{"==b?q(z):q(A)}function M(b){return":"==b?r(w,z):q(F,y(";"),w)}function I(b){return"variable"==b?(oa.marked="property",r()):void 0}function Q(b,c){if("variable"==b){if(oa.marked="property","get"==c||"set"==c)return r(V)}else if("number"==b||"string"==b)oa.marked=db?"property":b+" property";else if("["==b)return r(B,y("]"),C);return wa.hasOwnProperty(b)?r(C):void 0}function V(b){return"variable"!=b?q(C):(oa.marked="property",r(T))}function C(b){return":"==
b?r(A):"("==b?q(T):void 0}function Z(b,c){function e(d){return","==d?(d=oa.state.lexical,"call"==d.info&&(d.pos=(d.pos||0)+1),r(b,e)):d==c?r():r(y(c))}return function(d){return d==c?r():q(b,e)}}function N(b,c,e){for(var d=3;d<arguments.length;d++)oa.cc.push(arguments[d]);return r(v(c,e),Z(b,c),w)}function ca(b){return"}"==b?r():q(z,ca)}function R(b){return Va&&":"==b?r(X):void 0}function X(b){return"variable"==b?(oa.marked="variable-3",r()):void 0}function ba(){return q(na,R,$,ra)}function na(b,c){return"variable"==
b?(s(c),r()):"["==b?N(na,"]"):"{"==b?N(S,"}"):void 0}function S(b,c){return"variable"!=b||oa.stream.match(/^\s*:/,!1)?("variable"==b&&(oa.marked="property"),r(y(":"),na,$)):(s(c),r($))}function $(b,c){return"="==c?r(A):void 0}function ra(b){return","==b?r(ba):void 0}function Y(b,c){return"keyword b"==b&&"else"==c?r(v("form","else"),z,w):void 0}function ta(b){return"("==b?r(v(")"),Na,y(")"),w):void 0}function Na(b){return"var"==b?r(ba,y(";"),Oa):";"==b?r(Oa):"variable"==b?r(Qa):q(B,y(";"),Oa)}function Qa(b,
c){return"in"==c||"of"==c?(oa.marked="keyword",r(B)):r(F,Oa)}function Oa(b,c){return";"==b?r(fa):"in"==c||"of"==c?(oa.marked="keyword",r(B)):q(B,y(";"),fa)}function fa(b){")"!=b&&r(B)}function T(b,c){return"*"==c?(oa.marked="keyword",r(T)):"variable"==b?(s(c),r(T)):"("==b?r(t,v(")"),Z(ia,")"),w,z,u):void 0}function ia(b){return"spread"==b?r(ia):q(na,R)}function ea(b,c){return"variable"==b?(s(c),r(xa)):void 0}function xa(b,c){return"extends"==c?r(B):void 0}function Aa(b){return"{"==b?N(Q,"}"):void 0}
function ya(b,c){return"string"==b?r(z):"variable"==b?(s(c),r(Ra)):void 0}function Ba(b,c){return"*"==c?(oa.marked="keyword",r(Ra,y(";"))):"default"==c?(oa.marked="keyword",r(B,y(";"))):q(z)}function Ua(b){return"string"==b?r():q(ha,Ra)}function ha(b,c){return"{"==b?N(ha,"}"):("variable"==b&&s(c),r())}function Ra(b,c){return"from"==c?(oa.marked="keyword",r(B)):void 0}function Ha(b){return"]"==b?r():q(A,sa)}function sa(b){return"for"==b?q(eb,y("]")):","==b?r(Z(A,"]")):q(Z(A,"]"))}function eb(b){return"for"==
b?r(ta,eb):"if"==b?r(B,eb):void 0}var Xa,zb,Pa=d.indentUnit,va=c.statementIndent,db=c.jsonld,Ib=c.json||db,Va=c.typescript,Ta=function(){function b(c){return{type:c,style:"keyword"}}var c=b("keyword a"),e=b("keyword b"),d=b("keyword c"),f=b("operator"),g={type:"atom",style:"atom"},c={"if":b("if"),"while":c,"with":c,"else":e,"do":e,"try":e,"finally":e,"return":d,"break":d,"continue":d,"new":d,"delete":d,"throw":d,"debugger":d,"var":b("var"),"const":b("var"),let:b("var"),"function":b("function"),"catch":b("catch"),
"for":b("for"),"switch":b("switch"),"case":b("case"),"default":b("default"),"in":f,"typeof":f,"instanceof":f,"true":g,"false":g,"null":g,undefined:g,NaN:g,Infinity:g,"this":b("this"),module:b("module"),"class":b("class"),"super":b("atom"),yield:d,"export":b("export"),"import":b("import"),"extends":d};if(Va){var e={type:"variable",style:"variable-3"},e={"interface":b("interface"),"extends":b("extends"),constructor:b("constructor"),"public":b("public"),"private":b("private"),"protected":b("protected"),
"static":b("static"),string:e,number:e,bool:e,any:e},h;for(h in e)c[h]=e[h]}return c}(),Ka=/[+\-*&%=<>!?|~^]/,bb=/^@(context|id|value|language|type|container|list|set|reverse|index|base|vocab|graph)"/,fb="([{}])",wa={atom:!0,number:!0,variable:!0,string:!0,regexp:!0,"this":!0,"jsonld-keyword":!0},oa={state:null,column:null,marked:null,cc:null},Ia={name:"this",next:{name:"arguments"}};return w.lex=!0,{startState:function(b){b={tokenize:f,lastType:"sof",cc:[],lexical:new p((b||0)-Pa,0,"block",!1),localVars:c.localVars,
context:c.localVars&&{vars:c.localVars},indented:0};return c.globalVars&&"object"==typeof c.globalVars&&(b.globalVars=c.globalVars),b},token:function(b,c){if(b.sol()&&(c.lexical.hasOwnProperty("align")||(c.lexical.align=!1),c.indented=b.indentation(),l(b,c)),c.tokenize!=h&&b.eatSpace())return null;var e=c.tokenize(b,c);if("comment"!=Xa){c.lastType="operator"!=Xa||"++"!=zb&&"--"!=zb?Xa:"incdec";a:{var d=Xa,f=zb,g=c.cc;oa.state=c;oa.stream=b;oa.marked=null;oa.cc=g;for(c.lexical.hasOwnProperty("align")||
(c.lexical.align=!0);;)if((g.length?g.pop():Ib?B:z)(d,f)){for(;g.length&&g[g.length-1].lex;)g.pop()();if(oa.marked)e=oa.marked;else{if(d="variable"==d)b:{for(d=c.localVars;d;d=d.next)if(d.name==f){d=!0;break b}for(g=c.context;g;g=g.prev)for(d=g.vars;d;d=d.next)if(d.name==f){d=!0;break b}d=void 0}e=d?"variable-2":e}break a}e=void 0}}return e},indent:function(e,d){if(e.tokenize==h)return b.Pass;if(e.tokenize!=f)return 0;var g=d&&d.charAt(0),k=e.lexical;if(!/^\s*else\b/.test(d))for(var l=e.cc.length-
1;0<=l;--l){var p=e.cc[l];if(p==w)k=k.prev;else if(p!=Y)break}"stat"==k.type&&"}"==g&&(k=k.prev);va&&")"==k.type&&"stat"==k.prev.type&&(k=k.prev);l=k.type;p=g==l;return"vardef"==l?k.indented+("operator"==e.lastType||","==e.lastType?k.info+1:0):"form"==l&&"{"==g?k.indented:"form"==l?k.indented+Pa:"stat"==l?k.indented+("operator"==e.lastType||","==e.lastType?va||Pa:0):"switch"!=k.info||p||0==c.doubleIndentSwitch?k.align?k.column+(p?0:1):k.indented+(p?0:Pa):k.indented+(/^(?:case|default)\b/.test(d)?
Pa:2*Pa)},electricChars:":{}",blockCommentStart:Ib?null:"/*",blockCommentEnd:Ib?null:"*/",lineComment:Ib?null:"//",fold:"brace",helperType:Ib?"json":"javascript",jsonldMode:db,jsonMode:Ib}});b.defineMIME("text/javascript","javascript");b.defineMIME("text/ecmascript","javascript");b.defineMIME("application/javascript","javascript");b.defineMIME("application/ecmascript","javascript");b.defineMIME("application/json",{name:"javascript",json:!0});b.defineMIME("application/x-json",{name:"javascript",json:!0});
b.defineMIME("application/ld+json",{name:"javascript",jsonld:!0});b.defineMIME("text/typescript",{name:"javascript",typescript:!0});b.defineMIME("application/typescript",{name:"javascript",typescript:!0})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror",require("../xml/xml"))):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml"],b):b(CodeMirror)})(function(b){b.defineMode("markdown",function(d,c){function e(b){return b.linkTitle=!1,b.em=!1,b.strong=!1,b.quote=0,y||b.f!=g||(b.f=p,b.block=f),b.trailingSpace=0,b.trailingSpaceNewLine=!1,b.thisLineHasContent=!1,null}function f(b,e){var d=b.sol(),f=!1!==e.list;!1!==e.list&&0<=e.indentationDiff?
(4>e.indentationDiff&&(e.indentation-=e.indentationDiff),e.list=null):!1!==e.list&&0<e.indentation?(e.list=null,e.listDepth=Math.floor(e.indentation/4)):!1!==e.list&&(e.list=!1,e.listDepth=0);var g=null;return 4<=e.indentationDiff?(e.indentation-=4,b.skipToEnd(),E):b.eatSpace()?null:(g=b.match(na))?(e.header=6>=g[0].length?g[0].length:6,c.highlightFormatting&&(e.formatting="header"),e.f=e.inline,k(e)):e.prevLineHasContent&&(g=b.match(S))?(e.header="="==g[0].charAt(0)?1:2,c.highlightFormatting&&(e.formatting=
"header"),e.f=e.inline,k(e)):b.eat(">")?(e.indentation++,e.quote=d?1:e.quote+1,c.highlightFormatting&&(e.formatting="quote"),b.eatSpace(),k(e)):"["===b.peek()?(e.f=e.inline=t,t(b,e)):b.match(ca,!0)?aa:(!e.prevLineHasContent||f)&&(b.match(R,!1)||b.match(X,!1))?(d=null,b.match(R,!0)?d="ul":(b.match(X,!0),d="ol"),e.indentation+=4,e.list=!0,e.listDepth++,c.taskLists&&b.match(ba,!1)&&(e.taskList=!0),e.f=e.inline,c.highlightFormatting&&(e.formatting=["list","list-"+d]),k(e)):c.fencedCodeBlocks&&b.match(/^```([\w+#]*)/,
!0)?(e.localMode=A(RegExp.$1),e.localMode&&(e.localState=e.localMode.startState()),e.f=e.block=h,h(b,e),c.highlightFormatting&&(e.formatting="code-block"),e.code=!0,k(e)):(e.f=e.inline=e.inline,(0,e.inline)(b,e))}function g(b,c){var e=z.token(b,c.htmlState);return(y&&!c.htmlState.tagName&&!c.htmlState.context||c.md_inside&&-1<b.current().indexOf(">"))&&(c.f=p,c.block=f,c.htmlState=null),e}function h(b,e){if(b.sol()&&b.match(/^```/,!0)){e.localMode=e.localState=null;e.f=p;e.block=f;c.highlightFormatting&&
(e.formatting="code-block");e.code=!0;var d=k(e);return e.code=!1,d}return e.localMode?e.localMode.token(b,e.localState):(b.skipToEnd(),E)}function k(b){var e=[];if(b.formatting){e.push(M);"string"==typeof b.formatting&&(b.formatting=[b.formatting]);for(var d=0;d<b.formatting.length;d++)e.push(M+"-"+b.formatting[d]),"header"===b.formatting[d]&&e.push(M+"-"+b.formatting[d]+"-"+b.header),"quote"===b.formatting[d]&&(!c.maxBlockquoteDepth||c.maxBlockquoteDepth>=b.quote?e.push(M+"-"+b.formatting[d]+"-"+
b.quote):e.push("error"))}if(b.taskOpen)return e.push("meta"),e.length?e.join(" "):null;if(b.taskClosed)return e.push("property"),e.length?e.join(" "):null;if(b.linkHref)return e.push(C),e.length?e.join(" "):null;if(b.strong&&e.push(N),b.em&&e.push(Z),b.linkText&&e.push(V),b.code&&e.push(E),b.header&&(e.push(O),e.push(O+"-"+b.header)),b.quote&&(e.push(F),!c.maxBlockquoteDepth||c.maxBlockquoteDepth>=b.quote?e.push(F+"-"+b.quote):e.push(F+"-"+c.maxBlockquoteDepth)),!1!==b.list)(d=(b.listDepth-1)%3)?
1===d?e.push(H):e.push(G):e.push(U);return b.trailingSpaceNewLine?e.push("trailing-space-new-line"):b.trailingSpace&&e.push("trailing-space-"+(b.trailingSpace%2?"a":"b")),e.length?e.join(" "):null}function l(b,c){return b.match($,!0)?k(c):void 0}function p(e,d){var f=d.text(e,d);if("undefined"!=typeof f)return f;if(d.list)return d.list=null,k(d);if(d.taskList)return"x"!==e.match(ba,!0)[1]?d.taskOpen=!0:d.taskClosed=!0,c.highlightFormatting&&(d.formatting="task"),d.taskList=!1,k(d);if(d.taskOpen=!1,
d.taskClosed=!1,d.header&&e.match(/^#+$/,!0))return c.highlightFormatting&&(d.formatting="header"),k(d);var f=e.sol(),h=e.next();if(d.escape)return d.escape=!1,k(d);if("\\"===h)return c.highlightFormatting&&(d.formatting="escape"),d.escape=!0,k(d);if(d.linkTitle){d.linkTitle=!1;var l=h;"("===h&&(l=")");l=(l+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");if(e.match(RegExp("^\\s*(?:[^"+l+"\\\\]+|\\\\\\\\|\\\\.)"+l),!0))return C}if("`"===h)return f=d.formatting,c.highlightFormatting&&(d.formatting="code"),
h=k(d),l=e.pos,e.eatWhile("`"),l=1+e.pos-l,d.code?l===K?(d.code=!1,h):(d.formatting=f,k(d)):(K=l,d.code=!0,k(d));if(d.code)return k(d);if("!"===h&&e.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return e.match(/\[[^\]]*\]/),d.inline=d.f=r,D;if("["===h&&e.match(/.*\](\(| ?\[)/,!1))return d.linkText=!0,c.highlightFormatting&&(d.formatting="link"),k(d);if("]"===h&&d.linkText)return c.highlightFormatting&&(d.formatting="link"),f=k(d),d.linkText=!1,d.inline=d.f=r,f;if("<"===h&&e.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,
!1))return d.f=d.inline=q,c.highlightFormatting&&(d.formatting="link"),f=k(d),f?f+=" ":f="",f+I;if("<"===h&&e.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1))return d.f=d.inline=q,c.highlightFormatting&&(d.formatting="link"),f=k(d),f?f+=" ":f="",f+Q;if("<"===h&&e.match(/^\w/,!1))return-1!=e.string.indexOf(">")&&(f=e.string.substring(1,e.string.indexOf(">")),/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(f)&&(d.md_inside=!0)),e.backUp(1),d.htmlState=b.startState(z),d.f=d.block=g,g(e,d);if("<"===h&&e.match(/^\/\w*?>/))return d.md_inside=
!1,"tag";l=!1;if(!c.underscoresBreakWords&&"_"===h&&"_"!==e.peek()&&e.match(/(\w)/,!1)){var p=e.pos-2;0<=p&&(p=e.string.charAt(p),"_"!==p&&p.match(/(\w)/,!1)&&(l=!0))}if("*"===h||"_"===h&&!l){if(!(f&&" "===e.peek())){if(d.strong===h&&e.eat(h))return c.highlightFormatting&&(d.formatting="strong"),h=k(d),d.strong=!1,h;if(!d.strong&&e.eat(h))return d.strong=h,c.highlightFormatting&&(d.formatting="strong"),k(d);if(d.em===h)return c.highlightFormatting&&(d.formatting="em"),h=k(d),d.em=!1,h;if(!d.em)return d.em=
h,c.highlightFormatting&&(d.formatting="em"),k(d)}}else if(" "===h&&(e.eat("*")||e.eat("_"))){if(" "===e.peek())return k(d);e.backUp(1)}return" "===h&&(e.match(/ +$/,!1)?d.trailingSpace++:d.trailingSpace&&(d.trailingSpaceNewLine=!0)),k(d)}function q(b,e){if(">"===b.next()){e.f=e.inline=p;c.highlightFormatting&&(e.formatting="link");var d=k(e);return d?d+=" ":d="",d+I}return b.match(/^[^>]+/,!0),I}function r(b,e){if(b.eatSpace())return null;var d=b.next();return"("===d||"["===d?(e.f=e.inline=s("("===
d?")":"]"),c.highlightFormatting&&(e.formatting="link-string"),e.linkHref=!0,k(e)):"error"}function s(b){return function(e,d){if(e.next()===b){d.f=d.inline=p;c.highlightFormatting&&(d.formatting="link-string");var f=k(d);return d.linkHref=!1,f}return e.match(w(b),!0)&&e.backUp(1),d.linkHref=!0,k(d)}}function t(b,e){return b.match(/^[^\]]*\]:/,!1)?(e.f=u,b.next(),c.highlightFormatting&&(e.formatting="link"),e.linkText=!0,k(e)):(e.f=e.inline=p,p(b,e))}function u(b,e){if(b.match(/^\]:/,!0)){e.f=e.inline=
v;c.highlightFormatting&&(e.formatting="link");var d=k(e);return e.linkText=!1,d}return b.match(/^[^\]]+/,!0),V}function v(b,c){return b.eatSpace()?null:(b.match(/^[^\s]+/,!0),void 0===b.peek()?c.linkTitle=!0:b.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),c.f=c.inline=p,C)}function w(b){return ra[b]||(b=(b+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),ra[b]=RegExp("^(?:[^\\\\]|\\\\.)*?("+b+")")),ra[b]}var y=b.modes.hasOwnProperty("xml"),z=b.getMode(d,
y?{name:"xml",htmlMode:!0}:"text/plain"),B={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},A=function(){var c,e,f={},g={},h=[];for(e in b.modes)b.modes.propertyIsEnumerable(e)&&h.push(e);for(c=0;c<h.length;c++)f[h[c]]=h[c];h=[];for(e in b.mimeModes)b.mimeModes.propertyIsEnumerable(e)&&h.push({mime:e,mode:b.mimeModes[e]});for(c=0;c<h.length;c++)e=h[c].mime,g[e]=h[c].mime;
for(var k in B)(B[k]in f||B[k]in g)&&(f[k]=B[k]);return function(c){return f[c]?b.getMode(d,f[c]):null}}();void 0===c.highlightFormatting&&(c.highlightFormatting=!1);void 0===c.maxBlockquoteDepth&&(c.maxBlockquoteDepth=0);void 0===c.underscoresBreakWords&&(c.underscoresBreakWords=!0);void 0===c.fencedCodeBlocks&&(c.fencedCodeBlocks=!1);void 0===c.taskLists&&(c.taskLists=!1);var K=0,O="header",E="comment",F="quote",U="variable-2",H="variable-3",G="keyword",aa="hr",D="tag",M="formatting",I="link",Q=
"link",V="link",C="string",Z="em",N="strong",ca=/^([*\-=_])(?:\s*\1){2,}\s*$/,R=/^[*\-+]\s+/,X=/^[0-9]+\.\s+/,ba=/^\[(x| )\](?=\s)/,na=/^#+/,S=/^(?:\={1,}|-{1,})$/,$=/^[^#!\[\]*_\\<>` "'(]+/,ra=[],Y={startState:function(){return{f:f,prevLineHasContent:!1,thisLineHasContent:!1,block:f,htmlState:null,indentation:0,inline:p,text:l,escape:!1,formatting:!1,linkText:!1,linkHref:!1,linkTitle:!1,em:!1,strong:!1,header:0,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1}},copyState:function(c){return{f:c.f,
prevLineHasContent:c.prevLineHasContent,thisLineHasContent:c.thisLineHasContent,block:c.block,htmlState:c.htmlState&&b.copyState(z,c.htmlState),indentation:c.indentation,localMode:c.localMode,localState:c.localMode?b.copyState(c.localMode,c.localState):null,inline:c.inline,text:c.text,escape:!1,formatting:!1,linkTitle:c.linkTitle,em:c.em,strong:c.strong,header:c.header,taskList:c.taskList,list:c.list,listDepth:c.listDepth,quote:c.quote,trailingSpace:c.trailingSpace,trailingSpaceNewLine:c.trailingSpaceNewLine,
md_inside:c.md_inside}},token:function(b,c){if(c.formatting=!1,b.sol()){var d=b.match(/^\s*$/,!0)||c.header;if(c.header=0,d)return c.prevLineHasContent=!1,e(c),this.token(b,c);c.prevLineHasContent=c.thisLineHasContent;c.thisLineHasContent=!0;c.escape=!1;c.taskList=!1;c.code=!1;c.trailingSpace=0;c.trailingSpaceNewLine=!1;c.f=c.block;var d=b.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,f=4*Math.floor((d-c.indentation)/4);4<f&&(f=4);f=c.indentation+f;if(c.indentationDiff=f-c.indentation,c.indentation=
f,0<d)return null}d=c.f(b,c);return b.start==b.pos?this.token(b,c):d},innerMode:function(b){return b.block==g?{state:b.htmlState,mode:z}:b.localState?{state:b.localState,mode:b.localMode}:{state:b,mode:Y}},blankLine:e,getType:k,fold:"markdown"};return Y},"xml");b.defineMIME("text/x-markdown","markdown")});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.defineMode("sql",function(b,c){function e(b,c){var e=b.next();if(t[e]){var d=t[e](b,c);if(!1!==d)return d}if(1==s.hexNumber&&("0"==e&&b.match(/^[xX][0-9a-fA-F]+/)||("x"==e||"X"==e)&&b.match(/^'[0-9a-fA-F]+'/))||1==s.binaryNumber&&(("b"==e||"B"==e)&&b.match(/^'[01]+'/)||"0"==e&&b.match(/^b[01]+/)))return"number";
if(47<e.charCodeAt(0)&&58>e.charCodeAt(0))return b.match(/^[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/),1==s.decimallessFloat&&b.eat("."),"number";if("?"==e&&(b.eatSpace()||b.eol()||b.eat(";")))return"variable-3";if("'"==e||'"'==e&&s.doubleQuote)return c.tokenize=f(e),c.tokenize(b,c);if((1==s.nCharCast&&("n"==e||"N"==e)||1==s.charsetCast&&"_"==e&&b.match(/[a-z][a-z0-9]*/i))&&("'"==b.peek()||'"'==b.peek()))return"keyword";if(/^[\(\),\;\[\]]/.test(e))return null;if(s.commentSlashSlash&&"/"==e&&b.eat("/")||s.commentHash&&
"#"==e||"-"==e&&b.eat("-")&&(!s.commentSpaceRequired||b.eat(" ")))return b.skipToEnd(),"comment";if("/"==e&&b.eat("*"))return c.tokenize=g,c.tokenize(b,c);if("."!=e){if(r.test(e))return b.eatWhile(r),null;if("{"==e&&(b.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||b.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/)))return"number";b.eatWhile(/^[_\w\d]/);e=b.current().toLowerCase();return u.hasOwnProperty(e)&&(b.match(/^( )+'[^']*'/)||b.match(/^( )+"[^"]*"/))?"number":l.hasOwnProperty(e)?"atom":p.hasOwnProperty(e)?
"builtin":q.hasOwnProperty(e)?"keyword":k.hasOwnProperty(e)?"string-2":null}return 1==s.zerolessFloat&&b.match(/^(?:\d+(?:e[+-]?\d+)?)/i)?"number":1==s.ODBCdotTable&&b.match(/^[a-zA-Z_]+/)?"variable-2":void 0}function f(b){return function(c,d){for(var f,g=!1;null!=(f=c.next());){if(f==b&&!g){d.tokenize=e;break}g=!g&&"\\"==f}return"string"}}function g(b,c){for(;;){if(!b.skipTo("*")){b.skipToEnd();break}if(b.next(),b.eat("/")){c.tokenize=e;break}}return"comment"}function h(b,c,e){c.context={prev:c.context,
indent:b.indentation(),col:b.column(),type:e}}var k=c.client||{},l=c.atoms||{"false":!0,"true":!0,"null":!0},p=c.builtin||{},q=c.keywords||{},r=c.operatorChars||/^[*+\-%<>!=&|~^]/,s=c.support||{},t=c.hooks||{},u=c.dateSQL||{date:!0,time:!0,timestamp:!0};return{startState:function(){return{tokenize:e,context:null}},token:function(b,c){if(b.sol()&&c.context&&null==c.context.align&&(c.context.align=!1),b.eatSpace())return null;var e=c.tokenize(b,c);if("comment"==e)return e;c.context&&null==c.context.align&&
(c.context.align=!0);var d=b.current();"("==d?h(b,c,")"):"["==d?h(b,c,"]"):c.context&&c.context.type==d&&(c.indent=c.context.indent,c.context=c.context.prev);return e},indent:function(c,e){var f=c.context;if(!f)return 0;var g=e.charAt(0)==f.type;return f.align?f.col+(g?0:1):f.indent+(g?0:b.indentUnit)},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:s.commentSlashSlash?"//":s.commentHash?"#":null}});(function(){function d(b){for(var c;null!=(c=b.next());)if("`"==c&&!b.eat("`"))return"variable-2";
return null}function c(b){return b.eat("@")&&(b.match(/^session\./),b.match(/^local\./),b.match(/^global\./)),b.eat("'")?(b.match(/^.*'/),"variable-2"):b.eat('"')?(b.match(/^.*"/),"variable-2"):b.eat("`")?(b.match(/^.*`/),"variable-2"):b.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function e(b){return b.eat("N")?"atom":b.match(/^[a-zA-Z.#!?]/)?"variable-2":null}function f(b){var c={};b=b.split(" ");for(var e=0;e<b.length;++e)c[b[e]]=!0;return c}b.defineMIME("text/x-sql",{name:"sql",keywords:f("alter and as asc between by count create delete desc distinct drop from having in insert into is join like not on or order select set table union update values where begin"),
builtin:f("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:f("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:f("date time timestamp"),support:f("ODBCdotTable doubleQuote binaryNumber hexNumber")});b.defineMIME("text/x-mssql",
{name:"sql",client:f("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:f("alter and as asc between by count create delete desc distinct drop from having in insert into is join like not on or order select set table union update values where begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered"),builtin:f("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),
atoms:f("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:f("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":c}});b.defineMIME("text/x-mysql",{name:"sql",client:f("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:f("alter and as asc between by count create delete desc distinct drop from having in insert into is join like not on or order select set table union update values where accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group groupby_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),
builtin:f("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:f("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:f("date time timestamp"),support:f("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),
hooks:{"@":c,"`":d,"\\":e}});b.defineMIME("text/x-mariadb",{name:"sql",client:f("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:f("alter and as asc between by count create delete desc distinct drop from having in insert into is join like not on or order select set table union update values where accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),
builtin:f("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:f("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:f("date time timestamp"),support:f("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),
hooks:{"@":c,"`":d,"\\":e}});b.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:f("use select from using consistency where limit first reversed first and in insert into values using consistency ttl update set delete truncate begin batch apply create keyspace with columnfamily primary key index on drop alter type add any one quorum all local_quorum each_quorum"),builtin:f("ascii bigint blob boolean counter decimal double float int text timestamp uuid varchar varint"),atoms:f("false true"),
operatorChars:/^[<>=]/,dateSQL:{},support:f("commentSlashSlash decimallessFloat"),hooks:{}});b.defineMIME("text/x-plsql",{name:"sql",client:f("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),
keywords:f("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),
builtin:f("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least lenght lenghtb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),
operatorChars:/^[*+\-%<>!=~]/,dateSQL:f("date time timestamp"),support:f("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")});b.defineMIME("text/x-hive",{name:"sql",keywords:f("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),
builtin:f("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:f("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:f("date timestamp"),support:f("ODBCdotTable doubleQuote binaryNumber hexNumber")})})()});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.defineMode("xml",function(d,c){function e(b,c){function e(d){return c.tokenize=d,d(b,c)}var d=b.next();if("<"==d)return b.eat("!")?b.eat("[")?b.match("CDATA[")?e(h("atom","]]\x3e")):null:b.match("--")?e(h("comment","--\x3e")):b.match("DOCTYPE",!0,!0)?(b.eatWhile(/[\w\._\-]/),e(k(1))):null:b.eat("?")?
(b.eatWhile(/[\w\._\-]/),c.tokenize=h("meta","?>"),"meta"):(E=b.eat("/")?"closeTag":"openTag",c.tokenize=f,"tag bracket");if("&"==d){var g;return g=b.eat("#")?b.eat("x")?b.eatWhile(/[a-fA-F\d]/)&&b.eat(";"):b.eatWhile(/[\d]/)&&b.eat(";"):b.eatWhile(/[\w\.\-:]/)&&b.eat(";"),g?"atom":"error"}return b.eatWhile(/[^&<]/),null}function f(b,c){var d=b.next();return">"==d||"/"==d&&b.eat(">")?(c.tokenize=e,E=">"==d?"endTag":"selfcloseTag","tag bracket"):"="==d?(E="equals",null):"<"==d?(c.tokenize=e,c.state=
r,c.tagName=c.tagStart=null,(d=c.tokenize(b,c))?d+" error":"error"):/[\'\"]/.test(d)?(c.tokenize=g(d),c.stringStartCol=b.column(),c.tokenize(b,c)):(b.match(/^[^\s\u00a0=<>\"\']*[^\s\u00a0=<>\"\'\/]/),"word")}function g(b){var c=function(c,e){for(;!c.eol();)if(c.next()==b){e.tokenize=f;break}return"string"};return c.isInAttribute=!0,c}function h(b,c){return function(d,f){for(;!d.eol();){if(d.match(c)){f.tokenize=e;break}d.next()}return b}}function k(b){return function(c,d){for(var f;null!=(f=c.next());){if("<"==
f)return d.tokenize=k(b+1),d.tokenize(c,d);if(">"==f){if(1==b){d.tokenize=e;break}return d.tokenize=k(b-1),d.tokenize(c,d)}}return"meta"}}function l(b,c,e){this.prev=b.context;this.tagName=c;this.indent=b.indented;this.startOfLine=e;(U.doNotIndent.hasOwnProperty(c)||b.context&&b.context.noIndent)&&(this.noIndent=!0)}function p(b){b.context&&(b.context=b.context.prev)}function q(b,c){for(var e;b.context&&!(e=b.context.tagName,!U.contextGrabbers.hasOwnProperty(e)||!U.contextGrabbers[e].hasOwnProperty(c));)p(b)}
function r(b,c,e){return"openTag"==b?(e.tagStart=c.column(),s):"closeTag"==b?t:r}function s(b,c,e){return"word"==b?(e.tagName=c.current(),F="tag",w):(F="error",s)}function t(b,c,e){return"word"==b?(b=c.current(),e.context&&e.context.tagName!=b&&U.implicitlyClosed.hasOwnProperty(e.context.tagName)&&p(e),e.context&&e.context.tagName==b?(F="tag",u):(F="tag error",v)):(F="error",v)}function u(b,c,e){return"endTag"!=b?(F="error",u):(p(e),r)}function v(b,c,e){return F="error",u(b,c,e)}function w(b,c,e){if("word"==
b)return F="attribute",y;if("endTag"==b||"selfcloseTag"==b){c=e.tagName;var d=e.tagStart;return e.tagName=e.tagStart=null,"selfcloseTag"==b||U.autoSelfClosers.hasOwnProperty(c)?q(e,c):(q(e,c),e.context=new l(e,c,d==e.indented)),r}return F="error",w}function y(b,c,e){return"equals"==b?z:(U.allowMissing||(F="error"),w(b,c,e))}function z(b,c,e){return"string"==b?B:"word"==b&&U.allowUnquoted?(F="string",w):(F="error",w(b,c,e))}function B(b,c,e){return"string"==b?B:w(b,c,e)}var A=d.indentUnit,K=c.multilineTagIndentFactor||
1,O=c.multilineTagIndentPastTag;null==O&&(O=!0);var E,F,U=c.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,
div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0,caseFold:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1,caseFold:!1},
H=c.alignCDATA;return{startState:function(){return{tokenize:e,state:r,indented:0,tagName:null,tagStart:null,context:null}},token:function(b,c){if(!c.tagName&&b.sol()&&(c.indented=b.indentation()),b.eatSpace())return null;E=null;var e=c.tokenize(b,c);return(e||E)&&"comment"!=e&&(F=null,c.state=c.state(E||e,b,c),F&&(e="error"==F?e+" error":F)),e},indent:function(c,d,g){var h=c.context;if(c.tokenize.isInAttribute)return c.tagStart==c.indented?c.stringStartCol+1:c.indented+A;if(h&&h.noIndent)return b.Pass;
if(c.tokenize!=f&&c.tokenize!=e)return g?g.match(/^(\s*)/)[0].length:0;if(c.tagName)return O?c.tagStart+c.tagName.length+2:c.tagStart+A*K;if(H&&/<!\[CDATA\[/.test(d))return 0;if((c=d&&/^<(\/)?([\w_:\.-]*)/.exec(d))&&c[1])for(;h;){if(h.tagName==c[2]){h=h.prev;break}if(!U.implicitlyClosed.hasOwnProperty(h.tagName))break;h=h.prev}else if(c)for(;h;){d=U.contextGrabbers[h.tagName];if(!d||!d.hasOwnProperty(c[2]))break;h=h.prev}for(;h&&!h.startOfLine;)h=h.prev;return h?h.indent+A:0},electricInput:/<\/[\s\w:]+>$/,
blockCommentStart:"\x3c!--",blockCommentEnd:"--\x3e",configuration:c.htmlMode?"html":"xml",helperType:c.htmlMode?"html":"xml"}});b.defineMIME("text/xml","xml");b.defineMIME("application/xml","xml");b.mimeModes.hasOwnProperty("text/html")||b.defineMIME("text/html",{name:"xml",htmlMode:!0})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b,c){var e=b.getRange(g(c.line,c.ch-1),g(c.line,c.ch+1));return 2==e.length?e:null}function c(c){for(var e={name:"autoCloseBrackets",Backspace:function(e){if(e.getOption("disableInput"))return b.Pass;for(var f=e.listSelections(),k=0;k<f.length;k++){if(!f[k].empty())return b.Pass;var l=d(e,f[k].head);
if(!l||0!=c.indexOf(l)%2)return b.Pass}for(k=f.length-1;0<=k;k--)l=f[k].head,e.replaceRange("",g(l.line,l.ch-1),g(l.line,l.ch+1))}},l="",p=0;p<c.length;p+=2)!function(c,d){c!=d&&(l+=d);e["'"+c+"'"]=function(e){if(e.getOption("disableInput"))return b.Pass;for(var h,k,p=e.listSelections(),w=0;w<p.length;w++){var y=p[w],z=y.head;if("'"==c&&"comment"==e.getTokenTypeAt(z))return b.Pass;k=e.getRange(z,g(z.line,z.ch+1));if(y.empty())if(c==d&&k==d)k=e.getRange(z,g(z.line,z.ch+3))==c+c+c?"skipThree":"skip";
else if(c==d&&1<z.ch&&e.getRange(g(z.line,z.ch-2),z)==c+c&&(2>=z.ch||e.getRange(g(z.line,z.ch-3),g(z.line,z.ch-2))!=c))k="addFour";else{if(c==d&&b.isWordChar(k)||!(e.getLine(z.line).length==z.ch||0<=l.indexOf(k)||f.test(k)))return b.Pass;k="both"}else k="surround";if(h){if(h!=k)return b.Pass}else h=k}e.operation(function(){if("skip"==h)e.execCommand("goCharRight");else if("skipThree"==h)for(var b=0;3>b;b++)e.execCommand("goCharRight");else if("surround"==h){for(var f=e.getSelections(),b=0;b<f.length;b++)f[b]=
c+f[b]+d;e.replaceSelections(f,"around")}else"both"==h?(e.replaceSelection(c+d,null),e.execCommand("goCharLeft")):"addFour"==h&&(e.replaceSelection(c+c+c+c,"before"),e.execCommand("goCharRight"))})};c!=d&&(e["'"+d+"'"]=function(c){for(var e=c.listSelections(),f=0;f<e.length;f++){var h=e[f];if(!h.empty()||c.getRange(h.head,g(h.head.line,h.head.ch+1))!=d)return b.Pass}c.execCommand("goCharRight")})}(c.charAt(p),c.charAt(p+1));return e}function e(c){return function(e){if(e.getOption("disableInput"))return b.Pass;
for(var f=e.listSelections(),g=0;g<f.length;g++){if(!f[g].empty())return b.Pass;var q=d(e,f[g].head);if(!q||0!=c.indexOf(q)%2)return b.Pass}e.operation(function(){e.replaceSelection("\n\n",null);e.execCommand("goCharLeft");f=e.listSelections();for(var b=0;b<f.length;b++){var c=f[b].head.line;e.indentLine(c,null,!0);e.indentLine(c+1,null,!0)}})}}var f=/\s/,g=b.Pos;b.defineOption("autoCloseBrackets",!1,function(d,f,g){if(g!=b.Init&&g&&d.removeKeyMap("autoCloseBrackets"),f){var p="()[]{}''\"\"";g="[]{}";
"string"==typeof f?p=f:"object"==typeof f&&(null!=f.pairs&&(p=f.pairs),null!=f.explode&&(g=f.explode));f=c(p);g&&(f.Enter=e(g));d.addKeyMap(f)}})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],b):b(CodeMirror)})(function(b){function d(d){if(d.getOption("disableInput"))return b.Pass;for(var h=d.listSelections(),k=[],l=0;l<h.length;l++){if(!h[l].empty())return b.Pass;var p=h[l].head,q=d.getTokenAt(p),r=b.innerMode(d.getMode(),q.state),s=r.state;if("xml"!=r.mode.name||!s.tagName)return b.Pass;
var t=d.getOption("autoCloseTags"),u="html"==r.mode.configuration,r="object"==typeof t&&t.dontCloseTags||u&&e,u="object"==typeof t&&t.indentTags||u&&f,t=s.tagName;q.end>p.ch&&(t=t.slice(0,t.length-q.end+p.ch));var v=t.toLowerCase();if(!t||"string"==q.type&&(q.end!=p.ch||!/[\"\']/.test(q.string.charAt(q.string.length-1))||1==q.string.length)||"tag"==q.type&&"closeTag"==s.type||q.string.indexOf("/")==q.string.length-1||r&&-1<c(r,v)||b.scanForClosingTag&&b.scanForClosingTag(d,p,t,Math.min(d.lastLine()+
1,p.line+50)))return b.Pass;q=u&&-1<c(u,v);k[l]={indent:q,text:">"+(q?"\n\n":"")+"</"+t+">",newPos:q?b.Pos(p.line+1,0):b.Pos(p.line,p.ch+1)}}for(l=h.length-1;0<=l;l--)p=k[l],d.replaceRange(p.text,h[l].head,h[l].anchor,"+insert"),q=d.listSelections().slice(0),q[l]={head:p.newPos,anchor:p.newPos},d.setSelections(q),p.indent&&(d.indentLine(p.newPos.line,null,!0),d.indentLine(p.newPos.line+1,null,!0))}function c(b,c){if(b.indexOf)return b.indexOf(c);for(var e=0,d=b.length;d>e;++e)if(b[e]==c)return e;
return-1}b.defineOption("autoCloseTags",!1,function(c,e,f){if(f!=b.Init&&f&&c.removeKeyMap("autoCloseTags"),e)f={name:"autoCloseTags"},("object"!=typeof e||e.whenClosing)&&(f["'/'"]=function(c){a:if(c.getOption("disableInput"))c=b.Pass;else{for(var e=c.listSelections(),d=[],f=0;f<e.length;f++){if(!e[f].empty()){c=b.Pass;break a}var g=e[f].head,h=c.getTokenAt(g),k=b.innerMode(c.getMode(),h.state),v=k.state;if("string"==h.type||"<"!=h.string.charAt(0)||h.start!=g.ch-1||"xml"!=k.mode.name||!v.context||
!v.context.tagName){c=b.Pass;break a}d[f]="/"+v.context.tagName+">"}c.replaceSelections(d);c=void 0}return c}),("object"!=typeof e||e.whenOpening)&&(f["'>'"]=function(b){return d(b)}),c.addKeyMap(f)});var e="area base br col command embed hr img input keygen link meta param source track wbr".split(" "),f="applet blockquote body button div dl fieldset form frameset h1 h2 h3 h4 h5 h6 head html iframe layer legend object ol p select table ul".split(" ")});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../../mode/css/css")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../mode/css/css"],b):b(CodeMirror)})(function(b){var d={link:1,visited:1,active:1,hover:1,focus:1,"first-letter":1,"first-line":1,"first-child":1,before:1,after:1,lang:1};b.registerHelper("hint","css",function(c){function e(b){for(var c in b)k&&0!=c.lastIndexOf(k,0)||q.push(c)}var f=c.getCursor(),g=
c.getTokenAt(f),h=b.innerMode(c.getMode(),g.state);if("css"==h.mode.name){var k=g.string;c=g.start;var l=g.end;/[^\w$_-]/.test(k)&&(k="",c=l=f.ch);var p=b.resolveMode("text/css"),q=[],h=h.state.state;return"pseudo"==h||"variable-3"==g.type?e(d):"block"==h||"maybeprop"==h?e(p.propertyKeywords):"prop"==h||"parens"==h||"at"==h||"params"==h?(e(p.valueKeywords),e(p.colorKeywords)):("media"==h||"media_parens"==h)&&(e(p.mediaTypes),e(p.mediaFeatures)),q.length?{list:q,from:b.Pos(f.line,c),to:b.Pos(f.line,
l)}:void 0}})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b,c,d){var h;return h=b.getWrapperElement().appendChild(document.createElement("div")),h.className=d?"CodeMirror-dialog CodeMirror-dialog-bottom":"CodeMirror-dialog CodeMirror-dialog-top","string"==typeof c?h.innerHTML=c:h.appendChild(c),h}function c(b,c){b.state.currentNotificationClose&&b.state.currentNotificationClose();
b.state.currentNotificationClose=c}b.defineExtension("openDialog",function(e,f,g){function h(){p||(p=!0,l.parentNode.removeChild(l))}c(this,null);var k,l=d(this,e,g&&g.bottom),p=!1,q=this,r=l.getElementsByTagName("input")[0];return r?(g&&g.value&&(r.value=g.value),b.on(r,"keydown",function(c){g&&g.onKeyDown&&g.onKeyDown(c,r.value,h)||(13==c.keyCode||27==c.keyCode)&&(r.blur(),b.e_stop(c),h(),q.focus(),13==c.keyCode&&f(r.value))}),g&&g.onKeyUp&&b.on(r,"keyup",function(b){g.onKeyUp(b,r.value,h)}),g&&
g.value&&(r.value=g.value),r.focus(),b.on(r,"blur",h)):(k=l.getElementsByTagName("button")[0])&&(b.on(k,"click",function(){h();q.focus()}),k.focus(),b.on(k,"blur",h)),h});b.defineExtension("openConfirm",function(e,f,g){function h(){l||(l=!0,k.parentNode.removeChild(k),p.focus())}c(this,null);var k=d(this,e,g&&g.bottom);e=k.getElementsByTagName("button");var l=!1,p=this,q=1;e[0].focus();for(g=0;g<e.length;++g){var r=e[g];!function(c){b.on(r,"click",function(e){b.e_preventDefault(e);h();c&&c(p)})}(f[g]);
b.on(r,"blur",function(){--q;setTimeout(function(){0>=q&&h()},200)});b.on(r,"focus",function(){++q})}});b.defineExtension("openNotification",function(e,f){function g(){p||(p=!0,clearTimeout(h),k.parentNode.removeChild(k))}c(this,g);var h,k=d(this,e,f&&f.bottom),l=f&&(void 0===f.duration?5E3:f.duration),p=!1;b.on(k,"click",function(c){b.e_preventDefault(c);g()});l&&(h=setTimeout(g,f.duration))})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.defineOption("fullScreen",!1,function(d,c,e){e==b.Init&&(e=!1);!e!=!c&&(c?(c=d.getWrapperElement(),d.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:c.style.width,height:c.style.height},c.style.width="",c.style.height="auto",c.className+=" CodeMirror-fullscreen",
document.documentElement.style.overflow="hidden"):(c=d.getWrapperElement(),c.className=c.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="",e=d.state.fullScreenRestore,c.style.width=e.width,c.style.height=e.height,window.scrollTo(e.scrollLeft,e.scrollTop)),d.refresh())})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b){for(var c in q)q.hasOwnProperty(c)&&(b.attrs[c]=q[c])}var c="ab aa af ak sq am ar an hy as av ae ay az bm ba eu be bn bh bi bs br bg my ca ch ce ny zh cv kw co cr hr cs da dv nl dz en eo et ee fo fj fi fr ff gl ka de el gn gu ht ha he hz hi ho hu ia id ie ga ig ik io is it iu ja jv kl kn kr ks kk km ki rw ky kv kg ko ku kj la lb lg li ln lo lt lu lv gv mk mg ms ml mt mi mr mh mn na nv nb nd ne ng nn no ii nr oc oj cu om or os pa pi fa pl ps pt qu rm rn ro ru sa sc sd se sm sg sr gd sn si sk sl so st es su sw ss sv ta te tg th ti bo tk tl tn to tr ts tt tw ty ug uk ur uz ve vi vo wa cy wo fy xh yi yo za zu".split(" "),
e=["_blank","_self","_top","_parent"],f=["ascii","utf-8","utf-16","latin1","latin1"],g=["get","post","put","delete"],h=["application/x-www-form-urlencoded","multipart/form-data","text/plain"],k="all;screen;print;embossed;braille;handheld;print;projection;screen;tty;tv;speech;3d-glasses;resolution [>][<][=] [X];device-aspect-ratio: X/Y;orientation:portrait;orientation:landscape;device-height: [X];device-width: [X]".split(";"),l={attrs:{}},p={a:{attrs:{href:null,ping:null,type:null,media:k,target:e,
hreflang:c}},abbr:l,acronym:l,address:l,applet:l,area:{attrs:{alt:null,coords:null,href:null,target:null,ping:null,media:k,hreflang:c,type:null,shape:["default","rect","circle","poly"]}},article:l,aside:l,audio:{attrs:{src:null,mediagroup:null,crossorigin:["anonymous","use-credentials"],preload:["none","metadata","auto"],autoplay:["","autoplay"],loop:["","loop"],controls:["","controls"]}},b:l,base:{attrs:{href:null,target:e}},basefont:l,bdi:l,bdo:l,big:l,blockquote:{attrs:{cite:null}},body:l,br:l,
button:{attrs:{form:null,formaction:null,name:null,value:null,autofocus:["","autofocus"],disabled:["","autofocus"],formenctype:h,formmethod:g,formnovalidate:["","novalidate"],formtarget:e,type:["submit","reset","button"]}},canvas:{attrs:{width:null,height:null}},caption:l,center:l,cite:l,code:l,col:{attrs:{span:null}},colgroup:{attrs:{span:null}},command:{attrs:{type:["command","checkbox","radio"],label:null,icon:null,radiogroup:null,command:null,title:null,disabled:["","disabled"],checked:["","checked"]}},
data:{attrs:{value:null}},datagrid:{attrs:{disabled:["","disabled"],multiple:["","multiple"]}},datalist:{attrs:{data:null}},dd:l,del:{attrs:{cite:null,datetime:null}},details:{attrs:{open:["","open"]}},dfn:l,dir:l,div:l,dl:l,dt:l,em:l,embed:{attrs:{src:null,type:null,width:null,height:null}},eventsource:{attrs:{src:null}},fieldset:{attrs:{disabled:["","disabled"],form:null,name:null}},figcaption:l,figure:l,font:l,footer:l,form:{attrs:{action:null,name:null,"accept-charset":f,autocomplete:["on","off"],
enctype:h,method:g,novalidate:["","novalidate"],target:e}},frame:l,frameset:l,h1:l,h2:l,h3:l,h4:l,h5:l,h6:l,head:{attrs:{},children:"title base link style meta script noscript command".split(" ")},header:l,hgroup:l,hr:l,html:{attrs:{manifest:null},children:["head","body"]},i:l,iframe:{attrs:{src:null,srcdoc:null,name:null,width:null,height:null,sandbox:["allow-top-navigation","allow-same-origin","allow-forms","allow-scripts"],seamless:["","seamless"]}},img:{attrs:{alt:null,src:null,ismap:null,usemap:null,
width:null,height:null,crossorigin:["anonymous","use-credentials"]}},input:{attrs:{alt:null,dirname:null,form:null,formaction:null,height:null,list:null,max:null,maxlength:null,min:null,name:null,pattern:null,placeholder:null,size:null,src:null,step:null,value:null,width:null,accept:["audio/*","video/*","image/*"],autocomplete:["on","off"],autofocus:["","autofocus"],checked:["","checked"],disabled:["","disabled"],formenctype:h,formmethod:g,formnovalidate:["","novalidate"],formtarget:e,multiple:["",
"multiple"],readonly:["","readonly"],required:["","required"],type:"hidden text search tel url email password datetime date month week time datetime-local number range color checkbox radio file submit image reset button".split(" ")}},ins:{attrs:{cite:null,datetime:null}},kbd:l,keygen:{attrs:{challenge:null,form:null,name:null,autofocus:["","autofocus"],disabled:["","disabled"],keytype:["RSA"]}},label:{attrs:{"for":null,form:null}},legend:l,li:{attrs:{value:null}},link:{attrs:{href:null,type:null,
hreflang:c,media:k,sizes:["all","16x16","16x16 32x32","16x16 32x32 64x64"]}},map:{attrs:{name:null}},mark:l,menu:{attrs:{label:null,type:["list","context","toolbar"]}},meta:{attrs:{content:null,charset:f,name:"viewport application-name author description generator keywords".split(" "),"http-equiv":["content-language","content-type","default-style","refresh"]}},meter:{attrs:{value:null,min:null,low:null,high:null,max:null,optimum:null}},nav:l,noframes:l,noscript:l,object:{attrs:{data:null,type:null,
name:null,usemap:null,form:null,width:null,height:null,typemustmatch:["","typemustmatch"]}},ol:{attrs:{reversed:["","reversed"],start:null,type:["1","a","A","i","I"]}},optgroup:{attrs:{disabled:["","disabled"],label:null}},option:{attrs:{disabled:["","disabled"],label:null,selected:["","selected"],value:null}},output:{attrs:{"for":null,form:null,name:null}},p:l,param:{attrs:{name:null,value:null}},pre:l,progress:{attrs:{value:null,max:null}},q:{attrs:{cite:null}},rp:l,rt:l,ruby:l,s:l,samp:l,script:{attrs:{type:["text/javascript"],
src:null,async:["","async"],defer:["","defer"],charset:f}},section:l,select:{attrs:{form:null,name:null,size:null,autofocus:["","autofocus"],disabled:["","disabled"],multiple:["","multiple"]}},small:l,source:{attrs:{src:null,type:null,media:null}},span:l,strike:l,strong:l,style:{attrs:{type:["text/css"],media:k,scoped:null}},sub:l,summary:l,sup:l,table:l,tbody:l,td:{attrs:{colspan:null,rowspan:null,headers:null}},textarea:{attrs:{dirname:null,form:null,maxlength:null,name:null,placeholder:null,rows:null,
cols:null,autofocus:["","autofocus"],disabled:["","disabled"],readonly:["","readonly"],required:["","required"],wrap:["soft","hard"]}},tfoot:l,th:{attrs:{colspan:null,rowspan:null,headers:null,scope:["row","col","rowgroup","colgroup"]}},thead:l,time:{attrs:{datetime:null}},title:l,tr:l,track:{attrs:{src:null,label:null,"default":null,kind:["subtitles","captions","descriptions","chapters","metadata"],srclang:c}},tt:l,u:l,ul:l,"var":l,video:{attrs:{src:null,poster:null,width:null,height:null,crossorigin:["anonymous",
"use-credentials"],preload:["auto","metadata","none"],autoplay:["","autoplay"],mediagroup:["movie"],muted:["","muted"],controls:["","controls"]}},wbr:l},q={accesskey:"abcdefghijklmnopqrstuvwxyz0123456789".split(""),"class":null,contenteditable:["true","false"],contextmenu:null,dir:["ltr","rtl","auto"],draggable:["true","false","auto"],dropzone:["copy","move","link","string:","file:"],hidden:["hidden"],id:null,inert:["inert"],itemid:null,itemprop:null,itemref:null,itemscope:["itemscope"],itemtype:null,
lang:["en","es"],spellcheck:["true","false"],style:null,tabindex:"123456789".split(""),title:null,translate:["yes","no"],onclick:null,rel:"stylesheet alternate author bookmark help license next nofollow noreferrer prefetch prev search tag".split(" ")};d(l);for(var r in p)p.hasOwnProperty(r)&&p[r]!=l&&d(p[r]);b.htmlSchema=p;b.registerHelper("hint","html",function(c,e){var d={schemaInfo:p};if(e)for(var f in e)d[f]=e[f];return b.hint.xml(c,d)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b,c){for(var e=0,d=b.length;d>e;++e)c(b[e])}function c(c,e,d,h){var k=c.getCursor(),l=d(c,k),p=l;if(!/\b(?:string|comment)\b/.test(l.type)){l.state=b.innerMode(c.getMode(),l.state).state;for(/^[\w$_]*$/.test(l.string)||(l=p={start:k.ch,end:k.ch,string:"",state:l.state,type:"."==l.string?"property":
null});"property"==p.type;){if(p=d(c,g(k.line,p.start)),"."!=p.string)return;if(p=d(c,g(k.line,p.start)),!q)var q=[];q.push(p)}return{list:f(l,q,e,h),from:g(k.line,l.start),to:g(k.line,l.end)}}}function e(b,c){var e=b.getTokenAt(c);return c.ch==e.start+1&&"."==e.string.charAt(0)?(e.end=e.start,e.string=".",e.type="property"):/^\.[\w$_]*$/.test(e.string)&&(e.type="property",e.start++,e.string=e.string.replace(/\./,"")),e}function f(b,c,e,f){function g(b){if(0==b.lastIndexOf(z,0)){var c;a:if(Array.prototype.indexOf)c=
-1!=q.indexOf(b);else{for(c=q.length;c--;)if(q[c]===b){c=!0;break a}c=!1}c||q.push(b)}}function p(b){"string"==typeof b?d(h,g):b instanceof Array?d(k,g):b instanceof Function&&d(l,g);for(var c in b)g(c)}var q=[],z=b.string;if(c&&c.length){var B;b=c.pop();for(b.type&&0===b.type.indexOf("variable")?(f&&f.additionalContext&&(B=f.additionalContext[b.string]),B=B||window[b.string]):"string"==b.type?B="":"atom"==b.type?B=1:"function"==b.type&&(null==window.jQuery||"$"!=b.string&&"jQuery"!=b.string||"function"!=
typeof window.jQuery?null!=window._&&"_"==b.string&&"function"==typeof window._&&(B=window._()):B=window.jQuery());null!=B&&c.length;)B=B[c.pop().string];null!=B&&p(B)}else{for(c=b.state.localVars;c;c=c.next)g(c.name);for(c=b.state.globalVars;c;c=c.next)g(c.name);p(window);d(e,g)}return q}var g=b.Pos;b.registerHelper("hint","javascript",function(b,e){return c(b,p,function(b,c){return b.getTokenAt(c)},e)});b.registerHelper("hint","coffeescript",function(b,d){return c(b,q,e,d)});var h="charAt charCodeAt indexOf lastIndexOf substring substr slice trim trimLeft trimRight toUpperCase toLowerCase split concat match replace search".split(" "),
k="length concat join splice push pop shift unshift slice reverse sort indexOf lastIndexOf every some filter forEach map reduce reduceRight ".split(" "),l=["prototype","apply","call","bind"],p="break case catch continue debugger default delete do else false finally for function if in instanceof new null return switch throw true try typeof var void while with".split(" "),q="and break catch class continue delete do else extends false finally for if in instanceof isnt new no not null of off on or return switch then throw true try typeof until void while with yes".split(" ")});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b,e,d,f){var g=b.getLineHandle(e.line),l=e.ch-1,g=0<=l&&k[g.text.charAt(l)]||k[g.text.charAt(++l)];if(!g)return null;var v=">"==g.charAt(1)?1:-1;if(d&&0<v!=(l==e.ch))return null;d=b.getTokenTypeAt(h(e.line,l+1));b=c(b,h(e.line,l+(0<v?1:0)),v,d||null,f);return null==b?null:{from:h(e.line,l),
to:b&&b.pos,match:b&&b.ch==g.charAt(0),forward:0<v}}function c(b,c,e,d,f){var g=f&&f.maxScanLineLength||1E4,l=f&&f.maxScanLines||1E3,w=[];f=f&&f.bracketRegex?f.bracketRegex:/[(){}[\]]/;for(var l=0<e?Math.min(c.line+l,b.lastLine()+1):Math.max(b.firstLine()-1,c.line-l),y=c.line;y!=l;y+=e){var z=b.getLine(y);if(z){var B=0<e?0:z.length-1,A=0<e?z.length:-1;if(!(z.length>g))for(y==c.line&&(B=c.ch-(0>e?1:0));B!=A;B+=e){var K=z.charAt(B);if(f.test(K)&&(void 0===d||b.getTokenTypeAt(h(y,B+1))==d))if(">"==k[K].charAt(1)==
0<e)w.push(K);else{if(!w.length)return{pos:h(y,B),ch:K};w.pop()}}}}return y-e==(0<e?b.lastLine():b.firstLine())?!1:null}function e(b,c,e){for(var f=b.state.matchBrackets.maxHighlightLineLength||1E3,k=[],l=b.listSelections(),v=0;v<l.length;v++){var w=l[v].empty()&&d(b,l[v].head,!1,e);if(w&&b.getLine(w.from.line).length<=f){var y=w.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";k.push(b.markText(w.from,h(w.from.line,w.from.ch+1),{className:y}));w.to&&b.getLine(w.to.line).length<=
f&&k.push(b.markText(w.to,h(w.to.line,w.to.ch+1),{className:y}))}}if(k.length){g&&b.state.focused&&b.display.input.focus();e=function(){b.operation(function(){for(var b=0;b<k.length;b++)k[b].clear()})};if(!c)return e;setTimeout(e,800)}}function f(b){b.operation(function(){l&&(l(),l=null);l=e(b,!1,b.state.matchBrackets)})}var g=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||8>document.documentMode),h=b.Pos,k={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},l=null;b.defineOption("matchBrackets",
!1,function(c,e,d){d&&d!=b.Init&&c.off("cursorActivity",f);e&&(c.state.matchBrackets="object"==typeof e?e:{},c.on("cursorActivity",f))});b.defineExtension("matchBrackets",function(){e(this,!0)});b.defineExtension("findMatchingBracket",function(b,c,e){return d(this,b,c,e)});b.defineExtension("scanForBracket",function(b,e,d,f){return c(this,b,e,d,f)})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../fold/xml-fold")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],b):b(CodeMirror)})(function(b){function d(b){b.state.tagHit&&b.state.tagHit.clear();b.state.tagOther&&b.state.tagOther.clear();b.state.tagHit=b.state.tagOther=null}function c(c){c.state.failedTagMatch=!1;c.operation(function(){if(d(c),!c.somethingSelected()){var e=c.getCursor(),h=c.getViewport();
h.from=Math.min(h.from,e.line);h.to=Math.max(e.line+1,h.to);if(e=b.findMatchingTag(c,e,h))c.state.matchBothTags&&(h="open"==e.at?e.open:e.close)&&(c.state.tagHit=c.markText(h.from,h.to,{className:"CodeMirror-matchingtag"})),(e="close"==e.at?e.open:e.close)?c.state.tagOther=c.markText(e.from,e.to,{className:"CodeMirror-matchingtag"}):c.state.failedTagMatch=!0}})}function e(b){b.state.failedTagMatch&&c(b)}b.defineOption("matchTags",!1,function(f,g,h){h&&h!=b.Init&&(f.off("cursorActivity",c),f.off("viewportChange",
e),d(f));g&&(f.state.matchBothTags="object"==typeof g&&g.bothTags,f.on("cursorActivity",c),f.on("viewportChange",e),c(f))});b.commands.toMatchingTag=function(c){var e=b.findMatchingTag(c,c.getCursor());e&&(e="close"==e.at?e.open:e.close)&&c.extendSelection(e.to,e.from)}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){b.runMode=function(d,c,e,f){c=b.getMode(b.defaults,c);var g=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||9>document.documentMode);if(1==e.nodeType){var h=f&&f.tabSize||b.defaults.tabSize,k=e,l=0;k.innerHTML="";e=function(b,c){if("\n"==b)return k.appendChild(document.createTextNode(g?
"\r":b)),l=0,void 0;for(var e="",d=0;;){var f=b.indexOf("\t",d);if(-1==f){e+=b.slice(d);l+=b.length-d;break}l+=f-d;e+=b.slice(d,f);d=h-l%h;l+=d;for(var p=0;d>p;++p)e+=" ";d=f+1}c?(f=k.appendChild(document.createElement("span")),f.className="cm-"+c.replace(/ +/g," cm-"),f.appendChild(document.createTextNode(e))):k.appendChild(document.createTextNode(e))}}d=b.splitLines(d);f=f&&f.state||b.startState(c);for(var p=0,q=d.length;q>p;++p){p&&e("\n");var r=new b.StringStream(d[p]);for(!r.string&&c.blankLine&&
c.blankLine(f);!r.eol();){var s=c.token(r,f);e(r.current(),s,p,r.start,f);r.start=r.pos}}}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b,c,e){this.cm=b;this.getHints=c;this.options=e;this.widget=this.onClose=null}function c(b,c){function e(b,g){var h;h="string"!=typeof g?function(b){return g(b,c)}:d.hasOwnProperty(g)?d[g]:g;f[b]=h}var d={Up:function(){c.moveFocus(-1)},Down:function(){c.moveFocus(1)},PageUp:function(){c.moveFocus(-c.menuSize()+
1,!0)},PageDown:function(){c.moveFocus(c.menuSize()-1,!0)},Home:function(){c.setFocus(0)},End:function(){c.setFocus(c.length-1)},Enter:c.pick,Tab:c.pick,Esc:c.close},f=b.customKeys?{}:d;if(b.customKeys)for(var g in b.customKeys)b.customKeys.hasOwnProperty(g)&&e(g,b.customKeys[g]);if(b.extraKeys)for(g in b.extraKeys)b.extraKeys.hasOwnProperty(g)&&e(g,b.extraKeys[g]);return f}function e(b,c){for(;c&&c!=b;){if("LI"===c.nodeName.toUpperCase()&&c.parentNode==b)return c;c=c.parentNode}}function f(d,f){this.completion=
d;this.data=f;var p=this,q=d.cm,r=d.options,s=this.hints=document.createElement("ul");s.className="CodeMirror-hints";this.selectedHint=r.getDefaultSelection?r.getDefaultSelection(q,r,f):0;for(var t=f.list,u=0;u<t.length;++u){var v=s.appendChild(document.createElement("li")),w=t[u],y=g+(u!=this.selectedHint?"":" "+h);null!=w.className&&(y=w.className+" "+y);v.className=y;w.render?w.render(v,f,w):v.appendChild(document.createTextNode(w.displayText||("string"==typeof w?w:w.text)));v.hintId=u}var u=q.cursorCoords(!1!==
r.alignWithWord?f.from:null),z=u.left,B=u.bottom,A=!0;s.style.left=z+"px";s.style.top=B+"px";v=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth);y=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(r.container||document.body).appendChild(s);w=s.getBoundingClientRect();if(0<w.bottom-y){var K=w.bottom-w.top,O=w.top-(u.bottom-u.top);0<O-K?(s.style.top=(B=O-K)+"px",A=!1):K>y&&(s.style.height=y-5+"px",s.style.top=(B=
u.bottom-w.top)+"px",y=q.getCursor(),f.from.ch!=y.ch&&(u=q.cursorCoords(y),s.style.left=(z=u.left)+"px",w=s.getBoundingClientRect()))}y=w.left-v;if(0<y&&(w.right-w.left>v&&(s.style.width=v-5+"px",y-=w.right-w.left-v),s.style.left=(z=u.left-y)+"px"),q.addKeyMap(this.keyMap=c(r,{moveFocus:function(b,c){p.changeActive(p.selectedHint+b,c)},setFocus:function(b){p.changeActive(b)},menuSize:function(){return p.screenAmount()},length:t.length,close:function(){d.close()},pick:function(){p.pick()},data:f})),
!1!==r.closeOnUnfocus){var E;q.on("blur",this.onBlur=function(){E=setTimeout(function(){d.close()},100)});q.on("focus",this.onFocus=function(){clearTimeout(E)})}var F=q.getScrollInfo();return q.on("scroll",this.onScroll=function(){var b=q.getScrollInfo(),c=q.getWrapperElement().getBoundingClientRect(),e=B+F.top-b.top,f=e-(window.pageYOffset||(document.documentElement||document.body).scrollTop);return A||(f+=s.offsetHeight),f<=c.top||f>=c.bottom?d.close():(s.style.top=e+"px",s.style.left=z+F.left-
b.left+"px",void 0)}),b.on(s,"dblclick",function(b){(b=e(s,b.target||b.srcElement))&&null!=b.hintId&&(p.changeActive(b.hintId),p.pick())}),b.on(s,"click",function(b){(b=e(s,b.target||b.srcElement))&&null!=b.hintId&&(p.changeActive(b.hintId),r.completeOnSingleClick&&p.pick())}),b.on(s,"mousedown",function(){setTimeout(function(){q.focus()},20)}),b.signal(f,"select",t[0],s.firstChild),!0}var g="CodeMirror-hint",h="CodeMirror-hint-active";b.showHint=function(c,e,f){if(!(1<c.listSelections().length||
c.somethingSelected())){if(null==e){if(f&&f.async)return;e=b.hint.auto}c.state.completionActive&&c.state.completionActive.close();var g=c.state.completionActive=new d(c,e,f||{});return b.signal(c,"startCompletion",c),g.options.async?(e(c,function(b){g.showHints(b)},g.options),void 0):g.showHints(e(c,g.options))}};d.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.widget&&this.widget.close(),this.onClose&&this.onClose(),b.signal(this.cm,"endCompletion",this.cm))},
active:function(){return this.cm.state.completionActive==this},pick:function(c,e){var d=c.list[e];d.hint?d.hint(this.cm,c,d):this.cm.replaceRange("string"==typeof d?d:d.text,d.from||c.from,d.to||c.to,"complete");b.signal(c,"pick",d);this.close()},showHints:function(b){return b&&b.list.length&&this.active()?(0!=this.options.completeSingle&&1==b.list.length?this.pick(b,0):this.showWidget(b),void 0):this.close()},showWidget:function(c){function e(){s||(s=!0,u.close(),u.cm.off("cursorActivity",h),c&&
b.signal(c,"close"))}function d(){s||(b.signal(c,"update"),u.options.async?u.getHints(u.cm,g,u.options):g(u.getHints(u.cm,u.options)))}function g(b){if(c=b,!s){if(!c||!c.list.length)return e();u.widget&&u.widget.close();u.widget=new f(u,c)}}function h(){t&&(B(t),t=0);var b=u.cm.getCursor(),c=u.cm.getLine(b.line);b.line!=w.line||c.length-b.ch!=y-w.ch||b.ch<w.ch||u.cm.somethingSelected()||b.ch&&v.test(c.charAt(b.ch-1))?u.close():(t=z(d),u.widget&&u.widget.close())}this.widget=new f(this,c);b.signal(c,
"shown");var s,t=0,u=this,v=this.options.closeCharacters||/[\s()\[\]{};:>,]/,w=this.cm.getCursor(),y=this.cm.getLine(w.line).length,z=window.requestAnimationFrame||function(b){return setTimeout(b,1E3/60)},B=window.cancelAnimationFrame||clearTimeout;this.cm.on("cursorActivity",h);this.onClose=e}};f.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null;this.hints.parentNode.removeChild(this.hints);this.completion.cm.removeKeyMap(this.keyMap);var b=this.completion.cm;
!1!==this.completion.options.closeOnUnfocus&&(b.off("blur",this.onBlur),b.off("focus",this.onFocus));b.off("scroll",this.onScroll)}},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(c,e){if(c>=this.data.list.length?c=e?this.data.list.length-1:0:0>c&&(c=e?0:this.data.list.length-1),this.selectedHint!=c){var d=this.hints.childNodes[this.selectedHint];d.className=d.className.replace(" "+h,"");d=this.hints.childNodes[this.selectedHint=c];d.className+=" "+h;d.offsetTop<
this.hints.scrollTop?this.hints.scrollTop=d.offsetTop-3:d.offsetTop+d.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=d.offsetTop+d.offsetHeight-this.hints.clientHeight+3);b.signal(this.data,"select",this.data.list[this.selectedHint],d)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}};b.registerHelper("hint","auto",function(c,e){var d;d=c.getHelpers(c.getCursor(),"hint");if(d.length)for(var f=0;f<d.length;f++){var g=
d[f](c,e);if(g&&g.list.length)return g}else if(d=c.getHelper(c.getCursor(),"hintWords")){if(d)return b.hint.fromList(c,{words:d})}else if(b.hint.anyword)return b.hint.anyword(c,e)});b.registerHelper("hint","fromList",function(c,e){for(var d=c.getCursor(),f=c.getTokenAt(d),g=[],h=0;h<e.words.length;h++){var t=e.words[h];t.slice(0,f.string.length)==f.string&&g.push(t)}return g.length?{list:g,from:b.Pos(d.line,f.start),to:b.Pos(d.line,f.end)}:void 0});b.commands.autocomplete=b.showHint});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror"),require("../../mode/sql/sql")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],b):b(CodeMirror)})(function(b){function d(c){c=c.doc.modeOption;return"sql"===c&&(c="text/x-sql"),b.resolveMode(c).keywords}function c(b,c,e,d){for(var f in e)if(e.hasOwnProperty(f)){Array.isArray(e)&&(f=e[f]);var g=c,h=f.substr(0,g.length);g.toUpperCase()===h.toUpperCase()&&b.push(d(f))}}
function e(b,e){var d=e.getCursor(),f=e.getTokenAt(d),g=f.string.substr(1),d=q(d.line,f.start),d=e.getTokenAt(d).string;k.hasOwnProperty(d)||(d=h(d,e));(d=k[d])&&c(b,g,d,function(b){return"."+b})}function f(b,c){if(b)for(var e=/[,;]/g,d=b.split(" "),f=0;f<d.length;f++)c(d[f]?d[f].replace(e,""):"")}function g(b){return b.line+b.ch/Math.pow(10,6)}function h(b,c){for(var e=c.doc,d=e.getValue(),h=b.toUpperCase(),l="",y="",z=[],B=q(0,0),A=q(c.lastLine(),c.getLineHandle(c.lastLine()).length),K=d.indexOf(p.QUERY_DIV);-1!=
K;)z.push(e.posFromIndex(K)),K=d.indexOf(p.QUERY_DIV,K+1);z.unshift(q(0,0));z.push(q(c.lastLine(),c.getLineHandle(c.lastLine()).text.length));for(var K=0,O=g(c.getCursor()),d=0;d<z.length;d++){var E=g(z[d]);if(O>K&&E>=O){B=q(Math.floor(K),+K.toString().split(".").pop());A=q(Math.floor(E),+E.toString().split(".").pop());break}K=E}e=e.getRange(B,A,!1);for(d=0;d<e.length&&!(f(e[d],function(b){var c=b.toUpperCase();c===h&&k.hasOwnProperty(l)&&(y=l);c!==p.ALIAS_KEYWORD&&(l=b)}),y);d++);return y}var k,
l,p={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},q=b.Pos;b.registerHelper("hint","sql",function(b,f){k=f&&f.tables||{};l=l||d(b);var g=b.getCursor(),h=b.getTokenAt(g),p=h.end,w=[],y=h.string.trim();if("."==y.charAt(0)){if(e(w,b),!w.length){for(;h.start&&"."==y.charAt(0);)h=b.getTokenAt(q(g.line,h.start-1)),y=h.string+y;c(w,y,k,function(b){return b})}}else c(w,y,l,function(b){return b.toUpperCase()}),c(w,y,k,function(b){return b});return{list:w,from:q(g.line,h.start),to:q(g.line,p)}})});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){function d(b,c,e,d){this.line=c;this.ch=e;this.cm=b;this.text=b.getLine(c);this.min=d?d.from:b.firstLine();this.max=d?d.to-1:b.lastLine()}function c(b,c){var e=b.cm.getTokenTypeAt(q(b.line,c));return e&&/\btag\b/.test(e)}function e(b){return b.line>=b.max?void 0:(b.ch=0,b.text=b.cm.getLine(++b.line),!0)}
function f(b){return b.line<=b.min?void 0:(b.text=b.cm.getLine(--b.line),b.ch=b.text.length,!0)}function g(b){for(;;){var d=b.text.indexOf(">",b.ch);if(-1==d){if(e(b))continue;break}if(c(b,d+1)){var f=b.text.lastIndexOf("/",d),f=-1<f&&!/\S/.test(b.text.slice(f+1,d));return b.ch=d+1,f?"selfClose":"regular"}b.ch=d+1}}function h(b){for(;;){var e=b.ch?b.text.lastIndexOf("<",b.ch-1):-1;if(-1==e){if(f(b))continue;break}if(c(b,e+1)){r.lastIndex=e;b.ch=e;var d=r.exec(b.text);if(d&&d.index==e)return d}else b.ch=
e}}function k(b){for(;;){r.lastIndex=b.ch;var d=r.exec(b.text);if(!d){if(e(b))continue;break}if(c(b,d.index+1))return b.ch=d.index+d[0].length,d;b.ch=d.index+1}}function l(b,c){for(var e=[];;){var d,f=k(b),h=b.line,l=b.ch-(f?f[0].length:0);if(!f||!(d=g(b)))break;if("selfClose"!=d)if(f[1]){for(var p=e.length-1;0<=p;--p)if(e[p]==f[2]){e.length=p;break}if(0>p&&(!c||c==f[2]))return{tag:f[2],from:q(h,l),to:q(b.line,b.ch)}}else e.push(f[2])}}function p(b,e){for(var d=[];;){var g;a:{for(g=b;;){var k=g.ch?
g.text.lastIndexOf(">",g.ch-1):-1;if(-1==k){if(f(g))continue;g=void 0;break a}if(c(g,k+1)){var l=g.text.lastIndexOf("/",k),l=-1<l&&!/\S/.test(g.text.slice(l+1,k));g=(g.ch=k+1,l?"selfClose":"regular");break a}g.ch=k}g=void 0}if(!g)break;if("selfClose"!=g){g=b.line;k=b.ch;l=h(b);if(!l)break;if(l[1])d.push(l[2]);else{for(var p=d.length-1;0<=p;--p)if(d[p]==l[2]){d.length=p;break}if(0>p&&(!e||e==l[2]))return{tag:l[2],from:q(b.line,b.ch),to:q(g,k)}}}else h(b)}}var q=b.Pos,r=RegExp("<(/?)([A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*)",
"g");b.registerHelper("fold","xml",function(b,c){for(var e=new d(b,c.line,0);;){var f,h=k(e);if(!h||e.line!=c.line||!(f=g(e)))break;if(!h[1]&&"selfClose"!=f)return c=q(e.line,e.ch),(e=l(e,h[2]))&&{from:c,to:e.from}}});b.findMatchingTag=function(b,c,e){var f=new d(b,c.line,c.ch,e);if(-1!=f.text.indexOf(">")||-1!=f.text.indexOf("<")){var k=g(f),r=k&&q(f.line,f.ch),z=k&&h(f);if(k&&"selfClose"!=k&&z&&!(0<(f.line-c.line||f.ch-c.ch)))return c={from:q(f.line,f.ch),to:r,tag:z[2]},z[1]?{open:p(f,z[2]),close:c,
at:"close"}:(f=new d(b,r.line,r.ch,e),{open:c,close:l(f,z[2]),at:"open"})}};b.findEnclosingTag=function(b,c,e){for(var f=new d(b,c.line,c.ch,e);;){var g=p(f);if(!g)break;var h=new d(b,c.line,c.ch,e);if(h=l(h,g.tag))return{open:g,close:h}}};b.scanForClosingTag=function(b,c,e,f){b=new d(b,c.line,c.ch,f?{from:0,to:f}:null);return!!l(b,e)}});
(function(b){"object"==typeof exports&&"object"==typeof module?b(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],b):b(CodeMirror)})(function(b){var d=b.Pos;b.registerHelper("hint","xml",function(c,e){var f=e&&e.schemaInfo,g=e&&e.quoteChar||'"';if(f){var h=c.getCursor(),k=c.getTokenAt(h),l=b.innerMode(c.getMode(),k.state);if("xml"==l.mode.name){var p,q,r=[],s=!1,t=/\btag\b/.test(k.type),u=t&&/^\w/.test(k.string);if(u){var v=c.getLine(h.line).slice(Math.max(0,
k.start-2),k.start);(v=/<\/$/.test(v)?"close":/<$/.test(v)?"open":null)&&(q=k.start-("close"==v?2:1))}else t&&"<"==k.string?v="open":t&&"</"==k.string&&(v="close");if(!t&&!l.state.tagName||v){u&&(p=k.string);var s=v,l=(g=l.state.context)&&f[g.tagName],w=g?l&&l.children:f["!top"];if(w&&"close"!=v)for(f=0;f<w.length;++f)p&&0!=w[f].lastIndexOf(p,0)||r.push("<"+w[f]);else if("close"!=v)for(var y in f)!f.hasOwnProperty(y)||"!top"==y||"!attrs"==y||p&&0!=y.lastIndexOf(p,0)||r.push("<"+y);g&&(!p||"close"==
v&&0==g.tagName.lastIndexOf(p,0))&&r.push("</"+g.tagName+">")}else{y=(l=f[l.state.tagName])&&l.attrs;f=f["!attrs"];if(!y&&!f)return;if(y){if(f){var v={},z;for(z in f)f.hasOwnProperty(z)&&(v[z]=f[z]);for(z in y)y.hasOwnProperty(z)&&(v[z]=y[z]);y=v}}else y=f;if("string"==k.type||"="==k.string){v=c.getRange(d(h.line,Math.max(0,h.ch-60)),d(h.line,"string"==k.type?k.start:k.end));f=v.match(/([^\s\u00a0=<>\"\']+)=$/);if(!f||!y.hasOwnProperty(f[1])||!(w=y[f[1]]))return;"function"==typeof w&&(w=w.call(this,
c));"string"==k.type&&(p=k.string,/['"]/.test(k.string.charAt(0))&&(g=k.string.charAt(0),p=k.string.slice(1)),s=!0);for(f=0;f<w.length;++f)p&&0!=w[f].lastIndexOf(p,0)||r.push(g+w[f]+g)}else{"attribute"==k.type&&(p=k.string,s=!0);for(var B in y)!y.hasOwnProperty(B)||p&&0!=B.lastIndexOf(p,0)||r.push(B)}}return{list:r,from:s?d(h.line,null==q?k.start:q):h,to:s?d(h.line,k.end):h}}}})});YUI.add("thirdparty-codemirror-compressed",function(b){b.namespace("Squarespace.Thirdparty").CodeMirrorCompressed=CodeMirror});
YUI.add("squarespace-models-xero-tax-rate",function(b){var d=b.namespace("Squarespace.Models").XeroTaxRate=b.Base.create("xeroTaxRate",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.REST_API_ROOT+"xero-tax-rates",root:b.Squarespace.REST_API_ROOT+"xero-tax-rates"},{ATTRS:{name:{validator:b.Squarespace.AttrValidators.isString},taxType:{validator:b.Squarespace.AttrValidators.isString},canApplyToAssets:{validator:b.Squarespace.AttrValidators.isBoolean},canApplyToEquity:{validator:b.Squarespace.AttrValidators.isBoolean},
canApplyToLiabilites:{validator:b.Squarespace.AttrValidators.isBoolean},canApplyToRevenue:{validator:b.Squarespace.AttrValidators.isBoolean},displayTaxRate:{validator:b.Squarespace.AttrValidators.isNumber},effectiveTaxRate:{validator:b.Squarespace.AttrValidators.isNumber},taxComponents:{validator:b.Squarespace.AttrValidators.isArray}}});b.Squarespace.Models.XeroTaxRates=b.Base.create("xeroTaxRates",b.ModelList,[b.Squarespace.ModelSync.REST],{model:d})},"1.0",{requires:["model","squarespace-model-sync-rest",
"squarespace-attr-validators"]});
YUI.add("squarespace-dialog-email-service-connect",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.EmailServiceConnect=b.Base.create("emailServiceConnect",b.Squarespace.DialogFields.ServiceConnect,[],{initializer:function(){this.get("contentBox").addClass("sqs-service-connect-content");this._addressField=new b.Squarespace.DialogFields.Text({name:"address",className:"thin","strings.title":"Email Address",data:this.get("data.email")})},renderUI:function(){d.superclass.renderUI.call(this);
var b=this.get("contentBox"),e=this._addressField;e.render(b.one(".fields"));this._addressFieldInput=e.get("contentBox").one("input");this._connectedEmailEl=b.one(".text .message .connected-email")},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",function(b){var e=this.get("data.connected");b=b.target;e&&b.hasClass("icon")?this._disconnect():!e&&b.hasClass("connect")&&this._connect()},this);this._addressField.get("contentBox").one("input").after("keyup",function(b){13==
b.keyCode&&this._connect()},this);this.after("dataChange",function(){this._connectedEmailEl.setContent(this.get("data.email"))},this)},_connect:function(){var c=this._addressField.get("data").trim();if(b.Squarespace.EmailUtils.isValid(c)){var e=this.get("data")||{};e.email=c;e.connected=!0;this.set("data",e)}else new b.Squarespace.Widgets.Alert({"strings.title":"Invalid Email Address","strings.message":"You must provide a valid email address."})},_disconnect:function(){var b=this.get("data");b.email=
null;b.connected=!1;this.set("data",b)}},{CSS_PREFIX:"sqs-email-service-connect",HANDLEBARS_TEMPLATE:"dialog-email-service-connect.html",ATTRS:{strings:{value:{title:"Email"}}}})},"1.0",{requires:"base squarespace-util squarespace-ui-base squarespace-dialog-service-connect squarespace-dialog-text squarespace-dialog-email-service-connect-template squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-block-tourdates-editor",function(b){b.namespace("Squarespace.Block.Editor").TourDates=b.Base.create("tourdates-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.TourDates")},afterLayoutDrag:function(){this._host.fire("resized")}},{NS:"blockEditor",ATTRS:{blockName:{value:"TourDates"}}})},"1.0",{requires:["base","squarespace-model-editor","squarespace-block-editor-dialog",
"squarespace-block-tourdates-model-editor","squarespace-damask-context-globals"]});
YUI.add("squarespace-dialog-file-requires-processing",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.FileRequiresProcessing=b.Base.create("fileRequiresProcessing",b.Squarespace.DialogFields.File,[],{initializer:function(){if(this.constructor===d)throw"Y.Squarespace.DialogFields.FileRequiresProcessing is an abstract class. Please use a subclass.";this.uploader&&this.uploader.setAttrs({fileFilters:[this.getProperty("FILE_FILTER")],createJob:b.bind(this._createProcessingJob,
this),jobFailure:b.bind(this._processingJobFailure,this)})},_bindDataEvents:function(){d.superclass._bindDataEvents.call(this);var b=this.get("data");b&&this._registerEvent(b.after("mediaProcessingStateChange",this.syncUI,this))},_cleanupResidualElements:function(){d.superclass._cleanupResidualElements.call(this);var b=this.get("boundingBox"),e=this.get("contentBox");b.removeClass("processing-taking-longer");e.removeClass("loaded");e.all("."+this.getClassName()+"-preview").remove();e.all(".processing-failed").remove();
e.all(".processing-longer-than-expected").remove()},_renderDataLoadedState:function(){this._cleanupResidualElements();var c=this.get("boundingBox");this.get("contentBox");var e=this.get("data");this.get("contentBox").removeClass("data-loading");if(e&&e.get("hasFileData")){c.addClass("has-file");var d=e.get("mediaProcessingState");b.Squarespace.ContentItemUtils.isErrorProcessingState(e)?(c.addClass("has-error"),this._renderProcessingFailed()):(c.removeClass("has-error"),d===b.Squarespace.MediaProcessingState.READY||
b.Lang.isNull(d)?this._renderFilePreview():(c.addClass("processing-taking-longer"),this._progressPlugin.set("show",!0),this._renderProcessingPreview(),this._renderCancelProcessing()))}else c.removeClass("has-error"),c.removeClass("has-preview"),c.removeClass("has-file"),this._progressPlugin.set("show",!1)},_renderDataLoadingState:function(){d.superclass._renderDataLoadingState.call(this);this.get("boundingBox").removeClass("has-error")},_renderProcessingPreview:function(){var b=this.getClassName();
this.get("contentBox").append('<div class="'+b+"-preview "+b+'-preview-empty"></div>')},_renderProcessingFailed:function(){var c=b.Node.create('<div class="processing-failed"><p><strong>Oops!</strong><br />Something went wrong.<br /><a href="#" class="retry">Retry?</a></p></div>');c.one("p a.retry").on("click",function(b){b.halt();this.set("data",null)},this);this.get("contentBox").append(c)},_renderCancelProcessing:function(){var c=b.Node.create('<div class="processing-longer-than-expected"><p>'+
this.getProperty("PROCESSING_COPY")+'<br /><a href="#" class="cancel">Cancel</a></p></div>');c.one("p a.cancel").on("click",function(b){b.halt();this.set("data",null)},this);this.get("contentBox").append(c)},_createProcessingJob:function(c,e){if(!e.job)return console.warn("Did not create processing job because response did not have job information."),null;var d=new (this.getProperty("PROCESSING_JOB"))(b.merge(e.job,{started:!0}));this.set("data",new b.Squarespace.Models.ContentItem(b.merge(e.media[0],
{mediaProcessingState:b.Squarespace.MediaProcessingState.QUEUED})));return d},_processingJobFailure:function(){new b.Squarespace.Widgets.Alert({"strings.title":"Processing Failed","strings.message":"We were unable to process your file. Please try again."});this.syncUI()}},{})},"1.0",{requires:"base node squarespace-dialog-file squarespace-enum squarespace-models-content-item squarespace-ui-base squarespace-content-item-utils squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-welcome-video-gallery",function(b){b.namespace("Squarespace.Widgets").WelcomeVideoGallery=b.Base.create("welcomeVideoGallery",b.Squarespace.Widgets.VideoGallery,[],{initializer:function(){this._videoStartedOnce=!1;this._startTime=void 0},bindUI:function(){b.Squarespace.Widgets.WelcomeVideoGallery.superclass.bindUI.call(this);this._videoPlayer.on("seek",function(b){this._fireSeekEvent(b.from,b.to)},this);this._videoPlayer.before("destroy",function(){var b=(new Date).getTime()-
this._startTime.getTime();this._fireQuitEvent(b,this._videoPlayer.get("time"))},this)},syncUI:function(){b.Squarespace.Widgets.WelcomeVideoGallery.superclass.syncUI.call(this);this._videoPlayer.set("playing",!0);this._videoStartedOnce||(this._startTime=new Date,this._fireStartEvent(),this._videoStartedOnce=!0)},_fadeAndDestroy:function(){this.plug(b.Plugin.WidgetAnim);this.once("visibleChange",this.destroy,this);this.hide()},_fireSeekEvent:function(d,c){b.Squarespace.Analytics.trackInternal("engagement_welcome_video_seek",
{toSecs:c,fromSecs:d})},_fireQuitEvent:function(d,c){b.Squarespace.Analytics.trackInternal("engagement_welcome_video_close",{secsWatched:d,videoTime:c})},_fireStartEvent:function(){b.Squarespace.Analytics.trackInternal("engagement_welcome_video_start")}},{CSS_PREFIX:"sqs-welcome-video-gallery",ATTRS:{playlist:{value:!1}}})},"1.0",{requires:["base-build","widget-anim","squarespace-video-gallery"]});
YUI.add("widget-stdmod",function(b,d){function c(b){}var e=b.Lang,f=b.Node,g=b.UA,h=b.Widget,k=b.Widget.UI_SRC;c.HEADER="header";c.BODY="body";c.FOOTER="footer";c.AFTER="after";c.BEFORE="before";c.REPLACE="replace";var l=c.HEADER,p=c.BODY,q=c.FOOTER,r=l+"Content",s=q+"Content",t=p+"Content";c.ATTRS={headerContent:{value:null},footerContent:{value:null},bodyContent:{value:null},fillHeight:{value:c.BODY,validator:function(b){return this._validateFillHeight(b)}}};c.HTML_PARSER={headerContent:function(b){return this._parseStdModHTML(l)},
bodyContent:function(b){return this._parseStdModHTML(p)},footerContent:function(b){return this._parseStdModHTML(q)}};c.SECTION_CLASS_NAMES={header:h.getClassName("hd"),body:h.getClassName("bd"),footer:h.getClassName("ft")};c.TEMPLATES={header:'<div class="'+c.SECTION_CLASS_NAMES[l]+'"></div>',body:'<div class="'+c.SECTION_CLASS_NAMES[p]+'"></div>',footer:'<div class="'+c.SECTION_CLASS_NAMES[q]+'"></div>'};c.prototype={initializer:function(){this._stdModNode=this.get("contentBox");b.before(this._renderUIStdMod,
this,"renderUI");b.before(this._bindUIStdMod,this,"bindUI");b.before(this._syncUIStdMod,this,"syncUI")},_syncUIStdMod:function(){var b=this._stdModParsed;(!b||!b[r])&&this._uiSetStdMod(l,this.get(r));(!b||!b[t])&&this._uiSetStdMod(p,this.get(t));(!b||!b[s])&&this._uiSetStdMod(q,this.get(s));this._uiSetFillHeight(this.get("fillHeight"))},_renderUIStdMod:function(){this._stdModNode.addClass(h.getClassName("stdmod"));this._renderStdModSections();this.after("headerContentChange",this._afterHeaderChange);
this.after("bodyContentChange",this._afterBodyChange);this.after("footerContentChange",this._afterFooterChange)},_renderStdModSections:function(){e.isValue(this.get(r))&&this._renderStdMod(l);e.isValue(this.get(t))&&this._renderStdMod(p);e.isValue(this.get(s))&&this._renderStdMod(q)},_bindUIStdMod:function(){this.after("fillHeightChange",this._afterFillHeightChange);this.after("heightChange",this._fillHeight);this.after("contentUpdate",this._fillHeight)},_afterHeaderChange:function(b){b.src!==k&&
this._uiSetStdMod(l,b.newVal,b.stdModPosition)},_afterBodyChange:function(b){b.src!==k&&this._uiSetStdMod(p,b.newVal,b.stdModPosition)},_afterFooterChange:function(b){b.src!==k&&this._uiSetStdMod(q,b.newVal,b.stdModPosition)},_afterFillHeightChange:function(b){this._uiSetFillHeight(b.newVal)},_validateFillHeight:function(b){return!b||b==c.BODY||b==c.HEADER||b==c.FOOTER},_uiSetFillHeight:function(b){b=this.getStdModNode(b);var c=this._currFillNode;c&&b!==c&&c.setStyle("height","");b&&(this._currFillNode=
b);this._fillHeight()},_fillHeight:function(){if(this.get("fillHeight")){var b=this.get("height");""!=b&&"auto"!=b&&this.fillHeight(this.getStdModNode(this.get("fillHeight")))}},_uiSetStdMod:function(b,c,d){if(e.isValue(c)){var f=this.getStdModNode(b,!0);this._addStdModContent(f,c,d);this.set(b+"Content",this._getStdModContent(b),{src:k})}else this._eraseStdMod(b);this.fire("contentUpdate")},_renderStdMod:function(b){var c=this.get("contentBox"),e=this._findStdModSection(b);e||(e=this._getStdModTemplate(b));
this._insertStdModSection(c,b,e);this[b+"Node"]=e;return this[b+"Node"]},_eraseStdMod:function(b){var c=this.getStdModNode(b);c&&(c.remove(!0),delete this[b+"Node"])},_insertStdModSection:function(b,c,e){var d=b.get("firstChild");c===q||!d?b.appendChild(e):c===l?b.insertBefore(e,d):(c=this[q+"Node"])?b.insertBefore(e,c):b.appendChild(e)},_getStdModTemplate:function(b){return f.create(c.TEMPLATES[b],this._stdModNode.get("ownerDocument"))},_addStdModContent:function(b,e,d){switch(d){case c.BEFORE:d=
0;break;case c.AFTER:d=void 0;break;default:d=c.REPLACE}b.insert(e,d)},_getPreciseHeight:function(b){var c=b?b.get("offsetHeight"):0;b&&b.hasMethod("getBoundingClientRect")&&(b=b.invoke("getBoundingClientRect"))&&(c=b.bottom-b.top);return c},_findStdModSection:function(b){return this.get("contentBox").one("> ."+c.SECTION_CLASS_NAMES[b])},_parseStdModHTML:function(c){var e=this._findStdModSection(c);return e?(this._stdModParsed||(this._stdModParsed={},b.before(this._applyStdModParsedConfig,this,"_applyParsedConfig")),
this._stdModParsed[c+"Content"]=1,e.get("innerHTML")):null},_applyStdModParsedConfig:function(b,c,e){if(b=this._stdModParsed)b[r]=!(r in c)&&r in b,b[t]=!(t in c)&&t in b,b[s]=!(s in c)&&s in b},_getStdModContent:function(b){return this[b+"Node"]?this[b+"Node"].get("childNodes"):null},setStdModContent:function(b,c,e){this.set(b+"Content",c,{stdModPosition:e})},getStdModNode:function(b,c){var e=this[b+"Node"]||null;!e&&c&&(e=this._renderStdMod(b));return e},fillHeight:function(b){if(b){var c=this.get("contentBox"),
d=[this.headerNode,this.bodyNode,this.footerNode],f,h=0;f=0;for(var k=!1,l=0,p=d.length;l<p;l++)(f=d[l])&&(f!==b?h+=this._getPreciseHeight(f):k=!0);k&&((g.ie||g.opera)&&b.set("offsetHeight",0),c=c.get("offsetHeight")-parseInt(c.getComputedStyle("paddingTop"),10)-parseInt(c.getComputedStyle("paddingBottom"),10)-parseInt(c.getComputedStyle("borderBottomWidth"),10)-parseInt(c.getComputedStyle("borderTopWidth"),10),e.isNumber(c)&&(f=c-h,0<=f&&b.set("offsetHeight",f)))}}};b.WidgetStdMod=c},"3.17.2",{requires:["base-build",
"widget"]});
YUI.add("squarespace-dialog-country-select",function(b){var d=function(c){var e=[];b.Object.each(c,function(b,c){e.push({value:c,label:b.title})});return e},c=d(b.Squarespace.Localities.COUNTRY_OPTIONS),e=d(b.Squarespace.Localities.STATE_OPTIONS),f=b.namespace("Squarespace.DialogFields").CountrySelect=b.Base.create("countrySelect",b.Squarespace.DialogField2,[],{initializer:function(d){this._countrySel=new b.Squarespace.DialogFields.Select({name:"country",options:c,className:"thin",data:d.data?d.data.country:
null});this._stateSel=new b.Squarespace.DialogFields.Select({name:"state",options:e,className:"thin",data:d.data?d.data.state:e[0].value});this.add(this._countrySel);this.add(this._stateSel)},bindUI:function(){f.superclass.bindUI.call(this);this.each(this._bindDataChanges,this)},syncUI:function(){f.superclass.syncUI.call(this);var b=this.get("data");b.country&&"US"===b.country?this._stateSel.show():this._stateSel.hide()},didDataChange:function(){var b=this.get("data"),c=this._initialData;return b.country!==
c.country||b.state!==c.state},_bindDataChanges:function(b){b.after("dataChange",function(){this.set("data",{country:this._countrySel.get("data"),state:this._stateSel.get("visible")?this._stateSel.get("data"):void 0})},this)}},{CSS_PREFIX:"sqs-country-select",ATTRS:{data:{getter:function(){return this._countrySel&&this._stateSel?{country:this._countrySel.get("data"),state:this._stateSel.get("visible")?this._stateSel.get("data"):null}:{country:""}},setter:function(b){this._stateSel&&this._countrySel&&
(this._stateSel.set("data",b.state),this._countrySel.set("data",b.country));return b}}}})},"1.0",{requires:["base","squarespace-localities","squarespace-dialog-select","squarespace-dialog-field-2"]});
YUI.add("squarespace-block-map",function(b){var d={location:{mapLat:40.7207559,mapLng:-74.0007613,mapZoom:12},vSize:12};if(Static.SQUARESPACE_CONTEXT){var c=Static.SQUARESPACE_CONTEXT.website;c&&c.location&&(d.location=b.merge(d.location,c.location))}b.namespace("Squarespace.Block").Map=b.Base.create("block-map",b.Squarespace.Block.ModelSyncBase,[b.Squarespace.Block.Mixin.AspectRatio],{initializer:function(c){this._mapHolder=b.Node.create("<div class='sqs-map-wrapper'>");this.get("contentBox").append(this._mapHolder);
this.set("mapNode",this._mapHolder.getDOMNode());this.after("resized",this._onResize,this);if(c.model&&this._isMapDataBad(c.model.location))if(this.get("googleMapAPILoaded"))this._restoreBadData();else this.on("googleMapAPILoadedChange",function(b){b.newVal&&this._restoreBadData()},this)},renderUI:function(){this._renderBlock()},_onResize:function(){try{google.maps.event.trigger(this.get("map"),"resize")}catch(b){console.log("google does not exist for map resizing")}},_renderBlock:function(){this.get("rendered")?
this.get("map")?(this.updateMapPosition(),this.fire("widget:contentUpdate")):this.get("isMapLoading")||b.later(10,this,function(){b.Squarespace.Damask.ContextGlobals.fromTop("Y").Squarespace.Rendering.renderMap(this._mapHolder,this.get("model").toJSON());this.fire("widget:contentUpdate")}):this.after("renderedChange",this._renderBlock,this)},updateMapPosition:function(){var c=this.get("model").toJSON().location,d=this.get("map"),g=this.get("marker"),h=google.maps;this._didMapCenterChange()&&d.setCenter(new h.LatLng(c.mapLat,
c.mapLng));g&&this._didMarkerPositionChange()?g.setPosition(new h.LatLng(c.markerLat,c.markerLng)):!g&&b.Lang.isValue(c.markerLat)&&this.set("marker",new h.Marker({map:d,animation:h.Animation.DROP,draggable:9!==b.UA.ie&&10!==b.UA.ie,position:new h.LatLng(c.markerLat,c.markerLng),icon:{url:"/universal/images-v6/icons/icon-map-marker-2x.png",size:new h.Size(52,68),scaledSize:new h.Size(26,34),anchor:new h.Point(13,34)}}));d.getZoom()!==c.mapZoom&&b.Lang.isValue(c.mapZoom)&&d.setZoom(c.mapZoom)},_didMapCenterChange:function(){var b=
this.get("map").getCenter(),c=this.get("model").toJSON().location;return b.lat()!==c.mapLat||b.lng()!==c.mapLng},_didMarkerPositionChange:function(){var b=this.get("marker").getPosition(),c=this.get("model").toJSON().location;return b.lat()!==c.markerLat||b.lng()!==c.markerLng},_getSearchableAddress:function(b){var c=[];b.addressLine1&&c.push(b.addressLine1);b.addressLine2&&c.push(b.addressLine2);b.addressTitle&&!c.length&&c.unshift(b.addressTitle);b.addressCountry&&c.push(b.addressCountry);return!c.length?
"":c.join(", ")},_isMapDataBad:function(c){return!c||!b.Lang.isValue(c.mapLat)||!b.Lang.isValue(c.mapLng)||!b.Lang.isValue(c.mapZoom)},_restoreBadData:function(){var c={location:{}},f=c.location,g=this.get("model").toJSON().location,h=this._getSearchableAddress(g);!g||!h?(f=d.location,this.get("model").setAttrs(c)):(b.Lang.isValue(g.mapZoom)||(f.mapZoom=d.location.mapZoom),b.Lang.isValue(g.markerLat)&&b.Lang.isValue(g.markerLng)?(f.markerLat=f.mapLat,f.markerLng=f.mapLng,this.get("model").setAttrs(c)):
(new google.maps.Geocoder).geocode({address:h},b.bind(function(d,g){if(g===google.maps.GeocoderStatus.OK){var h=d[0].geometry.location;f.mapLat=h.lat();f.mapLng=h.lng();this.get("model").setAttrs(c)}else new b.Squarespace.Widgets.Alert({"strings.title":"Lookup Failed","strings.message":"Address lookup was not successful: "+g})},this)))}},{CSS_PREFIX:"sqs-block-map",ATTRS:{editor:{valueFn:function(){return b.Squarespace.Block.Editor.Map}},defaultContentModel:{value:d},mapNode:{valueFn:function(){return this.get("contentBox").getDOMNode()}},
map:{getter:function(c){if(b.Lang.isValue(c))return c;c=this.get("mapNode")||{};return c.__map?(this.set("map",c.__map),c.__map):null}},marker:{getter:function(){return(this.get("mapNode")||{}).__marker},setter:function(b){this.get("mapNode").__marker=b}},isMapLoading:{getter:function(c){return b.Lang.isValue(c)?c:(c=this.get("mapNode"))&&c.__loadingMap?(this.set("isMapLoading",!0),!0):!1}},googleMapAPILoaded:{getter:function(){if(b.Squarespace.GoogleMap.loaded)return!0;b.Squarespace.GoogleMap.once("load-success",
function(){this.set("googleMapAPILoaded",!0)},this);return!1}}}})},"1.0",{requires:["squarespace-block-base-modelsync","squarespace-block-map-editor","squarespace-block-mixin-aspect-ratio","squarespace-util","squarespace-widgets-alert"]});
YUI.add("squarespace-block-menu-parser",function(b){function d(b){return 0==b.search(e)?b.substring(1):b}function c(b){b=b.split("/");for(var c=[],e=0;e<b.length;++e){var k=b[e].trim().split(" "),l={price:d(k[0].trim())};-1==l.price.search("[0-9]")?(delete l.price,l.title=d(k.join(" ")).trim()):1<k.length&&(k.splice(0,1),l.title=k.join(" ").trim());c.push(l)}return c}var e="(\\$|\u00a3|\u20ac|\u00a5)";b.namespace("Squarespace.Utils").parseMenu=function(b){var d=[],h={title:null,description:null,items:[]},
k={title:null,description:null,sections:[]},l=!1,p=!1;b=b.split("\n");for(var q=0;q<b.length;q++){var r=b[q].trim();if(r)if(0==r.indexOf("==="))l?(k.sections.push(h),d.push(k),h={title:null,description:null,items:[]},k={title:null,description:null,sections:[]},p=!1):l=!0,0<=q-1&&(k.title=b[q-1].trim()),q+1<b.length&&0<b[q+1].trim().length&&(k.description=b[q+1].trim(),++q);else if(0==r.indexOf("---"))p?(k.sections.push(h),h={title:null,description:null,items:[]}):p=!0,0<=q-1&&(h.title=b[q-1].trim()),
q+1<b.length&&0<b[q+1].trim().length&&(h.description=b[q+1].trim(),++q);else{if(q+1<b.length&&0<b[q+1].trim().length){var s=b[q+1].trim();if(0==s.indexOf("---")||0==s.indexOf("==="))continue}var l=p=!0,t=r.search(e);-1!=t?(s=r.substring(0,t).trim(),r=r.substring(t),r={title:s,variants:c(r)}):r={title:r,variants:null};q+1<b.length&&(0<b[q+1].trim().length&&-1==b[q+1].search(e))&&(r.description=b[q+1].trim(),++q);!r.variants&&(q+1<b.length&&0<b[q+1].trim().length)&&(r.variants=c(b[q+1].trim()),++q);
for(;q+1<b.length&&0<b[q+1].trim().length&&0==b[q+1].indexOf("+");)null==r.options&&(r.options=[]),r.options.push(b[q+1].substring(1).trim()),++q;h.items.push(r)}}k.sections.push(h);d.push(k);return d}},"1.0",{requires:["squarespace-util"]});
YUI.add("squarespace-block-social-account-links",function(b){b.namespace("Squarespace.Block").SocialAccountLinksUtils={getAccountsWithProfileUrl:function(d){var c=[],e=Static.SQUARESPACE_CONTEXT.website.socialAccounts||Static.SQUARESPACE_CONTEXT.connectedAccounts;if(d&&d.get("accountIds")){var f=d.get("accountIds"),g=b.Squarespace.Block.SocialAccountLinksUtils._indexById(e);b.Array.each(f,function(b){(b=g[b])&&c.push(b)});d=b.Array.filter(e,function(b){return-1===f.indexOf(b.id)},this);c=c.concat(d)}else c=
e;return b.Array.filter(c,function(b){return!!b.profileUrl})},_indexById:function(d){return b.Array.reduce(d,{},function(b,e){b[e.id]=e;return b})}};b.namespace("Squarespace.Block").SocialAccountLinks=b.Base.create("block-legacy-social-account-links",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-socialaccountlinks",MODEL:b.Squarespace.ContentModel.SocialAccountLinksLegacyModel,ATTRS:{type:{value:b.Squarespace.BlockType.SOCIAL_ACCOUNT_LINKS},editor:{value:b.Squarespace.Block.Editor.LegacySocialAccountLinks}}})},
"1.0",{requires:["base","squarespace-block-base-modelsync","squarespace-block-social-account-links-legacy-editor","squarespace-block-social-account-links-legacy-model"]});
YUI.add("squarespace-dialog-mailchimp-service-connect",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.MailChimpServiceConnect=b.Base.create("mailChimpServiceConnect",b.Squarespace.DialogFields.OauthServiceConnect,[],{initializer:function(c){this.get("contentBox").addClass("sqs-oauth-service-connect-content");this._listField=new b.Squarespace.DialogFields.Select({name:"listName",className:"thin",data:this.get("data.list"),options:[{value:"",label:"Select List"}]});
this.get("data.connected")&&this._loadMailChimpLists()},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox").one(".fields"),e=b.Node.create('<div class="loading"><div class="spinner"></div><div class="text">Loading lists...</div></div>');(new b.Squarespace.Spinner({size:10,color:"light",render:e.one(".spinner")})).spin();c.append(e);this._listField.render(c)},bindUI:function(){d.superclass.bindUI.call(this);this.after("loadingMailChimpListsChange",this.syncUI,this);this._listField.after("dataChange",
function(b){var e=this.get("data")||{};e.list=b.newVal;this.set("data",e)},this);this.after("dataChange",function(b){b.newVal.connected&&b.newVal.connected!==b.prevVal.connected&&this._loadMailChimpLists()})},syncUI:function(){d.superclass.syncUI.call(this);this.get("contentBox").toggleClass("loading-lists",this.get("loadingMailChimpLists"))},_getErrors:function(){var c=[],e=this.get("data.list");if(this.get("data.connected")&&(!b.Lang.isValue(e)||""===e))this._set("errorFlyoutAnchor",this._listField.get("contentBox")),
c.push("Select a list");return c},_completeAuthentication:function(){this._loadMailChimpAccount()},_getConnectedMessageUsername:function(){return this.get("data.username")||"User"},_loadMailChimpAccount:function(){b.Data.get({url:"/api/external/GetMailchimpAccountDetail",data:{connectedAccountId:this.get("data.socialConfig.externalAuthenticationId")},success:function(b){b=b.username;var e=this.get("data")||{};e.username=b;this.set("data",e);this._loadMailChimpLists();this.set("connectionInProgress",
!1)},failure:function(){this._showMailChimpError();this.set("connectionInProgress",!1)}},this)},_loadMailChimpLists:function(){this.set("loadingMailChimpLists",!0);b.Data.get({url:"/api/external/GetMailchimpLists",data:{connectedAccountId:this.get("data.socialConfig.externalAuthenticationId")},success:function(c){var e=[];b.Object.each(c,function(c){var d=c.value;value=b.Lang.isValue(d)?d:"";e.push({value:value,label:c.title})});c=this._listField;c.set("options",e);c.set("data",this.get("data.list"));
this.set("loadingMailChimpLists",!1);1===e.length&&new b.Squarespace.Widgets.Alert({position:b.Squarespace.Widgets.Alert.ANCHOR.ELEMENT,anchor:this._listField.get("contentBox"),"strings.title":"No MailChimp Lists Created","strings.message":"Connecting to MailChimp requires an existing MailChimp mailing list. Please create one to continue."})},failure:function(){this._showMailChimpError();this.set("loadingMailChimpLists",!1)}},this)},_showMailChimpError:function(){new b.Squarespace.Widgets.Alert({position:b.Squarespace.Widgets.Alert.ANCHOR.ELEMENT,
anchor:this.get("contentBox"),"strings.title":"MailChimp Communication Error","strings.message":"There was an error communicating with the MailChimp service. Please try again later."})}},{CSS_PREFIX:"sqs-mailchimp-service-connect",ATTRS:{serviceProvider:{value:b.Squarespace.ExternalServiceProviders.MAILCHIMP},formStorageBackendType:{value:b.Squarespace.FormStorageBackendType.MAILCHIMP},strings:{value:{title:"MailChimp",connectedMessage:"As"}},loadingMailChimpLists:{value:!1}}})},"1.0",{requires:"base squarespace-enum squarespace-dialog-oauth-service-connect squarespace-dialog-select squarespace-ui-base squarespace-spinner squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-content-manager-widgets-music-album-details-editor",function(b){b.namespace("Squarespace.MusicAlbum");var d=b.Squarespace.MusicAlbum.DetailsEditor=b.Base.create("detailsEditor",b.Squarespace.Widgets.SSWidget,[b.WidgetParent],{initializer:function(){var c=this.get("collection");this._imageField=this.add({childType:b.Squarespace.DialogFields.FileImage,required:!1,height:282,square:!0,name:"mainImage",autoSaveFocalPoint:!0,contentLabel:"Album Art",strings:{title:"Album Art"},description:"The image to be used to represent this page if it is placed within an index",
fieldStyle:"normal",titleStyle:"top",data:c.get("metadata.albumCover"),spinnerColor:"dark"}).item(0);this._albumNameField=this.add({childType:b.Squarespace.DialogFields.Text,strings:{title:"Album Info",placeholder:"Album Name"},className:"thin album-name",render:this.get("contentBox").one(".album-name"),data:c.get("title")}).item(0);this._artistNameField=this.add({childType:b.Squarespace.DialogFields.Text,strings:{placeholder:"Artist Name"},className:"thin",render:this.get("contentBox").one(".artist-name"),
data:c.get("metadata.artistName")}).item(0);this._descriptionField=this.add({childType:b.Squarespace.DialogFields.Wysiwyg,name:"description",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:176,classNames:"title",saveOnEnter:!0,data:c.get("metadata.albumDescription"),preventThrottling:!0,"strings.title":"Description"}).item(0);this.publish("change");c.load(b.bind(function(){this._imageField.set("data",c.get("metadata.albumCover"));this._albumNameField.set("data",c.get("title"));
this._artistNameField.set("data",c.get("metadata.artistName"));this._descriptionField.set("data",c.get("metadata.albumDescription"))},this))},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._imageField.render(b.one(".main-image"));this._albumNameField.render(b.one(".album-name"));this._artistNameField.render(b.one(".artist-name"));this._descriptionField.render(b.one(".description"))},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("collection"),
e=this.get("id");b.Lang.isObject(c.get("metadata"))||c.set("metadata",{});c.set("metadata.typeName","music-album");this._imageField.on("dataChange",function(b){b=b.newVal;c.set("metadata.albumCoverId",b?b.get("id"):null);c.save()},this);this._albumNameField.after("dataChange",function(b){c.set("title",b.newVal,{source:e});this.fire("change")},this);this._artistNameField.after("dataChange",function(b){c.set("metadata.artistName",b.newVal,{source:e});this.fire("change")},this);this._descriptionField.after("dataChange",
function(b){c.set("metadata.albumDescription",b.newVal,{source:e});this.fire("change")},this);this._registerEvent(c.after("titleChange",function(b){b.source!=e&&this._albumNameField.set("data",b.newVal)},this));this._registerEvent(c.after("metadataChange",function(c){c.source!=e&&((!b.Lang.isValue(c.subAttrName)||"metadata.artistName"==c.subAttrName)&&this._artistNameField.set("data",c.newVal.artistName),(!b.Lang.isValue(c.subAttrName)||"metadata.albumDescription"==c.subAttrName)&&(!c.prevVal.albumDescription||
c.prevVal.albumDescription&&c.prevVal.albumDescription.html!==c.newVal.albumDescription.html)&&this._descriptionField.set("data",c.newVal.albumDescription))},this))}},{CSS_PREFIX:"sqs-music-album-details-editor",TEMPLATE:'<div class="main-image"></div><div class="strings artist-strings"><div class="album-name"></div><div class="artist-name"></div><div class="description"></div></div>',ATTRS:{collection:{value:null,validator:function(c){return c instanceof b.Squarespace.Models.ContentCollection}}}})},
"1.0",{requires:"base widget-parent squarespace-ss-widget squarespace-dialog-file-image squarespace-dialog-text squarespace-dialog-wysiwyg-wrapper".split(" ")});
YUI.add("squarespace-block-plugin-resizable",function(b){b.namespace("Squarespace.Block.Plugin.Resizable");b.Squarespace.Block.Plugin.Resizable=b.Base.create("resizableBlock",b.Plugin.Base,[],{initializer:function(d){this._host=this.get("host");b.after(this._initResize,this,"renderUI");b.after(this._initResize,this,"syncUI");b.after(this._initResize,this,"_renderBlock");b.after(this._initResize,this,"_renderSuccess");this._host.get("rendered")?this._initResize():this.afterHostEvent("renderedChange",
this._initResize,this)},destructor:function(){this._destroyResize()},_toggleResize:function(b){b?this._initResize():this._destroyResize()},_syncAspectRatio:function(){var b=this.get("model"),c=b.get("aspectRatio"),e=b.get("dimensions");b.get("vSize")?c=this._calculateAspectRatio():c||(c=e?100*(e.height/e.width):75);this.get("host").get("model").set("aspectRatio",c,{silent:!0})},_initResize:function(){var d=this.get("host"),c=this.get("resizeNode"),e=d.hasPlugin(b.Squarespace.WidgetResize.NS);d.plug(b.Squarespace.WidgetResize,
{resizeNode:c,wrap:!1,minHeight:1});d=c.one(".yui3-resize-handles-wrapper");this.get("host").get("boundingBox").appendChild(d);e||this._bindResizeEvents()},_destroyResize:function(){var d=this.get("resizeNode");this.get("host").unplug(b.Squarespace.WidgetResize);if(!this.get("blockEditor").get("resizable")&&!b.Lang.isValue(this.get("model").get("aspectRatio"))){var c=d.one(".sqs-intrinsic");c&&(c.setStyle("paddingBottom",null),c.removeClass("sqs-intrinsic"),(c=c.one(".sqs-intrinsic-content"))&&c.removeClass("sqs-intrinsic-content"))}d.setStyles({width:null,
height:null,border:null,margin:null,padding:null});d.one(".yui3-resize-handles-wrapper")&&d.one(".yui3-resize-handles-wrapper").remove(!0)},_bindResizeEvents:function(){var d=this._host[b.Squarespace.WidgetResize.NS];d.on("resize:start",this._nullVSize,this);d.on("resize:resize",this._adjustNodePosition,this);d.on("resize:resize",this._updateAspectRatio,this);d.on("resize:end",this._resetMouseDelta,this);d.after("resize:end",this._updateAspectRatio,this);d.on("resize:start",this._disableInsertPoints,
this);d.on("resize:end",this._enableInsertPoints,this)},_disableInsertPoints:function(){b.Squarespace.Singletons.InsertPointController.disable()},_enableInsertPoints:function(){b.Squarespace.Singletons.InsertPointController.enable()},_nullVSize:function(d){b.Squarespace.Singletons.InsertPointController.hide();d=this.get("model");b.Lang.isValue(d.get("vSize"))&&(this._syncAspectRatio(),d.set("vSize",null,{silent:!0}))},_adjustNodePosition:function(d){var c=this.get("resizeNode"),e=c[b.Plugin.Resize.NS];
d=this.get("snapToThreshold");var f=c.get("region"),g=this.get("host").get("boundingBox").get("region"),c=e.get("activeHandleNode").get("region"),h=this.get("model").get("dimensions"),e=e.delegate.dd,k=e.mouseXY[1];b.Lang.isNumber(this._mouseDelta)||(this._mouseDelta=c.bottom-c.height/2-k);var l;h?(l=f.width/h.width,h=parseInt(h.height,10)*l):h=f.height;f=h+(f.top+(g.bottom-f.bottom));c=f-c.height/2;k>f-d&&k<f+d&&(e.actXY[1]=c)},_calculateAspectRatio:function(){var d=this.get("resizeNode").get("region"),
c=parseInt(this.get("resizeNode").getStyle("paddingLeft"),10),c=c+parseInt(this.get("resizeNode").getStyle("paddingRight"),10),e=parseInt(this.get("resizeNode").getStyle("paddingBottom"),10),e=e+parseInt(this.get("resizeNode").getStyle("paddingTop"),10);b.Lang.isNumber(e)||(e=0);b.Lang.isNumber(c)||(c=0);return 100*(d.height-e)/(d.width-c)},_updateAspectRatio:function(b,c){var e=this._calculateAspectRatio();c?this.get("model").set("aspectRatio",e,{silent:!0}):this.get("model").set("aspectRatio",e)},
_resetMoustDelta:function(b){this.mouseDelta=null;this._host.get("editController").alignInsertPoints()}},{NS:"resizableBlock",ATTRS:{resizeNode:{valueFn:function(){return this.get("host").get("boundingBox")}},model:{valueFn:function(){return this.get("host").get("model")}},blockEditor:{value:null}}})},"1.0",{requires:["base","plugin","squarespace-widget-resize"]});
YUI.add("squarespace-models-commerce-coupon",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.CommerceCoupon=b.Base.create("CommerceCoupon",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.API_ROOT+"commerce/coupons",serialize:function(){var c=d.superclass.toJSON.call(this);delete c.isValid;return b.JSON.stringify(c)}},{ATTRS:{id:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},name:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},
promoCode:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},type:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.CommerceCouponType),writeOnce:"initOnly"},discountType:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.CommerceDiscountType),writeOnce:"initOnly"},discountAmt:{value:0,validator:function(c){c=isNaN(Number(c))?c:Number(c);return b.Lang.isNumber(c)?(this.discountAmt=c,!0):!1}},startDate:{value:null,validator:b.Squarespace.AttrValidators.isNullOrNumber},
endDate:{value:null,validator:b.Squarespace.AttrValidators.isNullOrNumber},active:{value:!0,validator:b.Squarespace.AttrValidators.isBoolean},productId:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},minPrice:{value:null,validator:b.Squarespace.AttrValidators.isNullOrNumber},currencyCode:{value:"USD",validator:b.Squarespace.AttrValidators.isString},numUses:{value:0,validator:b.Squarespace.AttrValidators.isNumber},productTitle:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},
computedDiscount:{value:0,validator:b.Squarespace.AttrValidators.isNumber},categories:{value:[],validator:b.Squarespace.AttrValidators.isArray},expired:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},isValid:{value:!0,validator:b.Squarespace.AttrValidators.isBoolean}}})},"1.0",{requires:["base","model","squarespace-attr-validators","squarespace-enum","squarespace-model-sync-rest"]});
YUI.add("squarespace-notification-item-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["notification-item.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;return(b=d.each.call(c,c.items,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n<div class="notification-item" data-id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f="function"===typeof f?f.apply(b):
f);e+=l(f)+'" data-url="';(f=d.fullUrl)?f=f.call(b,{hash:{},data:c}):(f=b.fullUrl,f="function"===typeof f?f.apply(b):f);e+=l(f)+'">\n  <div class="item-clear-button">&times;</div>\n  <div class="notification-category">';(f=d.category)?f=f.call(b,{hash:{},data:c}):(f=b.category,f="function"===typeof f?f.apply(b):f);e+=l(f)+'</div>\n  <div class="notification-title">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f="function"===typeof f?f.apply(b):f);e+=l(f)+'</div>\n  <div class="notification-summary">';
(f=d.body)?f=f.call(b,{hash:{},data:c}):(f=b.body,f="function"===typeof f?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n</div>\n"},k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("notification-item.html".replace("/","."),d.templates["notification-item.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-debounce",function(b){b.namespace("Squarespace").debounce=function(d,c,e,f){var g,h=function(){var h=this,l=arguments,p,q=e&&!g;g&&f&&(p=!0);g&&g.cancel();g=b.later(c,this,function(){g=null;b.Env&&(!e||p)&&d.apply(h,l)});q&&d.apply(h,l)};h.cancel=function(){g&&g.cancel()};return h}},"1.0",{requires:[]});
YUI.add("squarespace-xero-accounts-config",function(b){var d=b.Base.create("noChoicesErrorSelect",b.Squarespace.DialogFields.Select,[],{syncUI:function(){d.superclass.syncUI.call(this);if(0===this.get("options").length&&0===this.get("optGroups").length){var c=this.get("boundingBox");new b.Squarespace.ToolTip({target:c,title:this.get("noChoicesTitle"),body:this.get("noChoicesMsg"),dialogTooltip:!0,showTimeout:200,clickToShow:!0,style:"alert"})}}},{ATTRS:{noChoicesTitle:{validator:b.Squarespace.AttrValidators.isString},
noChoicesMsg:{validator:b.Squarespace.AttrValidators.isString}}}),c=b.namespace("Squarespace.DialogFields").XeroAccountsConfig=b.Base.create("xeroAccountConfig",b.Squarespace.Widgets.DialogField2,[],{renderUI:function(){c.superclass.renderUI.call(this);this.get("boundingBox").plug(b.Squarespace.Plugins.LoadingOverlay,{spinnerConfig:{size:"extra-large",color:"light"}})},bindUI:function(){c.superclass.bindUI.call(this);var b=this.get("xeroAccounts");this.after("enabledChange",this.syncUI,this);b.on("load",
this._asyncRender,this);b.after("load",this._fillInDefaults,this);b.onceAfter("load",this._animateIn,this)},syncUI:function(){var c=this.get("data");b.Array.each(this.get("selects"),function(d){var g=c[d.get("name")];b.Lang.isObject(g)&&d.set("data",g.accountId)});this._toggleEnabled()},showError:function(){b.Array.forEach(this.get("selects"),function(b){b.isEmpty()&&b.showError("This field is required")})},hideError:function(){b.Array.forEach(this.get("selects"),function(b){b.hideError()})},isValid:function(){var c=
!0;b.Array.forEach(this.get("selects"),function(b){b.isEmpty()&&(c=!1)});return c},refresh:function(){var c=this.get("selects"),d=this.get("contentBox"),g=this.get("xeroAccounts");this.hideError();this.get("boundingBox").loadingOverlay.set("visible",!0);g.onceAfter("load",this._animateIn,this);d=new b.Anim({node:d,duration:0.25,from:{opacity:1},to:{opacity:0}});d.once("end",function(){b.Array.forEach(c,function(b){b.destroy()});this.set("selects",[]);g.load()},this);d.run()},didDataChange:function(){return b.JSON.stringify(this._initialData)!==
b.JSON.stringify(this.get("data"))},destructor:function(){this.get("xeroAccounts").destroy();b.Array.each(this.selects,function(b){b.destroy()})},_animateIn:function(){(new b.Anim({node:this.get("contentBox"),duration:0.25,from:{opacity:0},to:{opacity:1}})).run();this.get("boundingBox").loadingOverlay.set("visible",!1)},_toggleEnabled:function(){var c=this.get("boundingBox");this.get("enabled")?(c.removeClass("accounts-config-disabled").detach("click"),b.Array.forEach(this.get("selects"),function(b){b.enable()})):
(c.addClass("accounts-config-disabled"),b.Array.forEach(this.get("selects"),function(b){b.disable()}))},_getErrors:function(){var c=[];b.Array.forEach(this.get("selects"),function(b){b.isEmpty()&&c.push("This field is required")});return c},_getOptGroups:function(c,d){var g=this.get("xeroAccounts").filter(function(g){var h=g.get("type"),k=!0;b.Lang.isArray(d)&&(k=-1===d.indexOf(h)||g.get("enablePayments"));return-1!==c.indexOf(h)&&k&&!g.get("isSystemAccount")}),h={},k=[];b.Array.each(g,function(c){var e=
c.get("type"),d=h[e];b.Lang.isArray(d)||(d=[]);d.push(c);h[e]=d});b.Object.each(h,function(c,e){k.push({label:b.Squarespace.XeroUtils.HUMAN_XERO_ACCOUNT_TYPES[e],options:b.Array.map(c,function(c){var e=b.Lang.isString(c.get("code"));return{value:c.get("accountId"),label:e?c.get("code")+" - "+c.get("name"):c.get("name")}})})});return k},_asyncRender:function(){var e=this.get("contentBox"),f=this.getClassName(),g=f+"-select";e.all("."+this.getClassName()+"-row").remove(!0);b.Array.each(c.SELECT_CONFIGS,
function(h){var k=this._getOptGroups(h.accountTypes,h.requiresPaymentsIfTypeIs),l=b.Node.create(b.Lang.sub(c.ROW_TPL,{rowCls:f+"-row",labelCls:f+"-account-label",selectCls:g,colonCls:f+"-colon",lineItemTitle:h.lineItemTitle}));h=new d({name:h.fieldName,noChoicesMsg:h.noChoicesMsg,noChoicesTitle:"No Eligible Accounts",optGroups:k,required:!0,boundingBox:l.one("."+g),className:"thin dark","strings.placeholder":"Select an account"});this.get("selects").push(h);this._bindSelect(h);e.append(l);h.render()},
this)},_bindSelect:function(b){var c=this.get("xeroAccounts");b.after("dataChange",function(){var d=c.findAccountById(b.get("data"));d&&(this.get("data")[b.get("name")]=d.toJSON())},this)},_fillInDefaults:function(){var e=this.get("data"),d=this.get("xeroAccounts");b.Array.each(c.SELECT_CONFIGS,function(b){var c=d.findAccountByName(b.defaultAccountName),k=e[b.fieldName];!(k&&null!==d.findAccountById(k.accountId))&&c&&(e[b.fieldName]=c.toJSON())});this.set("data",e);this._initialData=e}},{ATTRS:{xeroAccounts:{},
selects:{value:[]},data:{value:{}},enabled:{value:!1},spinnerConfig:{size:"extra-large"}},ROW_TPL:'<div class="{rowCls}"><div class="{labelCls}"><label>{lineItemTitle}</label></div><div class="{colonCls}">&rarr;</div><div class="{selectCls}"></div></div>',CSS_PREFIX:"sqs-xero-accounts-config",SELECT_CONFIGS:[{fieldName:"salesRevenueAccount",lineItemTitle:"Sales Revenue",accountTypes:[b.Squarespace.XeroAccountTypes.SALES,b.Squarespace.XeroAccountTypes.REVENUE],noChoicesMsg:'Create a Sales or Revenue account in Xero for sales revenue in Xero, then click "Refresh Accounts".',
defaultAccountName:"Sales"},{fieldName:"shippingChargesAccount",lineItemTitle:"Shipping Charges",accountTypes:[b.Squarespace.XeroAccountTypes.SALES,b.Squarespace.XeroAccountTypes.REVENUE,b.Squarespace.XeroAccountTypes.CURRENT_LIABILITY,b.Squarespace.XeroAccountTypes.LIABILITY,b.Squarespace.XeroAccountTypes.EXPENSE,b.Squarespace.XeroAccountTypes.DIRECT_COSTS],noChoicesMsg:'Create a Current Liability, Liability, or Expense account for Shipping Charges in Xero, then click "Refresh Accounts".',defaultAccountName:"Postage & Delivery"},
{fieldName:"salesDiscountAccount",lineItemTitle:'"On Sale" Discounts',accountTypes:[b.Squarespace.XeroAccountTypes.SALES,b.Squarespace.XeroAccountTypes.REVENUE],noChoicesMsg:'Create a Sales or Revenue account for "On Sale" discounts in Xero,then click "Refresh Accounts".',defaultAccountName:'"On Sale" Discounts'},{fieldName:"couponsDiscountAccount",lineItemTitle:"Coupon Discounts",accountTypes:[b.Squarespace.XeroAccountTypes.SALES,b.Squarespace.XeroAccountTypes.REVENUE],noChoicesMsg:'Create a Sales or Revenue account for coupon discounts in Xero, then click "Refresh Accounts".',
defaultAccountName:"Coupon Discounts"},{fieldName:"donationsRevenueAccount",lineItemTitle:"Donations",accountTypes:[b.Squarespace.XeroAccountTypes.REVENUE,b.Squarespace.XeroAccountTypes.SALES,b.Squarespace.XeroAccountTypes.OTHER_INCOME],noChoicesMsg:'Create a Revenue, Sales, or Other Income account for Donations in Xero, then click "Refresh Accounts".',defaultAccountName:"Other Revenue"},{fieldName:"stripeChargesAccount",lineItemTitle:"Payment Processing Fees",accountTypes:[b.Squarespace.XeroAccountTypes.DIRECT_COSTS],
noChoicesMsg:'Create a Direct Costs account for Payment Processing Fees in Xero,then click "Refresh Accounts".',defaultAccountName:"Cost of Goods Sold"},{fieldName:"stripePaymentsAccount",lineItemTitle:"Payments Received",accountTypes:[b.Squarespace.XeroAccountTypes.CURRENT_ASSET,b.Squarespace.XeroAccountTypes.BANK],requiresPaymentsIfTypeIs:[b.Squarespace.XeroAccountTypes.CURRENT_ASSET],noChoicesMsg:'Create a Current Asset account with Payments enabled in Xero, then click "Refresh Accounts".',defaultAccountName:"Credit Card Receivable"}]})},
"1.0",{requires:"anim squarespace-dialog-select squarespace-models-xero-account squarespace-dialog-field-2 squarespace-xero-utils squarespace-plugin-loading-overlay".split(" ")});
YUI.add("squarespace-block-posts-by-editor",function(b){b.namespace("Squarespace.Block.Editor");b.namespace("Squarespace.Block.ModelEditorDialog");b.Squarespace.Block.Editor.PostsByMonth=b.Base.create("posts-by-month-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.PostsByMonth")}},{NS:"blockEditor",ATTRS:{blockName:{value:"PostsByMonth"}}});b.Squarespace.Block.ModelEditorDialog.PostsByMonth=
b.Base.create("blockPostByMonthEditor",b.Squarespace.Block.ModelEditorDialog.PostsBy,[],{},{NS:"postsByMonthEditor",ATTRS:{strings:{value:{title:"Month Index",description:"Select a collection below to index."}}}});b.Squarespace.Block.Editor.PostsByCategory=b.Base.create("posts-by-category-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.PostsByCategory")}},{NS:"blockEditor",ATTRS:{blockName:{value:"PostsByCategory"}}});
b.Squarespace.Block.ModelEditorDialog.PostsByCategory=b.Base.create("blockPostByCategoryEditor",b.Squarespace.Block.ModelEditorDialog.PostsBy,[],{},{NS:"postsByCategoryEditor",ATTRS:{strings:{value:{title:"Category Index",description:"Select a collection below to collect categories from."}}}});b.Squarespace.Block.Editor.PostsByTag=b.Base.create("posts-by-tag-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.PostsByTag")}},
{NS:"blockEditor",ATTRS:{blockName:{value:"PostsByTag"}}});b.Squarespace.Block.ModelEditorDialog.PostsByTag=b.Base.create("blockPostByTagEditor",b.Squarespace.Block.ModelEditorDialog.PostsBy,[],{},{NS:"postsByTagTagEditor",ATTRS:{strings:{value:{title:"Tag Index",description:"Select a collection below to collect tags from."}}}});b.Squarespace.Block.Editor.PostsByAuthor=b.Base.create("posts-by-author-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.PostsByAuthor")}},
{NS:"blockEditor",ATTRS:{blockName:{value:"PostsByAuthor"}}});b.Squarespace.Block.ModelEditorDialog.PostsByAuthor=b.Base.create("blockPostByAuthorEditor",b.Squarespace.Block.ModelEditorDialog.PostsBy,[],{},{NS:"postsByAuthorEditor",ATTRS:{strings:{value:{title:"Author Index",description:"Select a collection below to collect authors from"}}}})},"1.0",{requires:"base model squarespace-block-editor-dialog squarespace-block-posts-by-model squarespace-block-posts-by-model-editor-base squarespace-damask-context-globals".split(" ")});
YUI.add("squarespace-widgets-inline-select",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.InlineSelect=b.Base.create("InlineSelect",b.Squarespace.Widgets.DataWidget,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox");b.Array.each(this.get("options"),function(e){var d=b.Node.create('<span class="inline-select-option">'+e.label+"</span>");d.setData("option",e);c.append(d)})},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").delegate("click",
function(b){b=b.currentTarget.getData("option");this.set("data",b.value)},".inline-select-option",this)},syncUI:function(){d.superclass.syncUI.call(this);var b=this.get("contentBox").all(".inline-select-option"),e=this.get("data"),f;b.each(function(b){b.removeClass("selected");b.getData("option").value===e&&(f=b)});f&&f.addClass("selected")}},{CSS_PREFIX:"sqs-inline-select",ATTRS:{options:{value:[],validator:b.Squarespace.AttrValidators.isArray,writeOnce:"initOnly"}}})},"1.0",{requires:["base","squarespace-attr-validators",
"squarespace-ss-widget"]});
YUI.add("autocomplete-highlighters",function(b,d){var c=b.Array,e=b.Highlight,f=b.mix(b.namespace("AutoCompleteHighlighters"),{charMatch:function(b,d,f){var l=c.unique((f?b:b.toLowerCase()).split(""));return c.map(d,function(b){return e.all(b.text,l,{caseSensitive:f})})},charMatchCase:function(b,c){return f.charMatch(b,c,!0)},phraseMatch:function(b,d,f){return c.map(d,function(c){return e.all(c.text,[b],{caseSensitive:f})})},phraseMatchCase:function(b,c){return f.phraseMatch(b,c,!0)},startsWith:function(b,
d,f){return c.map(d,function(c){return e.all(c.text,[b],{caseSensitive:f,startsWith:!0})})},startsWithCase:function(b,c){return f.startsWith(b,c,!0)},subWordMatch:function(d,f,k){var l=b.Text.WordBreak.getUniqueWords(d,{ignoreCase:!k});return c.map(f,function(b){return e.all(b.text,l,{caseSensitive:k})})},subWordMatchCase:function(b,c){return f.subWordMatch(b,c,!0)},wordMatch:function(b,d,f){return c.map(d,function(c){return e.words(c.text,b,{caseSensitive:f})})},wordMatchCase:function(b,c){return f.wordMatch(b,
c,!0)}})},"3.17.2",{requires:["array-extras","highlight-base"]});
YUI.add("squarespace-block-summary-gallery-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");var d=b.Squarespace.Block.ModelEditorDialog.SummaryGallery=b.Base.create("SummaryGalleryModelEditorDialog",b.Squarespace.Block.ModelEditorDialog.SocialSummary,[b.Squarespace.Block.Mixins.Gallery],{sanitizeDialogData:function(c){c=b.merge(c,c.options);delete c.options;"slider"!==c.design?c.aspectRatio=null:delete c.aspectRatio;c.vSize=null;return c},_getDefaultDialogConfig:function(){var c=
d.superclass._getDefaultDialogConfig.call(this),e=c.tabs[0];c.tabs.push({title:e.title,tabTitle:"Design",icon:e.icon,scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.GalleryOptions,name:"options",config:{options:this._getGalleryOptions()}}]});return b.merge(c,{name:"editGalleryBlock",height:420})},_getDefaultContent:function(){var c=this._defaultGalleryOptions();return b.merge(c,{methodOption:"transient"})}},{ATTRS:{}})},"1.0",{requires:"base squarespace-enum squarespace-block-mixin-gallery-option-sync squarespace-dialog-gallery-options squarespace-block-social-summary-model-editor squarespace-block-summary-gallery-model".split(" ")});
YUI.add("squarespace-enum-factory",function(b){b.namespace("Squarespace").enumFactory=function(d){var c=function(){throw"Can't Instantiate Enumerations";},e=c.prototype={constructor:c,toString:function(){return this.enumName},valueOf:function(){return this.value},toJSON:function(){return this.enumName}};c.values=[];b.Object.each(d,function(b,d){var h=function(){};h.prototype=e;h.enumName=d;h.value=b;c[d]=h;c.values.push(h)});c.each=function(c,e){b.Array.each(this.values,function(b){c.call(e,b)})};
c.isValid=function(e){if(!b.Lang.isValue(e))return!1;var d=c[e.enumName];return b.Lang.isValue(d)&&e===d};return c}});
YUI.add("squarespace-content-manager-widgets-calendar-list",function(b){b.namespace("Squarespace.Blog");b.Squarespace.Blog.CalendarList=b.Base.create("CalendarList",b.Squarespace.Blog.List,[],{_uiAddChild:function(b,c){var e=b.get("boundingBox");c.contains(e)||c.appendChild(b.get("boundingBox"))},_syncListItems:function(){var d=this.get("items");if(d){this.setLoadedState();var c=[];this.each(function(b){b.set("selected",0);c.push(b)});b.Array.each(c,function(b){b.destroy()});var e=this.get("contentBox").one(".past-events"),
f=e.one(".items"),g=this.get("contentBox").one(".upcoming-events"),h=g.one(".items"),k=d.getPastEvents();e.toggleClass("hidden",0===k.length);b.Array.each(k,function(c){this._addItemWidget(c,{childType:b.Squarespace.Blog.Item,render:f})},this);d=d.getUpcomingEvents();g.toggleClass("hidden",0===d.length);d=d.reverse();b.Array.each(d,function(c){this._addItemWidget(c,{childType:b.Squarespace.Blog.Item,render:h})},this)}}},{CSS_PREFIX:"sqs-calendar-list",TEMPLATE:'<div class="upcoming-events events-list"><header class="events-header">Upcoming Events</header><div class="items"></div></div><div class="past-events events-list"><header class="events-header">Past Events</header><div class="items"></div></div>',
ATTRS:{stickyHeadersEnabled:{value:!1}}})},"1.0",{requires:["base","squarespace-content-manager-widgets-blog-list"]});
YUI.add("squarespace-dialog-xero-setup-checklist-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-xero-setup-checklist.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="checklist-container">\n    <ul>\n     <li class="checklist-connect">\n        <div class="checklist-number">\n          <div class="num">1</div>\n        </div>\n        <div class="checklist-title">Connect Xero</div>\n        <div class="checklist-description">\n            Connect your store with Xero to get started.\n        </div>\n        <div class="checklist-signup-link">\n            <emph>Don\'t have a Xero account?</emph><br>\n            Click <a href="https://www.xero.com/us/squarespace/" target="_blank">here</a> to create one.\n        </div>\n        <div class="checklist-button"></div>\n      </li>\n      <li class="checklist-chart-of-accounts single-line-copy">\n        <div class="checklist-number">\n          <div class="num">2</div>\n        </div>\n        <div class="checklist-title">Set Up Account Mappings</div>\n        <div class="checklist-description">Choose which account each line item of your Daily Sales Summary will be filed under.</div>\n        <div class="checklist-button"></div>\n      </li>\n      <li class="checklist-tax-rates single-line-copy">\n        <div class="checklist-number">\n          <div class="num">3</div>\n        </div>\n        <div class="checklist-title">Set Up Tax Rates</div>\n        <div class="checklist-description">Automatically match your Tax Rates in Xero to your Taxes in Squarespace.</div>\n        <div class="checklist-button"></div>\n      </li>\n      <li class="checklist-finish">\n        <div class="checklist-number">\n          <div class="num">4</div>\n        </div>\n        <div class="checklist-title">Finish</div>\n        <div class="checklist-description">You\'re all set! At 1:00 AM EST every day, Squarespace will export a Daily Sales Summary for the previous day. You can manually export Daily Sales Summaries for earlier dates.</div>\n        <div class="checklist-button"></div>\n      </li>\n    </ul>\n</div>'})})();b.Handlebars.registerPartial("dialog-xero-setup-checklist.html".replace("/",
"."),d.templates["dialog-xero-setup-checklist.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-token-paginator",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.TokenPaginator=b.Base.create("TokenPaginator",b.Squarespace.Models.Paginator,[],{initializer:function(){b.Do.before(function(c){c=b.JSON.parse(c);b.Lang.isString(c.nextPageToken)&&this._tokens.push(c.nextPageToken)},this.get("models"),"parse",this);this._tokens=[null];this._currentTokenIdx=0},firstPage:function(){d.superclass.firstPage.call(this);this._currentTokenIdx=0;this._set("token",
this._tokens[this._currentTokenIdx]);this._syncAvailablePages()},previousPage:function(){d.superclass.previousPage.call(this);if(0>=this._currentTokenIdx)throw"No previous pages remaining.";this._currentTokenIdx--;this._set("token",this._tokens[this._currentTokenIdx]);this._syncAvailablePages()},nextPage:function(){d.superclass.nextPage.call(this);this._currentTokenIdx++;this._set("token",this._tokens[this._currentTokenIdx]);this._syncAvailablePages()},_getPaginationParams:function(){var c=d.superclass._getPaginationParams.call(this);
return b.merge(c,this.getAttrs(["token"]))},_syncAvailablePages:function(){var b=this._currentTokenIdx,e=this.get("models");e._set("hasPreviousPage",0<b);e._set("hasNextPage",b<this._tokens.length-1)}},{ATTRS:{token:{validator:b.Squarespace.AttrValidators.isNullOrString,value:null,readOnly:!0}}})},"1.0",{requires:["base","squarespace-attr-validators","squarespace-models-paginator"]});
YUI.add("squarespace-block-icon",function(b){var d=b.namespace("Squarespace.Block").Icon=b.Base.create("blockIcon",b.Widget,[],{renderUI:function(){var c=b.ClassNameManager.getClassName("sqs","blockicon",this.get("id"),!0);this.get("boundingBox").addClass(c);this.get("contentBox").setHTML('<div class="label">'+this.get("label")+"</div>")},bindUI:function(){this.after("pressedChange",this._afterPressedChange,this)},_afterPressedChange:function(b){this.get("boundingBox").toggleClass(d.CSS_PREFIX+"-pressed",
!!b.newVal)},queueForDestruction:function(){this.get("boundingBox").addClass("sqs-destroyme")}},{CSS_PREFIX:"sqs-blockicon",ATTRS:{ctor:{value:null},label:{},floatable:{valueFn:function(){var b=this.get("ctor");return(b=b.ATTRS.floatable||b.superclass.constructor.ATTRS.floatable)&&void 0!==b.value?b.value:!0}},pressed:{value:!1}}})},"1.0",{requires:["base","widget-child","squarespace-ss-widget"]});
YUI.add("squarespace-settings-site-labs",function(b){function d(){if(b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_DAMASK))return!0}b.namespace("Squarespace.Settings.Site");var c=[{$when:b.Squarespace.Utils.isDamaskEnabled,ctor:b.Squarespace.DialogFields.Description,config:{text:"Squarespace Labs contains all the various exprimental features that are being developed by their illustrious engineers. Proceed at your own peril, but keep in mind: with great risk comes great reward."}},
{$when:b.Squarespace.Utils.isSquarespaceAdmin,ctor:b.Squarespace.DialogFields.Description,config:{title:"General"}},{$when:b.Squarespace.Utils.isSquarespaceAdmin,ctor:b.Squarespace.DialogFields.CookieCheck,config:{className:"dark",name:"squarespaceDebugMode",cookieKey:"SQUARESPACE_DEBUG","strings.title":"Debug Mode","strings.description":"Enable Debugging"}},{$when:b.Squarespace.Utils.isSquarespaceAdmin,ctor:b.Squarespace.DialogFields.CookieCheck,config:{className:"dark",name:"betaFeatureActive",
cookieKey:"betaFeatureActive","strings.title":"Beta Features","strings.description":"Enable to try unreleased features before they go live. Only available to global admins.",disabledBehavior:"setToFalse"}},{$when:b.Squarespace.Utils.isSquarespaceAdmin,ctor:b.Squarespace.DialogFields.CookieCheck,config:{className:"dark",cookieKey:"fastAutoSave","strings.title":"Fast Autosave","strings.description":"Decrease the time between autosaves."}}];d()&&(c.push({ctor:b.Squarespace.DialogFields.Description,config:{name:"damaskHeader",
title:"Damask"}}),c.push({$when:d,ctor:b.Squarespace.DialogFields.CookieCheck,config:{className:"dark",name:"damaskActive",cookieKey:"damask","strings.title":"Damask UI (Alpha)","strings.description":"Damask is a complete overhaul of the Squarespace interface, and should not be used for production websites. Available only to global admins"}}),b.Cookie.get("damaskPanels")&&b.Cookie.remove("damaskPanels",{path:"/"}),c.push({$when:function(){return d()&&b.Squarespace.Utils.isSquarespaceAdmin()},ctor:b.Squarespace.DialogFields.CookieCheck,
config:{name:"damaskBlogPostFrontendEditing",className:"dark",cookieKey:"damaskBlogPostFrontendEditing","strings.title":"Blog Post Frontend Editing (Experimental)","strings.description":"Enabling this feature will enable editing blog posts on the frontend."}}),c.push({$when:d,ctor:b.Squarespace.DialogFields.CookieCheck,config:{className:"dark",name:"damaskClickToEdit",cookieKey:"damaskClickToEdit","strings.title":"Click To Edit\u2122 (Experimental)","strings.description":'This is the inverse of the always editing paradigm. All LayoutEngine fields are initially read-only with a "Edit" toolbar option that allows you to go into a focused edit mode.'}}));
b.Squarespace.Utils.isBetaFeatureEnabled()&&(c.push({ctor:b.Squarespace.DialogFields.Description,config:{title:"Newsletters"}}),c.push({ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:"newslettersEnabled","strings.title":"Newsletter Creation","strings.description":"Enable newsletter creation UI.",data:b.Squarespace.Utils.isNewslettersEnabled()}}));b.Array.each([],function(e){c.push({ctor:b.Squarespace.DialogFields.Description,config:{title:e.title,text:e.description}});c.push({ctor:b.Squarespace.DialogFields.Check,
config:{name:e.name,"strings.description":"Toggle all features"}});b.Array.each(e.featureList,function(e){c.push({ctor:b.Squarespace.DialogFields.Check,config:{className:"dark",name:e.name,"strings.title":e.title,"strings.description":e.description}})},this)});var e=b.Squarespace.Settings.Site.LabSettings=b.Base.create("labSettings",b.Squarespace.Widgets.SettingsPanel,[],{bindUI:function(){e.superclass.bindUI.call(this);this.after("fields-rendered",function(c){(c=this.getField("newslettersEnabled"))&&
this._registerEvent(c.after("dataChange",this._toggleNewsletters,this));if(c=this.getField("betaFeatureActive")){this._registerEvent(c.after("dataChange",function(b){this._disableAllBetaFeatures(b.newVal)},this));var e=b.Squarespace.Utils.isBetaFeatureEnabled();c.set("data",e,{silent:!0});this._disableAllBetaFeatures(e)}},this)},_disableAllBetaFeatures:function(c){b.Array.each(["damaskHeader","damaskActive","damaskBlogPostFrontendEditing"],function(b){c||this.getField(b).set("data",!1);this.getField(b).set("visible",
c)},this)},_saveChanges:function(){return b.Squarespace.Promises.create(function(c,e){b.Array.each(this._renderedFields,function(c){c instanceof b.Squarespace.DialogFields.CookieCheck&&c.setCookie()},this);c()},this)},_initSaveChanges:function(){return this._saveChanges().then(b.Squarespace.Fluent.Information({"strings.title":this.get("strings.saveSuccessfulTitle"),"strings.message":this.get("strings.saveSuccessfulDescription")})).then(b.bind(function(){this.markAsClean();window.location.href="/config";
window.location.reload()},this))},_toggleNewsletters:function(c){b.Data.get({url:"/api/rest/newsletters/settings/"+(c.newVal?"enable":"disable"),success:b.bind(function(b){this.showSuccessConfirmation()},this),failure:function(b){console.warn("[setNewsletters]",b)}})}},{CSS_PREFIX:"sqs-lab-settings",ATTRS:{"strings.title":{value:"Labs"},"strings.description":{value:"Squarespace Labs contains all the various exprimental features that are being developed by their illustrious engineers. Proceed at your own peril, but keep in mind: with great risk comes great reward."},
fields:{value:c}}})},"1.0",{requires:"base squarespace-dialog-cookie-check squarespace-dialog-description squarespace-dialog-field-2 squarespace-dialog-fields squarespace-dialog-structured-input squarespace-dialog-text squarespace-dialog-timezone squarespace-fluent-confirmation squarespace-settings-panel".split(" ")});
YUI.add("squarespace-block-content-image-editor",function(b){b.namespace("Squarespace.Content.Image").Editor=b.Base.create("ImageEditor",b.Plugin.Base,[],{initializer:function(){var d=this._host=this.get("host"),c=this._model=this._host.get("model");d.get("parent")?this.isBlogApp=d.get("parent").get("editController").isMobileApp():this.isBlogApp=!1;var e=b.UA.mobile?"dbltap":"dblclick";this._bb=d.get("boundingBox");this._cb=d.get("contentBox");this.isBlogApp||(this._bb.on(e,function(){b.Lang.isValue(c.get("imageId"))&&
!c.get("processing")&&this.set("editing",!0)},this),this.after("editingChange",this._editingChange,this));c.on("aspectRatioChange",d.blur,this);c.after(["imageIdChange","isBase64Change"],this._syncUploadUI,this);this._syncUploadUI()},_syncUploadUI:function(){var d=this._model;d.isEmpty()?this.isBlogApp?this.uploadButton||(this.uploadButton=b.Node.create('<div class="sqs-upload-button">Select Image</div>'),this._cb.appendChild(this.uploadButton),this.uploadButton.on("tap",function(){var b=this._host.get("id");
this._host.get("parent").get("editController").callNativeAppMethod("imagepicker","contentID="+b)},null,this)):(d.get("imageId")||this._removeImageOverlay(),this.uploader||(this.uploader=new b.Squarespace.Uploader({uploadURL:"/api/commondata/SaveMedia",multipleFiles:!1,appendNewFiles:!1,isTransient:b.Squarespace.UploadModes.TRANSIENT,isGlobal:!1,autoUpload:!0,addPlaceholder:b.bind(this._addPlaceholder,this),selectButtonLabel:"Add Image",dragAndDropArea:this._bb,fileFilters:[{description:"Images",extensions:"*.jpg;*.jpeg;*.png;*.gif;*.ico",
acceptTypes:"image/png, image/gif, image/jpeg"}],maxSize:20,processFile:b.bind(this._processFile,this),createJob:b.bind(this._createImageProcessingJob,this),jobComplete:b.bind(this._jobComplete,this),render:this._cb}),this.uploader.on("fileuploadstart",function(){this.uploadProgress({completed:0})},this),this.uploader.after("uploadprogress",function(b){this.uploadProgress({completed:b.percentLoaded})},this),this.uploader.get("boundingBox").removeClass("sqs-uploader"),this.uploader.get("boundingBox").addClass("sqs-image-uploader"))):
(this.uploader&&(this.uploader.destroy(),this.uploader=null),this.uploadButton&&(this.uploadButton.detach("tap"),this.uploadButton.remove()),this._host.render())},_addPlaceholder:function(b){return this._cb},_createImageProcessingJob:function(d,c){if(!c.job)return console.warn("Didn't create image processing job because response didn't have job information."),null;var e=new b.Squarespace.ImageProcessingJob(b.merge(c.job,{started:!0}));this.uploadProgress({completed:1,itemRepresentation:c.media[0]});
return e},_jobComplete:function(d,c){c.get("status")==b.Squarespace.JobStatuses.SUCCESS?this._model.loadImageData().then(b.bind(function(){this.jobUpdate({status:c.get("status"),data:c.get("data")})},this)):this.jobUpdate({status:c.get("status"),data:c.get("data")})},_processFile:function(d){if(d.invalid){var c=d.invalid[0];d=c.title;c=c.message;this.get("strings.invalidDrop")&&(d=this.get("strings.invalidDrop.title"),c=this.get("strings.invalidDrop.message"));new b.Squarespace.Widgets.Alert({position:b.Squarespace.Widgets.Alert.ANCHOR.ELEMENT,
anchor:this.get("contentBox"),"strings.title":d,"strings.message":c})}else d.postData={process:!0,contentType:"image"}},uploadProgress:function(d){var c=d.lowresImage,e=d.itemRepresentation,f={completed:d.completed||0};b.Lang.isNumber(d.completed)&&1==d.completed&&(f.processing=!0);if(b.Lang.isValue(c)){this._bb.toggleClass("uploading",1!==d.completed);var g=d.dimensions.split("x");d=parseInt(g[0],10);g=parseInt(g[1],10);f.isBase64=!0;f.baseAssetUrl=c;f.completed=0;f.dimensions={width:d,height:g};
f.aspectRatio=100*(g/d)}b.Lang.isObject(e)&&(f.baseAssetUrl=e.assetUrl,f.imageId=e.id);this._updateModel(f)},jobUpdate:function(d){d.status==b.Squarespace.JobStatuses.SUCCESS&&this._model.setAttrs({isBase64:!1,processing:!1})},_updateModel:function(b){this._model.setAttrs(b);this._host.get("parent")&&this._host.get("parent").get("isNewBlock")&&this._host.get("parent").set("isNewBlock",!1)},_editingChange:function(d){d=this._model;var c=this.get("editing");d.get("imageId")&&(c?(this._bb.on("clickoutside",
this._onClickOutside,this),this.imgOverlay&&b.Lang.isValue(this._host.imgNode)&&(d=this.imgOverlay.get("contentBox").one("img").getAttribute("src"),c=this._host.imgNode.getAttribute("src"),d!==c&&(this.imgOverlay.destroy(),this.imgOverlay=null)),this.imgOverlay||this._createImgOverlay(),this.imgOverlay.get("boundingBox").setStyles({position:"absolute",opacity:1}),this.imgOverlay.show(),this.isBlogApp||(this.mousedown=this._bb.on("mousedown",this._imgDragMousedown,this))):(this._bb.detach("clickoutside"),
this.set("positioning",!1),this._hideOverlay(),this.mousedown&&this.mousedown.detach(),this.imgDragMove&&this.imgDragMove.detach(),this.imgDragUpInnerFrame&&this.imgDragUpInnerFrame.detach(),this.imgDragUpOuterFrame&&this.imgDragUpOuterFrame.detach()))},_onClickOutside:function(b){!1!==this.get("editing")&&!b.target.ancestor(".dialog-imageblockconfig",!0)&&this.set("editing",!1)},_hideOverlay:function(b){this.imgOverlay&&this.imgOverlay.hide()},_createImgOverlay:function(){if(!this.imgOverlay){var d=
b.Node.create('<img class="sqs-image-overlay">');d.setAttribute("src",this._host.imgNode.getAttribute("src"));d.setStyles({height:"100%",width:"100%",opacity:0.2});this.imgOverlay=new b.Overlay({bodyContent:d,zIndex:1,align:{node:this._host.imgNode,points:["cc","cc"]}});this.imgOverlay.on("visibleChange",function(){var b=this.get("align.node").get("region");this.setAttrs({height:b.height,width:b.width});this.align()},this.imgOverlay);this.imgOverlayFocalPointChangeEvt=this._model.after("focalPointChange",
function(){this.imgOverlay.align()},this);this.imgOverlay.get("boundingBox").addClass("sqs-imageoverlay");this.imgOverlay.get("bodyContent").setStyle("height",null);(d=this._bb.ancestor(".sqs-block"))||(d="body");this.imgOverlay.render(d);this.imgOverlay.hide()}},_removeImageOverlay:function(){this.imgOverlay&&(this.imgOverlayFocalPointChangeEvt.detach(),this.imgOverlay.destroy(),this.imgOverlay=null)},_imgDragMousedown:function(d){if(this.get("editing")&&!this._model.isEmpty()){b.DD.DDM.stopDrag();
d.halt();var c=this.get("id");this.startX=d.pageX;this.startY=d.pageY;this.startFocal=this._model.get("focalPoint").split(",");this.bbR=this._host.get("boundingBox").get("region");this.imgR=this._host.imgNode.get("region");this.imgDragMove&&this.imgDragMove.detach();this.imgDragUpInnerFrame&&this.imgDragUpInnerFrame.detach();this.imgDragUpOuterFrame&&this.imgDragUpOuterFrame.detach();this.imgDragMove=b.one(b.config.win).on([c+"|mousemove",c+"|touchmove"],this._imgDragDrag,this);this.imgDragUpInnerFrame=
b.one(b.config.win).on([c+"|mouseup",c+"|touchend"],this._imgDragEnd,this);this.imgDragUpOuterFrame=b.one(window).on([c+"|mouseup",c+"|touchend"],this._imgDragEnd,this);this.set("positioning",!0)}},_imgDragDrag:function(b){var c=this.imgR,e=this.bbR,f=b.pageX-this.startX;b=b.pageY-this.startY;var g=parseFloat(this.startFocal[0]),h=parseFloat(this.startFocal[1]),f=this._calculateFocalPoint(f,c.width,e.width,g),c=this._calculateFocalPoint(b,c.height,e.height,h);this._model.set("focalPoint",f+","+c)},
_calculateFocalPoint:function(b,c,e,f){c=e-c;return 0<=c?f:Math.max(Math.min((c*f+b)/c,1),0)},_imgDragEnd:function(b){this.imgDragMove&&this.imgDragMove.detach();this.imgDragUpInnerFrame&&this.imgDragUpInnerFrame.detach();this.imgDragUpOuterFrame&&this.imgDragUpOuterFrame.detach();this.set("positioning",!1);this._model.saveFocalPoint()},destructor:function(){this.uploader&&this.uploader.destroy();this.uploadButton&&(this.uploadButton.detachAll(),this.uploadButton.remove())}},{NS:"contentEditor",ATTRS:{editing:{value:!1},
tabIndex:{value:0},focused:{value:!1,readOnly:!0}}})},"2.0",{requires:"node base plugin overlay anim event-touch event-tap dd-delegate squarespace-uploader squarespace-jobs squarespace-job-manager squarespace-event-dbltap squarespace-models-content-item squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-dialog-promo-code-field",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.PromoCodeField=b.Base.create("promoCodeField",b.Squarespace.DialogFields.Text,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox").one(".title"),e=b.Node.create('<div class="promoCodeGenerator">Generate</div>');c.insert(e,"after")},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").one(".promoCodeGenerator").on("click",
this._generatePromoCode,this)},_generatePromoCode:function(){for(var b=this.get("validChars"),e="",d=0;d<this.get("promoCodeLength");++d)var g=Math.floor(Math.random()*b.length),e=e+b.charAt(g);this.set("data",e)}},{CSS_PREFIX:"sqs-promo-code",ATTRS:{promoCodeLength:{value:7},validChars:{value:"ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789"}}})},"1.0",{requires:["base","squarespace-dialog-text"]});
YUI.add("squarespace-block-menu-editor",function(b){b.namespace("Squarespace.Block.Editor").Menu=b.Base.create("menu-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Menu")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Menu"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Menu=b.Base.create("block-menu-editor",b.Squarespace.ModelEditorDialog,[],{sanitizeDialogData:function(c){c&&
c.raw&&(c.menus=b.Squarespace.Utils.parseMenu(c.raw));return c}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={width:465,height:505,name:"menu-editor",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Menu",tabTitle:"Menu",icon:"/universal/images-v6/icons/icon-menu-20-light-solid.png",scroll:!0,fields:[{type:"textarea",name:"raw",description:"<strong>Squarespace Menu Formatting.</strong>  Squarespace uses simple formatting to style your menu. See the <strong>Formatting Help</strong> tab for more help with menu formats.",
height:440}]},{tabTitle:"Design",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Menu Style","strings.description":"Choose a layout style for your menu.",name:"menuStyle",className:"thin dark",defaultValue:"simple",options:[{value:"simple",label:"Simple (Centered)"},{value:"classic",label:"Classic (Multi-column)"}]}},{ctor:b.Squarespace.DialogFields.Select,config:{"strings.title":"Currency Symbol",name:"currencySymbol","strings.description":"Choose a currency symbol to display on your menu items.",
defaultValue:"$",className:"thin dark",options:[{value:"",label:"None"},{value:"$",label:"$"},{value:"\u20ac",label:"\u20ac"},{value:"\u00a3",label:"\u00a3"},{value:"\u00a5",label:"\u00a5"}]}}]},{tabTitle:"Formatting Help",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Menu Sections.</strong> Sections define groups of items on your menu. Section descriptions are optional. To create a section, type: <pre>Section\n-------\nOptional section description.</pre><strong>Menu Items.</strong> To add an item to your menu, type in the following format. Separate multiple menu items with 2 spaces. Options can be added to an item by using the '+' format on a new line. Both prices and descriptions are optional. <pre>Title of Menu Item\nDescription of food item.\n$10\n\nAnother of Menu Item\nA different description.\n$20\n+ Option\n+ Another Option</pre><strong>Price Variants.</strong> You can also define multiple prices for variants on your items in the following format: <pre>Wine Bottle Example\nDescription of the wine\n$9 glass / $40 bottle\n\nSalad Example\nA great, low-carb salad.\n$9 small / $15 large</pre><strong>Multiple Menus.</strong> Menu blocks can contain multiple menus at once (lunch, dinner, etc.). Menus will be turned into tabs upon rendering. To create a menu within a block, type: <pre>Lunch\n=======\nOptional menu description.</pre>"}}]}]}},
"1.0",{requires:["squarespace-block-editor-dialog","squarespace-block-menu-parser","squarespace-damask-context-globals"]});
YUI.add("squarespace-murmurhash",function(b){function d(b){b=b.replace(/[\u0080-\u07ff]/g,function(b){b=b.charCodeAt(0);return String.fromCharCode(192|b>>6,128|b&63)});return b=b.replace(/[\u0800-\uffff]/g,function(b){b=b.charCodeAt(0);return String.fromCharCode(224|b>>12,128|b>>6&63,128|b&63)})}b.namespace("Squarespace");b.Squarespace.MurmurHash={hash:function(b,e){var f=d(b),g,h,k,l,p;g=f.length&3;h=f.length-g;k=e;for(p=0;p<h;)l=f.charCodeAt(p)&255|(f.charCodeAt(++p)&255)<<8|(f.charCodeAt(++p)&
255)<<16|(f.charCodeAt(++p)&255)<<24,++p,l=3432918353*(l&65535)+((3432918353*(l>>>16)&65535)<<16)&4294967295,l=l<<15|l>>>17,l=461845907*(l&65535)+((461845907*(l>>>16)&65535)<<16)&4294967295,k^=l,k=k<<13|k>>>19,k=5*(k&65535)+((5*(k>>>16)&65535)<<16)&4294967295,k=(k&65535)+27492+(((k>>>16)+58964&65535)<<16);l=0;switch(g){case 3:l^=(f.charCodeAt(p+2)&255)<<16;case 2:l^=(f.charCodeAt(p+1)&255)<<8;case 1:l^=f.charCodeAt(p)&255,l=3432918353*(l&65535)+((3432918353*(l>>>16)&65535)<<16)&4294967295,l=l<<15|
l>>>17,k^=461845907*(l&65535)+((461845907*(l>>>16)&65535)<<16)&4294967295}k^=f.length;k^=k>>>16;k=2246822507*(k&65535)+((2246822507*(k>>>16)&65535)<<16)&4294967295;k^=k>>>13;k=3266489909*(k&65535)+((3266489909*(k>>>16)&65535)<<16)&4294967295;return k^k>>>16}}},"1.0");
YUI.add("squarespace-block-link",function(b){b.namespace("Squarespace.Block").Link=b.Base.create("block-link",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-link",ATTRS:{editor:{value:b.Squarespace.Block.Editor.Link},defaultContentModel:{value:{linkTitle:"",linkTarget:"",newWindow:!1}}}})},"1.0",{requires:["squarespace-block-base-modelsync","squarespace-block-link-editor"]});
YUI.add("squarespace-form-builder-field",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.FormBuilderField=b.Base.create("formBuilderField",b.Squarespace.Widgets.SSWidget,[b.WidgetChild,b.Squarespace.Mixins.Expandable],{initializer:function(){this.publish("removeClicked",{emitFacade:!0});var c=this.get("field");this._titleField=new b.Squarespace.DialogFields.Text({name:"fieldTitle",data:c.title});"hidden"===c.type&&(c.key=this._cleanTitleForHidden(c.title));this._editor=
new b.Squarespace.Widgets.FormBuilderFieldEditor({field:c})},destructor:function(){this._titleField.destroy();this._editor.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._editButton=b.one(".edit-field");var e=this._editorWrapper=b.one(".editor-wrapper");this._set("expandableNode",e);e.hide(!0);this._titleField.render(b.one(".field-title"));this._editor.render(e)},bindUI:function(){d.superclass.bindUI.call(this);this.after("editingChange",this.syncUI,
this);this._editor.on("change",function(b){this.fire("fieldChange")},this);this._bindTitleField();this._bindEditButton();this._bindRemoveButton()},syncUI:function(){d.superclass.syncUI.call(this);this.get("editing")?(this._editButton.setContent(this.get("strings.doneText")),this.open()):(this._editButton.setContent(this.get("strings.editText")),this.close());var b=this.get("field").locked;this.get("contentBox").toggleClass("field-locked",b)},openEdit:function(){this._set("editing",!0)},closeEdit:function(){this._set("editing",
!1)},focusAndSelect:function(){var b=this._titleField;b.focus();b.select()},lock:function(){this.get("field").locked=!0;this.fire("fieldChange");this.syncUI()},unlock:function(){this.get("field").locked=!1;this.fire("fieldChange");this.syncUI()},_bindTitleField:function(){var b=this._titleField,e=this.get("field");b.after("dataChange",function(b){e.title=b.newVal;"hidden"===e.type&&(b=this._cleanTitleForHidden(e.title),this._editor.item(0).set("data",b));this.fire("fieldChange")},this)},_bindEditButton:function(){this._editButton.on("click",
function(){this.get("animating")||(this.get("editing")?this.closeEdit():this.openEdit())},this)},_bindRemoveButton:function(){this.get("contentBox").one(".remove-field").on("click",function(b){b.halt();this.fire("removeClicked")},this)},_cleanTitleForHidden:function(b){b=b.trim().replace(/\W/g,"_").toUpperCase();0!==b.indexOf("SQF_")&&(b="SQF_"+b);return b}},{CSS_PREFIX:"sqs-form-builder-field",HANDLEBARS_TEMPLATE:"form-builder-field.html",ATTRS:{strings:{value:{editText:"Edit",doneText:"Done"},validator:b.Squarespace.AttrValidators.isObject,
writeOnce:"initOnly"},field:{value:null,validator:b.Squarespace.AttrValidators.isNullOrObject,writeOnce:"initOnly"},editing:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0},animating:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0}}})},"1.0",{requires:"base widget-child squarespace-animations squarespace-attr-validators squarespace-dialog-text squarespace-form-builder-field-editor squarespace-form-builder-field-template squarespace-mixins-expandable squarespace-ss-widget".split(" ")});
YUI.add("squarespace-navigation-item-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["navigation-item.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="icon icon-';(h=d.icon)?h=h.call(c,{hash:{},data:k}):(h=c.icon,h="function"===typeof h?h.apply(c):h);b+=l(h)+'"></div>\n<div class="title" title="';(h=d.navigationTitle)?h=h.call(c,{hash:{},data:k}):(h=c.navigationTitle,
h="function"===typeof h?h.apply(c):h);if(h||0===h)b+=h;b+='">';(h=d.navigationTitle)?h=h.call(c,{hash:{},data:k}):(h=c.navigationTitle,h="function"===typeof h?h.apply(c):h);if(h||0===h)b+=h;return b+'</div>\n<div class="icons">\n  <span class="icon icon-homepage"></span>\n  <span class="icon icon-syncing"></span>\n  <a href="#" class="icon icon-configure"></a>\n  <a href="#" class="icon icon-delete"></a>\n</div>'})})();b.Handlebars.registerPartial("navigation-item.html".replace("/","."),d.templates["navigation-item.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-connected-account-editors",function(b){var d={tumblr:b.Squarespace.TumblrAccountEditor};b.namespace("Squarespace").ConnectedAccountEditors={create:function(c){var e=c.get("serviceName"),f=d[e];f||(f=b.Squarespace.ModelEditorDialog);return new f({model:c,dialogConfigContext:b.Squarespace.ConnectedAccountDialogSettingsContext,dialogConfig:b.Squarespace.ConnectedAccountDialogSettings.get(e)})}}},"1.0",{requires:["squarespace-connected-account-dialog-settings","squarespace-model-editor",
"squarespace-tumblr-connected-account-editor"]});
YUI.add("squarespace-layout-email-utils",function(b){b.namespace("Squarespace").Layout.EmailUtils={prepHtmlForEmail:function(d){var c=b.Node.create("<div></div>");c.setContent(d);var e=c.get("children");d=e.item(0);e=e.pop();this._shouldCollapseMargin(d)&&d.setStyle("marginTop","0");this._shouldCollapseMargin(e)&&e.setStyle("marginBottom","0");c.all("*").setStyle("font-family","Helvetica, Arial, sans-serif");c.all(".text-align-left").setStyle("text-align","left");c.all(".text-align-center").setStyle("text-align",
"center");c.all(".text-align-right").setStyle("text-align","right");d=c.getContent();c.destroy();return d},_shouldCollapseMargin:function(d){return!b.Lang.isValue(d)?!1:(d=d.getDOMNode().tagName.match(/(p|h[1-6])/i))&&0<d.length}}});
YUI.add("squarespace-dialog-oembed-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-oembed.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var l,p=this.escapeExpression;if((h=d["if"].call(c,(l=c.strings,null==l||!1===l?l:l.title),{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,d;return e=""+('\n  <div class="title">'+p((d=(d=b.strings,null==d||!1===d?d:d.title),"function"===
typeof d?d.apply(b):d))+"</div>\n")},k),data:k}))||0===h)b+=h;b+="\n\n";if((h=d["if"].call(c,c.manual,{hash:{},inverse:this.noop,fn:this.program(3,function(b,c){return'\n  <div class="manual">&nbsp;</div>\n'},k),data:k}))||0===h)b+=h;b+='\n\n<input class="input field-input ';if((h=d["if"].call(c,c.manual,{hash:{},inverse:this.noop,fn:this.program(5,function(b,c){return"has-manual"},k),data:k}))||0===h)b+=h;b+='" value="';if((h=d["if"].call(c,(l=c.data,null==l||!1===l?l:l.url),{hash:{},inverse:this.noop,
fn:this.program(7,function(b,c){var e;return p((e=(e=b.data,null==e||!1===e?e:e.url),"function"===typeof e?e.apply(b):e))},k),data:k}))||0===h)b+=h;return b+='"\n  placeholder="'+p((l=(l=c.strings,null==l||!1===l?l:l.inputPlaceholder),"function"===typeof l?l.apply(c):l))+'" spellcheck="false" tabindex="1">\n\n<div class="status description"></div>'})})();b.Handlebars.registerPartial("dialog-oembed.html".replace("/","."),d.templates["dialog-oembed.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-mixins-field-filter",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.FilteredModelList=b.Base.create("FilteredModelList",b.Base,[],{initializer:function(){b.Do.after(function(){var d=this._filterUrl(b.Do.currentRetVal);return new b.Do.AlterReturn("Adding field filter.",d)},this,"getURL",this)},_filterUrl:function(d){d=d.split("?");var c=d[1],c=b.Lang.isValue(c)?c+"&":"",c=c+("fields="+this.get("fields").join(","));return d[0]+"?"+c}})},"1.0",{requires:["base",
"json","squarespace-attr-validators"]});
YUI.add("widget-buttons",function(b,d){function c(){this._buttonsHandles={}}var e=b.Array,f=b.Lang,g=b.Object,h=b.Plugin.Button,k=b.Widget,l=b.WidgetStdMod,p=b.ClassNameManager.getClassName,q=f.isArray,r=f.isNumber,s=f.isString,t=f.isValue;c.ATTRS={buttons:{getter:"_getButtons",setter:"_setButtons",value:{}},defaultButton:{readOnly:!0,value:null}};c.CLASS_NAMES={button:p("button"),buttons:k.getClassName("buttons"),primary:p("button","primary")};c.HTML_PARSER={buttons:function(b){return this._parseButtons(b)}};
c.NON_BUTTON_NODE_CFG="action classNames context events isDefault section".split(" ");c.prototype={BUTTONS:{},BUTTONS_TEMPLATE:"<span />",DEFAULT_BUTTONS_SECTION:l.FOOTER,initializer:function(){this._stdModNode||b.error("WidgetStdMod must be added to a Widget before WidgetButtons.");this._mapButtons(this.get("buttons"));this._updateDefaultButton();this.after({buttonsChange:b.bind("_afterButtonsChange",this),defaultButtonChange:b.bind("_afterDefaultButtonChange",this)});b.after(this._bindUIButtons,
this,"bindUI");b.after(this._syncUIButtons,this,"syncUI")},destructor:function(){g.each(this._buttonsHandles,function(b){b.detach()});delete this._buttonsHandles;delete this._buttonsMap;delete this._defaultButton},addButton:function(b,c,d){var f=this.get("buttons"),g;b.getDOMNode||(b=this._mergeButtonConfig(b),c||(c=b.section));c||(c=this.DEFAULT_BUTTONS_SECTION);g=f[c]||(f[c]=[]);r(d)||(d=g.length);g.splice(d,0,b);d=e.indexOf(g,b);this.set("buttons",f,{button:b,section:c,index:d,src:"add"});return this},
getButton:function(b,c){if(t(b)){var e=this._buttonsMap;c||(c=this.DEFAULT_BUTTONS_SECTION);return r(b)?(e=this.get("buttons"),e[c]&&e[c][b]):1<arguments.length?e[c+":"+b]:e[b]}},removeButton:function(b,c){if(!t(b))return this;var d=this.get("buttons"),f;r(b)?(c||(c=this.DEFAULT_BUTTONS_SECTION),f=b,b=d[c][f]):(s(b)&&(b=this.getButton.apply(this,arguments)),g.some(d,function(d,g){f=e.indexOf(d,b);if(-1<f)return c=g,!0}));b&&-1<f&&(d[c].splice(f,1),this.set("buttons",d,{button:b,section:c,index:f,
src:"remove"}));return this},_bindUIButtons:function(){var c=b.bind("_afterContentChangeButtons",this);this.after({visibleChange:b.bind("_afterVisibleChangeButtons",this),headerContentChange:c,bodyContentChange:c,footerContentChange:c})},_createButton:function(d){var f,g,k,l;if(d.getDOMNode)return b.one(d.getDOMNode()).plug(h);f=b.merge({context:this,events:"click",label:d.value},d);d=b.merge(f);g=c.NON_BUTTON_NODE_CFG;k=0;for(l=g.length;k<l;k+=1)delete d[g[k]];d=h.createNode(d);k=f.context;g=f.action;
s(g)&&(g=b.bind(g,k));g=d.on(f.events,g,k);this._buttonsHandles[b.stamp(d,!0)]=g;d.setData("name",this._getButtonName(f));d.setData("default",this._getButtonDefault(f));e.each(e(f.classNames),d.addClass,d);return d},_getButtonContainer:function(e,d){var f=l.SECTION_CLASS_NAMES[e],g=c.CLASS_NAMES.buttons,f=this.get("contentBox").one("."+f+" ."+g);!f&&d&&(f=b.Node.create(this.BUTTONS_TEMPLATE),f.addClass(g));return f},_getButtonDefault:function(b){b=b.getDOMNode?b.getData("default"):b.isDefault;return s(b)?
"true"===b.toLowerCase():!!b},_getButtonName:function(b){return b.getDOMNode?b.getData("name")||b.get("name"):b&&(b.name||b.type)},_getButtons:function(b){var c={};g.each(b,function(b,e){c[e]=b.concat()});return c},_mapButton:function(b,c){var e=this._buttonsMap,d=this._getButtonName(b),f=this._getButtonDefault(b);d&&(e[d]=b,e[c+":"+d]=b);f&&(this._defaultButton=b)},_mapButtons:function(b){this._buttonsMap={};this._defaultButton=null;g.each(b,function(b,c){var e,d;e=0;for(d=b.length;e<d;e+=1)this._mapButton(b[e],
c)},this)},_mergeButtonConfig:function(c){var e,d;c=s(c)?{name:c}:b.merge(c);c.srcNode&&(e=c.srcNode,d=e.get("tagName").toLowerCase(),d=e.get("input"===d?"value":"text"),e={disabled:!!e.get("disabled"),isDefault:this._getButtonDefault(e),name:this._getButtonName(e)},d&&(e.label=d),b.mix(c,e,!1,null,0,!0));e=this._getButtonName(c);(e=this.BUTTONS&&this.BUTTONS[e])&&b.mix(c,e,!1,null,0,!0);return c},_parseButtons:function(b){var d="."+c.CLASS_NAMES.button,f=null;e.each(["header","body","footer"],function(b){var c=
this._getButtonContainer(b),c=c&&c.all(d),e;c&&!c.isEmpty()&&(e=[],c.each(function(b){e.push({srcNode:b})}),f||(f={}),f[b]=e)},this);return f},_setButtons:function(b){function c(b,f){if(q(b)){var g,h,k,l;g=0;for(h=b.length;g<h;g+=1)k=b[g],l=f,k.getDOMNode||(k=this._mergeButtonConfig(k),l||(l=k.section)),k=this._createButton(k),l||(l=e),(d[l]||(d[l]=[])).push(k)}}var e=this.DEFAULT_BUTTONS_SECTION,d={};q(b)?c.call(this,b):g.each(b,c,this);return d},_syncUIButtons:function(){this._uiSetButtons(this.get("buttons"));
this._uiSetDefaultButton(this.get("defaultButton"));this._uiSetVisibleButtons(this.get("visible"))},_uiInsertButton:function(b,e,d){var f=c.CLASS_NAMES.button,g=this._getButtonContainer(e,!0),f=g.all("."+f);g.insertBefore(b,f.item(d));this.setStdModContent(e,g,"after")},_uiRemoveButton:function(e,d,f){var g=b.stamp(e,this),h=this._buttonsHandles,k=h[g];k&&k.detach();delete h[g];e.remove();f||(f={});f.preserveContent||(e=this._getButtonContainer(d),f=c.CLASS_NAMES.button,e&&e.all("."+f).isEmpty()&&
(e.remove(),this._updateContentButtons(d)))},_uiSetButtons:function(b){var d=c.CLASS_NAMES.button;e.each(["header","body","footer"],function(c){var e=b[c]||[],f=e.length,g=this._getButtonContainer(c,f),h=!1,k,l,p,q;if(g){k=g.all("."+d);for(l=0;l<f;l+=1)p=e[l],q=k.indexOf(p),-1<q?(k.splice(q,1),q!==l&&(g.insertBefore(p,l+1),h=!0)):(g.appendChild(p),h=!0);k.each(function(b){this._uiRemoveButton(b,c,{preserveContent:!0});h=!0},this);0===f?(g.remove(),this._updateContentButtons(c)):h&&this.setStdModContent(c,
g,"after")}},this)},_uiSetDefaultButton:function(b,e){var d=c.CLASS_NAMES.primary;b&&b.addClass(d);e&&e.removeClass(d)},_uiSetVisibleButtons:function(b){b&&(b=this.get("defaultButton"))&&b.focus()},_unMapButton:function(b,c){var e=this._buttonsMap,d=this._getButtonName(b);d&&(e[d]===b&&delete e[d],d=c+":"+d,e[d]===b&&delete e[d]);this._defaultButton===b&&(this._defaultButton=null)},_updateDefaultButton:function(){var b=this._defaultButton;this.get("defaultButton")!==b&&this._set("defaultButton",b)},
_updateContentButtons:function(b){var c=this.getStdModNode(b).get("childNodes");this.set(b+"Content",c.isEmpty()?null:c,{src:"buttons"})},_afterButtonsChange:function(b){var c=b.newVal,e=b.section,d=b.index,f=b.src;"add"===f?(b=c[e][d],this._mapButton(b,e),this._updateDefaultButton(),this._uiInsertButton(b,e,d)):"remove"===f?(b=b.button,this._unMapButton(b,e),this._updateDefaultButton(),this._uiRemoveButton(b,e)):(this._mapButtons(c),this._updateDefaultButton(),this._uiSetButtons(c))},_afterContentChangeButtons:function(b){var c=
b.src;b=b.stdModPosition;(!b||b===l.REPLACE)&&("buttons"!==c&&c!==k.UI_SRC)&&this._uiSetButtons(this.get("buttons"))},_afterDefaultButtonChange:function(b){this._uiSetDefaultButton(b.newVal,b.prevVal)},_afterVisibleChangeButtons:function(b){this._uiSetVisibleButtons(b.newVal)}};b.WidgetButtons=c},"3.17.2",{requires:["button-plugin","cssbutton","widget-stdmod"]});
YUI.add("squarespace-content-manager-widgets-gallery",function(b){b.namespace("Squarespace.ContentManagerWidgets");var d=b.Squarespace.ContentManagerWidgets.Gallery=b.Base.create("ContentManagerGallery",b.Squarespace.ContentManagerWidgets.Base,[b.WidgetChild],{initializer:function(){this._contentItemGrid=this._createContentItemGrid();this._itemsLoaded=!1;this._loadItems()},destructor:function(){b.one("body").removeClass("sqs-content-manager-gallery-active");this.get("collection").items.detach(this.get("id")+
"|*");this._contentItemGrid.destroy()},renderUI:function(){d.superclass.renderUI.call(this);b.one("body").addClass("sqs-content-manager-gallery-active");var c=b.Node.create('<div class="loading-state"></div>');(new b.Squarespace.Spinner({size:100,color:"dark",render:c})).spin();this.get("contentBox").append(c)},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("collection");this._registerEvent(c.after("synchronizingChange",function(b){!b.newVal&&b.prevVal&&this._loadItems()},this));
this._registerEvent(b.on("resize",function(b){this.headerTray.syncUI()},b.config.win,this));this._registerEvent(c.after("idChange",this._loadItems,this));this._registerEvent(this._contentItemGrid.after("itemSaved",c.load,c))},syncUI:function(){d.superclass.syncUI.call(this);this._itemsLoaded?this._setLoadedState():this._setLoadingState();this.get("collection").get("isDemoCollection")&&this._contentItemGrid.set("dragSelectionEnabled",!1)},handleAddContentRequest:function(){this._contentItemGrid.handleAddContentRequest()},
_loadItems:function(){this.get("collection").items.load({limit:this.get("limit"),html:!1},b.bind(function(){this._itemsLoaded=!0;this.syncUI()},this))},_setLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this.get("boundingBox").removeClass("content-loading");var b=this._contentItemGrid;b.get("rendered")?b.syncUI():b.render(this.get("contentBox"))},_setLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=b.later(500,this,function(){this.get("boundingBox").addClass("content-loading")})},
_createContentItemGrid:function(){var c={};b.Squarespace.Utils.isDamaskEnabled()&&(c.dragRegion=this.get("boundingBox"),c.actionTrayRelativePositionFixedNode=this.get("boundingBox"));return new b.Squarespace.ContentItemGrid(b.merge({collectionConfiguration:this.get("collectionConfiguration"),moveable:!0,dragRegion:b.one(".page-background-column"),model:this.get("collection"),collection:this.get("collection"),contentItemImageOptions:{editable:!0,progressSpinnerSize:45},showEmptyState:!0,imageSize:230,
customDragRegion:".page-background-column",windowScrollOnDrag:!b.Squarespace.Utils.isDamaskEnabled(),scrollNode:this.get("boundingBox"),"strings.emptyUploadText":"<h1>Add Media</h1><p>This Gallery contains no items. Drag and drop images from your desktop to add some.</p>"},c,this.get("galleryOptions")))}},{CSS_PREFIX:"sqs-content-manager-gallery",ATTRS:{pageSize:{value:1E3},galleryOptions:{valueFn:function(){var c={};b.Squarespace.Utils.isDamaskEnabled()&&(c={minMargin:10,imageSize:140,dragRegionNode:this.get("boundingBox")});
return c}},helpSectionIdentifier:{value:"gallery"}}})},"1.0",{requires:"base squarespace-ss-widget squarespace-content-item-grid squarespace-content-manager-widgets-base squarespace-content-manager-widgets-gallery-css squarespace-spinner".split(" ")});
YUI.add("parallel",function(b,d){b.Parallel=function(c){this.config=c||{};this.results=[];this.context=this.config.context||b;this.finished=this.total=0};b.Parallel.prototype={results:null,total:null,finished:null,add:function(c){var e=this,d=e.total;e.total+=1;return function(){e.finished++;e.results[d]=c&&c.apply(e.context,arguments)||(1===arguments.length?arguments[0]:b.Array(arguments));e.test()}},test:function(){this.finished>=this.total&&this.callback&&this.callback.call(this.context,this.results,
this.data)},done:function(b,e){this.callback=b;this.data=e;this.test()}}},"3.17.2",{requires:["yui-base"]});
YUI.add("squarespace-editor-form",function(b){b.namespace("Squarespace");var d=b.Squarespace.FormModelEditor=b.Base.create("formModelEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var b=this.get("dialog");b.on("ready",function(){var e=b.getField("formFields"),d=b.getField("formPreview");if(e&&d)e.on("change",d.syncUI,this)},this)},save:function(){this.get("useStorageBackends")?d.superclass.save.call(this,null,b.bind(this._saveFormStorageBackends,this),!0):d.superclass.save.call(this)},
getDialogData:function(){var c=this._formCopy=new b.Squarespace.Models.Form(this.get("model").toJSON()),e={formName:c.get("name"),formFields:c.get("fields"),formPreview:c};(c=c.get("connectedBackends"))&&b.Array.each(c,function(c){var d=c.backendId;if(b.Lang.isValue(d)){var h=c.socialConfig;switch(c.backendType){case b.Squarespace.FormStorageBackendType.EMAIL:e.emailConnect={connected:!0,email:d};break;case b.Squarespace.FormStorageBackendType.GOOGLE:e.googleDocsConnect={connected:!0,username:h.profileUserName,
socialConfig:h,spreadsheetName:c.config.spreadsheetName};break;case b.Squarespace.FormStorageBackendType.MAILCHIMP:e.mailchimpConnect={connected:!0,username:h.profileUserName,socialConfig:h,list:d};break;case b.Squarespace.FormStorageBackendType.SITE_USER:e.siteUserConnect={connected:!0}}}},this);return e},sanitizeDialogData:function(b){b=d.superclass.sanitizeDialogData.call(this,b);this._formCopy.set("name",b.formName);return this._formCopy.toJSON()},_saveFormStorageBackends:function(){var c=this.get("dialog"),
e=c.getData(),e={email:e.emailConnect,googleDocs:e.googleDocsConnect,mailchimp:e.mailchimpConnect,siteUser:e.siteUserConnect};this.get("model").saveStorageBackends(e,function(e){if(e){var d=e.googleDocsConnect,h=e.mailchimpConnect;e=e.emailConnect;var k,l;d?(k="Google Docs Connection Failure",l=d):h?(k="Mailchimp Connection Failure",l=h):e&&(k="Email Connection Failure",l=e);k?(new b.Squarespace.Widgets.Alert({"strings.title":k,"strings.message":l}),c.updateTitle(b.Squarespace.DialogStates.EDITING),
c.allowEditing()):new b.Squarespace.Widgets.Alert({"strings.title":"Form Storage Connection Failure","strings.message":"Unable to connect to form storage backend."})}else this.hide()},this)},_getFormId:function(){return this.get("model").get("id")},_getFormName:function(){return this.get("model").get("name")}},{ATTRS:{model:{value:null,validator:function(c){return b.instanceOf(c,b.Squarespace.Models.Form)}},dialogConfigStrings:{value:{title:"Edit Form",loadingText:"Editing Form..."}},useStorageBackends:{value:!1},
buttons:{value:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Delete Form"},{type:"saveAndClose",title:"Save"}]},dialogConfig:{getter:function(){var c=this.get("dialogConfigStrings"),c={name:"editForm",title:c.title,loadingText:c.loadingText,closeOthers:!1,overlay:0.7,style:"flyout",flyoutPointerDirection:"hidden",initialDataByReference:!0,width:850,height:454,buttons:this.get("buttons"),tabs:[{tabTitle:"Build",icon:"/universal/images-v6/icons/icon-form-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,
config:{name:"formName","strings.title":"Form Name"}},{type:"splitter",fields:[{type:"stack",name:"formBuilder",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"formBuilderTitle",content:"<strong>Manage Form Fields</strong>"}},{ctor:b.Squarespace.DialogFields.FormBuilder,config:{name:"formFields"}}]},{type:"stack",name:"preview",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"formPreviewTitle",content:"<strong>Live Form Preview</strong>"}},{ctor:b.Squarespace.DialogFields.FormPreview,
config:{name:"formPreview"}}]}]}]}]};this.get("useStorageBackends")&&c.tabs.push({tabTitle:"Storage",fields:[{ctor:b.Squarespace.DialogFields.EmailServiceConnect,config:{name:"emailConnect"}},{ctor:b.Squarespace.DialogFields.GoogleDocsServiceConnect,config:{name:"googleDocsConnect",getSpreadsheetName:b.bind(this._getFormName,this),oauthOwner:{name:"form",getId:b.bind(this._getFormId,this)}}},{ctor:b.Squarespace.DialogFields.MailChimpServiceConnect,config:{name:"mailchimpConnect",oauthOwner:{name:"form",
getId:b.bind(this._getFormId,this)}}},{ctor:b.Squarespace.DialogFields.SiteUserServiceConnect,config:{name:"siteUserConnect"}}]});return c}}}})},"1.0",{requires:"base squarespace-enum squarespace-ui-base squarespace-model-editor squarespace-models-form squarespace-dialog-text squarespace-dialog-html squarespace-dialog-form-builder squarespace-dialog-form-preview squarespace-dialog-email-service-connect squarespace-dialog-google-docs-service-connect squarespace-dialog-mailchimp-service-connect squarespace-dialog-site-user-service-connect squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-promises",function(b){function d(){}var c=b.namespace("Squarespace.Promises");c.all=function(){var c=new b.Array(arguments);return new b.Promise(function(d,g){var h=[],k=c.length,l=0,p=function(b){return function(c){l++;h[b]=c;l>=k&&d(h)}};b.Array.each(c,function(c,e){b.when(c).then(p(e),g)})})};c.resolve=function(b,c){return b.then(c)};c.reject=function(b,c){return b.then(d,c)};c.rejectWith=function(c){return b.Squarespace.Promises.create(function(b,d){d(c)})};c.finish=function(b,
c){return b.then(c,c)};c.chainFns=function(c,d){return function(){d=d||this;var g=0<c.length?c.shift().apply(d,arguments):b.when();return b.Array.reduce(c,g,function(c,e){return b.Squarespace.Promises.resolve(b.when(c),b.bind(e,d))})}};c.create=function(c,d){return new b.Promise(b.bind(c,d))}},"1.0",{requires:["promise"]});
YUI.add("squarespace-editor-google-apps-subscription",function(b){b.namespace("Squarespace.Editor.GoogleApps");var d=b.Squarespace.Editor.GoogleApps.Subscription=b.Base.create("googleAppsSubscriptionEditor",b.Squarespace.ModelEditorDialog,[],{sanitizeDialogData:function(b){var e={addressLine1:b.addressLine1,addressLine2:b.addressLine2,addressLine3:b.addressLine3,locality:b.locality,region:b.region,postalCode:b.postalCode,country:b.country,orgName:b.orgName,contactName:b.contactName},d=this.get("model").get("customer");
d.setAttrs({phoneNumber:b.phoneNumber,alternateEmail:b.alternateEmail,postalAddress:e});return{customer:d,transferToken:this.get("transferToken")}},getDialogData:function(){var c=d.superclass.getDialogData.call(this),c=b.merge(c,c.customer.postalAddress);c.phoneNumber=c.customer.phoneNumber;c.alternateEmail=c.customer.alternateEmail;c.country=c.customer.country;c.addressLine1=c.customer.addressLine1;c.addressLine2=c.customer.addressLine2;c.orgName=c.customer.orgName;c.contactName=c.customer.contactName;
return c},_showDialog:function(){d.superclass._showDialog.call(this);this.get("dialog").updateAutoSave("You will be charged $5 per user per month.")}},{ATTRS:{transferToken:{validator:b.Lang.isString},dialogConfig:{value:{name:"googleAppsSubscription",closeOthers:!1,overlay:0.5,style:"flyout",width:600,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Subscribe"}],tabs:[{title:"Subscribe to Google Apps",icon:"/universal/images-v6/icons/icon-domains-18-light.png",fields:[{ctor:b.Squarespace.DialogFields.HTML,
config:{className:"description",content:'<div class="description-label">Current Email</div>Enter your current email address to use for recovery of your new Google Apps account.'}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"alternateEmail",required:!0,"strings.placeholder":"Alternate Email"}},{ctor:b.Squarespace.DialogFields.HTML,config:{className:"description",content:'<div class="description-label">Organization Information</div>Enter the details of the organization you wish to register Google Apps to.'}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"orgName",required:!0,"strings.placeholder":"Organization Name"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"contactName",required:!0,"strings.placeholder":"Contact Name"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"phoneNumber",required:!0,"strings.placeholder":"(999)-999-9999"}},{type:"splitter",fields:[{type:"stack",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"addressLine1",required:!0,"strings.placeholder":"Address Line 1"}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"addressLine2","strings.placeholder":"Address Line 2"}}]},{type:"stack",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.Select,name:"country","strings.placeholder":"Country",options:b.Squarespace.Localities.getAmericentricSortedCountryOptions()},{ctor:b.Squarespace.DialogFields.Text,name:"locality","strings.placeholder":"City"},{ctor:b.Squarespace.DialogFields.Text,name:"region","strings.placeholder":"State/Region"},{ctor:b.Squarespace.DialogFields.Text,
name:"postalCode","strings.placeholder":"Postal Code"}]}]}]}]}}}})},"1.0",{requires:["base","squarespace-dialog-html","squarespace-dialog-text","squarespace-dialog-select","squarespace-model-editor"]});
YUI.add("squarespace-content-item-types-editor",function(b){b.namespace("Squarespace");b.Squarespace.ContentItemEditorVariants={MINIMAL:1,PANEL:2,DIALOG:3};b.Squarespace.ContentItemEditorFactory=new (b.Base.create("ContentItemEditorFactory",b.Base,[],{initializer:function(){this.EDITORS_BY_RECORDTYPE={};this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.TEXT]=b.Squarespace.ContentItemEditor.Text;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.IMAGE]=b.Squarespace.ContentItemEditor.Image;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.QUOTE]=
b.Squarespace.ContentItemEditor.Quote;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.LINK]=b.Squarespace.ContentItemEditor.Link;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.VIDEO]=b.Squarespace.ContentItemEditor.Video;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.EVENT]=b.Squarespace.ContentItemEditor.Event;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.GALLERY]=b.Squarespace.ContentItemEditor.Gallery;this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.AUDIO]=b.Squarespace.ContentItemEditor.Audio;
this.EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.KBARTICLE]=b.Squarespace.ContentItemEditor.KBArticle;this.MINIMAL_EDITORS_BY_RECORDTYPE={};this.MINIMAL_EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.IMAGE]=b.Squarespace.ContentItemEditor.ImageMinimal;this.MINIMAL_EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.VIDEO]=b.Squarespace.ContentItemEditor.VideoMinimal;this.PRODUCT_EDITORS_BY_PRODUCTTYPE={};this.PRODUCT_EDITORS_BY_PRODUCTTYPE[b.Squarespace.ProductTypes.DIGITAL]=b.Squarespace.ContentItemEditor.ProductDigital;
this.PRODUCT_EDITORS_BY_PRODUCTTYPE[b.Squarespace.ProductTypes.PHYSICAL]=b.Squarespace.ContentItemEditor.ProductPhysical;this.PRODUCT_EDITORS_BY_PRODUCTTYPE[b.Squarespace.ProductTypes.SERVICE]=b.Squarespace.ContentItemEditor.ProductService;this.PANEL_EDITORS_BY_RECORDTYPE={};this.PANEL_EDITORS_BY_RECORDTYPE[b.Squarespace.RecordType.TEXT]=b.Squarespace.ContentItemEditor.TextPanel},getEditor:function(d,c){c=b.Lang.isObject(c)?c:{};var e,f=d.get("recordType");e=b.merge({variant:b.Squarespace.ContentItemEditorVariants.DIALOG},
c);if(e=e.variant===b.Squarespace.ContentItemEditorVariants.MINIMAL?this.MINIMAL_EDITORS_BY_RECORDTYPE[f]:e.variant===b.Squarespace.ContentItemEditorVariants.PANEL?this.PANEL_EDITORS_BY_RECORDTYPE[f]:f===b.Squarespace.RecordType.STORE_ITEM?this.PRODUCT_EDITORS_BY_PRODUCTTYPE[d.get("structuredContent").get("productType")]:this.EDITORS_BY_RECORDTYPE[f])return e;throw"No ContentItemEditor has been found for this item: "+f;}}))},"1.0",{requires:"squarespace-content-item-types-audio squarespace-content-item-types-event squarespace-content-item-types-gallery squarespace-content-item-types-image squarespace-content-item-types-kbarticle squarespace-content-item-types-link squarespace-content-item-types-product-digital squarespace-content-item-types-product-physical squarespace-content-item-types-product-service squarespace-content-item-types-quote squarespace-content-item-types-text squarespace-content-item-types-text-panel squarespace-content-item-types-video".split(" ")});
YUI.add("squarespace-mixins-editable-model",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.EditableModel=b.Base.create("EditableModel",b.Base,[],{_edit:function(){var d=b.merge({model:this.get("model")},this.get("editorConfig")),d=new (this.get("editorCtor"))(d);this._bindEditor(d);d.show()},_bindEditor:function(b){}},{CSS_PREFIX:"sqs-editable-model",ATTRS:{editorCtor:{value:b.Squarespace.ModelEditorDialog,writeOnce:"initOnly"},editorConfig:{value:{},writeOnce:"initOnly"}}})},
"1.0",{requires:["base","squarespace-model-editor"]});
YUI.add("squarespace-variant-row",function(b){b.namespace("Squarespace");var d=function(c){var d=b.Node.create('<div class="attribute"></div>');c.render(d);d.setAttribute("name",c.get("name"));d.addClass("attribute-"+c.get("name"));return d},c=b.Squarespace.Widgets.VariantRow=b.Base.create("variantRow",b.Squarespace.SSWidget,[b.WidgetChild],{renderUI:function(){c.superclass.renderUI.call(this);var e=this.get("data"),d=this.get("contentBox");this._userAttributeInputs=[];var g=b.Node.create('<div class="variant-row"><div class="attributes"></div><div class="remove-variant"></div></div>');
g.one(".attributes");d.append(g);this._skuInput=new b.Squarespace.Widgets.Variants.VariantCellInput({name:"sku",data:e.sku});this._addSystemAttribute(this._skuInput);this._pricingInput=new b.Squarespace.Widgets.Variants.PricingInput({dialog:this.get("dialog"),name:"pricing",data:{price:e.price,salePrice:e.salePrice,onSale:e.onSale}});this._addSystemAttribute(this._pricingInput);this._stockInput=new b.Squarespace.Widgets.Variants.StockInput({dialog:this.get("dialog"),name:"stock",data:{qtyInStock:e.qtyInStock,
unlimited:e.unlimited}});this._addSystemAttribute(this._stockInput);this.get("isPhysical")&&(this._weightInput=new b.Squarespace.Widgets.Variants.VariantCellNumericInput({numericFormatterConfig:{postfixUnit:Static.SQUARESPACE_CONTEXT.websiteSettings.storeSettings.measurementStandard===b.Squarespace.MeasurementStandard.IMPERIAL?"lbs":"kg"},data:e.weight,name:"weight"}),this._addSystemAttribute(this._weightInput),this._dimensionsInput=new b.Squarespace.Widgets.Variants.DimensionsInput({data:{len:e.len,
width:e.width,height:e.height},dialog:this.get("dialog"),measurementStandard:this.get("measurementStandard"),name:"dimensions"}),this._addSystemAttribute(this._dimensionsInput));this.get("optionsList").each(this._addAttribute,this);this._refreshData()},bindUI:function(){c.superclass.bindUI.call(this);var e=this.get("boundingBox");e.plug(b.Squarespace.Animations.Expandable);this.get("optionsList").after("UserOption:optionNameChange",function(b){this._getAttributeElByName(b.prevVal).setAttribute("name",
b.newVal);this._refreshData()},this);this.get("optionsList").after("add",function(b){this._addAttribute(b.model);this._refreshData()},this);this.get("optionsList").after("remove",function(b){b=b.model;this._getAttributeElByName(b.get("optionName")).remove();this._userAttributeInputs.remove(b);this._refreshData()},this);e.one(".remove-variant").on("click",function(){this.fire("remove-requested")},this);this._skuInput.after("edit-next-row-requested",function(){this.fire("next-row-execute-requested",
{command:function(){var b=this._skuInput.get("contentBox").one("input");b.focus();b.select()}})},this);this._pricingInput.after("edit-next-row-requested",function(){this.fire("next-row-execute-requested",{command:function(){this._pricingInput.showFlyout()}})},this);this._stockInput.after("edit-next-row-requested",function(){this.fire("next-row-execute-requested",{command:function(){this._stockInput.showFlyout()}})},this);this.get("isPhysical")&&(b.Lang.isValue(this._dimensionsInput)&&this._dimensionsInput.after("edit-next-row-requested",
function(){this.fire("next-row-execute-requested",{command:function(){this._dimensionsInput.showFlyout()}})},this),this._weightInput.after("edit-next-row-requested",function(){this.fire("next-row-execute-requested",{command:function(){var b=this._weightInput.get("contentBox").one("input");b.focus();b.select()}})},this));this.after("variantCellInput:edit-next-row-requested",function(b){this.fire("next-row-execute-requested",{command:function(){var c=this._getAttributeElByName(b.target.get("name")).one("input");
c.focus();c.select()}})},this);this.after("*:dataChange",function(b){b.target!=this&&this._refreshData()},this)},close:function(){var b=this.get("boundingBox");b.on("closed",function(){this.fire("removed")},this);b.hide()},getError:function(c){var d=this.get("data");return d.onSale&&0>=d.salePrice?{inputEl:this._pricingInput.get("contentBox"),message:"Sale price must be greater than 0 for "+d.sku}:!d.onSale&&0===d.price?{inputEl:this._pricingInput.get("contentBox"),message:"Price must be greater than 0 for "+
d.sku}:""===d.sku.trim()?{inputEl:this._skuInput.get("contentBox"),message:"SKU cannot be left blank."}:60<d.sku.length?{inputEl:this._skuInput.get("contentBox"),message:"SKU is too long."}:b.Lang.isValue(c[d.sku])?{inputEl:this._skuInput.get("contentBox"),message:d.sku+" is not a unique SKU."}:!d.unlimited&&0>d.qtyInStock?{inputEl:this._stockInput.get("contentBox"),message:d.sku+" cannot have negative stock."}:d.price<=d.salePrice?{inputEl:this._pricingInput.get("contentBox"),message:"Sale price must be less than standard price."}:
null},_refreshData:function(c){c=this._pricingInput.get("data");var d=this._stockInput.get("data"),g={sku:this._skuInput.get("data"),price:c.price,salePrice:c.salePrice,onSale:c.onSale,qtyInStock:d.qtyInStock,unlimited:d.unlimited,attributes:{}};this.get("isPhysical")&&(c=b.Lang.isValue(this._dimensionsInput)?this._dimensionsInput.get("data"):{len:1,width:1,height:1},g=b.merge(g,{weight:this._weightInput.get("data"),len:c.len,width:c.width,height:c.height}));this.get("optionsList").each(function(b){b=
b.get("optionName");var c=this._getAttributeElByName(b);g.attributes[b]=c.one("input").get("value")},this);this.set("data",g)},_getAttributeElByName:function(b){var c;this.get("contentBox").all(".attribute").each(function(d){d.getAttribute("name")===b&&(c=d)});return c},_addSystemAttribute:function(b){this.get("contentBox").one(".attributes").append(d(b));b.addTarget(this,{emitFacade:!0})},_addAttribute:function(c){var d=this.get("contentBox").one(".attributes"),g=c.get("optionName");c=new b.Squarespace.Widgets.Variants.VariantCellInput({name:c.get("optionName"),
userOption:c,data:this.get("data.attributes")[g]});var h=b.Node.create('<div class="attribute"></div>');c.render(h);h.setAttribute("name",c.get("name"));h.setAttribute("name",g);d.append(h);c.addTarget(this,{emitFacade:!0});this._userAttributeInputs.push(c)}},{CSS_PREFIX:"sqs-variant-row",ATTRS:{data:{value:null},optionsList:{value:null},dialog:{value:null},isPhysical:{value:!0},measurementStandard:{value:null}}})},"1.0",{requires:"base node widget-child squarespace-ss-widget squarespace-basic-check squarespace-animations squarespace-plugin-money-formatter squarespace-plugin-numeric-formatter squarespace-plugin-pulsewarn squarespace-variant-row-inputs".split(" ")});
YUI.add("squarespace-models-billing-customer",function(b){b.namespace("Squarespace.Models.Billing");b.Squarespace.Models.Billing.Customer=b.Base.create("billingCustomer",b.Model,[b.Squarespace.ModelSync.REST],{url:"/api/billing/customer",isNew:function(){return!1}},{ATTRS:{name:{validator:b.Squarespace.AttrValidators.isString},cardNumber:{validator:b.Squarespace.AttrValidators.isString},cvv:{validator:b.Squarespace.AttrValidators.isString},zip:{validator:b.Squarespace.AttrValidators.isString},expirationMonth:{validator:b.Squarespace.AttrValidators.isNumber},
expirationYear:{validator:b.Squarespace.AttrValidators.isNumber},billingContactId:{validator:b.Squarespace.AttrValidators.isString},country:{validator:function(d){return!b.Lang.isString(d)||""===d?!1:b.Lang.isValue(b.Squarespace.Localities.COUNTRY_OPTIONS[d])}}}})},"1.0",{requires:["base","model","squarespace-attr-validators","squarespace-model-sync-rest","squarespace-localities"]});
YUI.add("squarespace-model-editor",function(b){b.Squarespace.ModelEditorDialog=b.Base.create("ModelEditorDialog",b.Base,[],{initializer:function(){this.saving=!1;this.publish("nonSavingClose",{emitFacade:!0});var d=this.get("dialog");this.on("visibleChange",function(c){if("dialog"!==c.source&&c.newVal!=c.prevVal){var e=this.get("dialogConfig");d.detachAll(this.get("id")+"|*");b.detachAll(this.get("id")+"|*");if(!e)throw"You need a DialogConfig for ModelEditorDialog to work!";c.newVal?this._showDialog():
this._hideDialog()}},this);this.on("modelChange",function(b){b.prevVal&&b.prevVal.detachAll(this.get("id")+"|*")},this);d.on("send-requested",this._onSendRequested,this);d.on("close",function(){this.saving||this.fire("nonSavingClose")},this);d.on(["close","dismiss"],function(b){this.set("visible",!1,{source:"dialog"})},this)},destructor:function(){this.get("visible")&&this.set("visible",!1)},_onSendRequested:function(d){d=this.get("dialog");var c=this.validateFields();b.Lang.isValue(c)?d.showErrors(c):
(this.saving=!0,this.save())},_showDialog:function(){var d=this.get("dialog"),c=this.get("dialogConfig"),c=b.Squarespace.ObjectBuilder.make(b.clone(c,this),this.get("dialogConfigContext"),this.getTemplateContext()),e=this.get("parentDialog");b.Lang.isValue(e)&&(c.parentDialog=e);d.setParams(c);d.setInitialData(this.getDialogData());d.show({anchor:this.get("anchorNode")})},_hideDialog:function(){this.get("model").detachAll(this.get("id")+"|*");this.get("dialog").params.discardChangesConfirmation=!1;
this.get("dialog").close()},validateFields:function(){var b=this.get("dialog").getErrors();return 0===b.errors?null:b.errorSet},save:function(d,c,e){d=d||{};var f=this.get("dialog"),g=this.get("model"),h=g.getAttrs();g.setAttrs(this.sanitizeDialogData(f.getData()));g.save(d,b.bind(function(d,f){d&&f instanceof XMLHttpRequest&&(d=b.merge(d,JSON.parse(f.response)));this._saveResponseHandler(d,f,h,c,e)},this))},autoSave:function(b){b=b||{};var c=this.get("model");c.setAttrs(this.sanitizeDialogData(this.get("dialog").getData()));
c.autoSave(b)},_saveResponseHandler:function(d,c,e,f,g){c=this.get("dialog");var h=this.get("model");d?(d.errors?c.showErrors(d.errors):"4"===String(d.code).charAt(0)&&d.message?(new b.Squarespace.Widgets.Alert({"strings.title":"Error Saving","strings.message":d.message}),c.allowEditing()):(new b.Squarespace.SystemError("Something Went Wrong",d,"json")).show(),h.setAttrs(e)):(f&&f(),g||this.hide());this.saving=!1},getTemplateContext:function(){return this.get("model")},getDialogData:function(){return this.get("model").toJSON()},
sanitizeDialogData:function(b){return b},show:function(){this.set("visible",!0)},hide:function(){this.set("visible",!1)}},{ATTRS:{model:{},dialog:{readOnly:!0,valueFn:function(){return new b.Squarespace.EditingDialog}},dialogConfig:{},dialogConfigContext:{value:{}},anchorNode:{value:null},visible:{value:!1},parentDialog:{value:null}}});b.namespace("Squarespace.ModelEditorPlugins");b.Squarespace.ModelEditorPlugins.AutoSave=b.Base.create("ModelEditorPluginAutoSave",b.Plugin.Base,[],{initializer:function(){this.afterHostMethod("_showDialog",
function(){b.later(5E3,this,this.requestAutoSave)},this);var d=b.bind(function(){this._autoSaveRequest&&(this._autoSaveRequest.cancel(),this._autoSaveRequest=null)},this);this.beforeHostMethod("_hideDialog",d,this);this.beforeHostMethod("autoSave",function(){this.get("host").get("model").once("save",function(){d();this._autoSaving=!1},this)},this)},requestAutoSave:function(){!this._autoSaveRequest&&!this._autoSaving&&(this._autoSaveRequest=b.later(1E3,this,function(){this.get("host").get("dialog").isVisible()?
(this._autoSaving=!0,this.get("host").autoSave()):this._autoSaveRequest.cancel()}))}},{NS:"autoSavePlugin"});b.Squarespace.ModelEditorPlugins.LoadBeforeShowing=b.Base.create("ModelEditorPluginLoadBeforeShowing",b.Plugin.Base,[],{initializer:function(){var d=this.get("host"),c=d.get("dialog");this.afterHostMethod("_showDialog",function(){c.updateTitle(b.Squarespace.DialogStates.LOADING);c.showSaveOverlay();d.get("model").onceAfter(this.get("id")+"|load",function(){c.setInitialData(d.getDialogData());
c.setData(d.getDialogData());c.hideSaveOverlay();c.clearEdited()},this);d.get("model").load()},this)}},{NS:"loadBeforeShowing"})},"1.0",{requires:"plugin squarespace-dialog squarespace-settings-tabbed-panel squarespace-object-builder squarespace-ss-widget squarespace-ui-base squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-block-posts-by",function(b){var d=b.namespace("Squarespace.Block").PostsByBase=b.Base.create("block-posts-by",b.Squarespace.Block.ModelSyncBase,[],{initializer:function(){}},{MODEL:b.Squarespace.ContentModel.PostsByBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Dialog}},CSS_PREFIX:"sqs-block-posts-by"});b.namespace("Squarespace.Block").PostsByAuthor=b.Base.create("block-posts-by-author",d,[],{},{MODEL:b.Squarespace.ContentModel.PostsByAuthor,ATTRS:{type:{value:b.Squarespace.BlockType.POSTS_BY_AUTHOR},
editor:{value:b.Squarespace.Block.Editor.PostsByAuthor}},CSS_PREFIX:"sqs-block-postsbyauthor"});b.namespace("Squarespace.Block").PostsByTag=b.Base.create("block-posts-by-tag",d,[],{},{MODEL:b.Squarespace.ContentModel.PostsByTag,ATTRS:{type:{value:b.Squarespace.BlockType.POSTS_BY_TAG},editor:{value:b.Squarespace.Block.Editor.PostsByTag}},CSS_PREFIX:"sqs-block-postsbytag"});b.namespace("Squarespace.Block").PostsByCategory=b.Base.create("block-posts-by-category",d,[],{},{MODEL:b.Squarespace.ContentModel.PostsByCategory,
ATTRS:{type:{value:b.Squarespace.BlockType.POSTS_BY_CATEGORY},editor:{value:b.Squarespace.Block.Editor.PostsByCategory}},CSS_PREFIX:"sqs-block-postsbycategory"});b.namespace("Squarespace.Block").PostsByMonth=b.Base.create("block-posts-by-month",d,[],{},{MODEL:b.Squarespace.ContentModel.PostsByMonth,ATTRS:{type:{value:b.Squarespace.BlockType.POSTS_BY_MONTH},editor:{value:b.Squarespace.Block.Editor.PostsByMonth}},CSS_PREFIX:"sqs-block-postsbymonth"})},"1.0",{requires:["base","model","squarespace-block-posts-by-editor",
"squarespace-block-posts-by-model"]});YUI.add("squarespace-hb-date-format",function(b){b.Handlebars.registerHelper("date-format",function(d,c){return b.Squarespace.DateUtils.dateFormat(d,{format:c.hash.format||"%B %e, %Y"})})},"1.0",{requires:["handlebars-base","datatype-date","squarespace-date-utils"]});
YUI.add("squarespace-block-collection-link",function(b){var d=b.namespace("Squarespace.Block").CollectionLink=b.Base.create("block-collection-link",b.Squarespace.Block.ModelSyncBase,[],{_renderSuccess:function(b){d.superclass._renderSuccess.call(this,b);this._plugImageLoader()}},{CSS_PREFIX:"sqs-block-collectionlink",ATTRS:{editor:{value:b.Squarespace.Block.Editor.CollectionLink},type:{value:b.Squarespace.BlockType.COLLECTION_LINK},defaultContentModel:{value:{linkTitle:"",linkTarget:"",newWindow:!1}}}})},
"1.0",{requires:["squarespace-enum","squarespace-image-loader","squarespace-block-base-modelsync","squarespace-block-collection-link-editor"]});
YUI.add("squarespace-member-invite",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.MemberInvite=b.Base.create("MemberInvite",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",this._edit,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("contentBox").setHTML(b.Squarespace.UITemplates.render(this.getProperty("TEMPLATE_NAME"),this.get("invite").toJSON()))},_edit:function(){(new b.Squarespace.Editor.MemberInvite({model:this.get("invite")})).show()}},
{CSS_PREFIX:"sqs-member-invite",TEMPLATE_NAME:"member-invite.html",ATTRS:{invite:{valueFn:function(){return new b.Squarespace.Models.MemberInvite},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberInvite)}}})},"1.0",{requires:"base widget-child squarespace-ss-widget squarespace-member-invite-template squarespace-models-member-invite squarespace-editor-member-invite squarespace-attr-validators squarespace-ui-templates".split(" ")});
YUI.add("squarespace-dialog-content-item-list-builder",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.ContentItemListBuilder=b.Base.create("ContentItemListBuilder",b.Squarespace.Widgets.DialogField2,[],{initializer:function(){this.publish("contentCleared",{emitFacade:!0});this._autoCompleteField=new b.Squarespace.DialogFields.AutoComplete({name:"contentItemSearch","strings.placeholder":"Search",requireListEntry:!0,acConfig:this._createAcConfig()})},renderUI:function(){d.superclass.renderUI.call(this);
var b=this.get("contentBox"),e=this._autoCompleteField;if(this.get("allowClear")){var f=b.appendChild('<div class="input-container"></div>');e.render(f);this._clearContentButton=f.appendChild('<div class="clear-content-wrapper"><div class="clear-content">Clear</div></div>').one(".clear-content")}else e.render(b);this._listContainer=b.appendChild('<div class="list-container"></div>');this._setupDragAndDrop()},bindUI:function(){d.superclass.bindUI.call(this);var c=this._autoCompleteField,e=this.get("data");
c.after("select",function(d){d=d.data;b.Lang.isValue(d)&&(c.clear(),e.add(d))},this);this.get("contentBox").delegate("click",function(b){b.halt();e.remove(b.target.ancestor(".content-item-wrapper").getData("contentItem"))},".remove-content-item",this);e.after("add",function(b){b.onReorder||this._addContentItemNode(b.model)},this);e.after("remove",function(b){b.onReorder||this._removeContentItemNode(b.model)},this);e.after("reset",this._clearContentItemNodes,this);if(this.get("allowClear"))this._clearContentButton.on("click",
this._confirmAndClear,this);this._ddReorder.after("reordered",function(b){this._reorderContentItem(b.oldIndex,b.newIndex)},this)},syncUI:function(){d.superclass.syncUI.call(this);this._listContainer.empty();this.get("data").each(function(b){this._addContentItemNode(b,!0)},this)},focus:function(){this._autoCompleteField.focus()},clear:function(){this._autoCompleteField.clear()},_addContentItemNode:function(c,e){var d=b.Node.create(b.Lang.sub('<div class="content-item-wrapper transparent"><div class="content-item">{title}<div class="remove-content-item">&times;</div></div></div>',
{id:c.get("id"),title:c.get("title")}));d.setData("contentItem",c);this._listContainer.append(d);e?d.removeClass("transparent"):b.later(100,this,function(){d.removeClass("transparent")});this._ddDelegate.syncTargets()},_removeContentItemNode:function(b){var e;this.get("contentBox").all(".content-item-wrapper").some(function(d){if(d.getData("contentItem")===b)return e=d,!0});e&&(e.remove(!0),this._ddDelegate.syncTargets())},_reorderContentItem:function(b,e){var d=this.get("data");d.add(d.remove(b,
{onReorder:!0}),{index:e,onReorder:!0})},_clearContentItemNodes:function(){this._listContainer.empty()},_confirmAndClear:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Clear Content","strings.message":"Are you sure you wish to clear this topic's content? This will reset the topic to its initial state."})).on("confirm",function(){this.get("data").reset();this.fire("contentCleared")},this)},_createAcConfig:function(){var c;c="?q={query}"+b.Lang.sub("&fields={fields}&collectionType={collectionType}&recordType={recordType}",
{searchFields:this.get("searchFields").join(","),recordType:this.get("recordType")});return{source:this._createDataSource(),requestTemplate:c,resultTextLocator:"title",resultFormatter:function(c,d){return b.Array.map(d,function(b){return"<div>"+b.raw.title+"</div>"})}}},_createDataSource:function(){var c=new b.DataSource.IO({source:"/api/content-items/search"});c.plug(b.Plugin.DataSourceJSONSchema,{schema:{resultListLocator:"results"}});return c},_setupDragAndDrop:function(){var c=this._listContainer,
e=(this._ddDelegate=new b.DD.Delegate({container:c,nodes:".content-item-wrapper:not(.yui3-dd-super-proxy-clone)",target:!0})).dd;e.set("groups",[this.get("id")]);this._ddReorder=e.plug(b.Squarespace.DDReorder,{container:c,nodes:".content-item-wrapper:not(.yui3-dd-super-proxy-clone)"}).ddreorder;e.plug(b.Plugin.DDConstrained,{constrain:c,stickY:!0});e.plug(b.Plugin.DDNodeScroll,{node:c,horizontal:!1,scrollDelay:100})}},{CSS_PREFIX:"sqs-content-item-list-builder",ATTRS:{data:{valueFn:function(){return new b.ModelList({model:b.Squarespace.Models.ContentItem})},
validator:b.Squarespace.AttrValidators.isInstanceOf(b.ModelList)},collectionType:{value:b.Squarespace.CollectionTypes.GENERIC,validator:function(c){if(b.Object.hasValue(b.Squarespace.CollectionTypes,c))return!0;console.error("ContentItemListBuilder: Invalid collectionType.");return!1},writeOnce:"initOnly"},recordType:{validator:function(c){if(b.Lang.isValue(c)){if(b.Object.hasValue(b.Squarespace.Enums.RecordType,c))return!0;console.error("ContentItemListBuilder: Invalid recordType.");return!1}console.error("ContentItemListBuilder: Missing attribute recordType.");
return!1}},allowClear:{value:!0,validator:b.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},searchFields:{value:[],validator:b.Squarespace.AttrValidators.isArray}}})},"1.0",{requires:"base datasource model-list squarespace-dd-behaviors squarespace-ui-base squarespace-dialog-field-2 squarespace-dialog-auto-complete squarespace-attr-validators squarespace-content-item-types-enum-record-type squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-content-manager-widgets-music-album-track-list",function(b){b.namespace("Squarespace.MusicAlbum");var d=b.Squarespace.MusicAlbum.TrackList=b.Base.create("trackList",b.Squarespace.Blog.List,[],{_addItemWidget:function(b){var e=this.add({model:b,render:this.get("contentBox").one(".tracks")}).item(0);this._itemToWidgetMap[b.get("clientId")]=e},renderUI:function(){d.superclass.renderUI.call(this);this._renderUploader()},bindUI:function(){d.superclass.bindUI.call(this);this._registerEvent(this.get("items").after(["add",
"remove"],function(b){"reorder"!=b.source&&this.syncUI()},this));this._bindDragAndDrop()},syncUI:function(){d.superclass.syncUI.call(this);this._syncEmptyState()},_syncEmptyState:function(c){b.Lang.isBoolean(c)||(c=this.get("items").isEmpty());this.get("boundingBox")[c?"addClass":"removeClass"](this.getClassName("empty"));this.uploader.set("selectButtonLabel",'<div class="title">'+this.get("strings.uploadText")+"</div>"+(c?'<div class="desc">'+this.get("strings.emptyDescription")+"</div>":""))},_bindDragAndDrop:function(){var c=
"."+this.get("defaultChildType").CSS_PREFIX;this._ddDelegate=new b.DD.Delegate({container:this.get("contentBox"),nodes:c,groups:"album-list",target:!0});this._ddDelegate.dd.plug(b.Plugin.DDConstrained,{constrain2node:this.get("contentBox").one(".tracks")});this._ddReorder=this._ddDelegate.dd.plug(b.Squarespace.DDReorder,{container:this.get("contentBox"),nodes:c}).ddreorder;this._ddReorder.on("reordered",this._onSingleReorder,this);this._ddDelegate.dd.on("drag:mouseDown",function(){this._ddDelegate.syncTargets()},
this);this._ddDelegate.dd.on("drag:drag",function(b){var c=this._ddDelegate.get("container").all(this._ddDelegate.get("nodes")),d=b.target.get("dragNode");b=b.target.get("node");(d=d.one(".music-track-number"))&&d.setContent(c.indexOf(b)+1)},this);this._ddDelegate.dd.plug(b.Plugin.DDConstrained,{stickY:!0});this._ddDelegate.dd.plug(b.Plugin.DDWinScroll,{horizontal:!1,scrollDelay:100})},_onSingleReorder:function(c){this.get("model").items.reorderItems([b.Widget.getByNode(c.node).get("item")],c.newIndex)},
_renderUploader:function(){var c=new b.Squarespace.Uploader({dragAndDropArea:this.get("boundingBox"),multipleFiles:!0,autoUpload:!0,fileFilters:[{description:"Audio",extensions:"*.mp3;*.mp4;*.ogg;*.m4a"}],processFile:b.bind(this._uploadAudioProcessor,this),addPlaceholder:b.bind(this._addAudioPlaceholder,this),fileComplete:b.bind(this._audioUploadComplete,this),createJob:b.bind(this._createAudioProcessingJob,this),jobFailure:b.bind(this._audioProcessingUpdate,this),jobComplete:b.bind(this._audioProcessingUpdate,
this),selectButtonLabel:this.get("strings.uploadText"),preflight:this.get("uploadPreflight"),validateFileFn:b.bind(this._validateFileBeforeUpload,this)});c.after(this.get("id")+"|uploaderror",function(b){b.fileData||c.fileDataFromFile(b.file)});this.uploader=c;c.render(this.get("contentBox"))},_uploadAudioProcessor:function(c){var e=this.get("model"),d=this.uploader.fileDataFromFile(c.file);d&&!c.item&&(c.item=d.item);c.postData={contentType:"audio",process:"true",index:c.item?c.item.get("displayIndex"):
e.get("nextDisplayIndex"),collectionId:this.get("collection").get("id"),id:c.id};c.invalid&&(c=c.invalid[0],new b.Squarespace.Widgets.Alert({"strings.title":c.title,"strings.message":c.message}))},_validateFileBeforeUpload:function(c){this.get("collection").get("itemCount");if(this.get("collection").get("nextDisplayIndex")>=b.Squarespace.Constants.MAX_TRACKS_IN_ALBUM)return{title:"Max Size Reached",message:"This album has a maximum size of "+b.Squarespace.Constants.MAX_TRACKS_IN_ALBUM+" tracks."}},
_addAudioPlaceholder:function(c){var e=new b.Squarespace.Models.ContentItem({mediaIsUploading:!0,displayIndex:c.postData.index,recordType:b.Squarespace.RecordType.AUDIO});c.item=e;this.get("model").items.add(c.item,{source:"upload"});c=this.getWidgetForItem(e);if(b.Lang.isValue(c))return c.get("contentBox")},_audioUploadComplete:function(b,e){var d=b.item;d.set("mediaIsUploading",!1);d.setAttrs(e.media[0]);0===b.index&&this.get("model").load()},_createAudioProcessingJob:function(c,e){if(!e.job)return console.warn("No job created. Audio processing on the frontend should hang."),
null;c.item.setAttrs(e.media[0]);var d=new b.Squarespace.AudioProcessingJob(b.merge(e.job,{started:!0}));d.set("collection",this.get("model"));return d},_audioProcessingUpdate:function(c,e){(new b.Squarespace.Models.ContentItem({id:e.get("data.contentItemId"),recordType:b.Squarespace.RecordType.AUDIO})).load(function(e,d){b.Lang.isValue(e)||c.item.setAttrs(d)})},_uiAddChild:function(b,e){var d=b.get("boundingBox");e.contains(d)||e.appendChild(b.get("boundingBox"))}},{TEMPLATE:'<div class="tracks"></div>',
CSS_PREFIX:"sqs-music-album-track-list",ATTRS:{defaultChildType:{valueFn:function(){return b.Squarespace.Widgets.MusicAlbumTrack}},strings:{value:{uploadText:"Add Tracks",emptyDescription:"This collection is empty. Click here to add your first item."}}}})},"1.0",{requires:["squarespace-content-manager-widgets-blog-list","squarespace-widgets-music-album-track","squarespace-uploader","squarespace-job-manager","squarespace-widgets-alert"]});
YUI.add("squarespace-dialog-text-area-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-text-area.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var l,p=this.escapeExpression;if((h=d["if"].call(c,(l=c.strings,null==l||!1===l?l:l.title),{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,d;return e=""+('\n  <div class="title">'+p((d=(d=b.strings,null==d||!1===d?d:d.title),"function"===
typeof d?d.apply(b):d))+"</div>\n")},k),data:k}))||0===h)b+=h;b+='\n\n<textarea placeholder="'+p((l=(l=c.strings,null==l||!1===l?l:l.placeholder),"function"===typeof l?l.apply(c):l))+'">';(h=d.data)?h=h.call(c,{hash:{},data:k}):(h=c.data,h="function"===typeof h?h.apply(c):h);b+=p(h)+"</textarea>\n\n";if((h=d["if"].call(c,(l=c.strings,null==l||!1===l?l:l.description),{hash:{},inverse:this.noop,fn:this.program(3,function(b,c){var e,d;return e=""+('\n  <div class="description">'+p((d=(d=b.strings,null==
d||!1===d?d:d.description),"function"===typeof d?d.apply(b):d))+"</div>\n")},k),data:k}))||0===h)b+=h;return b+"\n"})})();b.Handlebars.registerPartial("dialog-text-area.html".replace("/","."),d.templates["dialog-text-area.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-fluent-confirmation",function(b){var d=b.namespace("Squarespace.Fluent"),c=function(c,e,d,f){c.on("confirm",b.bind.apply(this,[e,this].concat(f)));c.on("reject",b.bind(d,this,{cancel:!1}));c.on("cancel",b.bind(d,this,{cancel:!0}))},e=function(e,d,f){return new b.Promise(function(g,q){d=b.Lang.isObject(d)&&!b.Lang.isArray(d)?d:{};var r=new e(d);c(r,g,q,f)})},f=function(b){return function(c){return function(){var d=Array.prototype.slice.call(arguments,0);return e(b,c,d)}}},g=function(b){return function(c,
d){d=d?[d]:[];return e(b,c,d)}};d.Confirm=g(b.Squarespace.Widgets.Confirmation);d.Alert=g(b.Squarespace.Widgets.Alert);d.Inform=g(b.Squarespace.Widgets.Information);d.ShowLoading=g(b.Squarespace.Loading);d.DataConfirm=g(b.Squarespace.Widgets.DataConfirmation);d.Confirmation=f(b.Squarespace.Widgets.Confirmation);d.Alerting=f(b.Squarespace.Widgets.Alert);d.Information=f(b.Squarespace.Widgets.Information);d.Loading=f(b.Squarespace.Loading);d.DataConfirmation=f(b.Squarespace.Widgets.DataConfirmation);
d.TYPE=b.Squarespace.Widgets.Confirmation.TYPE;d.ANCHOR=b.Squarespace.Widgets.Confirmation.ANCHOR},"1.0",{requires:"promise squarespace-ui-base squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-data-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-content-manager-navigation",function(b){b.namespace("Squarespace.ContentManager").Navigation=b.Base.create("ContentNavigationWidget",b.Squarespace.SSWidget,[b.WidgetChild,b.WidgetParent],{_getHBTemplateContext:function(){var b=this.constructor.superclass._getHBTemplateContext.call(this);b.navigation=b.navigation.toJSON();return b},bindUI:function(){var b=this.get("id");this._registerEvent(this.get("navigation").get("itemList").on(b+"|add",function(b){"dd"!=b.source&&this._uiAddNavigationItem(b.model,
!0,b.index)},this));this._registerEvent(this.get("navigation").get("itemList").after([b+"|add",b+"|remove"],this.syncUI,this))},renderUI:function(){this.constructor.superclass.renderUI.call(this);this.get("navigation").get("itemList").each(function(b){this._uiAddNavigationItem(b)},this)},syncUI:function(){this.get("boundingBox")[this.get("navigation").get("itemList").isEmpty()?"addClass":"removeClass"](this.getClassName("empty"))},_uiAddChild:function(d,c){var e=d.get("index");if(b.Lang.isNumber(e)&&
(e=this.get("contentBox").one(".items").get("children").item(e))){e.insert(d.get("boundingBox"),"before");return}this.get("contentBox").one(".items").appendChild(d.get("boundingBox"))},_uiAddNavigationItem:function(d,c,e){d=this.add({childType:d.isFolder()?b.Squarespace.ContentManager.NavigationItemFolder:b.Squarespace.ContentManager.NavigationItem,item:d,render:this.get("contentBox").one(".items")},e);b.Lang.isBoolean(c)&&c&&(c=d.item(0).get("contentBox"),c.setStyles({position:"relative",top:-1*
c.get("offsetHeight"),left:0}),c.anim({top:0}).run())}},{CSS_PREFIX:"sqs-navigation-item-list",HANDLEBARS_TEMPLATE:"navigation-item-list.html",ATTRS:{navigation:{},strings:{value:{addPage:"Add Page"}}}})},"1.0",{requires:["squarespace-navigation-item-list-template"]});
YUI.add("squarespace-settings-site-overlay",function(b){var d=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Squarespace Badge",text:'Display options related to displaying a "Powered by Squarespace" badge on your site.'}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"ssBadgeType",className:"thin",numeric:!0,focusable:!1,options:[{value:b.Squarespace.SSBadgeType.NONE,label:"Disable Squarespace Badge"},{value:b.Squarespace.SSBadgeType.WHITE,label:"Enable Squarespace Badge (White)"},
{value:b.Squarespace.SSBadgeType.BLACK,label:"Enable Squarespace Badge (Black)"}]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"ssBadgePosition",className:"thin",numeric:!0,focusable:!1,options:[{value:b.Squarespace.SSBadgePosition.TOP_LEFT,label:"Top Left"},{value:b.Squarespace.SSBadgePosition.TOP_CENTER,label:"Top Center"},{value:b.Squarespace.SSBadgePosition.TOP_RIGHT,label:"Top Right"},{value:b.Squarespace.SSBadgePosition.BOTTOM_LEFT,label:"Bottom Left"},{value:b.Squarespace.SSBadgePosition.BOTTOM_CENTER,
label:"Bottom Center"},{value:b.Squarespace.SSBadgePosition.BOTTOM_RIGHT,label:"Bottom Right"}]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"ssBadgeVisibility",className:"thin",numeric:!0,focusable:!1,options:[{value:b.Squarespace.SSBadgeVisibility.ALWAYS,label:"Show always"},{value:b.Squarespace.SSBadgeVisibility.SCROLL,label:"Show when scrolled to bottom"}]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"ssBadgeDevices",className:"thin",numeric:!0,focusable:!1,options:[{value:b.Squarespace.SSBadgeDevices.ALL,
label:"Display on desktop and mobile devices"},{value:b.Squarespace.SSBadgeDevices.DESKTOP_ONLY,label:"Display on desktop only"}]}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Announcement Bar",text:"Display a featured message in a large bar across the top of your website. This is useful if you have new or important news to report. When enabled, the Announcement Bar will be visible on both your mobile and desktop site.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"announcementBarStyle",
className:"thin",defaultValue:b.Squarespace.MobileInfoBarStyle.NONE,options:[{value:b.Squarespace.AnnouncementBarStyle.NONE,label:"Disable Announcement Bar"},{value:b.Squarespace.AnnouncementBarStyle.CUSTOM,label:"Enable Announcement Bar"}]}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"announcementBarText",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.LAYOUT_SMALL,isEditorSingleLine:!0,saveOnEnter:!0,hidden:!0,className:"sqs-dialog-wysiwyg-toolbar-left"}},{ctor:b.Squarespace.DialogFields.Description,
config:{name:"announcementBarUrlDesc",text:"<strong>Clickthrough URL</strong>. Add a link to make the whole Announcement Bar clickable."}},{ctor:b.Squarespace.DialogFields.CreateLink,config:{name:"announcementBarClickthroughUrl",className:"light",submitOnEnter:!0,renderTabs:{content:!0,external:!0,files:!1}}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"announcementBarResetDesc",text:"<strong>Announcement Bar Visiblity</strong>. Browsers keeps track of when the Announcement bars are hidden so that your visitors do not see them displayed repeatedly. Your announcement bar is currently hidden by your browser because you dismissed it. Click here to reset its visibility."}},
{ctor:b.Squarespace.DialogFields.Button,config:{name:"announcementBarResetButton","strings.text":"Reset Visibility"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Mobile Info Bar",text:"Show a simple notification tray to visitors on mobile devices. The Mobile Info Bar will appear at the bottom of your mobile site giving visitors quick access to directions, hours, an email address, and phone numbers. <strong>The information displayed in the Mobile Info Bar must be added/edited via Settings > Basic Information.</strong>",
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"mobileInfoBarStyle",className:"thin",defaultValue:b.Squarespace.MobileInfoBarStyle.NONE,options:[{value:b.Squarespace.MobileInfoBarStyle.NONE,label:"Disable Mobile Info Bar"},{value:b.Squarespace.MobileInfoBarStyle.LIGHT,label:"Enable Mobile Info Bar (Light)"},{value:b.Squarespace.MobileInfoBarStyle.DARK,label:"Enable Mobile Info Bar (Dark)"}]}},{ctor:b.Squarespace.DialogFields.CheckLink,config:{className:"dark",name:"mobileInfoBarContactEmailEnabled",
url:"#module=settings&settings-subpanelName=site-settings",onClick:function(){b.Squarespace.Utils.isDamaskEnabled()&&CONFIG_PANEL.visitPath("/settings/site")},"strings.urlLabel":"Edit","strings.title":"Show Email",toggle:!1}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"mobileInfoBarContactEmailDescription"}},{ctor:b.Squarespace.DialogFields.CheckLink,config:{className:"dark",name:"mobileInfoBarContactPhoneNumberEnabled",url:"#module=settings&settings-subpanelName=site-settings",onClick:function(){b.Squarespace.Utils.isDamaskEnabled()&&
CONFIG_PANEL.visitPath("/settings/site")},"strings.urlLabel":"Edit","strings.title":"Show Phone Number",toggle:!1}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"mobileInfoBarContactPhoneNumberDescription"}},{ctor:b.Squarespace.DialogFields.CheckLink,config:{className:"dark",url:"#module=settings&settings-subpanelName=site-settings",onClick:function(){b.Squarespace.Utils.isDamaskEnabled()&&CONFIG_PANEL.visitPath("/settings/site")},"strings.urlLabel":"Edit",name:"mobileInfoBarLocationEnabled",
"strings.title":"Show Location",toggle:!1}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"mobileInfoBarLocationDescription"}},{ctor:b.Squarespace.DialogFields.CheckLink,config:{className:"dark",url:"#module=settings&settings-subpanelName=site-settings",onClick:function(){b.Squarespace.Utils.isDamaskEnabled()&&b.Squarespace.Utils.isDamaskEnabled()&&CONFIG_PANEL.visitPath("/settings/site")},"strings.urlLabel":"Edit",name:"mobileInfoBarBusinessHoursEnabled","strings.title":"Show Business Hours",
toggle:!1}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"mobileInfoBarBusinessHoursDescription"}}],c=b.namespace("Squarespace.Settings.Site").Overlay=b.Base.create("OverlaySettings",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){b.Squarespace.Utils.isDamaskEnabled()&&(this.on("fields-rendered",function(c){b.Array.each(c.fields,function(b){this._registerEvent(b.after("dataChange",function(b){b.silent||this._syncDamaskPreviewFrame()},this))},this);this._syncDamaskPreviewFrame()}),
this._registerEvent(this.get("damask").get("previewFrame").on("load",this._syncDamaskPreviewFrame,this)),this.on("destroy",function(b){this.get("damask").get("previewFrame").getWebsiteOverlaysManager().hideMobileInfoBar()}))},_syncDamaskPreviewFrame:function(){var b=this.get("damask").get("previewFrame").getWebsiteOverlaysManager();if(b){var c=this.get("id");b.detach(c+"|AnnouncementBar:closed");this._registerEvent(b.after(c+"|AnnouncementBar:closed",this._syncResetAnnouncementBarField,this));b.setAttrs({ssBadgeSettings:this._getSSBadgeSettings(),
announcementBarSettings:this._getAnnouncementBarSettings(),mobileInfoBarSettings:this._getMobileInfoBarSettings()});b.showAnnouncementsBar();b.showMobileInfoBar()}},_getAnnouncementBarSettings:function(){return{style:parseInt(this.getField("announcementBarStyle").get("data"),10),text:this.getField("announcementBarText").get("data"),url:this.getField("announcementBarClickthroughUrl").get("data")}},_getMobileInfoBarSettings:function(){return{style:this.getField("mobileInfoBarStyle").get("data"),isContactEmailEnabled:this.getField("mobileInfoBarContactEmailEnabled").get("data"),
isContactPhoneNumberEnabled:this.getField("mobileInfoBarContactPhoneNumberEnabled").get("data"),isLocationEnabled:this.getField("mobileInfoBarLocationEnabled").get("data"),isBusinessHoursEnabled:this.getField("mobileInfoBarBusinessHoursEnabled").get("data")}},_getSSBadgeSettings:function(){return{visibility:this.getField("ssBadgeVisibility").get("data"),position:this.getField("ssBadgePosition").get("data"),devices:this.getField("ssBadgeDevices").get("data"),type:this.getField("ssBadgeType").get("data")}},
_getSanitizedPanelData:function(){var b=c.superclass._getSanitizedPanelData.call(this);this._trackEvents(b);this._sanitizeData(b);return b},_syncRenderedFields:function(){this._setIndividualFields();c.superclass._syncRenderedFields.call(this);this._changeDescriptions();this._bindSSBadgeFields();this._bindAnnouncementBarFields();this._bindMobileInfoBarFields()},_changeDescriptions:function(){this._updateEmailDescription();this._updatePhoneDescription();this._updateLocationDescription();this._updateHoursDescription()},
_updateEmailDescription:function(){var b=this.getField("mobileInfoBarContactEmailDescription"),c=Static.SQUARESPACE_CONTEXT.websiteSettings.contactEmail;b.set("text",c?c:"Click Edit to add an Email Address.")},_updatePhoneDescription:function(){var b=this.getField("mobileInfoBarContactPhoneNumberDescription"),c=Static.SQUARESPACE_CONTEXT.websiteSettings.contactPhoneNumber;b.set("text",c?c:"Click Edit to add a Phone Number.")},_updateLocationDescription:function(){var b=this.getField("mobileInfoBarLocationDescription"),
c=Static.SQUARESPACE_CONTEXT.website.location,d;c&&(d=this._formatLocation(c));d||(d="Click Edit to add a Location.");b.set("text",d)},_updateHoursDescription:function(){var c=this.getField("mobileInfoBarBusinessHoursDescription"),d=Static.SQUARESPACE_CONTEXT.websiteSettings.businessHours,g;b.Object.isEmpty(d)||(g=b.Squarespace.BusinessHoursUtils.plainTextDays(d));g||(g="Click Edit to add Business Hours.");c.set("text",g)},_formatLocation:function(c){var d="";b.Array.each(["addressTitle","addressLine1",
"addressLine2","addressCountry"],function(b,h){c[b]&&(d+=c[b]+"<br>")});return d},_bindSSBadgeFields:function(){var c=this.getField("ssBadgeType"),d=this.getField("ssBadgePosition"),g=this.getField("ssBadgeVisibility"),h=this.getField("ssBadgeDevices");c.get("data")===b.Squarespace.SSBadgeType.NONE&&(d.hide(),g.hide(),h.hide());c.after("dataChange",function(c){c.newVal==b.Squarespace.SSBadgeType.NONE?(d.hide(),g.hide(),h.hide()):(d.show(),g.show(),h.show())})},_bindFieldsToMaster:function(c,d,g,h){c=
this.getField(c);var k=function(c){var e=c&&c!=d;b.Array.each(g,function(b){e?b.temporaryShow():b.temporaryHide()});b.Lang.isFunction(h)&&h()};g=b.Array.map(g,function(b){return this.getField(b)},this);k(c.get("data"));c.on("dataChange",function(b){k(b.newVal)})},_trackEvents:function(c){var d=this._trackedData||this.get("data"),g=c.announcementBarStyle;b.Lang.isNull(d.announcementBarSettings)||""!==g&&g!=d.announcementBarStyle&&this._postEvent("announcement_bar_toggle",{enabled:g!=b.Squarespace.AnnouncementBarStyle.NONE});
c=c.mobileInfoBarStyle;if(!b.Lang.isNull(d.mobileInfoBarSettings)&&""!==c&&c!=d.mobileInfoBarStyle){var d={enabled:c!=b.Squarespace.MobileInfoBarStyle.NONE},h=b.Object.keys(b.Squarespace.MobileInfoBarStyle),k=parseInt(c,10);1<k&&(d.style=h[k-1]);this._postEvent("mobile_info_bar_toggle",d)}this._trackedData={announcementBarStyle:g,mobileInfoBarStyle:c}},_postEvent:function(c,d){b.Squarespace.Analytics.trackInternal(c,d)},_syncResetAnnouncementBarField:function(){(this._isAnnouncementBarClosed=b.Squarespace.Widgets.AnnouncementBar.isClosed())?
this._showAnnouncementBarResetButton():this._hideAnnouncementBarResetButton()},_bindAnnouncementBarFields:function(){var c=b.Squarespace.AnnouncementBarStyle.NONE;this.get("contentBox").one(".name-announcementBarResetButton").on("click",this._resetAnnouncementBarVisiblity,this);this._syncResetAnnouncementBarField();this._bindFieldsToMaster("announcementBarStyle",c,["announcementBarText","announcementBarUrlDesc","announcementBarClickthroughUrl","announcementBarResetDesc","announcementBarResetButton"],
this._onAnnouncementBarStyleChange.bind(this))},_onAnnouncementBarStyleChange:function(){this._isAnnouncementBarClosed||this._hideAnnouncementBarResetButton()},_hideAnnouncementBarResetButton:function(){var b=this.getField("announcementBarResetDesc"),c=this.getField("announcementBarResetButton");b.hide();c.hide()},_showAnnouncementBarResetButton:function(){var b=this.getField("announcementBarResetDesc"),c=this.getField("announcementBarResetButton");b.show();c.show()},_resetAnnouncementBarVisiblity:function(){b.Squarespace.Widgets.AnnouncementBar.resetVisibility();
b.Squarespace.Utils.isDamaskEnabled()||new b.Squarespace.Widgets.Information({"strings.title":"Announcement Bar Visibility","strings.message":"Your Announcement Bar's visibility has been reset."});this._isAnnouncementBarClosed=!1;this._hideAnnouncementBarResetButton();this._postEvent("announcement_bar_reset");b.Squarespace.Utils.isDamaskEnabled()&&this._syncDamaskPreviewFrame()},_bindMobileInfoBarFields:function(){this._bindFieldsToMaster("mobileInfoBarStyle",b.Squarespace.MobileInfoBarStyle.NONE,
"mobileInfoBarContactEmailEnabled mobileInfoBarContactPhoneNumberEnabled mobileInfoBarLocationEnabled mobileInfoBarBusinessHoursEnabled mobileInfoBarContactEmailDescription mobileInfoBarContactPhoneNumberDescription mobileInfoBarLocationDescription mobileInfoBarBusinessHoursDescription".split(" "))},_sanitizeData:function(b){b.mobileInfoBarSettings={style:b.mobileInfoBarStyle,isContactEmailEnabled:b.mobileInfoBarContactEmailEnabled,isContactPhoneNumberEnabled:b.mobileInfoBarContactPhoneNumberEnabled,
isLocationEnabled:b.mobileInfoBarLocationEnabled,isBusinessHoursEnabled:b.mobileInfoBarBusinessHoursEnabled};delete b.mobileInfoBarStyle;delete b.mobileInfoBarContactEmailEnabled;delete b.mobileInfoBarContactPhoneNumberEnabled;delete b.mobileInfoBarLocationEnabled;delete b.mobileInfoBarBusinessHoursEnabled;b.announcementBarSettings={style:b.announcementBarStyle,text:b.announcementBarText,url:b.announcementBarClickthroughUrl};delete b.announcementBarStyle;delete b.announcementBarText;delete b.announcementBarClickthroughUrl},
_setIndividualFields:function(){var c=this.get("data");if(c){var d=c.mobileInfoBarSettings,g=c.announcementBarSettings;b.Lang.isNull(d)?(c.mobileInfoBarContactEmailEnabled=!0,c.mobileInfoBarContactPhoneNumberEnabled=!0,c.mobileInfoBarLocationEnabled=!0,c.mobileInfoBarBusinessHoursEnabled=!0):(c.mobileInfoBarStyle=c.mobileInfoBarSettings.style,c.mobileInfoBarContactEmailEnabled=d.isContactEmailEnabled,c.mobileInfoBarContactPhoneNumberEnabled=d.isContactPhoneNumberEnabled,c.mobileInfoBarLocationEnabled=
d.isLocationEnabled,c.mobileInfoBarBusinessHoursEnabled=d.isBusinessHoursEnabled,delete c.mobileInfoBarSettings);b.Lang.isNull(g)||(c.announcementBarStyle=g.style,c.announcementBarText=g.text,c.announcementBarClickthroughUrl=g.clickthroughUrl,delete c.announcementBarSettings)}}},{CSS_PREFIX:"sqs-overlay-settings",ATTRS:{initialDataUrl:{value:"/api/config/GetOverlaySettings"},initialDataPropertyName:{value:"settings"},saveUrl:{value:"/api/config/SaveOverlaySettings"},"strings.title":{value:"Overlays"},
"strings.description":{value:"Overlay settings give you the ability to create and manage overlay messages for your website through the Announcement Bar and the Mobile Info Bar. You can also use Overlay Settings to show or hide the Powered by Squarespace badge on your site."},fields:{value:d}}})},"1.0",{requires:"base squarespace-settings-panel squarespace-enum squarespace-dialog-check-link squarespace-dialog-description squarespace-dialog-wysiwyg squarespace-dialog-select squarespace-date-utils squarespace-business-hours-utils squarespace-announcement-bar squarespace-widgets-information".split(" ")});
YUI.add("squarespace-wysiwyg",function(b){b.namespace("Squarespace");var d="field-wysiwyg";b.Squarespace.DialogFieldGenerators.wysiwyg=Class.extend(b.Squarespace.DialogField,{initialize:function(c,e,d){this.defaultEditor=b.Squarespace.Utils.isCKEditorEnabled()?"CKEDITOR":"WYSIWYG";this._super(c,e,d);this.events=[];this.containerHeight=this.config.height||null;this.containerWidth=this.config.width||null;this.tabIndex=d.getNextTabIndex();this._preventThrottling=c.preventThrottling;if(d=this.config.className)this.className=
d;this.viewMode="box-view";this.config.pageview&&(this.viewMode="page-view");this.menuConfig=c.menuConfig||"full";this.menuConfigs={full:{wysiwyg:[{cmd:"bold",title:"Bold",type:"button"},{cmd:"italic",title:"Italic",type:"button"},{type:"separator"},{cmd:"h1",title:"H1",type:"button"},{cmd:"h2",title:"H2",type:"button"},{cmd:"h3",title:"H3",type:"button"},{type:"separator"},{cmd:"link",title:"Link",type:"button"},{cmd:"blockquote",title:"Block Quote",type:"button"},{cmd:"removeformat",title:"Remove Formatting",
type:"button"},{type:"separator"},{cmd:"unorderedlist",title:"Unordered List",type:"button"},{cmd:"orderedlist",title:"Ordered List",type:"button"},{cmd:"outdent",title:"Outdent",type:"button"},{cmd:"indent",title:"Indent",type:"button"},{type:"container",style:"float: right;",contents:[{cmd:"undo",title:"Undo",type:"button"},{cmd:"redo",title:"Redo",type:"button"},{type:"button",cmd:"fullscreen",title:"fullscreen"}]}],other:[{cmd:"bold",title:"Bold",type:"button"},{cmd:"italic",title:"Italic",type:"button"},
{cmd:"link",title:"Link",type:"button"},{type:"separator"},{cmd:"h1",title:"H1",type:"button"},{cmd:"h2",title:"H2",type:"button"},{cmd:"h3",title:"H3",type:"button"},{cmd:"blockquote",title:"Block Quote",type:"button"},{type:"separator"},{cmd:"unorderedlist",title:"Unordered List",type:"button"},{cmd:"orderedlist",title:"Ordered List",type:"button"},{type:"container",style:"float: right;",contents:[{cmd:"undo",title:"Undo",type:"button"},{cmd:"redo",title:"Redo",type:"button"},{type:"button",cmd:"fullscreen",
title:"fullscreen"}]}],layout:[{cmd:"insertblock",title:"Insert Block",type:"button"},{cmd:"fullscreen",title:"fullscreen",type:"button"}]},code:{wysiwyg:[],code:[{cmd:"sourcecode",title:"Show Source",type:"button",html:"Display Source"},{type:"container",style:"float: right",contents:[{type:"select",title:"Editor Mode",selected:"htmlmixed",options:{css:"CSS",htmlmixed:"HTML",javascript:"Javascript",markdown:"Markdown","null":"Plain Text"}}]}]},markdown:{wysiwyg:[],markdown:[{cmd:"bold",title:"Bold",
type:"button"},{cmd:"italic",title:"Italic",type:"button"},{cmd:"link",title:"Link",type:"button"},{type:"separator"},{cmd:"h1",title:"H1",type:"button"},{cmd:"h2",title:"H2",type:"button"},{type:"separator"},{cmd:"blockquote",title:"Block Quote",type:"button"},{cmd:"unorderedlist",title:"Unordered List",type:"button"},{cmd:"orderedlist",title:"Ordered List",type:"button"}]},small:{wysiwyg:[{cmd:"bold",title:"Bold",type:"button"},{cmd:"italic",title:"Italic",type:"button"},{cmd:"link",title:"Link",
type:"button"}],other:[{cmd:"bold",title:"Bold",type:"button"},{cmd:"italic",title:"Italic",type:"button"},{cmd:"link",title:"Link",type:"button"}],layout:[{cmd:"insertblock",title:"Insert Block",type:"button"},{type:"container",style:"float: right;",contents:[{type:"button",cmd:"fullscreen",title:"fullscreen"}]}]},"ultra-small":{wysiwyg:[{cmd:"bold",title:"Bold",type:"button"},{cmd:"italic",title:"Italic",type:"button"},{cmd:"link",title:"Link",type:"button"}],other:[{cmd:"bold",title:"Bold",type:"button"},
{cmd:"italic",title:"Italic",type:"button"},{cmd:"link",title:"Link",type:"button"}]}};if("layout"==this.config.engine)this.modes={layout:this._loadLayout},this.mode="layout";else if("code"==this.config.engine||"markdown"==this.config.engine)this.modes={source:this._loadTextEditor},this.mode="source";else{this.modes={wysiwyg:this._loadVisualEditor,markdown:this._loadTextEditor,html:this._loadTextEditor,source:this._loadTextEditor};if("html"===this.mode||"markdown"===this.mode)this.mode="source";this.mode=
this.mode}this.modeRenderers={wysiwyg:this._visualRender,markdown:this._textEditorRender,html:this._textEditorRender,source:this._textEditorRender,layout:this._layoutRender};this.modeLinkHandlers={wysiwyg:this._visualOnLinkButtonClick,markdown:this._textEditorOnLinkButtonClick,html:this._textEditorOnLinkButtonClick,source:this._textEditorOnLinkButtonClick,layout:this._layoutOnLinkButtonClick};this.modeShowHandlers={wysiwyg:this._visualShow,markdown:this._textEditorShow,html:this._textEditorShow,source:this._textEditorShow,
layout:this._layoutEditorShow};this.modeEls={};this.config.titleStyle||(this.config.titleStyle="top");this.initialFieldData=e[this.config.name];c=this._determineModeContent(this.initialFieldData);this.mode=c.mode;this.codeMode=c.codeMode;this.isSource=c.isSource;c=c.content||this.config.defaultValue;this.modes[this.mode]||("layout"===this.mode?this.mode="wysiwyg":(console.warn("Requested "+this.mode+", which wasn't available. Converting to layout."),this.mode="layout"),c=c||this.config.defaultValue);
"wysiwyg"==this.mode&&"CKEDITOR"==this.defaultEditor&&this.containerHeight&&(this.containerHeight+=55);this.render();this.loadEditor(c);this.hookEvents();this.preCloseEvent=this.dialog.on("preClose",function(){this.dialog.fire("datachange",this)},this);this.publish("maximize-started",{broadcast:2});this.publish("maximize-complete",{broadcast:2});this.publish("minimize-started",{broadcast:2});this.publish("minimize-complete",{broadcast:2})},focus:function(){this.ckEditor?this.ckEditor.focus():this.editor.focus()},
didDataChange:function(){return this.ckEditor?this.ckEditor.changed:(b.Lang.isObject(this.initialFieldData)?this.initialFieldData.html:"")!==this.getValue().html},getTakenHeight:function(){return"wysiwyg"===this.mode?-1:this.html.get("offsetHeight")-60},switchMode:function(c){function e(){var b=this.isFullscreen();this.ckEditor?this.ckEditor.destroy():this.editor.destroy();this.destroyEvents();this.mode=c;this.render();this.html.one("."+d);var e=f.getStyle("width");e&&this.html.setStyle("width",e);
f.replace(this.html);this.select.setValue(c);this.loadEditor(h);this.hookEvents();this.show();b&&(this.addFullscreenButtons(),this.html.addClass("fullscreenEditor"));this.adjustHeight();this.dialog.fire("datachange",this)}var f=this.html,g=this._determineModeContent(this.getValue()),h=g.content,k=!1,h=this.generateHTML(h);if(!this._isContentEmpty(h)){if("layout"===g.mode||"layout"===c)k=!0;"markdown"===c&&(k=!0)}if("layout"===g.mode||"layout"===c)h=null;k&&null===h?(this.select.setValue(this.mode),
(new b.Squarespace.Widgets.Confirmation({"strings.title":"Change Mode / Data Loss","strings.message":"When switching to this mode you will lose all your previous data."})).on("confirm",function(){e.call(this);this.select.setValue(c)},this)):k?(this.select.setValue(this.mode),(new b.Squarespace.Widgets.Confirmation({"strings.title":"Change Mode","strings.message":"You might lose special formatting switching to this mode."})).on("confirm",function(){e.call(this);this.select.setValue(c)},this)):e.call(this)},
_isContentEmpty:function(b){if(null===b||"string"===typeof b&&0>=b.trim().length)return!0;if("object"===typeof b){for(var e in b.containers)if(b.containers.hasOwnProperty(e))return!1;return!0}return!1},loadEditor:function(b){this.modes[this.mode].apply(this,[b])},_determineModeContent:function(b){b||(b={});if(b.layout)return{content:b.layout,mode:"layout"};b.wysiwyg&&b.wysiwyg.markdown&&(b.wysiwyg.source=b.wysiwyg.markdown,b.wysiwyg.markdown="",b.wysiwyg.mode="markdown");return b.wysiwyg?{content:b.wysiwyg.source||
b.html,codeMode:b.wysiwyg.mode,isSource:b.wysiwyg.isSource,mode:"source"}:{content:b.html,mode:"wysiwyg"}},_loadVisualEditor:function(c){if("CKEDITOR"==this.defaultEditor){var e=this.control.getDOMNode().ownerDocument,e=e.defaultView||e.parentWindow,d={};e.CKEDITOR.editorConfig(d);d.uiColor="Light";this.html.one(".field-wysiwyg-control-wrapper").hide();this.setHeight(this.containerHeight);switch(this.menuConfig){case "small":case "ultra-small":d.toolbar=[{name:"left",items:"Undo Redo - Bold Italic sqslink - PasteText RemoveFormat".split(" ")},
{name:"right",items:["Maximize"]}];break;default:d.toolbar=[{name:"left",items:"Undo Redo - Bold Italic sqslink - Format Blockquote NumberedList BulletedList Outdent Indent - PasteText RemoveFormat".split(" ")},{name:"right",items:["Maximize"]}]}this.ckEditor=e.CKEDITOR.replace(this.control.getDOMNode(),d);this.ckEditor.on("contentDom",function(){this.ckEditor.resize(null,this.containerHeight-30,!0)},this);this.ckEditor.setData(c||"");this.events.push(this.ckEditor.on("change",function(){this.ckEditor.changed=
!0;this.onEditorContentChange()},this));this.ckEditor.on("focus",this._onfocus,this);this.ckEditor.on("blur",this._onblur,this)}else this.editor=new b.Squarespace.VisualEditor({el:this.control,mode:this.mode,tabIndex:this.tabIndex}),this.editor.on("input",this.onEditorContentChange,this),this.editor.el.editor.on("containersChange",this._containersHandler,this),this.events.push(this.dialog.on("send-requested",function(){this.editor.changed&&(this.editor.save(),this.edited=!1)},this)),this.events.push(this.editor.on("change",
this.onEditorContentChange,this)),this.editor.setContent(c),this._initializeLinkFlyout(),this.control.on("wysiwyg|focus",this._onfocus,this),this.control.on("wysiwyg|blur",this._onblur,this)},_initializeLinkFlyout:function(){this._linkEdit=new b.Squarespace.Flyout.LinkEdit;this.editor._linkEdit=this._linkEdit;this._linkEdit.on("dataChange",function(b){b=b.newVal;var e=b.anchorNode;e&&(e.setAttribute("href",b.linkUrl),b.newWindow?e.setAttribute("target","_blank"):e.removeAttribute("target"));this.editor._onContentChange()},
this);this._linkEdit.on("open",function(){this.editor.saveSelection()},this);this._linkEdit.on("close",function(b){this.editor.restoreSelection()},this);this._linkEdit.on("unlink",function(c){b.Squarespace.EditorBase.unwrap(c.anchorNode)})},_loadTextEditor:function(c){this.editor="markdown"===this.config.engine?new b.Squarespace.MarkdownEditor({el:this.control,mode:this.codeMode,isSource:this.isSource,tabIndex:this.tabIndex}):new b.Squarespace.TextEditor({el:this.control,mode:this.codeMode,isSource:this.isSource,
tabIndex:this.tabIndex});this.editor.on("modeChange",function(b){this.codeMode=b.newVal;var c=this.menuEl.one("select");c&&(c.set("value",b.newVal),c=this.menuEl.one(".field-wysiwyg-tool-sourcecode"),"htmlmixed"===b.newVal||"markdown"===b.newVal?c.removeAttribute("disabled"):(this.isSource=!0,c.addClass("active"),c.setAttribute("disabled","disabled")),this.dialog.fire("datachange",this))},this);this.editor.setContent(c);this.editor.editor.on("change",b.bind(this.onEditorContentChange,this));this.control.on("wysiwyg|focus",
this._onfocus,this);this.control.on("wysiwyg|blur",this._onblur,this);this.events.push(this.menuEl.delegate("click",function(b){b.currentTarget._node.disabled||(this.isSource=!this.isSource,b.currentTarget.toggleClass("active",this.isSource),this.dialog.fire("datachange",this))},".field-wysiwyg-tool-sourcecode",this));this.events.push(this.menuEl.delegate("change",function(b){this.editor.set("mode",b.currentTarget.get("value"))},"select",this));(c=this.menuEl.one("select"))&&c.set("value",this.codeMode);
if(c=this.menuEl.one(".field-wysiwyg-tool-sourcecode"))"htmlmixed"===this.codeMode||"markdown"===this.codeMode?c.removeAttribute("disabled"):(this.isSource=!0,c.setAttribute("disabled","disabled")),c.toggleClass("active",this.isSource)},_onblur:function(){if(this.ckEditor){var b=this.ckEditor.getSelection().getNative();"none"!==b.type&&b.empty()}window.CONFIG_PANEL&&(window.CONFIG_PANEL.set("allowContextMenu",!1),(b=this.control.ancestor(".field-rhs"))&&b.removeClass("focused"))},_onfocus:function(b){window.CONFIG_PANEL&&
(window.CONFIG_PANEL.set("allowContextMenu",!0),(b=this.control.ancestor(".field-rhs"))&&b.addClass("focused"))},_loadLayout:function(c){var e={node:this.control,content:c,parentDialog:this.dialog,parentField:this,tabIndex:this.tabIndex};b.Lang.isString(c)&&(delete e.content,e.defaultHtml=c);this.editor=new b.Squarespace.LayoutEngine(e);this.events.push(this.dialog.on("send-requested",function(){this.editor.changed&&(this.editor.save(),this.edited=!1)},this));this.events.push(this.editor.on("change",
this.onEditorContentChange,this))},_onEditorContentChange:function(){this.adjustHeight();this.dialog.fire("datachange",this)},debounceOnEditorContentChange:b.Squarespace.debounce(function(b){b=b.that;this.throttleChangeFlag=!1;b._onEditorContentChange.apply(b)},200,"layout"===this.mode,"layout"===this.mode),onEditorContentChange:function(b){this.cachedValue=this.cachedContent=null;"fullscreen-view"===this.viewMode&&this.hideMenuBar(b);this._preventThrottling?this._onEditorContentChange():this.debounceOnEditorContentChange({that:this})},
render:function(){var c=this.modeRenderers[this.mode].apply(this),e=this.mode;"wysiwyg"===this.mode&&(e="visual");if("markdown"===this.mode||"html"===this.mode)e="code";this.modeEls[this.mode]=c;this.control=c.control;this.fieldTitleEl=c.title;this.menuElems=c.menu;this.menuEl=b.DB.DIV("field-wysiwyg-control clear",this.menuElems);this.html=b.DB.DIV("field-wrapper wysiwyg-field-wrapper clear "+this.config.style+" "+this.mode+"-mode mode-"+e+("CKEDITOR"===this.defaultEditor&&"wysiwyg"==this.mode?" ckenabled":
""),this.fieldTitleEl,b.DB.DIV("field-rhs",b.DB.DIV("field-wysiwyg-control-wrapper",this.menuEl),b.DB.DIV(d,this.control),this.config.description?b.DB.DIV("field-description-wrapper",b.DB.DIV("field-description",{html:this.config.description})):null));c=this.html.one("."+d);null!==this.containerHeight&&c.setStyle("height",this.containerHeight+"px");null!==this.containerWidth&&this.html.setStyle("width",this.containerWidth+"px")},hookEvents:function(){this.ckEditor||this.events.push(this.menuEl.delegate("click",
b.bind(function(c){var e=c.currentTarget.get("className");try{switch(e=e.substring(e.lastIndexOf("-")+1),e=-1!==e.indexOf(" ")?e.substring(0,e.indexOf(" ")):e,e){case "bold":this.editor.execCommand("bold");break;case "italic":this.editor.execCommand("italic");break;case "underline":this.editor.execCommand("underline");break;case "link":if("markdown"===this.config.engine)this.editor.execCommand("link");else this.onLinkButtonClick(c);break;case "unlink":this.editor.execCommand("unlink");break;case "unorderedlist":this.editor.execCommand("insertunorderedlist");
break;case "orderedlist":this.editor.execCommand("insertorderedlist");break;case "indent":this.editor.execCommand("indent");break;case "outdent":this.editor.execCommand("outdent");break;case "title":this.editor.execCommand("title");break;case "unimportant":this.editor.execCommand("unimportant");break;case "h1":this.editor.execCommand("heading","1");break;case "h2":this.editor.execCommand("heading","2");break;case "h3":this.editor.execCommand("heading","3");break;case "blockquote":this.editor.execCommand("blockquote");
break;case "removeformat":this.editor.execCommand("removeformat");this.editor.execCommand("removeformatblocks");break;case "insertblock":b.Squarespace.LayoutManager.addBlock(this.editor);break;case "undo":this.editor.execCommand("undo");break;case "redo":this.editor.execCommand("redo");break;case "fullscreen":this.toggleFullScreen(c);break;case "inverted":this.toggleInvertedStyle(c);break;case "widthsmall":this.setSmallWidth(c);break;case "widthmedium":this.setMediumWidth(c);break;case "widthlarge":this.setLargeWidth(c);
break}}catch(d){throw console.error("Error executing command",e,"Error was:",d),d;}finally{c.halt()}},this),".field-wysiwyg-tool"))},_containersHandler:function(c){for(var e in c.prevVal)if(e in c.newVal||b.one(".field-wysiwyg-tool-"+e).removeClass("active"),"link"==e&&(!c.newVal[e]||c.newVal[e]&&c.prevVal[e].getAttribute("href")!==c.newVal[e].getAttribute("href")))this._linkEdit.updateLink(),this._linkEdit.close(!0);for(e in c.newVal)e in(c.prevVal||[])||b.one(".field-wysiwyg-tool-"+e).addClass("active"),
"link"==e&&(!c.prevVal||!c.prevVal[e]||c.prevVal[e]&&c.prevVal[e].getAttribute("href")!==c.newVal[e].getAttribute("href"))&&this._linkEdit.openPrompt(c.newVal[e])},destroyEvents:function(){this.control.detach("wysiwyg|*");for(var b=0;b<this.events.length;++b){var e=this.events[b];e.detach?e.detach():e.removeListener&&e.removeListener()}this.events=[];this.debounceOnEditorContentChange&&this.debounceOnEditorContentChange.cancel&&this.debounceOnEditorContentChange.cancel()},onDataChanged:function(b){this.dialog.fire("datachange",
this)},getMode:function(){return this.mode},getContent:function(){return this.ckEditor?this.ckEditor.getData().replace(/(?:[ ]{2})|(?:\s{0,20}id="yui[^"]+")|(?:(\w?)\u200b(\w?))/g,""):this.editor.getContent()},cleanHTML:function(b){return!b?null:b.replace(RegExp("<p\\s+>","g"),"<p>")},getValue:function(){var b=this.getMode(),e=this.getContent(),d={};"layout"===b?(d.layout=e.layout,d.html=this.cleanHTML(e.html)||""):(d.source=e,d.isSource=this.isSource,d.mode=this.codeMode,d.engine=this.mode,d.rendered=
this.cleanHTML(this.generateHTML(e))||"");"wysiwyg"===d.engine&&(d.html=d.rendered,delete d.rendered);return d},generateHTML:function(c){var e=c;b.Lang.isFunction(this.config.preGenerateHTML)&&(e=this.config.preGenerateHTML(c));return this.isSource?(c=b.Node.create("<div></div>"),CodeMirror.runMode(e,this.codeMode,c._node),'<pre class="source-code">'+c.getContent()+"</pre>"):"markdown"===this.codeMode?b.Squarespace.Lang.markdownToHTML(e):e},setValue:function(b){b=this._determineModeContent(b);b.mode=
b.mode||"wysiwyg";this.mode!==b.mode&&this.switchMode(b.mode);this.isSource=b.isSource;this.codeMode=b.codeMode;this.ckEditor?this.ckEditor.setData(b.content||""):this.editor.setContent(b.content)},show:function(){this.modeShowHandlers[this.mode].apply(this);this.wasShown=!0;this.dialog.fire("currentMode",this.mode)},toggleInvertedStyle:function(){this.html.toggleClass("inverted");this.ckEditor?this.ckEditor.focus():this.editor.focus()},updateEditorWidth:function(){if(!this.ckEditor&&this.editor.setWidth&&
("html"===this.mode||"markdown"===this.mode)){var b=this.html.one("textarea").get("offsetWidth");this.editor.setWidth(b)}this.adjustHeight()},setSmallWidth:function(b){this.html.removeClass("width-large");this.html.addClass("width-small");this.updateEditorWidth();this.ckEditor?this.ckEditor.focus():this.editor.focus()},setMediumWidth:function(b){this.html.removeClass("width-small");this.html.removeClass("width-large");this.updateEditorWidth();this.ckEditor?this.ckEditor.focus():this.editor.focus()},
setLargeWidth:function(b){this.html.removeClass("width-small");this.html.addClass("width-large");this.updateEditorWidth();this.ckEditor?this.ckEditor.focus():this.editor.focus()},toggleFullScreen:function(c){this.menuHidden=!1;"undefined"!==typeof this.hideMenuEvent&&this.hideMenuEvent&&this.hideMenuEvent.detach();"undefined"!==typeof this.showMenuEvent&&this.showMenuEvent&&this.showMenuEvent.detach();c.stopPropagation();this.isFullscreen()?(this.fire("minimize-started"),b.Global.fire("minimize-started"),
this.recessTransition()):(this.dialog.activeFlyout&&(this.dialog.activeFlyout.field.closeFlyout(),this.dialog.activeFlyout=null),this.fire("maximize-started"),b.Global.fire("maximize-started"),this.expandTransition());this.ckEditor?this.ckEditor.focus():this.editor.focus()},expandDialogBox:function(){this.dialog.el&&(this.dialogOldStyle={top:this.dialog.el.getStyle("top"),left:this.dialog.el.getStyle("left"),height:this.dialog.el.getStyle("height"),width:this.dialog.el.getStyle("width")},this.dialog.el.setStyle("top",
"0px"),this.dialog.el.setStyle("left","0px"),this.dialog.el.setStyle("height","5000px"),this.dialog.el.setStyle("width","5000px"))},recessDialogBox:function(){this.dialog.el&&this.dialogOldStyle&&(this.dialog.el.setStyle("top",this.dialogOldStyle.top),this.dialog.el.setStyle("left",this.dialogOldStyle.left),this.dialog.el.setStyle("height",this.dialogOldStyle.height),this.dialog.el.setStyle("width",this.dialogOldStyle.width),delete this.dialogOldStyle)},recessTransition:function(){if(this.isExpanded){this.recessDialogBox();
this.isExpanded=this.dialog.params.disableSaveOverlay=!1;"undefined"!==typeof this.resizeEvent&&null!==this.resizeEvent&&(this.resizeEvent.detach(),this.resizeEvent=null);this.removeFullscreenButtons();var c=this.html.cloneNode(!0);c.removeClass("fullscreenEditor");c.one(".field-wysiwyg").setContent("");c.one(".field-wysiwyg").setStyle("background","white");var e=c.one(".field-lhs");e&&e.remove();(e=c.one(".field-description-wrapper"))&&e.remove();c.setStyle("position","fixed");c.setStyle("top",0);
c.setStyle("left",0);c.setStyle("z-index",3E5);c.setStyle("height",this.html.get("offsetHeight")+"px");c.setStyle("width",this.html.get("offsetWidth")+"px");c.setStyle("background","transparent");c.setStyle("padding","0");c.setStyle("overflow","hidden");this.events.push(c.on("click",function(b){b.stopPropagation()}));var f=b.DB.DIV("background",{style:"opacity: 1; background: black; position: fixed; top: 0px; left: 0px; height: 5000px; width: 5000px; z-index: 250000"});b.one("body").insert(c);b.one("body").insert(f);
e=this.html.getData("replaceNode");this.html.remove();this.html.setStyle("zIndex",null);e.replace(this.html);1>=b.all(".standard-dialog-wrapper .wysiwyg-field-wrapper.fullscreenEditor").size()&&b.one("body").removeClass("fullscreenEditor");this.viewMode="box-view";this.html.removeClass("fullscreenEditor");this.html.removeClass("inverted");this.html.one("."+d).setStyle("height",this.containerHeight);var e=this._anim({node:c,to:{top:this.html.one(".field-rhs").getY()-b.one(document.body).get("docScrollY")+
"px",height:this.originalTransData.height,left:this.html.one(".field-rhs").getX()-b.one(document.body).get("docScrollX")+"px",width:this.originalTransData.width},easing:"easeOutStrong",duration:0.3}),g=this._anim({node:f,from:{opacity:1},to:{opacity:0},duration:0.3,easing:"easeOutStrong"}),h=this._anim({node:c,to:{opacity:0},duration:0.3,easing:"easeOutStrong"});e.on("end",function(){g.run()},this);g.on("end",function(){f.remove();h.run()},this);h.on("end",function(){c.remove();this.fire("minimize-complete");
b.Global.fire("minimize-complete")},this);e.run();b.Squarespace.EscManager.removeTarget(this)}},expandTransition:function(){if(!this.isExpanded){this.isExpanded=this.dialog.params.disableSaveOverlay=!0;var c=this.html.one(".field-wysiwyg-control-wrapper").get("offsetHeight"),c=c+this.html.one(".field-wysiwyg").get("offsetHeight");this.originalTransData={top:this.html.one(".field-rhs").getY()-b.one(document.body).get("docScrollY")+"px",left:this.html.one(".field-rhs").getX()-b.one(document.body).get("docScrollX")+
"px",height:c+"px",width:this.html.one(".field-rhs").get("offsetWidth")+"px"};var e=this.html.cloneNode(!0);e.one(".field-wysiwyg").remove();var d=e.one(".field-lhs");d&&d.remove();(d=e.one(".field-description-wrapper"))&&d.remove();e.setStyle("position","fixed");e.setStyle("top",this.originalTransData.top);e.setStyle("left",this.originalTransData.left);e.setStyle("z-index",3E5);e.setStyle("height",c+"px");e.setStyle("width",this.originalTransData.width);e.setStyle("background","white");e.setStyle("padding",
"0");e.setStyle("opacity","1");(c=e.one(".field-rhs"))&&c.setStyle("height","100%");var g=b.DB.DIV("background",{style:"opacity: 0; background: black; position: fixed; top: 0px; left: 0px; height: 5000px; width: 5000px; z-index: 250000"}),c=b.one("body");c.insert(e);c.insert(g);c.addClass("fullscreenEditor");this.viewMode="fullscreen-view";var c=this._anim({node:g,to:{opacity:1},duration:0.3,easing:"easeOutStrong"}),h=this._anim({node:e,to:{top:"0px",height:this.html.get("winHeight")+"px",left:"0px",
width:this.html.get("winWidth")+"px"},easing:"easeOutStrong",duration:0.3}),k=this._anim({node:e,to:{opacity:0},duration:0.3,easing:"easeOutStrong"});c.on("end",function(){this.updateEditorWidth();this.addFullscreenButtons();h.run()},this);h.on("end",function(){this.adjustHeight();var c=b.DB.DIV("replaceNode");this.html.setData("replaceNode",c);this.html.replace(c);b.one("body").append(this.html);this.html.setStyle("zIndex",b.Squarespace.DIALOG_ZINDEX_BASE+10);b.Squarespace.EscManager.addTarget(this);
this.html.addClass("fullscreenEditor");this.resizeEvent=b.on("resize",this.fullScreenEditorResize,b.one(window),this);this.hideMenuEvent=this.dialog.on("keydown",this.hideMenuBar,this);this.events.push(this.hideMenuEvent);g.remove();this.expandDialogBox();k.run()},this);k.on("end",function(){this.fire("maximize-complete");b.Global.fire("maximize-complete");e.remove()},this);c.run()}},cancel:function(c){this.isExpanded&&(27===c.keyCode?this.toggleFullScreen(c):b.Squarespace.EscManager.addTarget(this))},
addFullscreenButtons:function(){if("layout"!==this.mode){var b=this._renderContainer({type:"container",contents:[{type:"separator"},{cmd:"inverted",title:"Inverted",type:"button"},{type:"separator"},{cmd:"widthsmall",title:"Small",type:"button"},{cmd:"widthmedium",title:"Medium",type:"button"},{cmd:"widthlarge",title:"Large",type:"button"}]});b.addClass("fullscreen-options");var e=this.html.one(".field-wysiwyg-control"),d=e.get("children");e.insert(b,d.size()-1)}},removeFullscreenButtons:function(){this.html.all(".fullscreen-options").remove()},
hideMenuBar:function(c){if(!(c&&60>=c.pageY)&&!this.menuHidden&&!("layout"===this.mode||"fullscreen-view"!==this.viewMode)){this.menuHidden=!0;c=this.html.one(".field-wysiwyg-control-wrapper");var e=this.dialog.el.one(".autosave-state");this.hideMenuEvent&&this.hideMenuEvent.detach();!c||!c._node||c.get("id")!==c._node.id?(console.log("no menu node"),this.hideMenuEvent.detach()):(this.hideMenuAnim=new b.Anim({node:c,to:{top:"-"+c.get("offsetHeight")},duration:0.3,easing:b.Easing.easeOutStrong}),this.hideMenuAnim.run(),
e&&e.setStyle("visibility","hidden"),this.showMenuEvent=b.one("window").on("mousemove",this.showMenuBar,this),this.events.push(this.showMenuEvent),this.showMenuEvent=b.one("body").on("mousemove",this.showMenuBar,this))}},showMenuBar:function(c){if(!(60<c.pageY)){"undefined"!==typeof this.hideMenuAnim&&this.hideMenuAnim&&this.hideMenuAnim.stop();c=this.html.one(".field-wysiwyg-control-wrapper");var e=this.dialog.el.one(".autosave-state");!c||!c._node||c.get("id")!==c._node.id?this.showMenuEvent.detach():
(this.showMenuEvent&&this.showMenuEvent.detach(),this.showMenuAnim=new b.Anim({node:c,to:{top:"0px"},duration:0.3,easing:b.Easing.easeOutStrong}),this.showMenuAnim.run(),e&&e.setStyle("visibility",""),this.showMenuEvent&&this.showMenuEvent.detach(),this.menuHidden=!1)}},fullScreenEditorResize:function(b){this.adjustHeight()},isFullscreen:function(){return"fullscreen-view"===this.viewMode?!0:!1},_visualShow:function(){this.events.push(b.one("body").on("click",this.onBodyClick,this));"page-view"===
this.viewMode&&!this.resizeEvent&&(this.resizeEvent=b.on("resize",this.adjustHeight,b.one(window),this))},_textEditorShow:function(){this.events.push(b.one("body").on("click",this.onBodyClick,this));"page-view"===this.viewMode&&!this.resizeEvent&&(this.resizeEvent=b.on("resize",this.adjustHeight,b.one(window),this))},_layoutEditorShow:function(){this.events.push(b.one("body").on("click",this.onBodyClick,this));this.resizeEvent=b.on("resize",this.adjustHeight,b.one(window),this)},getIdealColumnWidth:function(){var b=
this.editor.getTemplate(),e=this.html.get("offsetWidth")-130,e=e-(b.getColumns()-1)*b.getMarginWidth();return e/b.getColumns()},onLinkButtonClick:function(b){this.modeLinkHandlers[this.mode].apply(this,arguments)},_visualOnLinkButtonClick:function(b){this.ckEditor||(this.editor.saveSelection(),this.editor.execCommand("createLink"))},_textEditorOnLinkButtonClick:function(b){},_layoutOnLinkButtonClick:function(){},onBodyClick:function(b){b.target.ancestor(".field-wysiwyg-control-wrapper",!0)||"fullscreen-view"===
this.viewMode&&this.hideMenuBar(b)},getContentHeight:function(){return"html"===this.mode||"markdown"===this.mode?this.ckEditor?parseInt(this.ckEditor.ui.space("contents").getStyle("height"),10):this.editor.getContentHeight():-1},adjustHeight:function(){var c=this.html.one("."+d);if("fullscreen-view"===this.viewMode){var e=c.get("winHeight");c.setStyle("height",null)}else"page-view"===this.viewMode&&"layout"!==this.mode&&(e=c.get("winHeight"),c=b.one(".content-title").get("offsetHeight"),e=Math.max(e-
c-34-20,this.getContentHeight()),this.control.setStyle("height",e+"px"))},setHeight:function(b){b=parseInt(b,10);if("box-view"===this.viewMode){b-=this.menuEl.get("offsetHeight");b=this.ckEditor?b-3:b-30;var e=this.html.one("."+d);this.containerHeight=b;e.setStyle("height",this.containerHeight+"px")}},_renderTitle:function(){return this.config.title&&"top"==this.config.titleStyle?b.DB.DIV("field-lhs",{html:this.config.title}):null},_renderButton:function(c){return b.DB.BUTTON("field-wysiwyg-tool field-wysiwyg-tool-"+
c.cmd,{tabIndex:-1},b.DB.SPAN("icon",{html:c.html||"&nbsp;"}))},_renderModeSelector:function(c){if(this.modes.layout)return null;c={};for(var e in this.modes)c[e]={title:e.toUpperCase()};this.select=new b.Squarespace.DialogFieldGenerators.select({type:"select",width:70,name:"mode",defaultValue:"",options:c},{mode:this.mode},this.dialog);this.select.underlyingControl.setAttribute("tabindex",-1);this.events.push(this.select.on("change",function(){this.switchMode(this.select.getValue())},this));this.select.render();
return b.DB.DIV("sqs-mode-container",this.select.html)},_renderMenuSeparator:function(c){return b.DB.DIV("separator")},_renderContainer:function(c){var e=b.DB.DIV("sqs-container",{style:c.style||""});c=this._renderMenu(c.contents);for(var d=0;d<c.length;++d)e.append(c[d]);return e},_renderSelect:function(c){var e=b.DB.SELECT("field-wysiwyg-select",{tabindex:-1}),d;for(d in c.options){var g={value:d,html:c.options[d]};c.selected&&c.selected===d&&(g.selected="selected");e.appendChild(b.DB.OPTION("",
g))}return e},_visualRender:function(){return{control:"CKEDITOR"!==this.defaultEditor?b.DB.DIV("sqs-visual-edit",{id:"field-wysiwyg-editor-container"}):b.DB.TEXTAREA("sqs-visual-edit",{id:"field-wysiwyg-editor-container"}),title:this._renderTitle(),menu:this._visualRenderMenu()}},_textEditorRender:function(){return{control:b.DB.TEXTAREA("sqs-text-edit mode-"+this.mode,{id:"field-wysiwyg-editor-container",style:"border: none;"}),title:this._renderTitle(),menu:this._textEditorRenderMenu()}},_layoutRender:function(){return{control:b.DB.DIV("sqs-layout columns-12",
{id:"field-wysiwyg-editor-container"}),title:this._renderTitle(),menu:this._layoutEditorRenderMenu()}},_visualRenderMenu:function(){return this._renderMenu(this.menuConfigs[this.menuConfig].wysiwyg)},_textEditorRenderMenu:function(){return this._renderMenu(this.menuConfigs[this.menuConfig].code||this.menuConfigs[this.menuConfig].other||this.menuConfigs[this.menuConfig].markdown)},_layoutEditorRenderMenu:function(){return this._renderMenu(this.menuConfigs[this.menuConfig].layout)},_renderMenu:function(b){for(var e=
[],d=0;d<b.length;++d){var g=b[d];"separator"===g.type?e.push(this._renderMenuSeparator(g)):"mode"===g.type?e.push(this._renderModeSelector(g)):"button"===g.type?e.push(this._renderButton(g)):"container"===g.type?e.push(this._renderContainer(g)):"select"===g.type&&e.push(this._renderSelect(g))}return e},_destroy:function(){this._super();this.destroyEvents();"undefined"!==typeof this.resizeEvent&&null!==this.resizeEvent&&(this.resizeEvent.detach(),this.resizeEvent=null);this.ckEditor&&this.ckEditor.destroy();
this.editor&&this.editor.destroy();this.preCloseEvent&&this.preCloseEvent.detach()}})},"1.0",{requires:"node transition squarespace-util squarespace-debounce squarespace-dialog squarespace-visual-editor squarespace-text-editor squarespace-wysiwyg-editor squarespace-flyout-link-edit squarespace-markdown squarespace-markdown-editor squarespace-widgets-confirmation thirdparty-codemirror".split(" "),after:["squarespace-dialog"]});
(function(){(function(b,d){if("function"===typeof define)define(d);else if("undefined"!==typeof module&&module.exports)module.exports=d();else{var c=d(),e=this,f=e[b];c.noConflict=function(){e[b]=f;return c};e[b]=c}})("markdownDOMParser",function(){var b=function(d,c,e){e=e||{};var f=document.createElement("div");f.innerHTML=d;d=e.nodesToIgnore||[];for(var g=e.parseHiddenNodes||"false",h=e.nodesToPreserve||[],k=e.preserveAttribute||"data-preserve-html-node",f=f.childNodes,l=0;l<f.length;l++)try{for(var p=
!1,q=0;q<d.length;q++)if(f[l].nodeName.toLowerCase()==d[q]){p=!0;break}for(var q=!1,r=0;r<h.length;r++)if(f[l].nodeName.toLowerCase()==h[r]){q=!0;break}var s;if(!(s=p)){var t;if(t=!g)a:{var u=f[l];if("title"==u.nodeName.toLowerCase())t=!1;else if(window.getComputedStyle){try{var v=window.getComputedStyle(u,null);if(v.getPropertyValue&&"none"==v.getPropertyValue("display")){t=!0;break a}}catch(w){}t=!1}else t=void 0}s=t}if(!s)if("#text"!=f[l].nodeName.toLowerCase()&&"#comment"!=f[l].nodeName.toLowerCase()){p=
[];if(f[l].hasAttributes()){for(var y=f[l].attributes,r=0;r<y.length;r++){var z=y.item(r);p.push({name:z.nodeName,value:z.nodeValue})}void 0!==f[l].attributes[k]&&(q=!0)}if(c.preserve&&q)c.preserve(f[l],k);else if(c.start)if(f[l].hasChildNodes()){c.start(f[l].nodeName,p,!1);if("iframe"==f[l].nodeName.toLowerCase()||"frame"==f[l].nodeName.toLowerCase()){if(f[l].contentDocument&&f[l].contentDocument.documentElement)return b(f[l].contentDocument.documentElement,c,e)}else b(f[l].innerHTML,c,e);c.end&&
c.end(f[l].nodeName)}else c.start(f[l].nodeName,p,!0)}else"#text"==f[l].nodeName.toLowerCase()?c.chars&&c.chars(f[l].nodeValue):"#comment"==f[l].nodeName.toLowerCase()&&c.comment&&c.comment(f[l].nodeValue)}catch(B){console.error(B),console.log("error while parsing node: "+f[l].nodeName.toLowerCase())}};return b});(function(b,d){if("function"===typeof define)define(d);else if("undefined"!==typeof module&&module.exports)module.exports=d();else{var c=d(),e=this,f=e[b];c.noConflict=function(){e[b]=f;
return c};e[b]=c}})("html2markdown",function(){function b(b){return b.replace(/^\s+|\s+$/g,"")}function d(b,e){return 0==b.indexOf(e)}return function(c,e){function f(){var b="";if(t)for(var c=0;c<t.length-1;c++)b+="  ";return b+=h(t)}function g(b){var c={},e;for(e in b){var d=b[e];c[d.name]=d}return c}function h(b){return b&&0<b.length?b.slice(-1)[0]:""}function k(b){if(!b)return"";for(var c=b.length-1;0<=c;c--)if(""!=b[c])return b[c];return""}function l(b){var c=!1;if(b==k(s)){for(;h(s)!=b;)s.pop();
s.pop();c=!0}return c}function p(b){for(var c=[];0<s.length&&h(s)!=b;){var e=s.pop();c.unshift(e)}return c.join("")}function q(b){var c=s.pop();c&&(b?(s.push(c),"\n"!=c.match("\n$")&&s.push("\n\n")):(/\s*\n\n\s*$/.test(c)?(c=c.replace(/\s*\n\n\s*$/,"\n\n"),b=""):/\s*\n\s*$/.test(c)?(c=c.replace(/\s*\n\s*$/,"\n"),b="\n"):(/\s+$/.test(c),b="\n\n"),s.push(c),s.push(b)))}function r(){0<s.length?"\n"!=h(s).match("\n$")&&s.push("\n"):s.push("\n")}e=e||{};var s=[],t=[],u=[],v=[],w=[],y=[],z=[],B=e.inlineStyle||
!1,A=e.parser,K={hr:"- - -\n\n",br:"  \n",title:"# ",h1:"# ",h2:"## ",h3:"### ",h4:"#### ",h5:"##### ",h6:"###### ",b:"**",strong:"**",i:"_",em:"_",dfn:"_","var":"_",cite:"_",span:" ",ul:"* ",ol:"1. ",dl:"- ",blockquote:"> ",code:"`"};!A&&"undefined"!==typeof markdownDOMParser&&(A=markdownDOMParser);A(c,{preserve:function(b,c){var e="\n"+b.outerHTML.replace(RegExp(" "+c+'="true"',"g"),"")+"\n";s.push(e)},start:function(c,e,l){c=c.toLowerCase();if(!l||!("br"!=c&&"hr"!=c&&"img"!=c))switch(c){case "br":s.push(K[c]);
break;case "hr":q();s.push(K[c]);break;case "title":case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":q();s.push(K[c]);break;case "b":case "strong":case "i":case "em":case "dfn":case "var":case "cite":s.push(K[c]);break;case "code":if(0<w.length||0<y.length)break;s.push(K[c]);y.push(!0);break;case "span":if(0<w.length||0<y.length)break;else/\s+$/.test(h(s))||s.push(K[c]);break;case "p":case "div":case "table":case "tbody":case "tr":case "td":q();break;case "ul":case "ol":case "dl":t.push(K[c]);
1<t.length?r():q();break;case "li":case "dt":var p=f();s.push(p);break;case "a":c=g(e);u.push(c);s.push("[");break;case "img":c=g(e);var A,aa;c.src?aa=c.src.value:aa="";if(!aa)break;c.alt?p=b(c.alt.value):p="";c.title?A=b(c.title.value):A="";!B&&!d(k(s),"[")?(c=z.indexOf(aa),-1==c&&(z.push(aa),c=z.length-1),q(),s.push("!["),""!=p?s.push(p):null!=A&&s.push(A),s.push("]["+c+"]"),q()):(d(k(s),"[")||q(),s.push("!["+p+"]("+aa+(A?' "'+A+'"':"")+")"),d(k(s),"[")||q(!0));break;case "blockquote":q();v.push(K[c]);
break;case "pre":q();w.push(!0);s.push("    ");break;case "table":s.push("<table>");break;case "thead":s.push("<thead>");break;case "tbody":s.push("<tbody>");break;case "tr":s.push("<tr>");break;case "td":s.push("<td>")}},chars:function(c){if(0===y.length)if(0<w.length)c=c.replace(/\n/g,"\n    ");else if(""!=b(c)){c=c.replace(/\s+/g," ");var e=k(s);/\s+$/.test(e)&&(c=c.replace(/^\s+/g,""))}else{s.push("");return}0<v.length&&s.push(v.join(""));s.push(c)},end:function(c){c=c.toLowerCase();switch(c){case "title":case "h1":case "h2":case "h3":case "h4":case "h5":case "h6":l(K[c])||
q(!0);break;case "p":case "div":case "table":case "tbody":case "tr":case "td":for(;0<s.length&&""==b(h(s));)s.pop();q(!0);break;case "b":case "strong":case "i":case "em":case "dfn":case "var":case "cite":l(K[c])||(s.push(b(p(K[c]))),s.push(K[c]));break;case "a":var e=p("["),e=e.replace(/\s+/g," "),e=b(e);if(""==e){s.pop();break}c=u.pop();var g;c.href&&""!=c.href.value?g=c.href.value:g="";if(""==g){s.pop();s.push(e);break}s.push(e);!B&&!d(h(s),"!")?(e=z.indexOf(g),-1==e&&(z.push(g),e=z.length-1),s.push("]["+
e+"]")):(d(h(s),"!")&&(e=s.pop(),e=s.pop()+e,q(),s.push(e)),e=c.title,s.push("]("+g+(e?' "'+b(e.value).replace(/\s+/g," ")+'"':"")+")"),d(h(s),"!")&&q(!0));break;case "ul":case "ol":case "dl":r();t.pop();break;case "li":case "dt":g=f();l(g)||(e=b(p(g)),d(e,"[![")?(s.pop(),q(),s.push(e),q(!0)):(s.push(e),r()));break;case "blockquote":v.pop();break;case "pre":q(!0);w.pop();break;case "code":y.pop();case "span":if(0<w.length)break;else""==b(h(s))?s.pop():(e=s.pop(),s.push(b(e))),s.push(K[c]);break;case "table":s.push("</table>");
break;case "thead":s.push("</thead>");break;case "tbody":s.push("</tbody>");break;case "tr":s.push("</tr>");break;case "td":s.push("</td>")}}},{nodesToPreserve:"script noscript object iframe frame head style label".split(" ")});if(!B)for(A=0;A<z.length;A++)if(0==A){var O=s.pop();s.push(O.replace(/\s+$/g,""));s.push("\n\n["+A+"]: "+z[A])}else s.push("\n["+A+"]: "+z[A]);return s.join("")}});YUI.add("squarespace-markdown-from-html",function(b){b.namespace("Squarespace.Lang");b.Squarespace.Lang.markdownFromHTML=
function(b){return!b?"":html2markdown(b)}},"1.0",{requires:[]})})();
YUI.add("squarespace-layout-insert-block-menu-email",function(b){b.namespace("Squarespace.Layout").InsertBlockMenuEmail=b.Base.create("layoutInsertBlockMenu",b.Squarespace.Layout.InsertBlockMenuWebBase,[],{_getInsertableBlockItems:function(){return[{label:"Basic",items:[b.Squarespace.BlockType.HTML,b.Squarespace.BlockType.MARKDOWN,b.Squarespace.BlockType.IMAGE,b.Squarespace.BlockType.BUTTON,b.Squarespace.BlockType.SPACER,b.Squarespace.BlockType.HORIZONTAL_RULE]}]}},{CSS_PREFIX:"sqs-layout-insert-block-menu",
ATTRS:{editMode:{readOnly:!0,value:b.Squarespace.Layout.EditMode.EMAIL}}})},"1.0",{requires:["base","squarespace-enum","squarespace-layout-insert-block-menu-web-base","squarespace-layout-renderable-blocks-email"]});
YUI.add("squarespace-content-manager-widgets-blog-item",function(b){var d=b.namespace("Squarespace.Blog").Item=b.Base.create("BlogListItem",b.Squarespace.SSWidget,[b.WidgetChild],{initializer:function(){this.publish("editContent")},bindUI:function(){var c=this.get("id");this.get("boundingBox").on([c+"|contextmenu",c+"|click"],function(c){c.target.ancestor(".preview a")?CONFIG_PANEL.showSite({targetUrl:this.get("item").get("fullUrl")}):c.shiftKey?this.set("selected",0===this.get("selected")?1:0):b.Squarespace.Utils.isDamaskEnabled()?
(this.get("parent").setSelected(this),this.set("selected",0),b.Lang.isValue(c.target.ancestor(".button-edit",!0))&&this._showConfigurationDialog()):this._showConfigurationDialog();c.halt()},this);this.after("isSelectedChange",this._toggleSelected,this);this._registerEvent(this.get("item").on(c+"|save",this._renderAgain,this))},renderUI:function(){d.superclass.renderUI.call(this);b.Squarespace.Utils.isDamaskEnabled()&&this.get("contentBox").one(".blog-list-item").append('<div class="buttons controls"><div class="button button-edit"><a href="#">Edit</a></div></div>')},
syncUI:function(){this.set("className",this.getClassName(this._getTemplateContextForWorkflow(this.get("item").get("workflowState")).className))},destructor:function(){this.get("item").detach(this.get("id")+"|*")},_toggleSelected:function(){this.get("boundingBox").toggleClass(this.getClassName("selected"),this.get("isSelected"))},_renderAgain:function(){this.get("destroyed")||(this.get("contentBox").empty(!0),this.get("contentBox").prepend(this.renderTemplate()),this.syncUI())},_showConfigurationDialog:function(){var c=
this.get("item");(new (b.Squarespace.ContentItemEditorFactory.getEditor(c))({model:c})).show()},_getTemplateContextForWorkflow:function(c){var e={className:"published"};switch(c){case b.Squarespace.WorkflowStates.SCHEDULED:e={className:"scheduled",message:"Scheduled"};break;case b.Squarespace.WorkflowStates.NEEDS_REVIEW:e={className:"needs-review",message:"Needs Review"};break;case b.Squarespace.WorkflowStates.DRAFT:e={className:"draft",message:"Draft"}}return e},_getCommentText:function(c){return b.Squarespace.Utils.isDamaskEnabled()?
c.commentState==b.Squarespace.CommentStates.DISABLED?!1:c.commentCount:Static.SQUARESPACE_CONTEXT.websiteSettings.disqusShortname?!1:c.commentState==b.Squarespace.CommentStates.DISABLED?"Comments Off":0===c.commentCount?"No Comments":1===c.commentCount?"1 Comment":c.commentCount+" Comments"},_getDateDescription:function(c){var e,d,g=c.structuredContent;c=b.DataType.Date.parse(g.startDate);g=b.DataType.Date.parse(g.endDate);e=b.Squarespace.DateUtils.dateFormat(c,{format:"%Y%m%d"});d=b.Squarespace.DateUtils.dateFormat(c,
{format:"%Y%m%d"});e==d?(e=b.Squarespace.DateUtils.dateFormat(c,{format:"%B %e, %Y, %l:%M%P"}),d=b.Squarespace.DateUtils.dateFormat(g,{format:"%l:%M%P"})):(e=b.Squarespace.DateUtils.dateFormat(c,{format:"%B %e, %Y"}),d=b.Squarespace.DateUtils.dateFormat(g,{format:"%B %e, %Y"}));return(c?e+"&nbsp;&mdash;&nbsp;":"")+(g?d:"")},_getHBTemplateContext:function(){var c=this.get("item").toJSON();c.commentCount=this._getCommentText(c);var e=this._getTemplateContextForWorkflow(c.workflowState);b.Object.isEmpty(e)||
(c.flag=e);b.Lang.isValue(c.proxyForId)&&(c.flag={className:"example-content",message:"Example"});c.recordType==b.Squarespace.RecordType.EVENT&&(c.eventDateDescriptor=this._getDateDescription(c));return c}},{CSS_PREFIX:"sqs-blog-item",HANDLEBARS_TEMPLATE:"content-manager-blog-item.html",ATTRS:{item:{},isSelected:{value:!1}}})},"1.0",{requires:["squarespace-content-item-types-editor","squarespace-date-utils","squarespace-ss-widget","squarespace-util","widget-child"]});
YUI.add("squarespace-view",function(b){b.namespace("Squarespace").View=b.Base.create("sqsView",b.View,[],{initializer:function(b){var c=this.get("id");this.after(c+"|modelChange",function(b){b.prevVal&&b.prevVal.removeTarget(this);b.newVal&&(b.newVal.addTarget(this),b.newVal.after("destroy",this.destroy,this))});b&&b.model&&this.set("model",b.model);this._rerenderSub=this.after(c+"|*:change",function(b){b.silent||this.render()},this)},destructor:function(d){(!d||d&&!d.preserveContainer)&&this.get("container").remove(!0);
b.detachAll(this.get("id")+"|*")},render:function(d){var c=this.get("container");if(this.template){var e=this._getTemplateContext(),f=b.Squarespace.UITemplates.render(this.template,e);c.setHTML(f);b.Cookie.get("SQUARESPACE_UI_DEBUG")&&console.log(this.name+": Rendered with context:",e)}d&&d instanceof b.Node&&c.appendTo(d)},_getTemplateContext:function(){var b=this.get("model");return b?b.toJSON():this.getAttrs()}},{ATTRS:{container:{valueFn:function(){return b.Node.create('<div class="sqs-'+this.name+
'"/>')},readOnly:!0}}})},"1.0",{requires:["base-build","node","view","model","squarespace-ui-templates"]});
YUI.add("thirdparty-pinterest",function(b){(function(d,c,e){var f=d[e.k]={w:d,d:c,a:e,s:{},f:function(){return{callback:[],get:function(b,c){var e=null;return e="string"===typeof b[c]?b[c]:b.getAttribute(c)},getData:function(b,c){c=f.a.dataAttributePrefix+c;return f.f.get(b,c)},set:function(b,c,e){"string"===typeof b[c]?b[c]=e:b.setAttribute(c,e)},make:function(b){var c=!1,e,d;for(e in b)if(b[e].hasOwnProperty){c=f.d.createElement(e);for(d in b[e])b[e][d].hasOwnProperty&&"string"===typeof b[e][d]&&
f.f.set(c,d,b[e][d]);break}return c},kill:function(b){"string"===typeof b&&(b=f.d.getElementById(b));b&&b.parentNode&&b.parentNode.removeChild(b)},replace:function(b,c){b.parentNode.insertBefore(c,b);f.f.kill(b)},getEl:function(b){var c=null;return c=b.target?3===b.target.nodeType?b.target.parentNode:b.target:b.srcElement},listen:function(b,c,e){b&&("undefined"!==typeof f.w.addEventListener?b.addEventListener(c,e,!1):"undefined"!==typeof f.w.attachEvent&&b.attachEvent("on"+c,e))},call:function(b,
c){var e,d,p="?";e=f.f.callback.length;d=f.a.k+".f.callback["+e+"]";f.f.callback[e]=function(b){c(b,e);f.f.kill(d)};b.match(/\?/)&&(p="&");f.d.b.appendChild(f.f.make({SCRIPT:{id:d,type:"text/javascript",charset:"utf-8",src:b+p+"callback="+d}}))},debug:function(b,c){(f.v.config.debug||c)&&(f.w.console&&f.w.console.log)&&f.w.console.log(b)},presentation:function(){var b,c,d;b=f.f.make({STYLE:{type:"text/css"}});c=f.a.cdn[f.v.protocol]||f.a.cdn["http:"];d=f.a.rules.join("\n");d=d.replace(/\._/g,"."+
e.k+"_");d=d.replace(/;/g,"!important;");d=d.replace(/_cdn/g,c);d=d.replace(/_rez/g,f.v.resolution);b.styleSheet?b.styleSheet.cssText=d:b.appendChild(f.d.createTextNode(d));f.d.h?f.d.h.appendChild(b):f.d.b.appendChild(b)},getPos:function(c){var e=b.one(c).ancestor(".content-fill,.image-block-wrapper.has-aspect-ratio");e&&(c=e.getDOMNode());if(b.Squarespace.Utils.isDamaskEnabled()&&c.getBoundingClientRect)return c=c.getBoundingClientRect(),{left:c.left,top:c.top};var d=e=0;if(c.offsetParent){do e+=
c.offsetLeft,d+=c.offsetTop;while(c=c.offsetParent);return{left:e,top:d}}},hideFloatingButton:function(){f.s.floatingButton&&f.f.kill(f.s.floatingButton)},getButtonConfig:function(b){b={height:f.f.getData(b,"height")||f.v.config.height,color:f.f.getData(b,"color")||f.v.config.color,shape:f.f.getData(b,"shape")||f.v.config.shape,assets:f.f.getData(b,"lang")||f.v.config.lang,zero:f.f.getData(b,"zero")||null,config:f.f.getData(b,"config")||"none"};"round"===b.shape?("16"!==b.height&&"32"!==b.height&&
(b.height="16"),b.color="red"):"rect"===b.shape?("20"!==b.height&&"28"!==b.height&&(b.height="20"),"gray"!==b.color&&("red"!==b.color&&"white"!==b.color)&&(b.color="gray")):(b.shape="rect",b.height="20",b.color="gray");"rect"===b.shape?f.a.hazAssets[b.assets]||(b.assets=f.v.config.assets):b.assets="en";return b},showFloatingButton:function(b){f.f.debug("show floating Pin It button");f.f.hideFloatingButton();var c=f.f.getButtonConfig(b);if(-1!==b.className.indexOf("demo-image")||b.height>f.a.minImgSize&&
b.width>f.a.minImgSize&&!b.src.match(/^data/)){var e=f.a.k+"_pin_it_button_"+c.height+" "+f.a.k+"_pin_it_button_"+c.assets+"_"+c.height+"_"+c.color+" "+f.a.k+"_pin_it_button_floating_"+c.height;"round"===c.shape&&(e=f.a.k+"_pin_it_button_en_"+c.height+"_red_round "+f.a.k+"_pin_it_button_floating_en_"+c.height+"_red_round");f.s.floatingButton=f.f.make({A:{className:e,title:"Pin it!",target:"_blank"}});f.f.set(f.s.floatingButton,f.a.dataAttributePrefix+"log","button_pinit_floating");f.d.b.appendChild(f.s.floatingButton);
c=f.f.getPos(b);e=f.v.endpoint.create;e=e+"url="+encodeURIComponent(f.d.URL)+"&media="+encodeURIComponent(b.src)+"&description="+encodeURIComponent(b.getAttribute("data-pin-description")||b.title||b.alt||f.d.title);f.s.floatingButton.href=e;f.s.floatingButton.onclick=function(){f.w.open(this.href,"pin"+(new Date).getTime(),f.a.pop);f.f.hideFloatingButton();return f.v.hazFloatingButton=!1};f.s.floatingButton.style.top=c.top+f.a.floatingButtonOffsetTop+"px";f.s.floatingButton.style.left=c.left+f.a.floatingButtonOffsetLeft+
"px";f.s.floatingButton.style.zIndex="8675309";f.s.floatingButton.style.display="block"}},over:function(c){if(c=f.f.getEl(c||f.w.event)){var e=b.one(c),d=e.ancestor(".sqs-block-image,.sqs-gallery-block-stacked,.sqs-gallery-block-grid,.sqs-gallery-block-slideshow"),l=b.Lang.isValue(d);d&&f.v.config.ancestorSelectorTest&&(b.Lang.isValue(e.ancestor(f.v.config.ancestorSelectorTest))||(l=!1));"IMG"===c.tagName&&c.src&&!f.f.getData(c,"no-hover")&&!f.f.get(c,"nopin")&&f.v.config.hover&&l?(!1===f.v.hazFloatingButton?
f.v.hazFloatingButton=!0:f.f.hideFloatingButton(),f.f.showFloatingButton(c)):!0===f.v.hazFloatingButton&&c!==f.s.floatingButton&&(f.v.hazFloatingButton=!1,f.f.hideFloatingButton())}},click:function(b){b=b||f.w.event;var c;if(b=f.f.getEl(b)){if(c=f.f.getData(b,"log"))f.f.log("&type="+c+"&href="+encodeURIComponent(b.href||f.f.getData(b,"href"))),b.className.match(/hazClick/)||(b.className=b.className+" "+f.a.k+"_hazClick");(b=f.f.getData(b,"pin-id"))&&f.w.open(f.v.endpoint.repin.replace(/%s/,b),"pin"+
(new Date).getTime(),f.a.pop)}},filter:function(b){var c;c="";try{c=decodeURIComponent(b)}catch(e){}b=c.replace(/</g,"&lt;");return b=b.replace(/>/g,"&gt;")},behavior:function(){f.f.listen(f.d.b,"click",f.f.click);f.v.config.hover&&(f.d.b.setAttribute("data-pin-hover",!0),f.f.listen(f.d.b,"mouseover",f.f.over));var b=function(){for(var c=f.d.getElementsByTagName("SCRIPT"),e=0,d=c.length;e<d;e+=1)c[e]&&(c[e].src&&c[e].src.match(/^https?:\/\/logc?\.pinterest\.com/))&&f.f.kill(c[e]);f.w.setTimeout(function(){b()},
2E3)};b()},getPinCount:function(b){b="?url="+b+"&ref="+encodeURIComponent(f.v.here)+"&source="+f.a.countSource;f.f.call(f.a.endpoint.count+b,f.f.ping.count)},prettyPinCount:function(b){999<b&&(b=1E6>b?parseInt(b/1E3,10)+"K+":1E9>b?parseInt(b/1E6,10)+"M+":"++");return b},avatar:function(b,c){var e=b.replace(/_30.jpg/,"_60.jpg"),d=f.f.make({A:{className:f.a.k+"_avatar",href:c,target:"_blank"}}),e=f.f.make({IMG:{src:e}});d.appendChild(e);return d},grid:function(b,c,e){e||(e="embed_board");b.style.display=
"block";var d=f.a.tile.scale.height,p=f.a.tile.scale.width,q=f.f.getData(b,"scale-height");q&&q>=f.a.tile.scale.minHeight&&(d=parseInt(q,10));(q=f.f.getData(b,"scale-width"))&&q>=f.a.tile.scale.minWidth&&(p=parseInt(q,10));q=f.f.getData(b,"board-width")||b.offsetWidth;q>b.offsetWidth&&(q=b.offsetWidth);var r=Math.floor(q/(p+f.a.tile.style.margin));r>f.a.tile.maxColumns&&(r=f.a.tile.maxColumns);if(r<f.a.tile.minColumns)return!1;b=f.f.make({SPAN:{className:f.a.k+"_embed_grid_bd"}});b.style.height=d+
"px";f.v.renderedWidth=r*(p+f.a.tile.style.margin)-f.a.tile.style.margin;b.style.width=f.v.renderedWidth+"px";for(var q=f.f.make({SPAN:{className:f.a.k+"_embed_grid_ct"}}),s=0,t=[],u=0,v=c.length;u<v;u+=1){var w=f.f.make({SPAN:{innerHTML:c[u].description}}),w=f.f.make({A:{className:f.a.k+"_embed_grid_th",title:w.innerHTML}});f.f.set(w,f.a.dataAttributePrefix+"pin-id",c[u].id);f.f.set(w,f.a.dataAttributePrefix+"log",e);var y=c[u].images["237x"].height*(p/c[u].images["237x"].width),z=p,B=f.f.make({IMG:{src:c[u].images["237x"].url,
nopin:"true",height:y,width:z,className:f.a.k+"_embed_grid_img",alt:c[u].description}});B.style.height=y+"px";B.style.width=z+"px";B.style.marginTop=0-y/f.a.tile.style.margin+"px";y>d&&(y=d);w.appendChild(B);w.style.height=y+"px";w.style.width=z+"px";t[s]||(t[s]=0);w.style.top=t[s]+"px";w.style.left=s*(p+f.a.tile.style.margin)+"px";t[s]=t[s]+y+f.a.tile.style.margin;w.appendChild(B);q.appendChild(w);s=(s+1)%r}c=1E4;for(u=0;u<t.length;u+=1)t[u]<c&&(c=t[u]);q.style.height=c+"px";b.appendChild(q);f.v.userAgent.match(/Mac OS X/)&&
(b.className=b.className+" "+f.a.k+"_embed_grid_scrolling_okay");return b},makeHeader:function(b,c,e,d){var p=f.v.endpoint.pinterest+c.href.split(".com")[1];c=f.f.make({SPAN:{className:f.a.k+"_embed_grid_hd"}});var q=f.f.avatar(b.data.user.image_small_url,p);f.f.set(q,f.a.dataAttributePrefix+"log",e);c.appendChild(q);d?(d=f.f.make({A:{className:f.a.k+"_embed_grid_first",innerHTML:f.f.filter(b.data.user.full_name),target:"_blank",href:p}}),d.style.width=f.v.renderedWidth-45+"px",f.f.set(d,f.a.dataAttributePrefix+
"log",e),c.appendChild(d),b=f.f.make({A:{className:f.a.k+"_embed_grid_second",innerHTML:f.f.filter(b.data.board.name),target:"_blank",href:p}})):b=f.f.make({A:{className:f.a.k+"_embed_grid_mid",innerHTML:f.f.filter(b.data.user.full_name),target:"_blank",href:p}});b.style.width=f.v.renderedWidth-45+"px";f.f.set(b,f.a.dataAttributePrefix+"log",e);c.appendChild(b);return c},makeFooter:function(b,c,e){var d;b=f.v.endpoint.pinterest+b.href.split(".com")[1];b=f.f.make({A:{className:f.a.k+"_embed_grid_ft",
href:b,target:"_blank"}});d=f.f.make({SPAN:{className:f.a.k+"_embed_grid_ft_logo"}});var p=f.v.strings;e&&f.a.strings[e]&&(p=f.a.strings[e]);f.v.renderedWidth>f.a.tile.minWidthToShowAuxText?(e=f.f.make({SPAN:{innerHTML:p.seeOn}}),p.seeOnTextAfterLogo?(b.appendChild(d),b.appendChild(e)):(b.appendChild(e),b.appendChild(d))):b.appendChild(d);f.f.set(b,f.a.dataAttributePrefix+"log",c);return b},cssHook:function(b,c){var e=f.f.getData(b,"css-hook");e&&(c.className=c.className+" "+e)},fireBookmark:function(){f.d.b.appendChild(f.f.make({SCRIPT:{type:"text/javascript",
charset:"utf-8",src:f.a.endpoint.bookmark+"?r="+99999999*Math.random()}}))},ping:{log:function(b,c){},count:function(b,c){var e=f.d.getElementById(f.a.k+"_pin_count_"+c);if(e){f.f.debug("API replied with count: "+b.count);var d=e.parentNode,p=f.f.getData(d,"config");0===b.count&&("above"===p?(f.f.debug("Rendering zero count above."),e.className=f.a.k+"_pin_it_button_count",e.appendChild(f.d.createTextNode("0"))):f.f.getData(d,"zero")?(f.f.debug("Zero pin count rendered to the side."),e.className=
f.a.k+"_pin_it_button_count",e.appendChild(f.d.createTextNode("0"))):f.f.debug("Zero pin count NOT rendered to the side."));0<b.count&&(f.f.debug("Got "+b.count+" pins for the requested URL."),"above"===p||"beside"===p?(f.f.debug("Rendering pin count "+p),e.className=f.a.k+"_pin_it_button_count",e.appendChild(f.d.createTextNode(f.f.prettyPinCount(b.count)))):f.f.debug("No valid pin count position specified; not rendering."));f.f.cssHook(d,e)}else f.f.debug("Pin It button container not found.")},pin:function(b,
c){var e=f.d.getElementById(f.a.k+"_"+c);if(e&&b.data&&b.data[0]){f.f.debug("API replied with pin data");var d=b.data[0],p={};d.images&&(p=d.images["237x"]);if(d&&d.id&&d.description&&p.url&&p.width&&p.height){f.f.debug("Found enough data to embed a pin");var q=f.v.strings,r=f.f.getData(e,"lang")||f.v.config.lang;f.a.strings[r]&&(q=f.a.strings[r]);var s=f.f.make({SPAN:{className:f.a.k+"_embed_pin","data-pin-id":d.id}});"plain"!==f.f.getData(e,"style")&&(s.className=s.className+" "+f.a.k+"_fancy");
var t=f.f.make({A:{className:f.a.k+"_embed_pin_link",title:d.description,href:f.v.endpoint.pinterest+"/pin/"+d.id+"/",target:"_blank"}}),u=f.f.make({IMG:{className:f.a.k+"_embed_pin_link_img",alt:d.description,nopin:"true",src:p.url,width:p.width,height:p.height}});f.f.set(u,f.a.dataAttributePrefix+"log","image_from_embedded_pin");f.f.set(u,f.a.dataAttributePrefix+"href",f.v.endpoint.pinterest+"/pin/"+d.id+"/");u.style.width=p.width+"px";u.style.height=p.height+"px";t.appendChild(u);p=f.a.k+"_repin";
"ja"===r&&(p+="_ja");r=f.f.make({I:{className:p,"data-pin-id":d.id}});f.f.set(r,f.a.dataAttributePrefix+"log","repin");f.f.set(r,f.a.dataAttributePrefix+"href",f.v.endpoint.repin.replace(/%s/,d.id));t.appendChild(r);r.onclick=function(){this.className.match(/hazClick/)||(this.className=this.className+" "+f.a.k+"_hazClick");var b=f.v.endpoint.repin.replace(/%s/,f.f.get(this,"data-pin-id"));f.w.open(b,"pin"+(new Date).getTime(),f.a.popLarge);return!1};r=f.f.make({I:{className:f.a.k+"_getThis",innerHTML:q.getThis+
"<i></i>","data-pin-id":d.id}});t.appendChild(r);r.onclick=function(){var b=f.f.get(this,"data-pin-id"),b=f.v.endpoint.builder+"#do_embed_pin&"+b;f.f.log("&type=getThis&href="+encodeURIComponent(b));f.w.open(b,"pin"+(new Date).getTime());return!1};f.f.set(t,f.a.dataAttributePrefix+"log","embed_pin");s.appendChild(t);t=f.f.make({SPAN:{className:f.a.k+"_embed_pin_desc",innerHTML:f.f.filter(d.description)}});d.attribution&&(d.attribution.url&&d.attribution.author_name&&d.attribution.provider_icon_url)&&
(f.f.debug("Building attribution line"),r=f.f.make({SPAN:{className:f.a.k+"_embed_pin_attrib"}}),r.appendChild(f.f.make({IMG:{className:f.a.k+"_embed_pin_attrib_icon",src:d.attribution.provider_icon_url}})),r.appendChild(f.f.make({SPAN:{className:f.a.k+"_embed_pin_attrib",innerHTML:q.attribTo+' <a href="'+d.attribution.url+'" target="_blank">'+f.f.filter(d.attribution.author_name)+"</a>"}})),t.appendChild(r));s.appendChild(t);d.pinner&&(d.pinner.profile_url&&d.pinner.image_small_url&&d.pinner.full_name)&&
(f.f.debug("Building pinner line"),d.pinner.profile_url=d.pinner.profile_url.replace(f.a.defaults.domain+".pinterest.com",f.v.endpoint.pinterest),t=f.f.make({A:{className:f.a.k+"_embed_pin_text",href:d.pinner.profile_url,target:"_blank"}}),t.appendChild(f.f.make({IMG:{className:f.a.k+"_embed_pin_text_avatar",src:d.pinner.image_small_url}})),t.appendChild(f.f.make({SPAN:{className:f.a.k+"_embed_pin_text_container",innerHTML:q.pinnedBy+' <em class="'+f.a.k+'_embed_pin_text_container_em">'+f.f.filter(d.pinner.full_name)+
"</em>"}})),r=f.f.make({B:{className:f.a.k+"_embed_pin_link_shield"}}),f.f.set(r,f.a.dataAttributePrefix+"log","pinner_from_embedded_pin"),f.f.set(r,f.a.dataAttributePrefix+"href",d.pinner.profile_url),t.appendChild(r),s.appendChild(t));d.board&&(d.board.url&&d.board.image_thumbnail_url&&d.board.name)&&(f.f.debug("Building board line"),d.board.url.match(/^(\/\/pinterest\.com|http:\/\/pinterest\.com|https:\/\/pinterest\.com)/)||(d.board.url=f.v.endpoint.pinterest+d.board.url,f.f.debug("appending Pinterest prefix to board URL")),
t=f.f.make({A:{className:f.a.k+"_embed_pin_text",href:d.board.url,target:"_blank"}}),t.appendChild(f.f.make({IMG:{className:f.a.k+"_embed_pin_text_avatar",src:d.board.image_thumbnail_url}})),t.appendChild(f.f.make({SPAN:{className:f.a.k+"_embed_pin_text_container",innerHTML:q.onto+' <em class="'+f.a.k+'_embed_pin_text_container_em">'+f.f.filter(d.board.name)+"</em>"}})),q=f.f.make({B:{className:f.a.k+"_embed_pin_link_shield"}}),f.f.set(q,f.a.dataAttributePrefix+"log","board_from_embedded_pin"),f.f.set(q,
f.a.dataAttributePrefix+"href",d.board.url),t.appendChild(q),s.appendChild(t));f.f.cssHook(e,s);f.f.replace(e,s)}else f.f.debug("Not enough data to embed a pin; aborting")}},user:function(b,c){var e=f.d.getElementById(f.a.k+"_"+c);if(e&&b.data&&b.data.pins&&b.data.pins.length){var d=f.f.getData(e,"lang")||f.v.config.lang;f.f.debug("API replied with a user");var p=f.f.make({SPAN:{className:f.a.k+"_embed_grid"}});"plain"!==f.f.getData(e,"style")&&(p.className=p.className+" "+f.a.k+"_fancy");var q=f.f.grid(e,
b.data.pins,"embed_user");if(q){var r=f.f.makeHeader(b,e,"embed_user");p.appendChild(r);p.appendChild(q);p.appendChild(f.f.makeFooter(e,"embed_user",d));f.f.cssHook(e,p);f.f.replace(e,p)}}},board:function(b,c){var e=f.d.getElementById(f.a.k+"_"+c);if(e&&b.data&&b.data.pins&&b.data.pins.length){f.f.debug("API replied with a group of pins");var d=f.f.getData(e,"lang")||f.v.config.lang,p=f.f.make({SPAN:{className:f.a.k+"_embed_grid"}});"plain"!==f.f.getData(e,"style")&&(p.className=p.className+" "+f.a.k+
"_fancy");var q=f.f.grid(e,b.data.pins,"embed_board");if(q){var r=f.f.makeHeader(b,e,"embed_board",!0);p.appendChild(r);p.appendChild(q);p.appendChild(f.f.makeFooter(e,"embed_board",d));f.f.cssHook(e,p);f.f.replace(e,p)}}}},parse:function(b,c){var e,d,f,q,r;r={};e=b.split("#")[0].split("?");if(e[1]){e=e[1].split("&");f=0;for(q=e.length;f<q;f+=1)d=e[f].split("="),2===d.length&&c[d[0]]&&(r[d[0]]=d[1])}return r},fixUrl:function(b){var c="";try{c=decodeURIComponent(b)}catch(e){}c===b&&(b=encodeURIComponent(b));
b.match(/^http/i)||(b.match(/^%2F%2F/i)||(b="%2F%2F"+b),b="http%3A"+b,f.f.debug("fixed URL: "+b));return b},deepLink:{ios_safari:function(b){var c,e,d,p;c=b.href;b=c.split("?")[1];b=b.replace(/url=/,"source_url=");b=b.replace(/media=/,"image_url=");b="pinit://pinit/?"+b;e=(new Date).getTime();d=0;p=function(){f.w.setTimeout(function(){if(10>d)p();else{var b=e+80*d;80>((new Date).getTime()-b)/10&&(f.w.location=c)}d+=1},80)};f.w.location=b;p()}},render:{buttonBookmark:function(b){f.f.debug("build bookmarklet button");
var c=f.f.getButtonConfig(b),e=f.a.k+"_pin_it_button_"+c.height+" "+f.a.k+"_pin_it_button_"+c.assets+"_"+c.height+"_"+c.color+" "+f.a.k+"_pin_it_button_inline_"+c.height;"round"===c.shape&&(e=f.a.k+"_pin_it_button_en_"+c.height+"_red_round "+f.a.k+"_pin_it_button_inline_en_"+c.height+"_red_round");e=f.f.make({A:{href:b.href,className:e}});(f.f.getData(b,"zero")||f.v.config.zero)&&f.f.set(e,f.a.dataAttributePrefix+"zero",!0);!0===f.a.config.pinItCountPosition[c.config]&&"rect"===c.shape?(f.f.set(e,
f.a.dataAttributePrefix+"config",c.config),e.className=e.className+" "+f.a.k+"_pin_it_"+c.config+"_"+c.height,c=f.f.make({SPAN:{className:f.a.k+"_hidden",id:f.a.k+"_pin_count_"+f.f.callback.length,innerHTML:"<i></i>"}}),e.appendChild(c),f.f.getPinCount(f.d.URL)):e.className=e.className+" "+f.a.k+"_pin_it_none";f.f.set(e,f.a.dataAttributePrefix+"log","button_pinit_bookmarklet");e.onclick=function(){f.f.fireBookmark();return!1};f.f.replace(b,e)},buttonPin:function(b){f.f.debug("build Pin It button");
var c=f.f.getButtonConfig(b),e=f.a.k+"_pin_it_button_"+c.height+" "+f.a.k+"_pin_it_button_"+c.assets+"_"+c.height+"_"+c.color+" "+f.a.k+"_pin_it_button_inline_"+c.height;"round"===c.shape&&(e=f.a.k+"_pin_it_button_en_"+c.height+"_red_round "+f.a.k+"_pin_it_button_inline_en_"+c.height+"_red_round");var d,p;p=f.f.parse(b.href,{url:!0,media:!0,description:!0});p.media?p.media=f.f.fixUrl(p.media):(p.media="",f.f.debug("no media found; click will pop bookmark"));p.url?p.url=f.f.fixUrl(p.url):(p.url=encodeURIComponent(f.d.URL),
f.f.debug("no url found; click will pin this page"));p.description||(p.description=encodeURIComponent(f.d.title||""));d=f.v.endpoint.create+"url="+p.url+"&media="+p.media+"&guid="+f.v.guid+"-"+f.v.buttonId+"&description="+p.description;f.v.buttonId+=1;e=f.f.make({A:{href:d,className:e,target:"_blank"}});f.f.set(e,f.a.dataAttributePrefix+"log","button_pinit");(f.f.getData(b,"zero")||f.v.config.zero)&&f.f.set(e,f.a.dataAttributePrefix+"zero",!0);d=f.f.getData(b,"config");!0===f.a.config.pinItCountPosition[d]?
(f.f.set(e,f.a.dataAttributePrefix+"config",d),e.className=e.className+" "+f.a.k+"_pin_it_"+c.config+"_"+c.height):e.className=e.className+" "+f.a.k+"_pin_it_none";p.url&&("rect"===c.shape&&(c=f.f.make({SPAN:{className:f.a.k+"_hidden",id:f.a.k+"_pin_count_"+f.f.callback.length,innerHTML:"<i></i>"}}),e.appendChild(c),f.f.getPinCount(p.url)),f.f.replace(b,e));e.onclick=function(){var b=f.f.parse(this.href,{url:!0,media:!0,description:!0});b.description||f.f.log("&type=config_warning&warning_msg=no_description&href="+
encodeURIComponent(f.d.URL));if(b.url&&b.url.match(/^http/i)&&b.media&&b.media.match(/^http/i))if(!f.v.config.shallow&&"function"===typeof f.f.deepLink[f.v.deepBrowser])f.f.deepLink[f.v.deepBrowser](this);else f.w.open(this.href,"pin"+(new Date).getTime(),f.a.pop);else f.f.log("&type=config_error&error_msg=invalid_url&href="+encodeURIComponent(f.d.URL)),f.f.fireBookmark();return!1}},buttonFollow:function(b){f.f.debug("build follow button");var c="_follow_me_button",e=f.f.getData(b,"render");e&&(c=
c+"_"+e);c=f.f.make({A:{target:"_blank",href:b.href,innerHTML:b.innerHTML,className:f.a.k+c}});c.appendChild(f.f.make({B:{}}));c.appendChild(f.f.make({I:{}}));f.f.set(c,f.a.dataAttributePrefix+"log","button_follow");f.f.replace(b,c)},embedPin:function(b){f.f.debug("build embedded pin");(b=b.href.split("/")[4])&&0<parseInt(b,10)&&f.f.getPinsIn("pin","",{pin_ids:b})},embedUser:function(b){f.f.debug("build embedded profile");(b=b.href.split("/")[3])&&f.f.getPinsIn("user",b+"/pins/")},embedBoard:function(b){f.f.debug("build embedded board");
var c=b.href.split("/")[3];b=b.href.split("/")[4];c&&b&&f.f.getPinsIn("board",c+"/"+b+"/pins/")}},getPinsIn:function(b,c,e){var d="",p="?",q;for(q in e)e[q].hasOwnProperty&&(d=d+p+q+"="+e[q],p="&");f.f.call(f.a.endpoint[b]+c+d,f.f.ping[b])},build:function(b){if("object"!==typeof b||null===b||!b.parentNode)b=f.d;var c=b.getElementsByTagName("A"),e,d,p,q={vertical:"above",horizontal:"beside"},r=[];e=0;for(b=c.length;e<b;e+=1)r.push(c[e]);e=0;for(b=r.length;e<b;e+=1)r[e].href&&r[e].href.match(f.a.myDomain)&&
(c=f.f.getData(r[e],"do"),!c&&r[e].href.match(/pin\/create\/button/)&&(c="buttonPin",p="none",(d=f.f.get(r[e],"count-layout"))&&q[d]&&(p=q[d]),f.f.set(r[e],"data-pin-config",p)),"function"===typeof f.f.render[c]&&(r[e].id=f.a.k+"_"+f.f.callback.length,f.f.render[c](r[e])))},config:function(){var b=f.d.getElementsByTagName("SCRIPT"),c,e,d;for(c=b.length-1;-1<c;c-=1)if(f.a.me&&b[c]&&b[c].src&&b[c].src.match(f.a.me)){for(e=0;e<f.a.configParam.length;e+=1)(d=f.f.get(b[c],f.a.dataAttributePrefix+f.a.configParam[e]))&&
(f.v.config[f.a.configParam[e]]=d);f.f.kill(b[c])}"string"===typeof f.v.config.build&&(f.w[f.v.config.build]=function(b){f.f.build(b)});f.w.setTimeout(function(){"string"===typeof f.v.config.logc?f.f.log("&type=pidget&logc="+f.v.config.logc,f.a.endpoint.logc):f.f.log("&type=pidget")},1E3)},setConfig:function(b){for(var c in b)f.v.config[c]=b[c]},log:function(b,c){encodeURIComponent(f.v.here)},langToDomain:function(b){var c,e,d,p,q,r;b||(b="en");b=b.toLowerCase();e=b.split("-");b=e[0];2===e.length&&
(c=e[1]);p=f.a.defaults.domain;q=f.a.defaults.lang;builderMatch="http://business.pinterest.com/widget-builder/";stringMatch=f.a.defaults.strings;assetMatch=f.a.defaults.assets;r=!1;for(d in f.a.domains)if(!r){e=f.a.domains[d];i=0;for(n=e.lang.length;i<n;i+=1)if(e.lang[i]===b||e.lang[i]===b+"-"+c)if(p=d,q=b,e.lang[i]===b+"-"+c){q=b+"-"+c;r=!0;break}}e=f.a.domains[p];e.assets&&(assetMatch=e.assets);e.strings&&f.a.strings[e.strings]&&(stringMatch=e.strings);e.builder&&(builderMatch="http://"+e.builder+
".business.pinterest.com/widget-builder/");return{lang:q,domain:p,builder:builderMatch,strings:stringMatch,assets:assetMatch}},init:function(b){f.d.b=f.d.getElementsByTagName("BODY")[0];if(f.d.b){f.d.h=f.d.getElementsByTagName("HEAD")[0];f.v={resolution:1,here:f.d.URL.split("#")[0],hazFloatingButton:!1,config:b,strings:f.a.strings.en,guid:"",buttonId:0,deepBrowser:null,protocol:f.w.location.protocol,userAgent:f.w.navigator.userAgent};"file:"===f.v.protocol&&(f.v.protocol="http:");for(var c in f.a.endpoint)f.a.endpoint[c]=
f.v.protocol+f.a.endpoint[c];null!==f.v.userAgent.match(/iP/)&&(null===f.v.userAgent.match(/Pinterest/)&&null===f.v.userAgent.match(/CriOS/))&&(f.v.deepBrowser="ios_safari");for(b=0;12>b;b+=1)f.v.guid+="0123456789ABCDEFGHJKLMNPQRSTUVWXYZ_abcdefghijkmnopqrstuvwxyz".substr(Math.floor(60*Math.random()),1);f.w.devicePixelRatio&&2<=f.w.devicePixelRatio&&(f.v.resolution=2);c=f.a.defaults.lang;if(f.v.config.lang&&"object"===typeof f.a.strings[f.v.config.lang])c=f.v.config.lang;else if(c=f.d.getElementsByTagName("HTML")[0].getAttribute("lang"),
!c){var e=f.d.getElementsByTagName("META");b=0;for(n=e.length;b<n;b+=1){var d=f.f.get(e[b],"http-equiv");if(d&&(d=d.toLowerCase(),"content-language"===d&&(d=f.f.get(e[b],"content")))){c=d.split("-")[0];break}}}f.v.config.lang&&(c=f.v.config.lang);b=f.f.langToDomain(c);f.v.config.assets=b.assets;f.v.config.lang=b.lang;f.v.endpoint={pinterest:"//"+b.domain+".pinterest.com",builder:b.builder,repin:"//"+b.domain+".pinterest.com/pin/%s/repin/x/",create:"//"+b.domain+".pinterest.com/pin/create/button/?"};
f.f.build();f.f.presentation();f.f.behavior()}}}}()};b.config.win.PINTEREST=f})(b.config.win,b.config.doc,{k:"PIN_"+(new Date).getTime(),myDomain:/^https?:\/\/(([a-z]{1,3})\.)?pinterest\.com\//,me:/pinit\.js$/,floatingButtonOffsetTop:10,floatingButtonOffsetLeft:10,endpoint:{bookmark:"//assets.pinterest.com/js/pinmarklet.js",count:"//widgets.pinterest.com/v1/urls/count.json",pin:"//widgets.pinterest.com/v3/pidgets/pins/info/",board:"//widgets.pinterest.com/v3/pidgets/boards/",user:"//widgets.pinterest.com/v3/pidgets/users/",
log:"//log.pinterest.com/",logc:"//logc.pinterest.com/"},config:{pinItCountPosition:{none:!0,above:!0,beside:!0}},minImgSize:119,countSource:6,dataAttributePrefix:"data-pin-",configParam:"build debug style hover logc shallow zero color height lang shape".split(" "),pop:"status=no,resizable=yes,scrollbars=yes,personalbar=no,directories=no,location=no,toolbar=no,menubar=no,width=632,height=270,left=0,top=0",popLarge:"status=no,resizable=yes,scrollbars=yes,personalbar=no,directories=no,location=no,toolbar=no,menubar=no,width=900,height=500,left=0,top=0",
cdn:{"https:":"https://s-passets.pinimg.com","http:":"http://passets.pinterest.com","file:":"http://passets.pinterest.com"},tile:{scale:{minWidth:60,minHeight:60,width:92,height:175},minWidthToShowAuxText:150,minContentWidth:120,minColumns:1,maxColumns:8,style:{margin:2,padding:10}},hazAssets:{en:!0,ja:!0},defaults:{domain:"www",strings:"en",lang:"en",assets:"en"},domains:{www:{lang:["en"],strings:"en",assets:"en"},br:{lang:["pt-br"],strings:"pt-br"},cz:{lang:["cs"],strings:"cs"},de:{lang:["de"],
strings:"de"},dk:{lang:["da"],strings:"da"},es:{lang:["es"],strings:"es"},fi:{lang:["fi"],strings:"fi"},fr:{lang:["fr"],strings:"fr",builder:"fr"},gb:{lang:["en-uk","en-gb","en-ie"],strings:"en",builder:"uk"},id:{lang:["id","in"],strings:"id"},it:{lang:["it"],strings:"it"},jp:{lang:["ja"],strings:"ja",builder:"ja",assets:"ja"},kr:{lang:["ko","kr"],strings:"ko"},nl:{lang:["nl"],strings:"nl"},no:{lang:["nb"],strings:"nb"},pl:{lang:["pl"],strings:"pl"},pt:{lang:["pt"],strings:"pt"},ru:{lang:["ru"],strings:"ru"},
sk:{lang:["sk"],strings:"sk"},se:{lang:["sv","sv-se"],strings:"sv"},tr:{lang:["tr"],strings:"tr"}},strings:{cs:{seeOn:"Zobrazit na",getThis:"st&#229;hnout",attribTo:"od",pinnedBy:"P&#345;upnul",onto:"Na"},da:{seeOn:"Se p&#229;",getThis:"hent den",attribTo:"af",pinnedBy:"Tilf&#248;jet af",onto:"P&#229;"},de:{seeOn:"Ansehen auf",getThis:"bekomme",attribTo:"von",pinnedBy:"Gepinnt von",onto:"Auf"},en:{seeOn:"See On",getThis:"get this",attribTo:"by",pinnedBy:"Pinned by",onto:"Onto"},"en-gb":{seeOn:"See On",
getThis:"get this",attribTo:"by",pinnedBy:"Pinned by",onto:"Onto"},"en-uk":{seeOn:"See On",getThis:"get this",attribTo:"by",pinnedBy:"Pinned by",onto:"Onto"},es:{seeOn:"Ver En",getThis:"obtener",attribTo:"por",pinnedBy:"Pineado por",onto:"En"},fi:{seeOn:"Katso palvelussa",getThis:"hanki",attribTo:"tekij&#228;",pinnedBy:"Lis&#228;&#228;j&#228;",onto:"tauluun"},fr:{seeOn:"Voir sur",getThis:"obtenir",attribTo:"par",pinnedBy:"&#201;pingl&#233; par",onto:"Sur"},id:{seeOn:"Lihat di",getThis:"dapatkan",
attribTo:"oleh",pinnedBy:"Dipin oleh",onto:"ke"},it:{seeOn:"Visualizza in",getThis:"scarica",attribTo:"da",pinnedBy:"Pinnato da",onto:"A"},ko:{seeOn:"&#45796;&#51020;&#50640;&#49436; &#48372;&#44592;",getThis:"&#45796;&#50868;&#47196;&#46300; &#54616;&#44592;",attribTo:"&#51060; &#54592;&#54632;",pinnedBy:"&#54592;&#54620; &#49324;&#46988;",onto:"&#50640;"},ja:{seeOn:"&#12391;&#35211;&#12427;",seeOnTextAfterLogo:!0,getThis:"&#24471;&#12427;",attribTo:"",pinnedBy:"&#12500;&#12531;&#12375;&#12383;&#20154;",
onto:"&#12508;&#12540;&#12489;"},nb:{seeOn:"Vis p&#229;",getThis:"hent den",attribTo:"av",pinnedBy:"Lagt til av",onto:"P&#229;"},nl:{seeOn:"Bekijken op",getThis:"krijg",attribTo:"door",pinnedBy:"Gepind door",onto:"Op"},pl:{seeOn:"Zobacz na",getThis:"pobierz",attribTo:"przez",pinnedBy:"Przypi&#281;te przez",onto:"Na"},pt:{seeOn:"Ver em",getThis:"obter",attribTo:"por",pinnedBy:"Pin afixado por",onto:"Em"},"pt-br":{seeOn:"Ver em",getThis:"obter",attribTo:"por",pinnedBy:"Pinado por",onto:"Em"},ru:{seeOn:"&#1055;&#1086;&#1089;&#1084;&#1086;&#1090;&#1088;&#1077;&#1090;&#1100; &#1074;",
getThis:"&#1087;&#1086;&#1083;&#1091;&#1095;&#1080;&#1090;&#1100;",attribTo:"&#1087;&#1086;&#1083;&#1100;&#1079;&#1086;&#1074;&#1072;&#1090;&#1077;&#1083;&#1077;&#1084;",pinnedBy:"&#1055;&#1088;&#1080;&#1082;&#1086;&#1083;&#1086;&#1090;&#1086;",onto:"&#1082;"},sk:{seeOn:"Zobrazi&#357; na",getThis:"stiahnu&#357;",attribTo:"od",pinnedBy:"Pripol",onto:"Na"},sv:{seeOn:"Visa p&#229;",getThis:"H&#228;mta",attribTo:"av",pinnedBy:"Tillagd av",onto:"P&#229;"},tr:{seeOn:"&#220;zerinde g&#246;r",getThis:"bunu al&#305;n",
attribTo:"taraf&#305;ndan",pinnedBy:"pinleyen",onto:"&#351;u panoya"}},rules:["a._pin_it_button_20 {  background-repeat: none; background-size: 40px 60px; height: 20px; margin: 0; padding: 0; vertical-align: baseline; text-decoration: none; width: 40px; background-position: 0 -20px }","a._pin_it_button_20:hover { background-position: 0 0px }","a._pin_it_button_20:active, a._pin_it_button_20._hazClick { background-position: 0 -40px }","a._pin_it_button_inline_20 { position: relative; display: inline-block; }",
"a._pin_it_button_floating_20 { position: absolute; }","a._pin_it_button_en_20_red { background-image: url(_cdn/images/pidgets/pinit_bg_en_rect_red_20__rez.png); }","a._pin_it_button_en_20_white { background-image: url(_cdn/images/pidgets/pinit_bg_en_rect_white_20__rez.png); }","a._pin_it_button_en_20_gray { background-image: url(_cdn/images/pidgets/pinit_bg_en_rect_gray_20__rez.png); }","a._pin_it_button_ja_20_red { background-image: url(_cdn/images/pidgets/pinit_bg_ja_rect_red_20__rez.png); }",
"a._pin_it_button_ja_20_white { background-image: url(_cdn/images/pidgets/pinit_bg_ja_rect_white_20__rez.png); }","a._pin_it_button_ja_20_gray { background-image: url(_cdn/images/pidgets/pinit_bg_ja_rect_gray_20__rez.png); }","a._pin_it_above_20 span._pin_it_button_count { background: transparent url(_cdn/images/pidgets/count_north_white_rect_20__rez.png) 0 0 no-repeat; background-size: 40px 29px; position: absolute; bottom: 21px; left: 0px; height: 29px; width: 40px; font: 12px Arial, Helvetica, sans-serif; line-height: 24px; text-indent: 0;}",
"a._pin_it_button_20 span._pin_it_button_count { position: absolute; color: #777; text-align: center; text-indent: 0; }","a._pin_it_beside_20 span._pin_it_button_count, a._pin_it_beside_20 span._pin_it_button_count i { background-color: transparent; background-repeat: no-repeat; background-image: url(_cdn/images/pidgets/count_east_white_rect_20__rez.png); }","a._pin_it_beside_20 span._pin_it_button_count { padding: 0 3px 0 10px; background-size: 45px 20px; background-position: 0 0; position: absolute; top: 0; left: 41px; height: 20px; font: 10px Arial, Helvetica, sans-serif; line-height: 20px; }",
"a._pin_it_beside_20 span._pin_it_button_count i { background-position: 100% 0; position: absolute; top: 0; right: -2px; height: 20px; width: 2px; }","a._pin_it_button_20._pin_it_above { margin-top: 20px; }","a._pin_it_button_28 { background-repeat: none; background-size: 56px 84px; height: 28px; margin: 0; padding: 0; vertical-align: baseline; text-decoration: none; width: 56px; background-position: 0 -28px }","a._pin_it_button_28:hover { background-position: 0 0px }","a._pin_it_button_28:active, a._pin_it_button_28._hazClick { background-position: 0 -56px }",
"a._pin_it_button_inline_28 { position: relative; display: inline-block; }","a._pin_it_button_floating_28 { position: absolute; }","a._pin_it_button_en_28_red { background-image: url(_cdn/images/pidgets/pinit_bg_en_rect_red_28__rez.png); }","a._pin_it_button_en_28_white { background-image: url(_cdn/images/pidgets/pinit_bg_en_rect_white_28__rez.png); }","a._pin_it_button_en_28_gray { background-image: url(_cdn/images/pidgets/pinit_bg_en_rect_gray_28__rez.png); }","a._pin_it_button_ja_28_red { background-image: url(_cdn/images/pidgets/pinit_bg_ja_rect_red_28__rez.png); }",
"a._pin_it_button_ja_28_white { background-image: url(_cdn/images/pidgets/pinit_bg_ja_rect_white_28__rez.png); }","a._pin_it_button_ja_28_gray { background-image: url(_cdn/images/pidgets/pinit_bg_ja_rect_gray_28__rez.png); }","a._pin_it_button_en_16_red_round, a._pin_it_button_en_32_red_round { background-repeat: none; margin: 0; padding: 0; vertical-align: baseline; text-decoration: none; }","a._pin_it_button_en_16_red_round { height: 16px; width: 16px; background-size: 16px 16px; background-image: url(_cdn/images/pidgets/pinit_bg_en_round_red_16__rez.png);}",
"a._pin_it_button_en_32_red_round { height: 32px; width: 32px; background-size: 32px 32px; background-image: url(_cdn/images/pidgets/pinit_bg_en_round_red_32__rez.png);}","a._pin_it_button_inline_en_16_red_round, a._pin_it_button_inline_en_32_red_round { position: relative; display: inline-block; }","a._pin_it_button_floating_en_16_red_round, a._pin_it_button_floating_en_32_red_round  { position: absolute; }","a._pin_it_button_28 span._pin_it_button_count { position: absolute; color: #777; text-align: center; text-indent: 0; }",
"a._pin_it_above_28 span._pin_it_button_count { background: transparent url(_cdn/images/pidgets/count_north_white_rect_28__rez.png) 0 0 no-repeat; background-size: 56px 37px; position: absolute; bottom: 29px; left: 0px; height: 37px; width: 56px; font: 15px Arial, Helvetica, sans-serif; line-height: 28px; text-indent: 0;}","a._pin_it_beside_28 span._pin_it_button_count, a._pin_it_beside_28 span._pin_it_button_count i { background-color: transparent; background-repeat: no-repeat; background-image: url(_cdn/images/pidgets/count_east_white_rect_28__rez.png); }",
"a._pin_it_beside_28 span._pin_it_button_count { padding: 0 3px 0 10px; background-size: 63px 28px; background-position: 0 0; position: absolute; top: 0; left: 57px; height: 28px; font: 12px Arial, Helvetica, sans-serif; line-height: 28px; }","a._pin_it_beside_28 span._pin_it_button_count i { background-position: 100% 0; position: absolute; top: 0; right: -2px; height: 28px; width: 2px; }","a._pin_it_button_28._pin_it_above { margin-top: 28px; }","a._follow_me_button, a._follow_me_button i { background-size: 200px 60px; background: transparent url(_cdn/images/pidgets/bfs_rez.png) 0 0 no-repeat }",
'a._follow_me_button { color: #444; display: inline-block; font: bold normal normal 11px/20px "Helvetica Neue",helvetica,arial,san-serif; height: 20px; margin: 0; padding: 0; position: relative; text-decoration: none; text-indent: 19px; vertical-align: baseline;}',"a._follow_me_button:hover { background-position: 0 -20px}","a._follow_me_button:active  { background-position: 0 -40px}","a._follow_me_button b { position: absolute; top: 3px; left: 3px; height: 14px; width: 14px; background-size: 14px 14px; background-image: url(_cdn/images/pidgets/log_rez.png); }",
"a._follow_me_button i { position: absolute; top: 0; right: -4px; height: 20px; width: 4px; background-position: 100% 0px; }","a._follow_me_button:hover i { background-position: 100% -20px;  }","a._follow_me_button:active i { background-position: 100% -40px; }","a._follow_me_button_tall, a._follow_me_button_tall i { background-size: 400px 84px; background: transparent url(_cdn/images/pidgets/bft_rez.png) 0 0 no-repeat }",'a._follow_me_button_tall { color: #444; display: inline-block; font: bold normal normal 13px/28px "Helvetica Neue",helvetica,arial,san-serif; height: 28px; margin: 0; padding: 0; position: relative; text-decoration: none; text-indent: 33px; vertical-align: baseline;}',
"a._follow_me_button_tall:hover { background-position: 0 -28px}","a._follow_me_button_tall:active  { background-position: 0 -56px}","a._follow_me_button_tall b { position: absolute; top: 5px; left: 10px; height: 18px; width: 18px; background-size: 18px 18px; background-image: url(_cdn/images/pidgets/smt_rez.png); }","a._follow_me_button_tall i { position: absolute; top: 0; right: -10px; height: 28px; width: 10px; background-position: 100% 0px; }","a._follow_me_button_tall:hover i { background-position: 100% -28px;  }",
"a._follow_me_button_tall:active i { background-position: 100% -56px; }","span._embed_pin { display: inline-block; text-align: center; width: 237px; overflow: hidden; vertical-align: top; }","span._embed_pin._fancy { background: #fff; box-shadow: 0 0 3px #aaa; border-radius: 3px; }","span._embed_pin a._embed_pin_link { display: block;  margin: 0 auto; padding: 0; position: relative;  line-height: 0}","span._embed_pin img { border: 0; margin: 0; padding: 0;}","span._embed_pin a._embed_pin_link i._repin { left: 10px; top: 10px; position: absolute; height: 33px; width: 64px; background-size: 64px 99px; background: transparent url(_cdn/images/pidgets/repin_rez.png) }",
"span._embed_pin a._embed_pin_link i._repin_ja { left: 10px; top: 10px; position: absolute; height: 33px; width: 64px; background-size: 64px 99px; background: transparent url(_cdn/images/pidgets/ja_repin_rez.png) }","span._embed_pin a._embed_pin_link i._repin:hover { background-position: 0 -33px; }","span._embed_pin a._embed_pin_link i._repin._hazClick { background-position: 0 -66px; }","span._embed_pin a._embed_pin_link i._getThis { display: none }","span._embed_pin a._embed_pin_link:hover i._getThis, span._embed_pin a._embed_pin_link:hover i._getThis i { background: transparent url(_cdn/images/pidgets/bfs1.png) }",
'span._embed_pin a._embed_pin_link:hover i._getThis { color: #555; display: inline-block; font: normal normal normal 11px/20px "Helvetica Neue",helvetica,arial,san-serif; height: 20px; margin: 0; padding: 0 1px 0 5px; position: absolute; bottom: 10px; right: 10px; text-decoration: none;  }',"span._embed_pin a._embed_pin_link:hover i._getThis:hover { background-position: 0 -20px }","span._embed_pin a._embed_pin_link:hover i._getThis i { position: absolute; top: 0; right: -4px; height: 20px; width: 5px; background-position: 100% 0px }",
"span._embed_pin a._embed_pin_link:hover i._getThis:hover i { background-position: 100% -20px }",'span._embed_pin span._embed_pin_desc { color: #333; white-space: normal; border-bottom: 1px solid #eee; display: block; font-family: "Helvetica Neue", arial, sans-serif; font-size: 12px; line-height: 17px; padding: 10px; text-align: left; }','span._embed_pin span._embed_pin_attrib, span._embed_pin span._embed_pin_text_container { color: #a7a7a7; font-family: "Helvetica", sans-serif; font-size: 10px; line-height: 18px; font-weight: bold; display: block;}',
"span._embed_pin span._embed_pin_attrib img._embed_pin_attrib_icon { height: 16px; width: 16px; vertical-align: middle; margin-right: 5px; float: left;}","span._embed_pin span._embed_pin_attrib a { color: #a7a7a7; text-decoration: none;}",'span._embed_pin a._embed_pin_text, span._embed_pin a._embed_pin_text span._embed_pin_text_container { position: relative; text-decoration: none; display: block; font-weight: bold; color: #b7b7b7; font-family: "Helvetica Neue", arial, sans-serif; font-size: 11px; line-height: 14px; height: 39px; text-align: left; }',
"span._embed_pin a._embed_pin_text { padding: 5px 0 0 7px; }","span._embed_pin a._embed_pin_text:hover { background: #eee;}","span._embed_pin a._embed_pin_text img._embed_pin_text_avatar { border-radius: 2px; overflow: hidden; height: 30px; width: 30px; vertical-align: middle; margin-right: 5px; float: left;}","span._embed_pin a._embed_pin_text span._embed_pin_text_container em._embed_pin_text_container_em { font-family: inherit; display: block; color: #717171; font-style: normal; width: 180px; text-overflow: ellipsis; overflow: hidden; white-space: nowrap; }",
"span._embed_pin a._embed_pin_text b._embed_pin_link_shield { position: absolute; top: 0; left: 0; height: 100%; width: 100%; }","span._embed_grid { display: inline-block; margin: 0; padding:10px 0; position: relative; text-align: center}","span._embed_grid._fancy { background: #fff; box-shadow: 0 0 3px #aaa; border-radius: 3px; }","span._embed_grid span._embed_grid_hd { display: block; margin: 0 10px; padding: 0; height: 45px; position: relative; background: #fff}","span._embed_grid span._embed_grid_hd a._avatar { position: absolute; top: 0; left: 0; height: 36px; width: 36px; }",
'span._embed_grid span._embed_grid_hd a._avatar::before { position: absolute; content:""; z-index: 2; top: 0; left: 0; right: 0; bottom: 0; box-shadow: inset 0 0 2px #888;  border-radius: 3px; }',"span._embed_grid span._embed_grid_hd a._avatar img { position: relative; height: 36px; width: 36px; margin: 0; padding: 0; border-radius: 3px; border: none;}","span._embed_grid span._embed_grid_hd a { text-decoration: none; background: transparent; cursor: pointer; white-space: nowrap; position: absolute; left: 44px; text-align: left; overflow: hidden; text-overflow: ellipsis; }",
"span._embed_grid span._embed_grid_hd a:hover { text-decoration: none; background: #fff; }","span._embed_grid span._embed_grid_hd a:active { text-decoration: none; background: #fff; }","span._embed_grid span._embed_grid_hd a._embed_grid_first { top: 2px; font-family: helvetica, sans-serif; font-weight: bold; color:#333; font-size: 14px; line-height: 16px; }","span._embed_grid span._embed_grid_hd a._embed_grid_second { bottom: 11px; font-family: helvetica, sans-serif; color:#8e8e8e; font-size: 12px; line-height: 14px; }",
"span._embed_grid span._embed_grid_hd a._embed_grid_mid { top: 12px; font-family: helvetica, sans-serif; font-weight: bold; color:#333; font-size: 14px; line-height: 16px; }","span._embed_grid span._embed_grid_bd { display:block; margin: 0 10px; border-radius: 2px; position: relative; overflow: hidden }","span._embed_grid span._embed_grid_scrolling_okay { overflow: auto; }","span._embed_grid span._embed_grid_bd span._embed_grid_ct { display:block; position: relative; overflow: hidden; }","span._embed_grid span._embed_grid_bd a._embed_grid_th { cursor: pointer; display: inline-block; position: absolute; overflow: hidden; }",
'span._embed_grid span._embed_grid_bd a._embed_grid_th::before { position: absolute; content:""; z-index: 2; top: 0; left: 0; right: 0; bottom: 0; box-shadow: inset 0 0 2px #888; }',"span._embed_grid span._embed_grid_bd a._embed_grid_th img._embed_grid_img { border: none; position: absolute; top: 50%; left: 0; }","a._embed_grid_ft { text-shadow: 0 1px #fff; display: block; text-align: center; border: 1px solid #ccc; margin: 10px 10px 0; height: 31px; line-height: 30px;border-radius: 2px; text-decoration: none; font-family: Helvetica; font-weight: bold; font-size: 13px; color: #746d6a; background: #f4f4f4 url(_cdn/images/pidgets/board_button_link.png) 0 0 repeat-x}",
"a._embed_grid_ft:hover { text-decoration: none; background: #fefefe url(_cdn/images/pidgets/board_button_hover.png) 0 0 repeat-x}","a._embed_grid_ft:active { text-decoration: none; background: #e4e4e4 url(_cdn/images/pidgets/board_button_active.png) 0 0 repeat-x}","a._embed_grid_ft span._embed_grid_ft_logo { vertical-align: top; display: inline-block; margin-left: 2px; height: 30px; width: 66px; background: transparent url(_cdn/images/pidgets/board_button_logo.png) 50% 48% no-repeat; }","._hidden { display:none; }"]})});
YUI.add("squarespace-blog-list-pagination",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.BlogListPagination=b.Base.create("BlogListPagination",b.Squarespace.Widgets.Pagination,[],{bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").delegate("click",function(b){b.target.siblings().removeClass("active");b.target.addClass("active");this.set("filter",b.target.getAttribute("data-filter"));b.halt()},"a[data-filter]",this);this.after("filterChange",this.syncUI,
this)},toggleNav:function(b){this.get("contentBox").one(".nav").toggleClass(this.getClassName("nav-hidden"),!b)},syncUI:function(){!this.get("hasNextPage")&&!this.get("hasPreviousPage")&&"all"===this.get("filter")?this.set("visible",!1):(this.set("visible",!0),this._prevEl.toggleClass("disabled",!this.get("hasPreviousPage")),this._nextEl.toggleClass("disabled",!this.get("hasNextPage")),this.set("className",""))}},{CSS_PREFIX:"sqs-pagination",TEMPLATE:'<span class="filters"><a href="#" data-filter="all">All</a><a href="#" data-filter="published">Published</a><a href="#" data-filter="draft">Draft</a></span><span class="nav"><span class="page-prev"></span><span class="page">Pages</span><span class="page-next"></span><span class="loading"></span></span>',
ATTRS:{filter:{value:"all"}}})},"1.0",{requires:["base","squarespace-pagination"]});
YUI.add("squarespace-dialog-email-service-connect-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-email-service-connect.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p=this.escapeExpression;h=d.blockHelperMissing;b='<div class="sqs-content-inner">\n\n  <div class="text">\n    ';l={hash:{},inverse:this.noop,fn:this.programWithDepth(1,function(b,c,e){var f,h;f='\n      <div class="title">';
(h=d.title)?h=h.call(b,{hash:{},data:c}):(h=b.title,h="function"===typeof h?h.apply(b):h);return f+=p(h)+'</div>\n      <div class="message">Sending to <span class="connected-email">'+p((h=(h=e.data,null==h||!1===h?h:h.email),"function"===typeof h?h.apply(b):h))+"</span></div>\n    "},k,c),data:k};(k=d.strings)?k=k.call(c,l):(k=c.strings,k="function"===typeof k?k.apply(c):k);d.strings||(k=h.call(c,k,l));if(k||0===k)b+=k;return b+'\n  </div>\n\n  <div class="fields"></div>\n\n  <div class="connect">Connect</div>\n  <div class="icon"></div>\n\n</div>\n'})})();
b.Handlebars.registerPartial("dialog-email-service-connect.html".replace("/","."),d.templates["dialog-email-service-connect.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-connected-accounts",function(b){b.namespace("Squarespace.Models");var d=b.Base.create("ConnectedAccounts",b.ModelList,[b.Squarespace.ModelSync.REST,b.Squarespace.ModelListParse],{model:b.Squarespace.Models.ConnectedAccount},{ATTRS:{websiteId:{value:null}}});b.Squarespace.Models.ConnectedAccounts=d;b=b.Squarespace.Singletons.ConnectedAccounts=new b.Squarespace.Models.ConnectedAccounts({websiteId:b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]),items:Static.SQUARESPACE_CONTEXT.connectedAccounts||
[]});b.comparator=function(b){return"dropbox"===b.get("serviceName")?0:b.get("addedOn")};b.sort()},"1.0",{requires:"base model model-list squarespace-model-sync-rest squarespace-models-connected-account squarespace-model-list-parse squarespace-util".split(" ")});
YUI.add("squarespace-block-mixin-splitable",function(b){b.namespace("Squarespace.Block.Mixin").Splitable=b.Base.create("block-splitable",b.Base,[],{initializer:function(){this._host.get("editController").set("contentParentBlockSelector","."+this._host.getClassName())},split:function(b,c){var e=b.ancestor().get("children"),f=!1;if(!b.ancestor(".sqs-block")||b.ancestor(".sqs-block")!==this._bb)f=!0;var g="",h="";e.each(function(c,e){f?h+=c.getDOMNode().outerHTML:(c===b&&(f=!0),g+=c.getDOMNode().outerHTML)},
this);0<h.length&&(e=new this._host.constructor({editable:this._host.get("editable"),render:!1,isNewBlock:!1,editMode:this._host.get("editMode"),editorConfig:{defaultEditingMode:!1},editController:this._host.get("editController")}),e.render(this._bb.ancestor(".sqs-layout")),e.blockEditor.insertContentIntoModel(h),e.syncUI(),this.insertContentIntoModel(g),this._host.syncUI(),this._bb.insert(e.get("boundingBox"),"after"),this._bb.ancestor(".sqs-layout").LayoutBuilder.registerBlock(e));this._bb.insert(c,
"after")},insertContentIntoModel:function(b){throw Error("Splitable requires insertContentIntoModel method implementation");},getBlockLevelElements:function(){var b=this.get("selectorsForInsertPoints");return this._cb.get("children").filter(b)},getOverlays:function(){return this._host.get("boundingBox").all(".sqs-content-overlay")},_initLayoutDrop:noop,_updateDropOverlays:function(){if(!this.get("destroyed")){var d=b.DD.DDM.activeDrag;if(d&&d.get("node").inDoc(b.config.doc)&&d.get("node")!==this._bb){this.overlays&&
this.overlays.length&&this._destroyDropOverlays();this.overlays=[];var c=this.getBlockLevelElements();1>c.size()&&(c=b.all(this._bb));this.overlays=b.Array.map(this._addOverlayDOMNodes(c),function(e,d){var g=c.item(d);return{node:b.one(e),alignNode:g,regionData:this._getRegionData(g,c.item(d-1),c.item(d+1)),drop:null}},this);this._positionOverlayNodes()}}},_addOverlayDOMNodes:function(d){d=d.size();for(var c=[];0<d--;)c.push(b.DOM.create('<div class="sqs-content-overlay">'));this._bb.append(c);return c},
_getRegionData:function(b,c,e){var f=this._bb.get("region");this.get("selectorsForInsertPoints");var g=e?e.get("region"):{},h=c?c.get("region"):{};b=b.get("region");var k=c?b.top:f.top;h.height&&(k-=(k-h.bottom)/2);h=e?b.bottom:f.bottom;g.height&&(h+=(g.top-b.bottom)/2);return{height:h-k,top:k-f.top,isFirstContent:!c,isLastContent:!e}},_positionOverlayNodes:function(){b.Array.each(this.overlays,function(d){var c=d.node,e=d.regionData;c.setData("alignNode",d.alignNode);c.setData("isAdjacentToBlockEdge",
{top:e.isFirstContent,bottom:e.isLastContent});c.setStyles({top:e.top,height:e.height});this.get("lockedLayout")||(d.drop=new b.Squarespace.Layout.Drop({node:c,groups:["blocks"],locked:!1}));c.on("click",this._destroyDropOverlays,this)},this)},_destroyDropOverlays:function(){this.overlays&&(b.Array.each(this.overlays,function(d){b.Lang.isValue(d.drop)&&d.drop.destroy();d.node.detach();d.node.remove(!0)}),delete this.overlays)},beforeLayoutDrag:function(){this._updateDropOverlays()},afterLayoutDrag:function(){this._destroyDropOverlays()},
_afterDropZoneLockedChange:function(d){b.Array.each(this._overlays,function(b){b.drop.set("lock",d.newVal)});d.newVal?this._destroyDropOverlays():this._updateDropOverlays()},destructor:function(){this._destroyDropOverlays()}},{ATTRS:{selectorsForInsertPoints:{valueFn:function(){return b.Array.map("p ul ol blockquote h1 h2 h3 h4 h5 h6".split(" "),function(b){return".sqs-block-content > "+b+", .sqs-html-content > "+b}).join(", ")}}}})},"1.0",{requires:["base","node","widget"]});
YUI.add("squarespace-block-tourdates",function(b){var d=b.namespace("Squarespace.Block").TourDates=b.Base.create("block-tourdates",b.Squarespace.Block.ModelSyncBase,[],{bindUI:function(){this.get("model").after("save",this._renderSuccess,this);this.after("resized",function(){this.tourdatesBlock&&this.tourdatesBlock.adjustLayout()},this)},_renderSuccess:function(c){d.superclass._renderSuccess.call(this,c);c=this.get("model");c.get("artistId")&&(this.tourdatesBlock=new b.Squarespace.Widgets.BandsInTownTourDatesList(c.getAttrs(["artistId",
"timeframe","startDate","endDate"])),this.tourdatesBlock.render(this.get("contentBox")))},_getDefaultContent:function(){var b=new Date,e=(new Date(b.getFullYear(),b.getMonth()-1,1)).getTime(),b=(new Date(b.getFullYear(),b.getMonth()+2,1)).getTime();return{artistId:"",timeframe:"upcoming",startDate:e,endDate:b}}},{MODEL:b.Squarespace.ContentModel.TourDatesBlock,CSS_PREFIX:"sqs-block-tourdates",ATTRS:{defaultContentModel:{valueFn:"_getDefaultContent"},editor:{value:b.Squarespace.Block.Editor.TourDates},
type:{value:b.Squarespace.BlockType.TOURDATES}}})},"1.0",{requires:"base model squarespace-block-base-modelsync squarespace-block-tourdates-editor squarespace-block-utils squarespace-enum".split(" ")});YUI.add("squarespace-block-product-model",function(b){b.namespace("Squarespace.ContentModel").ProductBlock=b.Base.create("ProductModel",b.Model,[],{},{ATTRS:{showImage:{value:!0}}})},"1.0",{requires:["base","model"]});
YUI.add("squarespace-content-item-types-audio",function(b){var d=b.namespace("Squarespace.ContentItemEditor").Audio=b.Base.create("AudioContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{_dialogOnReady:function(){d.superclass._dialogOnReady.call(this);var b=this.get("dialog").getField("audioTrack");b.on("dataChange",function(b){b.newVal&&this._bindListenersToAudioItem(b.newVal)},this);this._bindListenersToAudioItem(b.get("data"));this._bindFileUploadBehaviors("audioTrack")},_bindListenersToAudioItem:function(b){var e=
this.get("dialog");b.on("titleChange",function(b){var c=e.getField("title");c&&""===c.get("data").trim()&&c.set("data",b.newVal)},this);b.get("structuredContent").on("artistNameChange",function(b){var c=e.getField("artistName");c&&""===c.get("data").trim()?c.set("data",b.newVal):c||console.warn("Could not set artistName field, tried to set new data `"+b.newVal+"`.")},this)},getDialogData:function(){var b=d.superclass.getDialogData.call(this);b.audioTrack=this.get("model");b.artistName=b.structuredContent.artistName;
return b},sanitizeDialogData:function(c){var e=d.superclass.sanitizeDialogData.call(this,c);b.Array.each("systemDataId systemDataOrigin mediaProcessingState systemDataSourceType systemDataVariants filename".split(" "),function(b){e[b]=e.audioTrack?e.audioTrack.get(b):null});c={};e.audioTrack&&(c=e.audioTrack.get("structuredContent").toJSON());e.structuredContent=b.merge(c,{artistName:e.artistName});delete e.audioTrack;delete e.mediaProcessingState;return e}},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",
width:800,height:450,overlay:0.5,tabs:[{$include:["tabs.primary.base","tabs.primary.audio"]},{$include:"tabs.options.audio"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-block-content-base",function(b){var d=b.namespace("Squarespace.Content").ContentBase=function(){b.before(this._bindUIBlock,this,"bindUI");b.before(this._syncUIBlock,this,"syncUI")};d.prototype={_bindUIBlock:function(){this.after("editableChange",this.syncUI,this)},_syncUIBlock:function(){this.syncEditable()},syncEditable:function(){var c=this.get("editable"),e=this.get("editor");b.Lang.isValue(e)&&(c&&!this.hasPlugin(e.NS)?this.plug(e):!c&&this.hasPlugin(e.NS)&&this.unplug(e))},
toJSON:function(){var b=this.get("model").toJSON();delete b.id;return b},destructor:function(){this.unplug()},_onDocFocus:function(){}};d.ATTRS={tabIndex:{value:null},editable:{value:!1,lazyAdd:!1}}},"1.0",{requires:[]});
YUI.add("text-data-wordbreak",function(b,d){b.namespace("Text.Data").WordBreak={aletter:"[A-Za-z\u00aa\u00b5\u00ba\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02c1\u02c6-\u02d1\u02e0-\u02e4\u02ec\u02ee\u0370-\u0374\u0376\u0377\u037a-\u037d\u0386\u0388-\u038a\u038c\u038e-\u03a1\u03a3-\u03f5\u03f7-\u0481\u048a-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05d0-\u05ea\u05f0-\u05f3\u0620-\u064a\u066e\u066f\u0671-\u06d3\u06d5\u06e5\u06e6\u06ee\u06ef\u06fa-\u06fc\u06ff\u0710\u0712-\u072f\u074d-\u07a5\u07b1\u07ca-\u07ea\u07f4\u07f5\u07fa\u0800-\u0815\u081a\u0824\u0828\u0840-\u0858\u0904-\u0939\u093d\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097f\u0985-\u098c\u098f\u0990\u0993-\u09a8\u09aa-\u09b0\u09b2\u09b6-\u09b9\u09bd\u09ce\u09dc\u09dd\u09df-\u09e1\u09f0\u09f1\u0a05-\u0a0a\u0a0f\u0a10\u0a13-\u0a28\u0a2a-\u0a30\u0a32\u0a33\u0a35\u0a36\u0a38\u0a39\u0a59-\u0a5c\u0a5e\u0a72-\u0a74\u0a85-\u0a8d\u0a8f-\u0a91\u0a93-\u0aa8\u0aaa-\u0ab0\u0ab2\u0ab3\u0ab5-\u0ab9\u0abd\u0ad0\u0ae0\u0ae1\u0b05-\u0b0c\u0b0f\u0b10\u0b13-\u0b28\u0b2a-\u0b30\u0b32\u0b33\u0b35-\u0b39\u0b3d\u0b5c\u0b5d\u0b5f-\u0b61\u0b71\u0b83\u0b85-\u0b8a\u0b8e-\u0b90\u0b92-\u0b95\u0b99\u0b9a\u0b9c\u0b9e\u0b9f\u0ba3\u0ba4\u0ba8-\u0baa\u0bae-\u0bb9\u0bd0\u0c05-\u0c0c\u0c0e-\u0c10\u0c12-\u0c28\u0c2a-\u0c33\u0c35-\u0c39\u0c3d\u0c58\u0c59\u0c60\u0c61\u0c85-\u0c8c\u0c8e-\u0c90\u0c92-\u0ca8\u0caa-\u0cb3\u0cb5-\u0cb9\u0cbd\u0cde\u0ce0\u0ce1\u0cf1\u0cf2\u0d05-\u0d0c\u0d0e-\u0d10\u0d12-\u0d3a\u0d3d\u0d4e\u0d60\u0d61\u0d7a-\u0d7f\u0d85-\u0d96\u0d9a-\u0db1\u0db3-\u0dbb\u0dbd\u0dc0-\u0dc6\u0f00\u0f40-\u0f47\u0f49-\u0f6c\u0f88-\u0f8c\u10a0-\u10c5\u10d0-\u10fa\u10fc\u1100-\u1248\u124a-\u124d\u1250-\u1256\u1258\u125a-\u125d\u1260-\u1288\u128a-\u128d\u1290-\u12b0\u12b2-\u12b5\u12b8-\u12be\u12c0\u12c2-\u12c5\u12c8-\u12d6\u12d8-\u1310\u1312-\u1315\u1318-\u135a\u1380-\u138f\u13a0-\u13f4\u1401-\u166c\u166f-\u167f\u1681-\u169a\u16a0-\u16ea\u16ee-\u16f0\u1700-\u170c\u170e-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176c\u176e-\u1770\u1820-\u1877\u1880-\u18a8\u18aa\u18b0-\u18f5\u1900-\u191c\u1a00-\u1a16\u1b05-\u1b33\u1b45-\u1b4b\u1b83-\u1ba0\u1bae\u1baf\u1bc0-\u1be5\u1c00-\u1c23\u1c4d-\u1c4f\u1c5a-\u1c7d\u1ce9-\u1cec\u1cee-\u1cf1\u1d00-\u1dbf\u1e00-\u1f15\u1f18-\u1f1d\u1f20-\u1f45\u1f48-\u1f4d\u1f50-\u1f57\u1f59\u1f5b\u1f5d\u1f5f-\u1f7d\u1f80-\u1fb4\u1fb6-\u1fbc\u1fbe\u1fc2-\u1fc4\u1fc6-\u1fcc\u1fd0-\u1fd3\u1fd6-\u1fdb\u1fe0-\u1fec\u1ff2-\u1ff4\u1ff6-\u1ffc\u2071\u207f\u2090-\u209c\u2102\u2107\u210a-\u2113\u2115\u2119-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2139\u213c-\u213f\u2145-\u2149\u214e\u2160-\u2188\u24b6-\u24e9\u2c00-\u2c2e\u2c30-\u2c5e\u2c60-\u2ce4\u2ceb-\u2cee\u2d00-\u2d25\u2d30-\u2d65\u2d6f\u2d80-\u2d96\u2da0-\u2da6\u2da8-\u2dae\u2db0-\u2db6\u2db8-\u2dbe\u2dc0-\u2dc6\u2dc8-\u2dce\u2dd0-\u2dd6\u2dd8-\u2dde\u2e2f\u3005\u303b\u303c\u3105-\u312d\u3131-\u318e\u31a0-\u31ba\ua000-\ua48c\ua4d0-\ua4fd\ua500-\ua60c\ua610-\ua61f\ua62a\ua62b\ua640-\ua66e\ua67f-\ua697\ua6a0-\ua6ef\ua717-\ua71f\ua722-\ua788\ua78b-\ua78e\ua790\ua791\ua7a0-\ua7a9\ua7fa-\ua801\ua803-\ua805\ua807-\ua80a\ua80c-\ua822\ua840-\ua873\ua882-\ua8b3\ua8f2-\ua8f7\ua8fb\ua90a-\ua925\ua930-\ua946\ua960-\ua97c\ua984-\ua9b2\ua9cf\uaa00-\uaa28\uaa40-\uaa42\uaa44-\uaa4b\uab01-\uab06\uab09-\uab0e\uab11-\uab16\uab20-\uab26\uab28-\uab2e\uabc0-\uabe2\uac00-\ud7a3\ud7b0-\ud7c6\ud7cb-\ud7fb\ufb00-\ufb06\ufb13-\ufb17\ufb1d\ufb1f-\ufb28\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40\ufb41\ufb43\ufb44\ufb46-\ufbb1\ufbd3-\ufd3d\ufd50-\ufd8f\ufd92-\ufdc7\ufdf0-\ufdfb\ufe70-\ufe74\ufe76-\ufefc\uff21-\uff3a\uff41-\uff5a\uffa0-\uffbe\uffc2-\uffc7\uffca-\uffcf\uffd2-\uffd7\uffda-\uffdc]",midnumlet:"['\\.\u2018\u2019\u2024\ufe52\uff07\uff0e]",
midletter:"[:\u00b7\u00b7\u05f4\u2027\ufe13\ufe55\uff1a]",midnum:"[,;;\u0589\u060c\u060d\u066c\u07f8\u2044\ufe10\ufe14\ufe50\ufe54\uff0c\uff1b]",numeric:"[0-9\u0660-\u0669\u066b\u06f0-\u06f9\u07c0-\u07c9\u0966-\u096f\u09e6-\u09ef\u0a66-\u0a6f\u0ae6-\u0aef\u0b66-\u0b6f\u0be6-\u0bef\u0c66-\u0c6f\u0ce6-\u0cef\u0d66-\u0d6f\u0e50-\u0e59\u0ed0-\u0ed9\u0f20-\u0f29\u1040-\u1049\u1090-\u1099\u17e0-\u17e9\u1810-\u1819\u1946-\u194f\u19d0-\u19d9\u1a80-\u1a89\u1a90-\u1a99\u1b50-\u1b59\u1bb0-\u1bb9\u1c40-\u1c49\u1c50-\u1c59\ua620-\ua629\ua8d0-\ua8d9\ua900-\ua909\ua9d0-\ua9d9\uaa50-\uaa59\uabf0-\uabf9]",
cr:"\\r",lf:"\\n",newline:"[\x0B\f\u0085\u2028\u2029]",extend:"[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065f\u0670\u06d6-\u06dc\u06df-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0859-\u085b\u0900-\u0903\u093a-\u093c\u093e-\u094f\u0951-\u0957\u0962\u0963\u0981-\u0983\u09bc\u09be-\u09c4\u09c7\u09c8\u09cb-\u09cd\u09d7\u09e2\u09e3\u0a01-\u0a03\u0a3c\u0a3e-\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81-\u0a83\u0abc\u0abe-\u0ac5\u0ac7-\u0ac9\u0acb-\u0acd\u0ae2\u0ae3\u0b01-\u0b03\u0b3c\u0b3e-\u0b44\u0b47\u0b48\u0b4b-\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe-\u0bc2\u0bc6-\u0bc8\u0bca-\u0bcd\u0bd7\u0c01-\u0c03\u0c3e-\u0c44\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0c82\u0c83\u0cbc\u0cbe-\u0cc4\u0cc6-\u0cc8\u0cca-\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d02\u0d03\u0d3e-\u0d44\u0d46-\u0d48\u0d4a-\u0d4d\u0d57\u0d62\u0d63\u0d82\u0d83\u0dca\u0dcf-\u0dd4\u0dd6\u0dd8-\u0ddf\u0df2\u0df3\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f3e\u0f3f\u0f71-\u0f84\u0f86\u0f87\u0f8d-\u0f97\u0f99-\u0fbc\u0fc6\u102b-\u103e\u1056-\u1059\u105e-\u1060\u1062-\u1064\u1067-\u106d\u1071-\u1074\u1082-\u108d\u108f\u109a-\u109d\u135d-\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b6-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u192b\u1930-\u193b\u19b0-\u19c0\u19c8\u19c9\u1a17-\u1a1b\u1a55-\u1a5e\u1a60-\u1a7c\u1a7f\u1b00-\u1b04\u1b34-\u1b44\u1b6b-\u1b73\u1b80-\u1b82\u1ba1-\u1baa\u1be6-\u1bf3\u1c24-\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce8\u1ced\u1cf2\u1dc0-\u1de6\u1dfc-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2d7f\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua823-\ua827\ua880\ua881\ua8b4-\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua953\ua980-\ua983\ua9b3-\ua9c0\uaa29-\uaa36\uaa43\uaa4c\uaa4d\uaa7b\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe3-\uabea\uabec\uabed\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]",
format:"[\u00ad\u0600-\u0603\u06dd\u070f\u17b4\u17b5\u200e\u200f\u202a-\u202e\u2060-\u2064\u206a-\u206f\ufeff\ufff9-\ufffb]",katakana:"[\u3031-\u3035\u309b\u309c\u30a0-\u30fa\u30fc-\u30ff\u31f0-\u31ff\u32d0-\u32fe\u3300-\u3357\uff66-\uff9d]",extendnumlet:"[_\u203f\u2040\u2054\ufe33\ufe34\ufe4d-\ufe4f\uff3f]",punctuation:"[!-#%-*,-\\/:;?@\\[-\\]_{}\u00a1\u00ab\u00b7\u00bb\u00bf;\u00b7\u055a-\u055f\u0589\u058a\u05be\u05c0\u05c3\u05c6\u05f3\u05f4\u0609\u060a\u060c\u060d\u061b\u061e\u061f\u066a-\u066d\u06d4\u0700-\u070d\u07f7-\u07f9\u0830-\u083e\u085e\u0964\u0965\u0970\u0df4\u0e4f\u0e5a\u0e5b\u0f04-\u0f12\u0f3a-\u0f3d\u0f85\u0fd0-\u0fd4\u0fd9\u0fda\u104a-\u104f\u10fb\u1361-\u1368\u1400\u166d\u166e\u169b\u169c\u16eb-\u16ed\u1735\u1736\u17d4-\u17d6\u17d8-\u17da\u1800-\u180a\u1944\u1945\u1a1e\u1a1f\u1aa0-\u1aa6\u1aa8-\u1aad\u1b5a-\u1b60\u1bfc-\u1bff\u1c3b-\u1c3f\u1c7e\u1c7f\u1cd3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205e\u207d\u207e\u208d\u208e\u3008\u3009\u2768-\u2775\u27c5\u27c6\u27e6-\u27ef\u2983-\u2998\u29d8-\u29db\u29fc\u29fd\u2cf9-\u2cfc\u2cfe\u2cff\u2d70\u2e00-\u2e2e\u2e30\u2e31\u3001-\u3003\u3008-\u3011\u3014-\u301f\u3030\u303d\u30a0\u30fb\ua4fe\ua4ff\ua60d-\ua60f\ua673\ua67e\ua6f2-\ua6f7\ua874-\ua877\ua8ce\ua8cf\ua8f8-\ua8fa\ua92e\ua92f\ua95f\ua9c1-\ua9cd\ua9de\ua9df\uaa5c-\uaa5f\uaade\uaadf\uabeb\ufd3e\ufd3f\ufe10-\ufe19\ufe30-\ufe52\ufe54-\ufe61\ufe63\ufe68\ufe6a\ufe6b\uff01-\uff03\uff05-\uff0a\uff0c-\uff0f\uff1a\uff1b\uff1f\uff20\uff3b-\uff3d\uff3f\uff5b\uff5d\uff5f-\uff65]"}},
"3.17.2",{requires:["yui-base"]});
YUI.add("squarespace-drag-selection-selector-blacklist",function(b){b.namespace("Squarespace").DragSelectionSelectorBlackList=b.Base.create("dragSelectionSelectorBlackList",b.Base,[],{_getInvalidRegions:function(b){return b.concat(this.get("selectorBlacklist"))}},{ATTRS:{invalidRegions:{value:[],getter:"_getInvalidRegions"},selectorBlacklist:{valueFn:function(){var d=".dialog-screen-overlay;.mode-visual;.mode-source;.content-title .add-content;.config-panel-wrapper;input;object;.dropdown select;.sqs-disable-drag-selection".split(";");b.Squarespace.STANDARD_CONTROL_CLASSES&&
(d=d.concat(b.Squarespace.STANDARD_CONTROL_CLASSES));d=b.Array.dedupe(d);d.remove(".standard-dialog-wrapper");return d}}}})},"1.0",{requires:["base-build"]});
YUI.add("squarespace-dialog-xero-default-account-creator",function(b){var d={type:b.Squarespace.XeroAccountTypes.REVENUE,code:410,name:'"On Sale" Discounts',description:"Discounts taken from placing products On Sale in Squarespace Commerce."},c={type:b.Squarespace.XeroAccountTypes.REVENUE,code:411,name:"Coupon Discounts",description:"Discounts taken from applying coupons to orders in Squarespace Commerce."},e={type:b.Squarespace.XeroAccountTypes.CURRENT_ASSET,code:121,name:"Credit Card Receivable",
enablePayments:!0,description:"Funds owed to your business for credit card purchases made in Squarespace Commerce."};ACCOUNT_TPL='<div class="account-creator-account"><ul><li><span class="account-creator-label">Account Type:</span> <span class="account-creator-value">{humanType}</span><span class="missing-in-xero-badge">Missing</span></li><li><span class="account-creator-label">Code:</span> <span class="account-creator-value account-creator-code">Loading...</span></li><li><span class="account-creator-label">Name:</span> <span class="account-creator-value">{name}</span></li><li><span class="account-creator-label">Description:</span> <span class="account-creator-value">{description}</span></li>{enablePaymentsRow}</ul><div class="account-creator-create"></div></div>';
ENABLE_PAYMENTS_TPL='<li><span class="account-creator-label">Enable payments to this account:</span> <span class="account-creator-value">&#x2713;</span></li>';b.namespace("Squarespace.DialogFields").XeroDefaultAccountCreator=b.Base.create("xeroDefaultAccountCreator",b.Squarespace.DialogField2,[],{initializer:function(){this._defaultAccounts=new b.Squarespace.Models.XeroAccountList({items:[d,c,e]});this.publish("allAccountsPresent");this.publish("accountsMissing")},renderUI:function(){var c=this._defaultAccounts.size();
this._defaultAccounts.each(function(b,e){this._renderAccount(b,e===c-1)},this);this.get("contentBox").addClass("clear").plug(b.Squarespace.Plugins.LoadingOverlay,{spinnerConfig:{size:"extra-large",color:"light"}})},bindUI:function(){var b=this.get("xeroAccounts");this._defaultAccounts.after("*:save",b.load,b);this._defaultAccounts.after("*:save",this._clearAccountId);this._defaultAccounts.after("*:error",this._errorNotify,this);this.get("xeroAccounts").on("load",this._ensureUniqueCodes,this);this.get("xeroAccounts").after("load",
this.syncUI,this);this.get("xeroAccounts").after("load",this._notifyIfAllPresent,this)},syncUI:function(){var b=this.get("xeroAccounts"),c=this.get("contentBox");c.all(".account-creator-account").each(function(c,e){var d=this._defaultAccounts.item(e),g=d.get("code"),d=d.get("name");this.get("rendered")&&c.one(".account-creator-code").setHTML(g);b.isEmpty()||(g=null===b.findAccountByName(d),c.toggleClass("account-creator-missing-from-xero",g))},this);b.isEmpty()||c.loadingOverlay.set("visible",!1)},
_ensureUniqueCodes:function(){var b=this.get("xeroAccounts");this._defaultAccounts.each(function(c){if(null===b.findAccountByName(c.get("name")))for(;!this._hasUniqueCode(c);)c.set("code",c.get("code")+1)},this)},_hasUniqueCode:function(b){var c=this.get("xeroAccounts"),e=b.get("code"),c=null===c.findAccountByCode(e),d=!0;c&&this._defaultAccounts.each(function(c){var g=c.get("code");c=b!==c&&e===g;d=d&&!c});return c&&d},_renderAccount:function(c,e){var d=b.Squarespace.XeroUtils.HUMAN_XERO_ACCOUNT_TYPES[c.get("type")],
k=b.Lang.sub(ACCOUNT_TPL,b.merge(c.toJSON(),{humanType:d,enablePaymentsRow:c.get("enablePayments")?ENABLE_PAYMENTS_TPL:""})),l=this.get("contentBox"),k=l.appendChild(k);this.add({childType:b.Squarespace.DialogFields.Button,render:k.one(".account-creator-create"),"strings.text":"Create In Xero",onClick:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Create Account","strings.message":"A new "+d+' account called "'+c.get("name").replace('"',"'")+'" will be created in Xero.',"strings.confirm":"Create"})).on("confirm",
function(){c.save();b.later(250,this,function(){l.loadingOverlay.set("visible",!0)})})},context:this});e&&k.addClass("account-creator-last-account")},_notifyIfAllPresent:function(){var b=!0,c=this.get("xeroAccounts");this._defaultAccounts.each(function(e){e=null!==c.findAccountByName(e.get("name"));b=b&&e});b?this.fire("allAccountsPresent"):this.fire("accountsMissing")},_clearAccountId:function(b){b.target.set("accountId",null)},_errorNotify:function(){new b.Squarespace.Widgets.Alert({"strings.title":"Could Not Create Account",
"strings.message":"This account could not be created because there is already an account in Xero with the same Name or Code. Please edit your Chart Of Accounts, then try again."});this.get("contentBox").loadingOverlay.set("visible",!1)}},{CSS_PREFIX:"sqs-xero-default-account-creator",ATTRS:{xeroAccounts:{value:new b.Squarespace.Models.XeroAccountList}}})},"1.0",{requires:"base node squarespace-ui-base squarespace-dialog-field-2 squarespace-models-xero-account squarespace-dialog-xero-default-account-creator-css squarespace-plugin-loading-overlay squarespace-ui-base-css squarespace-dialog-button squarespace-widgets-alert squarespace-widgets-confirmation squarespace-xero-utils".split(" ")});
YUI.add("squarespace-dialog-state-manager",function(b){function d(c,f){if(!b.Lang.isObject(c)||!b.Lang.isObject(f))return c===f;var g=!0;b.Object.each(c,function(c,e){b.Lang.isObject(c)&&b.Lang.isObject(f[e])?g=g&&d(c,f[e]):c!==f[e]&&(g=!1)});return g}b.namespace("Squarespace.DialogFields");var c=b.Squarespace.DialogFields.StateManager=b.Base.create("stateManager",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(c){this.get("contentBox");var d=Date.now();b.Lang.isValue(c.data)||(c.data=
{state:c.stateOrder[0],date:c.allowNever?null:d},this.set("data",c.data));b.Lang.isNull(c.data.date)&&c.allowNever?this.set("durationOffset",-1):(d=b.Squarespace.DateUtils.calculateFullDayOffset(new Date,c.data.date),this.set("durationOffset",d));b.Lang.isValue(c.panel)&&(this.panel=c.panel);this.set("stateType",this.getStateType())},renderUI:function(){c.superclass.renderUI.call(this);var b=this.get("contentBox");this.stateLabel=b.one(".field-workflow-title");this.stateDesc=b.one(".field-workflow-description")},
bindUI:function(){c.superclass.bindUI.call(this);this.stateDesc.on("click",this.onStateChangeRequest,this);this.stateLabel.on("click",this.onStateChangeRequest,this);this.on("dataChange",this.onDataChange,this)},syncUI:function(){c.superclass.syncUI.call(this);var b=this.get("data"),d=this.get("states")[b.state];this.stateLabel.set("text",d.title);this.stateDesc.setHTML(this.getStateDesc(d.stateDesc,b.date))},onStateChangeRequest:function(b){b.target.hasClass("duration")||b.target.hasClass("date")?
b.widgetType="timer":b.widgetType="picker";this.showStateEditor(b)},onDataChange:function(c){var d;d=c.newVal;b.Lang.isValue(d.state)&&this.set("stateType",this.getStateType(d));b.Lang.isNull(d.date)&&this.get("allowNever")?this.set("durationOffset",-1):(d=b.Squarespace.DateUtils.calculateFullDayOffset(new Date,d.date),this.set("durationOffset",d));c.closeStateEditor&&this.closeStateEditor()},aggregateWidgetData:function(c){var d=this.get("data");c=c.newVal;var g={},h={closeStateEditor:!1};b.Lang.isDate(c)?
g.date=c.getTime():b.Lang.isString(c)?(g.state=c,h.closeStateEditor=!0):b.Lang.isNumber(c)?isNaN((new Date(c)).getTime())||(g.date=c):b.Lang.isObject(c)?(b.Object.hasKey(c,"state")&&(g.state=c.state),h.closeStateEditor=!0):b.Lang.isNull(c)&&(g.date=null);this.set("data",b.merge(d,g),h)},showStateEditor:function(b){this._activeChild||(b=this.getStateEditorWidget(b.widgetType),b.on("dataChange",this.aggregateWidgetData,this),b.on("destroy",function(){this._activeChild&&(this._activeChild=null)},this),
b.render(this.get("contentBox")),this._activeChild=b)},closeStateEditor:function(b){this._activeChild&&(this._activeChild.destroy(),this._activeChild=null)},getStateEditorWidget:function(c){switch(c){case "timer":return new b.Squarespace.DialogFields.StateScheduler2({data:this.get("data").date,type:this.get("stateType"),allowNever:this.get("allowNever"),durationOffset:this.get("durationOffset")});case "picker":return new b.Squarespace.DialogFields.Statepicker2({data:this.get("data"),states:this.get("states"),
stateOrder:this.get("stateOrder"),stateType:this.get("stateType"),allowNever:this.get("allowNever")});default:throw"Not Implemented";}},getStateType:function(c){c=c||this.get("data");var d=this.get("states");if(!b.Object.hasKey(d,c.state))return!1;c=/\[\s*([^|\]]+?)\s*(?:\|([^]]*))?\s*\]/g.exec(d[c.state].stateDesc);return(null!==c?String(c[1]).toLowerCase():!1)||"none"},getStateDesc:function(c,d){c=c.replace("[","{").replace("]","}");return b.Lang.sub(c,{DATE:this.getDateText(d),DURATION:this.getDurationText(d)})},
getDateText:function(c){var d="-";b.Lang.isValue(c)&&(d=b.Squarespace.DateUtils.dateFormat(new Date(c),{format:"%a, %b %d at %l:%M %p"}));return b.Lang.sub('<span class="date-wrapper"><span class="date">{date}</span></span>',{date:d})},getDurationText:function(c){var d=this.get("durationOffset"),g=this.get("allowNever")&&!b.Lang.isValue(c);c=b.Squarespace.DateUtils.dateFormat(c,{format:"%l:%M %p"});return b.Lang.sub('<span class="duration-wrapper"><span class="duration">{duration}</span></span>',
{duration:-1===d&&g?"never":0>d?"now":0===d?"today at "+c:1===d?"tomorrow at "+c:"in "+d+" days at "+c})},didDataChange:function(){var b=this.get("data");return d(b,this._initialData)}},{CSS_PREFIX:"sqs-state-manager",TEMPLATE:'<div class="clear field-workflow-wrapper"><div class="field-workflow-title">&nbsp</div><div class="field-workflow-description">&nbsp</div></div>',ATTRS:{strings:{},data:{},states:{},stateOrder:{validator:b.Lang.isArray},stateType:{},durationOffset:{value:-1,validator:function(c){return b.Lang.isNumber(Number(c))},
setter:function(b){return parseInt(b,10)}},allowNever:{validator:b.Lang.isBoolean}}})},"1.0",{requires:"base base-build squarespace-dialog-field-2 squarespace-date-utils squarespace-dialog-fields squarespace-dialog-state-picker squarespace-dialog-state-scheduler squarespace-node-flyout squarespace-node-flyover squarespace-panel".split(" ")});
YUI.add("squarespace-block-instagram",function(b){b.namespace("Squarespace.Block").Instagram=b.Base.create("block-instagram",b.Squarespace.Block.SummaryGallery,[],{},{CSS_PREFIX:"sqs-block-instagram",MODEL:b.Squarespace.ContentModel.InstagramBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Instagram},type:{value:b.Squarespace.BlockType.INSTAGRAM}}})},"1.0",{requires:["base","squarespace-enum","squarespace-block-summary-gallery","squarespace-block-instagram-editor","squarespace-block-instagram-model"]});
YUI.add("squarespace-account-menu",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.AccountMenu=b.Base.create("accountMenu",b.Squarespace.SSWidget,[],{delegatedEvents:{".sqs-account-menu":{click:"_haltClicks"},header:{click:"_editProfile"},".other-accounts li":{click:"_onSiteClick"},"button.create-site":{click:"_createSite"},"button.logout":{click:"_logout"},"button.site-admin":{click:"_goToSiteAdmin"}},initializer:function(){this.plug(b.Squarespace.Plugins.WidgetAnimTween,
{hideTweenOptions:this.get("hideTweenOptions"),showTweenOptions:this.get("showTweenOptions")});this._sitesById=b.Array.reduce(Static.SQUARESPACE_CONTEXT.managedWebsites,{},function(b,e){b[e.id]=e;return b})},destructor:function(){b.Squarespace.EscManager.removeTarget(this)},bindUI:function(){d.superclass.bindUI.call(this);this._registerEvent(this.get("memberAccount").after(["avatarAssetUrlChange","displayNameChange","emailChange"],this.syncUI,this));this.on("visibleChange",function(c){c.newVal?b.Squarespace.EscManager.addTarget(this):
b.Squarespace.EscManager.removeTarget(this)},this)},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("contentBox"),e=this.get("memberAccount"),f=c.one(".profile-image");b.Lang.isString(e.get("avatarId"))?f.setStyle("backgroundImage","url("+e.get("avatarAssetUrl")+")"):f.setStyle("backgroundImage",null);c.one(".profile-info .name").setContent(e.get("displayName"));c.one(".profile-info .email").setContent(e.get("email"))},_getHBTemplateContext:function(){var c={user:this.get("memberAccount").toJSON(),
genericAvatarURL:"/universal/images-v6/default-avatar-white.png"};b.Squarespace.Utils.isDamaskEnabled()&&(c.genericAvatarURL="/universal/images-v6/damask/avatar-dark.png");var e=[],d=[],g=[],h=[],k=[];b.Array.each(Static.SQUARESPACE_CONTEXT.managedWebsites,function(c){switch(c.siteStatus.value){case b.Squarespace.StatusConstants.PASTDUE:case b.Squarespace.StatusConstants.COMPED:case b.Squarespace.StatusConstants.ACTIVE:d.push(c);break;case b.Squarespace.StatusConstants.EXPIRED:g.push(c);break;case b.Squarespace.StatusConstants.TRIAL:h.push(c);
break;case b.Squarespace.StatusConstants.INTERNAL:k.push(c)}this._isCurrentSite(c.identifier)&&(c.currentSite=!0);c.faviconURL||(c.faviconURL=c.authenticUrl+"/favicon.ico");e.push(c)},this);1===e.length&&(e=[]);if(0<h.length||0<k.length||0<g.length)c.nonActiveSites=!0;return c=b.merge(c,{managedSites:e,activeSites:d,trialSites:h,expiredSites:g,internalSites:k})},_editProfile:function(){(new b.Squarespace.Editor.MemberAccount({model:window.CONFIG_PANEL.get("memberAccount")})).show()},_onSiteClick:function(c){var e=
c.target,d=e.ancestor("li",!0),g=d.getAttribute("data-site-id"),g=this._sitesById[g],h=g.identifier;c.halt();e.test(".remove-site")?this._confirmAndRemoveSite(g,d):e.test(".remove-access")?this._confirmAndRemoveAccess(g,d):b.Lang.isString(h)&&!this._isCurrentSite(h)&&this._switchSites(h)},_switchSites:function(b){window.open("https://"+b+"."+Static.SQUARESPACE_CONTEXT.appDomain+"/config/")},_confirmAndRemoveSite:function(c,e){var d=c.identifier+"."+Static.SQUARESPACE_CONTEXT.appDomain;(new b.Squarespace.Widgets.Confirmation({"strings.title":"Deactivate Site",
"strings.message":"Are you sure you wish to remove the site <strong>"+b.Escape.html(d)+"</strong>? This is permanent and cannot be undone."})).on("confirm",function(){b.Data.del({url:b.Squarespace.REST_API_ROOT+"websites/"+c.id,success:function(){new b.Squarespace.Widgets.Information({"strings.title":"Website Removed","strings.message":"<strong>"+d+"</strong> was successfully removed."});e.remove(!0)},failure:function(c){new b.Squarespace.Widgets.Alert({"strings.title":"Error Removing Site","strings.message":c.message||
"Failed to remove the site."})}},this)},this)},_confirmAndRemoveAccess:function(c,e){var d=c.identifier+"."+Static.SQUARESPACE_CONTEXT.appDomain,g=b.Lang.sub("{restApiRoot}websites/{websiteId}/member-permissions/mine",{restApiRoot:b.Squarespace.REST_API_ROOT,websiteId:c.id});(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Site Access","strings.message":"Are you sure you with to give up your permissions on <strong>"+d+"</strong>? You will need to be re-added by an existing administrator to be able to manage it"})).on("confirm",
function(){b.Data.del({url:g,success:function(){new b.Squarespace.Widgets.Information({"strings.title":"Access Removed","strings.message":"Access to <strong>"+d+"</strong> was successfully removed."});e.remove(!0)},failure:function(c){new b.Squarespace.Widgets.Alert({"strings.title":"Error Removing Access","strings.message":c.message||"There was an error removing access."})}},this)},this)},_goToSiteAdmin:function(){var c=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"]),c={targetSubdomain:b.Squarespace.Utils.isProductionEnvironment()?
"customersupport":c,appDomain:Static.SQUARESPACE_CONTEXT.appDomain,identifier:c},c=b.Lang.sub("http://{targetSubdomain}.{appDomain}/squarespace-admin/support/site/{identifier}",c);window.open(c)},_createSite:function(){window.open("http://www.squarespace.com/templates/?sourceIdentifier="+b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"]))},_logout:function(){b.Squarespace.Utils.logout()},_haltClicks:function(b){b.halt()},_isCurrentSite:function(c){return b.Object.getValue(Static,
["SQUARESPACE_CONTEXT","website","identifier"])===c}},{CSS_PREFIX:"sqs-account-menu",HANDLEBARS_TEMPLATE:"account-menu.html",ATTRS:{width:{value:340},hideTweenOptions:{valueFn:b.Squarespace.Plugins.WidgetAnimTween.TWEENS.zoomFadeOut,readOnly:!0},showTweenOptions:{valueFn:b.Squarespace.Plugins.WidgetAnimTween.TWEENS.zoomFadeIn,readOnly:!0},memberAccount:{valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberAccount}}}})},"1.0",{requires:"base json widget-anim squarespace-ss-widget squarespace-widget-anim-tween squarespace-util squarespace-enum squarespace-escmanager squarespace-ui-base squarespace-account-menu-template squarespace-hb-roles squarespace-editor-member-account squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-navigation-item-folder-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["navigation-item-folder.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="folder-item-wrapper">\n  <div class="icon icon-';(h=d.icon)?h=h.call(c,{hash:{},data:k}):(h=c.icon,h="function"===typeof h?h.apply(c):h);b+=l(h)+'"></div>\n  <div class="title">';(h=d.navigationTitle)?
h=h.call(c,{hash:{},data:k}):(h=c.navigationTitle,h="function"===typeof h?h.apply(c):h);if(h||0===h)b+=h;b+='</div>\n  <div class="icons">\n    <a href="#" class="icon icon-configure"></a>\n    <span class="icon icon-homepage"></span>\n    <a href="#" class="icon icon-delete"></a>\n  </div>\n</div>\n<div class="items-wrapper">\n  <div class="items-inner">\n    <div class="items"></div>\n    <div class="empty-message">\n      ';(h=d.emptyMessage)?h=h.call(c,{hash:{},data:k}):(h=c.emptyMessage,h="function"===
typeof h?h.apply(c):h);b+=l(h)+'\n    </div>\n    <footer>\n      <div class="add-page">\n        <div class="icon icon-add"></div>\n        <div class="title">';(h=d.addText)?h=h.call(c,{hash:{},data:k}):(h=c.addText,h="function"===typeof h?h.apply(c):h);return b+=l(h)+"</div>\n      </div>\n    </footer>\n  </div>\n</div>"})})();b.Handlebars.registerPartial("navigation-item-folder.html".replace("/","."),d.templates["navigation-item-folder.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-youtube-oembed-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["youtube-oembed.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};h=this.escapeExpression;b='<iframe src="';(d=d.src)?d=d.call(c,{hash:{},data:k}):(d=c.src,d="function"===typeof d?d.apply(c):d);return b+=h(d)+'" height="'+h((d=(d=c.data,null==d||!1===d?d:d.height),"function"===typeof d?d.apply(c):d))+'" width="'+h((d=
(d=c.data,null==d||!1===d?d:d.width),"function"===typeof d?d.apply(c):d))+'" scrolling="no" frameborder="0" allowfullscreen>\n</iframe>'})})();b.Handlebars.registerPartial("youtube-oembed.html".replace("/","."),d.templates["youtube-oembed.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-commerce-coupon-list",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.CommerceCouponList=b.Base.create("CommerceCouponList",b.Squarespace.Models.ModelList,[],{model:b.Squarespace.Models.CommerceCoupon,url:b.Squarespace.API_ROOT+"commerce/coupons",initializer:function(){this.after("*:save",function(b){this.remove(b.target);this.add(b.target)},this)},comparator:function(b){var c=-1,c=b.get("active")?b.get("isValid")?b.get("expired")?2:1:0:3;return c+b.get("name")}},
{})},"1.0",{requires:["base","squarespace-models-commerce-coupon","squarespace-models-model-list"]});
YUI.add("squarespace-settings-commerce-shipping",function(b){b.namespace("Squarespace.Settings.Commerce");var d=b.Squarespace.Settings.Commerce.Shipping=b.Base.create("shippingSettings",b.Squarespace.Widgets.SettingsPanel,[],{hasUnsavedChanges:function(){return!1},_syncRenderedFields:function(){d.superclass._syncRenderedFields.call(this);var b=this.getField("rules"),e=this.getField("shipstation-connect");b.on("rulesChanged",function(){this.getField("showIncompletePhysicalProductWarning").set("data",
b.data.showIncompletePhysicalProductWarning);this.getField("showOverweightProductWarning").set("data",b.data.showOverweightProductWarning);this.getField("showOversizeProductWarning").set("data",b.data.showOversizeProductWarning)},this);e.on("isIncompleteConnectionChange",function(){this.getField("showShipStationConnectionWarning").set("data",e.get("isIncompleteConnection"))},this);this.canUseAdvancedCommerce()||this.getField("shipstation-connect").showUpgradeLock()},_processResponseData:function(b){return b.rules=
b},canUseAdvancedCommerce:function(){return b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","canUseAdvancedCommerce"])},addItem:function(){this.getField("rules").showShippingTypeChooser()}},{CSS_PREFIX:"sqs-shipping-settings",ATTRS:{initialDataUrl:{value:"/api/commerce/admin/GetShippingOptions"},buttons:{value:[{type:"add",label:"Add Shipping Method"}]},"strings.title":{value:"Shipping"},"strings.description":{value:"Shipping Settings lets you control what shipping methods are available to customers and configure your label printing integration."},
fields:{value:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Shipping Methods",text:"Create shipping methods for your customers to choose from. The costs are automatically applied to physical products in their shopping carts. Countries not served by any of your shipping methods will not be accepted at checkout."}},{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"showIncompletePhysicalProductWarning","strings.warningMessage":"Real-time carrier shipping cannot be calculated for some of your products. Some of your products are missing weight or dimensions. The shipping cost of these items cannot be calculated and will be ignored by any real-time carrier shipping option."}},
{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"showOverweightProductWarning","strings.warningMessage":"Some of your products weigh in excess of carrier service limits. Real-time shipping cost estimates may not be completely accurate."}},{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"showOversizeProductWarning","strings.warningMessage":"Some of your products are too large to be shipped via one of your shipping methods."}},{ctor:b.Squarespace.DialogFields.ShippingRuleList,
config:{name:"rules"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"shipping-automation",title:"Shipping Automation",text:"Save time in your fulfillment workflow by automatically syncing your orders with a shipping solution."}},{ctor:b.Squarespace.DialogFields.WarningBanner,config:{name:"showShipStationConnectionWarning","strings.warningMessage":'Your ShipStation connection may be incomplete. Squarespace has not yet synced with ShipStation. Try clicking "Update" in your ShipStation dashboard and refreshing this panel.'}},
{ctor:b.Squarespace.DialogFields.ShipStationConnect,config:{$dontRecurse:!0,name:"shipstation-connect",siteIdentifier:b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"]),websiteSettings:b.Object.getValue(Static,["SQUARESPACE_CONTEXT","websiteSettings"])}}]}}})},"1.0",{requires:"squarespace-tray squarespace-localities squarespace-dialog-select squarespace-dialog-range-table squarespace-dialog-flow squarespace-dialog-warning-banner squarespace-dialog-map squarespace-dialog-description squarespace-commerce-utils squarespace-dialog-stringset squarespace-dialog-shipping-container-table squarespace-dialog-shipstation-connect squarespace-models-website-settings squarespace-shipping-rule-list node oop anim".split(" ")});
YUI.add("squarespace-layout-trash",function(b){b.namespace("Squarespace.Layout");b.Squarespace.Layout.BlockTrash=b.Base.create("blocktrash",b.Widget,[],{initializer:function(){var d=this.get("id");this.blockToRemove=null;this.drop=new b.Squarespace.Layout.Drop({node:this.get("boundingBox"),groups:["blocks"],lockScroll:!0});if(this.get("lowerPerformance"))b.DD.DDM.on(d+"|ddm:start",this._onDDMStart,this);this.drop.on(["drop:enter","drop:over"],this._onDropOver,this);this.drop.on("drop:hit",this._onDropHit,
this);this.drop.on("drop:exit",this._onDropExit,this);b.DD.DDM.before(d+"|ddm:end",this._beforeDDMEnd,this);this.after("markerLockChange",this._updateMarkerLock,this)},_onDDMStart:function(){this._bindScrollEvents();this._updatePositionAndShow()},_bindScrollEvents:function(){var d=this.get("id"),c=b.one(b.config.doc);c.on(d+"|scroll",b.Squarespace.debounce(function(){this.hide()},100,!0),this);c.on(d+"|scroll",b.Squarespace.debounce(function(){this._updatePositionAndShow()},80),this)},_updatePositionAndShow:function(){this.get("boundingBox").setStyle("top",
b.config.win.scrollY+this.get("winHeight")-20+"px");this.show();this.drop.sizeShim()},_onDropOver:function(){this.blockToRemove=b.DD.DDM.activeDrag.get("node");this.set("markerLock",!0)},_onDropExit:function(){this.blockToRemove=null;this.set("markerLock",!1)},_beforeDDMEnd:function(){var d=b.Widget.getByNode(this.blockToRemove);d&&d.queueForDestruction();this.set("markerLock",!1);b.one(b.config.doc).detach(this.get("id")+"|scroll")},_updateMarkerLock:function(b){this.get("editController").toggleInsertMarkerLock(b.newVal)},
destructor:function(){var d=this.get("id");this.drop.detach();this.drop.destroy();b.DD.DDM.detach(d+"|*");b.one(b.config.doc).detach(d+"|scroll")}},{CSS_PREFIX:"sqs-blocktrash",ATTRS:{render:{value:!0},markerLock:{value:!1},editController:{value:null},lowerPerformance:{value:!1},winHeight:{valueFn:function(){return b.config.win.innerHeight},lazyAdd:!1}}})},"1.0",{requires:["dd","squarespace-layout-drop","squarespace-layout-insert-marker","squarespace-ss-widget"]});
YUI.add("squarespace-layout-builder",function(b){function d(b){var c=[];if(3==b.get("nodeType"))return b.get("nodeValue");b.get("childNodes").each(function(b){c.push(d(b))});return c.join(" ")}b.namespace("Squarespace.Layout").Builder=b.Base.create("LayoutBuilder",b.Plugin.Base,[],{initializer:function(e){this.publish("layoutRendered",{defaultFn:function(c){c.layout.all(".sqs-block").getDOMNodes().forEach(function(c){b.Widget.getByNode(c).fire("layout-rendered")})},emitFacade:!0});this._blockSet=
new c;this._blockSet.on("add",this._onBlockSetAdd,this);this._blockSet.on("remove",this._onBlockSetRemove,this);e=this.get("host");var d=this._getContent();e.addClass("sqs-layout sqs-grid-"+this.get("columns"));d||(d=this.toJSON(),this._setContent(d));e.empty();this._cleanupImportedHTML(d);e=this.fromJSON(e,d)},_onBlockSetAdd:function(b){var c=b.block;c.addTarget(this);c.get("model").layout=this.get("layout");c.get("model").after("change",function(){this.syncDOMToContent({block:c})},this);c.after("destroy",
function(){var b=this.get("host").LayoutEditor;b&&b.cleanGrid()},this);this.syncDOMToContent({block:c})},_onBlockSetRemove:function(b){b=b.block;b.removeTarget(this);this.syncDOMToContent({block:b})},fromJSON:function(c,d){var g=this.get("host"),h=new b.Parallel;this._isBuildingFromJSON=!0;var k=this._fromJSON(c,d,h);this._isBuildingFromJSON=!1;g.addClass("sqs-layout-rendering");h.done(b.bind(function(){g.removeClass("sqs-layout-rendering");this.fire("layoutRendered",{layout:c})},this));return k},
_fromJSON:function(c,d,g){this.blocks=[];var h=b.Squarespace.BlockTypeByString,k=this.get("editController"),l=k.getRenderableBlocks(this.get("editMode")),p=k.isMobileApp()?k.get("blogApp").get("isNewPost"):!1;d.blocks?d.blocks.forEach(function(d){if(b.Lang.isNumber(d.type)){var f=l.get(h[d.type]);b.Lang.isValue(f)?(d=new f.ctor({editMode:this.get("editMode"),editController:k,id:d.id,model:d.value,stack:g,type:d.type,isNewBlock:p}),this.registerBlock(d),d.on("save",this.syncDOMToContent,this)):d=new b.Squarespace.Block.Unrenderable({editMode:this.get("editMode"),
editController:k,id:d.id,model:d.value,stack:g,type:d.type});d.render(c)}},this):d.rows?d.rows.forEach(function(b){var d=this.createRow();c.append(d);this._fromJSON(d,b,g)},this):d.columns&&d.columns.forEach(function(b){var h=this.createColumn(null,1<d.columns.length?b.span:null);c.append(h);this._fromJSON(h,b,g)},this);return c},createRow:function(c){return b.Node.create('<div class="sqs-row"></div>').setContent(c)},createColumn:function(c,d){b.Lang.isValue(d)||(d=this.get("columns"));var g=Math.min(d,
this.get("columns"));return b.Node.create('<div class="sqs-col sqs-col-'+g+'"></div>').setContent(c)},toJSON:function(c){c=c?c:this.get("host");var d={};if(!c)throw"Invalid node passed toJSON().";if(c.hasClass("sqs-row"))d.columns=[],c.get("children").filter(".sqs-col").each(function(b){d.columns.push(this.toJSON(b))},this);else if(c.hasClass("sqs-col")||c.hasClass("sqs-layout")){c.test("[class*='sqs-col-']")?d.span=b.Squarespace.Block.Utils.getValFromClass(c,"sqs-col-"):c.test("[class*='sqs-grid-']")?
d.span=b.Squarespace.Block.Utils.getValFromClass(c,"sqs-grid-"):c.test("[class*='columns-']")?d.span=b.Squarespace.Block.Utils.getValFromClass(c,"columns-"):console.error("Cannot find r.span from the wrappers");var g=[],h=[];c.get("children").each(function(c){if(c.test(".sqs-row"))0!==g.length&&(h.push({columns:[{span:d.span,blocks:b.clone(g,!0)}]}),g=[]),h.push(this.toJSON(c));else if(c.test(".sqs-block")){var e=b.Widget.getByNode(c);c=e?e.toJSON():{id:c.getAttribute("id"),type:c.getData("block-type"),
value:b.JSON.parse(c.getData("block-json"))};if(!c)throw"Block has no JSON.";g.push(c)}},this);0===h.length?d.blocks=g:(0!==g.length&&((b.Lang.isUndefined(d.span)||b.Lang.isNull(d.span))&&console.error("Block column span is invalid: ",d.span),h.push({columns:[{span:d.span,blocks:b.clone(g,!0)}]})),d.rows=h)}if(d.rows&&0===d.rows.length||d.columns&&0===d.columns.length)delete d.rows,delete d.columns,d.blocks=[],c.get("children").filter(".sqs-block").each(function(b){(b=b.getData("block"))&&d.blocks.push(b.toJSON())},
this);return d},syncDOMToContent:function(){this._isBuildingFromJSON||this._setContent(this.toJSON())},_setContent:function(b){this.get("layout").setAttrs(b)},_getContent:function(){return this.get("layout").toJSON()},registerBlock:function(b){this._blockSet.add(b)},deregisterBlock:function(b){this._blockSet.remove(b)},deregisterBlocks:function(c){b.Array.each(c,function(b){this._blockSet.remove(b)},this)},_cleanupImportedHTML:function(c){function f(c,e,f){var g=[],h,k=/\/static\/([a-z0-9]{24})\/([a-z0-9]{24})\/([a-z0-9]{24})\/[a-z0-9]{13}/i;
c.each(function(c){if(b.one(c).test("iframe"))h=b.Squarespace.PageLayoutTools.makeBlock(b.Squarespace.BlockType.EMBED,{html:c.get("outerHTML"),resolvedBy:"manual",title:"",url:""}),g.push(h);else if(b.one(c).test("img")&&k.test(c.get("src"))){var l=e.one('img[src="'+c.getAttribute("src")+'"]'),p=null;if(l&&(p=l.ancestor("a"),!p||!p.test("a")))p=null;for(var q=c.get("src").match(k),l=[],r=0;r<q.length;r++)24==q[r].length&&l.push(q[r]);q=null;3==l.length&&(q=l[2]);q?(l="",""!=b.Lang.trim(c.get("title"))?
l=c.get("title"):""!=b.Lang.trim(c.get("alt"))&&(l=c.get("alt")),p={description:l,linkTo:p?p.getAttribute("href"):"",newwindow:p?p.hasAttribute("_blank"):!1,imageId:q},f&&(p.image={assetUrl:c.get("src"),id:q}),h=b.Squarespace.PageLayoutTools.makeBlock(b.Squarespace.BlockType.IMAGE,p),g.push(h)):(window.trackClientError&&window.trackClientError({url:document.location.href,message:"Error creating image block from imported html. Could not find valid objectId.",file:"builder.js",line:"LayoutBuilder._cleanupImportedHTML / makeNewBlocks"}),
console.error("Error cleaning up an image: ",c))}else if(b.one(c).test("img"))h=b.Squarespace.PageLayoutTools.makeBlock(b.Squarespace.BlockType.CODE,{wysiwyg:{engine:"code",mode:"htmlmixed",isSource:!1,source:""},html:'<img src="'+c.get("src")+'" title="'+c.get("title")+'" alt="'+c.get("alt")+'"/>'}),g.push(h);else if(c.getContent()&&""!==d(c)){if(!h||h.type==b.Squarespace.BlockType.EMBED||h.type==b.Squarespace.BlockType.IMAGE||h.type==b.Squarespace.BlockType.CODE)h=b.Squarespace.PageLayoutTools.makeBlock(b.Squarespace.BlockType.HTML,
{html:"",wysiwyg:{html:""}}),g.push(h);h.value.html+=c.get("outerHTML")}});return g}function g(c,e){function d(b,c){c(b);for(b=b.firstChild;b;)d(b,c),b=b.nextSibling}function f(b){b=(b=b.tagName)?b.toLowerCase():"textNode";b="b"===b?"strong":b;return"i"===b?"em":b}function g(b,c,e){for(var d=[],h=[],k=c.length-1;0<=k;k--){var l=c[k],p=!1;I&&k===c.length-1&&l===f(b)?p=!0:"strong"===l&&!e.ancestor(l)?e.ancestor("b")||(p=!0):"em"===l&&!e.ancestor(l)?e.ancestor("i")||(p=!0):e.ancestor(l)||(p=!0);p?h.push(l):
d.unshift(l)}return{closed:h,nodes:d}}function h(c,e){0===D.length?F.hasOwnProperty(c)?(M+="<p>",D.push("p")):(M+="<"+c+">",D.push(c)):E.hasOwnProperty(D[D.length-1])&&0<=b.Array.indexOf(E[D[D.length-1]],c)&&(0<aa.length?(M+=aa,aa="",D.push(c),p.push(M),M="<"+c+">",I=!0):(M+="<"+c+">",D.push(c)))}function k(b,c){l(null,!0);M+="</"+b+">";p.push(M);M="";c&&D.pop();0===D.length&&I&&(I=!1)}function l(b,c){b&&(aa+="</"+b+">");c&&(M+=aa,aa="")}var p=[],q="h1 h2 h3 h4 h5 h6 p ul ol li blockquote".split(" "),
r="a strong em b i cite".split(" "),E={ul:["li","ol","ul"],ol:["li","ul","ol"],li:["ol","ul","li"],blockquote:["ul","ol","li","p"]},F={li:["ul","ol"]},U=["br","table","tr","div"],H=b.Node.create("<div></div>"),G=[],aa="",D=[],M="",I=!1;d(c._node,function(c){var d,s=b.one(c),u=f(c),H=s.get("text"),I=g(c,G,s),F=g(c,D,s);if(0<I.closed.length){G=I.nodes;for(d=0;d<I.closed.length;d++)l(I.closed[d])}if(0<F.closed.length){D=F.nodes;for(d=0;d<F.closed.length;d++)k(F.closed[d])}if(s.test(e))p.push(s.get("outerHTML"));
else if(0<=b.Array.indexOf(r,f(c)))!("a"===u&&s.one(">"+e))&&!(0<=b.Array.indexOf(G,f(c)))&&(G.push(u),"a"==u?(c=s.getAttribute("target"),d="",b.Lang.isValue(c)&&0<c.length&&(d=' target="'+c+'"'),aa+='<a href="'+s.get("href")+'"'+d+">"):aa+="<"+u+">");else if(0<=b.Array.indexOf(q,f(c)))h(u,c);else if(3==c.nodeType&&""!=b.Lang.trim(b.one(c).get("text")))""!=b.Lang.trim(H)&&(D.length||h("p",c),H=H.replace(/</g,"&lt;").replace(/>/g,"&gt;"),aa+=H);else if(0<=b.Array.indexOf(U,f(c)))if(0<D.length)s=D[D.length-
1],k(s,!0),h(s,c);else if(0<aa.length){for(d=G.length-1;0<=d;d--)l(G[d]);h("p",c);k("p",!0)}});(function(){var b,c;for(b=G.length-1;0<=b;b--)l(G[b]);for(b=D.length-1;0<=b;b--)c=0===b,k(D[b],c)})();1>=p.length&&p.push("<p></p>");H.append(b.Node.create(p.join("")));return b.Node.create(H.get("innerHTML"))._node}if(c.rows)this._cleanupImportedHTML(c.rows);else if(b.Lang.isArray(c.columns))this._cleanupImportedHTML(c.columns);else if(b.Lang.isArray(c))for(var h=0;h<c.length;h++)this._cleanupImportedHTML(c[h]);
else if(c.blocks){for(var h=[],k=0;k<c.blocks.length;k++)if(c.blocks[k].type==b.Squarespace.BlockType.HTML&&c.blocks[k].value){var l=b.guid(),p=c.blocks[k].value.html,q=p.toLowerCase();if((-1!==q.indexOf("<iframe")||-1!==q.indexOf("<img"))&&125>q.split("<iframe").length-1+(q.split("<img").length-1)){q=b.Node.create('<div id="'+l+'"/>');try{q.setContent("<div>"+p+"</div>")}catch(r){console.error("Skipping over error while trying to clean import html: ",r);continue}p=g(q,"iframe, img");p=b.one(p);p.get("id")!=
l&&(l=f(p.get("childNodes"),q,this.get("editController").isMobileApp()),h.push({find:c.blocks[k],replaceWith:l}))}}if(0<h.length)for(k=0;k<h.length;k++){l=h[k];p=[c.blocks.indexOf(l.find),1];for(q=0;q<l.replaceWith.length;q++)p.push(l.replaceWith[q]);c.blocks.splice.apply(c.blocks,p)}}}},{NS:"LayoutBuilder",ATTRS:{columns:{valueFn:function(){return this.get("layout").get("columns")}},editController:{writeOnce:!0,validator:function(c){return b.instanceOf(c,b.Squarespace.EditControllerBase)}},layout:{writeOnce:!0,
validator:function(c){return b.instanceOf(c,b.Squarespace.Models.PageLayout)}},editMode:{writeOnce:!0,validator:function(c){return b.Squarespace.Layout.EditMode.isValid(c)}}}});var c=b.Base.create("BlockSet",b.Base,[],{initializer:function(){this._blockMap={}},add:function(b){this._containsBlock(b)||(this._blockMap[b.get("id")]=b,b.after("destroy",function(){this.remove(b)},this),this.fire("add",{block:b}))},_containsBlock:function(c){return b.Lang.isValue(this._blockMap[c.get("id")])},remove:function(b){this._containsBlock(b)&&
(delete this._blockMap[b.get("id")],this.fire("remove",{block:b}))}});b.Squarespace.PageLayoutTools={sanitizeImportedECB:function(c){if(this.isEmptyECB(c)&&b.Lang.isValue(c.get("html"))){var d=c.get("html");c.get("layout").setAttrs({rows:[{columns:[{span:12,rows:[{columns:[{span:12,blocks:[this.makeBlock(b.Squarespace.BlockType.HTML,{html:d,wysiwyg:{html:d}})]}]}]}]}]})}},isEmptyECB:function(c){c=this.getBlocks(c.get("layout").toJSON());return 0===c.length?!0:1==c.length&&(c=c[0],c.type===b.Squarespace.BlockType.HTML)?
""===c.value.html:!1},convertLayoutToNewColumnCount:function(c,d){function g(c){b.Array.each(c.columns||c.get("columns"),h)}function h(c){c.span=d;c.rows&&b.Array.each(c.rows,g)}c.set("columns",d);c.get("rows").each(g)},getBlocks:function(b){var c=[];if(b&&b.rows)for(var d=0;d<b.rows.length;d++)c=c.concat(this._getBlocksRow(b.rows[d]));return c},_getBlocksRow:function(b){var c=[];if(b.columns)for(var d=0;d<b.columns.length;d++)c=c.concat(this._getBlocksColumn(b.columns[d]));return c},_getBlocksColumn:function(b){var c=
[];if(b.rows)for(var d=0;d<b.rows.length;d++)c=c.concat(this._getBlocksRow(b.rows[d]));b.blocks&&(c=c.concat(b.blocks));return c},getSimpleEditableContentBlock:function(c){var d={columns:12,rows:[{columns:[{span:12,rows:[{columns:[{span:12,blocks:Array.prototype.slice.call(arguments)}]}]}]}]};c||(d=b.JSON.stringify(d));return{layout:d}},getSimpleHTMLEditableContentBlock:function(c,d){return this.getSimpleEditableContentBlock(b.Squarespace.PageLayoutTools.makeBlock(b.Squarespace.BlockType.HTML,{html:c,
wysiwyg:{html:c}},d))},makeBlock:function(c,d){return{type:c,id:b.Squarespace.Utils.getGuid(),value:d}}}},"1.0",{requires:"base json node squarespace-util squarespace-enum squarespace-block-base-modelsync squarespace-block-utils squarespace-block-unrenderable squarespace-layout-snapshot squarespace-string-utils".split(" ")});
YUI.add("squarespace-domain-message-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["domain-message.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="title">';(h=d.title)?h=h.call(c,{hash:{},data:k}):(h=c.title,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n<div class="message">';(h=d.message)?h=h.call(c,{hash:{},data:k}):(h=c.message,h="function"===
typeof h?h.apply(c):h);if(h||0===h)b+=h;return b+"</div>\n"})})();b.Handlebars.registerPartial("domain-message.html".replace("/","."),d.templates["domain-message.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-domain-linker",function(b){var d=b.namespace("Squarespace.Singletons"),c=b.Squarespace.Promises,e={name:"linkDomain",style:"flyout",savingText:"Linking Domain...",overlay:0.5,width:370,closeOthers:!1,discardChangesConfirmation:!1,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Link"}],tabs:[{title:"Link Existing",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{required:!0,name:"domain","strings.placeholder":"Domain Name",
submitOnEnter:!0}}]}]},f=b.Base.create("domainLinker",b.Base,[],{link:function(){return c.chainFns([this._getTypeFromUser,this._doLink],this)()},_getTypeFromUser:function(){var c=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website"]),c=b.Lang.isValue(c)&&c.referralSource===b.Squarespace.ReferralSource.GOOGLE;return!b.Squarespace.Utils.isBetaFeatureEnabled()&&!c?"custom":b.Squarespace.Promises.create(function(c){var e=null,e=new b.Squarespace.EditingDialog({title:"Link Existing Domain",style:"flyout",
width:370,overlay:0.5,tabs:[{icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.MultiOption,config:{className:"icon20",name:"linkSource",submitOnSelect:!0,optionClickCb:function(b){c(b);e.close()},options:[{icon:"external-domain",title:"Other",value:"custom"},{icon:"google",title:"Google",value:"google"}]}}]}]});e.show()},this)},_doLink:function(b){switch(b){case "google":return this._linkGoogleDomain();case "custom":return this._linkCustomDomain()}},
_linkGoogleDomain:function(){var c=b.bind(function(c){return b.bind(c,this)},this),e=this._getGoogleConsent();b.Squarespace.Analytics.trackInternal("domain_link_google_domain_start");e=e.then(c(this._getGoogleDomainList)).then(c(this._selectGoogleDomain)).then(c(this._addGoogleDomain));e.then(null,c(this._showError));return e},_showError:function(c){return!b.Lang.isString(c.message)?!1:b.Squarespace.Fluent.Alert({"strings.message":c.message,"strings.title":"Failed to Link Domain"})},_getGoogleConsent:function(){return b.Squarespace.GoogleDomainsConsentService.getConsentForList().then(function(b){return b.requestId})},
_getGoogleDomainList:function(e){return c.create(function(c,d){var f=new b.Squarespace.Models.ExternalGoogleDomainList({authRequestId:e});f.load(function(e){b.Lang.isValue(e)?d(Error("Failed to get domains.")):f.isEmpty()?d(Error("You have no Google domains to link to this site.")):c(f)})},this)},_selectGoogleDomain:function(c){return b.Squarespace.Promises.create(function(e,d){var f=this._getDomainSelectConfig(c),p=new b.Squarespace.EditingDialog(f);p.on(["cancel-click","cancel"],function(){d(null)});
p.show();p.saveAndCloseButton.on("click",function(){var d=p.getData();p.close();var f=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]);e(b.Squarespace.GoogleDomainsConsentService.getDomainOnlyConsent(d.domain,c.get("authRequestId"),f))})},this)},_getDomainSelectConfig:function(c){c=b.Array.reduce(c.toJSON(),[],function(b,c){var e=c.name;b.push({label:e,value:e});return b});return{name:"selectGoogleDomain",style:"flyout",overlay:0.5,width:370,discardChangesConfirmation:!1,buttons:[{type:"cancel",
title:"Cancel"},{type:"saveAndClose",title:"Link Domain"}],tabs:[{title:"Link Google Domain",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Select,config:{name:"domain",data:c[0].value,"strings.title":"Your Google Domains","strings.description":"Select a google domain to link to your site.",options:c}}]}]}},_addGoogleDomain:function(e){return b.when(e).then(b.bind(function(e){return c.create(function(c,d){var f=new b.Squarespace.Models.GoogleDomain({googleAuthRequestId:e.requestId});
f.save(function(e){b.Lang.isValue(e)?400===e.code?d(Error(e.responseJSON.message)):d(e):c(f.toJSON())})},this)},this))},_linkCustomDomain:function(){return b.Squarespace.Promises.submitDialog(e,function(b){return this._storeLinkedDomain(b.domain)},this)},_storeLinkedDomain:function(e){return c.create(function(c,d){b.Data.post({url:"/api/domains/AddDomain",data:{domain:e},success:function(b){c(b.domain)},failure:d})},this)}});d.DomainLinker=new f},"1.0",{requires:"base squarespace-dialog squarespace-models-google-domain squarespace-models-external-google-domain-list squarespace-google-domains-consent-service squarespace-promises squarespace-dialog-promises squarespace-dialog-text squarespace-dialog-select".split(" ")});
YUI.add("squarespace-widgets-model-list-manager",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.ModelListManager=b.Base.create("ModelListManager",b.Squarespace.Widgets.SSWidget,[],{destructor:function(){this.get("header").destroy();this.get("body").destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._headerNode=b.appendChild('<div class="manager-header"></div>');this._shadowNode=this._headerNode.appendChild('<div class="shadow"></div>');
this._modelsNode=b.appendChild('<div class="manager-models"></div>')},bindUI:function(){d.superclass.bindUI.call(this);var c=b.one(b.config.win),e=this.get("id");c.on(e+"|scroll",this._updateHeaderShadow,this)},_updateHeaderShadow:function(){var c=b.one(b.config.win).get("scrollTop"),c=Math.min(c/100,0.4);this._shadowNode.setStyle("opacity",c)},_createHeader:function(){var c=this.get("constructors.header"),e=b.merge({models:this.get("models")},this.get("constructorConfigs.header"));return new c(e)},
_createBody:function(){var c=this.get("constructors.body"),e=b.merge({models:this.get("models")},this.get("constructorConfigs.body"));return new c(e)}},{CSS_PREFIX:"sqs-model-list-manager",ATTRS:{constructors:{value:{models:b.Squarespace.Models.ModelList,header:b.Squarespace.Widgets.ModelListHeader,body:b.Squarespace.Widgets.ModelList},validator:function(c){if(!b.Lang.isObject(c))return console.error('ModelListManager: Invalid "constructors" attribute. Must be an object.'),!1;var e=b.Array.filter(["models",
"header","body"],function(e){return!b.Object.hasKey(c,e)});return 0<e.length?(e=e.join(", "),console.error('ModelListManager: Invalid "constructors" attribute. Missing '+e+"."),!1):!0}},constructorConfigs:{value:{models:{},header:{},body:{}},validator:function(c){if(!b.Lang.isObject(c))return console.error('ModelListManager: Invalid "constructorConfigs" attribute. Must be an object.'),!1;var e=b.Array.filter(["models","header","body"],function(e){return!b.Object.hasKey(c,e)});return 0<e.length?(e=
e.join(", "),console.error('ModelListManager: Invalid "constructorConfigs" attribute. Missing '+e+"."),!1):!0},writeOnce:"initOnly"},models:{valueFn:function(){var b=this.get("constructors.models"),e=this.get("constructorConfigs.models");return new b(e)},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ModelList),writeOnce:"initOnly"},header:{valueFn:"_createHeader",validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Widgets.ModelListHeader),readOnly:!0},body:{valueFn:"_createBody",
validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Widgets.ModelList),readOnly:!0}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-models-model-list squarespace-ss-widget squarespace-widgets-model-list squarespace-widgets-model-list-header".split(" ")});
YUI.add("squarespace-models-form",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.Form=b.Base.create("form",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.REST_API_ROOT+"forms",url:b.Squarespace.REST_API_ROOT+"forms/{id}",toJSON:function(){var c=d.superclass.toJSON.call(this);c.fields=b.Array.map(c.fields,function(c){return b.JSON.stringify(c)});c.submissionMessage=b.JSON.stringify(c.submissionMessage);c.preSubmitTopics=c.preSubmitTopics.toJSON();return c},saveStorageBackends:function(c,
e,d){b.Data.post({url:"/api/form/SaveFormBackendConfig",data:{id:this.get("id"),googleDocsConnect:c.googleDocs,mailchimpConnect:c.mailchimp,emailConnect:c.email,siteUserConnect:c.siteUser},success:function(b){this.setAttrs(b.form);e&&e.call(d||this,null)},failure:function(b){b=b.errors||b;e&&e.call(d||this,b,null)}},this)}},{ATTRS:{id:{value:null},type:{value:b.Squarespace.FormType.FORM_BLOCK,validator:b.Squarespace.AttrValidators.isNumber},name:{value:"New Form",validator:b.Squarespace.AttrValidators.isString},
fields:{value:[],setter:function(c){return b.Array.map(c,function(c){return b.Lang.isString(c)?b.JSON.parse(c):c},this)},validator:b.Squarespace.AttrValidators.isArray},connectedBackends:{value:null,validator:b.Squarespace.AttrValidators.isNullOrArray},submitButtonText:{value:"Submit",validator:b.Lang.isString},submissionMessage:{value:{html:"Thank you!"},setter:function(c){return b.Lang.isString(c)?b.JSON.parse(c):c}},submissionHTML:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},
preSubmitTopics:{valueFn:function(){return new b.Squarespace.Models.FormPreSubmitTopicList},setter:function(c){if(!b.Lang.isValue(c)||c instanceof b.Squarespace.Models.FormPreSubmitTopicList)return c;if(b.Lang.isArray(c))return new b.Squarespace.Models.FormPreSubmitTopicList({items:c});console.error("Form: Invalid preSubmitTopics. Must be an array or a FormPreSubmitTopicList.")}},usePreSubmit:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean}}});b.Squarespace.Models.FormList=b.Base.create("formList",
b.ModelList,[b.Squarespace.ModelSync.REST],{model:b.Squarespace.Models.Form,filterByType:function(b){return this.filter(function(e){return e.get("type")===b})}});b.Squarespace.FormCache=new b.Squarespace.Models.FormList},"1.0",{requires:"base model json squarespace-model-sync-rest squarespace-enum squarespace-util squarespace-attr-validators squarespace-models-form-pre-submit-topic".split(" ")});
YUI.add("squarespace-block-summary-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog");b.Squarespace.Block.ModelEditorDialog.Summary=b.Base.create("SummaryModelEditorDialog",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var b=this.get("dialog");this.get("model").after("collectionIdChange",this._updateAutocomplete,this);this.get("dialog").on("ready",this._updateAutocomplete,this);b.on("shown",function(c){b.getField("pageSize").refreshWidth()},this)},_updateAutocomplete:function(d){var c=
this.get("model").get("collectionId");d=this.get("dialog").getField("filter");if(b.Lang.isString(c)&&0!==c.length&&b.Lang.isValue(d)){var e=d.get("tagField"),f=d.get("categoryField"),c={collectionId:c};b.Lang.isValue(d)&&(this._getNewAutoCompleteData(e,"/api/commondata/GetAutoCompleteTags",c),this._getNewAutoCompleteData(f,"/api/commondata/GetAutoCompleteCategories",c))}},_getNewAutoCompleteData:function(d,c,e){b.Data.get({url:c,data:e,success:function(c){var e=d.get("acWidget");b.Lang.isValue(e)&&
e.set("source",c)}})},_createSelectOption:function(b,c){return{value:b,label:c}},_getDefaultDialogConfig:function(){return{width:380,height:420,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Summary",tabTitle:"Content",icon:"/universal/images-v6/icons/icon-summary-16-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Items to Display.</strong>  Select the number of items this block should display."}},
{ctor:b.Squarespace.DialogFields.Slider,required:!0,config:{name:"pageSize",range:[1,20],"strings.suffix":"Item",pluralize:!0,labelWidth:60,submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.ContentIdSelector,config:{name:"collectionId",showCollectionTagsAndCategories:!1,showGroupTitles:!0,collectionFilter:{collectionType:[b.Squarespace.CollectionTypes.PRODUCT,b.Squarespace.CollectionTypes.GENERIC],folder:!1}}}]},{tabTitle:"Filters",scroll:!0,fields:[{name:"filter",ctor:b.Squarespace.DialogFields.SummaryFilter}]},
{tabTitle:"Design",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Check,name:"title",config:{"strings.title":"Title","strings.description":"Display the title of each item."}},{ctor:b.Squarespace.DialogFields.Check,name:"thumbnail",config:{"strings.title":"Thumbnail","strings.description":"Display the thumbnail image for each item."}},{ctor:b.Squarespace.DialogFields.Check,name:"excerpt",config:{"strings.title":"Excerpt","strings.description":"Display an excerpt of each item."}}]}]}}},{ATTRS:{dialogConfig:{valueFn:"_getDefaultDialogConfig",
validator:b.Lang.isObject}}})},"1.0",{requires:"base model squarespace-model-editor squarespace-dialog-summary-filter squarespace-dialog-check squarespace-dialog-slider squarespace-dialog-content-selector".split(" ")});
YUI.add("squarespace-dropbox-sync-plugin",function(b){function d(b){d.superclass.constructor.apply(this,arguments)}d.NAME="dropboxSyncPlugin";d.NS="dropboxSync";b.extend(d,b.Plugin.Base,{initializer:function(){var c=this.get("host");b.Do.after(this._render,c,"syncUI",this)},destructor:function(){this.get("host").get("contentBox").one(".sync").remove(!0)},_getHostContent:function(){return this.get("host").get("contentBox")},_render:function(){this._renderSyncButton();this._renderDescriptionText()},
_renderDescriptionText:function(){this._getHostContent().one(".dropbox").append('<div class="desc">Your Dropbox account is now connected to Squarespace. Place folders for collections and pages in the <strong>/Apps/Squarespace/'+b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"])+"/</strong> directory in order to have them published to your site.</div>")},_renderSyncButton:function(){var b=this._getHostContent();b.one(".dropbox").append('<div class="sync"><input class="sync-button" type="button" value="Publish to Squarespace" /></div>');
b.one(".sync-button").on("click",this._onSyncClick,this)},_onSyncClick:function(c){c.halt();c=c.target;c.hasClass("disabled")||(c.addClass("disabled"),new b.Squarespace.Widgets.Information({"strings.title":"Starting Dropbox Publish","strings.message":"Beginning dropbox publishing."}),b.Data.post({url:"/api/commondata/DropboxSync",success:this._afterDropboxSync},this))},_afterDropboxSync:function(c){var e=this.get("host").get("contentBox").one(".sync-button"),d=function(b){},g=function(c){b.Squarespace.ContentCollectionCache.getCollectionFromData(c)};
e&&e.removeClass("disabled");if(c.syncError)new b.Squarespace.Widgets.Information({"strings.title":"Dropbox Publish Failed","strings.message":"Unable to publish from Dropbox: <strong>"+c.syncError+"</strong>"});else{var h=[];b.Object.each({created:c.createdCollections,deleted:c.removedCollections,updated:c.updatedCollections},function(c,e){b.Lang.isArray(c)&&0!==c.length&&h.push(b.Lang.sub("{n} {pluralize} {action}",{n:c.length,pluralize:1===c.length?"collection":"collections",action:e}))});e=0===
h.length?"There were no new changes.":h.join(",<br/>")+".";new b.Squarespace.Widgets.Information({"strings.title":"Dropbox Publish Complete","strings.message":e});(c.removedCollections||[]).forEach(d);(c.createdCollections||[]).forEach(g)}}});b.namespace("Squarespace.Plugins").DropboxSync=d},"1.0",{requires:["plugin","squarespace-widgets-information"]});
YUI.add("squarespace-timers",function(b){var d=b.namespace("Squarespace.Timers").FixedInterval=b.Base.create("FixedInterval",b.Base,[],{initializer:function(b){this._iterations=0},run:function(){this._shouldRun()&&b.later(this._getDelayLimitByMax(),this,this._runner)},_runner:function(){this._timer=null;this.get("fn")();this._iterations++;this.run()},_shouldRun:function(){return this.isRunning()||0<this.get("maxIterations")&&this._iterations>=this.get("maxIterations")||!0===this.get("untilFn")()?
!1:!0},_getDelayLimitByMax:function(){var b=this.getDelay(),e=this.get("maxDelay");return 0<e&&b>e?e:b},getDelay:function(){return this.get("initialDelay")},isRunning:function(){return b.Lang.isValue(this._timer)},pause:function(){clearTimeout(this._timer);this._timer=null},reset:function(){this._iterations=0}},{ATTRS:{initialDelay:{value:2E3,validator:b.Lang.isNumber},maxIterations:{value:-1,validator:b.Lang.isNumber},maxDelay:{value:-1,validator:b.Lang.isNumber},fn:{validator:b.Lang.isFunction},
untilFn:{value:noop,validator:b.Lang.isFunction}}});b.namespace("Squarespace.Timers").LinearIncreaseInterval=b.Base.create("LinearIncreaseInterval",d,[],{getDelay:function(){return this.get("initialDelay")+this._iterations*this.get("delayIncrement")}},{ATTRS:{delayIncrement:{value:500,validator:b.Lang.isNumber}}})},"1.0",{requires:["base"]});
YUI.add("squarespace-dialog-text",function(b){var d=b.namespace("Squarespace.DialogFields").Text=b.Base.create("text",b.Squarespace.DialogField2,[],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("name"),c=this.get("autocompleteType");this._textField=this.get("contentBox").one("input[type]");this.get("dialog")&&this._textField.setAttribute("tabindex",this.get("dialog").getNextTabIndex());this._textField.set("type",this.get("password")?"password":"text");b&&this._textField.setAttribute("name",
b);c&&this._textField.setAttribute("x-autocompletetype",c);this._set("errorFlyoutAnchor",this._textField);this._textField.set("value",this.get("data"))},bindUI:function(){d.superclass.bindUI.call(this);this.get("id");this.after("dataChange",this._afterDataChange,this);this._textField.after("valuechange",this._afterValueChange,this);var c=this._textField.getDOMNode(),e="addEventListener";b.Lang.isFunction(c.attachEvent)&&(e="attachEvent");c[e]("focus",b.bind(this._afterFocus,this));c[e]("blur",b.bind(this._afterBlur,
this));this._textField.on("click",function(b){b.halt()});this._textField.after("keyup",function(b){13===b.keyCode&&this.get("submitOnEnter")&&(this.fire("submit"),(b=this.get("dialog"))&&b.saveAndClose())},this);this._textField.on("keypress",this.applyKeyFilter,this);!0===this.get("mailcheck")&&this._textField.plug(b.Squarespace.Plugin.MailCheck,{field:this})},syncUI:function(){d.superclass.syncUI.call(this);var b=this.get("strings.placeholder");b&&this._textField.setAttribute("placeholder",b);this.get("disabled")?
this._textField.setAttribute("disabled","disabled"):this._textField.removeAttribute("disabled")},getErrors:function(){var b=this.get("data");return this.get("validator")(b)?this.get("required")&&this.isEmpty()?[this.get("strings.requiredFieldEmptyMessage")]:[]:[this.get("strings.validationFailMessage")]},isEmpty:function(){return""===this.get("data")},focus:function(){d.superclass.focus.call(this);this.get("rendered")&&this._textField.focus()},select:function(){this.get("rendered")&&this._textField.select()},
blur:function(){d.superclass.blur.call(this);this.get("rendered")&&this._textField.blur()},disable:function(){d.superclass.disable.call(this);this.get("rendered")&&this._textField.setAttribute("disabled","disabled")},enable:function(){d.superclass.enable.call(this);this.get("rendered")&&this._textField.removeAttribute("disabled")},applyKeyFilter:function(c){var e=this.get("keyFilter"),d=this.get("keyFilterExplanation"),f;if(e&&(0===b.UA.gecko||c._event.isChar))f=String.fromCharCode(c.which),!f.match(RegExp(e))&&
0<f.length&&(d&&this.showError(d),c.halt())},_afterDataChange:function(b){b.dataSync||this._textField.set("value",b.newVal||"",{dataSync:!0});this.hideError()},_afterValueChange:function(b){b.dataSync||this.set("data",b.newVal,{dataSync:!0})},_afterFocus:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.set("allowContextMenu",!0);b.UA.ie||this.focus()},_afterBlur:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.set("allowContextMenu",!1);this.set("data",this._textField.get("value"),
{dataSync:!0});this.blur()}},{CSS_PREFIX:"sqs-text",HANDLEBARS_TEMPLATE:"dialog-text.html",ATTRS:{strings:{value:{placeholder:"",validationFailMessage:"This must be a string.",requiredFieldEmptyMessage:"This is a required field."}},data:{value:"",setter:function(c){b.Lang.isValue(c)||(c="");return c},validator:function(c){return b.Lang.isString(c)||!b.Lang.isValue(c)}},validator:{value:b.Lang.isString},password:{value:!1,validator:b.Lang.isBoolean},submitOnEnter:{value:!1,validator:b.Lang.isBoolean},
disabled:{value:!1,validator:b.Lang.isBoolean},autocompleteType:b.Squarespace.AutocompleteTypeATTR,mailcheck:{value:!1,validator:b.Lang.isBoolean},keyFilter:{},keyFilterExplanation:{value:""},maxLength:{value:null},readOnly:{value:!1},selectAllOnFocus:{value:!1}}});b.Squarespace.DialogFields.LabeledText=b.Base.create("labeledText",b.Squarespace.DialogFields.Text,[b.Squarespace.DialogFields.DialogFieldLabel],{},{CSS_PREFIX:"sqs-labeled-text",LABEL_CONFIG:{forNode:"input[type]"}});var c=b.Squarespace.DialogFields.MoneyText=
b.Base.create("moneyText",b.Squarespace.DialogFields.Text,[],{renderUI:function(){c.superclass.renderUI.call(this);this.get("contentBox").one("input").plug(b.Squarespace.Plugin.MoneyFormatter)},bindUI:function(){var b=this.get("contentBox").one("input");b.on("valuechange",function(){this.set("data",b.moneyFormatterPlugin.get("data"))},this)}},{CSS_PREFIX:"sqs-money-text",LABEL_CONFIG:{forNode:"input[type]"},ATTRS:{data:{value:0,validator:b.Lang.isNumber},validator:{value:b.Lang.isNumber},prefixUnit:{valueFn:function(){return b.Squarespace.Commerce.currencySymbol()}}}}),
e=b.Squarespace.DialogFields.Email=b.Base.create("emailText",b.Squarespace.DialogFields.Text,[],{renderUI:function(){e.superclass.renderUI.call(this);this.get("contentBox").one("input").setAttribute("type","email")}},{CSS_PREFIX:"sqs-email-text",ATTRS:{mailcheck:{value:!0}}}),f=b.Squarespace.DialogFields.Url=b.Base.create("urlText",b.Squarespace.DialogFields.Text,[],{renderUI:function(){f.superclass.renderUI.call(this);this._textField.wrap('<div class="sqs-input-wrapper-content"></div>');var b=this.get("contentBox").one(".sqs-input-wrapper-content");
b.wrap('<div class="sqs-input-wrapper"></div>');b.prepend('<div class="prefix">'+this.get("prefix")+"</div>")},bindUI:function(){f.superclass.bindUI.call(this);this._textField.after("keyup",this.onKeyUp,this)},onKeyUp:function(c){var e=this.get("filter"),d;if("url-slug"===e||"url-slug-with-slash"==e)d=this._textField.get("value"),e="url-slug"===e?b.Squarespace.Utils.createUrl(d):b.Squarespace.Utils.createUrlWithSlash(d),c=this._textField.selectionStart-(32==c.keyCode?0:1),d!=e&&(this._textField.set("value",
e),this._textField.selectionStart=c,this._textField.selectionEnd=c)}},{CSS_PREFIX:"sqs-url-text",ATTRS:{filter:{value:"url-slug-with-slash"},prefix:{value:"/"}}})},"1.0",{requires:"base base-build event-valuechange squarespace-dialog-field-2 squarespace-autocomplete-types squarespace-dialog-text-template squarespace-dialog-label squarespace-mailcheck squarespace-attr-validators".split(" ")});
YUI.add("squarespace-content-item-types-product-physical",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.ProductPhysical=b.Base.create("ProductPhysicalContentItemEditor",b.Squarespace.ContentItemEditor.ProductVariants,[],{getDialogData:function(){var c=d.superclass.getDialogData.call(this);c.pricingPlaceholder={productType:b.Squarespace.ProductTypes.PHYSICAL,variants:c.variants.variants};return c},getPresentationName:function(){return"Physical Product"}},
{ATTRS:{editorConfiguration:{value:{name:"editProduct",title:"Edit {presentationName}",width:850,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?505:420}},overlay:0.5,closeOthers:!1,initialDataByReference:!0,tabs:[{$include:"tabs.primary.product.base",$update:{".pricingPlaceholder":{$include:"fields.productVariantsPricingPlaceholder"}}},{$include:"tabs.product.variantsPhysical"},{$include:"tabs.product.additionalInfo"},{$include:"tabs.product.workflow"},{$include:"tabs.options.product"},
{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["base","squarespace-util","squarespace-content-item-types-product-variants"]});
YUI.add("squarespace-tab-view-tab-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["tab-view-tab.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;return(b=d["if"].call(c,c.id,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n  <div class="tab-view-tab ';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f="function"===typeof f?f.apply(b):f);e+=l(f)+'" data-tabId="';
(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f="function"===typeof f?f.apply(b):f);e+=l(f)+'">\n    <span class="label">';(f=d.label)?f=f.call(b,{hash:{},data:c}):(f=b.label,f="function"===typeof f?f.apply(b):f);return e+=l(f)+"</span>\n  </div>\n"},k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("tab-view-tab.html".replace("/","."),d.templates["tab-view-tab.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-rss",function(b){b.namespace("Squarespace.ContentModel").RSSBlock=b.Base.create("RSSBlockModel",b.Model,[],{},{ATTRS:{collectionId:{}}});b.namespace("Squarespace.Block").Rss=b.Base.create("block-rss",b.Squarespace.Block.ModelSyncBase,[],{},{MODEL:b.Squarespace.ContentModel.RSSBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Rss},type:{value:b.Squarespace.BlockType.RSS}},CSS_PREFIX:"sqs-block-rss"})},"1.0",{requires:"base model squarespace-enum squarespace-block-base-modelsync squarespace-models-template squarespace-models-content-collection squarespace-block-rss-editor".split(" ")});
YUI.add("squarespace-dialog-statepicker-inset-timer",function(b){var d=function(c,d){var g=String(c),h=Number(d),k="";if(!b.Lang.isNumber(h))return g;for(var l=0,h=h-g.length;l<h;l++)k+="0";return k+g},c=b.namespace("Squarespace.DialogFields").InsetTimer=b.Base.create("insetTimer",b.Squarespace.DialogField2,[b.WidgetChild],{initializer:function(c){if(b.Lang.isValue(c.data))this.set("minutes",c.data.minutes),this.set("ampm",c.data.ampm),this.set("hours",c.data.hours);else{c=new Date;var d=c.getHours();
this.set("data",{minutes:c.getMinutes(),ampm:b.Lang.trim(b.Squarespace.DateUtils.dateFormat(Date.now(),{format:"%p"})),hours:11<d?d-12:d})}},renderUI:function(){c.superclass.renderUI.call(this);var b=this.get("contentBox");this._ampmControl=b.one(".ampm");this._hoursControl=b.one(".hour");this._minutesControl=b.one(".minute")},bindUI:function(){c.superclass.bindUI.call(this);this._ampmControl.on("click",this.selectControlEl,this,"ampm");this._minutesControl.on("click",this.selectControlEl,this,"minutes");
this._hoursControl.on("click",this.selectControlEl,this,"hours");this._ampmControl.on("blur",this.onTimerBlur,this,"ampm");this._minutesControl.on("blur",this.onTimerBlur,this,"minutes");this._hoursControl.on("blur",this.onTimerBlur,this,"hours");this._ampmControl.on("keydown",this.onTimerKeyDown,this,"ampm");this._minutesControl.on("keydown",this.onTimerKeyDown,this,"minutes");this._hoursControl.on("keydown",this.onTimerKeyDown,this,"hours");this.after(["minutesChange","hoursChange","ampmChange"],
this.updateData,this)},syncUI:function(){c.superclass.syncUI.call(this);this._ampmControl.set("value",this.get("ampm"));this._minutesControl.set("value",d(this.get("minutes"),2));this._hoursControl.set("value",this.get("hours"))},updateData:function(b){var c=this.get("data");c[b.attrName]=b.newVal;this.set("data",c)},selectControlEl:function(b,c){-1!==["ampm","minutes","hours"].indexOf(c)&&b.target.select()},onTimerBlur:function(b,c){("hours"===c||"ampm"===c||"minutes"===c)&&this.set(c,b.target.get("value"));
this.syncUI()},onTimerKeyDown:function(b,c){65==b.keyCode?(this._ampmControl.set("value","AM"),b.halt()):80==b.keyCode?(this._ampmControl.set("value","PM"),b.halt()):13!=b.keyCode&&("hours"===c&&186===b.keyCode?this._minutesControl.select():"minutes"===c&&32===b.keyCode&&this._ampmControl.select(),this._invalidHourMinKeyCode(b.keyCode)&&("minutes"===c||"hours"===c)?b.halt():b.target.hasClass("ampm")&&9!==b.keyCode&&b.halt())},_invalidHourMinKeyCode:function(b){return(57<b||48>b)&&(96>b||105<b)&&9!=
b&&16!=b&&37!=b&&39!=b&&46!=b&&8!=b}},{CSS_PREFIX:"time-wrapper",TEMPLATE:'<input class="time-control hour"> <span class="time-control">:</span> <input class="time-control minute"> <input class="time-control ampm"> <div class="duration-display"></div>',ATTRS:{ampm:{validator:function(c){return b.Lang.isString(c)?(c=c.toLowerCase(),"am"===c||"pm"===c):!1},setter:function(b){return b.toUpperCase()}},minutes:{validator:function(c){c=parseInt(c,10);return b.Lang.isNumber(c)&&0<=c&&60>c},setter:function(b){return parseInt(b,
10)}},hours:{validator:function(c){c=parseInt(c,10);return b.Lang.isNumber(c)&&0<c&&12>=c},setter:function(b){return parseInt(b,10)}},data:{value:{minutes:0,ampm:"AM",hours:0},getter:function(c){return b.merge(c,{})}}}})},"1.0",{requires:"base base-build squarespace-dialog-fields squarespace-dialog-field-2 squarespace-node-flyout squarespace-date-utils".split(" ")});
YUI.add("squarespace-jobs",function(b){b.namespace("Squarespace");var d=b.Squarespace.JobMessage=b.Base.create("jobMessage",b.Base,[],{},{ATTRS:{level:{validator:b.Lang.isNumber},date:{validator:b.Lang.isDate},message:{validator:b.Lang.isString,value:""}}});b.Squarespace.Job=b.Base.create("job",b.Model,[],{initializer:function(c){this.set("data",b.merge({},c.data));this.publish("open",{defaultFn:this.onOpen,context:this});this.publish("start",{defaultFn:this.onStart,context:this});this.publish("complete",
{defaultFn:this.onComplete,context:this});this.publish("failure",{defaultFn:this.onFailure,context:this});this.publish("update",{defaultFn:this.onUpdate,context:this})},getName:function(){return this.get("name")},getId:function(){return this.get("id")},getData:function(){return{name:this.get("name"),id:this.get("id"),status:this.get("status"),type:this.get("type"),data:this.get("data")}},update:function(c){var e=c.status,f=this.get("data"),g=this.get("status");c.data&&(f=this.set("data",c.data).get("data"));
c.childJobs&&this.set("childJobs",c.childJobs);f&&f.update&&this.fire("update",this);f=c.update?c.update.numFailed:0;e!==b.Squarespace.JobStatuses.SUCCESS&&this.getItemCount()<=this.getCompletedItemCount()+this.get("failedItems")+f&&(e=b.Squarespace.JobStatuses.SUCCESS);this.set("progress",c.progress);c.messages&&this.set("messages",c.messages.map(function(c){return new d(b.merge(c,{date:new Date(c.date)}))}));this.set("addedOn",new Date(c.addedOn));if(e!==g)switch(e&&this.set("status",e),this.set("statusMessage",
c.statusMessage),g=this.get("status"),g!=b.Squarespace.JobStatuses.WAITING&&!this.get("started")&&(this.fire("start",this),this.set("started",!0)),g){case b.Squarespace.JobStatuses.SUCCESS:this.fire("complete",this);break;case b.Squarespace.JobStatuses.FAILURE:this.fire("failure",this)}},setCollection:function(b){this.set("collection",b)},getItemCount:function(){return 1},getCompletedItemCount:function(){return this.get("status")===b.Squarespace.JobStatuses.SUCCESS?1:0},opened:function(){this.fire("open",
this)},onOpen:function(){},onComplete:function(){},onStart:function(){},onFailure:function(){}},{ATTRS:{name:{value:""},progress:{value:0,validator:b.Lang.isNumber},lastError:{value:"",readOnly:!0,getter:function(){if(!b.Lang.isValue(this.get("messages")))return null;var c=this.get("messages").filter(function(c){return c.get("level")===b.Squarespace.MessageLevels.ERROR}).sort(function(c,d){return b.DataType.Date.isGreater(d.get("date"),c.get("date"))});return c.length?c.shift().get("message"):"Error"}},
collection:{setter:function(b){var e=this.get("data");b&&(e.collectionId=b.getId())}},status:{value:b.Squarespace.JobStatuses.WAITING},statusMessage:{value:"",setter:function(b){return b||""}},messages:{validator:b.Lang.isArray},updateData:{value:null},data:{},failedItems:{value:0},type:{},childJobs:{value:[],validator:b.Lang.isArray},addedOn:{setter:function(c){return b.Lang.isDate(c)?c:new Date(c)}}}});b.Squarespace.ImageProcessingJob=b.Base.create("imageProcessingJob",b.Squarespace.Job,[],{setNumFiles:function(b){this.get("data").numFiles=
b},setBatchId:function(b){this.get("data").batchId=b},getItemCount:function(){return this.get("data").numFiles},getCompletedItemCount:function(){return!this.processedItems?0:this.processedItems.length},getProcessedItems:function(){return this.processedItems.slice(0)},onUpdate:function(){var b=this.get("data");b&&(b.update&&b.update.newProcessedItems)&&(this.processedItems||(this.processedItems=[]),Array.prototype.push.apply(this.processedItems,b.update.newProcessedItems))},incrementFailedItemCount:function(){var b=
this.get("failedItems");this.set("failedItems",b+1)}},{ATTRS:{type:{value:b.Squarespace.JobTypes.IMAGE_PROCESSING},started:{value:!1}}});b.Squarespace.AudioProcessingJob=b.Base.create("AudioProcessingJob",b.Squarespace.ImageProcessingJob,[],{},{ATTRS:{type:b.Squarespace.JobTypes.AUDIO_PROCESSING}});b.Squarespace.WordpressExportJob=b.Base.create("wordpressExportJob",b.Squarespace.Job,[],{onComplete:function(){b.Squarespace.Singletons.Template.refreshNavigationList();new b.Squarespace.Widgets.Information({"strings.title":"Export Complete",
"strings.message":"Your export has finished and your content can be downloaded in the Import / Export panel."})}},{ATTRS:{type:{value:b.Squarespace.JobTypes.EXPORTING_WORDPRESS}}});b.Squarespace.ImportingJob=b.Base.create("importingJob",b.Squarespace.Job,[],{onComplete:function(){b.Squarespace.Singletons.Template.refreshNavigationList();var c=this.get("data").expansionAttemptResponse;c.isAtOrOverProductLimit?new b.Squarespace.Widgets.Alert({"strings.title":"Notice","strings.message":c.message}):new b.Squarespace.Widgets.Information({"strings.title":"Import Complete",
"strings.message":"Your import has finished and your content can be found in the Content Library."})},onFailure:function(){var c=this.get("data").expansionAttemptResponse;if(c.isAtOrOverProductLimit)(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Too Many Products","strings.message":c.message})).on("confirm",CONFIG_PANEL.goToUpgrade)}},{ATTRS:{type:{value:b.Squarespace.JobTypes.IMPORTING}}});b.Squarespace.StatsMigrationJob=b.Base.create("statsMigrationJob",
b.Squarespace.Job,[],{onComplete:function(){new b.Squarespace.Widgets.Information({"strings.title":"Migration Complete","strings.message":"Your legacy statistics have been migrated and analysis has begun."})}},{ATTRS:{type:{value:b.Squarespace.JobTypes.STATS_MIGRATION}}});b.Squarespace.PushJob=b.Base.create("pushJob",b.Squarespace.Job,[],{},{ATTRS:{type:{value:b.Squarespace.JobTypes.PUSH}}});b.Squarespace.CollectionSyncJob=b.Base.create("collectionSyncJob",b.Squarespace.Job,[],{onComplete:function(){new b.Squarespace.Widgets.Information({"strings.title":this.get("strings.successTitle"),
"strings.message":this.get("strings.successMessage")});this._setCollectionSyncState(!1);var c=b.Squarespace.ACTIVE_MANAGER;c.getActiveCollectionManager&&c.getActiveCollection().getId()===this.get("data.collectionId")&&c.getActiveCollectionManager().refreshPage()},onFailure:function(){new b.Squarespace.Widgets.Information({"strings.title":this.get("strings.failureTitle"),"strings.message":this.get("strings.failureMessage")});this._setCollectionSyncState(!1)},_setCollectionSyncState:function(c){var e=
this.get("data.collectionId");(e=b.Squarespace.ContentCollectionCache.getById(e))&&e.set("synchronizing",c)}},{ATTRS:{strings:{value:{successTitle:"Sync Completed",successMessage:"Collection sync completed. Your images may still be processing. This can take several minutes to complete.",failureTitle:"Sync Failed",failureMessage:"Collection sync failed."}},type:{value:b.Squarespace.JobTypes.COLLECTION_SYNC}}});b.Squarespace.SmugMugSyncJob=b.Base.create("smugMugSyncJob",b.Squarespace.CollectionSyncJob,
[],{},{ATTRS:{strings:{value:{successTitle:"Import Completed",successMessage:"SmugMug album import completed. Your images may still be processing. This can take several minutes to complete.",failureTitle:"Import Failed",failureMessage:"Failed to import SmugMug album."}}}});b.Squarespace.XeroExportJob=b.Base.create("xeroSyncJob",b.Squarespace.Job,[],{},{ATTRS:{strings:{value:{successTitle:"Export Complete",successMessage:"Invoices successfully exported to Xero.",failureTitle:"Export Failed",failureMessage:"Failed to export invoices to Xero."}}}})},
"1.0",{requires:"datatype-date-math event model squarespace-util squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-widgets-edu-welcome-popup",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.EduWelcomePopup=b.Base.create("eduWelcomePopup",b.Squarespace.SSWidget,[],{delegatedEvents:{".get-started":{click:"_confirm"}},initializer:function(){this.publish("confirm")},renderUI:function(){this._lightbox=new b.Squarespace.Lightbox({content:'<div class="wrapper">'+this.renderTemplate()+"</div>",zIndex:200100,transition:"scale",name:"welcome-box",opacity:0.7,margin:200,clickAnywhereToExit:!1,
disableNormalClose:!0,noHeightConstrain:!0,containerNode:this.get("contentBox")});this._lightbox.show()},destructor:function(){this._lightbox.destroy()},dismiss:function(){this._lightbox.once("hidden",this.destroy,this);this._lightbox.hide()},_confirm:function(){this.fire("confirm")}},{getConfirmation:function(d){return new b.Promise(function(c){var e=new b.Squarespace.Widgets.EduWelcomePopup({schoolName:d});e.after("confirm",function(){e.dismiss();c(!0)});e.render()})},CSS_PREFIX:"sqs-edu-welcome-popup",
HANDLEBARS_TEMPLATE:"widgets-edu-welcome-popup.html",ATTRS:{schoolName:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base","promise","squarespace-ui-base","squarespace-ss-widget","squarespace-widgets-edu-welcome-popup-template"]});
YUI.add("squarespace-block-twitter-editor",function(b){b.namespace("Squarespace.Block.Editor").Twitter=b.Base.create("twitter-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Twitter")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Twitter"}}});var d=b.namespace("Squarespace.Block.ModelEditorDialog").Twitter=b.Base.create("TwitterSummaryModelEditorDialog",b.Squarespace.Block.ModelEditorDialog.SocialSummary,
[],{_getDefaultDialogConfig:function(){var c=this.get("model").toJSON(),e=d.superclass._getDefaultDialogConfig.call(this),f=e.tabs[0].fields;f.push({ctor:b.Squarespace.DialogFields.Check,name:"showAvatar",config:{"strings.title":"Show Avatar","strings.description":"Shows or hides the avatar image.",data:c.showAvatar}});f.push({ctor:b.Squarespace.DialogFields.Check,name:"showUsername",config:{"strings.title":"Show Username","strings.description":"Shows or hides the username text.",data:c.showUsername}});
f.push({ctor:b.Squarespace.DialogFields.Check,name:"followButton",config:{"strings.title":"Show Follow Button","strings.description":"Shows or hides the follow button appended to the end of the block.",data:c.followButton}});return e}},{ATTRS:{icon:{value:"twitter"},type:{value:b.Squarespace.BlockType.TWITTER},socialAccountType:{value:b.Squarespace.ExternalServiceProviders.TWITTER},collectionType:{value:b.Squarespace.CollectionTypes.TWITTER},strings:{value:{name:"Twitter",itemTypePlural:"Tweets",
itemType:"Tweet"}}}})},"1.0",{requires:"base model squarespace-block-social-summary-model-editor squarespace-damask-context-globals squarespace-dialog-check squarespace-model-editor".split(" ")});
YUI.add("squarespace-tax-rule-view-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["tax-rule-view.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n      <span class="add">';(f=d.addAction)?f=f.call(b,{hash:{},data:c}):(f=b.addAction,f=typeof f===p?f.apply(b):f);return e+=q(f)+"</span>\n      "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p="function",q=this.escapeExpression,r=this;return(b=d["with"].call(c,c.strings,
{hash:{},inverse:r.noop,fn:r.program(1,function(b,c){var e,f;e='\n\n<div class="rule-body">\n  <div>\n    <div class="name">\n      ';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===p?f.apply(b):f);e+=q(f)+'\n    </div>\n    <div class="actions">\n      ';if((f=d["if"].call(b,b.addAction,{hash:{},inverse:r.noop,fn:r.program(2,l,c),data:c}))||0===f)e+=f;e+='\n    </div>\n  </div>\n  <div>\n    <div class="description">\n      ';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,
f=typeof f===p?f.apply(b):f);e+=q(f)+'\n    </div>\n    <span class="aggregate">';(f=d.aggregate)?f=f.call(b,{hash:{},data:c}):(f=b.aggregate,f=typeof f===p?f.apply(b):f);return e+=q(f)+'</span>\n  </div>\n  <div class="subrules-list">\n  </div>\n</div>\n\n\n'},k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("tax-rule-view.html".replace("/","."),d.templates["tax-rule-view.html"])},"1.0",{requires:["handlebars-base"]});
var Detector={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{return!!window.WebGLRenderingContext&&!!document.createElement("canvas").getContext("experimental-webgl")}catch(b){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var b=document.createElement("div");b.id="webgl-error-message";b.style.fontFamily="monospace";b.style.fontSize="13px";b.style.fontWeight="normal";b.style.textAlign="center";
b.style.background="#fff";b.style.color="#000";b.style.padding="1.5em";b.style.width="400px";b.style.margin="5em auto 0";this.webgl||(b.innerHTML=window.WebGLRenderingContext?'Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />\nFind out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.':'Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>\nFind out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.');
return b},addGetWebGLMessage:function(b){var d,c;b=b||{};d=void 0!==b.parent?b.parent:document.body;b=void 0!==b.id?b.id:"oldie";c=Detector.getWebGLErrorMessage();c.id=b;d.appendChild(c)}};YUI.add("thirdparty-threejs-detector",function(b){},"1.0");
YUI.add("squarespace-block-summary-editor",function(b){b.namespace("Squarespace.Block.Editor").Summary=b.Base.create("summary-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Summary")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Summary"}}})},"1.0",{requires:["base","squarespace-block-editor-dialog","squarespace-block-summary-model-editor","squarespace-damask-context-globals",
"squarespace-model-editor"]});
YUI.add("squarespace-connected-account-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["connected-account.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p=this.escapeExpression,q=d.helperMissing;b='<div class="';(h=d.serviceName)?h=h.call(c,{hash:{},data:k}):(h=c.serviceName,h="function"===typeof h?h.apply(c):h);b+=p(h)+'">\n  ';if((h=d["if"].call(c,c.iconUrl,{hash:{},inverse:this.program(3,
function(b,c){var e,f;e='\n    <div class="icon default ';(f=d.serviceName)?f=f.call(b,{hash:{},data:c}):(f=b.serviceName,f="function"===typeof f?f.apply(b):f);return e+=p(f)+'"></div>\n  '},k),fn:this.program(1,function(b,c){var e,f;e='\n    <div class="icon">\n      <img src="';(f=d.iconUrl)?f=f.call(b,{hash:{},data:c}):(f=b.iconUrl,f="function"===typeof f?f.apply(b):f);return e+=p(f)+'" />\n    </div>\n  '},k),data:k}))||0===h)b+=h;l={hash:{},data:k};b=b+'\n  <div class="names">\n    <div class="user">'+
(p((h=d.screenNameForDisplay||c.screenNameForDisplay,h?h.call(c,c,l):q.call(c,"screenNameForDisplay",c,l)))+'</div>\n    <div class="service ');(l=d.serviceName)?l=l.call(c,{hash:{},data:k}):(l=c.serviceName,l="function"===typeof l?l.apply(c):l);b+=p(l)+'">';l={hash:{},data:k};b+=p((h=d.serviceNameForDisplay||c.serviceNameForDisplay,h?h.call(c,c,l):q.call(c,"serviceNameForDisplay",c,l)))+"</div>\n  </div>\n  ";if((l=d["if"].call(c,c.unauthorized,{hash:{},inverse:this.noop,fn:this.program(5,function(b,
c){return'\n    <div class="unauthorized-message">\n      <strong>Unauthorized</strong> &mdash; Remove or <a class="reauthenticate">reauthenticate</a> this account for continued usage.\n    </div>\n  '},k),data:k}))||0===l)b+=l;return b+="\n</div>"})})();b.Handlebars.registerPartial("connected-account.html".replace("/","."),d.templates["connected-account.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-newsletter-editor",function(b){b.namespace("Squarespace.Block.Editor").Newsletter=b.Base.create("newsletter-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Newsletter")}},{NS:"blockEditor"});b.namespace("Squarespace.Block.ModelEditorDialog").Newsletter=b.Base.create("blockFormEditor",b.Squarespace.Block.ModelEditorDialog.Form,[],{_bindDialogFields:function(){},
getDialogData:function(){var c=this.get("model"),e=c.getFormModel();return b.merge({showName:c.get("showName"),title:c.get("title"),description:c.get("description"),disclaimer:c.get("disclaimer"),submitButtonText:e.get("submitButtonText"),submissionMessage:e.get("submissionMessage"),submissionHTML:e.get("submissionHTML")},this._getConnectFieldInitialData())}},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});var d={name:"editNewsletterBlock",loadingText:"Editing Newsletter Block...",title:"Edit Newsletter Block",
icon:"/universal/images-v6/standard/icon_form_42_light.png",closeOthers:!1,style:"standard",flyoutPointerDirection:"hidden",width:500,height:525,initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{tabTitle:"Display",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Check,config:{name:"showName","strings.title":"Require Name Field","strings.description":"Display inputs for the subscriber's first and last name."}},
{ctor:b.Squarespace.DialogFields.Description,config:{name:"titleDescription",title:"Title"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"title",className:"thin"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"descriptionDescription",title:"Description"}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"description",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:125,classNames:"description"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"disclaimerDescription",
title:"Disclaimer",text:"Displayed below the input field."}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"disclaimer",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:125,classNames:"description"}}]},{tabTitle:"Storage",fields:function(){var c=[];b.Squarespace.Utils.isNewslettersEnabled()&&c.push({$include:"connectFieldConfigsByName.siteUser"});c.push({$include:"connectFieldConfigsByName.googleDocs"},{$include:"connectFieldConfigsByName.mailchimp"});return c}()},
{tabTitle:"Advanced",scroll:!0,fields:{$include:"submissionFieldConfigs"}}]}},"1.0",{requires:["squarespace-block-form-editor","squarespace-damask-context-globals","squarespace-dialog-wysiwyg","squarespace-model-editor","squarespace-util"]});
YUI.add("squarespace-settings-billing-base",function(b){var d=function(){};d.NAME="billingSettingsBase";d.prototype={initializer:function(c){this.set("strings.title","Billing");c=Static.SQUARESPACE_CONTEXT.billingStatus===b.Squarespace.BillingStatus.SUBSCRIBED;var e=Static.SQUARESPACE_CONTEXT.billingStatus===b.Squarespace.BillingStatus.FREE;Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.BillingStatus.EXPIRED&&(c||e)?this.set("strings.description",'Your site is no longer active. If you\'d like to reactivate service for your site, upgrade your account by clicking below. <a target="new" href="'+
b.Squarespace.HelpLinks.BILLING+'">Click here for more help regarding Squarespace billing.</a>'):this.set("strings.description",'You can use this area to edit your billing information, view your billing history, or modify your account. <a target="new" href="'+b.Squarespace.HelpLinks.BILLING+'">Click here for more help regarding Squarespace billing.</a>')},_getExpirationString:function(){var c=Static.SQUARESPACE_CONTEXT.website.siteStatus.expiration,e=new Date(c),d=(new Date).getTime(),c=Math.abs((c-
d)/1E3/60/60/24);return 1>c?"This trial will expire "+((new Date(d)).getDate()===e.getDate()?"today":"tomorrow")+" at "+b.DataType.Date.format(e,{format:"%I:%M%p"})+".":b.Squarespace.Singletons.Template.isTemplateOwner()?"This account is in <strong>Sandbox Mode</strong>.  It will not expire, but it is also not accessible to the public.":"This trial will expire in "+Math.floor(c)+" day"+(1!==c?"s":"")+"."},_linkAccountDescription:{ctor:b.Squarespace.DialogFields.Description,config:{name:"linkv5-description",
title:"Link Squarespace 5 Account",text:"If you are an existing Squarespace 5 customer with an active account you are eligible to link this site for free. Your Squarespace 5 account must be in good standing and on an Unlimited or Standard plan. Click this button to link your Squarespace 6 site with your existing Squarespace 5 account."}},_linkAccountButton:{ctor:b.Squarespace.DialogFields.Button,config:{name:"linkv5",className:"sqs-button-light","strings.text":"Link Squarespace 5 Account Billing"}},
_linkAccount:function(){var c=new b.Squarespace.EditingDialog({name:"link-v5-account",width:420,top:200,overlay:!0,style:"flyout",closeOthers:!1,primaryTabs:[{title:"Link Squarespace 5 Account",icon:"/universal/images-v6/icons/icon-login-20-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Active Squarespace 5 customers with our current Standard or Unlimited service plans are eligible for one free Squarespace 6 website.</strong> Login below with your Squarespace 5 details to link this website.<br/><br/>Please note: Canceling your Squarespace 5 account will place this account into a 24-hour trial.",
padding:[10,10]}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"identifier",submitOnEnter:!0,"strings.label":"Squarespace 5 Login","strings.placeholder":"Login"}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"password",password:!0,submitOnEnter:!0,"strings.label":"Password","strings.placeholder":"Password"}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Link Account"}]});c.on(this.get("id")+"|send-requested",function(){b.Data.sendForm(c,{url:"/api/account/LinkAccount",
success:function(b){c.close();this.showSuccessConfirmation("V5 Account Linked","Enjoy your free version 6 account!");window.location.reload()}},this)},this);c.show()},_bindLinkAccountButton:function(){var b=this.getField("linkv5");b&&b.setOnClick(this._linkAccount,this)}};b.namespace("Squarespace.Widgets").BillingSettingsBase=d},"1.0",{requires:["node","squarespace-models-billing-summary","squarespace-dialog-button","squarespace-dialog-map","squarespace-dialog-description"]});
YUI.add("squarespace-dialog-order-history-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-order-history.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e="<br />Amount Refunded: ";(f=d.amountRefunded)?f=f.call(b,{hash:{},data:c}):(f=b.amountRefunded,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p="function",q=this.escapeExpression,r=this,s=d.helperMissing;
return(b=d.each.call(c,c,{hash:{},inverse:r.noop,fn:r.program(1,function(b,c){var e,f,h;e='\n\n  <div class="order-event">\n    <div class="statement">\n      ';(f=d.statusType)?f=f.call(b,{hash:{},data:c}):(f=b.statusType,f=typeof f===p?f.apply(b):f);e+=q(f)+' changed from <span class="state">';(f=d.fromState)?f=f.call(b,{hash:{},data:c}):(f=b.fromState,f=typeof f===p?f.apply(b):f);e+=q(f)+'</span> to <span class="state">';(f=d.toState)?f=f.call(b,{hash:{},data:c}):(f=b.toState,f=typeof f===p?f.apply(b):
f);e+=q(f)+"</span>\n      ";if((f=d["if"].call(b,b.amountRefunded,{hash:{},inverse:r.noop,fn:r.program(2,l,c),data:c}))||0===f)e+=f;e+='\n    </div>\n    <div class="date">by ';(f=d.actorName)?f=f.call(b,{hash:{},data:c}):(f=b.actorName,f=typeof f===p?f.apply(b):f);e+=q(f)+" on ";h={hash:{format:"%m/%d/%Y %l:%M %p"},data:c};return e+=q((f=d["date-format"]||b["date-format"],f?f.call(b,b.eventDate,h):s.call(b,"date-format",b.eventDate,h)))+"</div>\n  </div>\n\n"},k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("dialog-order-history.html".replace("/",
"."),d.templates["dialog-order-history.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-base-modelsync",function(b){function d(b){return b.replace(/[-|_]/g," ").toLowerCase().capitalize()}b.namespace("Squarespace.Block").ModelSyncBase=b.Base.create("block-modelsync",b.Squarespace.Block.Base,[],{initializer:function(){"MODELSYNC"===this.get("blockTypeName")&&b.Lang.isValue(this.get("type"))&&this.set("blockTypeName",b.Squarespace.BlockTypeByString[this.get("type")])},renderUI:function(){this._renderBlock()},bindUI:function(){this.get("model").after("change",
b.Squarespace.debounce(function(b){this._renderBlock(b)},200,!0,!0),this)},_renderBlock:function(){var c=d(this.get("blockTypeName")),e=b.bind(function(){this.fire("widget:contentUpdate");this.set("stack",null)},this),f=this.get("stack");f&&(e=f.add(e));try{var g=JSON.stringify(this.toJSON());b.Data.post({url:"/api/widget/GetWidgetRendering",data:{widgetJSON:g},success:function(b){this._renderSuccess(b);this.fire("widget:contentUpdate");e()},failure:function(b){this._renderError(b);this.fire("widget:contentUpdate");
e()}},this)}catch(h){c="Error: "+c+" Block could not be rendered.",h instanceof TypeError&&console.warn(b.Lang.sub("Error: {message}",h)),this._renderError({error:c})}},_setWidgetContent:function(){var c=this.get("contentBox"),e=c.one(".sqs-state-message, .state-message");c.setHTML(this.get("widgetContent"));b.Lang.isValue(e)&&this.get("model").get("aspectRatio")&&e.wrap("<div></div>")},_renderSuccess:function(b){this.set("widgetContent",b.html);this._setWidgetContent()},_renderError:function(b){b=
b&&b.error||"Error: "+d(this.get("blockTypeName"))+" Block could not be rendered.";this.get("boundingBox").addClass("sqs-block-error");this.get("contentBox").setHTML('<div class="error">'+b+"</div>")}},{CSS_PREFIX:"sqs-block-modelsync",MODEL:b.Model,ATTRS:{stack:{},widgetContent:{value:""}}})},"1.0",{requires:"base squarespace-ss-widget squarespace-enum squarespace-util squarespace-debounce squarespace-block-base squarespace-block-editor-dialog".split(" ")});
YUI.add("squarespace-dialog-content-stat-manager",function(b){var d=function(b,c){return b.name.toLocaleLowerCase().localeCompare(c.name.toLocaleLowerCase())},c=function(b,c){return c.count-b.count},e=function(b,c){return c.modifiedOn-b.modifiedOn},f=b.namespace("Squarespace.DialogFields").ContentStatManager=b.Base.create("contentStatManager",b.Squarespace.DialogField2,[],{initializer:function(b){this._getItemsFromServer()},renderUI:function(){f.superclass.renderUI.call(this);var b=this.get("contentBox").one(".tag-cloud-footer-wrapper");
this._editInput=b.one(".field-tag-input");this.set("footerHeight",b.one(".field-tag-footer").get("offsetHeight"));b.setStyles({opacity:0,height:0,overflow:"hidden",transitionProperty:"transform, height, opacity",transitionDuration:".3s",transitionTimingFunction:"ease-out"});this._sortItems()},bindUI:function(){f.superclass.bindUI.call(this);var b=this.get("contentBox"),c="."+this.get("itemClass");b.one(".button-remove-sel").on("click",this._removeSelected,this);b.one(".button-rename").on("click",
this._confirmChangeItems,this);b.one(".field-tag-filter-input").on("keyup",this._filterItems,this);b.one("select.select").on("change",this._updateSortFunction,this);this._editInput.on("keydown",this._handleChangeItemInput,this);b.one(".field-tag-cloud").delegate("click",this._selectItem,c,this);this.after("sortFnChange",this._sortItems,this);this.after("itemListChange",this.syncUI,this)},syncUI:function(){f.superclass.syncUI.call(this);var b=this.get("contentBox");this._refreshItemNodes();this._syncFooter();
this.setRelativeItemColorValue();b.one(".field-tag-filter-input").set("value","")},_selectItem:function(b){b=b.currentTarget;b.hasClass(this.get("itemClass"))&&b.toggleClass("selected");this._syncFooter()},_syncFooter:function(){var b=this.get("contentBox"),c=b.one(".button-rename > input"),b=b.all(".selected").size();c&&c.set("value",2>b?"Rename":"Merge");this._toggleFooter(0<b)},_removeSelected:function(c){c=this.get("contentBox").all(".selected."+this.get("itemClass"));1>c.size()||(c=this._getConfirmText(c.size(),
"remove"),this.removeDialog=(new b.Squarespace.Widgets.Confirmation({"strings.title":c.title,"strings.message":c.text})).on("confirm",this._removeConfirmCallback,this))},_confirmChangeItems:function(c){c=this.get("contentBox").all(".selected."+this.get("itemClass"));1>b.Lang.trim(this._editInput.get("value")).length||1>c.size()||(c=this._getConfirmText(c.size()),this.confirmDialog=(new b.Squarespace.Widgets.Confirmation({"strings.title":c.title,"strings.message":c.text})).on("confirm",this._confirmMergeSuccess,
this))},_filterItems:function(b){b=b.target.get("value");this._hideMatchedItems(b);this._syncFooter()},_handleChangeItemInput:function(b){13===b.keyCode?this._confirmChangeItems():27===b.keyCode&&this.halt()},_updateSortFunction:function(b){var f=this.get("contentBox");b=b.target.get("value");f.one(".field-tag-sort-inner").set("text",b);"Weight"===b?this.set("sortFn",c):"Activity"===b?this.set("sortFn",e):this.set("sortFn",d)},_sortItems:function(b){b=this.get("itemList").concat([]);b.sort(this.get("sortFn"));
this.set("itemList",b)},_toggleFooter:function(c){var e=this.get("contentBox");b.Lang.isUndefined(c)&&(c=!e.one(".tag-cloud-footer-wrapper").get("offsetHeight"));e.one(".tag-cloud-footer-wrapper").setStyles({height:c?this.get("footerHeight"):0,opacity:c?1:0})},setRelativeItemColorValue:function(){var c=this.get("itemList"),e=this.get("contentBox").all("."+this.get("itemClass")),d=0,f=Number.MAX_VALUE;1>c.length||(b.Array.each(c,function(b){d=Math.max(b.count,d);f=Math.min(b.count,f)}),e.each(function(c){var e;
e=f;var g=d,h=parseInt(c.getData("count"),10);e===g?e=100:1>h?e=50:(1>e&&(e=0.1),e=Math.log(h/e)/Math.log(g/e),e=parseInt(50*e+50,10));b.Squarespace.Utils.isDamaskEnabled()?c.setStyle("opacity",e/100):c.setStyle("color","hsl(0, 0%, "+e+"%)")}))},_getItemsFromServer:function(){b.Data.get({url:this.get("endpoints").load,data:{collectionId:this.get("collectionId")},success:function(c){if(b.Lang.isArray(c)){var e=this.get("sortFn");c.sort(e)}this.set("itemList",c)},failure:function(b){console.warn("Could not load data: error.",
b)}},this)},_requestMergeCollectionItems:function(b,c){var e={},d=this.get("mode");e["new"+d]=c;e["old"+d]=b;this._postToServer(e,this.get("endpoints").merge)},_requestDeleteCollectionItems:function(b){var c={};c[this.get("mode")]=b;this._postToServer(c,this.get("endpoints").remove)},_postToServer:function(c,e){var d=b.merge(c,{collectionId:this.get("collectionId")});b.Data.post({url:e,data:d,success:this._postToServerSuccess,failure:function(b){console.warn("Failed to complete request",b)}},this)},
_postToServerSuccess:function(c){c=b.Object.getValue(c,"collection"+this._getItemName(!0).capitalize());b.Lang.isArray(c)&&(c.sort(this.get("sortFn")),this.set("itemList",c))},_removeConfirmCallback:function(){var b=this.get("contentBox").all(".selected."+this.get("itemClass"));if(!(1>b.size())){var c=[];b.each(function(b){b=b.getData("name");c.push(b)},this);this._requestDeleteCollectionItems(c)}},_confirmMergeSuccess:function(){var b=[],c=this.get("contentBox").all(".selected."+this.get("itemClass"));
this.get("itemList");var e=this._editInput.get("value");this._editInput.set("value","");c.each(function(c){c=c.getData("name");b.push(c)},this);this._requestMergeCollectionItems(b,e)},_hideMatchedItems:function(b){this.get("contentBox").all("."+this.get("itemClass")).each(function(c){var e=0===c.getData("name").indexOf(b);c.toggleClass("hidden",!e);e||c.removeClass("selected")})},_refreshItemNodes:function(){var c=this.get("contentBox").one(".field-tag-cloud"),e=this.get("itemList");c.empty();c.toggleClass("field-tag-no-items",
1>e.length);if(1>e.length)c.set("text","This collection does not contain any "+this._getItemName(!0));else{var d=b.Node.create('<ul class="field-tag-list"></ul>');b.Array.each(e,function(b,c){d.append(this._createItemNode(b))},this);c.append(d)}},_createItemNode:function(c){var e=this.get("itemClass"),e=b.Node.create(b.Lang.sub('<li class="field-tag-list-item {itemClass}" tag="{name}" title="{count}"> <span class="field-tag-name  tag">{name}</span> </li>',{count:c.count,name:c.name,itemClass:e}));
e.setData(c);return e},_getItemName:function(b){return!b?this.get("mode"):"tag"===this.get("mode")?"tags":"categories"},_getConfirmText:function(c,e){var d=1<c,f=this._getItemName(d);"remove"!==e&&(e=d?"merge":"rename");return{title:e.capitalize()+" "+f.capitalize(),text:b.Lang.sub("Are you sure you would like to {action} {capName}? <strong>All items with {adjective} {name} will be updated.</strong>",{name:f,capName:f.capitalize(),adjective:d?"these":"this",action:e})}},_getHBTemplateContext:function(){var c=
this.getAttrs(),e={modePlural:"tag"===c.mode?"tags":"categories"};b.Lang.isArray(c.data)&&c.data.sort(this.get("sortFn"));return b.merge(c,e)}},{CSS_PREFIX:"sqs-content-stat-manager",HANDLEBARS_TEMPLATE:"dialog-content-stat-manager.html",ATTRS:{collectionId:{},itemList:{value:[],validator:b.Lang.isArray},endpoints:{value:{tag:{remove:"/api/commondata/RemoveTag",merge:"/api/commondata/MergeTags",load:"/api/commondata/GetCollectionTags"},category:{remove:"/api/commondata/RemoveCategory",merge:"/api/commondata/MergeCategories",
load:"/api/commondata/GetCollectionCategories"}},getter:function(b){return b[this.get("mode")]}},footerHeight:{value:50,validator:b.Lang.isNumber},itemClass:{value:"tag-cloud-item"},maxLength:{},mode:{value:"tag",validator:function(c){return-1!==b.Array.indexOf(["tag","category"],c)},getter:function(b){return b.toLocaleLowerCase()}},sortFn:{value:d,validator:b.Lang.isFunction},title:{}}})},"1.0",{requires:["base","node","squarespace-dialog-field-2","squarespace-dialog-content-stat-manager-template",
"squarespace-widgets-confirmation"]});YUI.add("squarespace-widgets-sync-model-list-manager",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.SyncModelListManager=b.Base.create("SyncModelListManager",b.Squarespace.Widgets.ModelListManager,[],{renderUI:function(){d.superclass.renderUI.call(this);this.get("header").render(this._headerNode);this.get("body").render(this._modelsNode)}},{CSS_PREFIX:"sqs-sync-model-list-manager",ATTRS:{}})},"1.0",{requires:["base","squarespace-widgets-model-list-manager"]});
YUI.add("squarespace-block-social-account-links-legacy-editor",function(b){b.namespace("Squarespace.Block.Editor").LegacySocialAccountLinks=b.Base.create("legacySocialAccountLinksEditor",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.LegacySocialAccountLinks")}},{NS:"blockEditor"})},"1.0",{requires:["base","squarespace-block-social-account-links-legacy-model-editor","squarespace-damask-context-globals"]});
YUI.add("squarespace-block-content-html-editor-email",function(b){b.namespace("Squarespace.Content").HtmlEditorEmail=b.Base.create("contentHtmlEditor",b.Squarespace.Content.HtmlEditor,[],{_getVisualEditorData:function(){var d=this.visualEditor.getEditorData();return b.Squarespace.Layout.EmailUtils.prepHtmlForEmail(d)}},{NS:"contentEditor"})},"2.0",{requires:["base","squarespace-block-content-html-editor","squarespace-layout-email-utils"]});
YUI.add("squarespace-dialog-shipping-container-table-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-shipping-container-table.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;return(b=d["with"].call(c,c.strings,{hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n\n  <div class="field-lhs top">\n    ';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=
b.title,f="function"===typeof f?f.apply(b):f);e+=l(f)+'\n  </div>\n  <div class="field-rhs">\n    <div class="field-description-wrapper">\n      <div class="field-description">\n        ';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f="function"===typeof f?f.apply(b):f);e+=l(f)+'\n      </div>\n    </div>\n\n    <table>\n      <thead>\n        <tr>\n          <th>\n            Container\n          </th>\n          <th>\n            Dimensions\n          </th>\n        </tr>\n      </thead>\n      <tbody class="table-body">\n        <tr class="empty-message"><td colspan="2">';
(f=d.emptyMessage)?f=f.call(b,{hash:{},data:c}):(f=b.emptyMessage,f="function"===typeof f?f.apply(b):f);return e+=l(f)+'</td></tr>\n      </tbody> \n    </table>\n\n    <div class="add-row">\n      <img src="/universal/images-v6/standard/icon_add_11_light.png" />\n    </div>\n\n  </div>\n'},k),data:k}))||0===b?b:""})})();b.Handlebars.registerPartial("dialog-shipping-container-table.html".replace("/","."),d.templates["dialog-shipping-container-table.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-mixin-aspect-ratio",function(b){b.namespace("Squarespace.Block.Mixin");b.Squarespace.Block.Mixin.AspectRatio=b.Base.create("aspectRatio",b.Base,[],{initializer:function(){this.get("boundingBox").addClass("sqs-aspect-ratio");this.after("intrinsicWrapperChange",this._swapIntrisincWrapper,this);b.after(this._bindAspectRatio,this,"bindUI");b.after(this._updateAspectRatio,this,"renderUI");b.after(this._updateAspectRatio,this,"syncUI");b.after(this._updateAspectRatio,this,"_renderSuccess")},
_bindAspectRatio:function(){this.get("model").after("change",this._afterModelChange,this)},_afterModelChange:function(b){this._updateAspectRatio()},_swapIntrisincWrapper:function(d){var c=this.get("model").get("aspectRatio");b.Lang.isValue(d.prevVal)&&this.destroyBlock(d.prevVal);b.Lang.isValue(d.newVal)&&c&&this.initializeBlock(d.newVal,c)},_updateAspectRatio:function(d){d=this.get("model").get("aspectRatio");var c=this.get("intrinsicWrapper");b.Lang.isValue(d)?!c.hasClass("sqs-intrinsic")||c.one("> div")&&
!c.one("> div").hasClass("sqs-intrinsic-content")?this.initializeBlock(c,d):this._setPadding(d):this.destroyBlock(c)},_setPadding:function(b){this.get("intrinsicWrapper").setStyle("paddingBottom",b+"%")},initializeBlock:function(d,c){b.Lang.isValue(c)&&(d.addClass("sqs-intrinsic"),d.setStyle("paddingBottom",c+"%"),d.one("> div")&&d.one("> div").addClass("sqs-intrinsic-content"))},destroyBlock:function(b){b.hasClass("sqs-intrinsic")&&(b.removeClass("sqs-intrinsic"),b.setStyle("padding-bottom",null),
b.one(".sqs-intrinsic-content")&&b.one(".sqs-intrinsic-content").removeClass("sqs-intrinsic-content"))}},{ATTRS:{intrinsicWrapper:{getter:function(){return this.get("contentBox")}}}})},"1.0",{requires:["base","node","squarespace-aspect-ratio-manager"]});
YUI.add("squarespace-dialog-shipping-diagram",function(b){b.namespace("Squarespace");var d=function(b){return Math.round(100*b)/100},c=b.namespace("Squarespace.DialogFields").ShippingSummary=b.Base.create("shippingSummary",b.Squarespace.DialogField2,[],{initializer:function(){c.superclass.initializer.call(this);var e=this.get("data").shippingConfiguration,f=this.get("data").order,g=e.get("containers"),p=0,q=0,r=0;g.each(function(b){p+=b.get("rate");q+=b.get("weight")});p=d(p/100);q=d(q);r=Math.round(100*
e.get("efficiency"));r=b.Lang.isNumber(r)?r+"%":"N/A";this.setAttrs({shippingMethod:f.purchasedCart.selectedShippingOption.name,numContainers:g.size(),totalCost:p,totalWeight:q,efficiency:r})}},{CSS_PREFIX:"sqs-shipping-summary",HANDLEBARS_TEMPLATE:"dialog-shipping-summary.html",ATTRS:{currencySymbol:{value:null},readOnly:{value:!0},weightUnit:{value:null}}}),e=b.namespace("Squarespace.DialogFields").ShippingDetails=b.Base.create("shippingDetails",b.Squarespace.DialogField2,[],{syncUI:function(){e.superclass.syncUI.call(this);
b.Lang.isValue(this.get("data"))&&(this._formatAttrs(),this._refresh())},_formatAttrs:function(){var c=this.get("data"),e=d(c.get("rate")/100),f=Math.round(100*c.get("weight"))/100,g=c.getUsedSpace(),q=c.getVolume(),r=d(c.get("length")),s=d(c.get("depth")),t=d(c.get("height")),c=Math.round(100*g/c.getVolume()),c=b.Lang.isNumber(c)?c+"%":"N/A";this.setAttrs({rate:e,weight:f,usedSpace:g,freeSpace:q,efficiency:c,cLength:r,cDepth:s,cHeight:t})},_refresh:function(){var b=this.get("contentBox"),c=this._getTemplateInfo(),
e=this._getHBTemplateContext(),c=c.template(e);b.empty();b.append(c)}},{CSS_PREFIX:"sqs-shipping-details",HANDLEBARS_TEMPLATE:"dialog-shipping-details.html",ATTRS:{currencySymbol:{value:null},dimensionUnit:{value:null},order:{value:null},readOnly:{value:!0},weightUnit:{value:null}}}),f=b.namespace("Squarespace.DialogFields").ShippingLegend=b.Base.create("shippingLegend",b.Squarespace.DialogField2,[],{genRandomGrey:function(){for(var b="#",c=(13*Math.random()<<0)+2,e=0;6>e;e++)var d=(c+0).toString(16),
b=b+d;return b},genRandomColor:function(){var b="#9e0142 #d53e4f #f46d43 #fdae61 #fee08b #ffffbf #e6f598 #abdda4 #66c2a5 #3288bd #5e4fa2".split(" ");return b[Math.floor(Math.random()*b.length)]},bindUI:function(){f.superclass.bindUI.call(this);var b=this.get("contentBox");b.delegate("mouseover",function(b){this.fire("item-activated",{boxIndex:Number(b.currentTarget.getAttribute("data-box-index"))})},".shipping-legend-item",this);b.delegate("mouseout",function(b){this.fire("item-activated",{boxIndex:-1})},
".shipping-legend-item",this)},syncUI:function(){f.superclass.syncUI.call(this);b.Lang.isValue(this.get("data"))&&(this._formatAttrs(),this._refresh())},_formatAttrs:function(){var b=this.get("data").get("packed"),c=1===b.size()?b.size()+" Item in Package":b.size()+" Items in Package",e=0;b.each(function(b){b.setAttrs({grayColor:this.genRandomGrey(),activeColor:this.genRandomColor(),length:d(b.get("length")),height:d(b.get("height")),depth:d(b.get("depth")),boxIndex:e,x:d(b.get("x")),y:d(b.get("y")),
z:d(b.get("z"))});e++},this);this.setAttrs({title:c,packed:b})},_refresh:function(){var b=this.get("contentBox"),c=this._getTemplateInfo(),e=this._getHBTemplateContext(),c=c.template(e);b.empty();b.append(c)},_getHBTemplateContext:function(){var c=f.superclass._getHBTemplateContext.call(this);b.Lang.isValue(c.packed)&&(c.packed=c.packed.toJSON());return c}},{CSS_PREFIX:"sqs-shipping-legend",HANDLEBARS_TEMPLATE:"dialog-shipping-legend.html",ATTRS:{currencySymbol:{value:null},dimensionUnit:{value:null},
order:{value:null},readOnly:{value:!0},weightUnit:{value:null}}}),g=b.namespace("Squarespace.DialogFields").ShippingRendering=b.Base.create("ShippingRendering",b.Squarespace.DialogField2,[],{renderUI:function(){g.superclass.renderUI.call(this);this._spinner=new b.Squarespace.Spinner({size:20,color:"light",render:this.get("contentBox")});this._spinner.spin()},syncUI:function(){g.superclass.syncUI.call(this);b.Lang.isValue(this.get("data"))&&this._refresh()},setActiveBoxIndex:function(b){this._activeBoxIndex=
b},_refresh:function(){var c,e,d,f,g,r=this.get("contentBox"),s=this.get("data"),t=this.get("canvasWidth"),u=this.get("canvasHeight"),v=function(){var c;c=t/u;if(!b.Lang.isNumber(c)||0>=c)throw"Shipping rendering aspect must be greater than 0";f=new THREE.PerspectiveCamera(45,c,0.1,1E3);f.position.y=0.75*s.get("height");c=Math.max(s.get("length"),s.get("height"),s.get("depth"));f.position.z=1.9*c;f.lookAt(d.position)},w=function(){var b=new THREE.SpotLight(16777215,1,0,Math.PI,1);b.position.set(0,
800,0);b.target.position.set(0,0,0);b.castShadow=!0;b.shadowCameraNear=700;b.shadowCameraFar=f.far;b.shadowCameraFov=10;b.shadowBias=1E-4;b.shadowDarkness=0.05;b.shadowMapWidth=1024;b.shadowMapHeight=1024;d.add(b)},y=function(b){var c,e;c=new THREE.MeshBasicMaterial({color:"#ccc",opacity:0.85,transparent:!0});e=new THREE.PlaneGeometry(1E3,1E3);c=new THREE.Mesh(e,c);e=(new THREE.Matrix4).makeRotationX(-Math.PI/2);c.applyMatrix(e);c.position.y=b;c.receiveShadow=!0;d.add(c)},z=[],B=function(){var b,
c;g=new THREE.Object3D;b=new THREE.MeshBasicMaterial({color:"#ffffff",opacity:0.3,transparent:!0});c=new THREE.CubeGeometry(s.get("length")+0.1,s.get("height")+0.1,s.get("depth")+0.1);b=new THREE.Mesh(c,b);b.castShadow=!0;b.receiveShadow=!1;g.add(b);boxes=s.get("packed");z=[];boxes.each(function(b){var c,e;c=new THREE.CubeGeometry(b.get("length"),b.get("height"),b.get("depth"));e=new THREE.MeshBasicMaterial({color:b.get("grayColor")});c=new THREE.Mesh(c,e);c.position.x=b.get("x")+b.get("length")/
2-s.get("length")/2;c.position.y=b.get("y")+b.get("height")/2-s.get("height")/2;c.position.z=b.get("z")+b.get("depth")/2-s.get("depth")/2;c.scale.multiplyScalar(0.97);g.add(c);z.push(e)});g.position.y=2;g.rotation.x=10*Math.PI/180;d.add(g)},A=function(){var e=b.Node.create('<div class="canvas-container"></div>');e.setStyles({width:t,height:u});e.append(c.domElement);r.append(b.Node.create('<div class="title">Packing Configuration</div>'));r.append(e)};b.bind(function(){return this._activeBoxIndex},
this);var K=b.bind(function(){var r=30*e.getDelta()*Math.PI/180;b.Array.each(z,function(c,e){var d=this._activeBoxIndex;e==d?c.color=new THREE.Color(boxes.item(d).get("activeColor")):b.Lang.isValue(boxes.item(e))&&(c.color=new THREE.Color(boxes.item(e).get("grayColor")))},this);requestAnimationFrame(K);g.rotation.y+=r;c.render(d,f)},this),O=function(){r.empty();if(0===s.getVolume()){var f=b.Node.create('<div class="canvas-container text">No dimensions provided for container items.</div>');f.setStyles({width:t,
height:u});r.append('<div class="title">Packing Configuration</div>');r.append(f);return!1}if(Detector.webgl)c=new THREE.WebGLRenderer({antialias:!0});else if(Detector.canvas)c=new THREE.CanvasRenderer({antialias:!0});else return f=Detector.addGetWebGLMessage(),r.append(f),!1;d=new THREE.Scene;e=new THREE.Clock(!0);c.setSize(t,u);c.setClearColor(13421772,1);c.shadowMapEnabled=!0;c.shadowMapSoft=!0;c.shadowMapType=THREE.PCFSoftShadowMap;return!0}(),E=-1*(3+s.get("height")/2);O&&(v(),w(),y(E),B(),A(),
K())}},{CSS_PREFIX:"sqs-shipping-diagram",ATTRS:{canvasHeight:{value:0,validator:function(c){return b.Lang.isNumber(c)}},canvasWidth:{value:0,validator:function(c){return b.Lang.isNumber(c)}},readOnly:{value:!0},time:{value:0}}})},"1.0",{requires:"base json-parse json-stringify squarespace-dialog-fields squarespace-dialog-field-2 squarespace-dialog-shipping-summary-template squarespace-dialog-shipping-details-template squarespace-dialog-shipping-legend-template thirdparty-threejs thirdparty-threejs-detector".split(" ")});
YUI.add("squarespace-block-editor-base",function(b){var d=function(){};b.namespace("Squarespace.Block.Editor").Base=b.Base.create("blockEditorBase",b.Plugin.Base,[],{initializer:function(){this._host=this.get("host");this._model=this._host.get("model");this._bb=this._host.get("boundingBox");this._cb=this._host.get("contentBox");this._createEditingOverlay();this._bindEvents();this._executeOrBindPlugInsertPoint();this.once("initializedChange",this._onceInitializedChange,this)},_bindEvents:function(){this._setEditingEvent(this.get("editingEvent"));
this.onHostEvent("editableChange",this._onBlur,this);this.after("editingChange",this._afterEditingChange,this);this.on("editingEventChange",this._onEditingEventChange,this);this.after("dropZoneLockedChange",this._afterDropZoneLockedChange,this);this.after(["resizableChange","resizeNodeChange"],this._syncResizable,this);this.afterHostEvent("blockEditor|focusedChange",this._afterFocusedChange,this);this._handles.push(this._model.after("blockEditor|floatDirChange",this._floatChange,this));this.on("remove",
this.removeBlock,this)},_onceInitializedChange:function(){this._initFocused();this._syncResizable();this._initEditable();this._initLockedLayout();this._initLayoutDrop()},_initLockedLayout:function(){this.get("host").get("boundingBox").toggleClass("sqs-block-locked-layout",this.get("lockedLayout"))},_createEditingOverlay:function(){var b=this.get("editingOverlay");b&&b.appendTo(this._bb)},_executeOrBindPlugInsertPoint:function(){this._layoutHasInsertPoints()&&(this._canPlugInsertPointsNow()?this._plugInsertPoint():
(this._handles.push(this._host.onceAfter("renderedChange",function(b){this._canPlugInsertPointsNow()&&this._plugInsertPoint()},this)),this.afterHostEvent("layout-rendered",this._plugInsertPoint,this)))},_canPlugInsertPointsNow:function(){var b=this.get("host"),e=b.get("contentBox");return b.get("rendered")&&!e.ancestor(".sqs-layout-rendering")},_updateModel:function(b){this._model.setAttrs(b);this._host.get("isNewBlock")&&this._host.set("isNewBlock",!1)},_afterFocusedChange:function(b){b.newVal?(this._onFocus(),
this._syncResizable()):this._onBlur()},_onFocus:d,_onBlur:d,_afterEditingChange:function(c){b.Lang.isValue(this._bb.getDOMNode())&&this._bb.toggleClass("sqs-block-editing",c.newVal)},_initEditable:function(){this._host.get("editable")&&(this._bb.addClass("sqs-block-editable"),this._host.get("isNewBlock")&&this.get("defaultEditingMode")&&this._enableEditing())},_initFocused:function(){this._host.get("isNewBlock")&&this._host.get("focusHandler").giveBlockSyntheticFocus(this._host)},_syncResizable:function(){this._toggleResizable(this.get("resizable")&&
this._host.get("focused"))},_toggleResizable:function(c){c?this.get("host").plug(b.Squarespace.Block.Plugin.Resizable,{resizeNode:this.get("resizeNode"),blockEditor:this}):this.get("host").unplug(b.Squarespace.Block.Plugin.Resizable)},beforeLayoutDrag:d,afterLayoutDrag:d,cleanBlock:d,_initLayoutDrop:function(){this.get("lockedLayout")||(this.drop=new b.Squarespace.Layout.Drop({node:this._bb,groups:["blocks"],lock:!!this._model.get("floatDir")}))},_plugInsertPoint:function(){this._host.hasPlugin(b.Squarespace.Layout.InsertPoint.NS)||
this._host.plug(b.Squarespace.Layout.InsertPoint,{layoutNode:this._bb.ancestor(".sqs-layout"),divideSelectors:this.get("selectorsForInsertPoints")})},_layoutHasInsertPoints:function(){return!this._host.get("editController").isMobileApp()&&!this.get("lockedLayout")},_floatChange:function(){this.set("dropZoneLocked",!!this._model.get("floatDir"));this._bb.one(".sqs-helper")&&(this._host.get("model").get("floatDir")?this._bb.one(".sqs-helper").show():this._bb.one(".sqs-helper").hide())},getMobileAppMenuConfig:function(){return null},
_afterDropZoneLockedChange:function(b){this.drop&&this.drop.set("lock",b.newVal)},_onEditingEventChange:function(b){this._setEditingEvent(b.newVal)},_setEditingEvent:function(b){this.editingEvent&&this.editingEvent.detach();b&&(this.editingEvent=this._handles.push(this._bb.on(b,this._enableEditing,this)))},_enableEditing:function(){this.set("editing",!0)},_disableEditing:function(){this.set("editing",!1)},removeBlock:function(b){this._host.removeBlock(!0===b);this.destroy()},destructor:function(){this._host.detach("blockEditor|*");
this._model.detach("blockEditor|*");this.drop&&this.drop.destroy();var c=this.get("editingOverlay");b.Lang.isValue(c)&&c.remove(!0);this._bb.removeClass("sqs-block-editable");this._bb.removeClass("sqs-block-editing");this._host.unplug(b.Squarespace.Layout.InsertPoint)}},{NS:"blockEditor",ATTRS:{editing:{value:!1,setter:function(b){return!(!b||!this._host.get("editable"))}},editingOverlay:{valueFn:function(){return null},validator:function(c){return null===c||c instanceof b.Node}},dropZoneLocked:{value:!1},
lockedLayout:{getter:function(c){if(b.Lang.isValue(c))return c;c=this.get("host").get("boundingBox");c=b.Lang.isValue(c)?c.ancestor(".sqs-layout"):null;return b.Lang.isValue(c)&&c.hasClass("sqs-locked-layout")}},selectorsForInsertPoints:{value:"",validator:b.Lang.isString},minHSize:{value:1,validator:b.Lang.isNumber},resizable:{value:!1},resizeNode:{valueFn:function(){return this.get("host").get("boundingBox")}},resizeDefaultSize:{value:75},resizeSnapToDefaultSize:{value:!0},snapToThreshold:{value:10,
validator:b.Lang.isNumber},editingEvent:{value:null,lazyAdd:!1},defaultEditingMode:{value:!1}}})},"1.0",{requires:"base plugin squarespace-block-focus-handler squarespace-block-plugin-resizable squarespace-util squarespace-widget-resize squarespace-layout-drop".split(" ")});
YUI.add("squarespace-block-horizontal-rule",function(b){b.namespace("Squarespace.ContentModel").HorizontalRule=b.Base.create("HorizontalRuleContentModel",b.Model,[],{},{});b.namespace("Squarespace.Block").HorizontalRule=b.Base.create("block-horizontalrule",b.Squarespace.Block.Base,[],{renderUI:function(){var d=b.Node.create("<hr>");this.get("contentBox").appendChild(d)}},{CSS_PREFIX:"sqs-block-horizontalrule",MODEL:b.Squarespace.ContentModel.HorizontalRule,ATTRS:{editor:{valueFn:function(){return b.Squarespace.Block.Editor.HorizontalRule}},
mobileEditor:{valueFn:function(){return b.Squarespace.Block.Editor.HorizontalRule}},emailEditor:{valueFn:function(){return b.Squarespace.Block.Editor.HorizontalRuleEmail}},type:{value:b.Squarespace.BlockType.HORIZONTAL_RULE}}})},"1.0",{requires:["squarespace-ss-widget","squarespace-block-base","squarespace-block-horizontal-rule-editor"]});
YUI.add("squarespace-stats-block-gauge-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["stats-block-gauge.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="sqs-gauge">\n  <div class="graphic"></div>\n\n  <div class="description">\n    <div class="datametric">';(h=d.dataMetric)?h=h.call(c,{hash:{},data:k}):(h=c.dataMetric,h="function"===typeof h?h.apply(c):h);
b+=l(h)+'</div>\n    <div class="timeframe">';(h=d.timeFrame)?h=h.call(c,{hash:{},data:k}):(h=c.timeFrame,h="function"===typeof h?h.apply(c):h);return b+=l(h)+"</div>\n  </div>\n</div>"})})();b.Handlebars.registerPartial("stats-block-gauge.html".replace("/","."),d.templates["stats-block-gauge.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-settings-activity-mobile-usage",function(b){b.namespace("Squarespace.Settings.Activity");b.Squarespace.Settings.Activity.MobileUsage=b.Base.create("ActivityManagerMobileUsage",b.Squarespace.Settings.Activity.BaseManager,[],{_isDataEmpty:function(d){return!(b.Lang.isArray(d.deviceBySegment)&&0<d.deviceBySegment.length)},_renderSuccess:function(d){this.get("contentBox");var c=this.get("activeTab"),e=b.Node.create('<div class="chart-container clear line">'),f=b.Node.create('<div class="summary line clear">'),
g=this.get("contentBody"),h;if(!this._isDataEmpty(d)){h=Math.max(d.desktopTotal+d.mobileTotal,1);var k=this.renderSummary((100*(d.desktopTotal/h)).toFixed(2),d.desktopTotal,"total","Desktop",!0).addClass("desktop-summary");h=this.renderSummary((100*(d.mobileTotal/h)).toFixed(2),d.mobileTotal,"total","Mobile",!0).addClass("mobile-summary");f.append(k).append(h);this._addToolTips()}g.append(e).append(f);f=b.Node.create('<div class="traffic-details clear"></div>');k=b.Node.create('<div class="detail overview"></div>');
this._isDataEmpty(d)||b.Array.each(d.deviceBySegment,function(b,c){var e=Math.max(b.desktop+b.mobile,1);b.desktop=(100*(b.desktop/e)).toFixed(2);b.mobile=(100*(b.mobile/e)).toFixed(2)});0<d.deviceBySegment.length&&(h=b.Node.create('<div class="table mobile-usage">'),(new b.Squarespace.BarTable({data:[].concat(d.deviceBySegment).reverse(),key:"timePeriodShort",values:["desktop","mobile"],valueNameMap:{desktop:"desktop",mobile:"mobile"},toolTips:{desktop:"Percentage of pageviews originating from a desktop device.",
mobile:"Percentage of pageviews originating from a mobile device."}})).render(h),k.append(h));f.append(k);k=b.Node.create('<div class="analyses"></div>');this._isDataEmpty(d)||(k.append(this.renderAnalysis("Desktop OS",d["desktop os"],"os")),k.append(this.renderAnalysis("Mobile OS",d["mobile os"],"os")));f.append(k);g.append(f);this.renderDeviceOverviewChart(d,e,c)},_addToolTips:function(){new b.Squarespace.ToolTip({target:".desktop-summary",title:"Desktop",body:"Percentage of pageviews originating from a desktop device."});
new b.Squarespace.ToolTip({target:".mobile-summary",title:"Mobile",body:"Percentage of pageviews originating from a mobile device."})},renderDeviceOverviewChart:function(d,c,e){if(0===d.deviceBySegment.length)c.append(this.renderNoData());else{var f={font:"Helvetica Neue","font-size":"10px",fill:"#a3a3a3"},g={"letter-spacing":"1px",font:"Helvetica Neue","font-weight":700,"font-size":"7px",fill:"#fff"},h={targetContainer:b.Node.getDOMNode(c),gridColor:"#e9e9e9",width:716,height:235,animate:!0,yAxisLabelStyle:f,
labelFunc:function(b,c,e,d){var h=b.text(c,e-2,d.text).attr(f).toBack();d.image&&b.image(d.image,c-10,e+h.getBBox().height-2,20,15);d.subText&&(e=e+h.getBBox().height+2,c=b.text(c,e+3,d.subText).attr(g).getBBox(),b.rect(c.x-2,c.y-3,c.width+4,c.height+6).attr({stroke:"#c6c6c6",fill:"#c6c6c6"}).toBack())},labels:[],lines:[]},k={title:"Mobile",fillStyle:{fill:"#c4c4c4",opacity:0.4},lineStyle:{stroke:"#222222","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#333"},data:[]},l=
{title:"Desktop",fillStyle:{fill:"#949494",opacity:0.8},lineStyle:{stroke:"#828282","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#797979"},data:[]};h.lines=[k,l];h.is_percentage=!0;var p="";b.Array.each(d.deviceBySegment,function(b){var c=this.formatShortDate(b,e),d={text:c.primary,flyout:b.timePeriodShort,toString:function(){return this.flyout}},c=c.secondary.toUpperCase();c!==p&&(p=d.subText=c);h.labels.push(d);l.data.push(b.desktop);k.data.push(b.mobile)},this);new b.Squarespace.Graphing.LineChart(h)}}},
{CSS_PREFIX:"sqs-activity-manager-mobile-usage",ATTRS:{activeTab:{value:"month"},strings:{value:{title:"Mobile Usage"}},requestParams:{getter:function(){return{name:"device",segmentName:this.get("activeTab"),verbose:"true"}}}}})},"1.0",{requires:["base","squarespace-graphing","squarespace-settings-activity-base-manager"]});
YUI.add("squarespace-terms-of-service-overlay",function(b){var d=b.namespace("Squarespace.Widgets").TermsOfService=b.Base.create("termsOfServiceOverlay",b.Squarespace.Widgets.SSWidget,[b.Overlay],{renderUI:function(){d.superclass.renderUI.call(this);this._animateIn()},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("contentBox");b.Squarespace.EscManager&&this.after("visibleChange",this._toggleEscapeManager,this);b.delegate("click",this._acceptNewToS,c,".button.accept",this);b.delegate("click",
this._rejectNewToS,c,".button.cancel, .close-button",this);this.after("frameContentChange",this._updateFrameContent,this)},_toggleEscapeManager:function(){this.get("visible")?b.Squarespace.EscManager.addTarget(this):b.Squarespace.EscManager.removeTarget(this)},_animateIn:function(){this.get("boundingBox").setStyles({opacity:1,transform:"scale(1)"})},_animateOut:function(){var c=new b.Anim({node:this.get("boundingBox"),duration:0.3,easing:b.Easing.easeOutStrong,to:{opacity:0,transform:"scale(0.94)"},
from:{opacity:1,transform:"scale(1)"}});this._anims.add(c);c.after("end",function(){this.set("visible",!1);this.destroy()},this);c.run()},_acceptNewToS:function(b){b.halt();this._setUserToS()},_setUserToS:function(){var c=this.get("websiteSettings"),e=c.get("lastAgreedTermsOfService"),d=this.get("mostRecentToSVersion");c.set("lastAgreedTermsOfService",this.get("mostRecentToSVersion"));c.save(b.bind(function(){b.Squarespace.Analytics.trackInternal("engagement_terms_of_service_updated",{oldTOSVersion:e,
agreedTOSVersion:d});this._animateOut()},this))},_rejectNewToS:function(c){c.preventDefault();var e=this.get("websiteSettings").get("mostRecentToSVersion");(new b.Squarespace.Widgets.Confirmation({"strings.title":"Reject Terms of Servce","strings.message":"Are you sure you wish to reject the Terms of Service? You will not be able to edit your website.","strings.confirm":"Reject Terms of Service"})).on("confirm",function(){b.Squarespace.Analytics.trackInternal("engagement_terms_of_service_rejected",
{rejectedVersion:e});window.location="http://www.squarespace.com"},this)}},{HANDLEBARS_TEMPLATE:"terms-of-service-overlay.html",CSS_PREFIX:"sqs-terms-of-service-overlay",ATTRS:{websiteSettings:{setter:function(c){return!b.instanceOf(c,b.Squarespace.Models.WebsiteSettings)?new b.Squarespace.Models.WebsiteSettings(c):c}},mostRecentToSVersion:{},endPoint:{value:"/api/config/acceptTos"},tosURL:{value:"https://www.squarespace.com/terms-of-service"},strings:{value:{title:"Updated Terms of Service",accept:"I accept, continue to my account.",
cancel:"Cancel"}},iframeHeight:{value:400},align:{value:{node:null,points:[b.WidgetPositionAlign.TL,b.WidgetPositionAlign.TL]}},zIndex:{value:300001}}})},"1.0",{requires:"base overlay squarespace-ss-widget squarespace-terms-of-service-overlay-template squarespace-util squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-dialog-state-option",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.StateOption=b.Base.create("StateOption",b.Squarespace.DialogField2,[],{intializer:function(){this.publish("stateSelected")},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox"),e=this.get("data");b.one(".title").setContent(e.title);b.one(".description").setContent(e.optionDesc)},bindUI:function(){d.superclass.bindUI.call(this);this.get("boundingBox").on("click",
function(b){this.set("isSelected",!0)},this);this.after("isSelectedChange",this._syncClass,this)},_syncClass:function(b){this.get("boundingBox").toggleClass(this.getClassName("selected"),!!b.newVal);b.newVal&&this.fire("stateSelected")},didDataChange:function(){return objEqual(this.get("data"),this._initialData)}},{CSS_PREFIX:"sqs-state-option",TEMPLATE:'<div class="sqs-state-option-wrapper"><div class="title">{title}</div><div class="description">{optionDesc}</div></div>',ATTRS:{readOnly:{value:!0},
data:{value:null},isSelected:{value:!1}}})},"1.0",{requires:["base","base-build","squarespace-dialog-fields","squarespace-dialog-field-2"]});
YUI.add("squarespace-widgets-audio-player",function(b){var d,c=b.namespace("Squarespace.Widgets").AudioPlayerMinimal=b.Base.create("audioPlayer",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this.setAttrs(this.get("render").getData());""===this.get("title")&&this.set("title","Untitled");this.set("showDownload","true"===this.get("show-download"));this.set("colorTheme",this.get("color-theme"));this.set("artistName",this.get("author"));this._contentBox=this.get("contentBox")},render:function(){var e=
arguments,f=b.bind(function(){d.onready(b.bind(function(){c.superclass.render.apply(this,e)},this))},this);d?f():b.use("thirdparty-soundmanager2",b.bind(function(b){d=soundManager;f()},this))},renderUI:function(){c.superclass.renderUI.call(this);this._playerNode=this._contentBox.one(".player");this._actionNode=this._playerNode.one(".action");this._timeNode=this._playerNode.one(".time");this._trackNode=this._playerNode.one(".track");this._labelsNode=this._playerNode.one(".labels");this._titleNode=
this._labelsNode.one(".title");this.get("showDownload")&&this._renderDownloadLink();this.get("boundingBox").addClass(this.get("colorTheme"));this._createSound()},bindUI:function(){this._contentBox.one(".action").on("click",this._togglePlaying,this);this._setupScrubber();this.after("playingChange",this.syncUI,this);this.after("progressChange",function(b){var c=this._timeNode.one(".progress");c.setContent(b.newVal);c.addClass("loaded")},this);this.after("durationChange",function(b){var c=this._timeNode.one(".total");
c.setContent(b.newVal);c.addClass("loaded");this.syncUI()},this);this.after("titleChange",function(b){this._labelsNode.one(".title").setContent(b.newVal)},this);this.after("artistNameChange",function(b){this._labelsNode.one(".artistName").setContent(b.newVal)},this);this._trackNode.on("click",this._updatePosition,this);var c=new b.Squarespace.ResizeEmitter;this._registerEvent(c.on("resize:end",this.syncUI,this));this.get("boundingBox").plug(b.Squarespace.NodeDestroyNotifier,{onDestroy:this.destroy,
context:this})},syncUI:function(){var b=this.get("boundingBox"),c=b.get("offsetWidth");this._trackNode.setStyle("width",c);b.toggleClass("playing",this.get("playing"));b.toggleClass("tiny",300>c);b.toggleClass("no-artist",""===this.get("artistName"));b=this._titleNode.get("offsetWidth")<this._titleNode.get("scrollWidth");this._titleNode.toggleClass("marquee-mark",b)},_renderNativeAudio:function(){var e=b.Lang.sub(c.NATIVE_TEMPLATE,this.getAttrs());this._contentBox.replace(b.Node.create(e))},_renderDownloadLink:function(){var c=
'<div class="download"><a href="'+b.Squarespace.UrlUtils.addQueryParam(this.get("url"),"download","true")+'" target="_blank">Download</a></div>';this._downloadNode=this._playerNode.one(".secondary-controls").appendChild(c);this._playerNode.addClass("download")},_renderVisualizer:function(){for(var b=this._contentBox.one(".visualizer"),c="",d=0;100>d;d++)c+='<div class="eq-bar"><div class="height"></div></div>';b.append(c)},_togglePlaying:function(c){c.halt();b.UA.ios?window.location.href=this.get("url"):
(this.set("playing",!this.get("playing")),this.get("playing")?(d.pauseAll(),this._sound.play()):this._sound.pause())},_createSound:function(){var c=this.get("url");0<c.indexOf(Static.SQUARESPACE_CONTEXT.appDomain)&&(c=c.replace(/^(http:\/\/|https:\/\/|\/\/)/i,window.location.protocol+"//"));var f=b.bind(this.set,this,"playing",!1);this._sound=d.createSound({id:"squarespaceTrack-"+this.get("id"),url:c,volume:this.get("volume"),autoPlay:!1,autoLoad:!0,whileplaying:b.bind(this._whilePlaying,this),onload:b.bind(function(){this.get("destroyed")||
(this.set("duration",this._durationToStr(this.get("trueDuration"))),this._sound.onpause=f,this._sound.onfinish=f)},this)})},_whilePlaying:function(){this.get("playing")&&(this._contentBox.one(".track .played").setStyle("width",100*(this._sound.position/this.get("trueDuration"))+"%"),this.set("progress",this._durationToStr(this._sound.position)))},_mergeEQData:function(){for(var b=this._sound.eqData.left,c=this._sound.eqData.right,d=b.length,h=[],k=0;k<d;k++)h.push((parseFloat(b[k])+parseFloat(c[k]))/
2);return h},_calculateEQChunks:function(){for(var c=this._mergeEQData(),d=[],g=0;g<length;g+=2){var h=0;b.Array.each(c.slice(g,g+2),function(b){h+=b});d.push(75*(h/2))}return d},_drawEQBars:function(){var c=this._contentBox.all(".eq-bar .height"),d=this._calculateEQChunks();b.Array.each(d,function(g,h){var k=c.item(h);b.Lang.isValue(k)&&k.setStyle("height",Math.min(45,d[h]))},this);this.syncUI()},_setupScrubber:function(){var c=this._contentBox.one(".played .icon"),d=b.Node.create('<div class="scrubber-shim"></div>'),
g;d.setStyles({position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:Math.pow(10,7),cursor:"none"});c.on("mousedown",function(c){var e=this._sound.volume;g=this._contentBox.one(".track").get("region");this._sound.setVolume(0.25*e);b.one("body").append(d);d.once("mouseup",function(){this._sound.setVolume(e);d.remove()},this)},this);var h=this._contentBox.one(".track .played .icon").get("offsetWidth")/2;d.on("mousemove",function(b){this._sound.setPosition(this._getRelativePosition(g,b.pageX-h))},this)},
_updatePosition:function(b){b.halt();if(this.get("playing")){var c=this._contentBox.one(".track").get("region"),d=this._contentBox.one(".track .played .icon").get("offsetWidth")/2;this._sound.setPosition(this._getRelativePosition(c,b.pageX-d))}},_durationToStr:function(b){var c=Math.floor(b/1E3%60);b=Math.floor(b/6E4);10>c&&(c="0"+c);return b+":"+c},_getRelativePosition:function(b,c){return this.get("trueDuration")*Math.min(1,Math.max(0,(c-b.left)/b.width))},_selectVolume:function(b){var c=this._contentBox.all(".player .volume .bar");
c.removeClass("active");c.filter(function(c){return parseInt(c.getAttribute("data-level"),10)<=b}).addClass("active");this._sound.setVolume(b)}},{CSS_PREFIX:"sqs-widgets-audio-player",HANDLEBARS_TEMPLATE:"block-audio-player.html",ATTRS:{progress:{},duration:{},trueDuration:{getter:function(){var c=this.get("duration-in-ms");return b.Lang.isString(c)&&""!==c?c:b.Lang.isValue(this._sound)?this._sound.duration:0}},title:{value:""},artistName:{value:""},playing:{value:!1},volume:{value:100}}})},"1.0",
{requires:"base node widget squarespace-url-utils squarespace-block-audio-player-template thirdparty-soundmanager2".split(" ")});
YUI.add("squarespace-save-manager",function(b){b.namespace("Squarespace");b.Squarespace.QueueManager=b.Base.create("QueueManager",b.Base,[],{initializer:function(d){this.queue=new b.AsyncQueue;this.queue.on("execute",this._onTaskExecute,this)},addTask:function(d){b.Lang.isFunction(d)&&(d={fn:d});b.Lang.isUndefined(d.args)&&(d.args=[]);d.args.push(b.bind(this._taskDoneCallback,this));var c=0===this.queue.size()&&!this.isRunning();this.get("isSingleTaskQueue")||0<this.queue.size()&&this.queue.stop();
this.queue.add(d);c&&this.queue.run()},isRunning:function(){return this.get("isRunning")},_onTaskExecute:function(b){this.queue.pause();this.set("isRunning",!0)},_taskDoneCallback:function(){0<this.queue.size()?this.queue.run():this.set("isRunning",!1)}},{ATTRS:{isRunning:{value:!1,validator:b.Lang.isBoolean},isSingleTaskQueue:{value:!0,validator:b.Lang.isBoolean}}});b.Squarespace.SaveManager=b.Base.create("SaveManager",b.Squarespace.QueueManager,[],{save:function(d,c){this.addTask({fn:this._runTask,
args:[b.clone(d),c],context:this})},_runTask:function(d,c,e){d.success=this._wrapDone(d.success,e);d.failure=this._wrapDone(d.failure,e);b.Lang.isFunction(d.buildData)&&(d.data=d.buildData());b.Data.post(d,c)},_wrapDone:function(d,c){return function(e){b.Lang.isUndefined(d)||d(e);c()}}})},"1.0",{requires:["async-queue"]});
YUI.add("squarespace-block-soundcloud",function(b){b.namespace("Squarespace.ContentModel").SoundCloud=b.Base.create("SpacerBlockModel",b.Model,[],{},{ATTRS:{aspectRatio:{value:67}}});b.namespace("Squarespace.Block").SoundCloud=b.Base.create("block-soundcloud",b.Squarespace.Block.ModelSyncBase,[b.Squarespace.Block.Mixin.AspectRatio],{_renderSuccess:function(d){var c=b.Node.create("<div></div>");c.insert(d.html);b.Squarespace.UrlUtils.securifyBlockEmbed(c);this.get("contentBox").setHTML(c)}},{CSS_PREFIX:"sqs-block-soundcloud",
MODEL:b.Squarespace.ContentModel.SoundCloud,ATTRS:{editor:{value:b.Squarespace.Block.Editor.SoundCloud},type:{value:b.Squarespace.BlockType.SOUNDCLOUD}}})},"1.0",{requires:["squarespace-enum","squarespace-url-utils","squarespace-block-base-modelsync","squarespace-block-soundcloud-editor"]});
YUI.add("squarespace-widgets-inventory-manager",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Widgets.InventoryManager=b.Base.create("InventoryManager",b.Squarespace.Widgets.SyncModelListManager,[],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-manager-content");this.get("models").load()}},{CSS_PREFIX:"sqs-inventory-manager",ATTRS:{constructors:{value:{models:b.Squarespace.Models.Inventory,header:b.Squarespace.Widgets.InventoryHeader,body:b.Squarespace.Widgets.Inventory}}}})},
"1.0",{requires:["base","squarespace-models-inventory","squarespace-widgets-inventory","squarespace-widgets-inventory-header","squarespace-widgets-sync-model-list-manager"]});
YUI.add("squarespace-content-item-types-link",function(b){b.namespace("Squarespace.ContentItemEditor").Link=b.Base.create("LinkContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",width:800,height:370,overlay:0.5,initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.link"]},{$include:"tabs.options.default"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",
{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-commerce-coupon-formatters",function(b){b.namespace("Squarespace.CommerceCouponFormatters");b.Squarespace.CommerceCouponFormatters={getStoreCollections:function(){return b.Squarespace.ContentCollectionCache.filter(function(d){return(d=d.getTemplateConfiguration())?d.get("collectionType")==b.Squarespace.CollectionTypes.PRODUCT&&!1===d.get("folder"):!1})},getCouponSummary:function(d){var c,e,f=b.clone(d),f=b.Squarespace.Commerce.normalizeAndCleanCouponData(f);f.minPrice=b.Squarespace.Commerce.moneyString(d.minPrice);
f.productTitle=f.productTitle||"?";switch(d.type){case b.Squarespace.CommerceCouponType.ALL_ORDERS:c="Save <strong>{discountAmt}</strong> on any order.";e="<strong>Free shipping on any order.</strong>";break;case b.Squarespace.CommerceCouponType.ORDERS_OVER:c="Save <strong>{discountAmt}</strong> on any order over <strong>{minPrice}</strong>.";e="<strong>Free shipping</strong> on any order over <strong>{minPrice}</strong>.";break;case b.Squarespace.CommerceCouponType.CATEGORIES:if(Static.IN_BACKEND){var g=
f.categories;g&&0!==g.length?(c='Save <strong>{discountAmt}</strong> on every item from categories:<ul class="category-list">',b.Array.each(g,function(b,e){c=e!==g.length-1?c+("<li><strong>"+b+"</strong>, </li>"):c+("<li><strong>"+b+"</strong></li>")},this),c+="</ul>"):c="Save <strong>{discountAmt}</strong> on every item from: <div>No category selections.</div>"}else c="Save <strong>{discountAmt}</strong> on select products.";break;case b.Squarespace.CommerceCouponType.SINGLE_PRODUCT:c="Save <strong>{discountAmt}</strong> on one <strong>{productTitle}</strong>.";
break;default:throw"Unsupported coupon type";}switch(d.discountType){case b.Squarespace.CommerceDiscountType.FLAT:f.discountAmt=b.Squarespace.Commerce.moneyString(d.discountAmt);break;case b.Squarespace.CommerceDiscountType.PERCENTAGE:f.discountAmt=d.discountAmt+"%";break;case b.Squarespace.CommerceDiscountType.FREE_SHIPPING:return b.Lang.sub(e,f)}return b.Lang.sub(c,f)}}},"1.0",{requires:["squarespace-util","squarespace-commerce-utils"]});
YUI.add("squarespace-dialog-form-selector",function(b){b.namespace("Squarespace.DialogFields");var d={};d[b.Squarespace.FormType.PRODUCT]=b.Squarespace.ProductFormModelEditor;var c=b.Squarespace.DialogFields.FormSelector=b.Base.create("formSelector",b.Squarespace.DialogField2,[],{initializer:function(){b.Squarespace.FormCache.load(b.bind(function(){this._set("dataLoaded",!0)},this))},destructor:function(){this._loadingTimer&&this._loadingTimer.cancel()},renderUI:function(){c.superclass.renderUI.call(this);
var e=this.get("contentBox");this.get("dataLoaded")||this.get("boundingBox").addClass("content-loading");var d=e.appendChild('<div class="loading-state"><div class="spinner"></div><div class="text">Loading...</div></div>');(new b.Squarespace.Spinner({size:20,color:"dark",render:d.one(".spinner")})).spin();d=this.get("strings.noFormMessage");this._noFormEl=e.appendChild('<div class="no-form"><div class="name">'+d+"</div></div>");this._addFormEl=e.appendChild('<div class="add-form"><div class="title"><div class="title-icon"></div><div class="title-text">Create New Form</span></div>')},
bindUI:function(){c.superclass.bindUI.call(this);this.after("dataLoadedChange",this.syncUI,this);this._bindFormCache();this.get("contentBox").delegate("click",function(b){var c=b.currentTarget;b.target.test(".edit")?this._editForm(c):c.hasClass("selected")||(b=c.hasClass("no-form"),c=c.getAttribute("data-form-id"),this.set("data",b?null:c,{noSyncUI:!0}),this._updateSelectedFormNode())},".form, .no-form",this);this._addFormEl.on("click",this._addForm,this)},syncUI:function(){c.superclass.syncUI.call(this);
if(this.get("dataLoaded")){this._setLoadedState();this.get("contentBox").all(".form").remove(!0);var e=this.get("formType"),e=b.Squarespace.FormCache.filterByType(e);b.Array.each(e,this._addFormNode,this);this._updateSelectedFormNode()}else this._setLoadingState()},_setLoadedState:function(){this._loadingTimer&&this._loadingTimer.cancel();this.get("boundingBox").removeClass("content-loading")},_setLoadingState:function(){this._loadingTimer&&this._loadingTimer.cancel();this._loadingTimer=b.later(500,
this,function(){this.get("boundingBox").addClass("content-loading")})},_bindFormCache:function(){var c=b.Squarespace.FormCache;this._registerEvent(c.after("reset",this.syncUI,this));this._registerEvent(c.after("add",function(b){this._addFormNode(b.model)},this));this._registerEvent(c.after("remove",function(b){b=b.model;this._removeFormNode(b);b.get("id")===this.get("data")&&(this.set("data",null,{noSyncUI:!0}),this._updateSelectedFormNode())},this));this._registerEvent(c.after("*:save",function(b){this._updateFormNode(b.target)},
this))},_addFormNode:function(c){var d=b.Node.create('<div class="form" data-form-id="'+c.get("id")+'"><div class="name">'+c.get("name")+'</div><div class="edit">EDIT</div></div>');c.get("id")===this.get("data")&&d.addClass("selected");d.setData("form",c);this._addFormEl.insert(d,"before");return d},_updateFormNode:function(b){var c=this._getFormNode(b.get("id")).one(".name");b=b.get("name");b!==c.getHTML()&&c.setHTML(b)},_removeFormNode:function(b){this._getFormNode(b.get("id")).remove(!0)},_getFormNode:function(b){return this.get("contentBox").one('[data-form-id="'+
b+'"]')},_updateSelectedFormNode:function(){var b=this.get("contentBox").one(".selected");b&&b.removeClass("selected");(b=this.get("data"))?this._getFormNode(b).addClass("selected"):this._noFormEl.addClass("selected")},_editForm:function(b){var c=d[this.get("formType")];b=b.getData("form");(new c({model:b})).show()},_addForm:function(){var c=this.get("formType"),f=d[c],g=new b.Squarespace.Models.Form({type:c,name:"New Form",useLightbox:!1});g.onceAfter("save",function(){b.Squarespace.FormCache.add(g);
this.set("data",g.get("id"),{noSyncUI:!0});this._updateSelectedFormNode()},this);(new f({model:g})).show()}},{CSS_PREFIX:"sqs-form-selector",ATTRS:{data:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},formType:{value:b.Squarespace.FormType.BLOCK,validator:function(c){return!b.Object.hasValue(b.Squarespace.FormType,c)?(console.error("Form Selector: Invalid formType."),!1):!0},writeOnce:"initOnly"},dataLoaded:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0},
strings:{value:{noFormMessage:"No Form Required"},validator:b.Squarespace.AttrValidators.isObject,writeOnce:"initOnly"}}})},"1.0",{requires:"base node squarespace-enum squarespace-dialog-field-2 squarespace-models-form squarespace-editor-form-product squarespace-spinner squarespace-attr-validators".split(" ")});
YUI.add("squarespace-block-summary-gallery",function(b){var d=b.namespace("Squarespace.Block").SummaryGallery=b.Base.create("block-summary-gallery",b.Squarespace.Block.SocialSummaryBase,[b.Squarespace.Block.Mixin.AspectRatio],{bindUI:function(){d.superclass.bindUI.call(this);this.after("resized",this.syncUI,this);this.after("widgetContentChange",this._setWidgetContent,this)},_renderBlock:function(b){this.get("boundingBox").setData("block",this.get("model").getAttrs());this._shouldGetWidgetRendering(b)?
(this.requestingContent=!0,d.superclass._renderBlock.call(this)):this.fire("widget:contentUpdate")},_renderSuccess:function(b){this.requestingContent=!1;this.set("widgetContent",b.html);this._setWidgetContent()},_setWidgetContent:function(){if(!this.requestingContent){var c=b.Node.create(this.get("widgetContent")),e=this.get("contentBox");e.setHTML(c);this.get("model").get("aspectRatio")&&e.one(".sqs-state-message")&&e.one(".sqs-state-message").wrap("<div></div>");b.Squarespace.GalleryManager.initializeBlock(e);
this._updateAspectRatio()}},_shouldGetWidgetRendering:function(c){return!b.Lang.isValue(c)||!b.Object.hasKey(c,"changed")?!0:!b.Squarespace.Block.Utils.checkWhitelist(this.get("modelWhiteList"),c.changed)}},{CSS_PREFIX:"sqs-block-summary-gallery",MODEL:b.Squarespace.ContentModel.SummaryGalleryBlock,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Gallery},modelWhiteList:{setter:function(c){return b.Lang.isArray(c)?c:b.Lang.isString(c)?[c]:[]},value:"padding autoplay lightbox vSize aspectRatio thumbnail-strip-height thumbnail-strip-margin".split(" ")},
widgetContent:{value:""}}})},"1.0",{requires:"base squarespace-enum squarespace-block-social-summary squarespace-block-mixin-aspect-ratio squarespace-block-gallery squarespace-block-gallery-editor squarespace-block-summary-gallery-model-editor squarespace-block-summary-gallery-model".split(" ")});
YUI.add("squarespace-content-manager-widgets-knowledge-base-item",function(b){b.namespace("Squarespace.KnowledgeBase").Item=b.Base.create("KnowledgeBaseListItem",b.Squarespace.Blog.Item,[],{_getHBTemplateContext:function(){var d=this.get("item").toJSON(),c=this._getTemplateContextForWorkflow(d.workflowState);b.Object.isEmpty(c)||(d.flag=c);b.Lang.isValue(d.proxyForId)&&(d.flag={className:"example-content",message:"Example"});var c=d.upVotes+d.downVotes,e=100*(d.upVotes/Math.max(c,1));d.rating=e.toFixed();
d.votes=c;return d}},{CSS_PREFIX:"sqs-kb-item",HANDLEBARS_TEMPLATE:"content-manager-kb-item.html",ATTRS:{item:{}}})},"1.0",{requires:["squarespace-content-manager-widgets-blog-item"]});
YUI.add("squarespace-dialog-variants-table",function(b){b.namespace("Squarespace");var d=b.Base.create("UserOption",b.Model,[],{},{ATTRS:{optionName:{value:null},displayName:{value:null}}}),c=b.Base.create("UserOptionList",b.ModelList,[],{model:d,getOptionsByName:function(b){return this.filter(function(c){return c.get("optionName")===b})},find:function(b){return this.getOptionsByName(b)[0]}},{}),e=b.namespace("Squarespace.DialogFields").VariantsTable=b.Base.create("variantsTable",b.Squarespace.DialogField2,
[b.WidgetParent],{_name:"variantsTable",initializer:function(){this._edited=!1;this._tooltips=[];var e=new c;b.Array.each(this.get("data.variantOptionOrdering"),function(b){e.add({optionName:b,displayName:b})});e.on("*:change",function(){this._edited=!0},this);this.set("optionsList",e)},destroy:function(){e.superclass.destroy.call(this);b.Array.each(this._tooltips,function(b){b.destroy()},this)},renderUI:function(){e.superclass.renderUI.call(this);var c=this.get("contentBox");c.append(b.Node.create('<div class="title">'+
this.get("strings.title")+"</div>"));c.append(b.Node.create('<div class="description">'+this.get("strings.description")+"</div>"));c.append(b.Node.create('<div class="table"><div class="viewport"><div class="header"><div class="add-option"><img src="/universal/images-v6/standard/icon_add_11_light.png" /></div></div><div class="body"><div class="rows"></div><div class="add-variant"><img src="/universal/images-v6/standard/icon_add_11_light.png" /></div></div></div></div>'));this._headerEl=c.one(".header");
this._addOptionEl=this._headerEl.one(".add-option");this._bodyEl=c.one(".body");this._addVariantEl=this._bodyEl.one(".add-variant");this._childrenContainer=this._bodyEl.one(".rows");this._addOptionEl.plug(b.Squarespace.Plugin.PulseWarn,{iterations:3,color:"#C1B12E"});this._renderOption({optionName:"sku",displayName:"SKU"},!1);this._renderOption({optionName:"pricing",displayName:"Pricing"},!1);this._renderOption({optionName:"stock",displayName:"Stock"},!1);this.get("isPhysical")&&(this._renderOption({optionName:"weight",
displayName:'Weight<div class="question">?</div>',tooltipConfig:{title:"Shipping Weight",body:"Specify weight for shipping calculations if you use a weight-based formula or real-time carrier-calculated rates."}},!1),this._renderOption({optionName:"dimensions",displayName:'Dimensions<div class="question">?</div>',tooltipConfig:{title:"Packing Dimensions",body:"Specify the packing dimensions of your product if you want to estimate the cost of shipping via real-time carrier shipping-calculated rates."}},
!1));this.get("optionsList").each(function(b){this._renderOption(b.getAttrs(),!0)},this);c=this.get("data.variants");this._setupDragAndDrop();0<c.length?b.Array.each(c,this._addVariant,this):this._addVariant({sku:b.Squarespace.Commerce.generateSKU(),price:0,salePrice:0,onSale:!1,qtyInStock:1,len:0,width:0,height:0,attributes:{}});this._refreshData()},bindUI:function(){e.superclass.bindUI.call(this);this._addOptionEl.on("click",function(b){this._addEditOption()},this);this.get("optionsList").after(["*:add",
"*:remove","*:optionNameChange"],this._refreshData,this);this.after(["addChild","variantRow:removed","variantRow:dataChange"],this._refreshData,this);this.after("variantRow:next-row-execute-requested",this._editOrCreateNextRow,this);this.on("variantRow:removed",function(b){this.remove(this.indexOf(b.target))});this.on("variantRow:remove-requested",this._attemptDeleteRow,this);this.on("variantRow:removed",this._ddDelegate.syncTargets,this._ddDelegate);this._headerEl.delegate("click",this._editOption,
".custom-option",this);this._addVariantEl.on("click",this._attemptAddNewVariant,this);this._bodyEl.delegate("click",this.hideError,"input",this);this.after("dataChange",this.hideError,this);this._ddReorder.on("reordered",this._reorderRows,this)},syncUI:function(){e.superclass.syncUI.call(this);this._bodyEl.toggleClass("one-variant",1===this.size())},didDataChange:function(){return this._edited},_setupDragAndDrop:function(){var c=this._childrenContainer;this._ddDelegate=new b.DD.Delegate({container:c,
nodes:".sqs-variant-row",groups:"variant-row",target:!0});this._ddReorder=this._ddDelegate.dd.plug(b.Squarespace.DDReorder,{container:c,nodes:".sqs-variant-row"}).ddreorder;this._ddDelegate.dd.plug(b.Plugin.DDConstrained,{constrain:c,stickY:!0});this._ddDelegate.dd.plug(b.Plugin.DDNodeScroll,{node:c,horizontal:!1,scrollDelay:100});this._ddReorder.on("reordered",this._refreshData,this)},_editOrCreateNextRow:function(c){var e=this.indexOf(c.target);c=c.command;var d=this.item(e+1);b.Lang.isValue(d)?
c.call(d):this._attemptAddNewVariant()&&(d=this.item(e+1),c.call(d))},_attemptDeleteRow:function(c){c=c.target;if(1===this.size())new b.Squarespace.Widgets.Alert({"strings.title":"Cannot Remove","strings.message":"Your product must have at least one choice."});else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Delete Variant?","strings.message":"Do you want to delete this product variant?"})).on("confirm",c.close,c)},_editOption:function(c){c=c.currentTarget;var e=c.getData();b.Squarespace.Utils.isSystemVariantOption(e.optionName)||
this._addEditOption(e,c)},_renderOption:function(c,e){var d=c.optionName,k=c.tooltipConfig,l=b.Node.create('<div class="option" data-option-name="'+d+'">'+c.displayName+"</div>");b.Squarespace.Utils.isSystemVariantOption(c.optionName)&&l.addClass("option-"+d);e&&l.addClass("custom-option");l.setData(c);this._headerEl.insert(l,this._headerEl.one(".add-option"));b.Lang.isValue(k)&&new b.Squarespace.ToolTip({target:".option-"+d,title:k.title,body:k.body,clickToShow:!0,alwaysEnable:!0,dialogTooltip:!0})},
_addVariant:function(c){c=new b.Squarespace.Widgets.VariantRow({optionsList:this.get("optionsList"),data:c,dialog:this.get("dialog"),isPhysical:this.get("isPhysical"),measurementStandard:this.get("measurementStandard")});this.add(c);this._ddDelegate.syncTargets()},_attemptAddNewVariant:function(){var c=this.get("data.variants");if(0===this.get("optionsList").size())return new b.Squarespace.Widgets.Alert({"strings.title":"Options Needed","strings.message":'You must define at least one option (e.g. "color", "size") before adding product variants.'}),
this._addOptionEl.pulseWarn.warn(),!1;if(100<=c.length)return new b.Squarespace.Widgets.Alert({"strings.title":"Too Many Variants","strings.message":"You have reached the system limit of 100 variants per product. It is recommended that you divide this item into several separate products if you have more than 100 SKUs."}),!1;50<c.length&&100>c.length&&new b.Squarespace.Widgets.Alert({"strings.title":"Warning: Variants Limit","strings.message":"The system has a limit of 100 variants per product. You currently have "+
c.length+". It is recommended that you divide this item into several separate products if you have more than 100 SKUs."});c=b.clone(c[c.length-1]);c.sku=b.Squarespace.Commerce.generateSKU();this._addVariant(c);this._addVariantEl.scrollIntoView();return!0},_addEditOption:function(c,e){var h=new b.Squarespace.EditingDialog({top:120,width:300,overlay:0.5,closeOthers:!1,initialData:c,buttons:c?[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"save",title:"Save Option"}]:[{type:"cancel",
title:"Cancel"},{type:"save",title:"Save Option"}],primaryTabs:[{title:"Edit Option",icon:"/universal/images-v6/form/light/24px/icon_radio_24_light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"optionName",className:"thin",saveOnEnter:!0,strings:{title:"Option Name",description:"E.g. color, size, style, material"}}}]}]});h.on("send-requested",function(){var k=h.getField("optionName").getValue().trim();if(""===k)h.getField("optionName").showError("The option name cannot be blank."),
h.allowEditing();else if(b.Squarespace.Utils.isSystemVariantOption(k))h.getField("optionName").showError("That name is reserved by the system."),h.allowEditing();else{if(b.Lang.isValue(c)){e.setContent(k);e.setAttribute("data-option-name",k);var l=this.get("optionsList").find(c.optionName);l.set("optionName",k);e.setData(l.getAttrs())}else{if(0<this.get("optionsList").getOptionsByName(k).length){h.getField("optionName").showError("You cannot create another option with the same name.");h.allowEditing();
return}this._renderOption({optionName:k,displayName:k},!0);this.get("optionsList").add(new d({optionName:k,displayName:k}))}h.close()}},this);h.on("remove-requested",function(){if(1==this.get("optionsList").size()&&1<this.size())new b.Squarespace.Widgets.Alert({"strings.title":"Cannot Remove","strings.message":"Since you have several variants defined, you must have at least one option. If you really want to remove this option, remove your variants first."});else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Delete Option?",
"strings.message":"Do you want to delete this option?"})).on("confirm",function(){var b=this.get("optionsList");b.remove(b.find(c.optionName));this._headerEl.all(".option").each(function(b){b.getData().optionName==c.optionName&&b.remove()});h.close()},this)},this);h.show()},_getErrors:function(){this.get("data.variants");var c={},e=[];this.each(function(d){var k=d.get("data.sku");d=d.getError(c);b.Lang.isValue(d)&&(this._set("errorFlyoutAnchor",d.inputEl),this.fire("errors"),e=[d.message]);c[k]=!0},
this);return e},_reorderRows:function(b){var c=b.newIndex;b=this.remove(b.oldIndex);this.add(b,c)},_refreshData:function(){var b=[];this.each(function(c){b.push(c.get("data"))},this);var c=[];this.get("optionsList").each(function(b){c.push(b.get("optionName"))});this.set("data",{variants:b,variantOptionOrdering:c})}},{CSS_PREFIX:"sqs-variants-table",ATTRS:{strings:{value:{title:"Product Variants",description:"Define the options of your item, create variants, and track stock levels. Each row in the table below represents a variant on this product. You can add additional options to those variants by adding columns."}},
isPhysical:{value:!0},optionsList:{value:null},measurementStandard:{value:null}}})},"1.0",{requires:"base model squarespace-util squarespace-variant-row squarespace-dialog-field-2 squarespace-plugin-money-formatter squarespace-plugin-numeric-formatter squarespace-plugin-pulsewarn squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-hb-member-account-isowner",function(b){b.Handlebars.registerHelper("if-owner",function(d,c){return d.id===b.Squarespace.Context.getInstance().get("websiteSettings").get("ownerId")?c.fn(this):c.inverse(this)});b.Handlebars.registerHelper("if-me",function(d,c){var e=b.Squarespace.Context.getInstance().get("authenticatedAccount").get("id");return d.id===e?c.fn(this):c.inverse(this)})},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-scrolling-auto-complete-list",function(b){b.namespace("Squarespace.Widgets");EVT_KEYBOARD_CONTINUE="keyboardContinue";EVT_LIST_MOUSEUP="listMouseUp";EVT_LIST_MOUSEDOWN="listMouseDown";var d=b.Squarespace.Widgets.ScrollingAutoCompleteList=b.Base.create("ScrollingAutoCompleteList",b.AutoCompleteList,[],{initializer:function(){this.publish(EVT_KEYBOARD_CONTINUE);this.publish(EVT_LIST_MOUSEUP);this.publish(EVT_LIST_MOUSEDOWN)},renderUI:function(){d.superclass.renderUI.call(this);
var c=this._scrollNode=b.Node.create('<div class="'+this.getClassName()+'-scroll-container"></div>');this.get("listNode").wrap(c);c.hide();(c=this.get("className"))&&this.get("contentBox").addClass(c)},bindUI:function(){d.superclass.bindUI.call(this);var b=this._scrollNode,e=this.get("inputNode");this.after("activeItemChange",function(b){b.newVal&&this._scrollToActiveItem()},this);this.on("results",function(e){0<e.results.length?b.show():b.hide()},this);this.on(["select","clear"],function(){b.hide()});
this.get("boundingBox").on(["focusoutside","clickoutside"],function(e){b.hide()});e.on("keydown",function(b){switch(b.keyCode){case 13:this.selectItem();this.fire(EVT_KEYBOARD_CONTINUE);break;case 9:this.get("activeItem")&&(this.selectItem(),this.fire(EVT_KEYBOARD_CONTINUE));break;case 27:this.hide();case 38:this._activatePrevItem();break;case 40:this._activateNextItem()}},this);this._listNode.delegate("mouseup",function(b){this.fire(EVT_LIST_MOUSEUP);b.preventDefault()},this._SELECTOR_ITEM,this);
this._listNode.delegate("mousedown",function(b){this.fire(EVT_LIST_MOUSEDOWN)},this._SELECTOR_ITEM,this)},_activateNextItem:function(){d.superclass._activateNextItem.call(this);b.Lang.isNull(this.get("activeItem"))&&this.set("activeItem",this._getFirstItemNode())},_activatePrevItem:function(){d.superclass._activatePrevItem.call(this);b.Lang.isNull(this.get("activeItem"))&&this.set("activeItem",this._getLastItemNode())},_scrollToActiveItem:function(){this.get("activeItem").scrollIntoView();var b=this._scrollNode,
e=b.get("scrollTop"),d=b.one("li:first-child").get("offsetHeight");b.set("scrollTop",d*Math.round(e/d))}},{CSS_PREFIX:"sqs-scroll-ac",ATTRS:{className:{validator:b.Squarespace.AttrValidators.isNullOrString}}})},"1.0",{requires:"base autocomplete lang/autocomplete-list squarespace-attr-validators squarespace-scrolling-auto-complete-list-css event-outside".split(" ")});
YUI.add("squarespace-dialog-password",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.Password=b.Base.create("Password",b.Squarespace.DialogFields.Text,[],{initializer:function(){this.publish("forgot-password",{emitFacade:!0})},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox");this.get("strengthMeterVisible")&&(this._strengthMeter=c.plug(b.Squarespace.Plugin.ProgressBar,{show:!0,append:!0})[b.Squarespace.Plugin.ProgressBar.NS]);
this._forgotNode=c.appendChild(this.getProperty("FORGOT_PASSWORD_TEMPLATE"))},bindUI:function(){d.superclass.bindUI.call(this);this._forgotNode.on("click",function(b){b.halt();this.fire("forgot-password")},this);this.get("strengthMeterVisible")&&this.after("dataChange",this._updateStrengthMeter,this)},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("boundingBox");c.toggleClass("has-title",b.Lang.isValue(this.get("strings.title")));c.toggleClass("forgot-visible",this.get("forgotVisible")&&
""===this.get("data").trim())},_updateStrengthMeter:function(){if(typeof zxcvbn===typeof Function){var b=zxcvbn(this.get("data")),b=100*((Math.log(b.crack_time)+7)/30);0>=b&&(b=this.get("data")?1:0);100<b&&(b=100);var e=this._strengthMeter._meterEl.one(".bar-inner");33>b?e.setStyle("background","hsl(5, 65%, 57%)"):33<=b&&67>b?e.setStyle("background","hsl(36, 80%, 57%)"):67<=b&&e.setStyle("background","hsl(145, 65%, 40%)");this._strengthMeter.set("progress",b)}}},{FORGOT_PASSWORD_TEMPLATE:'<a class="forgot">Forgot?</a>',
CSS_PREFIX:"sqs-dialog-password",ATTRS:{forgotVisible:{value:!1,validator:b.Lang.isBoolean},strengthMeterVisible:{value:!1,validator:b.Lang.isBoolean,writeOnce:"initOnly"},password:{value:!0,readOnly:!0}}})},"1.0",{requires:["base","squarespace-dialog-text","squarespace-plugin-progress-bar","thirdparty-password-strength-async"]});
YUI.add("squarespace-account-menu-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["account-menu.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n\n    <div class="other-accounts">\n\n      ';if((f=d["if"].call(b,b.internalSites,{hash:{},inverse:E.noop,fn:E.program(3,p,c),data:c}))||0===f)e+=f;e+="\n\n      ";if((f=d["if"].call(b,b.activeSites,{hash:{},inverse:E.noop,fn:E.program(9,t,c),data:c}))||0===f)e+=f;e+="\n\n      ";if((f=d["if"].call(b,
b.trialSites,{hash:{},inverse:E.noop,fn:E.program(11,u,c),data:c}))||0===f)e+=f;e+="\n\n      ";if((f=d["if"].call(b,b.expiredSites,{hash:{},inverse:E.noop,fn:E.program(14,w,c),data:c}))||0===f)e+=f;return e+"\n\n    </div>\n\n  "}function p(b,c){var e,f;e='\n        <ul class="internal-sites site-list">\n          ';if((f=d.each.call(b,b.internalSites,{hash:{},inverse:E.noop,fn:E.program(4,q,c),data:c}))||0===f)e+=f;return e+"\n        </ul>\n      "}function q(b,c){var e,f;e='\n            <li data-site-id="';
(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===K?f.apply(b):f);e+=O(f)+'" ';if((f=d["if"].call(b,b.currentSite,{hash:{},inverse:E.noop,fn:E.program(5,r,c),data:c}))||0===f)e+=f;e+='>\n\n              <div class="favicon"><img src="'+O((f=b.faviconURL,typeof f===K?f.apply(b):f))+'" alt="'+O((f=b.siteTitle,typeof f===K?f.apply(b):f))+' favicon">\n              </div>\n\n              <div class="site-desc">\n                <span class="title">'+O((f=b.siteTitle,typeof f===K?f.apply(b):
f))+'</span>\n                <span class="url">'+O((f=b.authenticUrl,typeof f===K?f.apply(b):f))+"</span>\n              </div>\n\n              ";if((f=d.unless.call(b,b.currentSite,{hash:{},inverse:E.noop,fn:E.program(7,s,c),data:c}))||0===f)e+=f;return e+"\n\n            </li>\n          "}function r(b,c){return'class="active"'}function s(b,c){return'\n                <button type="button" class="remove remove-access">Remove Access</button>\n              '}function t(b,c){var e,f;e='\n        <ul class="active-sites site-list">\n          ';
if((f=d.each.call(b,b.activeSites,{hash:{},inverse:E.noop,fn:E.program(4,q,c),data:c}))||0===f)e+=f;return e+"\n        </ul>\n      "}function u(b,c){var e,f;e='\n        <ul class="trial-sites site-list">\n          ';if((f=d.each.call(b,b.trialSites,{hash:{},inverse:E.noop,fn:E.program(12,v,c),data:c}))||0===f)e+=f;return e+"\n        </ul>\n      "}function v(b,c){var e,f;e='\n            <li data-site-id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===K?f.apply(b):f);e+=O(f)+'" ';
if((f=d["if"].call(b,b.currentSite,{hash:{},inverse:E.noop,fn:E.program(5,r,c),data:c}))||0===f)e+=f;return e+='>\n\n              <div class="favicon"><img src="'+O((f=b.faviconURL,typeof f===K?f.apply(b):f))+'" alt="'+O((f=b.siteTitle,typeof f===K?f.apply(b):f))+' favicon">\n              </div>\n\n              <div class="site-desc">\n                <span class="title">'+O((f=b.siteTitle,typeof f===K?f.apply(b):f))+'</span>\n                <span class="url">'+O((f=b.authenticUrl,typeof f===
K?f.apply(b):f))+"</span>\n              </div>\n\n            </li>\n          "}function w(b,c){var e,f;e='\n        <ul class="expired-sites site-list">\n          ';if((f=d.each.call(b,b.expiredSites,{hash:{},inverse:E.noop,fn:E.program(15,y,c),data:c}))||0===f)e+=f;return e+"\n        </ul>\n      "}function y(b,c){var e,f;e='\n            <li data-site-id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===K?f.apply(b):f);e+=O(f)+'" ';if((f=d["if"].call(b,b.currentSite,{hash:{},inverse:E.noop,
fn:E.program(5,r,c),data:c}))||0===f)e+=f;e+='>\n\n              <div class="favicon"><img src="'+O((f=b.faviconURL,typeof f===K?f.apply(b):f))+'" alt="'+O((f=b.siteTitle,typeof f===K?f.apply(b):f))+' favicon">\n              </div>\n\n              <div class="site-desc">\n                <span class="title">'+O((f=b.siteTitle,typeof f===K?f.apply(b):f))+'</span>\n                <span class="url">'+O((f=b.authenticUrl,typeof f===K?f.apply(b):f))+"</span>\n              </div>\n\n              ";
if((f=d.unless.call(b,b.currentSite,{hash:{},inverse:E.noop,fn:E.program(16,z,c),data:c}))||0===f)e+=f;return e+"\n\n            </li>\n          "}function z(b,c){return'\n                <button type="button" class="remove remove-site">Remove Site</button>\n              '}function B(b,c){var e,f;e='\n\n    <ul class="other-accounts">\n      ';if((f=d.each.call(b,b.managedSites,{hash:{},inverse:E.noop,fn:E.program(19,A,c),data:c}))||0===f)e+=f;return e+"\n    </ul>\n\n  "}function A(b,c){var e,
f;e='\n        <li data-site-id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===K?f.apply(b):f);e+=O(f)+'" ';if((f=d["if"].call(b,b.currentSite,{hash:{},inverse:E.noop,fn:E.program(5,r,c),data:c}))||0===f)e+=f;return e+='>\n\n          <div class="favicon"><img src="'+O((f=b.faviconURL,typeof f===K?f.apply(b):f))+'" alt="'+O((f=b.siteTitle,typeof f===K?f.apply(b):f))+' favicon">\n          </div>\n\n          <div class="site-desc">\n            <span class="title">'+O((f=b.siteTitle,
typeof f===K?f.apply(b):f))+'</span>\n            <span class="url">'+O((f=b.authenticUrl,typeof f===K?f.apply(b):f))+"</span>\n          </div>\n\n        </li>\n      "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var K="function",O=this.escapeExpression,E=this,F=d.helperMissing;b='<header>\n\n  <div class="profile-image"></div>\n\n  <div class="profile-info">\n    <span class="name"></span> \u2014 <span class="edit-profile">edit profile</span>\n    <span class="email"></span>\n  </div>\n\n</header>\n\n';
if((h=d["if"].call(c,c.managedSites,{hash:{},inverse:E.noop,fn:E.program(1,function(b,c){var e,f;e="\n\n  ";if((f=d["if"].call(b,b.nonActiveSites,{hash:{},inverse:E.program(18,B,c),fn:E.program(2,l,c),data:c}))||0===f)e+=f;return e+"\n\n"},k),data:k}))||0===h)b+=h;b+="\n\n<footer>\n\n  ";k={hash:{permissionName:"ADMIN"},inverse:E.noop,fn:E.program(21,function(b,c){return'\n    <button type="button" class="site-admin secondary">Admin</button>\n  '},k),data:k};if((c=(h=d["has-permission"]||c["has-permission"],
h?h.call(c,k):F.call(c,"has-permission",k)))||0===c)b+=c;return b+'\n\n  <button type="button" class="create-site secondary">Create New Site</button>\n  <button type="button" class="logout primary">Logout</button>\n\n</footer>\n'})})();b.Handlebars.registerPartial("account-menu.html".replace("/","."),d.templates["account-menu.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-fivehundredpix-editor",function(b){b.namespace("Squarespace.Block.Editor");b.namespace("Squarespace.Block.ModelEditorDialog");b.Squarespace.Block.Editor.Fivehundredpix=b.Base.create("fivehundredpix-block-editor-dialog",b.Squarespace.Block.Editor.Gallery,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Fivehundredpix")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Fivehundredpix"}}});b.Squarespace.Block.ModelEditorDialog.Fivehundredpix=
b.Base.create("FivehundredpixModelEditorDialog",b.Squarespace.Block.ModelEditorDialog.SummaryGallery,[],{},{ATTRS:{dialogConfig:{valueFn:null,getter:"_getDefaultDialogConfig"},icon:{value:"fivehundredpix"},type:{value:b.Squarespace.BlockType.FIVEHUNDREDPIX},socialAccountType:{value:b.Squarespace.ExternalServiceProviders.FIVEHUNDREDPIX},collectionType:{value:b.Squarespace.CollectionTypes.FIVEHUNDREDPIX},strings:{value:{name:"500px",itemTypePlural:"Photos",itemType:"Photo"}}}})},"1.0",{requires:"base squarespace-block-summary-gallery-model-editor squarespace-block-fivehundredpix-model squarespace-damask-context-globals squarespace-enum squarespace-util".split(" ")});
YUI.add("squarespace-layout-renderable-blocks-web-app",function(b){var d=b.Squarespace.BlockTypeByString,c={};c[d[b.Squarespace.BlockType.HTML]]={value:{id:"html",ctor:b.Squarespace.Block.Html,label:"Text"}};c[d[b.Squarespace.BlockType.MARKDOWN]]={value:{id:"markdown",ctor:b.Squarespace.Block.Markdown,label:"Markdown"}};c[d[b.Squarespace.BlockType.QUOTE]]={value:{id:"quote",ctor:b.Squarespace.Block.Quote,label:"Quote"}};c[d[b.Squarespace.BlockType.IMAGE]]={value:{id:"image",ctor:b.Squarespace.Block.Image,
label:"Image"}};c[d[b.Squarespace.BlockType.GALLERY]]={value:{id:"gallery",ctor:b.Squarespace.Block.Gallery,label:"Gallery"}};c[d[b.Squarespace.BlockType.VIDEO]]={value:{id:"video",ctor:b.Squarespace.Block.Video,label:"Video"}};c[d[b.Squarespace.BlockType.AUDIO]]={value:{id:"audio",ctor:b.Squarespace.Block.Audio,label:"Audio"}};c[d[b.Squarespace.BlockType.EMBED]]={value:{id:"embed",ctor:b.Squarespace.Block.Embed,label:"Embed"}};c[d[b.Squarespace.BlockType.PRODUCT]]={value:{id:"product",ctor:b.Squarespace.Block.Product,
label:"Product"}};c[d[b.Squarespace.BlockType.AMAZON]]={value:{id:"amazon",ctor:b.Squarespace.Block.Amazon,label:"Amazon"}};c[d[b.Squarespace.BlockType.DONATION]]={value:{id:"donation",ctor:b.Squarespace.Block.Donation,label:"Donation"}};c[d[b.Squarespace.BlockType.FORM]]={value:{id:"form",ctor:b.Squarespace.Block.Form,label:"Form"}};c[d[b.Squarespace.BlockType.NEWSLETTER]]={value:{id:"newsletter",ctor:b.Squarespace.Block.Newsletter,label:"Newsletter"}};c[d[b.Squarespace.BlockType.MAP]]={value:{id:"map",
ctor:b.Squarespace.Block.Map,label:"Map"}};c[d[b.Squarespace.BlockType.CODE]]={value:{id:"code",ctor:b.Squarespace.Block.Code,label:"Code"}};c[d[b.Squarespace.BlockType.MENU]]={value:{id:"menu",ctor:b.Squarespace.Block.Menu,label:"Menu"}};c[d[b.Squarespace.BlockType.LINK]]={value:{id:"link",ctor:b.Squarespace.Block.Link,label:"Link"}};c[d[b.Squarespace.BlockType.CALENDAR]]={value:{id:"calendar",ctor:b.Squarespace.Block.Calendar,label:"Calendar"}};c[d[b.Squarespace.BlockType.OPENTABLE]]={value:{id:"opentable",
ctor:b.Squarespace.Block.Opentable,label:"Opentable"}};c[d[b.Squarespace.BlockType.TOURDATES]]={value:{id:"tourdates",ctor:b.Squarespace.Block.TourDates,label:"Bandsintown"}};c[d[b.Squarespace.BlockType.SPACER]]={value:{id:"spacer",ctor:b.Squarespace.Block.Spacer,label:"Spacer"}};c[d[b.Squarespace.BlockType.HORIZONTAL_RULE]]={value:{id:"horizontal-rule",ctor:b.Squarespace.Block.HorizontalRule,label:"Line"}};c[d[b.Squarespace.BlockType.SEARCH]]={value:{id:"search",ctor:b.Squarespace.Block.Search,label:"Search"}};
c[d[b.Squarespace.BlockType.COLLECTION_LINK]]={value:{id:"collection-link",ctor:b.Squarespace.Block.CollectionLink,label:"Content Link"}};c[d[b.Squarespace.BlockType.BUTTON]]={value:{id:"button",ctor:b.Squarespace.Block.Button,label:"Button"}};c[d[b.Squarespace.BlockType.SUMMARY]]={value:{id:"summary",ctor:b.Squarespace.Block.Summary,label:"Summary"}};c[d[b.Squarespace.BlockType.SUMMARY_V2]]={value:{id:"summary-v2",ctor:b.Squarespace.Block.SummaryV2,label:"Summary"}};c[d[b.Squarespace.BlockType.TAGCLOUD]]=
{value:{id:"tagcloud",ctor:b.Squarespace.Block.Tagcloud,label:"Tag Cloud"}};c[d[b.Squarespace.BlockType.POSTS_BY_TAG]]={value:{id:"posts-by-tag",ctor:b.Squarespace.Block.PostsByTag,label:"Tag List"}};c[d[b.Squarespace.BlockType.POSTS_BY_AUTHOR]]={value:{id:"posts-by-author",ctor:b.Squarespace.Block.PostsByAuthor,label:"Author List"}};c[d[b.Squarespace.BlockType.POSTS_BY_CATEGORY]]={value:{id:"posts-by-category",ctor:b.Squarespace.Block.PostsByCategory,label:"Category List"}};c[d[b.Squarespace.BlockType.POSTS_BY_MONTH]]=
{value:{id:"posts-by-month",ctor:b.Squarespace.Block.PostsByMonth,label:"Month List"}};c[d[b.Squarespace.BlockType.TWITTER]]={value:{id:"twitter",ctor:b.Squarespace.Block.Twitter,label:"Twitter"}};c[d[b.Squarespace.BlockType.FOURSQUARE]]={value:{id:"foursquare",ctor:b.Squarespace.Block.Foursquare,label:"Foursquare"}};c[d[b.Squarespace.BlockType.SOCIAL_ACCOUNT_LINKS]]={value:{id:"social-links",ctor:b.Squarespace.Block.SocialAccountLinks,label:"Social Links"}};c[d[b.Squarespace.BlockType.SOCIAL_ACCOUNT_LINKS_V2]]=
{value:{id:"social-links",ctor:b.Squarespace.Block.SocialAccountLinksV2,label:"Social Links"}};c[d[b.Squarespace.BlockType.RSS]]={value:{id:"rss",ctor:b.Squarespace.Block.Rss,label:"RSS"}};c[d[b.Squarespace.BlockType.FIVEHUNDREDPIX]]={value:{id:"fivehundredpix",ctor:b.Squarespace.Block.Fivehundredpix,label:"500px"}};c[d[b.Squarespace.BlockType.INSTAGRAM]]={value:{id:"instagram",ctor:b.Squarespace.Block.Instagram,label:"Instagram"}};c[d[b.Squarespace.BlockType.FLICKR]]={value:{id:"flickr",ctor:b.Squarespace.Block.Flickr,
label:"Flickr"}};c[d[b.Squarespace.BlockType.SOUNDCLOUD]]={value:{id:"soundcloud",ctor:b.Squarespace.Block.SoundCloud,label:"SoundCloud"}};b.namespace("Squarespace.Layout").RenderableBlocksWebApp=b.Base.create("squarespace-layout-renderable-blocks",b.Base,[],{},{ATTRS:c})},"1.0",{requires:"base squarespace-enum squarespace-util squarespace-block-amazon squarespace-block-audio squarespace-block-button squarespace-block-calendar squarespace-block-code squarespace-block-collection-link squarespace-block-donation squarespace-block-embed squarespace-block-soundcloud squarespace-block-fivehundredpix squarespace-block-flickr squarespace-block-form squarespace-block-foursquare squarespace-block-gallery squarespace-block-horizontal-rule squarespace-block-html squarespace-block-content-html-editor squarespace-block-image squarespace-block-image-editor squarespace-block-instagram squarespace-block-link squarespace-block-map squarespace-block-markdown squarespace-block-markdown-editor squarespace-block-menu squarespace-block-newsletter squarespace-block-opentable squarespace-block-posts-by squarespace-block-product squarespace-block-quote squarespace-block-rss squarespace-block-search squarespace-block-social-account-links squarespace-block-social-account-links-v2 squarespace-block-social-summary squarespace-block-spacer squarespace-block-summary squarespace-block-summary-v2 squarespace-block-tagcloud squarespace-block-tourdates squarespace-block-twitter squarespace-block-video squarespace-block-video-editor".split(" ")});
YUI.add("squarespace-plugin-progress-spinner",function(b){b.namespace("Squarespace.Plugin");var d=b.Squarespace.Plugin.ProgressSpinner=b.Base.create("ProgressSpinner",b.Squarespace.Plugin.ProgressBase,[],{_renderContent:function(){d.superclass._renderContent.call(this);(new b.Squarespace.Spinner({render:this._meterEl,size:this.get("spinnerSize"),color:this.get("spinnerColor")})).get("boundingBox")}},{NS:"progress",PROGRESS_METER_TEMPLATE:'<div class="spinner"></div>',ATTRS:{spinnerSize:{value:30},
spinnerColor:{value:"dark"}}})},"1.0",{requires:["base","squarespace-plugin-progress-base","squarespace-spinner"]});
YUI.add("squarespace-layout-renderable-blocks-email",function(b){var d=b.Squarespace.BlockTypeByString,c={};c[d[b.Squarespace.BlockType.HTML]]={value:{id:"html",ctor:b.Squarespace.Block.Html,label:"Text"}};c[d[b.Squarespace.BlockType.MARKDOWN]]={value:{id:"markdown",ctor:b.Squarespace.Block.Markdown,label:"Markdown"}};c[d[b.Squarespace.BlockType.IMAGE]]={value:{id:"image",ctor:b.Squarespace.Block.Image,label:"Image"}};c[d[b.Squarespace.BlockType.BUTTON]]={value:{id:"button",ctor:b.Squarespace.Block.Button,
label:"Button"}};c[d[b.Squarespace.BlockType.HORIZONTAL_RULE]]={value:{id:"horizontal-rule",ctor:b.Squarespace.Block.HorizontalRule,label:"Horizontal Rule"}};c[d[b.Squarespace.BlockType.SPACER]]={value:{id:"spacer",ctor:b.Squarespace.Block.Spacer,label:"Spacer"}};c[d[b.Squarespace.BlockType.EMAIL_FOOTER]]={value:{id:"email-footer",ctor:b.Squarespace.Block.EmailFooter,label:"Email Footer"}};c[d[b.Squarespace.BlockType.LOGO]]={value:{id:"logo",ctor:b.Squarespace.Block.Logo,label:"Logo"}};c[d[b.Squarespace.BlockType.IN_BROWSER_MESSAGE_LINK]]=
{value:{id:"in-browser-message-link",ctor:b.Squarespace.Block.InBrowserMessageLink,label:"Webview Link"}};b.namespace("Squarespace.Layout").RenderableBlocksEmail=b.Base.create("squarespace-layout-renderable-blocks",b.Base,[],{},{ATTRS:c})},"1.0",{requires:"base squarespace-enum squarespace-util squarespace-block-button squarespace-block-html squarespace-block-content-html-editor-email squarespace-block-image squarespace-block-image-editor-email squarespace-block-markdown squarespace-block-markdown-editor squarespace-block-button-editor-email squarespace-block-horizontal-rule-editor-email squarespace-block-image-editor-email squarespace-block-markdown-editor-email squarespace-block-spacer-editor-email squarespace-block-email-footer squarespace-block-email-footer-editor squarespace-block-logo squarespace-block-logo-editor squarespace-block-in-browser-message-link squarespace-block-in-browser-message-link-editor".split(" ")});
YUI.add("squarespace-block-donation",function(b){var d=b.Base.create("DonationModel",b.Model,[],{sync:function(c,e,d){var g=this.get("donatePageId");"update"==c||"create"==c?(new b.Squarespace.Models.DonatePage(this.getAttrs())).save(e,b.bind(function(c,e){var g=b.JSON.parse(e.response);this.set("donatePageId",g.id);d(c)},this)):"read"==c&&b.Lang.isValue(g)?(new b.Squarespace.Models.DonatePage({id:g})).load(d):d()}},{ATTRS:{suggestedContributions:{valueFn:function(){if(!this.get("donatePageId"))return[{amountCents:1E3,
label:""},{amountCents:2500,label:""},{amountCents:5E3,label:""},{amountCents:1E4,label:""}]}},buttonLabel:{value:"Donate"}}});b.namespace("Squarespace.Block").Donation=b.Base.create("block-donation",b.Squarespace.Block.ModelSyncBase,[],{bindUI:function(){this.get("model").after("change",function(b){b.changed.buttonAlignment&&(b=b.changed.buttonAlignment,this.get("contentBox").get("children").replaceClass("sqs-donate-button-wrapper--align-"+b.prevVal,"sqs-donate-button-wrapper--align-"+b.newVal))},
this);this.get("boundingBox").delegate("click",function(c){this.get("editable")||b.Squarespace.Commerce.goToDonatePage(c.target.getAttribute("data-donate-page-id"))},".sqs-donate-button",this)}},{CSS_PREFIX:"sqs-block-donation",MODEL:d,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Donation},type:{value:b.Squarespace.BlockType.DONATION}}})},"1.0",{requires:["squarespace-block-base-modelsync","squarespace-block-donation-editor","squarespace-models-donate-page"]});
YUI.add("squarespace-dialog-structured-input",function(b){var d=b.namespace("Squarespace.DialogFields").StructuredInput=b.Base.create("structuredInputDialog",b.Squarespace.DialogField2,[b.WidgetParent],{initializer:function(c){b.Lang.isValue(c.dialog)&&(this.dialog=c.dialog);c={childType:b.Squarespace.Widgets.StructuredInput,value:this.get("data"),variables:this.get("variables")};b.Lang.isValue(this.dialog)&&(c.tabIndex=this.dialog.getNextTabIndex());this._structInput=this.add(c).item(0)},renderUI:function(){d.superclass.renderUI.call(this);
this._structInput.set("value",this.get("data"));this._titleContainer=this.get("contentBox").one(".title");this._descriptionContainer=this.get("contentBox").one(".description");this._childrenContainer=this.get("contentBox").one(".structured-input")},bindUI:function(){d.superclass.bindUI.call(this);this.after("dataChange",function(b){"StructuredInput:_syncData"!=b.source&&(this._structInput.set("value",b.newVal,{source:"StructuredInput:bindUI"}),this._titleContainer.setHTML(this.get("strings.title")),
this._descriptionContainer.setHTML(this.get("strings.description")))},this);this._titleContainer.setHTML(this.get("strings.title"));this._descriptionContainer.setHTML(this.get("strings.description"));this._structInput.after("valueChange",this._syncData,this)},destructor:function(){this._structInput&&this._structInput.destroy()},_syncData:function(b){"StructuredInput:bindUI"!=b.source&&this.set("data",b.newVal,{source:"StructuredInput:_syncData"})}},{CSS_PREFIX:"sqs-structured-input-field",TEMPLATE:'<div class="structured-input-field"><div class="structured-input-wrapper"><div class="title"></div><div class="structured-input"></div><div class="description"></div></div> </div>',
ATTRS:{data:{},variables:{}}})},"1.0.0",{requires:["base","node","squarespace-dialog-field-2","squarespace-structured-input"]});
YUI.add("squarespace-block-summary",function(b){var d=b.namespace("Squarespace.Block").Summary=b.Base.create("block-summary",b.Squarespace.Block.ModelSyncBase,[],{syncUI:function(){d.superclass.syncUI.call(this);this._plugImageLoader()},_renderSuccess:function(b){d.superclass._renderSuccess.call(this,b);this._plugImageLoader()},_getDefaultContent:function(){return{title:!0,thumbnail:!0,excerpt:!0,pageSize:10,collectionId:"",filter:{}}}},{MODEL:b.Squarespace.ContentModel.SummaryBlock,ATTRS:{defaultContentModel:{valueFn:"_getDefaultContent"},
editor:{value:b.Squarespace.Block.Editor.Summary},type:{value:b.Squarespace.BlockType.SUMMARY}},CSS_PREFIX:"sqs-block-summary"})},"1.0",{requires:["base","squarespace-enum","squarespace-block-summary-editor"]});
YUI.add("squarespace-widgets-newsletter-message-editor",function(b){var d=b.namespace("Squarespace.Widgets").NewsletterMessageEditor=b.Base.create("NewsletterMessageEditor",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){var c=this.get("dialogParams"),c=b.merge(c,{width:800,discardChangesConfirm:!1,dontSetWidthOnFields:!0,primaryTabs:[{fields:[]}]});this.set("dialogParams",c);b.Squarespace.EscManager.disable()},renderUI:function(){d.superclass.renderUI.apply(this,arguments);b.later(0,this,
this._showDraft);b.one("body").addClass("squarespace-editnewsletter");this.subjectField=this.get("contentBox").one(".newsletters-edit-main").one(".subjectfield")},bindUI:function(){this._headerChangeEvent=this._initHeaderLayoutEngine().after("change",function(){this.set("dirty",!0)},this);this._bodyChangeEvent=this._initBodyLayoutEngine().after("change",function(){this.set("dirty",!0)},this);this._footerChangeEvent=this._initFooterLayoutEngine().after("change",function(){this.set("dirty",!0)},this);
var c=b.Squarespace.NewsletterMessageStatus.DRAFT;b.Lang.isValue(this.get("model").get("status"))&&(c=this.get("model").get("status"));switch(c){case b.Squarespace.NewsletterMessageStatus.TEST_SEND:case b.Squarespace.NewsletterMessageStatus.TEST_SENDING:this._showSendingOverlay(this._getOverlaySendingContext());break;case b.Squarespace.NewsletterMessageStatus.TEST_SENT:this._showSendingOverlay(this._getOverlayConfirmContext(),this._overlayConfirmBindings)}c=this.get("contentBox").one(".newsletters-edit-toolbar");
c.one(".savedraft").on("click",this._saveDraft,this);c.one(".deletedraft").on("click",this._deleteDraft,this);c.one(".sendtest").on("click",this._showAddMessageDialog,this);this._showHideDelete();this.get("contentBox").one(".subjectInput").on("change",function(){this.set("dirty",!0)},this)},syncUI:function(){d.superclass.syncUI.apply(this,arguments);this._showHideDelete()},destructor:function(){this._bodyChangeEvent.detach();this._footerChangeEvent.detach();this._headerChangeEvent.detach();this.get("contentBox").all(".sqs-layout").unplug();
this.get("editController").disableDragSelection();b.Squarespace.EscManager.enable()},_getHBTemplateContext:function(){return{testLabel:this.get("strings.testEmailLabel"),emailSubject:this.get("model").get("subject")}},_deleteDraft:function(){if(!this.get("isNew"))(new b.Squarespace.Widgets.Confirmation({"strings.title":this.get("strings.deleteDraftConfirmationTitle"),"strings.message":this.get("strings.deleteDraftConfirmationContent")})).on("confirm",function(){this.get("model").destroy({remove:!0});
this._closeDraft()},this)},_saveDraft:function(c){var e=this.get("isNew"),d=this.get("contentBox").one(".bodycontainer .sqs-layout"),g=this.get("contentBox").one(".footerContainer .sqs-layout"),h=this.get("contentBox").one(".headerContainer .sqs-layout");this.get("model").setAttrs({subject:this.subjectField.one(".subjectInput").get("value"),header:{layout:h.LayoutBuilder.toJSON()},body:{layout:d.LayoutBuilder.toJSON()},footer:{layout:g.LayoutBuilder.toJSON()},status:c.status||b.Squarespace.NewsletterMessageStatus.DRAFT},
{silent:!0});this.get("model").save();e&&b.Squarespace.NewsletterMessagesList.add(this.get("model"),{index:0});this.set("dirty",!1)},_cancelChanges:function(){if(this.get("dirty"))(new b.Squarespace.Widgets.Confirmation({"strings.title":this.get("strings.cancelChangesConfirmationTitle"),"strings.message":this.get("strings.cancelChangesConfirmationContent")})).on("confirm",this._closeDraft,this);else this._closeDraft()},_showHideDelete:function(){this.get("contentBox").one(".newsletters-edit-toolbar").one(".deletedraft").toggleClass("hidden",
this.get("isNew"))},_showDraft:function(){this.get("boundingBox").addClass("show")},_closeDraft:function(){this.get("boundingBox").removeClass("show");b.one("body").removeClass("squarespace-editnewsletter");b.Squarespace.Newsletters.editMessagePanel=null;b.later(300,this,this.destroy)},_initHeaderLayoutEngine:function(){var c=this.get("contentBox").one(".headerContainer .sqs-layout"),e=new b.Squarespace.Models.PageLayout,d=this.get("editController"),g=b.Squarespace.Layout.EditMode.EMAIL;e.set("columns",
6);!this.get("isNew")&&b.Lang.isValue(this.get("model").get("header"))?e.set("rows",this.get("model").get("header").layout.rows):e.get("rows").item(0).get("columns")[0].blocks=[];d.pluginLayoutEditor(c,e,void 0,g);if(this.get("isNew")||!b.Lang.isValue(this.get("model").get("header")))this._insertInBrowserMessageLinkBlock(c,d),this._insertLogoBlock(c,d);return e},_initBodyLayoutEngine:function(){var c=this.get("contentBox").one(".bodycontainer .sqs-layout"),e=new b.Squarespace.Models.PageLayout,d=
this.get("editController"),g=b.Squarespace.Layout.EditMode.EMAIL;e.set("columns",6);this.get("isNew")?b.Lang.isValue(this.get("template"))&&e.set("rows",this.get("template").body.layoutRows):e.set("rows",this.get("model").get("body").layout.rows);d.pluginLayoutEditor(c,e,void 0,g);return e},_initFooterLayoutEngine:function(){var c=this.get("contentBox").one(".footerContainer .sqs-layout"),e=new b.Squarespace.Models.PageLayout,d=this.get("editController"),g=b.Squarespace.Layout.EditMode.EMAIL;e.set("columns",
6);!this.get("isNew")&&b.Lang.isValue(this.get("model").get("footer"))?e.set("rows",this.get("model").get("footer").layout.rows):e.get("rows").item(0).get("columns")[0].blocks=[];d.pluginLayoutEditor(c,e,void 0,g);(this.get("isNew")||!b.Lang.isValue(this.get("model").get("footer")))&&this._insertEmailFooterBlock(c,d);return e},_insertEmailFooterBlock:function(c,e){var d=c.LayoutBuilder,g=new b.Squarespace.Block.EmailFooter({editable:!0,render:!1,visible:!0,isNewBlock:!1,editController:e,editMode:b.Squarespace.Layout.EditMode.EMAIL});
c.one(".sqs-col").insert(g.get("boundingBox"));g.render();d.registerBlock(g);e.alignInsertPoints(c,!0)},_insertInBrowserMessageLinkBlock:function(c,e){var d=c.LayoutBuilder,g=new b.Squarespace.Block.InBrowserMessageLink({editable:!0,render:!1,visible:!0,isNewBlock:!1,editController:e,editMode:b.Squarespace.Layout.EditMode.EMAIL});c.one(".sqs-col").insert(g.get("boundingBox"));g.get("model").set("webviewText","Having trouble viewing this email?");g.render();d.registerBlock(g);e.alignInsertPoints(c,
!0)},_insertLogoBlock:function(c,e){var d=c.LayoutBuilder,g=new b.Squarespace.Block.Logo({editable:!0,render:!1,visible:!0,isNewBlock:!1,editController:e,editMode:b.Squarespace.Layout.EditMode.EMAIL});b.Lang.isValue(this.get("template"))&&g.get("model").set("align",this.get("template").header.logoAlignment);c.one(".sqs-col").insert(g.get("boundingBox"));g.render();g.syncUI();d.registerBlock(g);e.alignInsertPoints(c,!0)},_showAddMessageDialog:function(){var c=this.subjectField.one(".subjectInput").get("value");
if(!b.Lang.isValue(c)||b.Squarespace.StringUtils.isBlank(c))new b.Squarespace.Widgets.Alert({"strings.title":"Please enter a Subject","strings.message":"We cannot send an email without a subject."});else{var e=new b.Squarespace.EditingDialog({loadingText:"Loading...",icon:"/universal/images-v6/icons/icon-email-24-light-solid.png",style:"flyout sqs-test-email-dialog",width:500,overlay:0.5,closeOthers:!1,flyoutPointerDirection:"centered",tabs:[{title:"Test and Send",fields:[{ctor:b.Squarespace.DialogFields.Description,
config:{text:"Before you send out your email, test it out to up to five people, comma separated. Make sure everything's looking good, then you'll be able to schedule your email.",padding:[10,10]}},{ctor:b.Squarespace.DialogFields.Text,config:{"strings.title":"Email Address","strings.validationFailMessage":"Please enter one to five comma separated valid emails.",required:!0,name:"toTestEmails",submitOnEnter:!0,validator:b.bind(function(c){c=this._splitTestEmails(c);var e=c.length,d=function(b,c){return b&&
c&&0<=c.indexOf(".")&&0<=c.indexOf("@")};return 1<=e&&5>=e&&b.Array.reduce(c,!0,d)},this)}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Send Test"}]});e.setInitialData({toTestEmails:this.get("model").get("toTestEmails").join(", ")});e.once("send-requested",function(){this.get("model").set("toTestEmails",this._splitTestEmails(e.fields.toTestEmails.getValue()),{silent:!0});e.close();this._sendTestEmail()},this);e.show()}},_splitTestEmails:function(c){var e="";b.Lang.isValue(c)&&
b.Lang.isString(c)&&(e=c.replace(/\s/g,""));return!e.length?[]:e.split(",")},_showSendingOverlay:function(c,e){this.overlay&&(this.overlay.remove(!0),delete this.overlay);var d=b.Squarespace.UITemplates.render("widgets-newsletter-message-editor-overlay.html",c);this.overlay=b.Node.create(d);this.get("contentBox").appendChild(this.overlay);this.overlay.one(".overlay-cancel").on("click",this._hideSendingOverlay,this);this.overlay.one(".close-button").on("click",function(){this._hideSendingOverlay()},
this);b.Lang.isFunction(e)&&b.bind(e,this)()},_hideSendingOverlay:function(){this.overlay.remove(!0);this.get("model").set("status",b.Squarespace.NewsletterMessageStatus.DRAFT,{silent:!0});this.get("model").save({silent:!0});delete this.overlay},_getOverlaySendingContext:function(){return{additionalClasses:"sending",overlayTitle:this.get("strings.overlaySendingContext.overlayTitle"),hideMessage:!0,hideSend:!0,hideCancel:!0}},_getOverlayConfirmContext:function(){var c=this.get("strings.recipients");
return{additionalClasses:"",overlayTitle:this.get("strings.overlayConfirmContext.overlayTitle"),overlayMessage:this.get("strings.overlayConfirmContext.overlayMessage"),overlaySendLabel:b.Lang.sub(this.get("strings.overlayConfirmContext.overlaySendLabel"),{recipientTotal:-1,pluralSafeRecipients:c}),overlayCancelLabel:this.get("strings.overlayConfirmContext.overlayCancelLabel")}},_overlayConfirmBindings:function(){b.Lang.isValue(this.overlaySendClickEvt)&&this.overlaySendClickEvt.detach();this.overlaySendClickEvt=
this.overlay.one(".overlay-send").on("click",this._sendEmail,this)},_getOverlayErrorContext:function(){return{additionalClasses:"",overlayTitle:this.get("strings.overlayErrorContext.overlayTitle"),overlayMessage:this.get("strings.overlayErrorContext.overlayMessage"),overlaySendLabel:this.get("strings.overlayErrorContext.overlaySendLabel"),overlayCancelLabel:this.get("strings.overlayErrorContext.overlayCancelLabel")}},_overlayErrorBindings:function(){b.Lang.isValue(this.overlaySendClickEvt)&&this.overlaySendClickEvt.detach();
this.overlaySendClickEvt=this.overlay.one(".overlay-send").on("click",this._sendTestEmail,this)},_sendTestEmail:function(){this._saveDraft({status:b.Squarespace.NewsletterMessageStatus.TEST_SEND});this._showSendingOverlay(this._getOverlaySendingContext());this._waitForStatusChange(b.Squarespace.NewsletterMessageStatus.TEST_SEND,this._handleTestEmailStatusChange)},_handleTestEmailStatusChange:function(c){switch(c){case b.Squarespace.NewsletterMessageStatus.TEST_SENT:this._showSendingOverlay(this._getOverlayConfirmContext(),
this._overlayConfirmBindings);break;case b.Squarespace.NewsletterMessageStatus.TEST_ERROR:this._showSendingOverlay(this._getOverlayErrorContext(),this._overlayErrorBindings);break;case b.Squarespace.NewsletterMessageStatus.TEST_SENDING:this._waitForStatusChange(b.Squarespace.NewsletterMessageStatus.TEST_SEND,this._handleTestEmailStatusChange)}},_sendEmail:function(){this._saveDraft({status:b.Squarespace.NewsletterMessageStatus.SEND})},_checkEmailStatus:function(c,e,d){this.get("isNew")?d&&this._waitForStatusChange(c,
e):this.get("model").load({silent:!0},b.bind(function(){var b=this.get("model").get("status");b!==c?e.apply(this,[b]):d&&this._waitForStatusChange(c,e)},this))},_waitForStatusChange:function(c,e){b.later(1E3,this,this._checkEmailStatus,[c,e,!0])}},{HANDLEBARS_TEMPLATE:"widgets-newsletter-message-editor.html",CSS_PREFIX:"sqs-edit-newsletter",ATTRS:{dirty:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},editController:{readOnly:!0,valueFn:function(){return b.Squarespace.EditControllerWebApp.getInstance()}},
isNew:{getter:function(){return!b.Lang.isValue(this.get("model").get("id"))}},model:{writeOnce:!0,lazyAdd:!1,value:{},setter:function(c){return b.instanceOf(c,b.Model)?c:new b.Squarespace.Models.NewsletterMessage({subject:"",toGroups:[],toEmails:[],toTestEmails:[Static.SQUARESPACE_CONTEXT.authenticatedAccount.email],header:"",body:"",footer:""})}},strings:{value:{allSubscribers:"All Subscribers",cancelChangesConfirmationTitle:"Discard changes?",cancelChangesConfirmationContent:"Are you sure you want to discard your changes?",
deleteDraftConfirmationTitle:"Delete this draft?",deleteDraftConfirmationContent:"Are you sure you want to delete this draft?",overlaySendingContext:{overlayTitle:"Sending..."},overlayConfirmContext:{overlayTitle:"How did your test email look?",overlayMessage:"If everything looks good and you're ready to send your email, click the button below. Alternatively, you can click the link below to go back and make changes to your email before sending.",overlaySendLabel:"Finish and send to {recipientTotal} {pluralSafeRecipients}",
overlayCancelLabel:"I'm not ready to send yet."},overlayErrorContext:{overlayTitle:"Oops",overlayMessage:"An error occured, would you like to try again?",overlaySendLabel:"Retry sending the test email",overlayCancelLabel:"Cancel"},recipient:"recipient",recipients:"recipients",testEmailLabel:"Send Test Email",xSubscribers:"{number} subscribers."}},template:{readOnly:!0,getter:function(){return!b.Lang.isValue(this.get("templateType"))?null:b.Squarespace.Newsletters.Templates[this.get("templateType").value]}},
templateType:{validator:function(c){var e=b.Squarespace.Newsletters.TemplateType;return b.Lang.isValue(c)&&b.Lang.isValue(e[c])},setter:function(c){return b.Squarespace.Newsletters.TemplateType[c]}}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-edit-controller-web-app squarespace-enum-factory squarespace-escmanager squarespace-models-layout squarespace-newsletters-message squarespace-newsletters-templates squarespace-widgets-newsletter-message-editor-template squarespace-widgets-newsletter-message-editor-overlay-template squarespace-settings-panel squarespace-ss-widget squarespace-ui-base squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-pinterest",function(b){var d=b.namespace("Squarespace.Pinterest");d.bind=function(c){if(b.Lang.isObject(c)){var e={hover:!0},d=c.shape,g=c.size;e.shape=d;e.height={round:{small:"16",large:"32"},rect:{small:"20",large:"28"}}[d][g];e.color=c.color;"enabled_for_blogs"==c.mode?e.ancestorSelectorTest='[data-type="item"],[data-type="promoted-block"]':"enabled_for_blogs_and_pages"==c.mode&&(e.ancestorSelectorTest='[data-type="item"],[data-type="promoted-block"],[data-type="page"]');
b.config.win.PINTEREST.f.init(e)}};b.config.win.Squarespace.onInitialize(b,function(){d.bind(b.Object.getValue(b.config.win.Static,["SQUARESPACE_CONTEXT","websiteSettings","pinterestOverlayOptions"]))})},"1.0",{requires:["thirdparty-pinterest"]});
YUI.add("squarespace-models-google-domain",function(b){var d=b.namespace("Squarespace.Models");d.GoogleDomain=b.Base.create("googleDomain",d.Domain,[],{root:b.Squarespace.REST_API_ROOT+"domains/google",isNew:function(){return b.Lang.isValue(this.get("googleAuthRequestId"))}},{ATTRS:{googleAuthRequestId:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base","squarespace-models-domain"]});
YUI.add("squarespace-dialog-shipping-details-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-shipping-details.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="clearfix">\n  <div class="title">Package Details</div>\n  <div class="row">\n    <div class="header left">Cost</div>\n    <div class="cell">';(h=d.currencySymbol)?h=h.call(c,{hash:{},data:k}):
(h=c.currencySymbol,h="function"===typeof h?h.apply(c):h);b+=l(h);(h=d.rate)?h=h.call(c,{hash:{},data:k}):(h=c.rate,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n  </div>\n  <div class="row">\n    <div class="header">Weight</div>\n    <div class="cell">';(h=d.weight)?h=h.call(c,{hash:{},data:k}):(h=c.weight,h="function"===typeof h?h.apply(c):h);b+=l(h)+" ";(h=d.weightUnit)?h=h.call(c,{hash:{},data:k}):(h=c.weightUnit,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n  </div>\n  <div class="row">\n    <div class="header">Size</div>\n    <div class="cell">';
(h=d.cLength)?h=h.call(c,{hash:{},data:k}):(h=c.cLength,h="function"===typeof h?h.apply(c):h);b+=l(h);(h=d.dimensionUnit)?h=h.call(c,{hash:{},data:k}):(h=c.dimensionUnit,h="function"===typeof h?h.apply(c):h);b+=l(h)+" x ";(h=d.cHeight)?h=h.call(c,{hash:{},data:k}):(h=c.cHeight,h="function"===typeof h?h.apply(c):h);b+=l(h);(h=d.dimensionUnit)?h=h.call(c,{hash:{},data:k}):(h=c.dimensionUnit,h="function"===typeof h?h.apply(c):h);b+=l(h)+" x ";(h=d.cDepth)?h=h.call(c,{hash:{},data:k}):(h=c.cDepth,h="function"===
typeof h?h.apply(c):h);b+=l(h);(h=d.dimensionUnit)?h=h.call(c,{hash:{},data:k}):(h=c.dimensionUnit,h="function"===typeof h?h.apply(c):h);return b+=l(h)+"</div>\n  </div>\n</div>"})})();b.Handlebars.registerPartial("dialog-shipping-details.html".replace("/","."),d.templates["dialog-shipping-details.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-social-account-links-model-editor",function(b){var d={width:340,height:290,name:"social-account-links",buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Social Links",icon:"/universal/images-v6/icons/icon-social-18-light.png",tabTitle:"Design",name:"design",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.HTML,config:{name:"ordering-desc",content:"The social links block contains accounts that are both connected and marked as visible from the Connected Accounts area of your website manager. To change the order of these icons, drag them to new positions from the Connected Accounts area.",
className:"description"}},{ctor:b.Squarespace.DialogFields.Select,config:{titleStyle:"top",name:"iconStyle","strings.title":"Style",className:"thin dark",options:{$include:"iconStyleOptions"}}},{ctor:b.Squarespace.DialogFields.Select,config:{titleStyle:"top",name:"iconSize","strings.title":"Size",className:"thin dark",options:{$include:"iconSizeOptions"}}},{ctor:b.Squarespace.DialogFields.Select,config:{titleStyle:"top",name:"iconAlignment",className:"thin dark","strings.title":"Alignment",options:{$include:"iconAlignmentOptions"}}},
{ctor:b.Squarespace.DialogFields.Select,config:{name:"iconColor","strings.title":"Color",className:"thin dark",options:{$include:"iconColorOptions"}}}]}]};b.namespace("Squarespace.Block.ModelEditorDialog").SocialAccountLinks=b.Base.create("socialAccountLinks",b.Squarespace.ModelEditorDialog,[],{},{ATTRS:{dialogConfig:{value:d},dialogConfigContext:{value:{socialAccountPickerAccounts:{$valueFn:function(c){return b.Squarespace.Block.SocialAccountLinksUtils.getAccountsWithProfileUrl(c)}},iconStyleOptions:{$valueFn:function(){var c=
b.Squarespace.SocialIconStyles;return[{value:c.ROUND,label:"Round"},{value:c.SQUARE,label:"Square"},{value:c.ICON_ONLY,label:"Icon Only"}]}},iconSizeOptions:{$valueFn:function(){var c=b.Squarespace.SocialIconSizes;return[{value:c.DEFAULT,label:"Medium"},{value:c.SMALL,label:"Small"},{value:c.LARGE,label:"Large"}]}},iconAlignmentOptions:{$valueFn:function(){var c=b.Squarespace.SocialIconAlignments;return[{value:c.LEFT,label:"Left"},{value:c.CENTER,label:"Center"},{value:c.RIGHT,label:"Right"}]}},iconColorOptions:{$valueFn:function(){var c=
b.Squarespace.SocialIconColors;return[{value:c.BLACK,label:"Black"},{value:c.WHITE,label:"White"},{value:c.STANDARD,label:"Standard"}]}}}}}})},"1.0",{requires:["base","squarespace-model-editor","squarespace-dialog-social-account-picker","squarespace-dialog-select"]});
YUI.add("squarespace-block-quote-editor",function(b){b.namespace("Squarespace.Block.Editor").Quote=b.Base.create("block-quote-editor",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Quote")}},{NS:"blockEditor",ATTRS:{blockName:{value:"Quote"}}});b.namespace("Squarespace.Block.ModelEditorDialog").Quote=b.Base.create("blockQuoteEditor",b.Squarespace.ModelEditorDialog,[],{},{ATTRS:{dialogConfig:{valueFn:function(){return d}}}});
var d={name:"editQuoteBlock",width:420,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Quote",icon:"/universal/images-v6/icons/icon-quote-16-light-solid.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.TextArea,config:{name:"quote","strings.placeholder":"Enter quote...",height:110}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"source",submitOnEnter:!0,"strings.placeholder":"Enter source..."}}]}]}},"1.0",{requires:["squarespace-block-editor-base",
"squarespace-damask-context-globals","squarespace-dialog-text-area"]});
YUI.add("squarespace-dialog-form-preview",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.FormPreview=b.Base.create("formPreview",b.Squarespace.DialogField2,[],{initializer:function(){this._formPreview=new b.Squarespace.Widgets.FormPreview({form:this.get("data"),hideSubmitButton:!0});this._emptyMessage=b.Node.create('<div class="no-fields">No fields. Use the form builder to add some.</div>')},destructor:function(){this._formPreview.destroy()},renderUI:function(){d.superclass.renderUI.call(this);
var b=this.get("contentBox");this._formPreview.render(b);b.append(this._emptyMessage)},syncUI:function(){d.superclass.syncUI.call(this);this._formPreview.syncUI();0<this.get("data").get("fields").length?(this._emptyMessage.hide(),this._formPreview.show()):(this._formPreview.hide(),this._emptyMessage.show())}},{CSS_PREFIX:"sqs-dialog-preview-form",ATTRS:{data:{value:null,validator:function(c){return b.instanceOf(c,b.Squarespace.Models.Form)}},readOnly:{value:!0}}})},"1.0",{requires:"base node json squarespace-dialog-field-2 squarespace-models-form squarespace-form-preview".split(" ")});
YUI.add("squarespace-template-picker",function(b){var d=b.Squarespace.TemplatePicker=b.Base.create("TemplatePicker",b.Squarespace.Widgets.SSWidget,[],{initializer:function(){this._hasTransitionedOut=this._hasTransitionedIn=!1},renderUI:function(){var c=b.Node.create('<header class="preview-header"></header>').appendTo(this.get("contentBox"));this._closeButtonEl=c.appendChild('<a class="close-button" href="#"></a>');c.appendChild('<div class="instructions-wrapper"></div>').append('<div class="title">Pick a New Template to Install</div>').append('<div class="description">Select a template to install. Installing a template will not affect your live website.</div>');
c=b.Node.create('<div class="preview-viewport"></div>').appendTo(this.get("contentBox"));this._viewportInnerEl=b.Node.create('<div class="inner"></div>').appendTo(c);this._framePlaceholderEl=b.Node.create('<div class="display-placeholder"></div>').appendTo(this._viewportInnerEl);this._loaderEl=b.Node.create('<div class="loading-indicator"><span>Loading templates&hellip;</span></div>').appendTo(c);this.get("boundingBox").plug(b.Squarespace.ScrollLock);b.one("body").addClass("preview-open");b.later(1,
this,function(){this.get("boundingBox").addClass("open")});this._showSpinner();this._framePlaceholderEl.setStyle("display","block");this._showTimer=b.later(d.TRANSITION_IN_DURATION,this,function(){this._hasTransitionedIn=!0;this._load();this._iframeSourceTimer&&this._iframeSourceTimer.cancel()})},bindUI:function(){this._closeButtonEl.on("click",function(b){b.halt();this.destroy()},this)},_load:function(){b.Squarespace.TemplateInstallRPC.createConsumer({container:this._viewportInnerEl.getDOMNode(),
onLoad:b.bind(this._onLoad,this),installTemplate:b.bind(function(b){this.fire("install-template",{identifier:b.cloneIdentifier})},this)}).configure({lang:{TEMPLATE_CALL_TO_ACTION:"Install Template"}})},_onLoad:function(){this.get("boundingBox").addClass("loaded");this._framePlaceholderEl.setStyle("display","none")},_showSpinner:function(){this._hideSpinner();this._spinner=new b.Squarespace.Spinner({color:"light",size:"xx-large",render:this._loaderEl})},_hideSpinner:function(){this._spinner&&(this._spinner.destroy(),
this._spinner=null)},destroy:function(){b.one("body").removeClass("preview-open");this._hasTransitionedOut||(this._hasTransitionedOut=!0,this.get("boundingBox").removeClass("open").addClass("fast"),b.later(d.TRANSITION_OUT_DURATION,this,function(){d.superclass.destroy.call(this)}))},destructor:function(){this._hideSpinner();this._showTimer&&(this._showTimer.cancel(),this._showTimer=null);this._closeButtonEl.remove(!0)}},{CSS_PREFIX:"sqs-preview",TRANSITION_IN_DURATION:500,TRANSITION_OUT_DURATION:300})},
"1.0",{requires:"base-build node squarespace-common squarespace-ui-base squarespace-ss-widget squarespace-spinner squarespace-tourtip".split(" ")});
YUI.add("squarespace-models-billing-contact",function(b){b.namespace("Squarespace.Models.Billing");b.Squarespace.Models.Billing.Contact=b.Base.create("billingContact",b.Model,[],{isNew:function(){return!1}},{ATTRS:{name:{validator:b.Squarespace.AttrValidators.isString},email:{validator:b.Squarespace.AttrValidators.isString},memberAccountId:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["base","model","squarespace-attr-validators"]});
YUI.add("squarespace-image-picker",function(b){b.namespace("Squarespace.Widgets").ImagePickerDragPlugin=b.Base.create("imagePickerDragPlugin",b.Plugin.Base,[],{initializer:function(){this._selector=new b.Squarespace.DragSelection({node:this.get("host").get("boundingBox")});this._selector.on(this.get("host").get("id")+"|selection-dragged",this._selectImages,this);this.get("host").get("multiSelect")||console.warn("Image picker drag selection plugin only works on multi-selectable image pickers!")},_selectImages:function(b){var e=
this.get("host"),d=e.get("boundingBox").all(".images .preview"),g=e.get("selectedImageURLs"),h=e.get("maxSelected");d.each(function(e){if(g.length<h&&e.inRegion(b.region)){var d=e.getData("imageURL");-1===g.indexOf(d)&&(g.push(d),e.addClass("selected"))}});e._set("selectedImageURLs",g)},destructor:function(){this._selector.destroy()}},{NS:"ds"});var d=b.namespace("Squarespace.Widgets").ImagePicker=b.Base.create("imagePicker",b.Squarespace.Widgets.DataWidget,[],{initializer:function(){this._displayedImages=
{};this.plug(b.Plugin.WidgetAnim)},destructor:function(){b.Squarespace.EscManager.removeTarget(this)},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("boundingBox"),e=this.get("strings");b.one(".instructions").setContent(e.instructions);b.one(".cancel").setContent(e.cancelButton);b.one(".confirm").setContent(e.confirmButton);b.one(".prev").setContent("Previous");b.one(".next").setContent("Next");var f=b.one(".error");f.hide();f.setContent(e.loadFailed);this._updateEscapeManager();
this._sizeVisualizerNode=b.one(".size-visualizer");this._hideSizeVisualizer()},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("id");this.on(c+"|dataStateChange",this._uiSyncDataState,this);this.after(c+"|imageURLsChange",this.syncUI,this);this.after(c+"|visibleChange",this._updateEscapeManager,this);this.after(c+"|pageChange",this.syncUI,this);var e=this.get("boundingBox");e.on(c+"|click",this._selectImage,this);e.plug(b.Squarespace.ScrollLock);e.one(".images").on(c+"|mouseleave",
this._hideSizeVisualizer,this);e.one(".cancel").on(c+"|click",function(b){this.hide();this.fire("cancel")},this);e.one(".confirm").on(c+"|click",function(b){this.hide();this.fire("submit")},this);e.one(".next").on(c+"|click",function(b){b.halt();this.set("page",this.get("page")+1)},this);e.one(".prev").on(c+"|click",function(b){b.halt();this.set("page",this.get("page")-1)},this)},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("contentBox"),e=c.one(".images"),f=this.get("imageURLs").slice(0),
g=this.get("strings");this.get("sizeInfo")?c.addClass("has-size-info"):c.removeClass("has-size-info");if(this.get("paginate")){var h=this.get("pageSize"),k=this.get("page")*h,l=Math.min(k+h,f.length),p=c.one(".prev");0>=this.get("page")?p.addClass("hidden"):p.removeClass("hidden");p=c.one(".next");k+h>=f.length?p.addClass("hidden"):p.removeClass("hidden");f=f.slice(k,l)}h=c.one(".confirm");this.get("multiSelect")?h.show():h.hide();b.Object.each(this._displayedImages,function(b,c){if(-1===f.indexOf(c)){var d=
e.one('[data-id="'+this._displayedImages[c]+'"]');d&&(d.ancestor(".preview",!0).remove(!0),this._displayedImages[c]=null)}},this);b.Array.each(f,function(c){var d=this.get("id");if(!this._displayedImages[c]){this.get("dataState")!==this.getProperty("DATA_STATES").LOADED&&this.setLoadedState();var f=b.Node.create(this.getProperty("IMAGE_TEMPLATE")),h=f.one("img");this.get("imageDimensions");f.setData("imageURL",c);e.appendChild(f);this.get("multiSelect")&&-1!==this.get("selectedImageURLs").indexOf(c)&&
f.addClass("selected");h.onceAfter(d+"|load",function(c){var e=c.target.get("naturalHeight"),k=c.target.get("naturalHeight");f.one(".dimensions span").setContent(b.substitute(g.imageDimensions,{height:k,width:e}));f.setData("width",e);f.setData("height",k);var k=f.one(".image-underlay"),e=k.width(),k=k.height(),l=c.target.get("width");c=c.target.get("height");f.one(".image-wrapper").setStyles({width:l+4,height:c+4,top:Math.floor(k/2-c/2),left:Math.floor(e/2-l/2)});h.setStyles({top:null,left:null,
position:"static"});f.on(d+"|mouseenter",this._updateSizeVisualizer,this)},this);h.plug(b.Squarespace.Loader2,{source:c,fit:!0});var k=h.loader,l=f.one(".dimensions"),p=function(){k.get("loading")?l.addClass("loading"):l.removeClass("loading")};p();k.after(d+"|loadingChange",p,this);p=h.getAttribute("data-id");p||(p=b.guid(),h.setAttribute("data-id",p));this._displayedImages[c]=p}},this);0<f.length&&c.one(".error").hide();c=c.one(".pagination");this.get("paginate")?c.show():c.hide()},_uiSyncDataState:function(b){b=
b?b.newVal:this.get("dataState");var e=this.getProperty("DATA_STATES"),d=this.get("contentBox").one(".error"),g=this.get("imageURLs"),h=this.get("strings");switch(b){case e.LOADED:0===g.length&&(d.setContent(h.noImages),d.show());break;case e.LOAD_FAILED:d.setContent(h.loadFailed);d.show();break;default:d.hide()}},_isImageWrapper:function(b){return!!b.getData("imageURL")},_selectImage:function(c){c.preventDefault();c.stopPropagation();c=c.target.ancestor(this._isImageWrapper,!0);var e=this.get("contentBox").one(".images"),
d=this.get("selectedImageURLs"),g=this.get("multiSelect");if(c){var h=c.getData("imageURL");g?d.length>=this.get("maxSelected")?new b.Squarespace.Widgets.Alert({"strings.title":"Too Many Images","strings.message":"You have selected the maximum number of images allowed. Please remove an image before selecting another."}):(c.hasClass("selected")?d=b.Array.filter(d,function(b){return b!==h}):d.push(h),c.toggleClass("selected"),this._set("selectedImageURLs",d)):(c.addClass("selected"),e.all(".preview").removeClass("selected"),
this._set("selectedImageURL",h));this.get("hideOnSelect")&&this.hide()}else g&&(this._set("selectedImageURLs",[]),this.get("contentBox").all(".preview.selected").each(function(b){b.removeClass("selected")}))},_updateSizeVisualizer:function(b){if(this._sizeVisualizerNode){var e=b.target.ancestor(this._isImageWrapper,!0);b=e.getData("width");var e=e.getData("height"),d=this._sizeVisualizerNode.one(".label.width"),g=this._sizeVisualizerNode.one(".label.height");d.setContent(b+"px");g.setContent(e+"px");
d.setStyle("left",b-38);g.setStyle("top",e-20);this._sizeVisualizerNode.show();this._sizeVisualizerNode.one(".ruler.width").setStyle("width",b);this._sizeVisualizerNode.one(".ruler.height").setStyle("height",e)}},_hideSizeVisualizer:function(){this._sizeVisualizerNode&&this._sizeVisualizerNode.hide()},_updateEscapeManager:function(){this.get("visible")?b.Squarespace.EscManager.addTarget(this):b.Squarespace.EscManager.removeTarget(this)}},{CSS_PREFIX:"sqs-image-picker",HANDLEBARS_TEMPLATE:"image-picker.html",
IMAGE_TEMPLATE:'<div class="preview"><div class="image-underlay"><div class="dimensions"><span></span></div><div class="image-wrapper"><img /></div></div></div>',ATTRS:{visible:{value:!1},strings:{value:{instructions:"Select an Image",cancelButton:"Cancel",loadFailed:"Unable to load images, please check the URL and try again later.",noImages:"No images available.",imageDimensions:"{width} x {height}",confirmButton:"Confirm"}},imageURLs:{value:[],validator:b.Lang.isArray},selectedImageURL:{value:null,
readOnly:!0},selectedImageURLs:{value:[],readOnly:!0},hideOnSelect:{value:!0},multiSelect:{value:!1},maxSelected:{value:Number.MAX_VALUE,validator:b.Lang.isNumber},paginate:{value:!1},pageSize:{value:25},page:{value:0,validatore:b.Lang.isNumber},sizeInfo:{value:!0}}})},"1.0",{requires:"base base-build widget widget-parent widget-anim squarespace-ss-widget squarespace-image-loader squarespace-ui-base squarespace-async-task-synchronizer squarespace-image plugin squarespace-drag-selection squarespace-image-picker-template squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-stats-timeline-model",function(b){var d=function(){};b.namespace("Squarespace.Stats.Models").Timeline=b.Base.create("statsTimelineModel",b.Model,[],{sync:function(c,e,f){b.Lang.isFunction(f)||(f=d);e.start&&(e.start=this._convertDateValueToGMT(e.start));e.end&&(e.end=this._convertDateValueToGMT(e.end));switch(c){case "read":this._read(e,f);break;case "delete":console.error("Delete not implemented.");break;case "create":console.error("Create not implemented.");break;case "update":console.error("Update not implemented.")}},
loadTotals:function(){var c=b.Squarespace.StatsTimeFrameFns.ALL();c.dataType=b.Squarespace.CensusDataType.TOTAL;c.dataMetric=this.get("dataMetric");c.granularity=b.Squarespace.CensusGranularity.DAILY;this.load(c)},loadDataForExtent:function(){var b=this.get("extent"),e=this.get("dataType"),d=this.get("dataMetric"),g=this.get("granularity"),h=this._getIncrementFn(g),k=this._stripTimeFromDate(b[0]),b=h(this._stripTimeFromDate(b[1]));this.load({start:k,end:h(b),dataType:e,dataMetric:d,granularity:g})},
_read:function(c,e){1!==c.dataType&&(this.set("isLoading",!0),c.limit=this.get("limit"));b.Data.get({url:"/api/census/GetData",data:c,success:function(b){1===b.dataType?this._normalizeTotalsData(b):(this._normalizeData(b),this.set("isLoading",!1))},failure:function(b){1!==c.dataType&&this.set("isLoading",!1);e.apply(null,[!0,b])}},this)},_stripTimeFromDate:function(b){b=new Date(b);b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0);return b},_getTimePointsFromResponse:function(b,e){var d=
this._convertDateValueToGMT(b.start),g=this._convertDateValueToGMT(b.end);return this._getTimePoints(d,g,e)},_getTimePointsFromTotals:function(b,e,d){b=this._convertDateValueToGMT(b[0].d);d=this._convertDateValueToGMT(d.end);var g=new Date,g=new Date(g.getFullYear(),g.getMonth(),g.getDate()+1);d>g&&(d=g);return this._getTimePoints(b,d,e,!1)},_getIncrementFn:function(c){var e;switch(c){case b.Squarespace.CensusGranularity.HOURLY:e="incrementHour";break;case b.Squarespace.CensusGranularity.DAILY:e=
"incrementDay";break;case b.Squarespace.CensusGranularity.WEEKLY:e="incrementWeek";break;case b.Squarespace.CensusGranularity.MONTHLY:e="incrementMonth"}return b.Squarespace.StatsTimeFrameUtils[e]},_getTimePoints:function(b,e,d,g){var h=[];d=this._getIncrementFn(d);g?(b=d(b,-1).valueOf(),e=d(e).valueOf()):b=b.valueOf();for(;b<=e;)h.push(b),b=d(b).valueOf();return h},_seedNestedDataWithValues:function(c,e,d){for(var g=0,h=e.length,k,l=0;g<h;g++)k=e[g],k.d=this._convertDateValueToGMT(k.d),k.title=1===
d?void 0:k.v[1],k=1===d?"Other":k.v[0],b.Object.hasKey(c,k)||(c[k]={},l++);return c},_seedNestedDataWithDates:function(c,e){var d,g,h,k=e.length,l;for(d in c){g=c[d];l={};for(h=0;h<k;h++)b.Object.hasKey(g,e[h])?l[e[h]]=g[e[h]]:l[e[h]]=0;c[d]=l}return c},_seedNestedDataWithCounts:function(c,e,d){var g=this._getDataMetricMapping(),h=0,k=e.length,l,p,q,r={};for(l in c)r[l]={};for(;h<k;h++)l=e[h],p=1===d?"Other":l.v[0],q=c[p],p=r[p],b.Object.hasKey(q,l.d)&&(b.Object.hasKey(p,l.d)?q[l.d].count+=l[g]||
0:(q[l.d]={count:l[g]||0,title:l.title},p[l.d]=1));return c},setDataMetric:function(c){this.set("dataMetric",b.Squarespace.CensusDataMetric[c])},_getDataMetricMapping:function(){var b=this.get("dataMetric");if(1===b)return"vw";if(2===b)return"vt";if(3===b)return"vr"},_compileNormalizedData:function(c){var e,d,g,h,k,l=[];for(e in c)for(g in d=c[e],d)h=!b.Lang.isUndefined(d[g].count)?d[g].count:d[g],k=d[g].title,l.push({d:parseInt(g,10),value:e,title:k,count:h});return l},_normalizeTotalsData:function(b){var e=
b.raw,d=b.granularity,g=this.get("nestedTotalsData");0<e.length?(d=this._getTimePointsFromTotals(e,d,b),g={},this._seedNestedDataWithValues(g,e,b.dataType),this._seedNestedDataWithDates(g,d),this._seedNestedDataWithCounts(g,e,b.dataType),b=this._compileNormalizedData(g),this.set("nestedTotalsData",g),this.set("normalizedTotalsData",b)):console.info("Data set is empty.")},_normalizeData:function(c){var e=c.raw,d=c.dataType,g=c.dataMetric,h=c.granularity;this.get("dataType");var k=this.get("dates"),
l=this.get("nestedData");c.start&&c.end?(k=[],l={},k=b.Array.unique(k.concat(this._getTimePointsFromResponse(c,h))),k.sort(b.Array.numericSort),this._seedNestedDataWithValues(l,e,d),this._seedNestedDataWithDates(l,k),this._seedNestedDataWithCounts(l,e,d),c=this._compileNormalizedData(l)):(console.info("Data set is empty."),c=this.get("normalizedData"));c&&this._formatDataForGraphs(c);this.set("dataType",d);this.set("dataMetric",g);this.set("dates",k);this.set("nestedData",l);this.set("normalizedData",
c);this.set("granularity",h)},_addLeadingZeros:function(b){for(var e=0,d=b.length,g,h,k,l;e<d;e++){k=0;l=b[e].values;g=0;for(h=l.length;g<h;g++)if(0===l[g].count)k++;else break;b[e].leadingZeros=k}return b},_filterByExtent:function(b){for(var e=this.get("extent"),d=e[0].valueOf(),g=e[1].valueOf(),h=0,e=function(b){b=b.d>=d&&b.d<=g?b.count:0;h+=b;return b},k=0,l=b.length,p;k<l;k++){p=b[k];p.extentCount=d3.sum(p.values.map(e));for(var q=0;q<p.values.length;q++)if(p.values[q].title){p.title=p.values[q].title;
break}}b.sort(function(b,c){return b.extentCount>c.extentCount?-1:c.extentCount>b.extentCount?1:0});for(k=0;k<l;k++)p=b[k],p.extentPercentage=Math.round(1E3*(p.extentCount/h))/10;return b},_formatDataForGraphs:function(b){var e=this.get("stackFn"),d=this.get("valueNestFn"),g=this.get("dateNestFn"),d=d(b);b=g(b);this._filterByExtent(d);this._addLeadingZeros(d);0<d.length?(g=d.slice(0),g.sort(function(b,c){return c.leadingZeros-b.leadingZeros}),e=e(g)):e=[];b=b.map(function(b){return{d:b.values[0].d,
count:d3.sum(b.values.map(function(b){return b.y}))}});this.setAttrs({totalsByDate:b,streamsByValue:e})},_convertDateValueToGMT:function(b){b=new Date(b);return b.addMilliseconds(6E4*b.getTimezoneOffset()).valueOf()}},{TOTAL_KEY:"TOTAL_KEY",ATTRS:{dataType:{value:b.Squarespace.CensusDataType.PAGE_URL,validator:function(c){return b.Lang.isNumber(c)&&b.Object.hasValue(b.Squarespace.CensusDataType,c)}},dataMetric:{value:b.Squarespace.CensusDataMetric.VISITS,validator:function(c){return b.Lang.isNumber(c)&&
b.Object.hasValue(b.Squarespace.CensusDataMetric,c)}},granularity:{value:b.Squarespace.CensusGranularity.DAILY,validator:function(c){return b.Lang.isNumber(c)&&b.Object.hasValue(b.Squarespace.CensusGranularity,c)}},limit:{value:10},extent:{value:[],validator:function(c){return b.Lang.isArray(c)&&(0===c.length||2===c.length)}},stackFn:{value:d3.layout.stack().offset("zero").values(function(b){return b.values}).x(function(b){return b.d}).y(function(b){return b.count})},valueNestFn:{value:function(b){return d3.nest().key(function(b){return b.value}).entries(b)}},
dateNestFn:{value:function(b){return d3.nest().key(function(b){return b.d}).entries(b)}},dates:{value:[]},nestedData:{value:{}},nestedTotalsData:{value:null},normalizedData:{value:null},normalizedTotalsData:{value:null},totalsByDate:{value:null},streamsByValue:{value:null},isLoading:{value:!1}}})},"1.0",{requires:"base model squarespace-enum squarespace-util squarespace-stats-timeframes thirdparty-d3".split(" ")});
YUI.add("squarespace-editor-member-invite",function(b){b.namespace("Squarespace.Editor");var d=b.Squarespace.Editor.MemberInvite=b.Base.create("MemberInvite",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this.get("dialog").on("remove-requested",this._confirmAndRemove,this)},save:function(c){var e=this.get("model").isNew();d.superclass.save.call(this,c,b.bind(function(){new b.Squarespace.Widgets.Information({"strings.title":e?"Invite Sent":"Invite Saved","strings.message":e?"The invite was successfully sent.":
"The specified invite has been saved."})},this))},getDialogData:function(){var c=d.superclass.getDialogData.call(this);c.inviteUrl=b.Lang.sub("{secureDomain}/config/acceptInvite?invitation={inviteCode}",{secureDomain:Static.SQUARESPACE_CONTEXT.secureDomain,inviteCode:encodeURIComponent(c.inviteCode)});return c},sanitizeDialogData:function(c){c=d.superclass.sanitizeDialogData.call(this,c);var e={};b.Array.each(c.permissions,function(b){e[b]=!0});c.permissions=e;return c},_confirmAndRemove:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Invitation",
"strings.message":"Are you sure you wish to remove this invitation?"})).on("confirm",function(){this.get("model").destroy({remove:!0},b.bind(function(){new b.Squarespace.Widgets.Information({"strings.title":"Invitation Removed","strings.message":"The specified invitation has been removed."});this.destroy()},this))},this)},_getNewInviteFields:function(){return[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Invite Information",text:"Enter a name and email address for the user you would like to invite below."}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"name",className:"large",required:!0,"strings.placeholder":"Name"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"email",className:"thin",required:!0,mailcheck:!0,"strings.placeholder":"Email Address"}},{ctor:b.Squarespace.DialogFields.Description,config:{padding:[10,0],title:"Permissions",text:"Select what permissions the invited contributor will have. Permissions control what this contributor can do on your site."}},{ctor:b.Squarespace.DialogFields.Permissions,
config:{name:"permissions",columns:2,allowEmpty:!1}}]},_getExistingInviteFields:function(){return[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Invitation Link",name:"inviteLinkDescription"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"inviteUrl",className:"thin",readOnly:!0,selectAllOnFocus:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"permissionsDescription",title:"Permissions",text:"This is a pending invitation. Below, you can change the permissions that will be assigned if this invitation is accepted."}},
{ctor:b.Squarespace.DialogFields.Permissions,config:{name:"permissions",columns:2,allowEmpty:!1}}]}},{ATTRS:{model:{value:null,validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.MemberInvite)},dialogConfig:{getter:function(){var b=this.get("model"),e=b.isNew(),d=[{type:"cancel",title:"Cancel"}];e?b="Invite Contributor":(b="Modify Invitation for "+b.get("name")+" ("+b.get("email")+")",d.push({type:"remove",title:"Remove Invite"}));d.push({type:"saveAndClose",title:"Save"});return{name:"editInvite",
closeOthers:!1,overlay:0.5,width:600,verticalHeight:"fit",buttons:d,tabs:[{title:b,icon:e?"/universal/images-v6/icons/icon-plus-16-light.png":"/universal/images-v6/content/member.png?2",scroll:!0,fields:e?this._getNewInviteFields():this._getExistingInviteFields()}]}}}}})},"1.0",{requires:"base squarespace-model-editor squarespace-models-member-invite squarespace-dialog-description squarespace-dialog-text squarespace-dialog-permissions squarespace-attr-validators squarespace-ui-base squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dialog-website-subjects",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.WebsiteSubjects=b.Base.create("dialogWebsiteSubjects",b.Squarespace.DialogField2,[],{initializer:function(){var c=b.Object.values(b.Squarespace.SystemWebsiteSubjects),c=b.Array.map(c,function(c){return new b.Squarespace.DialogFields.Check({name:c,"strings.title":this._formatSubjectForTitle(c),className:"dark"})},this);this.add(c);this._otherTextField=this.add(new b.Squarespace.DialogFields.Text({name:"otherTextField",
className:"other-subject","strings.placeholder":"Other","strings.title":"Other Subject"})).item(0)},renderUI:function(){var b=this.get("contentBox"),e=b.appendChild('<div class="checkboxes"></div>');this.each(function(d){"otherTextField"===d.get("name")?d.render(b):d.render(e)})},bindUI:function(){d.superclass.bindUI.call(this);this.each(function(b){var e=b.get("name");"other"===e&&(b.after("dataChange",function(){this._otherTextField.set("data",null,{silent:!0});this._toggleOtherTextFieldVisibility(b)},
this),this._toggleOtherTextFieldVisibility(b));"otherTextField"==e?b.after("dataChange",this._updateDataFromOtherTextField,this):b.after("dataChange",this._updateDataFromSystemCheckField,this)},this)},_toggleOtherTextFieldVisibility:function(b){b.get("data")?this._otherTextField.show():this._otherTextField.hide()},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("data"),c=b.Array.reduce(c,{},function(b,c){b[c.systemSubject]=!0;"other"==c.systemSubject&&(b.otherTextField=c.otherSubject);
return b});b.Squarespace.FormUtils.setData(this._items,c)},_updateDataFromOtherTextField:function(c){var e=c.target;c=this.get("data");var d=b.Array.partition(c,function(b){return"other"===b.systemSubject}),g=d.matches[0],d=d.rejects,e=e.get("data");b.Lang.isValue(g)?0<e.length?(g.otherSubject=e,this._silentUpdateData(c)):this._silentUpdateData(d):this._silentUpdateData(d.concat([{systemSubject:"other",otherSubject:e}]))},_updateDataFromSystemCheckField:function(c){c=c.target;var e=c.get("name"),
d=this.get("data"),g=b.Array.partition(d,function(b){return b.systemSubject===e}),d=g.matches[0],g=g.rejects;c=c.get("data");b.Lang.isValue(d)?c||this._silentUpdateData(g):c&&this._silentUpdateData(g.concat([{systemSubject:e}]))},_silentUpdateData:function(b){this.set("data",b,{noSyncUI:!0})},_formatSubjectForTitle:function(c){var e=c.split(/[\s_]/);return b.Array.map(e,function(b){var e=b.charAt(0).toUpperCase();b=b.substr(1,c.length);return e+b}).join(" ")},_validateData:function(c){return!b.Lang.isArray(c)?
(this._logError("Data is not an array."),!1):b.Array.every(c,function(c){(c=b.Lang.isValue(c.otherSubject)||b.Lang.isValue(c.systemSubject))||this._logError("A subject is missing the required fields 'otherSubject' or 'systemSubject'");return c})},_logError:function(b){console.error("[Dialog Website Subjects] "+b)}},{CSS_PREFIX:"sqs-dialog-website-subjects",ATTRS:{data:{validator:"_validateData",value:[]}}})},"1.0",{requires:"base squarespace-attr-validators squarespace-dialog-check squarespace-dialog-text squarespace-dialog-field-2 squarespace-enum squarespace-form-utils".split(" ")});
YUI.add("squarespace-widgets-google-apps-user-list-manager",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Promises,c=b.Squarespace.Fluent;b.Squarespace.Widgets.GoogleAppsUserListManager=b.Base.create("GoogleAppsUserListManager",b.Squarespace.Widgets.SyncModelListManager,[b.WidgetChild],{initializer:function(){var b=this.get("models");b.set("domain",this.get("domain"));b.after(["firstPage","previousPage","nextPage","currentPage"],b.load,b);b=this.get("header");b.after("*:add-request",
this.addUser,this);b.after("*:filter-request",this._beginFilterFlow,this);this.get("body").after("*:remove-request",this._removeRequested,this)},loadFirstPage:function(){this.get("models").firstPage()},addUser:function(){var b=d.chainFns([this._saveUser,this._addUserToList],this)();this._catchGoogleError(b,"Failed to add user")},_saveUser:function(){return new b.Promise(b.bind(function(c,d){var g=new b.Squarespace.Models.GoogleAppsUser({domain:this.get("models").get("domain")}),h=new b.Squarespace.Editor.GoogleApps.User({model:g}),
k=g.onceAfter("error",function(b){d(b.error.toString())}),l=g.onceAfter("save",function(){c(g)});h.after("destroy",k.detach,k);h.after("destroy",l.detach,l);h.show()},this))},_beginRemoveUserFlow:function(c){c=this._confirmUserRemoval(c).then(b.bind(this._removeUser,this));this._catchGoogleError(c,"Failed to remove user")},_beginFilterFlow:function(){var c=this.get("models");this._getFilterFromUser().then(b.bind(c.set,c,"email")).then(b.bind(this.loadFirstPage,this))},_getFilterFromUser:function(){return new b.Promise(b.bind(function(c,
d){var g=this.get("models").get("email"),h=new b.Squarespace.EditingDialog({name:"googleAppsUserListFilter",closeOthers:!1,overlay:0,style:"flyout",width:400,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Apply"}],tabs:[{title:"Filter Users",icon:"/universal/images-v6/icons/icon-domains-18-light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"filter","strings.placeholder":"name@example.com",submitOnEnter:!0}}]}]});h.setInitialData({filter:g});h.on("send-requested",
function(){var b=h.getData();h.close();c(b.filter)});h.on("cancel-click",d);h.show()},this))},_catchGoogleError:function(c,f){d.reject(c,b.bind(function(c){b.Lang.isObject(c)&&c.responseJSON.googleError&&this._showInternalGoogleError(f)},this))},_showInternalGoogleError:function(c){new b.Squarespace.Widgets.Alert({"strings.title":c,"strings.message":"There was a problem contacting a Google service."})},_confirmUserAddition:function(e){return new b.Promise(function(b,d){c.Confirm({"strings.title":"Add New User?",
"strings.message":"Are you sure you want to add user: <strong>"+e.email+"</strong> to your account?"},e).then(b,d)})},_confirmUserRemoval:function(e){return new b.Promise(function(b,d){c.Confirm({"strings.title":"Delete User?","strings.message":"Are you sure you want to remove user: <strong>"+e.get("email")+"</strong> from your account?"},e).then(b,d)})},_getUserInfo:function(){var c=this.get("models").get("domain");return b.when({email:"sjackson@"+c,firstName:"Samuel",lastName:"Jackson"})},_addUserToList:function(b){this.get("models").add(b)},
_removeRequested:function(b){this._beginRemoveUserFlow(b.user)},_removeUser:function(c){return new b.Promise(function(b,d){c.destroy({remove:!0},function(c){c?d(c):b()})})}},{CSS_PREFIX:"sqs-google-apps-user-list-manager",ATTRS:{domain:{validator:b.Squarespace.AttrValidators.isString},constructors:{value:{models:b.Squarespace.Models.GoogleAppsUserList,header:b.Squarespace.Widgets.GoogleAppsUserListHeader,body:b.Squarespace.Widgets.GoogleAppsUserList}}}})},"1.0",{requires:"base squarespace-fluent-confirmation squarespace-promises squarespace-models-google-apps-user-list squarespace-widgets-google-apps-user-list squarespace-widgets-google-apps-user-list-header squarespace-widgets-sync-model-list-manager squarespace-editor-google-apps-user squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-range",function(b){function d(e){var f=Array.prototype.slice.call(arguments,1);e&&null==e[c]&&(e._range?e=e._range:(f.unshift(e),e=null));e||(e=b.config.doc.createRange());d.superclass.constructor.apply(this,f);if(this.get("root")){var f=e.cloneRange(),g=this.get("root");g&&(g=g._node,f.selectNodeContents(g));d.intersection(e,f)||(e.setStart(g,0),e.setEnd(g,0))}this._range=e;return this}var c="START_TO_START",e=/^\s+/,f=/\s+$/,g=/(?:^\s+)|(?:\s+$)/g,h=/^[\s\u200b]*$/;b.namespace("Squarespace").Range=
d;b.extend(d,b.Base,{isIdentical:function(b){var c=this._range;return c.startContainer===b.startContainer&&c.endContainer===b.endContainer&&c.startOffset===b.startOffset&&c.endOffset===b.endOffset},isEqual:function(b){return d.isEqual(this._range,b)},union:function(b){return d.union(this.cloneRange(),b)},intersection:function(b){return d.intersection(this.cloneRange(),b)},getPseudoBoundingClientRect:function(){var c=this._range.cloneRange(),e=Math.max(0,(c.endContainer.childNodes&&c.endContainer.childNodes.length||
c.endContainer.textContent.length)-1);c.setEnd(c.endContainer,Math.min(c.endOffset+1,e));c=b.Array(c.getClientRects());e=c.filter(function(b){return b.width});e.length?(c=e.reduce(function(b,c){return{top:Math.min(b.top,c.top),left:Math.min(b.left,c.left),right:Math.max(b.right,c.right),bottom:Math.max(b.bottom,c.bottom)}}),c.width=c.right-c.left,c.height=c.bottom-c.top):c=c[0];return c},shrink:function(){this._range=d._shrink(this._range);return this},grow:function(b){b=b&&b._node||b;var c=this.get("root");
this._range=d._grow(this._range,b||(c?c._node:null));return this},collapse:function(b){this._range.collapse(b);return this},collapsed:function(){return h.test(this._range.toString())},empty:function(){return this._range.collapsed},setStart:function(b,c){b=b._node||b;this._range.setStart(b,c);return this},setEnd:function(b,c){b=b._node||b;this._range.setEnd(b,c);return this},selectNode:function(c){c=c._node||c;b.one(this._range.selectNode.call(this._range,c));return this},selectNodeContents:function(b){b=
b._node||b;this._range.selectNodeContents.call(this._range,b);return this},cloneContents:function(){return b.one(this._range.cloneContents.apply(this._range,arguments))},cloneRange:function(){return new d(this._range.cloneRange(),{root:this.get("root")})},surroundContents:function(b,c){var e=this._range,f=d.extractContents(e);c=c&&c._node||c||b._node||b;b.appendChild(f);e.insertNode(c);return this},extractContents:function(){return b.one(d.extractContents(this._range))},insertNode:function(b){this._range.insertNode(b._node||
b);return this},deleteContents:function(){d.extractContents(this._range);return this},fromSelection:function(){var b=d.fromSelection()._range,c=this.get("root"),e;c&&(e=b.cloneRange(),e.selectNodeContents(c._node),d.intersection(b,e));this._range.setStart(b.startContainer,b.startOffset);this._range.setEnd(b.endContainer,b.endOffset);return this},toSelection:function(){d.toSelection(this._range);return this},iterate:function(b,c){function e(b){if(b.hasChildNodes())return b.firstChild;if(b.nextSibling)return b.nextSibling;
for(;b&&!b.nextSibling;)b=b.parentNode;return b&&b.nextSibling?b.nextSibling:null}var d=current=this._range.startContainer,f=this._range.startOffset,g=this._range.endContainer,h;c&&(current=c,b(current));if(current===g)b(current);else{3==current.nodeType&&(current=current.parentNode,0<f&&(h=d.textContent.substring(f)),b(current,h));for(;current&&current!=g;)(current=e(current))&&b(current)}},_getOffsets:function(){function b(c,e){return c+e.length}var c=this.get("root")._node,e=this._range,f=e.startContainer,
g=e.endContainer,h=e.collapsed,t=3===f.nodeType?e.startOffset:0,e=e.endOffset;if(3!==g.nodeType&&0!==e)if(h)e=0;else{for(h=g.childNodes[e-1];h&&3!==h.nodeType;)g=h,e=g.childNodes.length,h=g.childNodes[e-1];e=h&&h.textContent.length||0}return{start:d._previousText(f,c).reduce(b,0)+(0===t?0.1:t),end:d._previousText(g,c).reduce(b,0)+e}},_setOffsets:function(b){if(!this.get("root")||!b.start&&!b.end)return b;var c=this.get("root"),e=this._range,f=d._offsetToNode(c,b.start),c=Math.floor(b.start)===Math.floor(b.end)&&
e.collapsed?f:d._offsetToNode(c,b.end);e.setStart(f.node,Math.floor(f.offset));c&&e.setEnd(c.node,Math.floor(c.offset));this.shrink();return b},_getContainer:function(){return b.one(this._range.commonAncestorContainer)},_getStartCont:function(){return b.one(this._range.startContainer)},_getStartOff:function(){return this._range.startOffset},_getEndCont:function(){return b.one(this._range.endContainer)},_getEndOff:function(){return this._range.endOffset}},{NAME:"Range",ATTRS:{root:{value:null,lazyAdd:!0},
offsets:{value:{start:0,end:0},lazyAdd:!0,getter:"_getOffsets",setter:"_setOffsets"},container:{value:null,getter:"_getContainer",readOnly:!0},startContainer:{getter:"_getStartCont"},startOffset:{getter:"_getStartOff"},endContainer:{getter:"_getEndCont"},endOffset:{getter:"_getEndOff"}},isPointIdentical:function(b,c,e){if(!b||!c)return!1;null==e&&(e="start");b._range&&(b=b._range);c._range&&(c=c._range);return"start"===e?b.startContainer===c.startContainer&&b.startOffset===c.startOffset:b.endContainer===
c.endContainer&&b.endOffset===c.endOffset},isEqual:function(b,c){return d.isPointEqual(b,c)&&d.isPointEqual(b,c,"end")},isPointEqual:function(b,e,f){if(!b||!e)return!1;var g=!0;null!=f&&"start"!==f&&(g=!1);b._range&&(b=b._range);e._range&&(e=e._range);f=b.cloneRange();var r=b.cloneRange(),s=g?b.startContainer:b.endContainer,t=g?e.startContainer:e.endContainer,u=g?b.startOffset:b.endOffset,v=g?e.startOffset:e.endOffset;if(0===b.compareBoundaryPoints(g?b[c]:b.END_TO_END,b,e)&&s===t&&u===v)return!0;
f.setStart(s,u);f.setEnd(t,v);r.setStart(t,v);r.setEnd(s,u);r.toString().length>f.toString().length&&(f=r);b=f.toString();return""===b||h.test(b)&&(r=f.cloneRange(),d._grow(r),d._wsBefore(f)||d._wsBefore(r)||d._wsAfter(r))?!0:!1},isOverlap:function(b,c){b=b._range||b;c=c._range||c;try{var e=!(0>b.compareBoundaryPoints(b.END_TO_START,c)&&0>b.compareBoundaryPoints(b.START_TO_END,c)),f=!(0<b.compareBoundaryPoints(b.END_TO_START,c)&&0<b.compareBoundaryPoints(b.START_TO_END,c))}catch(g){return!1}return d.isPointEqual(b,
c)?f:d.isPointEqual(b,c,"end")?e:e&&f},union:function(b,e){if(d.isOverlap(b,e)){e=e._range||e;var f=b._range||b,g=0>f.compareBoundaryPoints(f[c],e)?f:e,h=0>f.compareBoundaryPoints(f.END_TO_END,e)?e:f;g===e&&f.setStart(e.startContainer,e.startOffset);h===e&&f.setEnd(e.endContainer,e.endOffset);return b}return null},intersection:function(b,e){e=e._range||e;var f=b._range||b;if(f.startContainer.documentElement!==e.startContainer.documentElement||!d.isOverlap(b,e))return null;var g=0>f.compareBoundaryPoints(f[c],
e)?e:f,h=0>f.compareBoundaryPoints(f.END_TO_END,e)?f:e;g===e&&f.setStart(e.startContainer,e.startOffset);h===e&&f.setEnd(e.endContainer,e.endOffset);return b},_wsBefore:function(c){var e=b.config.doc.createRange(),d=c.startContainer;c=c.startOffset;return 3===d.nodeType&&f.test(d.textContent.substring(0,c))||0<c&&(c<=d.childNodes.length&&null!=d.childNodes[c-1])&&(e.selectNode(d.childNodes[c-1]),f.test(e.toString()))?!0:!1},_wsAfter:function(c){var d=b.config.doc.createRange(),f=c.endContainer;c=
c.endOffset;return 3===f.nodeType&&e.test(f.textContent.substring(c))||0<=c&&(c<f.childNodes.length&&null!=f.childNodes[c])&&(d.selectNode(f.childNodes[c]),e.test(d.toString()))?!0:!1},_shrink:function(b){var c=b.startContainer,e=b.startOffset,f=b.endContainer,g=b.endOffset;if(b.collapsed)return b;for(;3===c.nodeType&&(h.test(c.textContent)||c.textContent.length===e)&&(c.nextSibling||c.parentNode.nextSibling);)c=c.nextSibling||c.parentNode.nextSibling,e=0;for(;1===c.nodeType&&c.childNodes[e];){c=
c.childNodes[e];for(e=0;3===c.nodeType&&h.test(c.textContent)&&c.nextSibling;)c=c.nextSibling,e=0}b.setStart(c,e);0===g&&(new d(b.cloneRange())).setStart(c,c.length).collapsed()&&(f=c,g=c.length,b.setEnd(f,g));for(;3===f.nodeType&&(h.test(f.textContent)||0===g)&&(f.previousSibling||f.parentNode.previousSibling);)f=f.previousSibling||f.parentNode.previousSibling,g=f.childNodes&&f.childNodes.length?f.childNodes.length:f.textContent.length;for(;1===f.nodeType&&g&&(f.childNodes[g]||g&&f.childNodes.length===
g);){f=f.childNodes[g]||f.childNodes[g-1];for(g=f.childNodes&&f.childNodes.length?f.childNodes.length:f.textContent.length;3===f.nodeType&&(h.test(f.textContent)||0===g)&&(f.previousSibling||f.parentNode.previousSibling);)f=f.previousSibling||f.parentNode.previousSibling,g=f.childNodes&&f.childNodes.length?f.childNodes.length:f.textContent.length}b.setEnd(f,g);return b},_grow:function(b,c){var e=b.startContainer,f=b.startOffset,h=b.endContainer,s=b.endOffset,t=b.cloneRange(),u=b.toString().replace(g,
" "),v,w,y=u.length&&" "===u[u.length-1];for(v=u.length&&" "===u[0]?u:" "+u;e.parentNode&&e!==c;)if(t.setStartBefore(e),w=t.toString().replace(g," "),w===u)b.setStart(t.startContainer,t.startOffset),e=t.startContainer,f=t.startOffset;else if((" "===w[0]?w:" "+w)===v)e=t.startContainer,f=t.startOffset;else break;!d.isPointIdentical(b,t,"start")&&d._wsBefore(t)&&b.setStart(e,f);u=b.toString().replace(g," ");v=y?u:u+" ";for(t=b.cloneRange();h.parentNode&&h!==c;)if(t.setEndAfter(h),w=t.toString().replace(g,
" "),w===u)b.setEnd(t.endContainer,t.endOffset),h=t.endContainer,s=t.endOffset;else if((" "===w[w.length-1]?w:w+" ")===v)h=t.endContainer,s=t.endOffset;else break;!d.isPointIdentical(b,t,"end")&&d._wsAfter(t)&&b.setEnd(h,s);return b},extractContents:function(b){for(var c=b=b.extractContents(),e=b,d;c.firstChild;)c=c.firstChild;for(;!c.textContent&&c.parentNode;)d=c.parentNode,d.removeChild(c),c=d;for(;e.lastChild;)e=e.lastChild;for(;!e.textContent&&e.parentNode;)d=e.parentNode,d.removeChild(e),e=
d;return b},fromSelection:function(c){var e=b.config.doc.getSelection();if(e&&e.rangeCount){var f=e.getRangeAt(e.rangeCount-1);1<e.rangeCount&&(e.removeallRanges(),e.addRange(f));return new d(f.cloneRange(),c)}return new d(c)},toSelection:function(c){var e=b.config.doc.getSelection();e&&(e.removeAllRanges(),e.addRange(c._range||c))},_previousText:function(b,c){var e=[];b=b._node||b;for(c=c._node||c||b.parentNode;b&&b!==c;){for(;b.previousSibling;)b=b.previousSibling,(1===b.nodeType||3===b.nodeType)&&
e.push(b.textContent);b=b.parentNode}return e},_offsetToNode:function(b,c,e){b=b._node||b;if(!c){for(;b.firstChild;)b=b.firstChild;b=b.parentNode||b;return{node:b,offset:0,acc:0}}null==e&&(e=0);for(var d,f,g=0,h=b.childNodes.length;g<h;g++)if(d=b.childNodes[g],1===d.nodeType||3===d.nodeType){f=d.textContent.length;if(e<=c&&e+f>=c)return 0<d.childNodes.length?this._offsetToNode(d,c,e):{node:d,offset:c-e,acc:e};e+=f}return e===Math.floor(c)?{node:d,offset:d.childNodes.length||d.textContent.length,acc:e}:
{node:b,offset:b.childNodes.length||b.textContent.length,acc:0}},fromOffsets:function(b,c){var e=new d({root:b});e.set("offsets",c);return e}})},"1.0.0",{requires:["base","node"]});
YUI.add("squarespace-dialog-check-link-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-check-link.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='<span> - </span><a href="';(f=d.url)?f=f.call(b,{hash:{},data:c}):(f=b.url,f=typeof f===q?f.apply(b):f);return e+=r(f)+'">'+r((f=(f=b.strings,null==f||!1===f?f:f.urlLabel),typeof f===q?f.apply(b):f))+"</a>"}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p,q="function",
r=this.escapeExpression,s=this;b='\n<div class="check-element ';if((h=d["if"].call(c,c.data,{hash:{},inverse:s.noop,fn:s.program(1,function(b,c){return"active"},k),data:k}))||0===h)b+=h;b+='">\n  ';if((p=d["if"].call(c,(h=c.strings,null==h||!1===h?h:h.title),{hash:{},inverse:s.noop,fn:s.program(3,function(b,c){var e,f,h;e='\n    <div class="title">';if((h=(f=(f=b.strings,null==f||!1===f?f:f.title),typeof f===q?f.apply(b):f))||0===h)e+=h;if((h=d["if"].call(b,b.url,{hash:{},inverse:s.noop,fn:s.program(4,
l,c),data:c}))||0===h)e+=h;return e+"</div>\n  "},k),data:k}))||0===p)b+=p;b+="\n  ";if((p=d["if"].call(c,(h=c.strings,null==h||!1===h?h:h.description),{hash:{},inverse:s.noop,fn:s.program(6,function(b,c){var e,d;return e=""+('\n    <div class="description">'+r((d=(d=b.strings,null==d||!1===d?d:d.description),typeof d===q?d.apply(b):d))+"</div>\n  ")},k),data:k}))||0===p)b+=p;return b+"\n</div>\n"})})();b.Handlebars.registerPartial("dialog-check-link.html".replace("/","."),d.templates["dialog-check-link.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-backend",function(b){var d=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","currentTermsOfServiceVersion"]),c=b.Squarespace.Promises,e=b.Squarespace.Configuration=b.Base.create("configuration",b.Squarespace.Widgets.SSWidget,[b.WidgetParent],{initializer:function(){this.panels=[];this.stateParams={};this.lastSiteUrl="/";this.websiteSettings=new b.Squarespace.Models.WebsiteSettings(Static.SQUARESPACE_CONTEXT.websiteSettings);b.Squarespace.EscManager.attach();b.Squarespace.Singletons.Search.attach();
this.get("debug")&&(document.title+=" (DEBUG)")},renderUI:function(){e.superclass.renderUI.call(this);b.Cookie.set("ss_ignoretraffic","1",{path:"/",expires:new Date("January 12, 2025")});b.one("html").addClass("squarespace-cameron");b.Squarespace.Utils.storeSharedSSIdentity();(new Image).src="/universal/images-v6/error-x.png";var c=b.one(".loading-text");c&&c.remove();b.one(".page-background-column").addClass("loaded");this.get("boundingBox").addClass("main-content-wrapper");this.contentWrapperEl=
this.get("contentBox").addClass("main-content");this.configPanelWrapperEl=b.Node.create('<div class="config-panel-wrapper"></div>');b.one(document.body).append(this.configPanelWrapperEl);this._renderConfigurationMenu();this._renderAlertBanner();this._renderWelcomeExperiences();var c=this.configurationMenu.getAvailableMenuItems(),d=this.get("history").get("module");c[d]?this.activateModule(d):this.activateModule(c["default"]);Static.SQUARESPACE_CONTEXT.connectedAccounts&&this._showUnauthorizedSocialAccountAlert();
b.one("html").addClass("sqs-os-"+b.UA.os)},_renderWelcomeExperiences:function(){var e=this._shouldGetEduDiscountWelcome(),d=this._shouldBeWelcomed(),h=this._needsToS(),k=b.bind(this._showEduPopup,this),l=b.bind(this._showUpdateToS,this),p=b.bind(this._showTips,this),q=b.bind(function(){this._showWelcomeTutorial().then(p)},this),e=b.Array.reduce([{action:l,cond:h},{action:k,cond:e},{action:q,cond:d}],[],function(b,c){c.cond&&b.push(c.action);return b});c.chainFns(e)()},bindUI:function(){e.superclass.bindUI.call(this);
b.one(document.body).on("contextmenu",function(b){this.get("allowContextMenu")||b.halt()},this);b.on("history:change",this.onStateChange,this);this.configurationMenu.on({"click:module":b.bind(this.onModuleClicked,this),"click:betatag":b.bind(this.onBetaTagClicked,this)})},_showUnauthorizedSocialAccountAlert:function(){if(b.Array.some(Static.SQUARESPACE_CONTEXT.connectedAccounts,function(c){return c.accountState===b.Squarespace.AccountStates.UNAUTHORIZED}))(new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.CENTER,
"strings.confirm":"Reconnect Accounts","strings.cancel":"Dismiss","strings.title":"Connected Accounts Deactivated","strings.message":"One or more of your Connected Accounts has been deactivated. You must reconnect them for continued usage."})).on("confirm",function(){CONFIG_PANEL.getHistory().replace({module:"settings","settings-subpanelName":"social-account-settings"})})},_renderConfigurationMenu:function(){this.configurationMenu=new b.Squarespace.ConfigurationMenu({render:this.configPanelWrapperEl,
menuItems:Static.SQUARESPACE_CONTEXT.websiteSettings.configurationMenuItems,memberAccount:this.get("memberAccount")});this.panels.push(this.configurationMenu)},_renderAlertBanner:function(){var c=Static.SQUARESPACE_CONTEXT.website.siteStatus.value;if(c===b.Squarespace.StatusConstants.PASTDUE||c===b.Squarespace.StatusConstants.REMOVED){var e=c===b.Squarespace.StatusConstants.PASTDUE,c=e?'This account is <strong>past due</strong>. <a href="/config#module=settings&settings-subpanelName=billing-settings">Click here to fix this.</a>':
"This account has been removed. Contact Customer Care for more information.",e=e?"past-due":"removed";b.one(document.body).append(b.DB.DIV("sqs-alert-banner "+e,{html:c}))}},canAgreeToToS:function(){return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_ACCEPT_TOS)},hasAgreedToMostRecentToS:function(){return!b.Lang.isValue(d)||this.websiteSettings.get("lastAgreedTermsOfService")===d},_showUpdateToS:function(){return c.create(function(c){var e=new b.Squarespace.Widgets.TermsOfService({websiteSettings:this.websiteSettings,
mostRecentToSVersion:d});e.on("destroy",c,this);e.render()},this)},_needsToS:function(){var b=Static.SQUARESPACE_CONTEXT.website.siteStatus.value;return!this.hasAgreedToMostRecentToS()&&this.canAgreeToToS()&&this._accountNotRemovedOrExpired(b)},hasCompletedMemberTutorial:function(c){return b.Object.getValue(Static,["SQUARESPACE_CONTEXT","authenticatedAccount","tutorialsCompleted",c])},_shouldBeWelcomed:function(){return this._accountNotRemovedOrExpired()&&!this.hasCompletedMemberTutorial("welcome")},
_shouldGetEduDiscountWelcome:function(){return b.Lang.isString(Static.SQUARESPACE_CONTEXT.marketingRelationshipName)},_showEduPopup:function(){return b.Squarespace.Widgets.EduWelcomePopup.getConfirmation(Static.SQUARESPACE_CONTEXT.marketingRelationshipName)},_showTips:function(){1<b.Object.getValue(Static,["SQUARESPACE_CONTEXT","managedWebsites","length"])&&!this.hasCompletedMemberTutorial("account-switcher")&&(b.Data.post({url:"/api/config/MarkMemberTutorialCompleted",data:{tutorial:"account-switcher"}},
this),new b.Squarespace.Tourtip({title:"Account Switcher",body:"You can switch between your Squarespace accounts by clicking on the Squarespace symbol to the left.",icon:"open",constrain:!0,position:"fixed","align.node":"select.picker"}));b.later(200,this,function(){b.Data.post({url:"/api/config/MarkMemberTutorialCompleted",data:{tutorial:"welcome"}},this);var c=new b.Squarespace.Tourtip({title:"The Content Manager",body:"This area lets you manage the content for the pages on your website.  Add images to galleries, blog posts to blogs, etc. from here.",
position:"fixed",centered:".page-background-column"});this.once("panel-change",function(){c.hide()});c.on("hidden",function(){(new b.Squarespace.Tourtip({title:"Site Navigation",body:"The navigation area contains the pages for your website.  Click on a page to edit it, or select <strong>Add Page</strong> to add more pages.",align:{node:".inside .contents",points:[b.WidgetPositionAlign.TL,b.WidgetPositionAlign.TR],offset:[-22,0]}})).on("hidden",function(){new b.Squarespace.Tourtip({title:"View Your Website",
body:"Click here to leave the site manager and view your site as it looks on the web.  From the front of your site, you can also make stylistic changes.",position:"fixed",align:{node:".nav-icon",points:[b.WidgetPositionAlign.TL,b.WidgetPositionAlign.TR],offset:[-22,-5]}})},this)},this)})},_showWelcomeTutorial:function(){return c.create(function(c){var e=new b.Squarespace.Widgets.WelcomeVideoGallery({videos:b.Squarespace.HelpVideos,visible:!1});e.plug(b.Plugin.WidgetAnim);e.on("destroy",c,this);e.before("close",
function(c){c.preventDefault();e.hide();b.later(300,this,function(){e.destroy()})},this);e.render().show();Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted||(Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted={});Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted.welcome=!0;Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["le2-welcome"]=!0;b.Data.post({url:"/api/config/MarkWebsiteTutorialCompleted",data:{tutorial:"welcome"}},this);b.Data.post({url:"/api/config/MarkWebsiteTutorialCompleted",
data:{tutorial:"le2-welcome"}},this);if("PRODUCTION"===Static.SQUARESPACE_CONTEXT.env||"STAGING"===Static.SQUARESPACE_CONTEXT.env)c=Static.SQUARESPACE_CONTEXT.website,b.Squarespace.Marketing.trackAffiliateSignup({custid:c.id,oid:c.id,note:c.identifier})},this)},_accountNotRemovedOrExpired:function(c){return c!==b.Squarespace.StatusConstants.EXPIRED&&c!==b.Squarespace.StatusConstants.REMOVED},updateLastUrl:function(b){this.lastSiteUrl=b},showSite:function(c){c||(c={});var e="/";this.lastSiteUrl&&(e=
this.lastSiteUrl);c.targetUrl&&(e=c.targetUrl);"about:blank"===e&&(e="/");c.force&&(e=e+"?v="+Math.floor(99999999*Math.random()+1));e+=c.notifyLogout?"?logout=true":"";b.Squarespace.EscManager=null;document.location.href=e},hideSite:function(){},getHistory:function(){return this.get("history")},goToUpgrade:function(){Static.SQUARESPACE_CONTEXT.website.siteStatus.value===b.Squarespace.StatusConstants.TRIAL?window.location="/config/upgrade":CONFIG_PANEL.getHistory().replace({module:"settings","settings-subpanelName":"billing-settings"})},
updateBodyClass:function(){var c=["squarespace-config","squarespace-editable","section-"+this.configurationMenu.get("selection")];("true"===b.Cookie.get("fixedSidebar")||null===b.Cookie.get("fixedSidebar"))&&c.push("fixed-sidebar");var e=this.panelRenderer;if(e){e.currentPanel&&c.push(e.currentPanel.name);var d=e.activeCollectionManager,k=e.activeCollection;d?(k=d.getViewMode(),k===b.Squarespace.CollectionView.GRID||k===b.Squarespace.CollectionView.PRODUCT?c.push("ordering-user"):k===b.Squarespace.CollectionView.LIST&&
c.push("ordering-chronological"),c.push("collection-type-"+e.activeCollection.getTypeLabel())):k&&(d=k.getOrdering(),d===b.Squarespace.CollectionOrdering.USER||d===b.Squarespace.CollectionOrdering.PRODUCT?c.push("ordering-user"):d===b.Squarespace.CollectionOrdering.CHRONOLOGICAL&&c.push("ordering-chronological"),c.push("collection-type-"+k.getTypeLabel()));b.instanceOf(e,b.Squarespace.ContentManager.Base)&&c.push("sqs-content-manager-active")}b.one(document.body).hasClass("fullscreenEditor")&&c.push("fullscreenEditor");
c.push("native-currency-code-"+b.Squarespace.Commerce.currencyCode().toLowerCase());b.one(document.body).set("className",c.join(" "))},showPanel:function(c){var e=b.Node.create('<div class="config-panel '+c.style+" "+c.className+" depth-"+this.panels.length+'"></div>'),d=b.Node.create('<div class="inner '+(c.className?c.className:"")+'"></div>');d.append(b.Node.create('<div class="nav-content"></div>'));e.append(d);e.plug(b.Squarespace.ScrollLock);c.events=[];c.el=e;c.el.appendTo(this.configPanelWrapperEl);
this.panels.push(c);c.getContentEl=function(){return this.el.one(".nav-content")};this.fire("panel-change",c);return c},popPanel:function(){var b=this.panels.pop();b.el.remove();for(var c=0;c<b.events.length;++c)b.events[c].detach()},resize:function(){},getContentWrapperEl:function(){return this.contentWrapperEl},onStateChange:function(b){b.changed.module&&this.panels[0]&&this.activateModule(b.changed.module.newVal);this.fire("state-changed")},refreshModule:function(){this.panelRenderer&&this.panelRenderer.destroy();
var c=this.configurationMenu.getSelectionData();this.panelRenderer=new b.Squarespace.ConfigurationPanelRenderers[c.name]({renderEl:this.get("contentBox"),configurationManager:this});this.get("contentBox").addClass("transitioning");this.panelRenderer.configurationManager=this;this.panelRenderer.render();this.panelRendererReady=!0;this.updateBodyClass()},activateModule:function(c){if(c!==this.configurationMenu.get("selection")){this.configurationMenu.set("selection",c);var e=this.configurationMenu.getSelectionData();
this.panelRenderer&&this.panelRenderer.destroy();b.Global.fire("manager:change-mode",c);e.requiredPermission&&!b.Squarespace.Utils.userHasAccessPermission(e.requiredPermission)?this.panelRenderer=new b.Squarespace.ConfigurationPanelRenderers.accessDenied({renderEl:this.get("contentBox"),configurationManager:this}):this.panelRenderer=new b.Squarespace.ConfigurationPanelRenderers[e.name]({renderEl:this.get("contentBox"),configurationManager:this,render:this.get("contentBox"),rootBar:this});this.panelRenderer?
(this.get("contentBox").addClass("transitioning"),this.panelRenderer.configurationManager=this,this.panelRenderer.render(),this.panelRendererReady=!0):(this.get("contentBox").set("className","main-content"),this.get("contentBox").set("innerHTML",e.name+" (Undefined)"));this.updateBodyClass()}},_checkUnsavedChanges:function(c){b.Lang.isFunction(this.panelRenderer.hasUnsavedChanges)&&this.panelRenderer.hasUnsavedChanges()?this.panelRenderer.ensureSavedChanges().then(c):c()},onModuleClicked:function(c){this._checkUnsavedChanges(b.bind(function(){"home"===
c.module?this.showSite():"help"===c.module?b.Squarespace.Analytics.trackInternal("help_site_link_click",{position:"questionmark"}):"notifications"!==c.module&&this.get("history").replace({module:c.module})},this))},onBetaTagClicked:function(){this._checkUnsavedChanges(b.bind(function(){this.get("history").replace({module:"settings","settings-subpanelName":"billing-settings"})},this))}},{CSS_PREFIX:"sqs-configuration",ATTRS:{createdOn:{value:Static.SQUARESPACE_CONTEXT.website.createdOn,readOnly:!0},
allowContextMenu:{value:!1},debug:{value:b.Cookie.get("SQUARESPACE_DEBUG"),writeOnce:"initOnly"},history:{value:new b.HistoryHash,readOnly:!0},memberAccount:{valueFn:function(){return b.Squarespace.Singletons.AuthenticatedMemberAccount}},siteContext:{value:{}},strings:{value:{accountPastDue:'This account is <strong>past due</strong>. <a href="/config#module=settings&settings-subpanelName=billing-settings">Click here to fix this.</a>',accountRemoved:"This account has been removed. Contact Customer Care for more information."}}}});
b.namespace("Squarespace.ConfigurationPanelRenderers");b.Squarespace.ConfigurationPanelRenderers.accessDenied=Class.extend(b.Squarespace.Gizmo,{render:function(){this.configurationManager.hideSite();this.configurationManager.getContentEl().set("innerHTML","access denied")}});b.Squarespace.ConfigurationPanelRenderers.home=Class.extend(b.Squarespace.Gizmo,{render:function(){this.configurationManager.getHistory().replace({module:"content"})}})},"1.0",{requires:"node history anim intl datatype-date-format dd attribute slider json base-build widget widget-position squarespace-tab-view squarespace-common squarespace-jobui squarespace-imageloader squarespace-dombuilder squarespace-dashboard-manager squarespace-settings-commerce-manager squarespace-settings-site-manager squarespace-newsletters-manager squarespace-gizmo squarespace-drag-selection squarespace-audio-player squarespace-calendar-block-renderer squarespace-search-fullscreen squarespace-tourtip squarespace-ui-base squarespace-commerce-utils squarespace-configuration-menu squarespace-help-videos squarespace-welcome-video-gallery squarespace-terms-of-service-overlay squarespace-content-manager squarespace-models-connected-accounts squarespace-models-member-account squarespace-widgets-confirmation squarespace-widgets-edu-welcome-popup".split(" ")});
YUI.add("squarespace-dialog-wysiwyg",function(b){var d=b.namespace("Squarespace.DialogFields").Wysiwyg=b.Base.create("wysiwyg",b.Squarespace.DialogField2,[],{initializer:function(c){this.get("boundingBox").addClass("field-wrapper wysiwyg-field-wrapper clear ckenabled");b.Lang.isValue(this.get("classNames"))&&this.get("boundingBox").addClass(this.get("classNames"));this.get("contentBox").addClass("")},renderUI:function(){d.superclass.renderUI.apply(this,arguments);b.Lang.isValue(this.get("title"))&&
this.get("contentBox").one(".title").setHTML(this.get("title"));b.Lang.isValue(this.get("description"))&&this.get("contentBox").one(".description").setHTML(this.get("description"));this.get("contentBox").one(".field-wysiwyg").setStyle("height",this.get("editorHeight")+"px");this._instantiateEditor()},_instantiateEditor:function(){var c=this.get("contentBox").one("textarea");this.visualEditor=new b.Squarespace.Wysiwyg.Editor({node:c,editorType:b.Squarespace.Wysiwyg.EditorTypes.IFRAME,toolbarType:this.get("toolbarType"),
height:this.get("editorHeight"),isSingleLine:this.get("isEditorSingleLine")});this.visualEditor.setEditorData(this.get("data.html"))},_syncEditorData:function(){var c=this.visualEditor.getEditorData();this.set("data",b.merge(this.get("data"),{source:c,html:c}))},bindUI:function(){this.visualEditor.on("change",b.Squarespace.debounce(this._syncEditorData,200,!0,!0),this);this.on("dataChange",function(c){b.Lang.isValue(c.newVal)||c.preventDefault()},this);var c=this.get("data");(!b.Lang.isValue(c)||
!b.Lang.isValue(c.html))&&this._syncEditorData()},didDataChange:function(){return this.visualEditor.didDataChange()},setValue:function(){d.superclass.setValue.apply(this,arguments);this.visualEditor.setEditorData(this.get("data.html"))},_renderTitle:function(){return this.config.title&&"top"==this.config.titleStyle?b.DB.DIV("field-lhs",{html:this.config.title}):null}},{CSS_PREFIX:"sqs-dialog-wysiwyg",TEMPLATE:'<div class="title field-lhs"></div><div class="field-rhs"><div class="field-wysiwyg"><textarea class="sqs-visual-edit""></textarea></div><div class="field-description-wrapper"><div class="description field-description"></div></div></div>',
ATTRS:{toolbarType:{},editorHeight:{validator:b.Squarespace.AttrValidators.isNumber,getter:function(b){this.get("isEditorSingleLine")&&(b=this.get("singleLineEditorHeight"));return b}},singleLineEditorHeight:{value:115},isEditorSingleLine:{value:!1},classNames:{validator:b.Squarespace.AttrValidators.isString},title:{validator:b.Squarespace.AttrValidators.isString},description:{validator:b.Squarespace.AttrValidators.isString}}})},"1.0",{requires:["squarespace-wysiwyg-editor"]});
YUI.add("squarespace-dialog-post-by-email",function(b){var d=b.namespace("Squarespace.DialogFields"),c=d.PostByEmailAddress=b.Base.create("PostByEmailAddress",d.Text,[],{allowedToChangePostByEmail:function(){return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions.CONFIG_CHANGE_STRUCTURE)},renderUI:function(){c.superclass.renderUI.call(this);this.allowedToChangePostByEmail()&&(this._refreshButtonNode=this.get("contentBox").appendChild('<div class="refresh-post-by-email"></div>'),
this._clearButtonNode=this.get("contentBox").appendChild('<div class="clear-post-by-email"></div>'))},bindUI:function(){c.superclass.bindUI.call(this);this.allowedToChangePostByEmail()&&(this._refreshButtonNode.on("click",function(b){b.halt();this._refreshEmail()},this),this._clearButtonNode.on("click",function(b){b.halt();this._clearEmail()},this));var b=this.get("contentBox");b.on("click",function(){b.one("input").focus()});this._registerEvent(this.get("collection").after("postByEmailAddressChange",
function(b){this.set("data",b.newVal)},this))},_refreshEmail:function(){var c=this.get("collection");b.Data.post({url:"/api/commondata/GenerateCollectionPostByEmailAddress",data:{collectionId:c.get("id")},success:function(b){c.set("postByEmailAddress",b.postByEmailAddress)}},this)},_clearEmail:function(){var c=this.get("collection");b.Data.post({url:"/api/commondata/ClearCollectionPostByEmailAddress",data:{collectionId:c.get("id")},success:function(){c.set("postByEmailAddress","")}},this)}},{CSS_PREFIX:"sqs-dialog-field-post-by-email",
ATTRS:{collection:{},className:{value:"thin"},"strings.placeholder":{value:"None"}}})},"1.0",{requires:["squarespace-dialog-text"]});
YUI.add("squarespace-content-item-types-product-variants",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.ProductVariants=b.Base.create("ProductVariantsContentItemEditor",b.Squarespace.ContentItemEditor.Product,[],{initializer:function(){var b=this.get("dialog");b.on("button-duplicate",this._duplicate,this);b.on("ready",function(){var e=b.getField("variants"),d=b.getField("pricingPlaceholder");e.after("dataChange",function(b){d.set("data.variants",b.newVal.variants)},
this);e.on("errors",function(){d.pulseWarn()},this)},this)},getDialogData:function(){var b=d.superclass.getDialogData.call(this),e=b.structuredContent;b.variants={variants:e.variants,variantOptionOrdering:e.variantOptionOrdering};return b},sanitizeDialogData:function(c){c=d.superclass.sanitizeDialogData.call(this,c);var e=c.variants;c.structuredContent=b.merge(c.structuredContent,{variants:e.variants,variantOptionOrdering:e.variantOptionOrdering});delete c.variants;return c},_duplicate:function(){var c=
this.get("dialog");(new b.Promise(function(c){b.Data.get({url:"/api/commerce/inventory/violation",success:c})})).then(b.bind(function(e){if(e.isAtOrOverProductLimit)if(e.blockUserAction)(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Product Limit Reached","strings.message":e.message})).on("confirm",function(){c.cancel();CONFIG_PANEL.goToUpgrade()});else(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Continue",
"strings.title":"Warning: Product Limit","strings.message":e.message})).on("confirm",this._closeAndShowDuplicateProductEditor,this);else this._closeAndShowDuplicateProductEditor()},this))},_closeAndShowDuplicateProductEditor:function(){var c=this.get("dialog"),e=this.get("model");c.on("canceled",function(){var c=b.clone(e.toJSON()),d=c.structuredContent;b.Array.each(d.variants,function(c){c.sku=b.Squarespace.Commerce.generateSKU()});var h=new b.Squarespace.Models.ContentItem({title:"Copy of "+c.title,
recordType:c.recordType,collectionId:c.collectionId,categories:c.categories,excerpt:c.excerpt,structuredContent:{variants:d.variants,variantOptionOrdering:d.variantOptionOrdering,productType:d.productType,additionalFieldsFormId:d.additionalFieldsFormId}}),c=this.get("model").get("collectionId");b.Squarespace.ContentCollectionCache.getCollectionById(c,function(c){var e=new (b.Squarespace.ContentItemEditorFactory.getEditor(h))({model:h});h.once("save",function(){c.items.add(h)});setTimeout(function(){e.show()},
50)})},this);c.cancel()}})},"1.0",{requires:"base json squarespace-content-item-types-product squarespace-commerce-utils squarespace-models-content-item squarespace-models-content-collection squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-widgets-order-list",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.OrderList=b.Base.create("OrderList",b.Squarespace.Widgets.ModelList,[b.Squarespace.Mixins.SelectedActionTray],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-content")},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("models");this.after("*:orderStateChange",function(){1===b.size()&&b.get("hasPreviousPage")?b.previousPage():b.currentPage()},this)},
printSelected:function(){this.get("selectedModels").print()},markSelectedAsCompleted:function(){var c=new b.Squarespace.OptionConfirmationDialog({width:250,optionConfig:{title:"Send Shipping Notification",description:"Send an email to the customer.",padding:["15px","0px"]}}),e=this.get("selectedModels"),d=e.size(),d=b.Lang.sub('This will move {numOrders} {orderString} to the "Completed" tab for your records.',{numOrders:d,orderString:"order"+(1===d?"":"s")});c.show("Mark as Completed",d,function(){var d=
b.bind(this._orderStateChangeCallback,this);e.markShipped(c.getValue(),d)},this)},markSelectedAsPending:function(){var c=this.get("selectedModels"),e=c.size(),e=b.Lang.sub('This will move {numOrders} {orderString} to the "Pending" tab for your records',{numOrders:e,orderString:"order"+(1===e?"":"s")});(new b.Squarespace.Widgets.Confirmation({"strings.title":"Mark as Pending","strings.message":e})).on("confirm",function(){var e=b.bind(this._orderStateChangeCallback,this);c.markPending(e)},this)},_orderStateChangeCallback:function(){var b=
this.get("models");this.get("selectedModels").size()===b.size()&&b.get("hasPreviousPage")?b.previousPage():b.currentPage()}},{CSS_PREFIX:"sqs-order-list",ATTRS:{defaultChildType:{value:b.Squarespace.Widgets.Order},strings:{value:{modelName:"order"}},emptyStateIconSrc:{value:"/universal/images-v6/configuration/no-orders.png"}}})},"1.0",{requires:["base","squarespace-mixins-selected-action-tray","squarespace-widgets-order","squarespace-widgets-model-list","squarespace-widgets-confirmation"]});
YUI.add("squarespace-stats-timeframes",function(b){b.namespace("Squarespace");b.Squarespace.StatsTimeFrames={LAST_24_HOURS:1,TODAY:2,LAST_7_DAYS:3,THIS_WEEK:4,LAST_30_DAYS:5,THIS_MONTH:6,LAST_365_DAYS:7,THIS_YEAR:8};b.Squarespace.StatsTimeFrameLabels={LAST_24_HOURS:"Last Day",TODAY:"Today",LAST_7_DAYS:"Last 7 Days",THIS_WEEK:"This Week",LAST_30_DAYS:"Last 30 Days",THIS_MONTH:"This Month",LAST_365_DAYS:"Last Year",THIS_YEAR:"This Year",ALL:"All"};b.Squarespace.StatsTimeFrameFns={LAST_24_HOURS:function(){var b=
(new Date).getTime()-864E5;return{start:new Date(b),end:new Date}},TODAY:function(){var b=new Date;b.setHours(0);b.setMinutes(0);b.setSeconds(0);b.setMilliseconds(0);return{start:b,end:new Date}},LAST_7_DAYS:function(){var b=new Date,c=new Date(b.getTime()-6048E5);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);return{start:c,end:new Date(b.setDate(b.getDate()+1))}},THIS_WEEK:function(){var b=new Date,c=new Date,c=new Date(c.getTime()-864E5*c.getDay());c.setHours(0);c.setMinutes(0);
c.setSeconds(0);c.setMilliseconds(0);return{start:c,end:new Date(b.setDate(b.getDate()+1))}},LAST_30_DAYS:function(){var b=new Date,c=new Date,c=new Date(c.getTime()-2592E6);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);return{start:c,end:new Date(b.setDate(b.getDate()+1))}},THIS_MONTH:function(){var b=new Date,c=new Date;return{start:new Date(c.getFullYear(),c.getMonth(),0),end:new Date(b.setDate(b.getDate()+1))}},LAST_365_DAYS:function(){var b=new Date,c=new Date,c=new Date(c.getTime()-
315576E5);c.setHours(0);c.setMinutes(0);c.setSeconds(0);c.setMilliseconds(0);return{start:c,end:new Date(b.setDate(b.getDate()+1))}},THIS_YEAR:function(){var b=new Date;return{start:new Date((new Date).getFullYear(),0,0),end:new Date(b.setDate(b.getDate()+1))}},ALL:function(){var b=new Date;return{start:new Date("1/1/2010"),end:new Date(b.setDate(b.getDate()+1))}}};b.Squarespace.StatsTimeFrameUtils={incrementHour:function(d,c){c=b.Lang.isNumber(c)?c:1;return new Date(d+36E5*c)},incrementDay:function(d,
c){c=b.Lang.isNumber(c)?c:1;var e=new Date(d);e.setDate(e.getDate()+c);return e},incrementWeek:function(d,c){c=b.Lang.isNumber(c)?c:1;return this.incrementDay(d,7*c)},incrementMonth:function(d,c){c=b.Lang.isNumber(c)?c:1;var e=new Date(d);e.setMonth(e.getMonth()+c);return e},getLabel:function(d){var c=b.Squarespace.Utils.reverseMap(b.Squarespace.StatsTimeFrames);return b.Squarespace.StatsTimeFrameLabels[c[d]]},getDateRange:function(d){d=b.Squarespace.Utils.reverseMap(b.Squarespace.StatsTimeFrames)[d];
return b.Squarespace.StatsTimeFrameFns[d]()}}},"1.0",{requires:["squarespace-util"]});
YUI.add("squarespace-settings-sessions-list-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-sessions-list.html"]=b(function(b,c,d,h,k){function l(b,c){return'\n\t\t\t\t\t<span class="current">Current Session</span>\n\t\t\t\t\t'}function p(b,c){return'\n\t\t\t\t\t<span class="delete">Delete</span>\n\t\t\t\t\t'}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var q=this.escapeExpression,r=this,s=d.helperMissing;b='<div class="sessions session-list">\n\t';
if((c=d.each.call(c,c.sessions,{hash:{},inverse:r.noop,fn:r.program(1,function(b,c){var e,f,h;e='\n\t\t<div class="session-item" id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f="function"===typeof f?f.apply(b):f);e+=q(f)+'">\n\t\t\t<div class="right">\n\t\t\t\t<div class="tag">\n\t\t\t\t\t';if((f=d["if"].call(b,b.currentSession,{hash:{},inverse:r.program(4,p,c),fn:r.program(2,l,c),data:c}))||0===f)e+=f;e+='\n\t\t\t\t</div>\n\t\t\t\t<div class="top">\n\t\t\t\t\t<span class="session-browser field">\n\t\t\t\t\t\t<span class="bold">Browser: </span>\n\t\t\t\t\t\t<span>';
(f=d.browserDisplayName)?f=f.call(b,{hash:{},data:c}):(f=b.browserDisplayName,f="function"===typeof f?f.apply(b):f);e+=q(f)+'</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="session-os field">\n\t\t\t\t\t\t<span class="bold">OS: </span>\n\t\t\t\t\t\t<span>';(f=d.osDisplayName)?f=f.call(b,{hash:{},data:c}):(f=b.osDisplayName,f="function"===typeof f?f.apply(b):f);e+=q(f)+'</span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div class="bottom">\n\t\t\t\t\t<span class="session-created field">\n\t\t\t\t\t\t<span class="bold">Created: </span>\n\t\t\t\t\t\t<span>';
h={hash:{},data:c};e+=q((f=d["humanizedate-format"]||b["humanizedate-format"],f?f.call(b,b.createdOn,h):s.call(b,"humanizedate-format",b.createdOn,h)))+'</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="session-ip field">\n\t\t\t\t\t\t<span class="bold">IP: </span>\n\t\t\t\t\t\t<span>';(f=d.remoteIP)?f=f.call(b,{hash:{},data:c}):(f=b.remoteIP,f="function"===typeof f?f.apply(b):f);return e+=q(f)+"</span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t"},k),data:k}))||0===c)b+=c;return b+
"\n</div>"})})();b.Handlebars.registerPartial("settings-sessions-list.html".replace("/","."),d.templates["settings-sessions-list.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-file-manager-tab",function(b){var d=b.namespace("Squarespace.Views").FileManagerTab=b.Base.create("FileManagerTab",b.Squarespace.View,[],{template:"file-manager-tab.html",initializer:function(c){d.superclass.initializer.apply(this,arguments);this._options=new b.Squarespace.DialogFields.MultiOption({data:this.get("selectedFile")?"existing":"new",options:[{value:"new",title:"New File",icon:"new"},{value:"existing",title:"Existing File",icon:"existing"}]});this._frames=new b.Squarespace.DialogFields.MultiFrame({data:this.get("selectedFile")?
"existing":"new",frames:[{name:"new",fields:[]},{name:"existing",fields:[{ctor:b.Squarespace.DialogFields.FileManager,config:{name:"selectFile",data:this.get("selectedFile")}}]}]});this._options.on("dataChange",function(b){this._frames.switchFrames(b.newVal)},this);this._uploader=new b.Squarespace.Uploader({process:!1,autoUpload:!0});this._spinnerEl=b.Node.create('<div class="spinner"></div>');this.get("disableNewWindow")||(this._newWindowField=new b.Squarespace.DialogFields.Check({name:"newWindow",
"strings.title":"Open in new window",data:this.get("newWindow")}))},render:function(){d.superclass.render.apply(this,arguments);var b=this.get("container");this._options.render(b.one(".options"));this._frames.render(b.one(".frames"));this._frames.get("contentBox").all(".frame").each(function(b){"new"==b.getAttribute("data-name")&&(this._uploader.set("dragAndDropArea",b),this._uploader.render(b),b=this._uploader.get("contentBox"),this._uploaderIcon=b.one(".icon"),this._uploaderText=b.one(".text"),
this._spinnerEl.hide(),this._uploaderIcon.append(this._spinnerEl))},this);this.get("disableNewWindow")||this._newWindowField.render(b.one(".file-manager-tab"));this.bindUI()},bindUI:function(){this._frames.getField("selectFile").on("dataChange",function(b){this.set("selectedFile",b.newVal);this._dataChanged()},this);this._frames.on("animated",function(b){"existing"==b.name&&this._frames.get("contentBox").one(".search input").focus()},this);this._uploader.set("processFile",b.bind(function(c){c.invalid?
(c=c.invalid[0],new b.Squarespace.Widgets.Alert({"strings.title":c.title,"strings.message":c.message})):(this._uploaderIcon.addClass("loading"),this._uploaderText.setContent("Uploading file..."),this._spinner=new b.Squarespace.Spinner({color:"dark",size:"large",render:this._spinnerEl}),this._spinnerEl.show(),c.postData={contentType:"binary",recordType:b.Squarespace.RecordType.ATTACHMENT,useFilenameAsUrlId:"true"})},this));this._uploader.set("fileComplete",b.bind(function(c,e){var d=e.media[0];this.set("selectedFile",
d.urlId);this._spinnerEl.anim({opacity:0},{duration:1.25,start:function(){this._uploaderText.setContent("Uploaded "+e.media[0].filename)},end:function(){this._spinnerEl.hide();this._dataChanged();new b.Squarespace.Widgets.Information({"strings.title":"File Uploaded","strings.message":"Your file has been successfully uploaded."});b.later(1E3,this,function(){this._uploaderIcon.removeClass("loading");this._uploaderText.setContent("Click here or drag and drop to add a file");var b=this._frames.getField("selectFile");
b.set("data",d.urlId,{silent:!0});b.updateFullList();this._options.selectOption("existing")})},context:this}).run()},this));this.get("disableNewWindow")||this._newWindowField.after("dataChange",function(b){this.set("newWindow",b.newVal);this._dataChanged()},this)},reset:function(){this.set("selectedFile",null);this._options.selectOption("new");this._frames.set("data",null);this.set("newWindow",!1);this._frames.get("contentBox").all(".attachment").removeClass("selected")},_dataChanged:function(){var c=
this.get("onDataChange");if(b.Lang.isFunction(c)){var e=this.get("selectedFile"),d=this.get("newWindow");c(e,d)}}},{ATTRS:{selectedFile:{value:null},onDataChange:{value:null},disableNewWindow:{value:!1},newWindow:{value:!1}}})},"1.0",{requires:"base squarespace-dialog-check squarespace-dialog-file-manager squarespace-dialog-html squarespace-dialog-multi-frame squarespace-dialog-multi-option squarespace-dialog-text squarespace-file-manager-tab-template squarespace-ui-base squarespace-view squarespace-widgets-alert squarespace-widgets-information".split(" ")});
YUI.add("squarespace-dialog-smugmug-sync",function(b){b.namespace("Squarespace.DialogFields").SmugmugSync=b.Base.create("smugmugSync",b.Squarespace.DialogField2,[],{initializer:function(b){this._getGalleriesForAccount(b.account);smugmug_field=this},bindUI:function(){b.Squarespace.DialogFields.SmugmugSync.superclass.bindUI.call(this);this.after("errorChange",function(){this.get("boundingBox").setHTML(this.renderTemplate())},this)},_getGalleriesForAccount:function(d){this.set("dataState",this.getProperty("DATA_STATES").LOADING);
b.Data.get({url:"/api/smugmug/GetSmugmugAlbums",data:{accountId:d.get("id")},success:function(c){this.get("destroyed")||(c.smugmugError?(this.set("dataState",this.getProperty("DATA_STATES").LOAD_FAILED),this.set("error",this._errorMessage(c.code))):(this.set("dataState",this.getProperty("DATA_STATES").LOADED),this._initialGalleryCount=c.galleryCount,c=c.albums,this._albumMap=b.Array.reduce(c,{},function(b,c){b[c.albumID]=c;return b}),this.set("data",c),c=this.get("contentBox"),c.setHTML(this.renderTemplate()),
c.delegate("click",function(b){b=b.target.ancestor(".album",!0).getAttribute("data-albumID");this._startImagePickerWorkflow(b,d)},".picker-btn",this)))},failure:function(){this.set("dataState",this.getProperty("DATA_STATES").LOAD_FAILED);this.set("error",this._errorMessage())}},this)},_startImagePickerWorkflow:function(d,c){var e=new b.Squarespace.Widgets.SmugMugImagePicker({albumId:d,connectedAccountId:c.get("id")});e.on(this.get("id")+"|images-selected",function(b){b.ids.length&&this._importGallery(d,
c.get("id"),b.ids)},this);e.render()},_importGallery:function(d,c,e){var f=this.get("dialog");f&&f.showSaveOverlay();b.Data.post({url:"/api/smugmug/SyncSmugMugAlbum",data:{albumID:d,connectedAccountId:c,galleryIds:e},success:function(c){f&&f.hideSaveOverlay();var e=b.Array.find(this.get("data"),function(b){return b.albumID===d}).title;new b.Squarespace.Widgets.Information({"strings.title":"Album Importing","strings.message":'Importing album "'+e+'."'});b.Squarespace.ContentCollectionCache.getCollectionById(c.collection.id,
function(e){Static.JOB_MANAGER.addJob(new b.Squarespace.SmugMugSyncJob(c.job));b.Squarespace.Singletons.Template.get("navigations").getHiddenNavigation().get("itemList").create({collectionId:e.get("id"),enabled:!0,title:e.get("navigationTitle"),typeName:e.get("typeName"),urlId:e.get("urlId")});CONFIG_PANEL.getHistory().replace({module:"content",collectionId:c.collection.id});this.fire("gallery-imported")},this)},failure:function(){new b.Squarespace.Widgets.Alert({"strings.title":"Error Importing Album",
"strings.message":"Please try again."})}},this)},_errorMessage:function(d){return!d?"Error getting Smugmug galleries. Please try again or contact Customer Support.":d===b.Squarespace.SmugMugError.EXPIRED_TOKEN?"Expired or invalid OAuth credentials. Please ensure you have not revoked Squarespace's access to your SmugMug account.":"Error getting Smugmug galleries. Please try again or contact Customer Support."},_getHBTemplateContext:function(){var d=b.Object.values(this.getProperty("DATA_STATES")),
c=this.get("dataState"),d=b.Array.reduce(d,{},function(b,d){b[d]=d===c;return b},this);return b.merge(this.getAttrs(),{state:d})}},{ATTRS:{error:{},readOnly:{value:!0}},HANDLEBARS_TEMPLATE:"dialog-smugmug-sync.html",ASYNC_DATA:!0,CSS_PREFIX:"sqs-dialog-smugmug-sync"})},"1.0",{requires:"base-build handlebars squarespace-dialog-field-2 squarespace-dialog-smugmug-sync-template squarespace-smugmug-image-picker squarespace-widgets-alert squarespace-widgets-information".split(" ")});
YUI.add("squarespace-widgets-blog-list-manager",function(b){b.namespace("Squarespace.Widgets.Blog");var d=b.Squarespace.Widgets.Blog.ListManager=b.Base.create("ListManager",b.Squarespace.Widgets.SSWidget,[b.WidgetParent,b.Squarespace.Mixins.ContentCollectionBulkActionable],{initializer:function(b){this.set("model",this.get("collection"));this._initChildren()},_initChildren:function(){var c=b.Object.keys(b.Squarespace.WorkflowStates).reverse();b.Array.each(c,function(c,d){var g=b.Squarespace.WorkflowStates[c],
h=this._getOptions(g),k=new b.Squarespace.Models.ContentItemList({parent:this.get("collection")}),h=this.add({collection:this.get("collection"),items:this.get("collection").items,loadOnInit:!1,contentItemList:k,options:h,"strings.title":c.toLowerCase().replace("_"," ").capitalize()}).item(0);g===b.Squarespace.WorkflowStates.PUBLISHED?h._loadPage({limit:1},b.bind(this._cascadingLoad,this,40)):h._loadPage({limit:1})},this)},bindUI:function(){d.superclass.bindUI.call(this);this.after("*:contentLoaded",
this.refreshPages,this);this.after("*:selectionChange",this.updateActionTray,this)},_cascadingLoad:function(c){c=parseInt(c,10);if(1>c||isNaN(c))return!1;this.some(function(e){var d=e.hasMorePages();d&&e.loadNextPage(b.bind(function(){this._cascadingLoad(c-e.size())},this));return d},this)},setSelected:function(b){this.each(function(e){e.setSelected(b)},this);this.updateActionTray()},updateActionTray:function(){b.soon(b.bind(function(){var b=0;this.each(function(e){e=e.get("selection")?e.get("selection").size():
0;b+=e},this);this._actionTray.set("count",b,this)},this))},getWidgetForItem:function(c){var e=null;this.some(function(d){d=d.getWidgetForItem(c);return b.Lang.isValue(d)?(e=d,!0):!1},this);return e},syncUI:function(){d.superclass.syncUI.call(this);this.each(function(b){b.syncUI()},this)},routeItem:function(b){this.each(function(e){e.get("options.workflowState")===b.get("workflowState")&&e.get("contentItemList").add(b,{index:0,isSelected:!0});e.syncUI()},this)},filterChildWidgets:function(b){this.each(function(e){e.each(function(e){e.set("visible",
b(e.get("item")))},this);e._syncHeight()},this)},getSelectedWidget:function(){var c=null;this.some(function(e){c=e.getSelectedWidget();return b.Lang.isValue(c)},this);return c},refreshPages:function(){this.syncUI()},tryToLoadMore:function(){this._cascadingLoad(this.get("limit"))},countVisible:function(){return this.get("contentBox").all(".sqs-blog-item:not(.sqs-blog-item-hidden)").size()},hasMorePages:function(){var b=!1;this.some(function(e){return b=b||e.hasMorePages()},this);return b},tryToLoadAll:function(){if(!0!==
this.get("rendered"))this.on("renderedChange",this.tryToLoadAll,this);var c=new b.Parallel;this.each(function(b,d){b.hasMorePages()&&b.loadNextPage(c.add(function(){}))},this);c.done(b.bind(function(){this.hasMorePages()&&this.tryToLoadAll()},this))},_getOptions:function(c){var e={limit:this.get("limit")};b.Lang.isValue(c)&&(e.workflowState=c);return e}},{CSS_PREFIX:"sqs-blog-list-manager",ATTRS:{actionTrayRelativePositionFixedNode:{},collection:{value:null},defaultChildType:{value:b.Squarespace.Widgets.Blog.List},
limit:{value:20},model:{},moveable:{value:!0},selection:{getter:function(){var c=[];this.each(function(b){c=c.concat(b.get("selection")?b.get("selection").toJSON():[])},this);return new b.ArrayList(c)}},teaserLimit:{value:5},root:{}}})},"1.0",{requires:"base squarespace-content-manager-plugin-sticky-header squarespace-content-manager-widgets-blog-item squarespace-models-content-item-list squarespace-ss-widget squarespace-widgets-blog-list widget-child widget-parent".split(" ")});
YUI.add("squarespace-hb-pluralize",function(b){b.Handlebars.registerHelper("pluralize",function(b,c){return 1!==c?b+"s":b})},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-store-settings-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["store-settings.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n  <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p="function",q=this;if((h=d["with"].call(c,c.strings,
{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e="\n  ";if((f=d["if"].call(b,b.description,{hash:{},inverse:q.noop,fn:q.program(2,l,c),data:c}))||0===f)e+=f;e+='\n  <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n"},k),data:k}))||0===h)b+=h;b+='\n\n<div class="settings-panel-fields">\n\n  <div data-field-name="storeState"></div>\n\n  <div class="stripe-connection-wrapper">\n    <div class="message">\n      <div data-field-name="paymentsTitle"></div>\n      <div data-field-name="lastCharge"></div>\n      <div data-field-name="toggleStripe"></div>\n    </div>\n\n    ';
if((h=d["if"].call(c,c.connectedWithStripe,{hash:{},inverse:q.noop,fn:q.program(4,function(b,c){return'\n      <div class="store-live-control">\n        <div data-field-name="testModeTitle"></div>\n        <div data-field-name="isLive"></div>\n      </div>\n    '},k),data:k}))||0===h)b+=h;return b+'\n  </div>\n\n  <div class="store-fields-wrapper">\n    <div data-field-name="storeCurrencyDescription"></div>\n    <div data-field-name="selectedCurrency"></div>\n    <div data-field-name="measurementStandardDescription"></div>\n    <div data-field-name="measurementStandard"></div>\n    <div data-field-name="nextOrderNumberDescription"></div>\n    <div data-field-name="nextOrderId"></div>\n    <div data-field-name="checkoutStyleDescription"></div>\n    <div class="edit-checkout-style-btn" data-field-name="editCheckoutStyle"></div>\n    <div data-field-name="expressCheckoutDescription"></div>\n    <div data-field-name="expressCheckout"></div>\n    <div data-field-name="shoppingCartStyleDescription"></div>\n    <div data-field-name="useLightCart"></div>\n    <div data-field-name="storeMailingListDescription"></div>\n    <div data-field-name="storeMailingList"></div>\n    <div data-field-name="showCustomFormFieldDescription"></div>\n    <div data-field-name="showCustomCheckoutForm"></div>\n    <div data-field-name="editCheckoutPageFormButton"></div>\n    <div data-field-name="storePoliciesDescription"></div>\n    <div data-field-name="returnPolicyDescription"></div>\n    <div data-field-name="returnPolicy"></div>\n    <div data-field-name="termsOfServiceDescription"></div>\n    <div data-field-name="termsOfService"></div>\n    <div data-field-name="privacyPolicyDescription"></div>\n    <div data-field-name="privacyPolicy"></div>\n  </div>\n\n</div>'})})();
b.Handlebars.registerPartial("store-settings.html".replace("/","."),d.templates["store-settings.html"])},"1.0",{requires:["handlebars-base"]});YUI.add("squarespace-models-billing-subscription-list",function(b){b.namespace("Squarespace.Models.Billing");b.Squarespace.Models.Billing.SubscriptionList=b.Base.create("billingSubscriptionList",b.ModelList,[],{model:b.Squarespace.Models.Billing.Subscription})},"1.0",{requires:["base","model-list","squarespace-models-billing-subscription"]});
YUI.add("squarespace-widgets-edu-welcome-popup-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["widgets-edu-welcome-popup.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<header class="offer-name">Squarespace x ';(h=d.schoolName)?h=h.call(c,{hash:{},data:k}):(h=c.schoolName,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</header>\n<section class="offer-desc">\n  <strong>';
(h=d.schoolName)?h=h.call(c,{hash:{},data:k}):(h=c.schoolName,h="function"===typeof h?h.apply(c):h);return b+=l(h)+'</strong> is part of Squarespace\'s education program. Students like you are eligible for a 50% discount off your\n  first year. Look out for an email to verify your school email address and we\'ll automatically apply your discount\n  at checkout.\n</section>\n<footer class="controls">\n  <div class="get-started">Got it, ready to get started</div>\n  <a class="learn-more" target="_blank" href="http://www.squarespace.com/students">Learn more</a>\n</footer>\n'})})();
b.Handlebars.registerPartial("widgets-edu-welcome-popup.html".replace("/","."),d.templates["widgets-edu-welcome-popup.html"])},"1.0",{requires:["handlebars-base"]});YUI.add("squarespace-hb-product-price-string",function(b){b.Handlebars.registerHelper("price-string",function(d){return new b.Handlebars.SafeString(b.Squarespace.Commerce.priceString(d))})},"1.0",{requires:["handlebars-base","squarespace-commerce-utils"]});
YUI.add("squarespace-external-link-tab-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["external-link-tab.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];this.merge(d,b.helpers);return'<div class="external-link-tab">\n  <div class="link">\n    <button class="visit" title="Visit URL"></button>\n  </div>\n</div>\n'})})();b.Handlebars.registerPartial("external-link-tab.html".replace("/","."),d.templates["external-link-tab.html"])},"1.0",
{requires:["handlebars-base"]});
YUI.add("squarespace-content-manager-navigation-item",function(b){b.namespace("Squarespace.ContentManager").NavigationItem=b.Base.create("ContentNavigationItem",b.Squarespace.SSWidget,[b.WidgetChild],{bindUI:function(){this.get("contentBox").on("click",function(b){!b.target.ancestor("a",!0)&&this.get("item").get("collectionId")&&(this.get("isSelected")||this.get("root").set("selectedCollection",this.get("item").get("collection")))},this);this.get("id");var b=this.get("item"),c=b.get("collection");
b.get("collectionId")?(this._registerEvent(c.on("navigationTitleChange",function(b){this._setTitle(b.newVal)},this)),this._registerEvent(this.get("template").after("homepageCollectionIdChange",this.syncUI,this)),this._registerEvent(c.after(["enabledChange","synchronizingChange","idChange"],this.syncUI,this)),this._registerEvent(c.on("destroy",this.hideAndDestroy,this))):b.get("externalLink")&&(this._registerEvent(b.on("externalLinkChange",function(b){this._setTitle(b.newVal.title)},this)),this._registerEvent(b.on("destroy",
this.hideAndDestroy,this)));this._bindIsSelectedBehavior()},syncUI:function(){var d=[],c=this.get("item"),e=c.get("collection");if(b.Lang.isValue(e)){var f=e.get("id");this.get("boundingBox").setAttribute("id","collection-"+f);this.get("template").get("homepageCollectionId")==f&&d.push(this.getClassName("homepage"));e.get("enabled")||d.push(this.getClassName("disabled"));e.get("synchronizing")&&d.push(this.getClassName("syncing"));e.getTemplateConfiguration().get("collectionType")==b.Squarespace.CollectionTypes.TEMPLATE_PAGE&&
d.push(this.getClassName("type-template-page"));d.push(this.getClassName("collection-type-"+c.get("icon")));d.push(this.getClassName("type-collection"))}else c.get("externalLink")&&d.push(this.getClassName("type-external-link"));this.set("className",d.join(" "))},_bindIsSelectedBehavior:function(){var b=this.get("boundingBox");this.on("isSelectedChange",function(c){b.toggleClass(this.getClassName("is-selected"),c.newVal)},this)},_getHBTemplateContext:function(){var d=this.get("item");return{icon:d.get("icon"),
navigationTitle:b.Escape.html(d.get("title")).trim()||"&nbsp;"}},_setTitle:function(d){d=!d||0===d.trim().length?"&nbsp;":b.Escape.html(d);this.get("contentBox").one(".title").setContent(d);this.get("contentBox").one(".title").setAttribute("title",d)},hideAndDestroy:function(){var b=this.get("contentBox"),c=this.get("boundingBox");!b.getDOMNode()||!c.getDOMNode()?this.destroy():(c.setStyles({overflow:"hidden",position:"relative",height:c.get("offsetHeight")}),b.setStyles({position:"absolute",bottom:0,
left:0,right:0}),c.anim({height:0},{end:function(){this.destroy()},context:this}).run())}},{SELECTED_ATTRIBUTE:"isSelected",CSS_PREFIX:"sqs-navigation-item",HANDLEBARS_TEMPLATE:"navigation-item.html",ATTRS:{item:{},template:{valueFn:function(){return this.get("item").getNavigationItemList().getTemplateNavigation().getTemplateNavigationList().getTemplate()}},collectionConfiguration:{valueFn:function(){var b=this.get("item").get("typeName");if(b){var c=this.get("template"),e=c.get("collectionConfigs."+
b);return e?e:c.get("pageConfigs."+b)}return null}},isSelected:{value:!1}}})},"1.0",{requires:["squarespace-ss-widget","squarespace-navigation-item-template","widget-child"]});
YUI.add("squarespace-dialog-create-link",function(b){var d=b.namespace("Squarespace.DialogFields").CreateLink=b.Base.create("createLink",b.Squarespace.DialogField2,[],{initializer:function(){this.get("strings.placeholderText")||this.set("strings.placeholderText","Click to add URL...");this._edited=!1},renderUI:function(){d.superclass.renderUI.call(this);b.Squarespace.ContentStatsCache.isEmpty()?b.Squarespace.ContentStatsCache.load(b.bind(function(){this._verifyLink(b.bind(this._customRender,this))},
this)):this._verifyLink(b.bind(this._customRender,this))},_customRender:function(c){var e=this.get("width");e&&this.get("contentBox").setStyles({width:e});e=this.get("contentBox");this.get("condensed")&&e.addClass("condensed");this.get("strings.title")&&e.append(b.Node.create('<div class="title">'+this.get("strings.title")+"</div>"));this.get("withLinkText")&&(this._linkTextField=new b.Squarespace.DialogFields.Text({name:"text","strings.title":"Link Text",className:"thin",render:e,data:this.get("data.text")}));
this._editingWindow=b.Node.create('<div class="editing-window"></div>');this.get("showPlaceholder")||this._editingWindow.addClass("without-placeholder");e.append(this._editingWindow);this._editingWindowTabs=this._createTabs(c);this._editingWindowTabs.render(this._editingWindow);this.get("showPlaceholder")?(c=this.get("data.url"),this._placeholder=b.Node.create('<div class="placeholder"><div class="link-icon"></div><div class="inner">'+(c?c:this.get("strings.placeholderText"))+"</div></div>"),this._set("errorFlyoutAnchor",
this._placeholder),this._clearButton=b.Node.create('<div class="clear'+(c?"":" hidden")+'"></div>'),this._placeholder.append(this._clearButton),this._editingWindow.insert(this._placeholder,"before"),this._editingWindow.addClass("hidden"),this._editingWindow.setStyle("height",0),this._editingWindow.one(".sqs-tab-view").setStyle("opacity",0)):(this._editingWindow.setStyle("height",this._getOpenWindowHeight()),"external"==this._editingWindowTabs.getActiveChildId()&&this._editingWindow.one(".external-link-tab input").focus(),
this._set("errorFlyoutAnchor",this._editingWindow));this.fire("rendered");this._customBindUI()},_customBindUI:function(){this.get("withLinkText")&&this._linkTextField.after("dataChange",function(b){var e=this.get("data")||{};e.text=b.newVal;this.set("data",e)},this);this.get("showPlaceholder")&&(this._placeholder.on("click",function(b){b.target.hasClass("clear")?this._clear():(b.halt(),this._placeholder.hasClass("open")?this._closeEditingWindow():this._openEditingWindow())},this),this.after("dataChange",
this._setPlaceholderText,this));this._editingWindowTabs.before("tab-switch-requested",function(b){if(this._editingWindowTabs.getActiveChildId()!=b.tabId&&(!this._placeholder||this._placeholder.hasClass("open")))this._editingWindow.one(".sqs-tab-view-children").setStyle("opacity",0),this._editingWindow.activeAnim&&this._editingWindow.activeAnim.stop(),b=this._editingWindow.anim({height:this._getOpenWindowHeight(b.tabId)},{duration:0.2,end:function(){this._editingWindow.one(".sqs-tab-view-children").anim({opacity:1},
{duration:0.1}).run();"external"==this._editingWindowTabs.getActiveChildId()&&this._editingWindow.one(".external-link-tab input").focus()},context:this}),b.on("tween",function(){this.fire("animating")},this),b.run()},this);this.get("required")&&this.after("dataChange",function(b){this.hideError()},this)},didDataChange:function(){return this._edited},isEmpty:function(){var b=this.get("data.url");return!b||""===b},_verifyLink:function(c){var e=this._getLinkType();if("external"==e)c();else if("files"==
e)e=this._getSelectedFile(),b.Data.get({url:b.Squarespace.API_ROOT+"content-items",data:{recordType:b.Squarespace.RecordType.ATTACHMENT,urlId:e},success:function(e){e=b.Object.getValue(e,["results"]);e=b.Lang.isArray(e)&&0<e.length;c(!e)},failure:function(b){c()}},this);else if("content"==e){var d=this._getSelectedContent();if(e=b.Array.find(b.Squarespace.ContentCollectionCache.toArray(),function(b){return b.get("urlId")==d.urlId}))if(d.filter){var g=d.filter,h=!1,e=b.Squarespace.ContentStatsCache.getByCollectionId(e.get("id"));
"category"==g.type?b.Array.each(e.getCategoriesAsStringArray(),function(b){b==g.name&&(h=!0)}):b.Array.each(e.getTagsAsStringArray(),function(b){b==g.name&&(h=!0)});h?c():c(!0)}else c();else c(!0)}},_createTabs:function(c){var e=this._getLinkType(),d=this.get("data.url"),g=this.get("data.newWindow"),h=this.get("disableNewWindow"),k,l;c&&(e="external");"files"==e?k=this._getSelectedFile():"content"==e&&(l=this._getSelectedContent());var p={external:{label:"External",id:"external",ctor:b.Squarespace.Views.ExternalLinkTab,
config:{onDataChange:b.bind(function(c,e,d){var f=null;b.Lang.isValue(c)&&""!==c&&(f={url:c,newWindow:e,text:this.get("data.text")});this.set("data",f);d&&(this.get("showPlaceholder")&&this._closeEditingWindow(),this.fire("close"));this._edited=!0},this),linkUrl:"external"==e?d:null,newWindow:g,disableNewWindow:h}},files:{label:"Files",id:"files",ctor:b.Squarespace.Views.FileManagerTab,config:{onDataChange:b.bind(function(b,c){this.set("data",{url:b?"/s/"+b:null,newWindow:c,text:this.get("data.text")});
this._edited=!0},this),selectedFile:"files"==e?k:null,newWindow:g,disableNewWindow:h}},content:{label:"Content",id:"content",ctor:b.Squarespace.Views.ExistingContentLinkTab,config:{onDataChange:b.bind(function(b,c){var e="/"+b.urlId;b.filter&&(e=e+"?"+b.filter.type+"="+encodeURIComponent(b.filter.name));this.set("data",{url:e,newWindow:c,text:this.get("data.text")});this.fire("close");this._edited=!0},this),selectedContent:"content"==e?l:null,newWindow:g,disableNewWindow:h}}};c=this.get("renderTabs");
var q=[];b.Object.each(c,function(b,c){b&&q.push(p[c])});return new b.Squarespace.Widgets.TabView({widgets:q,initialTabId:e})},_openEditingWindow:function(){this._editingWindow.activeAnim&&this._editingWindow.activeAnim.stop();this._editingWindow.anim({height:this._getOpenWindowHeight()},{duration:0.2,start:function(){this._placeholder.addClass("open");this._editingWindow.removeClass("hidden")},end:function(){this._editingWindow.one(".sqs-tab-view").anim({opacity:1},{duration:0.1}).run();"external"==
this._editingWindowTabs.getActiveChildId()&&this._editingWindow.one(".external-link-tab input").focus()},context:this}).run()},_closeEditingWindow:function(b){this._editingWindow.activeAnim&&this._editingWindow.activeAnim.stop();this._editingWindow.one(".sqs-tab-view").anim({opacity:0},{duration:0.1,start:function(){this._editingWindow.anim({height:0},{duration:0.2,end:function(){this._placeholder.removeClass("open");this._editingWindow.addClass("hidden");b&&this._editingWindowTabs.switchTabs("external")},
context:this}).run();this.get("data.url")&&this._clearButton.removeClass("hidden")},context:this}).run()},_clear:function(){this.set("data.url",null);this._clearButton.addClass("hidden");this._placeholder.hasClass("open")?this._closeEditingWindow(!0):(this._setPlaceholderText(),this._editingWindowTabs.switchTabs("external"));b.Object.each(this._editingWindowTabs.getChildWidgets(),function(b){b.reset()},this)},_setPlaceholderText:function(){var b=this.get("data.url");if(b&&"http://"===b.substring(0,
7)){var e=b.substring(7);if(0<e.length&&7>e.length||"https:/"==e)if(e==="http://".substring(0,e.length)||e==="https://".substring(0,e.length))b=e}b=b?b:this.get("strings.placeholderText");this._placeholder.one(".inner").setHTML(b)},_getLinkType:function(){var b=this.get("data.url");return b?"/"==b.charAt(0)?"/s/"==b.substring(0,3)?"files":"content":"external":"external"},_getSelectedFile:function(){var b=this.get("data.url").split("/");return b[b.length-1]},_getSelectedContent:function(){var c=this.get("data.url").split("?");
selectedContent={urlId:c[0].substring(1)};if(c=c[1])queryParams=b.QueryString.parse(c),queryParams.category?selectedContent.filter={type:"category",name:queryParams.category}:queryParams.tag&&(selectedContent.filter={type:"tag",name:queryParams.tag});return selectedContent},_getOpenWindowHeight:function(b){b=b||this._editingWindowTabs.getActiveChildId();var e=this.get("disableNewWindow"),d=this.get("condensed"),g,h;switch(b){case "external":g=h=e?92:116;break;case "files":g=e?318:342;h=e?252:276;
break;case "content":g=e?318:342,h=e?232:256}return d?h:g}},{CSS_PREFIX:"sqs-create-link",ATTRS:{condensed:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},disableNewWindow:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},renderTabs:{value:{external:!0,files:!0,content:!0}},showPlaceholder:{value:!0,validator:b.Squarespace.AttrValidators.isBoolean},withLinkText:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean}}})},"1.0",{requires:["base","squarespace-attr-validators",
"squarespace-dialog","squarespace-dialog-field-2"]});
YUI.add("squarespace-stats-timeline-range-graph",function(b){var d=b.namespace("Squarespace.Stats.Widgets").TimelineRangeGraph=b.Base.create("statsTimelineRangeGraph",b.Squarespace.Widgets.SSWidget,[],{renderUI:function(){d.superclass.renderUI.apply(this,arguments);var c=this.get("contentBox")._node,c=d3.select(c).append("svg"),e=this.get("margin"),f=this.get("width"),g=this.get("height"),h=f-e.left-e.right,e=g-e.top-e.bottom,k=d3.time.scale().range([0,f]),l=d3.scale.linear().range([g,0]),p=this.get("brushHandleRadius"),
q=this.get("brushHandleOffset"),r=this.get("interpolation"),f=d3.svg.axis().scale(k).orient("bottom").tickFormat(function(b){b=k.tickFormat()(b);isNaN(Number(b))?d3.select(this).classed("major",!1):d3.select(this).classed("major",!0);return b}),r=d3.svg.area().interpolate(r).x(function(b){return k(b.d)}).y0(g).y1(function(b){return l(b.count)}),s=d3.svg.brush().x(k).on("brush",b.bind(this._onBrushChange,this)).on("brushstart",b.bind(function(){this._changeDragCursor(!0,d3.select(".extent"))},this)).on("brushend",
b.bind(function(){this._changeDragCursor(!1,d3.select(".extent"));this._onBrushEnd()},this));c.attr("width",h).attr("height",e+2*p+q);var p=c.append("g").attr("class","range"),q=p.append("g").attr("class","greyscale"),t=p.append("g").attr("class","color"),u="translate(0,"+(g/2-13)+")";this._renderDataStream(q,h,e,u);t.attr("clip-path","url(#clipBrush)");this._renderDataStream(t,h,e,u);this._renderBrush(p,s,g);this._renderClipPath(t,g);this._changeDragCursor(!1,d3.select(".extent"));this.set("xScale",
k);this.set("yScale",l);this.set("xAxis",f);this.set("area",r);this.set("svg",c);this.set("brush",s)},bindUI:function(){d.superclass.bindUI.apply(this,arguments);var b=this.get("model");b.on("normalizedDataChange",function(){this._changeExtent(b.get("extent"))},this);b.on("normalizedTotalsDataChange",function(b){this.set("data",b.newVal)},this);this.after("dataChange",this.syncUI,this)},syncUI:function(){d.superclass.syncUI.apply(this,arguments);var b=this.get("data");if(null!==b){var e=this.get("xScale"),
f=this.get("yScale"),g=this.get("xAxis"),h=this.get("area"),k=this.get("svg"),l=this.get("brush");e.domain(d3.extent(b.map(function(b){return b.d})));f.domain(d3.extent(b.map(function(b){return b.count})));k.selectAll(".data-stream").datum(b).attr("d",h);k.selectAll(".x.axis").call(g);this._changeExtent(l.empty()?e.domain():l.extent())}},_renderClipPath:function(b,e){b.append("clipPath").attr("id","clipBrush").append("rect").attr("width",0).attr("height",e)},_renderBrush:function(b,e,d){var g=this.get("brushHandleRadius"),
h=this.get("brushHandleOffset");b.append("g").attr("class","x brush").call(e).selectAll("rect").attr("height",d);d+=h;this._renderLine(b.select(".resize.e"),-1,-1,d,d-h);this._renderLine(b.select(".resize.w"),0,0,d,d-h);b.selectAll(".resize").append("circle").attr("cy",d+g).attr("r",g)},_renderDataStream:function(b,e,d,g){b.append("rect").attr("width",e).attr("height",d).attr("y");b.append("path").attr("class","data-stream");b.append("g").attr("class","x axis").attr("transform",g)},_renderLine:function(b,
e,d,g,h){return b.append("line").attr("x1",e).attr("x2",d).attr("y1",g).attr("y2",h)},_changeExtent:function(b){var e=this.get("brush"),d=this.get("svg"),g=this.get("data");e.extent(b);g&&(d.selectAll(".x.brush").call(e),this._renderBrushChange())},_renderBrushChange:function(){var b=this.get("svg"),e=this.get("brush"),d=b.select(".extent"),g=this.get("xScale");b.select("#clipBrush rect").attr("x",g(e.extent()[0])).attr("width",d.attr("width"))},_onBrushChange:function(){var b=this.get("model"),e=
this.get("xScale"),d=this.get("brush");this._renderBrushChange();b.set("extent",d.empty()?e.domain():d.extent())},_onBrushEnd:function(){this.get("nav").clearActiveTimespans();this.get("model").loadDataForExtent()},_changeDragCursor:function(c,e){var d;d=c?b.UA.opera?"move":b.UA.gecko?"-moz-grabbing":"url(/universal/images-v6/stats/closedhand.png), move":b.UA.gecko?"-moz-grab":"url(/universal/images-v6/stats/openhand.png), move";e.style("cursor",d);d3.select("body").style("cursor",c?d:null)}},{CSS_PREFIX:"sqs-timeline-range-graph",
ATTRS:{model:{value:null},nav:{value:null},data:{value:null},width:{value:800},height:{value:60},margin:{value:{top:0,right:0,bottom:0,left:0}},xScale:{value:null},yScale:{value:null},xAxis:{value:null},yAxis:{value:null},area:{value:null},svg:{value:null},brush:{value:null},brushHandleRadius:{value:5},brushHandleOffset:{value:4},interpolation:{value:"linear"}}})},"1.0",{requires:["base-base","squarespace-ss-widget","squarespace-attr-validators","thirdparty-d3"]});
YUI.add("squarespace-models-shipping-configuration",function(b){var d=b.Base.create("Box",b.Model,[],{getVolume:function(){return this.get("length")*this.get("height")*this.get("depth")}},{ATTRS:{length:{value:0},height:{value:0},depth:{value:0},x:{value:0},y:{value:0},z:{value:0}}}),c=b.Base.create("boxList",b.ModelList,[],{model:d}),d=b.Base.create("Container",d,[],{getUsedSpace:function(){var b=0;this.get("packed").each(function(c){b+=c.getVolume()});return b},getWeight:function(){var b=0;this.get("packed").each(function(c){b+=
c.get("weight")});return b}},{ATTRS:{packed:{lazyAdd:!1,setter:function(e){return b.instanceOf(e,c)?e:new c({items:e})},validator:function(c){return b.Lang.isValue(c)&&0<c.length}},rate:{value:0},efficiency:{value:0}}}),e=b.Base.create("ContainerList",b.ModelList,[],{model:d}),d=b.Base.create("ShippingConfiguration",b.Model,[],{},{ATTRS:{containers:{lazyAdd:!1,setter:function(c){return b.instanceOf(c,e)?c:new e({items:c})},validator:function(c){return b.Lang.isValue(c)&&0<c.length}},time:{value:0},
efficiency:{value:0}}});b.namespace("Squarespace.Models").ShippingConfiguration=d},"1.0",{requires:["base","model","model-list"]});
YUI.add("squarespace-video-gallery",function(b){b.namespace("Squarespace.Widgets").VideoGallery=b.Base.create("videoGallery",b.Squarespace.Widgets.SSWidget,[b.WidgetStack,b.WidgetPosition,b.WidgetPositionAlign],{initializer:function(){this.publish("close",{defaultFn:this.destroy,preventable:!0})},_getSelectedVideo:function(){return this.get("videos")[this.get("selectedIdx")]},_getHBTemplateContext:function(){var d=this.getAttrs();b.Array.each(d.videos,function(b,e){b.index=e+1});return d},bindUI:function(){var d=
this.get("contentBox");this.after("selectedIdxChange",this.syncUI,this);d.delegate("click",function(b){this.fire("close")},".overlay, .close-button",this);d.delegate("click",function(b){b=b.currentTarget.getAttribute("data-video-index")-1;this.set("selectedIdx",b)},".playlist-item",this);b.Squarespace.EscManager&&this.after("visibleChange",function(){this.get("visible")?b.Squarespace.EscManager.addTarget(this):b.Squarespace.EscManager.removeTarget(this)})},close:function(){this.fire("close")},_findVideoElById:function(b){return this.get("contentBox").one('[data-video-id="'+
b+'"]')},destructor:function(){this._videoPlayer&&this._videoPlayer.destroy()},renderUI:function(){b.Squarespace.Widgets.VideoGallery.superclass.renderUI.call(this);this._videoPlayer=new b.Squarespace.Widgets.WistiaPlayer({video:this._getSelectedVideo()});this._videoPlayer.render(this.get("contentBox").one(".player"))},syncUI:function(){this._videoPlayer.set("video",this._getSelectedVideo());this._syncSelectedState()},_syncSelectedState:function(){var b=this.get("contentBox").one(".playlist-item.selected");
b&&b.removeClass("selected");b=this._getSelectedVideo();(b=this._findVideoElById(b.id))&&b.addClass("selected")}},{HANDLEBARS_TEMPLATE:"video-gallery.html",CSS_PREFIX:"sqs-video-gallery",ATTRS:{videos:{value:[]},zIndex:{value:3E5},selectedIdx:{value:0,validator:function(d){var c=b.Object.keys(this.get("videos")).length-1;return b.Lang.isNumber(d)&&0<=d&&d<=c}},align:{value:{node:null,points:[b.WidgetPositionAlign.TL,b.WidgetPositionAlign.TL]}},playlist:{value:!0}}})},"1.0",{requires:"base-build widget-position widget-position-align widget-stack squarespace-video-gallery-template squarespace-wistia-player squarespace-ss-widget".split(" ")});
YUI.add("squarespace-settings-site-billing-linked-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-site-billing-linked.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n    <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p="function",q=this;b=
'<div class="billing-subscribed-panel">\n  ';if((h=d["with"].call(c,c.strings,{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e="\n    ";if((f=d["if"].call(b,b.description,{hash:{},inverse:q.noop,fn:q.program(2,l,c),data:c}))||0===f)e+=f;e+='\n    <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "},k),data:k}))||0===h)b+=h;b+='\n\n  <div class="settings-panel-fields">\n\n    ';
if((h=d["if"].call(c,c.inBadStanding,{hash:{},inverse:q.program(6,function(b,c){return'\n\n      <div data-field-name="v5-membership-ok-description"></div>\n\n\n    '},k),fn:q.program(4,function(b,c){return'\n\n      <div data-field-name="v5-membership-bad-description"></div>\n\n      '},k),data:k}))||0===h)b+=h;return b+'\n\n    <div class="account-center-wrapper">\n      <div data-field-name="account-center-description"></div>\n      <div data-field-name="account-center-button"></div>\n    </div>\n\n    <div class="unlink-wrapper">\n      <div data-field-name="unlink-description"></div>\n      <div data-field-name="linkv5"></div>\n    </div>\n    \n  </div>\n</div>\n'})})();
b.Handlebars.registerPartial("settings-site-billing-linked.html".replace("/","."),d.templates["settings-site-billing-linked.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-member-permission-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["member-permission.html"]=b(function(b,c,d,h,k){function l(b,c){return" "}function p(b,c){return'\n  <div class="roles">\n    <div class="role-label"><span class="role-short-text">Owner</span></div>\n  </div>\n  '}function q(b,c){var e,f;e='\n      <div class="role-label"><span class="role-short-text">';(f=d.shortText)?f=f.call(b,{hash:{},data:c}):(f=b.shortText,
f=typeof f===u?f.apply(b):f);return e+=v(f)+"</span></div>\n    "}function r(b,c){return'\n      <div class="button activate"><a href="#">Send Activate Email</a></div>\n    '}function s(b,c){return'\n    <input type="button" class="transfer-owner-btn button" value="Transfer Ownership"/>\n  '}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var t,u="function",v=this.escapeExpression,w=d.helperMissing,y=this;b='<div class="image" ';if((h=d["if"].call(c,(t=c.memberAccount,null==t||
!1===t?t:t.avatarAssetUrl),{hash:{},inverse:y.noop,fn:y.program(1,function(b,c){var e,d;return e=""+('style="background-image: url('+v((d=(d=b.memberAccount,null==d||!1===d?d:d.avatarAssetUrl),typeof d===u?d.apply(b):d))+');"')},k),data:k}))||0===h)b+=h;b+='>\n  <div class="overlay"></div>\n</div>\n\n<div class="info">\n\n  <div class="name">\n    '+v((t=(t=c.memberAccount,null==t||!1===t?t:t.displayName),typeof t===u?t.apply(c):t))+'\n  </div>\n\n  <div class="time">\n    Last Login: ';if((h=d["if"].call(c,
c.lastLoginOn,{hash:{},inverse:y.program(5,function(b,c){return"Never logged in"},k),fn:y.program(3,function(b,c){var e,f;f={hash:{},data:c};return v((e=d["humanizedate-format"]||b["humanizedate-format"],e?e.call(b,b.lastLoginOn,f):w.call(b,"humanizedate-format",b.lastLoginOn,f)))},k),data:k}))||0===h)b+=h;b+="\n  </div>\n\n</div>\n\n";h={hash:{},inverse:y.program(12,function(b,c){var e,f,h;e='\n  <div class="roles">\n    ';h={hash:{},inverse:y.noop,fn:y.program(13,q,c),data:c};if((h=(f=d["with-member-permission-roles"]||
b["with-member-permission-roles"],f?f.call(b,b.permissions,h):w.call(b,"with-member-permission-roles",b.permissions,h)))||0===h)e+=h;return e+"\n  </div>\n"},k),fn:y.program(7,function(b,c){var e,f,h;e="\n  ";h={hash:{},inverse:y.program(10,p,c),fn:y.program(8,l,c),data:c};if((h=(f=d["if-me"]||b["if-me"],f?f.call(b,b.memberAccount,h):w.call(b,"if-me",b.memberAccount,h)))||0===h)e+=h;return e+"\n"},k),data:k};if((h=(t=d["if-owner"]||c["if-owner"],t?t.call(c,c.memberAccount,h):w.call(c,"if-owner",c.memberAccount,
h)))||0===h)b+=h;b+='\n\n<div class="buttons">\n  ';if((h=d.unless.call(c,(t=c.memberAccount,null==t||!1===t?t:t.activatedAccount),{hash:{},inverse:y.noop,fn:y.program(15,function(b,c){var e,f,h;e="\n    ";if((h=d["if"].call(b,(f=b.memberAccount,null==f||!1===f?f:f.email),{hash:{},inverse:y.noop,fn:y.program(16,r,c),data:c}))||0===h)e+=h;return e+"\n  "},k),data:k}))||0===h)b+=h;b+="\n  ";h={hash:{},inverse:y.noop,fn:y.program(18,function(b,c){var e,f;f={hash:{},inverse:y.noop,fn:y.program(19,s,c),
data:c};return(f=(e=d["if-me"]||b["if-me"],e?e.call(b,b.memberAccount,f):w.call(b,"if-me",b.memberAccount,f)))||0===f?f:""},k),data:k};if((h=(t=d["if-owner"]||c["if-owner"],t?t.call(c,c.memberAccount,h):w.call(c,"if-owner",c.memberAccount,h)))||0===h)b+=h;return b+"\n</div>\n"})})();b.Handlebars.registerPartial("member-permission.html".replace("/","."),d.templates["member-permission.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-billing-subscription",function(b){b.namespace("Squarespace.Models.Billing");b.Squarespace.Models.Billing.Subscription=b.Base.create("billingSubscription",b.Model,[b.Squarespace.ModelSync.REST],{url:"/api/billing/subscriptions/{stripeId}",isNew:function(){return!b.Lang.isString(this.get("stripeId"))},toJSON:function(){var d=b.Squarespace.Models.Billing.Subscription.superclass.toJSON.call(this);d.renewalDate=d.renewalDate.getTime();return d}},{ATTRS:{stripeId:{validator:b.Squarespace.AttrValidators.isString},
renewalDate:{validator:b.Squarespace.AttrValidators.isDate},nextChargePrice:{validator:b.Squarespace.AttrValidators.isNumber},plan:{setter:function(d){this.set("product",b.merge(this.get("product"),{plan:d}))},getter:function(){return this.get("product.plan")}},period:{setter:function(d){this.set("product",b.merge(this.get("product"),{period:d}))},getter:function(){return this.get("product.period")}},product:{validator:function(d){return b.Lang.isString(d.plan)&&b.Lang.isString(d.period)}}}})},"1.0",
{requires:["base","model","squarespace-attr-validators","squarespace-model-sync-rest"]});
YUI.add("squarespace-settings-commerce-tutorial",function(b){b.namespace("Squarespace.Settings.Commerce");b.Squarespace.Settings.Commerce.Tutorial=b.Base.create("commerceTutorial",b.Squarespace.Widgets.SettingsPanel,[],{_dismissTutorial:function(){(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Dismiss this Guide","strings.title":"Dismiss this guide?","strings.message":'This will remove "Getting Started with Commerce" from your Commerce area in the future.'})).on("confirm",function(){b.Data.post({url:"/api/config/MarkWebsiteTutorialCompleted",
data:{tutorial:"commerce-tutorial-checklist"}},this);Static.SQUARESPACE_CONTEXT.websiteSettings.tutorialsCompleted["commerce-tutorial-checklist"]=!0;new b.Squarespace.Widgets.Information({"strings.title":"Dismissed","strings.message":"This guide will no longer appear in your Commerce panel."})},this)}},{HANDLEBARS_TEMPLATE:"store-tutorial.html",CSS_PREFIX:"sqs-settings-commerce-tutorial",ATTRS:{initialDataUrl:{value:"/api/commerce/admin/GetStoreLaunchProgress"},saveUrl:{},"strings.title":{value:"Getting Started"},
"strings.description":{value:'Squarespace Commerce lets you sell anything from your website in a completely integrated way. The platform supports selling physical goods, digital goods, and services, as well as accepting donations. Read more in our announcement about <a href="http://blog.squarespace.com/blog/squarespace-commerce-is-here">the release of Squarespace Commerce</a>.'},buttons:{valueFn:function(){return[{type:"dismiss",label:"Dismiss",action:b.bind(function(){this._dismissTutorial()},this)}]}},
fields:{value:[{ctor:b.Squarespace.DialogFields.Checklist,config:{name:"checklist",width:800,tutorialNamePrefix:"commerce-welcome",strings:{congratsTitle:"Your Store is Now Live",congratsDescription:"Click 'Dismiss' to move this guide to the bottom of the Commerce menu."},tasks:[{task:"add-product",name:"Add Products",description:"Add Products Pages to your site in your Content Manager.",skippable:!1,tip:{title:"Add Some Products",body:"Add a Products Page for your store in the Content Manager.",
alignNodeSelector:".config-panel .nav-content",pulseNavItem:!1}},{task:"create-shipping",name:"Create a Shipping Option",description:"If you are selling physical goods, you must create shipping options for your customers.",skippable:!0,tip:{title:"Create Shipping Options",body:"If you have physical goods, create shipping options for your customers.",alignNodeSelector:".config-panel .panel-menu-item.shipping",pulseNavItem:!0}},{task:"connect-stripe",name:"Connect your Stripe account",description:"Stripe provides the easiest way to accept credit cards on the web. You can create a free account in a few short minutes.",
skippable:!1,tip:{title:"Accept Payments with Stripe",body:"In Store Settings, connect your account to start accepting credit card payments.",alignNodeSelector:".config-panel .panel-menu-item.store-settings",pulseNavItem:!0}},{task:"stripe-live",name:"Flip the Switch to Go Live",description:"When you are ready, flip the switch to launch your store. You can start accepting orders immediately.",skippable:!1,tip:{title:"Go Live",body:"In Store Settings, flip the switch to start accepting payments and launch your store.",
alignNodeSelector:".config-panel .panel-menu-item.store-settings",pulseNavItem:!0}}]}}]}}})},"1.0",{requires:"squarespace-dombuilder squarespace-settings-panel squarespace-dialog-checklist squarespace-store-tutorial-template squarespace-widgets-confirmation squarespace-widgets-information".split(" ")});
YUI.add("squarespace-content-manager-add-page-dialog",function(b){var d=["splash-page"];b.namespace("Squarespace.ContentManager").AddPageDialog=b.Base.create("AddPageDialog",b.Squarespace.ModelEditorDialog,[],{getTemplateContext:function(){return{navigation:this.get("model"),template:this.get("template")}}},{ATTRS:{template:{},dialogConfig:{value:{width:400,savingText:"Saving...",flyoutPointerDirection:"hidden",style:"flyout",initialDataByReference:!0,tabs:[{title:"Create New Page",icon:"/universal/images-v6/icons/icon-plus-16-light.png",
fields:[{$valueFn:function(c){function e(b){g.push({title:b.title,value:b.value,icon:b.icon})}var f=c.navigation.get("acceptTypes");if(!f)throw"Accept Types not found in model";var f=b.Array.filter(f,function(c){return"splash-page"===c?!1:b.Squarespace.Utils.isBetaFeatureEnabled()?!0:-1===d.indexOf(c)}),g=[];c=c.template.get("collectionConfigs");for(var h=0;h<f.length;h++){var k=f[h],l=c[k];"link"==k?e({icon:"link",title:"Link",value:"link"}):b.Lang.isValue(l)?l.get("ordering")==b.Squarespace.CollectionOrdering.KNOWLEDGE_BASE?
b.Squarespace.Utils.isBetaFeatureEnabled()&&e({icon:l.get("icon"),title:l.get("title")+" (Beta)",value:k}):e({icon:l.get("icon"),title:l.get("title"),value:k}):console.warn("Could not find type: "+k+". Could not create entry in Add Page dialog.")}return{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"newNavigationItemType",iconDropPx:34,columns:3,optionPadding:"74px 0 20px 0",style:"title-bottom",className:"button icon32 square round",numeric:!1,options:g}}}}]}]}}}})},"1.0",{requires:["squarespace-model-editor",
"squarespace-util","squarespace-dialog-multi-option","squarespace-enum"]});
YUI.add("squarespace-panel",function(b){b.namespace("Squarespace").Panel=b.Base.create("panel",b.Panel,[b.WidgetParent,b.WidgetChild],{initializer:function(d){this.config=d||{};d=this.get("animDuration");0<d&&this.plug(b.Plugin.WidgetAnim,{duration:d});this.before("render",this._initPointer,this);this.after(["pointerChange","typeChange","alignChange"],this._initPointer,this);this.after("render",this.afterRender,this);this.set("alignOn",[{node:b.one(b.config.doc.body),eventName:"resize"}])},afterRender:function(){this.config.position&&
this.get("boundingBox").setStyle("position",this.config.position);this.show();this.config.align&&this.config.align.offset&&this.setPanelOffset(this.config.align.offset)},_initPointer:function(){var d=this.get("align");this.get("type");if(this.get("pointer")&&!this.pointer){if(d&&d.node&&b.one(d.node)&&"inline"!==this.get("type")){var c=this.get("boundingBox"),e=b.one(d.node).get("region");this.pointer=new b.Overlay({constrain:c,align:d,zIndex:2,render:c});d=this.getAxis(this.pointer);d.horizontal?
this.pointer.set("height",e.height):d.vertical&&this.pointer.set("width",e.width);e=this.get("animDuration");0<this.get("animDuration")&&this.plug(b.Plugin.WidgetAnim,{duration:e});this.pointer.get("boundingBox").addClass(this.getClassName("pointer"));this.after("xyChange",this.pointerOffset,this);this.pointerOffset();this.pointer.show()}}else!this.get("pointer")&&this.pointer&&this.pointer.destroy()},getAxis:function(b){var c=b.get("align").points[0].toLowerCase(),e=b.get("align").points[1].toLowerCase();
b="b"===c[0];var f="r"===c[0]||"r"===c[1],g="b"===e[0],h="r"===e[0]||"r"===e[1],h="l"===e[0]||"l"===e[1]||h,e="t"===e[0]||g;return{horizontal:("l"===c[0]||"l"===c[1]||f)&&h,vertical:("t"===c[0]||b)&&e}},setPanelOffset:function(b){this.move(this.get("boundingBox").getX()+b[0],this.get("boundingBox").getY()+b[1])},pointerOffset:function(d){d=this.get("xy");var c=b.one(this.get("align.node")).get("region"),e=this.get("boundingBox"),f=this.pointer.get("boundingBox"),g=this.getAxis(this),h="";["top","left",
"right","bottom"].forEach(function(b){e.removeClass(this.getClassName(b));f.removeClass(this.getClassName("pointer",b))},this);g.horizontal?h=d[0]>c[0]?"left":"right":g.vertical&&(h=d[1]>c[1]?"top":"bottom");e.addClass(this.getClassName(h));f.addClass(this.getClassName("pointer",h));this.pointer.align();"left"===h||"right"===h?f.setStyles({left:"left"===h?0:null,right:"right"===h?0:null}):f.setStyles({top:"top"===h?0:null,bottom:"bottom"===h?0:null})},destructor:function(){this.pointer&&this.pointer.destroy()}},
{CSS_PREFIX:"sqs-panel",ATTRS:{render:{value:!0},controls:{value:[],validator:b.Lang.isArray},node:{},type:{value:["popover"],setter:function(b){b="string"===typeof b?[b]:b;var c="";b.forEach(function(b){c+=this.getClassName("type-"+b)},this);this.get("boundingBox").addClass(c);"inline"===b&&this.set("align",{node:null,points:[null,null]});return b}},align:{value:{node:null,points:["tl","tr"]},broadcast:1},animDuration:{value:0.5},buttons:{value:{}},width:{value:260},modal:{value:!1},pointer:{value:!0,
lazyAdd:!1},constrain:{value:null},preventOverlap:{value:!0},visible:{value:!1}}})},"0.2.0",{requires:"node panel overlay widget-anim widget-child widget-parent".split(" ")});
(function(b,d){function c(c,e){function h(b){return p.preferFlash&&Jb&&!p.ignoreFlash&&p.flash[b]!==d&&p.flash[b]}function k(b){return function(c){var e=this._s;!e||!e._a?(e&&e.id?p._wD(e.id+": Ignoring "+c.type):p._wD(s+"Ignoring "+c.type),c=null):c=b.call(this,c);return c}}this.setupOptions={url:c||null,flashVersion:8,debugMode:!0,debugFlash:!1,useConsole:!0,consoleOnly:!0,waitForWindowLoad:!1,bgColor:"#ffffff",useHighPerformance:!1,flashPollingInterval:null,html5PollingInterval:null,flashLoadTimeout:1E3,
wmode:null,allowScriptAccess:"always",useFlashBlock:!1,useHTML5Audio:!0,html5Test:/^(probably|maybe)$/i,preferFlash:!0,noSWFCache:!1,idPrefix:"sound"};this.defaultOptions={autoLoad:!1,autoPlay:!1,from:null,loops:1,onid3:null,onload:null,whileloading:null,onplay:null,onpause:null,onresume:null,whileplaying:null,onposition:null,onstop:null,onfailure:null,onfinish:null,multiShot:!0,multiShotEvents:!1,position:null,pan:0,stream:!0,to:null,type:null,usePolicyFile:!1,volume:100};this.flash9Options={isMovieStar:null,
usePeakData:!1,useWaveformData:!1,useEQData:!1,onbufferchange:null,ondataerror:null};this.movieStarOptions={bufferTime:3,serverURL:null,onconnect:null,duration:null};this.audioFormats={mp3:{type:['audio/mpeg; codecs="mp3"',"audio/mpeg","audio/mp3","audio/MPA","audio/mpa-robust"],required:!0},mp4:{related:["aac","m4a","m4b"],type:['audio/mp4; codecs="mp4a.40.2"',"audio/aac","audio/x-m4a","audio/MP4A-LATM","audio/mpeg4-generic"],required:!1},ogg:{type:["audio/ogg; codecs=vorbis"],required:!1},opus:{type:["audio/ogg; codecs=opus",
"audio/opus"],required:!1},wav:{type:['audio/wav; codecs="1"',"audio/wav","audio/wave","audio/x-wav"],required:!1}};this.movieID="sm2-container";this.id=e||"sm2movie";this.debugID="soundmanager-debug";this.debugURLParam=/([#?&])debug=1/i;this.versionNumber="V2.97a.20130512";this.altURL=this.movieURL=this.version=null;this.enabled=this.swfLoaded=!1;this.oMC=null;this.sounds={};this.soundIDs=[];this.didFlashBlock=this.muted=!1;this.filePattern=null;this.filePatterns={flash8:/\.mp3(\?.*)?$/i,flash9:/\.mp3(\?.*)?$/i};
this.features={buffering:!1,peakData:!1,waveformData:!1,eqData:!1,movieStar:!1};this.sandbox={type:null,types:{remote:"remote (domain-based) rules",localWithFile:"local with file access (no internet access)",localWithNetwork:"local with network (internet access only, no local access)",localTrusted:"local, trusted (local+internet access)"},description:null,noRemote:null,noLocal:null};this.html5={usingFlash:null};this.flash={};this.ignoreFlash=this.html5Only=!1;var l,p=this,q=null,r=null,s="HTML5::",
t,u=navigator.userAgent,v=b.location.href.toString(),w=document,y,z,B,A,K=[],O=!0,E,F=!1,U=!1,H=!1,G=!1,aa=!1,D,M=0,I,Q,V,C,Z,N,ca,R,X,ba,na,S,$,ra,Y,ta,Na,Qa,Oa,fa,T,ia,ea=["log","info","warn","error"],xa,Aa,ya,Ba=null,Ua=null,ha,Ra,Ha,sa,eb,Xa,zb,Pa,va=!1,db=!1,Ib,Va,Ta,Ka=0,bb=null,fb,wa=[],oa,Ia=null,x,cb,La,jb,Ab,ja,Vb,$a,za=Array.prototype.slice,yb=!1,gc,Jb,Fb,rc,la,ob,Bc,hc,Gc=0,sc=u.match(/(ipad|iphone|ipod)/i),oc=u.match(/android/i),ga=u.match(/msie/i),Hc=u.match(/webkit/i),Gb=u.match(/safari/i)&&
!u.match(/chrome/i),Kb=u.match(/opera/i),Qb=u.match(/firefox/i),Lb=u.match(/(mobile|pre\/|xoom)/i)||sc||oc,xc=!v.match(/usehtml5audio/i)&&!v.match(/sm2\-ignorebadua/i)&&Gb&&!u.match(/silk/i)&&u.match(/OS X 10_6_([3-7])/i),tc=b.console!==d&&console.log!==d,uc=w.hasFocus!==d?w.hasFocus():null,Bb=Gb&&(w.hasFocus===d||!w.hasFocus()),hd=!Bb,mc=/(mp3|mp4|mpa|m4a|m4b)/i,Rb=w.location?w.location.protocol.match(/http/i):null,ld=!Rb?"http://":"",ed=/^\s*audio\/(?:x-)?(?:mpeg4|aac|flv|mov|mp4||m4v|m4a|m4b|mp4v|3gp|3g2)\s*(?:$|;)/i,
md="mpeg4 aac flv mov mp4 m4v f4v m4a m4b mp4v 3gp 3g2".split(" "),fd=RegExp("\\.("+md.join("|")+")(\\?.*)?$","i");this.mimePattern=/^\s*audio\/(?:x-)?(?:mp(?:eg|3))\s*(?:$|;)/i;this.useAltURL=!Rb;var nc;try{nc=Audio!==d&&(Kb&&opera!==d&&10>opera.version()?new Audio(null):new Audio).canPlayType!==d}catch(Pb){nc=!1}this.hasHTML5=nc;this.setup=function(b){var c=!p.url;b!==d&&H&&(Ia&&p.ok()&&(b.flashVersion!==d||b.url!==d||b.html5Test!==d))&&zb(ha("setupLate"));V(b);b&&(c&&Na&&b.url!==d&&p.beginDelayedInit(),
!Na&&b.url!==d&&"complete"===w.readyState&&setTimeout(Y,1));return p};this.supported=this.ok=function(){return Ia?H&&!G:p.useHTML5Audio&&p.hasHTML5};this.getMovie=function(c){return t(c)||w[c]||b[c]};this.createSound=function(b,c){function e(){g=eb(g);p.sounds[g.id]=new l(g);p.soundIDs.push(g.id);return p.sounds[g.id]}var f,g;f=null;f="soundManager.createSound(): "+ha(!H?"notReady":"notOK");if(!H||!p.ok())return zb(f),!1;c!==d&&(b={id:b,url:c});g=Q(b);g.url=fb(g.url);void 0===g.id&&(g.id=p.setupOptions.idPrefix+
Gc++);g.id.toString().charAt(0).match(/^[0-9]$/)&&p._wD("soundManager.createSound(): "+ha("badID",g.id),2);p._wD("soundManager.createSound(): "+g.id+(g.url?" ("+g.url+")":""),1);if(Pa(g.id,!0))return p._wD("soundManager.createSound(): "+g.id+" exists",1),p.sounds[g.id];if(cb(g))f=e(),p._wD(g.id+": Using HTML5"),f._setup_html5(g);else{if(p.html5Only)return p._wD(g.id+": No HTML5 support for this sound, and no Flash. Exiting."),e();if(p.html5.usingFlash&&g.url&&g.url.match(/data\:/i))return p._wD(g.id+
": data: URIs not supported via Flash. Exiting."),e();8<A&&(null===g.isMovieStar&&(g.isMovieStar=!(!g.serverURL&&!(g.type&&g.type.match(ed)||g.url&&g.url.match(fd)))),g.isMovieStar&&(p._wD("soundManager.createSound(): using MovieStar handling"),1<g.loops&&D("noNSLoop")));g=Xa(g,"soundManager.createSound(): ");f=e();8===A?r._createSound(g.id,g.loops||1,g.usePolicyFile):(r._createSound(g.id,g.url,g.usePeakData,g.useWaveformData,g.useEQData,g.isMovieStar,g.isMovieStar?g.bufferTime:!1,g.loops||1,g.serverURL,
g.duration||null,g.autoPlay,!0,g.autoLoad,g.usePolicyFile),g.serverURL||(f.connected=!0,g.onconnect&&g.onconnect.apply(f)));!g.serverURL&&(g.autoLoad||g.autoPlay)&&f.load(g)}!g.serverURL&&g.autoPlay&&f.play();return f};this.destroySound=function(b,c){if(!Pa(b))return!1;var e=p.sounds[b],d;e._iO={};e.stop();e.unload();for(d=0;d<p.soundIDs.length;d++)if(p.soundIDs[d]===b){p.soundIDs.splice(d,1);break}c||e.destruct(!0);delete p.sounds[b];return!0};this.load=function(b,c){return!Pa(b)?!1:p.sounds[b].load(c)};
this.unload=function(b){return!Pa(b)?!1:p.sounds[b].unload()};this.onposition=this.onPosition=function(b,c,e,d){return!Pa(b)?!1:p.sounds[b].onposition(c,e,d)};this.clearOnPosition=function(b,c,e){return!Pa(b)?!1:p.sounds[b].clearOnPosition(c,e)};this.start=this.play=function(b,c){var e=null,d=c&&!(c instanceof Object);if(!H||!p.ok())return zb("soundManager.play(): "+ha(!H?"notReady":"notOK")),!1;if(Pa(b,d))d&&(c={url:c});else{if(!d)return!1;d&&(c={url:c});c&&c.url&&(p._wD('soundManager.play(): Attempting to create "'+
b+'"',1),c.id=b,e=p.createSound(c).play())}null===e&&(e=p.sounds[b].play(c));return e};this.setPosition=function(b,c){return!Pa(b)?!1:p.sounds[b].setPosition(c)};this.stop=function(b){if(!Pa(b))return!1;p._wD("soundManager.stop("+b+")",1);return p.sounds[b].stop()};this.stopAll=function(){var b;p._wD("soundManager.stopAll()",1);for(b in p.sounds)p.sounds.hasOwnProperty(b)&&p.sounds[b].stop()};this.pause=function(b){return!Pa(b)?!1:p.sounds[b].pause()};this.pauseAll=function(){var b;for(b=p.soundIDs.length-
1;0<=b;b--)p.sounds[p.soundIDs[b]].pause()};this.resume=function(b){return!Pa(b)?!1:p.sounds[b].resume()};this.resumeAll=function(){var b;for(b=p.soundIDs.length-1;0<=b;b--)p.sounds[p.soundIDs[b]].resume()};this.togglePause=function(b){return!Pa(b)?!1:p.sounds[b].togglePause()};this.setPan=function(b,c){return!Pa(b)?!1:p.sounds[b].setPan(c)};this.setVolume=function(b,c){return!Pa(b)?!1:p.sounds[b].setVolume(c)};this.mute=function(b){var c=0;b instanceof String&&(b=null);if(b){if(!Pa(b))return!1;p._wD('soundManager.mute(): Muting "'+
b+'"');return p.sounds[b].mute()}p._wD("soundManager.mute(): Muting all sounds");for(c=p.soundIDs.length-1;0<=c;c--)p.sounds[p.soundIDs[c]].mute();return p.muted=!0};this.muteAll=function(){p.mute()};this.unmute=function(b){b instanceof String&&(b=null);if(b){if(!Pa(b))return!1;p._wD('soundManager.unmute(): Unmuting "'+b+'"');return p.sounds[b].unmute()}p._wD("soundManager.unmute(): Unmuting all sounds");for(b=p.soundIDs.length-1;0<=b;b--)p.sounds[p.soundIDs[b]].unmute();p.muted=!1;return!0};this.unmuteAll=
function(){p.unmute()};this.toggleMute=function(b){return!Pa(b)?!1:p.sounds[b].toggleMute()};this.getMemoryUse=function(){var b=0;r&&8!==A&&(b=parseInt(r._getMemoryUse(),10));return b};this.disable=function(c){var e;c===d&&(c=!1);if(G)return!1;G=!0;D("shutdown",1);for(e=p.soundIDs.length-1;0<=e;e--)xa(p.sounds[p.soundIDs[e]]);I(c);$a.remove(b,"load",ca);return!0};this.canPlayMIME=function(b){var c;p.hasHTML5&&(c=La({type:b}));!c&&Ia&&(c=b&&p.ok()?!!(8<A&&b.match(ed)||b.match(p.mimePattern)):null);
return c};this.canPlayURL=function(b){var c;p.hasHTML5&&(c=La({url:b}));!c&&Ia&&(c=b&&p.ok()?!!b.match(p.filePattern):null);return c};this.canPlayLink=function(b){return b.type!==d&&b.type&&p.canPlayMIME(b.type)?!0:p.canPlayURL(b.href)};this.getSoundById=function(b,c){if(!b)return null;var e=p.sounds[b];!e&&!c&&p._wD('soundManager.getSoundById(): Sound "'+b+'" not found.',2);return e};this.onready=function(c,e){if("function"===typeof c)H&&p._wD(ha("queue","onready")),e||(e=b),Z("onready",c,e),N();
else throw ha("needFunction","onready");return!0};this.ontimeout=function(c,e){if("function"===typeof c)H&&p._wD(ha("queue","ontimeout")),e||(e=b),Z("ontimeout",c,e),N({type:"ontimeout"});else throw ha("needFunction","ontimeout");return!0};this._writeDebug=function(b,c){var e,f;if(!p.debugMode)return!1;if(tc&&p.useConsole){if(c&&"object"===typeof c)console.log(b,c);else if(ea[c]!==d)console[ea[c]](b);else console.log(b);if(p.consoleOnly)return!0}e=t("soundmanager-debug");if(!e)return!1;f=w.createElement("div");
0===++M%2&&(f.className="sm2-alt");c=c===d?0:parseInt(c,10);f.appendChild(w.createTextNode(b));c&&(2<=c&&(f.style.fontWeight="bold"),3===c&&(f.style.color="#ff3333"));e.insertBefore(f,e.firstChild);return!0};-1!==v.indexOf("sm2-debug=alert")&&(this._writeDebug=function(c){b.alert(c)});this._wD=this._writeDebug;this._debug=function(){var b,c;D("currentObj",1);b=0;for(c=p.soundIDs.length;b<c;b++)p.sounds[p.soundIDs[b]]._debug()};this.reboot=function(c,e){p.soundIDs.length&&p._wD("Destroying "+p.soundIDs.length+
" SMSound object"+(1!==p.soundIDs.length?"s":"")+"...");var d,f,g;for(d=p.soundIDs.length-1;0<=d;d--)p.sounds[p.soundIDs[d]].destruct();if(r)try{ga&&(Ua=r.innerHTML),Ba=r.parentNode.removeChild(r)}catch(h){D("badRemove",2)}Ua=Ba=Ia=r=null;p.enabled=Na=H=va=db=F=U=G=yb=p.swfLoaded=!1;p.soundIDs=[];p.sounds={};Gc=0;if(c)K=[];else for(d in K)if(K.hasOwnProperty(d)){f=0;for(g=K[d].length;f<g;f++)K[d][f].fired=!1}e||p._wD("soundManager: Rebooting...");p.html5={usingFlash:null};p.flash={};p.html5Only=!1;
p.ignoreFlash=!1;b.setTimeout(function(){ra();e||p.beginDelayedInit()},20);return p};this.reset=function(){D("reset");return p.reboot(!0,!0)};this.getMoviePercent=function(){return r&&"PercentLoaded"in r?r.PercentLoaded():null};this.beginDelayedInit=function(){aa=!0;Y();setTimeout(function(){if(db)return!1;Oa();$();return db=!0},20);R()};this.destruct=function(){p._wD("soundManager.destruct()");p.disable(!0)};l=function(b){var c,e,f=this,g,h,k,l,s,t,u=!1,v=[],w=0,y,z,x=null,S;e=c=null;this.sID=this.id=
b.id;this.url=b.url;this._iO=this.instanceOptions=this.options=Q(b);this.pan=this.options.pan;this.volume=this.options.volume;this.isHTML5=!1;this._a=null;S=this.url?!1:!0;this.id3={};this._debug=function(){p._wD(f.id+": Merged options:",f.options)};this.load=function(b){var c=null,e;b!==d?f._iO=Q(b,f.options):(b=f.options,f._iO=b,x&&x!==f.url&&(D("manURL"),f._iO.url=f.url,f.url=null));f._iO.url||(f._iO.url=f.url);f._iO.url=fb(f._iO.url);e=f.instanceOptions=f._iO;p._wD(f.id+": load ("+e.url+")");
if(!e.url&&!f.url)return p._wD(f.id+": load(): url is unassigned. Exiting.",2),f;!f.isHTML5&&8===A&&(!f.url&&!e.autoPlay)&&p._wD(f.id+": Flash 8 load() limitation: Wait for onload() before calling play().",1);if(e.url===f.url&&0!==f.readyState&&2!==f.readyState)return D("onURL",1),3===f.readyState&&e.onload&&hc(f,function(){e.onload.apply(f,[!!f.duration])}),f;f.loaded=!1;f.readyState=1;f.playState=0;f.id3={};if(cb(e))c=f._setup_html5(e),c._called_load?p._wD(f.id+": Ignoring request to load again"):
(f._html5_canplay=!1,f.url!==e.url&&(p._wD(D("manURL")+": "+e.url),f._a.src=e.url,f.setPosition(0)),f._a.autobuffer="auto",f._a.preload="auto",f._a._called_load=!0,e.autoPlay&&f.play());else{if(p.html5Only)return p._wD(f.id+": No flash support. Exiting."),f;if(f._iO.url&&f._iO.url.match(/data\:/i))return p._wD(f.id+": data: URIs not supported via Flash. Exiting."),f;try{f.isHTML5=!1,f._iO=Xa(eb(e)),e=f._iO,8===A?r._load(f.id,e.url,e.stream,e.autoPlay,e.usePolicyFile):r._load(f.id,e.url,!!e.stream,
!!e.autoPlay,e.loops||1,!!e.autoLoad,e.usePolicyFile)}catch(g){D("smError",2),E("onload",!1),fa({type:"SMSOUND_LOAD_JS_EXCEPTION",fatal:!0})}}f.url=e.url;return f};this.unload=function(){0!==f.readyState&&(p._wD(f.id+": unload()"),f.isHTML5?(l(),f._a&&(f._a.pause(),x=Ab(f._a))):8===A?r._unload(f.id,"about:blank"):r._unload(f.id),g());return f};this.destruct=function(b){p._wD(f.id+": Destruct");f.isHTML5?(l(),f._a&&(f._a.pause(),Ab(f._a),yb||k(),f._a._s=null,f._a=null)):(f._iO.onfailure=null,r._destroySound(f.id));
b||p.destroySound(f.id,!0)};this.start=this.play=function(b,c){var e,g,h,k,l,q=!0,q=null;e=f.id+": play(): ";c=c===d?!0:c;b||(b={});f.url&&(f._iO.url=f.url);f._iO=Q(f._iO,f.options);f._iO=Q(b,f._iO);f._iO.url=fb(f._iO.url);f.instanceOptions=f._iO;if(!f.isHTML5&&f._iO.serverURL&&!f.connected)return f.getAutoPlay()||(p._wD(e+" Netstream not connected yet - setting autoPlay"),f.setAutoPlay(!0)),f;cb(f._iO)&&(f._setup_html5(f._iO),s());1===f.playState&&!f.paused&&((g=f._iO.multiShot)?p._wD(e+"Already playing (multi-shot)",
1):(p._wD(e+"Already playing (one-shot)",1),f.isHTML5&&f.setPosition(f._iO.position),q=f));if(null!==q)return q;b.url&&b.url!==f.url&&(!f.readyState&&!f.isHTML5&&8===A&&S?S=!1:f.load(f._iO));f.loaded?p._wD(e.substr(0,e.lastIndexOf(":"))):0===f.readyState?(p._wD(e+"Attempting to load"),!f.isHTML5&&!p.html5Only?(f._iO.autoPlay=!0,f.load(f._iO)):f.isHTML5?f.load(f._iO):(p._wD(e+"Unsupported type. Exiting."),q=f),f.instanceOptions=f._iO):2===f.readyState?(p._wD(e+"Could not load - exiting",2),q=f):p._wD(e+
"Loading - attempting to play...");if(null!==q)return q;!f.isHTML5&&9===A&&(0<f.position&&f.position===f.duration)&&(p._wD(e+"Sound at end, resetting to position:0"),b.position=0);if(f.paused&&0<=f.position&&(!f._iO.serverURL||0<f.position))p._wD(e+"Resuming from paused state",1),f.resume();else{f._iO=Q(b,f._iO);if(null!==f._iO.from&&null!==f._iO.to&&0===f.instanceCount&&0===f.playState&&!f._iO.serverURL){g=function(){f._iO=Q(b,f._iO);f.play(f._iO)};if(f.isHTML5&&!f._html5_canplay)p._wD(e+"Beginning load for from/to case"),
f.load({oncanplay:g}),q=!1;else if(!f.isHTML5&&!f.loaded&&(!f.readyState||2!==f.readyState))p._wD(e+"Preloading for from/to case"),f.load({onload:g}),q=!1;if(null!==q)return q;f._iO=z()}(!f.instanceCount||f._iO.multiShotEvents||f.isHTML5&&f._iO.multiShot&&!yb||!f.isHTML5&&8<A&&!f.getAutoPlay())&&f.instanceCount++;f._iO.onposition&&0===f.playState&&t(f);f.playState=1;f.paused=!1;f.position=f._iO.position!==d&&!isNaN(f._iO.position)?f._iO.position:0;f.isHTML5||(f._iO=Xa(eb(f._iO)));f._iO.onplay&&c&&
(f._iO.onplay.apply(f),u=!0);f.setVolume(f._iO.volume,!0);f.setPan(f._iO.pan,!0);f.isHTML5?2>f.instanceCount?(s(),e=f._setup_html5(),f.setPosition(f._iO.position),e.play()):(p._wD(f.id+": Cloning Audio() for instance #"+f.instanceCount+"..."),h=new Audio(f._iO.url),k=function(){$a.remove(h,"onended",k);f._onfinish(f);Ab(h);h=null},l=function(){$a.remove(h,"canplay",l);try{h.currentTime=f._iO.position/1E3}catch(b){zb(f.id+": multiShot play() failed to apply position of "+f._iO.position/1E3)}h.play()},
$a.add(h,"ended",k),f._iO.position?$a.add(h,"canplay",l):h.play()):(q=r._start(f.id,f._iO.loops||1,9===A?f.position:f.position/1E3,f._iO.multiShot||!1),9===A&&!q&&(p._wD(e+"No sound hardware, or 32-sound ceiling hit",2),f._iO.onplayerror&&f._iO.onplayerror.apply(f)))}return f};this.stop=function(b){var c=f._iO;1===f.playState&&(p._wD(f.id+": stop()"),f._onbufferchange(0),f._resetOnPosition(0),f.paused=!1,f.isHTML5||(f.playState=0),y(),c.to&&f.clearOnPosition(c.to),f.isHTML5?f._a&&(b=f.position,f.setPosition(0),
f.position=b,f._a.pause(),f.playState=0,f._onTimer(),l()):(r._stop(f.id,b),c.serverURL&&f.unload()),f.instanceCount=0,f._iO={},c.onstop&&c.onstop.apply(f));return f};this.setAutoPlay=function(b){p._wD(f.id+": Autoplay turned "+(b?"on":"off"));f._iO.autoPlay=b;f.isHTML5||(r._setAutoPlay(f.id,b),b&&!f.instanceCount&&1===f.readyState&&(f.instanceCount++,p._wD(f.id+": Incremented instance count to "+f.instanceCount)))};this.getAutoPlay=function(){return f._iO.autoPlay};this.setPosition=function(b){b===
d&&(b=0);var c=f.isHTML5?Math.max(b,0):Math.min(f.duration||f._iO.duration,Math.max(b,0));f.position=c;b=f.position/1E3;f._resetOnPosition(f.position);f._iO.position=c;if(f.isHTML5){if(f._a){if(f._html5_canplay){if(f._a.currentTime!==b){p._wD(f.id+": setPosition("+b+")");try{f._a.currentTime=b,(0===f.playState||f.paused)&&f._a.pause()}catch(e){p._wD(f.id+": setPosition("+b+") failed: "+e.message,2)}}}else if(b)return p._wD(f.id+": setPosition("+b+"): Cannot seek yet, sound not ready",2),f;f.paused&&
f._onTimer(!0)}}else b=9===A?f.position:b,f.readyState&&2!==f.readyState&&r._setPosition(f.id,b,f.paused||!f.playState,f._iO.multiShot);return f};this.pause=function(b){if(f.paused||0===f.playState&&1!==f.readyState)return f;p._wD(f.id+": pause()");f.paused=!0;f.isHTML5?(f._setup_html5().pause(),l()):(b||b===d)&&r._pause(f.id,f._iO.multiShot);f._iO.onpause&&f._iO.onpause.apply(f);return f};this.resume=function(){var b=f._iO;if(!f.paused)return f;p._wD(f.id+": resume()");f.paused=!1;f.playState=1;
f.isHTML5?(f._setup_html5().play(),s()):(b.isMovieStar&&!b.serverURL&&f.setPosition(f.position),r._pause(f.id,b.multiShot));!u&&b.onplay?(b.onplay.apply(f),u=!0):b.onresume&&b.onresume.apply(f);return f};this.togglePause=function(){p._wD(f.id+": togglePause()");if(0===f.playState)return f.play({position:9===A&&!f.isHTML5?f.position:f.position/1E3}),f;f.paused?f.resume():f.pause();return f};this.setPan=function(b,c){b===d&&(b=0);c===d&&(c=!1);f.isHTML5||r._setPan(f.id,b);f._iO.pan=b;c||(f.pan=b,f.options.pan=
b);return f};this.setVolume=function(b,c){b===d&&(b=100);c===d&&(c=!1);f.isHTML5?f._a&&(f._a.volume=Math.max(0,Math.min(1,b/100))):r._setVolume(f.id,p.muted&&!f.muted||f.muted?0:b);f._iO.volume=b;c||(f.volume=b,f.options.volume=b);return f};this.mute=function(){f.muted=!0;f.isHTML5?f._a&&(f._a.muted=!0):r._setVolume(f.id,0);return f};this.unmute=function(){f.muted=!1;var b=f._iO.volume!==d;f.isHTML5?f._a&&(f._a.muted=!1):r._setVolume(f.id,b?f._iO.volume:f.options.volume);return f};this.toggleMute=
function(){return f.muted?f.unmute():f.mute()};this.onposition=this.onPosition=function(b,c,e){v.push({position:parseInt(b,10),method:c,scope:e!==d?e:f,fired:!1});return f};this.clearOnPosition=function(b,c){var e;b=parseInt(b,10);if(isNaN(b))return!1;for(e=0;e<v.length;e++)if(b===v[e].position&&(!c||c===v[e].method))v[e].fired&&w--,v.splice(e,1)};this._processOnPosition=function(){var b,c;b=v.length;if(!b||!f.playState||w>=b)return!1;for(b-=1;0<=b;b--)c=v[b],!c.fired&&f.position>=c.position&&(c.fired=
!0,w++,c.method.apply(c.scope,[c.position]));return!0};this._resetOnPosition=function(b){var c,e;c=v.length;if(!c)return!1;for(c-=1;0<=c;c--)e=v[c],e.fired&&b<=e.position&&(e.fired=!1,w--);return!0};z=function(){var b=f._iO,c=b.from,e=b.to,d,g;g=function(){p._wD(f.id+': "To" time of '+e+" reached.");f.clearOnPosition(e,g);f.stop()};d=function(){p._wD(f.id+': Playing "from" '+c);if(null!==e&&!isNaN(e))f.onPosition(e,g)};null!==c&&!isNaN(c)&&(b.position=c,b.multiShot=!1,d());return b};t=function(){var b,
c=f._iO.onposition;if(c)for(b in c)if(c.hasOwnProperty(b))f.onPosition(parseInt(b,10),c[b])};y=function(){var b,c=f._iO.onposition;if(c)for(b in c)c.hasOwnProperty(b)&&f.clearOnPosition(parseInt(b,10))};s=function(){f.isHTML5&&Ib(f)};l=function(){f.isHTML5&&Va(f)};g=function(b){b||(v=[],w=0);u=!1;f._hasTimer=null;f._a=null;f._html5_canplay=!1;f.bytesLoaded=null;f.bytesTotal=null;f.duration=f._iO&&f._iO.duration?f._iO.duration:null;f.durationEstimate=null;f.buffered=[];f.eqData=[];f.eqData.left=[];
f.eqData.right=[];f.failures=0;f.isBuffering=!1;f.instanceOptions={};f.instanceCount=0;f.loaded=!1;f.metadata={};f.readyState=0;f.muted=!1;f.paused=!1;f.peakData={left:0,right:0};f.waveformData={left:[],right:[]};f.playState=0;f.position=null;f.id3={}};g();this._onTimer=function(b){var d,g=!1,h={};if(f._hasTimer||b){if(f._a&&(b||(0<f.playState||1===f.readyState)&&!f.paused))d=f._get_html5_duration(),d!==c&&(c=d,f.duration=d,g=!0),f.durationEstimate=f.duration,d=1E3*f._a.currentTime||0,d!==e&&(e=d,
g=!0),(g||b)&&f._whileplaying(d,h,h,h,h);return g}};this._get_html5_duration=function(){var b=f._iO;return(b=f._a&&f._a.duration?1E3*f._a.duration:b&&b.duration?b.duration:null)&&!isNaN(b)&&Infinity!==b?b:null};this._apply_loop=function(b,c){!b.loop&&1<c&&p._wD("Note: Native HTML5 looping is infinite.",1);b.loop=1<c?"loop":""};this._setup_html5=function(b){b=Q(f._iO,b);var c=yb?q:f._a,e=decodeURI(b.url),d;yb?e===decodeURI(gc)&&(d=!0):e===decodeURI(x)&&(d=!0);if(c){if(c._s)if(yb)c._s&&c._s.playState&&
!d&&c._s.stop();else if(!yb&&e===decodeURI(x))return f._apply_loop(c,b.loops),c;d||(g(!1),c.src=b.url,gc=x=f.url=b.url,c._called_load=!1)}else f._a=b.autoLoad||b.autoPlay?new Audio(b.url):Kb&&10>opera.version()?new Audio(null):new Audio,c=f._a,c._called_load=!1,yb&&(q=c);f.isHTML5=!0;f._a=c;c._s=f;h();f._apply_loop(c,b.loops);b.autoLoad||b.autoPlay?f.load():(c.autobuffer=!1,c.preload="auto");return c};h=function(){if(f._a._added_events)return!1;var b;f._a._added_events=!0;for(b in la)la.hasOwnProperty(b)&&
f._a&&f._a.addEventListener(b,la[b],!1);return!0};k=function(){var b;p._wD(f.id+": Removing event listeners");f._a._added_events=!1;for(b in la)la.hasOwnProperty(b)&&f._a&&f._a.removeEventListener(b,la[b],!1)};this._onload=function(b){var c=!!b||!f.isHTML5&&8===A&&f.duration;b=f.id+": ";p._wD(b+(c?"onload()":"Failed to load / invalid sound?"+(!f.duration?" Zero-length duration reported.":" -")+" ("+f.url+")"),c?1:2);!c&&!f.isHTML5&&(!0===p.sandbox.noRemote&&p._wD(b+ha("noNet"),1),!0===p.sandbox.noLocal&&
p._wD(b+ha("noLocal"),1));f.loaded=c;f.readyState=c?3:2;f._onbufferchange(0);f._iO.onload&&hc(f,function(){f._iO.onload.apply(f,[c])});return!0};this._onbufferchange=function(b){if(0===f.playState||b&&f.isBuffering||!b&&!f.isBuffering)return!1;f.isBuffering=1===b;f._iO.onbufferchange&&(p._wD(f.id+": Buffer state change: "+b),f._iO.onbufferchange.apply(f));return!0};this._onsuspend=function(){f._iO.onsuspend&&(p._wD(f.id+": Playback suspended"),f._iO.onsuspend.apply(f));return!0};this._onfailure=function(b,
c,e){f.failures++;p._wD(f.id+": Failures = "+f.failures);if(f._iO.onfailure&&1===f.failures)f._iO.onfailure(f,b,c,e);else p._wD(f.id+": Ignoring failure")};this._onfinish=function(){var b=f._iO.onfinish;f._onbufferchange(0);f._resetOnPosition(0);if(f.instanceCount&&(f.instanceCount--,f.instanceCount||(y(),f.playState=0,f.paused=!1,f.instanceCount=0,f.instanceOptions={},f._iO={},l(),f.isHTML5&&(f.position=0)),(!f.instanceCount||f._iO.multiShotEvents)&&b))p._wD(f.id+": onfinish()"),hc(f,function(){b.apply(f)})};
this._whileloading=function(b,c,e,d){var g=f._iO;f.bytesLoaded=b;f.bytesTotal=c;f.duration=Math.floor(e);f.bufferLength=d;f.durationEstimate=!f.isHTML5&&!g.isMovieStar?g.duration?f.duration>g.duration?f.duration:g.duration:parseInt(f.bytesTotal/f.bytesLoaded*f.duration,10):f.duration;f.isHTML5||(f.buffered=[{start:0,end:f.duration}]);(3!==f.readyState||f.isHTML5)&&g.whileloading&&g.whileloading.apply(f)};this._whileplaying=function(b,c,e,g,h){var k=f._iO;if(isNaN(b)||null===b)return!1;f.position=
Math.max(0,b);f._processOnPosition();!f.isHTML5&&8<A&&(k.usePeakData&&c!==d&&c&&(f.peakData={left:c.leftPeak,right:c.rightPeak}),k.useWaveformData&&e!==d&&e&&(f.waveformData={left:e.split(","),right:g.split(",")}),k.useEQData&&h!==d&&(h&&h.leftEQ)&&(b=h.leftEQ.split(","),f.eqData=b,f.eqData.left=b,h.rightEQ!==d&&h.rightEQ&&(f.eqData.right=h.rightEQ.split(","))));1===f.playState&&(!f.isHTML5&&8===A&&(!f.position&&f.isBuffering)&&f._onbufferchange(0),k.whileplaying&&k.whileplaying.apply(f));return!0};
this._oncaptiondata=function(b){p._wD(f.id+": Caption data received.");f.captiondata=b;f._iO.oncaptiondata&&f._iO.oncaptiondata.apply(f,[b])};this._onmetadata=function(b,c){p._wD(f.id+": Metadata received.");var e={},d,g;d=0;for(g=b.length;d<g;d++)e[b[d]]=c[d];f.metadata=e;f._iO.onmetadata&&f._iO.onmetadata.apply(f)};this._onid3=function(b,c){p._wD(f.id+": ID3 data received.");var e=[],d,g;d=0;for(g=b.length;d<g;d++)e[b[d]]=c[d];f.id3=Q(f.id3,e);f._iO.onid3&&f._iO.onid3.apply(f)};this._onconnect=
function(b){b=1===b;p._wD(f.id+": "+(b?"Connected.":"Failed to connect? - "+f.url),b?1:2);if(f.connected=b)f.failures=0,Pa(f.id)&&(f.getAutoPlay()?f.play(d,f.getAutoPlay()):f._iO.autoLoad&&f.load()),f._iO.onconnect&&f._iO.onconnect.apply(f,[b])};this._ondataerror=function(b){0<f.playState&&(p._wD(f.id+": Data error: "+b),f._iO.ondataerror&&f._iO.ondataerror.apply(f))};this._debug()};Qa=function(){return w.body||w._docElement||w.getElementsByTagName("div")[0]};t=function(b){return w.getElementById(b)};
Q=function(b,c){var e=b||{},f,g;f=c===d?p.defaultOptions:c;for(g in f)f.hasOwnProperty(g)&&e[g]===d&&(e[g]="object"!==typeof f[g]||null===f[g]?f[g]:Q(e[g],f[g]));return e};hc=function(c,e){!c.isHTML5&&8===A?b.setTimeout(e,0):e()};C={onready:1,ontimeout:1,defaultOptions:1,flash9Options:1,movieStarOptions:1};V=function(b,c){var e,f=!0,g=c!==d,h=p.setupOptions;if(b===d){f=[];for(e in h)h.hasOwnProperty(e)&&f.push(e);for(e in C)C.hasOwnProperty(e)&&("object"===typeof p[e]?f.push(e+": {...}"):p[e]instanceof
Function?f.push(e+": function() {...}"):f.push(e));p._wD(ha("setup",f.join(", ")));return!1}for(e in b)if(b.hasOwnProperty(e))if("object"!==typeof b[e]||null===b[e]||b[e]instanceof Array||b[e]instanceof RegExp)g&&C[c]!==d?p[c][e]=b[e]:h[e]!==d?(p.setupOptions[e]=b[e],p[e]=b[e]):C[e]===d?(zb(ha(p[e]===d?"setupUndef":"setupError",e),2),f=!1):p[e]instanceof Function?p[e].apply(p,b[e]instanceof Array?b[e]:[b[e]]):p[e]=b[e];else if(C[e]===d)zb(ha(p[e]===d?"setupUndef":"setupError",e),2),f=!1;else return V(b[e],
e);return f};$a=function(){function c(b){b=za.call(b);var e=b.length;d?(b[1]="on"+b[1],3<e&&b.pop()):3===e&&b.push(!1);return b}function e(b,c){var g=b.shift(),h=[f[c]];if(d)g[h](b[0],b[1]);else g[h].apply(g,b)}var d=b.attachEvent,f={add:d?"attachEvent":"addEventListener",remove:d?"detachEvent":"removeEventListener"};return{add:function(){e(c(arguments),"add")},remove:function(){e(c(arguments),"remove")}}}();la={abort:k(function(){p._wD(this._s.id+": abort")}),canplay:k(function(){var b=this._s,c;
if(b._html5_canplay)return!0;b._html5_canplay=!0;p._wD(b.id+": canplay");b._onbufferchange(0);c=b._iO.position!==d&&!isNaN(b._iO.position)?b._iO.position/1E3:null;if(b.position&&this.currentTime!==c){p._wD(b.id+": canplay: Setting position to "+c);try{this.currentTime=c}catch(e){p._wD(b.id+": canplay: Setting position of "+c+" failed: "+e.message,2)}}b._iO._oncanplay&&b._iO._oncanplay()}),canplaythrough:k(function(){var b=this._s;b.loaded||(b._onbufferchange(0),b._whileloading(b.bytesLoaded,b.bytesTotal,
b._get_html5_duration()),b._onload(!0))}),ended:k(function(){var b=this._s;p._wD(b.id+": ended");b._onfinish()}),error:k(function(){p._wD(this._s.id+": HTML5 error, code "+this.error.code);this._s._onload(!1)}),loadeddata:k(function(){var b=this._s;p._wD(b.id+": loadeddata");!b._loaded&&!Gb&&(b.duration=b._get_html5_duration())}),loadedmetadata:k(function(){p._wD(this._s.id+": loadedmetadata")}),loadstart:k(function(){p._wD(this._s.id+": loadstart");this._s._onbufferchange(1)}),play:k(function(){this._s._onbufferchange(0)}),
playing:k(function(){p._wD(this._s.id+": playing");this._s._onbufferchange(0)}),progress:k(function(b){var c=this._s,e,d,f,g="progress"===b.type,h=b.target.buffered,k=b.loaded||0,l=b.total||1;c.buffered=[];if(h&&h.length){e=0;for(d=h.length;e<d;e++)c.buffered.push({start:1E3*h.start(e),end:1E3*h.end(e)});e=1E3*(h.end(0)-h.start(0));k=Math.min(1,e/(1E3*b.target.duration));if(g&&1<h.length){f=[];d=h.length;for(e=0;e<d;e++)f.push(1E3*b.target.buffered.start(e)+"-"+1E3*b.target.buffered.end(e));p._wD(this._s.id+
": progress, timeRanges: "+f.join(", "))}g&&!isNaN(k)&&p._wD(this._s.id+": progress, "+Math.floor(100*k)+"% loaded")}isNaN(k)||(c._onbufferchange(0),c._whileloading(k,l,c._get_html5_duration()),k&&l&&k===l&&la.canplaythrough.call(this,b))}),ratechange:k(function(){p._wD(this._s.id+": ratechange")}),suspend:k(function(b){var c=this._s;p._wD(this._s.id+": suspend");la.progress.call(this,b);c._onsuspend()}),stalled:k(function(){p._wD(this._s.id+": stalled")}),timeupdate:k(function(){this._s._onTimer()}),
waiting:k(function(){var b=this._s;p._wD(this._s.id+": waiting");b._onbufferchange(1)})};cb=function(b){return!b||!b.type&&!b.url&&!b.serverURL?!1:b.serverURL||b.type&&h(b.type)?!1:b.type?La({type:b.type}):La({url:b.url})||p.html5Only||b.url.match(/data\:/i)};Ab=function(b){var c;b&&(c=Gb&&!sc?null:Qb?"about:blank":null,b.src=c,void 0!==b._called_unload&&(b._called_load=!1));yb&&(gc=null);return c};La=function(b){if(!p.useHTML5Audio||!p.hasHTML5)return!1;var c=b.url||null;b=b.type||null;var e=p.audioFormats,
f;if(b&&p.html5[b]!==d)return p.html5[b]&&!h(b);if(!jb){jb=[];for(f in e)e.hasOwnProperty(f)&&(jb.push(f),e[f].related&&(jb=jb.concat(e[f].related)));jb=RegExp("\\.("+jb.join("|")+")(\\?.*)?$","i")}f=c?c.toLowerCase().match(jb):null;!f||!f.length?b&&(c=b.indexOf(";"),f=(-1!==c?b.substr(0,c):b).substr(6)):f=f[1];f&&p.html5[f]!==d?c=p.html5[f]&&!h(f):(b="audio/"+f,c=p.html5.canPlayType({type:b}),c=(p.html5[f]=c)&&p.html5[b]&&!h(b));return c};Vb=function(){function b(e){var d,f,g=d=!1;if(!c||"function"!==
typeof c.canPlayType)return d;if(e instanceof Array){d=0;for(f=e.length;d<f;d++)if(p.html5[e[d]]||c.canPlayType(e[d]).match(p.html5Test))g=!0,p.html5[e[d]]=!0,p.flash[e[d]]=!!e[d].match(mc);d=g}else e=c&&"function"===typeof c.canPlayType?c.canPlayType(e):!1,d=!(!e||!e.match(p.html5Test));return d}if(!p.useHTML5Audio||!p.hasHTML5)return Ia=p.html5.usingFlash=!0,!1;var c=Audio!==d?Kb&&10>opera.version()?new Audio(null):new Audio:null,e,f,g={},h;h=p.audioFormats;for(e in h)if(h.hasOwnProperty(e)&&(f=
"audio/"+e,g[e]=b(h[e].type),g[f]=g[e],e.match(mc)?(p.flash[e]=!0,p.flash[f]=!0):(p.flash[e]=!1,p.flash[f]=!1),h[e]&&h[e].related))for(f=h[e].related.length-1;0<=f;f--)g["audio/"+h[e].related[f]]=g[e],p.html5[h[e].related[f]]=g[e],p.flash[h[e].related[f]]=g[e];g.canPlayType=c?b:null;p.html5=Q(p.html5,g);p.html5.usingFlash=x();Ia=p.html5.usingFlash;return!0};S={notReady:"Unavailable - wait until onready() has fired.",notOK:"Audio support is not available.",domError:"soundManagerexception caught while appending SWF to DOM.",
spcWmode:"Removing wmode, preventing known SWF loading issue(s)",swf404:"soundManager: Verify that %s is a valid path.",tryDebug:"Try soundManager.debugFlash = true for more security details (output goes to SWF.)",checkSWF:"See SWF output for more debug info.",localFail:"soundManager: Non-HTTP page ("+w.location.protocol+" URL?) Review Flash player security settings for this special case:\nhttp://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html\nMay need to add/allow path, eg. c:/sm2/ or /users/me/sm2/",
waitFocus:"soundManager: Special case: Waiting for SWF to load with window focus...",waitForever:"soundManager: Waiting indefinitely for Flash (will recover if unblocked)...",waitSWF:"soundManager: Waiting for 100% SWF load...",needFunction:"soundManager: Function object expected for %s",badID:'Sound ID "%s" should be a string, starting with a non-numeric character',currentObj:"soundManager: _debug(): Current sound objects",waitOnload:"soundManager: Waiting for window.onload()",docLoaded:"soundManager: Document already loaded",
onload:"soundManager: initComplete(): calling soundManager.onload()",onloadOK:"soundManager.onload() complete",didInit:"soundManager: init(): Already called?",secNote:"Flash security note: Network/internet URLs will not load due to security restrictions. Access can be configured via Flash Player Global Security Settings Page: http://www.macromedia.com/support/documentation/en/flashplayer/help/settings_manager04.html",badRemove:"soundManager: Failed to remove Flash node.",shutdown:"soundManager.disable(): Shutting down",
queue:"soundManager: Queueing %s handler",smError:"SMSound.load(): Exception: JS-Flash communication failed, or JS error.",fbTimeout:"No flash response, applying .swf_timedout CSS...",fbLoaded:"Flash loaded",fbHandler:"soundManager: flashBlockHandler()",manURL:"SMSound.load(): Using manually-assigned URL",onURL:"soundManager.load(): current URL already assigned.",badFV:'soundManager.flashVersion must be 8 or 9. "%s" is invalid. Reverting to %s.',as2loop:"Note: Setting stream:false so looping can work (flash 8 limitation)",
noNSLoop:"Note: Looping not implemented for MovieStar formats",needfl9:"Note: Switching to flash 9, required for MP4 formats.",mfTimeout:"Setting flashLoadTimeout = 0 (infinite) for off-screen, mobile flash case",needFlash:"soundManager: Fatal error: Flash is needed to play some required formats, but is not available.",gotFocus:"soundManager: Got window focus.",policy:"Enabling usePolicyFile for data access",setup:"soundManager.setup(): allowed parameters: %s",setupError:'soundManager.setup(): "%s" cannot be assigned with this method.',
setupUndef:'soundManager.setup(): Could not find option "%s"',setupLate:"soundManager.setup(): url, flashVersion and html5Test property changes will not take effect until reboot().",noURL:"soundManager: Flash URL required. Call soundManager.setup({url:...}) to get started.",sm2Loaded:"SoundManager 2: Ready.",reset:"soundManager.reset(): Removing event callbacks",mobileUA:"Mobile UA detected, preferring HTML5 by default.",globalHTML5:"Using singleton HTML5 Audio() pattern for this device."};ha=function(){var b=
za.call(arguments),c=b.shift(),c=S&&S[c]?S[c]:"",e,d;if(c&&b&&b.length){e=0;for(d=b.length;e<d;e++)c=c.replace("%s",b[e])}return c};eb=function(b){8===A&&1<b.loops&&b.stream&&(D("as2loop"),b.stream=!1);return b};Xa=function(b,c){if(b&&!b.usePolicyFile&&(b.onid3||b.usePeakData||b.useWaveformData||b.useEQData))p._wD((c||"")+ha("policy")),b.usePolicyFile=!0;return b};zb=function(b){tc&&console.warn!==d?console.warn(b):p._wD(b)};y=function(){return!1};xa=function(b){for(var c in b)b.hasOwnProperty(c)&&
"function"===typeof b[c]&&(b[c]=y)};Aa=function(b){b===d&&(b=!1);(G||b)&&p.disable(b)};ya=function(b){if(b)if(b.match(/\.swf(\?.*)?$/i)){if(b.substr(b.toLowerCase().lastIndexOf(".swf?")+4))return b}else b.lastIndexOf("/")!==b.length-1&&(b+="/");b=(b&&-1!==b.lastIndexOf("/")?b.substr(0,b.lastIndexOf("/")+1):"./")+p.movieURL;p.noSWFCache&&(b+="?ts="+(new Date).getTime());return b};ba=function(){A=parseInt(p.flashVersion,10);8!==A&&9!==A&&(p._wD(ha("badFV",A,8)),p.flashVersion=A=8);var b=p.debugMode||
p.debugFlash?"_debug.swf":".swf";p.useHTML5Audio&&!p.html5Only&&(p.audioFormats.mp4.required&&9>A)&&(p._wD(ha("needfl9")),p.flashVersion=A=9);p.version=p.versionNumber+(p.html5Only?" (HTML5-only mode)":9===A?" (AS3/Flash 9)":" (AS2/Flash 8)");8<A?(p.defaultOptions=Q(p.defaultOptions,p.flash9Options),p.features.buffering=!0,p.defaultOptions=Q(p.defaultOptions,p.movieStarOptions),p.filePatterns.flash9=RegExp("\\.(mp3|"+md.join("|")+")(\\?.*)?$","i"),p.features.movieStar=!0):p.features.movieStar=!1;
p.filePattern=p.filePatterns[8!==A?"flash9":"flash8"];p.movieURL=(8===A?"soundmanager2.swf":"soundmanager2_flash9.swf").replace(".swf",b);p.features.peakData=p.features.waveformData=p.features.eqData=8<A};T=function(b,c){if(!r)return!1;r._setPolling(b,c)};ia=function(){p.debugURLParam.test(v)&&(p.debugMode=!0);if(t(p.debugID))return!1;var b,c,e,d;if(p.debugMode&&!t(p.debugID)&&(!tc||!p.useConsole||!p.consoleOnly)){b=w.createElement("div");b.id=p.debugID+"-toggle";c={position:"fixed",bottom:"0px",
right:"0px",width:"1.2em",height:"1.2em",lineHeight:"1.2em",margin:"2px",textAlign:"center",border:"1px solid #999",cursor:"pointer",background:"#fff",color:"#333",zIndex:10001};b.appendChild(w.createTextNode("-"));b.onclick=sa;b.title="Toggle SM2 debug console";u.match(/msie 6/i)&&(b.style.position="absolute",b.style.cursor="hand");for(d in c)c.hasOwnProperty(d)&&(b.style[d]=c[d]);c=w.createElement("div");c.id=p.debugID;c.style.display=p.debugMode?"block":"none";if(p.debugMode&&!t(b.id)){try{e=Qa(),
e.appendChild(b)}catch(f){throw Error(ha("domError")+" \n"+f.toString());}e.appendChild(c)}}};Pa=this.getSoundById;D=function(b,c){return!b?"":p._wD(ha(b),c)};sa=function(){var b=t(p.debugID),c=t(p.debugID+"-toggle");if(!b)return!1;O?(c.innerHTML="+",b.style.display="none"):(c.innerHTML="-",b.style.display="block");O=!O};E=function(c,e,f){if(b.sm2Debugger!==d)try{sm2Debugger.handleEvent(c,e,f)}catch(g){return!1}return!0};Ha=function(){var b=[];p.debugMode&&b.push("sm2_debug");p.debugFlash&&b.push("flash_debug");
p.useHighPerformance&&b.push("high_performance");return b.join(" ")};Ra=function(){var b=ha("fbHandler"),c=p.getMoviePercent(),e={type:"FLASHBLOCK"};if(p.html5Only)return!1;p.ok()?(p.didFlashBlock&&p._wD(b+": Unblocked"),p.oMC&&(p.oMC.className=[Ha(),"movieContainer","swf_loaded"+(p.didFlashBlock?" swf_unblocked":"")].join(" "))):(Ia&&(p.oMC.className=Ha()+" movieContainer "+(null===c?"swf_timedout":"swf_error"),p._wD(b+": "+ha("fbTimeout")+(c?" ("+ha("fbLoaded")+")":""))),p.didFlashBlock=!0,N({type:"ontimeout",
ignoreInit:!0,error:e}),fa(e))};Z=function(b,c,e){K[b]===d&&(K[b]=[]);K[b].push({method:c,scope:e||null,fired:!1})};N=function(b){b||(b={type:p.ok()?"onready":"ontimeout"});if(!H&&b&&!b.ignoreInit||"ontimeout"===b.type&&(p.ok()||G&&!b.ignoreInit))return!1;var c={success:b&&b.ignoreInit?p.ok():!G},e=b&&b.type?K[b.type]||[]:[],d=[],f,c=[c],g=Ia&&!p.ok();b.error&&(c[0].error=b.error);b=0;for(f=e.length;b<f;b++)!0!==e[b].fired&&d.push(e[b]);if(d.length){b=0;for(f=d.length;b<f;b++)d[b].scope?d[b].method.apply(d[b].scope,
c):d[b].method.apply(this,c),g||(d[b].fired=!0)}return!0};ca=function(){b.setTimeout(function(){p.useFlashBlock&&Ra();N();"function"===typeof p.onload&&(D("onload",1),p.onload.apply(b),D("onloadOK",1));p.waitForWindowLoad&&$a.add(b,"load",ca)},1)};Fb=function(){if(Jb!==d)return Jb;var c=!1,e=navigator,f=e.plugins,g,h=b.ActiveXObject;if(f&&f.length)(e=e.mimeTypes)&&e["application/x-shockwave-flash"]&&(e["application/x-shockwave-flash"].enabledPlugin&&e["application/x-shockwave-flash"].enabledPlugin.description)&&
(c=!0);else if(h!==d&&!u.match(/MSAppHost/i)){try{g=new h("ShockwaveFlash.ShockwaveFlash")}catch(k){g=null}c=!!g}return Jb=c};x=function(){var b,c,e=p.audioFormats;if(sc&&u.match(/os (1|2|3_0|3_1)/i))p.hasHTML5=!1,p.html5Only=!0,p.oMC&&(p.oMC.style.display="none");else if(p.useHTML5Audio){if(!p.html5||!p.html5.canPlayType)p._wD("SoundManager: No HTML5 Audio() support detected."),p.hasHTML5=!1;xc&&p._wD("soundManager: Note: Buggy HTML5 Audio in Safari on this OS X release, see https://bugs.webkit.org/show_bug.cgi?id=32159 - "+
(!Jb?" would use flash fallback for MP3/MP4, but none detected.":"will use flash fallback for MP3/MP4, if available"),1)}if(p.useHTML5Audio&&p.hasHTML5)for(c in oa=!0,e)if(e.hasOwnProperty(c)&&e[c].required)if(p.html5.canPlayType(e[c].type)){if(p.preferFlash&&(p.flash[c]||p.flash[e[c].type]))b=!0}else oa=!1,b=!0;p.ignoreFlash&&(b=!1,oa=!0);p.html5Only=p.hasHTML5&&p.useHTML5Audio&&!b;return!p.html5Only};fb=function(b){var c,e,d=0;if(b instanceof Array){c=0;for(e=b.length;c<e;c++)if(b[c]instanceof Object){if(p.canPlayMIME(b[c].type)){d=
c;break}}else if(p.canPlayURL(b[c])){d=c;break}b[d].url&&(b[d]=b[d].url);b=b[d]}return b};Ib=function(b){b._hasTimer||(b._hasTimer=!0,!Lb&&p.html5PollingInterval&&(null===bb&&0===Ka&&(bb=setInterval(Ta,p.html5PollingInterval)),Ka++))};Va=function(b){b._hasTimer&&(b._hasTimer=!1,!Lb&&p.html5PollingInterval&&Ka--)};Ta=function(){var b;if(null!==bb&&!Ka)return clearInterval(bb),bb=null,!1;for(b=p.soundIDs.length-1;0<=b;b--)p.sounds[p.soundIDs[b]].isHTML5&&p.sounds[p.soundIDs[b]]._hasTimer&&p.sounds[p.soundIDs[b]]._onTimer()};
fa=function(c){c=c!==d?c:{};"function"===typeof p.onerror&&p.onerror.apply(b,[{type:c.type!==d?c.type:null}]);c.fatal!==d&&c.fatal&&p.disable()};rc=function(){if(!xc||!Fb())return!1;var b=p.audioFormats,c,e;for(e in b)if(b.hasOwnProperty(e)&&("mp3"===e||"mp4"===e))if(p._wD("soundManager: Using flash fallback for "+e+" format"),p.html5[e]=!1,b[e]&&b[e].related)for(c=b[e].related.length-1;0<=c;c--)p.html5[b[e].related[c]]=!1};this._setSandboxType=function(b){var c=p.sandbox;c.type=b;c.description=c.types[c.types[b]!==
d?b:"unknown"];"localWithFile"===c.type?(c.noRemote=!0,c.noLocal=!1,D("secNote",2)):"localWithNetwork"===c.type?(c.noRemote=!1,c.noLocal=!0):"localTrusted"===c.type&&(c.noRemote=!1,c.noLocal=!1)};this._externalInterfaceOK=function(b){if(p.swfLoaded)return!1;var c;E("swf",!0);E("flashtojs",!0);p.swfLoaded=!0;Bb=!1;xc&&rc();if(!b||b.replace(/\+dev/i,"")!==p.versionNumber.replace(/\+dev/i,""))return c='soundManager: Fatal: JavaScript file build "'+p.versionNumber+'" does not match Flash SWF build "'+
b+'" at '+p.url+". Ensure both are up-to-date.",setTimeout(function(){throw Error(c);},0),!1;setTimeout(B,ga?100:1)};Oa=function(b,c){function e(){var b=[],c,d=[];c="SoundManager "+p.version+(!p.html5Only&&p.useHTML5Audio?p.hasHTML5?" + HTML5 audio":", no HTML5 audio support":"");p.html5Only?p.html5PollingInterval&&b.push("html5PollingInterval ("+p.html5PollingInterval+"ms)"):(p.preferFlash&&b.push("preferFlash"),p.useHighPerformance&&b.push("useHighPerformance"),p.flashPollingInterval&&b.push("flashPollingInterval ("+
p.flashPollingInterval+"ms)"),p.html5PollingInterval&&b.push("html5PollingInterval ("+p.html5PollingInterval+"ms)"),p.wmode&&b.push("wmode ("+p.wmode+")"),p.debugFlash&&b.push("debugFlash"),p.useFlashBlock&&b.push("flashBlock"));b.length&&(d=d.concat([b.join(" + ")]));p._wD(c+(d.length?" + "+d.join(", "):""),1);ob()}function f(b,c){return'<param name="'+b+'" value="'+c+'" />'}if(F&&U)return!1;if(p.html5Only)return ba(),e(),p.oMC=t(p.movieID),B(),U=F=!0,!1;var g=c||p.url,h=p.altURL||g,k=Qa(),l=Ha(),
q=null,q=w.getElementsByTagName("html")[0],r,s,v,q=q&&q.dir&&q.dir.match(/rtl/i);b=b===d?p.id:b;ba();p.url=ya(Rb?g:h);c=p.url;p.wmode=!p.wmode&&p.useHighPerformance?"transparent":p.wmode;if(null!==p.wmode&&(u.match(/msie 8/i)||!ga&&!p.useHighPerformance)&&navigator.platform.match(/win32|win64/i))wa.push(S.spcWmode),p.wmode=null;k={name:b,id:b,src:c,quality:"high",allowScriptAccess:p.allowScriptAccess,bgcolor:p.bgColor,pluginspage:ld+"www.macromedia.com/go/getflashplayer",title:"JS/Flash audio component (SoundManager 2)",
type:"application/x-shockwave-flash",wmode:p.wmode,hasPriority:"true"};p.debugFlash&&(k.FlashVars="debug=1");p.wmode||delete k.wmode;if(ga)g=w.createElement("div"),s=['<object id="'+b+'" data="'+c+'" type="'+k.type+'" title="'+k.title+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="'+ld+'download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0">',f("movie",c),f("AllowScriptAccess",p.allowScriptAccess),f("quality",k.quality),p.wmode?f("wmode",p.wmode):"",f("bgcolor",
p.bgColor),f("hasPriority","true"),p.debugFlash?f("FlashVars",k.FlashVars):"","</object>"].join("");else for(r in g=w.createElement("embed"),k)k.hasOwnProperty(r)&&g.setAttribute(r,k[r]);ia();l=Ha();if(k=Qa())if(p.oMC=t(p.movieID)||w.createElement("div"),p.oMC.id)v=p.oMC.className,p.oMC.className=(v?v+" ":"movieContainer")+(l?" "+l:""),p.oMC.appendChild(g),ga&&(r=p.oMC.appendChild(w.createElement("div")),r.className="sm2-object-box",r.innerHTML=s),U=!0;else{p.oMC.id=p.movieID;p.oMC.className="movieContainer "+
l;r=l=null;p.useFlashBlock||(p.useHighPerformance?l={position:"fixed",width:"8px",height:"8px",bottom:"0px",left:"0px",overflow:"hidden"}:(l={position:"absolute",width:"6px",height:"6px",top:"-9999px",left:"-9999px"},q&&(l.left=Math.abs(parseInt(l.left,10))+"px")));Hc&&(p.oMC.style.zIndex=1E4);if(!p.debugFlash)for(v in l)l.hasOwnProperty(v)&&(p.oMC.style[v]=l[v]);try{ga||p.oMC.appendChild(g),k.appendChild(p.oMC),ga&&(r=p.oMC.appendChild(w.createElement("div")),r.className="sm2-object-box",r.innerHTML=
s),U=!0}catch(y){throw Error(ha("domError")+" \n"+y.toString());}}F=!0;e();return!0};$=function(){if(p.html5Only)return Oa(),!1;if(r)return!1;if(!p.url)return D("noURL"),!1;(r=p.getMovie(p.id))||(Ba?(ga?p.oMC.innerHTML=Ua:p.oMC.appendChild(Ba),Ba=null,F=!0):Oa(p.id,p.url),r=p.getMovie(p.id));"function"===typeof p.oninitmovie&&setTimeout(p.oninitmovie,1);Bc();return!0};R=function(){setTimeout(X,1E3)};X=function(){var c,e=!1;if(!p.url||va)return!1;va=!0;$a.remove(b,"load",R);if(Bb&&!uc)return D("waitFocus"),
!1;H||(c=p.getMoviePercent(),0<c&&100>c&&(e=!0));setTimeout(function(){c=p.getMoviePercent();if(e)return va=!1,p._wD(ha("waitSWF")),b.setTimeout(R,1),!1;H||(p._wD("soundManager: No Flash response within expected time. Likely causes: "+(0===c?"SWF load failed, ":"")+"Flash blocked or JS-Flash security error."+(p.debugFlash?" "+ha("checkSWF"):""),2),!Rb&&c&&(D("localFail",2),p.debugFlash||D("tryDebug",2)),0===c&&p._wD(ha("swf404",p.url),1),E("flashtojs",!1,": Timed out"+Rb?" (Check flash security or flash blockers)":
" (No plugin/missing SWF?)"));!H&&hd&&(null===c?p.useFlashBlock||0===p.flashLoadTimeout?(p.useFlashBlock&&Ra(),D("waitForever")):!p.useFlashBlock&&oa?b.setTimeout(function(){zb("soundManager: useFlashBlock is false, 100% HTML5 mode is possible. Rebooting with preferFlash: false...");p.setup({preferFlash:!1}).reboot();p.didFlashBlock=!0;p.beginDelayedInit()},1):(D("waitForever"),N({type:"ontimeout",ignoreInit:!0})):0===p.flashLoadTimeout?D("waitForever"):Aa(!0))},p.flashLoadTimeout)};na=function(){if(uc||
!Bb)return $a.remove(b,"focus",na),!0;uc=hd=!0;D("gotFocus");va=!1;R();$a.remove(b,"focus",na);return!0};Bc=function(){wa.length&&(p._wD("SoundManager 2: "+wa.join(" "),1),wa=[])};ob=function(){Bc();var b,c=[];if(p.useHTML5Audio&&p.hasHTML5){for(b in p.audioFormats)p.audioFormats.hasOwnProperty(b)&&c.push(b+" = "+p.html5[b]+(!p.html5[b]&&Ia&&p.flash[b]?" (using flash)":p.preferFlash&&p.flash[b]&&Ia?" (preferring flash)":!p.html5[b]?" ("+(p.audioFormats[b].required?"required, ":"")+"and no flash support)":
""));p._wD("SoundManager 2 HTML5 support: "+c.join(", "),1)}};I=function(c){if(H)return!1;if(p.html5Only)return D("sm2Loaded"),H=!0,ca(),E("onload",!0),!0;var e=!0,d;if(!p.useFlashBlock||!p.flashLoadTimeout||p.getMoviePercent())H=!0,G&&(d={type:!Jb&&Ia?"NO_FLASH":"INIT_TIMEOUT"});p._wD("SoundManager 2 "+(G?"failed to load":"loaded")+" ("+(G?"Flash security/load error":"OK")+")",G?2:1);G||c?(p.useFlashBlock&&p.oMC&&(p.oMC.className=Ha()+" "+(null===p.getMoviePercent()?"swf_timedout":"swf_error")),
N({type:"ontimeout",error:d,ignoreInit:!0}),E("onload",!1),fa(d),e=!1):E("onload",!0);G||(p.waitForWindowLoad&&!aa?(D("waitOnload"),$a.add(b,"load",ca)):(p.waitForWindowLoad&&aa&&D("docLoaded"),ca()));return e};z=function(){var b,c=p.setupOptions;for(b in c)c.hasOwnProperty(b)&&(p[b]===d?p[b]=c[b]:p[b]!==c[b]&&(p.setupOptions[b]=p[b]))};B=function(){if(H)return D("didInit"),!1;if(p.html5Only)return H||($a.remove(b,"load",p.beginDelayedInit),p.enabled=!0,I()),!0;$();try{r._externalInterfaceTest(!1),
T(!0,p.flashPollingInterval||(p.useHighPerformance?10:50)),p.debugMode||r._disableDebug(),p.enabled=!0,E("jstoflash",!0),p.html5Only||$a.add(b,"unload",y)}catch(c){return p._wD("js/flash exception: "+c.toString()),E("jstoflash",!1),fa({type:"JS_TO_FLASH_EXCEPTION",fatal:!0}),Aa(!0),I(),!1}I();$a.remove(b,"load",p.beginDelayedInit);return!0};Y=function(){if(Na)return!1;Na=!0;z();ia();var b=null,b=null,c=v.toLowerCase();-1!==c.indexOf("sm2-usehtml5audio=")&&(b="1"===c.charAt(c.indexOf("sm2-usehtml5audio=")+
18),tc&&console.log((b?"Enabling ":"Disabling ")+"useHTML5Audio via URL parameter"),p.setup({useHTML5Audio:b}));-1!==c.indexOf("sm2-preferflash=")&&(b="1"===c.charAt(c.indexOf("sm2-preferflash=")+16),tc&&console.log((b?"Enabling ":"Disabling ")+"preferFlash via URL parameter"),p.setup({preferFlash:b}));!Jb&&p.hasHTML5&&(p._wD("SoundManager: No Flash detected"+(!p.useHTML5Audio?", enabling HTML5.":". Trying HTML5-only mode."),1),p.setup({useHTML5Audio:!0,preferFlash:!1}));Vb();!Jb&&Ia&&(wa.push(S.needFlash),
p.setup({flashLoadTimeout:1}));w.removeEventListener&&w.removeEventListener("DOMContentLoaded",Y,!1);$();return!0};ja=function(){"complete"===w.readyState&&(Y(),w.detachEvent("onreadystatechange",ja));return!0};ta=function(){aa=!0;$a.remove(b,"load",ta)};ra=function(){if(Lb&&((!p.setupOptions.useHTML5Audio||p.setupOptions.preferFlash)&&wa.push(S.mobileUA),p.setupOptions.useHTML5Audio=!0,p.setupOptions.preferFlash=!1,sc||oc&&!u.match(/android\s2\.3/i)))wa.push(S.globalHTML5),sc&&(p.ignoreFlash=!0),
yb=!0};ra();Fb();$a.add(b,"focus",na);$a.add(b,"load",R);$a.add(b,"load",ta);w.addEventListener?w.addEventListener("DOMContentLoaded",Y,!1):w.attachEvent?w.attachEvent("onreadystatechange",ja):(E("onload",!1),fa({type:"NO_DOM2_EVENTS",fatal:!0}))}var e=null;if(void 0===b.SM2_DEFER||!SM2_DEFER)e=new c;b.SoundManager=c;b.soundManager=e})(window);soundManager.url="/universal/scripts-thirdparty/soundmanager2/swf/";soundManager.flashVersion=9;soundManager.useHTML5Audio=!0;soundManager.useFlashBlock=!1;
soundManager.debugMode=!1;soundManager.consoleOnly=!0;soundManager.preferFlash=!1;YUI.add("thirdparty-soundmanager2",function(b){},"2.97.0");
YUI.add("squarespace-dialog-tab",function(b){b.namespace("Squarespace.DialogFields");var d=b.namespace("Squarespace.DialogFields").TabButton=b.namespace("Squarespace.Widgets").TabButton=b.Base.create("tabButton",b.Squarespace.DialogFields.Button,[],{renderUI:function(){d.superclass.renderUI.call(this);this.get("boundingBox").removeClass("sqs-button")}},{CSS_PREFIX:"sqs-tab"})},"1.0",{requires:["base","node","squarespace-dialog-button"]});
YUI.add("squarespace-store-tutorial-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["store-tutorial.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n        <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p="function",q=this;if((c=d["with"].call(c,
c.strings,{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e="\n    ";if((f=d["if"].call(b,b.description,{hash:{},inverse:q.noop,fn:q.program(2,l,c),data:c}))||0===f)e+=f;e+='\n    <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n"},k),data:k}))||0===c)b+=c;return b+'\n\n<div class="settings-panel-fields"></div>\n\n<div class="articles">\n\n    <div class="title">\n        Helpful Articles\n    </div>\n    <div class="article-list">\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/872062">How do I add products to my commerce site?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/936414">How do I add product variants?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/931089">How do I organize my store into product categories?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/919956">How do I embed products elsewhere in my site using the Product Block?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/936903">How do I manage the shipping of my products?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/931168">How do I charge taxes for my products?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/931281">How do I offer coupons?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/931337">How do I create mailing lists from customer email addresses I collect upon checkout?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/936871">How do I notify customers that their orders have been processed/shipped?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/926326">How do I configure my store settings?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/920831">How do I create a Stripe account?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/guides/using-the-donation-block">How do I collect donations?</a><br />\n        <a target="_blank" href="http://help.squarespace.com/customer/portal/topics/392225-commerce/articles">View all articles</a></br />\n\n    </div>\n    <br /><br />\n    <div class="title">\n        Questions or Feedback?\n    </div>\n\n    <div class="article-list">\n        If you have any questions along the way, please do not hesitate to contact us at <strong><a href="http://help.squarespace.com">help.squarespace.com</a></strong>. We look forward to your feedback and suggestions. Enjoy!\n    </div>\n\n</div>'})})();
b.Handlebars.registerPartial("store-tutorial.html".replace("/","."),d.templates["store-tutorial.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-connected-account-capabilities",function(b){var d=b.namespace("Squarespace.ConnectedAccountCapabilities"),c=d.PULL=1,e=d.PUSH=2,f=d.ICON=4,g=d.NONE=0,h={twitter:c|e|f,flickr:c|f,smugmug:f,facebook:f|e,github:f,dropbox:g,instagram:f|c,youtube:f,tumblr:f|e,vimeo:f,pinterest:f,fivehundredpix:f|c,email:f,google:f,dribbble:f,foursquare:f|c,linkedin:f|e};d.can=function(c,e){var d=h[c.get("serviceName")];return!b.Lang.isValue(d)?!1:d&e};d.get=function(b){return h[b.get("serviceName")]}},
"1.0");
YUI.add("squarespace-content-manager-widgets-page",function(b){var d=b.namespace("Squarespace.ContentManagerWidgets").Page=b.Base.create("ContentManagerPage",b.Squarespace.ContentManagerWidgets.Base,[b.WidgetChild,b.Squarespace.ContentManagerWidgets.SaveChangesInHeaderTray,b.Squarespace.Mixins.Recoverable],{initializer:function(){var c=this.get("collection");this._modelLoaded=this._saving=!1;this.pageCollectionData=new b.Squarespace.Models.PageCollectionData({collection:c});this._registerEvent(this.pageCollectionData.after("load",function(){this._modelLoaded=
!0;this.syncUI();if(!c.get("isDemoCollection"))if(this.get("recoverableSourceId"))this.initializeRecoveryBuffer();else this.pageCollectionData.onceAfter("idChange",this.initializeRecoveryBuffer,this)},this));this.pageCollectionData.load();this._registerEvent(c.after("idChange",function(c){this._revertChanges(b.bind(function(){this.syncUI()},this))},this))},handleAddContentRequest:function(){},destructor:function(){this.pageCollectionData.destroy();this._destroyLayout();this.closeOpenDialogs()},renderUI:function(){d.superclass.renderUI.call(this);
this._renderLayoutEl();b.Squarespace.Layout.Help.showIfNeeded()},syncUI:function(){d.superclass.syncUI.call(this);if(!this.get("destroyed")&&this._modelLoaded){var c=this.get("collection"),e=this.get("contentBox").one(".sqs-layout"),f=b.Squarespace.EditControllerWebApp.getInstance(),g=this.pageCollectionData.get("data").get("layout");g.set("collectionId",c.get("id"));c.get("isDemoCollection")?(e.addClass("sqs-editing"),f.pluginLayoutBuilder(e,g)):(f.pluginLayoutEditor(e,g),g.detach(this.get("id")+
"|*"),this._registerEvent(g.on(this.get("id")+"|change",function(b){this._saving||this.markAsDirty()},this)));this.markAsClean()}},_renderLayoutEl:function(){var b=this.get("contentBox"),e=b.one(".sqs-layout");e&&e.remove(!0);b.append('<div class="sqs-layout"></div>')},_saveChanges:function(){return b.Squarespace.Promises.create(function(c,e){this._saving=!0;this.destroyBufferOnSave();this.pageCollectionData.save(b.bind(function(d,g){var h=this.headerTray.get("contentBox").one(".subtitle");h.empty(!0);
if(d){var k="";0===d.code?k="Could not connect":(k=d.responseJSON,k=k.message||k.errorKey);h.setHTML('<span class="error">'+k+"</span>")}else h.setHTML('Last saved <span class="time"></span>.'),h.one(".time").plug(b.Squarespace.RelativeTimeDisplay);this._saving=!1;d?e(d):c()},this))},this)},_revertChanges:function(){return new b.Squarespace.Promises.create(function(b,e){this.destroyBufferOnRevert();this._destroyLayout();this._renderLayoutEl();this._modelLoaded=!1;this.pageCollectionData.load(function(d){d?
e(d):b()})},this)},_destroyLayout:function(){var c=this.get("collection"),e=this.get("contentBox").one(".sqs-layout"),d=b.Squarespace.EditControllerWebApp.getInstance();c.get("isDemoCollection")?d.destroyLayoutBuilder(e):d.destroyLayoutEditor(e)}},{CSS_PREFIX:"sqs-content-manager-page",ATTRS:{addContentButtonVisible:{value:!1},helpSectionIdentifier:{value:"page"},recoveryType:{value:b.Squarespace.RecoveryBufferType.PAGE_COLLECTION_DATA},recoverableField:{getter:function(){return this.pageCollectionData.get("data")}},
recoverableFieldName:{value:"data"},recoverableSourceId:{getter:function(){return this.pageCollectionData.get("id")}},layoutNode:{getter:function(){return this.get("contentBox").one(".sqs-layout")}}}})},"1.0",{requires:"base node squarespace-content-manager-widgets-base squarespace-content-manager-widgets-save-changes-tray squarespace-edit-controller-web-app squarespace-layout-help squarespace-layout-renderable-blocks-web-app squarespace-mixins-recoverable squarespace-models-layout squarespace-ui-base".split(" ")});
YUI.add("squarespace-dialog-statepicker",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.Statepicker=b.Base.create("statepicker",b.Squarespace.DialogField2,[b.WidgetPosition,b.WidgetPositionAlign],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this.stateLabel=b.one(".field-workflow-title");this.stateDesc=b.one(".field-workflow-description");this.buildStateMenu()},onStateChosen:function(c){c=c.currentTarget.getData("state");var e=
this.get("data");b.Object.hasKey(c,"state")&&(e.state=c.state);this.set("data",e)},getStateType:function(){var b=this.get("data"),b=this.get("states")[b.state].stateDesc,b=/\[\s*([^|\]]+?)\s*(?:\|([^]]*))?\s*\]/g.exec(b);return null!==b?String(b[1]).toLowerCase():!1},buildStateMenu:function(){this.get("contentBox");var b=this.get("stateOrder"),e=this.get("states");this._renderStatesObject(e,b)},_renderStatesObject:function(c,e){var d=b.Array.map(e,function(b,e){var d=c[b];d.key=b;return d});b.Array.each(d,
this._renderState,this)},_renderState:function(c,e){var d,g=this.get("data").state;d=b.Lang.sub(this.constructor.OPTION_TEMPLATE,c);var h=this.get("contentBox").one(".workflow-flyout-options");if(!h)throw"No element to attach states to.";d=b.Node.create(d);d.on("click",this.onStateChosen,this);g===c.key&&d.addClass("selected");d.setData("state",{state:c.key});h.appendChild(d)},didDataChange:function(){return objEqual(this.get("data"),this._initialData)}},{CSS_PREFIX:"sqs-statepicker",TEMPLATE:'<div class="workflow-flyout"><div class="workflow-flyout-options"></div></div>',
OPTION_TEMPLATE:'<div class="field-workflow-flyout-option-wrapper"><div class="field-workflow-flyout-option"><div class="field-workflow-title">{title}</div><div class="field-workflow-description">{optionDesc}</div></div></div>',ATTRS:{strings:{},data:{getter:function(c){return b.Lang.isObject(c)?b.merge(c,{}):c}},states:{},stateOrder:{},stateType:{},durationOffset:{value:-1},allowNever:{}}})},"1.0",{requires:["base","base-build","squarespace-dialog-fields","squarespace-dialog-field-2"]});
YUI.add("squarespace-dialog-description",function(b){var d=b.namespace("Squarespace.DialogFields").Description=b.Base.create("descriptionField",b.Squarespace.DialogField2,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("padding");this._descEl=this.get("contentBox").one(".custom-field-description");b.Lang.isArray(c)&&0<c.length&&this._descEl.setStyles({paddingTop:c[0],paddingBottom:c[1]});this._attachNode("title");this._attachNode("text")},bindUI:function(){d.superclass.bindUI.call(this);
this.after(["titleChange","textChange"],this.syncUI,this)},syncUI:function(){d.superclass.syncUI.call(this);this._descEl.empty();this._attachNode("title");this._attachNode("text")},_attachNode:function(c){var e=this.get(c);b.Lang.isString(e)&&0<e.length&&(attrNode=b.Node.create('<div class="'+c+'">'+e+"</div>"),this._descEl.append(attrNode))},_getAsString:function(c){return!b.Lang.isValue(c)?"":c+""},setTitle:function(b){this.set("title",b)},setText:function(b){this.set("text",b)}},{CSS_PREFIX:"sqs-description",
TEMPLATE:'<div class="custom-field-description"></div>',ATTRS:{title:{value:"",getter:this._getAsString},text:{value:"",getter:this._getAsString},className:{value:"",validator:b.Lang.isString},padding:{value:[],validator:b.Lang.isArray},focusable:{value:!1}}})},"1.0.0",{requires:["node","base","squarespace-dialog-field-2"]});
YUI.add("squarespace-plugin-focalpoint",function(b){b.namespace("Squarespace.Plugin").FocalPoint=b.Base.create("ImageFocalPoint",b.Plugin.Base,[b.Squarespace.GismoBase],{initializer:function(){this._renderUI();this._bindUI();this._syncUI()},_renderUI:function(){this._focalPointEl=this.get("relativeYUI").Node.create('<div class="image-focal-point"></div>');this.get("parentNode").appendChild(this._focalPointEl);"static"==this.get("parentNode").getComputedStyle("position")&&console.warn("The parentNode must have a non-static position for FocalPoint to properly work.")},
_bindUI:function(){var b=!1,c=this.get("relativeYUI");this._event(this.get("host").on(["mouseenter","mousemove"],function(b){this._anim(this._focalPointEl,{opacity:1}).run();this._syncUI()},this));this._event(this.get("host").on("mouseleave",function(c){b||c.relatedTarget==this._focalPointEl||this._anim(this._focalPointEl,{opacity:0}).run()},this));this.dd=new c.DD.Drag({node:this._focalPointEl});this.dd.plug(c.Plugin.DDConstrained,{constrain2region:this._getConstrainRegion(!0)});this.dd.on("drag:start",
function(){this.dd.plug(c.Plugin.DDConstrained,{constrain2region:this._getConstrainRegion(!0)});b=!0;this._startPolling()},this);this.dd.on("drag:end",function(){b=!1;this._stopPolling();this._syncUI();this.fire("focalPointChanged",{focalPoint:this.get("focalPoint")})},this);this.tooltip=new c.Squarespace.ToolTip({target:this._focalPointEl,dialogTooltip:!0,title:"Image Focal Point",body:"An image focal point allows Squarespace to make better cropping decisions when the image is placed within a thumbnail. Drag the circle to change the focal point in the image so it displays to your preference."})},
_startPolling:function(){this._hostRegion=this.get("host").get("region");this._hostActualWidth=this.get("host").get("clientWidth");this._hostActualHeight=this.get("host").get("clientHeight");this._timer=b.later(50,this,this._evaluatedFocalPoint,this,{},!0)},_stopPolling:function(){this._evaluatedFocalPoint();this._timer.cancel()},_evaluatedFocalPoint:function(){var b=this._focalPointEl.get("region"),c=b[0]-this._hostRegion[0],e=b[1]-this._hostRegion[1],c=c+b.width/2,e=e+b.height/2,c=c-(this._hostRegion.width-
this._hostActualWidth)/2,e=e-(this._hostRegion.height-this._hostActualHeight)/2;this.set("focalPoint",{x:c/this._hostActualWidth,y:e/this._hostActualHeight},{source:"plugin-focalPoint"})},_syncUI:function(){var b=this.get("host").get("clientWidth"),c=this.get("host").get("clientHeight"),e=b*this.get("focalPoint.x"),f=c*this.get("focalPoint.y"),g=this.get("host").get("region"),e=e+g[0],f=f+g[1],e=e+(g.width-b)/2,f=f+(g.height-c)/2,e=e-this._focalPointEl.get("offsetWidth")/2,f=f-this._focalPointEl.get("offsetHeight")/
2;this._focalPointEl.setXY([e,f])},_getConstrainRegion:function(){var b=this.get("host").get("region"),c=this._focalPointEl.get("offsetWidth"),e=this._focalPointEl.get("offsetHeight"),f=this.get("host").get("offsetWidth")-this.get("host").get("clientWidth"),g=this.get("host").get("offsetHeight")-this.get("host").get("clientHeight");b.top-=c/2-g/2;b.left-=c/2-f/2;b.right+=c/2-f/2;b.bottom+=e/2-g/2;b.width-=f;b.height-=g;return b},destructor:function(){this._focalPointEl.remove();this.dd.destroy();
this.tooltip.destroy()}},{NS:"focalPoint",ATTRS:{focalPoint:{value:{x:0.5,y:0.5},setter:function(d){b.Lang.isUndefined(d)&&console.log("UNDEFINED");if(b.Lang.isString(d)){d=d.split(",");var c=parseFloat(d[0]);d=parseFloat(d[1]);return{x:!isNaN(c)&&1>=c?c:0.5,y:!isNaN(d)&&1>=d?d:0.5}}return d}},parentNode:{valueFn:function(){return this.get("host").get("parentNode")}},relativeYUI:{valueFn:function(){return b.config.win!==window.top&&b.config.doc.body!==this.get("parentNode").ancestor("body").getDOMNode()?
window.top.Y:b}}}})},"1.0",{requires:"base squarespace-gismo dd plugin event-base squarespace-ui-base".split(" ")});
YUI.add("squarespace-plugin-slider-fill",function(b){b.namespace("Squarespace.Plugin").SliderFill=b.Base.create("sliderFill",b.Plugin.Base,[],{initializer:function(){var b=this.get("host");if(b.get("rendered"))this._initializeBar();else b.onceAfter("renderedChange",this._initializeBar,this);b.after("valueChange",this._adjustProgressWidth,this)},destructor:function(){this._progressBar&&this._progressBar.destroy()},_initializeBar:function(){var d=this._getRailNode(),c=b.Node.create('<div class="fill-bar"></div>');
this._measureHeight(d);c.setStyles({height:this._measureHeight(d),width:this._computeBarWidth(),position:"absolute",left:0,top:0});this._progressBar=c;this.get("host").get("contentBox").setStyle("position","relative").append(c)},_getRailNode:function(){return this.get("host").get("contentBox").one(".yui3-slider-rail")},_getThumbNode:function(){return this.get("host").get("contentBox").one(".yui3-slider-thumb")},_computeBarWidth:function(){var b=this.get("host"),b=b.get("value")/b.get("max"),c=this._getRailNode();
return Math.floor(this._measureWidth(c)*b)},_adjustProgressWidth:function(){this._setBarWidth(this._computeBarWidth())},_measureWidth:function(b){return b.get("offsetWidth")-this._measureBorderWidthContribution(b)},_measureBorderWidthContribution:function(b){return parseInt(b.getComputedStyle("borderLeftWidth"),10)+parseInt(b.getComputedStyle("borderRightWidth"),10)},_measureBorderHeightContribution:function(b){return parseInt(b.getComputedStyle("borderTopWidth"),10)+parseInt(b.getComputedStyle("borderBottomWidth"),
10)},_measureHeight:function(b){return b.get("offsetHeight")-this._measureBorderHeightContribution(b)},_setBarWidth:function(b){this._progressBar&&this._progressBar.setStyle("width",b)}},{NS:"sliderFill"})},"1.0",{requires:["base","plugin"]});
YUI.add("squarespace-dialog-statepicker-scheduler",function(b){var d=b.namespace("Squarespace.DialogFields").StateScheduler=b.Base.create("stateScheduler",b.Squarespace.DialogField2,[b.WidgetPosition,b.WidgetPositionAlign,b.WidgetChild,b.WidgetParent],{initializer:function(c){var e=new Date;this.get("contentBox");b.Lang.isValue(c.data)&&(e=new Date(c.data));c=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(e,{format:"%M"}));var d=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(e,{format:"%p"})),g=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(e,
{format:"%l"})),h=this.get("maximumDate");this._widgets=[];this._widgets[0]=new b.Squarespace.DialogFields.InsetCalendar({name:"calendar",maximumDate:h,data:e});this._widgets[1]=new b.Squarespace.DialogFields.InsetTimer({name:"timer",data:{minutes:Number(c),ampm:d,hours:Number(g)}});this._widgets[2]=new b.Squarespace.DialogFields.Slider({name:"slider",range:["duration"===this.get("type")&&this.get("allowNever")?-1:0,90],data:this.get("durationOffset"),labelWidth:0,length:260,visible:"duration"===
this.get("type"),thumbUrl:"/universal/images-v6/dialog/slider-thumb-dark.png"})},destructor:function(){b.Array.each(this._widgets,function(b,e){b.detach();b.destroy()})},renderUI:function(){d.superclass.renderUI.call(this);this.get("data");this.get("type");var c=this.get("contentBox"),e=c.one(".flyout-calendar");c.one(".flyout-title").set("text",this.get("strings.title"));this._widgets[0].render(e);this._widgets[1].render(e);"duration"===this.get("type")&&(this._durationEl=b.Node.create('<div class="duration-wrapper"></div>'),
this._durationEl.append(b.Node.create('<div class="duration-display"><span class="duration"></span></div><div class="slider-container-wrapper"></div>')),c.one(".workflow-flyout-options").append(this._durationEl),this._widgets[2].render(c.one(".slider-container-wrapper")),this._widgets[2].show());e=b.Node.create('<div class="flyout-notch">');"down"===this.get("direction")?(e.addClass("flyout-notch-up"),c.one(".workflow-flyout").prepend(e)):c.one(".workflow-flyout").append(e)},syncUI:function(){d.superclass.syncUI.call(this);
this._widgets[2].get("visible")&&this._durationEl.one(".duration").set("text",this.getShortDurationText())},bindUI:function(){d.superclass.bindUI.call(this);this._registerEvent(this._widgets[0].after("dataChange",this._mergeDateTimeComponents,this));this._registerEvent(this._widgets[1].after("dataChange",this._mergeDateTimeComponents,this));this._registerEvent(this._widgets[2].after("dataChange",this._updateTimeOffset,this));this.after("dataChange",this.syncCalendar,this)},_mergeDateTimeComponents:function(c){c=
this._widgets[0].get("data");var e=b.merge(this._widgets[1].get("data"),{});if(b.Lang.isNull(c))this.get("allowNever")?(this.set("durationOffset",-1),this.set("data",null,{noSyncUI:!0})):this.set("data",Date.now(),{noSyncUI:!0});else{var d=e.ampm,g=e.hours;12===g&&(g=0);"PM"===d&&(g+=12);e=e.minutes;c=b.Squarespace.DateUtils.createWebsiteDate(c.getFullYear(),c.getMonth(),c.getDate(),g,e);this.set("durationOffset",b.Squarespace.DateUtils.calculateFullDayOffset(new Date,c));this.set("data",c,{noSyncUI:!0})}},
_updateTimeOffset:function(b){if(-1===b.newVal&&this.get("allowNever"))this._widgets[0].set("data",null),this._widgets[1].disable();else{this._widgets[1].enable();var e=new Date;e.addDays(b.newVal);this._widgets[0].setAttrs({day:e.getDate(),month:e.getMonth(),year:e.getFullYear(),data:e})}},syncCalendar:function(){var c=new Date(this.get("data")),e=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,{format:"%M"})),d=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,{format:"%p"})),g=b.Lang.trim(b.Squarespace.DateUtils.dateFormat(c,
{format:"%l"}));c.set({hours:0,minutes:0,seconds:0,milliseconds:0});this._widgets[0].setAttrs({day:c.getDate()},{silent:!0});this._widgets[0].setAttrs({month:c.getMonth(),year:c.getFullYear()});this._widgets[1].setAttrs({minutes:Number(e),ampm:d,hours:Number(g)});this._widgets[2].get("visible")&&this._durationEl.one(".duration").set("text",this.getShortDurationText())},getShortDurationText:function(){var c=this.get("data"),c=this.get("allowNever")&&b.Lang.isNull(c),e=this.get("durationOffset");return-1===
e&&c?"Never":0===e?"Today":1==e?"Tomorrow":-1==e?"Yesterday":-1>e?Math.abs(e)+" Days ago":Math.abs(e)+" Days"},getCalendarHeight:function(){return this.get("rendered")?this.get("contentBox").one(".sqs-calendar-flyout").get("offsetHeight"):0}},{CSS_PREFIX:"sqs-scheduler",TEMPLATE:'<div class="workflow-flyout tight sqs-calendar-flyout"><div class="workflow-flyout-options"><div class="flyout-title clear"></div><div class="flyout-calendar clear"></div></div></div>',ATTRS:{allowNever:{value:!1},data:{setter:function(c){return b.Lang.isDate(c)?
c.getTime():c}},day:{value:1,setter:function(b){return parseInt(b,10)}},direction:{value:"up"},durationOffset:{value:0},maximumDate:{},strings:{value:{title:"Select a Date & Time"}},type:{value:"date",validator:function(b){validTypes=["duration","date"];return-1!==validTypes.indexOf(b)}},errorFlyoutAnimationTime:{value:0.01}}})},"1.0",{requires:"base base-build slider squarespace-dialog-fields squarespace-dialog-field-2 squarespace-dialog-slider squarespace-dialog-statepicker-inset-timer squarespace-dialog-statepicker-inset-calendar squarespace-timezone-tools squarespace-date-utils".split(" ")});
YUI.add("squarespace-tab-view-tab-group-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["tab-view-tab-group.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e="\n        ";if((f=d["if"].call(b,b.widgets,{hash:{},inverse:s.program(5,q,c),fn:s.program(3,p,c),data:c}))||0===f)e+=f;return e+"\n      "}function p(b,c){var e,f;e="\n          ";if((f=s.invokePartial(h["tab-view/tab-group.html"],"tab-view/tab-group.html",b,d,h,c))||0===f)e+=f;return e+
"\n        "}function q(b,c){var e,f;e="\n          ";if((f=s.invokePartial(h["tab-view/tab.html"],"tab-view/tab.html",b,d,h,c))||0===f)e+=f;return e+"\n        "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);h=this.merge(h,b.partials);k=k||{};var r,s=this,t=this.escapeExpression;b='<div class="tab-group">\n  <div class="tab-group-label">';(r=d.label)?r=r.call(c,{hash:{},data:k}):(r=c.label,r="function"===typeof r?r.apply(c):r);b+=t(r)+'</div>\n  <div class="tab-group-items">\n    ';
if((r=d["if"].call(c,c.widgets,{hash:{},inverse:s.noop,fn:s.program(1,function(b,c){var e,f;e="\n      ";if((f=d.each.call(b,b.widgets,{hash:{},inverse:s.noop,fn:s.program(2,l,c),data:c}))||0===f)e+=f;return e+"\n    "},k),data:k}))||0===r)b+=r;return b+"\n  </div>\n</div>"})})();b.Handlebars.registerPartial("tab-view-tab-group.html".replace("/","."),d.templates["tab-view-tab-group.html"])},"1.0",{requires:["handlebars-base"]});
var avpw_swfobject=function(){function b(){if(!C){try{var b=E.getElementsByTagName("body")[0].appendChild(E.createElement("span"));b.parentNode.removeChild(b)}catch(c){return}C=!0;for(var b=H.length,e=0;e<b;e++)H[e]()}}function d(b){C?b():H[H.length]=b}function c(b){if(typeof O.addEventListener!=z)O.addEventListener("load",b,!1);else if(typeof E.addEventListener!=z)E.addEventListener("load",b,!1);else if(typeof O.attachEvent!=z)t(O,"onload",b);else if("function"==typeof O.onload){var c=O.onload;O.onload=
function(){c();b()}}else O.onload=b}function e(){var b=E.getElementsByTagName("body")[0],c=E.createElement(B);c.setAttribute("type",A);var e=b.appendChild(c);if(e){var d=0;(function(){if(typeof e.GetVariable!=z){var g=e.GetVariable("$version");g&&(g=g.split(" ")[1].split(","),X.pv=[parseInt(g[0],10),parseInt(g[1],10),parseInt(g[2],10)])}else if(10>d){d++;setTimeout(arguments.callee,10);return}b.removeChild(c);e=null;f()})()}else f()}function f(){var b=G.length;if(0<b)for(var c=0;c<b;c++){var e=G[c].id,
d=G[c].callbackFn,f={success:!1,id:e};if(0<X.pv[0]){var p=s(e);if(p)if(u(G[c].swfVersion)&&!(X.wk&&312>X.wk))w(e,!0),d&&(f.success=!0,f.ref=g(e),d(f));else if(G[c].expressInstall&&h()){f={};f.data=G[c].expressInstall;f.width=p.getAttribute("width")||"0";f.height=p.getAttribute("height")||"0";p.getAttribute("class")&&(f.styleclass=p.getAttribute("class"));p.getAttribute("align")&&(f.align=p.getAttribute("align"));for(var q={},p=p.getElementsByTagName("param"),r=p.length,t=0;t<r;t++)"movie"!=p[t].getAttribute("name").toLowerCase()&&
(q[p[t].getAttribute("name")]=p[t].getAttribute("value"));k(f,q,e,d)}else l(p),d&&d(f)}else w(e,!0),d&&((e=g(e))&&typeof e.SetVariable!=z&&(f.success=!0,f.ref=e),d(f))}}function g(b){var c=null;if((b=s(b))&&"OBJECT"==b.nodeName)typeof b.SetVariable!=z?c=b:(b=b.getElementsByTagName(B)[0])&&(c=b);return c}function h(){return!Z&&u("6.0.65")&&(X.win||X.mac)&&!(X.wk&&312>X.wk)}function k(b,c,e,d){Z=!0;Q=d||null;V={success:!1,id:e};var f=s(e);if(f){"OBJECT"==f.nodeName?(M=p(f),I=null):(M=f,I=e);b.id=K;
if(typeof b.width==z||!/%$/.test(b.width)&&310>parseInt(b.width,10))b.width="310";if(typeof b.height==z||!/%$/.test(b.height)&&137>parseInt(b.height,10))b.height="137";E.title=E.title.slice(0,47)+" - Flash Player Installation";d=X.ie&&X.win?"ActiveX":"PlugIn";d="MMredirectURL="+encodeURI(window.location).toString().replace(/&/g,"%26")+"&MMplayerType="+d+"&MMdoctitle="+E.title;typeof c.flashvars!=z?c.flashvars+="&"+d:c.flashvars=d;X.ie&&(X.win&&4!=f.readyState)&&(d=E.createElement("div"),e+="SWFObjectNew",
d.setAttribute("id",e),f.parentNode.insertBefore(d,f),f.style.display="none",function(){4==f.readyState?f.parentNode.removeChild(f):setTimeout(arguments.callee,10)}());q(b,c,e)}}function l(b){if(X.ie&&X.win&&4!=b.readyState){var c=E.createElement("div");b.parentNode.insertBefore(c,b);c.parentNode.replaceChild(p(b),c);b.style.display="none";(function(){4==b.readyState?b.parentNode.removeChild(b):setTimeout(arguments.callee,10)})()}else b.parentNode.replaceChild(p(b),b)}function p(b){var c=E.createElement("div");
if(X.win&&X.ie)c.innerHTML=b.innerHTML;else if(b=b.getElementsByTagName(B)[0])if(b=b.childNodes)for(var e=b.length,d=0;d<e;d++)(1!=b[d].nodeType||"PARAM"!=b[d].nodeName)&&8!=b[d].nodeType&&c.appendChild(b[d].cloneNode(!0));return c}function q(b,c,e){var d,f=s(e);if(X.wk&&312>X.wk)return d;if(f)if(typeof b.id==z&&(b.id=e),X.ie&&X.win){var g="",h;for(h in b)b[h]!=Object.prototype[h]&&("data"==h.toLowerCase()?c.movie=b[h]:"styleclass"==h.toLowerCase()?g+=' class="'+b[h]+'"':"classid"!=h.toLowerCase()&&
(g+=" "+h+'="'+b[h]+'"'));h="";for(var k in c)c[k]!=Object.prototype[k]&&(h+='<param name="'+k+'" value="'+c[k]+'" />');f.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+g+">"+h+"</object>";aa[aa.length]=b.id;d=s(b.id)}else{k=E.createElement(B);k.setAttribute("type",A);for(var l in b)b[l]!=Object.prototype[l]&&("styleclass"==l.toLowerCase()?k.setAttribute("class",b[l]):"classid"!=l.toLowerCase()&&k.setAttribute(l,b[l]));for(g in c)c[g]!=Object.prototype[g]&&"movie"!=g.toLowerCase()&&
(b=k,h=g,l=c[g],e=E.createElement("param"),e.setAttribute("name",h),e.setAttribute("value",l),b.appendChild(e));f.parentNode.replaceChild(k,f);d=k}return d}function r(b){var c=s(b);c&&"OBJECT"==c.nodeName&&(X.ie&&X.win?(c.style.display="none",function(){if(4==c.readyState){var e=s(b);if(e){for(var d in e)"function"==typeof e[d]&&(e[d]=null);e.parentNode.removeChild(e)}}else setTimeout(arguments.callee,10)}()):c.parentNode.removeChild(c))}function s(b){var c=null;try{c=E.getElementById(b)}catch(e){}return c}
function t(b,c,e){b.attachEvent(c,e);D[D.length]=[b,c,e]}function u(b){var c=X.pv;b=b.split(".");return b[0]=parseInt(b[0],10),b[1]=parseInt(b[1],10)||0,b[2]=parseInt(b[2],10)||0,c[0]>b[0]||c[0]==b[0]&&c[1]>b[1]||c[0]==b[0]&&c[1]==b[1]&&c[2]>=b[2]?!0:!1}function v(b,c,e,d){if(!X.ie||!X.mac){var f=E.getElementsByTagName("head")[0];if(f){e=e&&"string"==typeof e?e:"screen";d&&(N=null,ca=null);if(!N||ca!=e)d=E.createElement("style"),d.setAttribute("type","text/css"),d.setAttribute("media",e),N=f.appendChild(d),
X.ie&&X.win&&typeof E.styleSheets!=z&&0<E.styleSheets.length&&(N=E.styleSheets[E.styleSheets.length-1]),ca=e;X.ie&&X.win?N&&typeof N.addRule==B&&N.addRule(b,c):N&&typeof E.createTextNode!=z&&N.appendChild(E.createTextNode(b+" {"+c+"}"))}}}function w(b,c){if(R){var e=c?"visible":"hidden";C&&s(b)?s(b).style.visibility=e:v("#"+b,"visibility:"+e)}}function y(b){return null!=/[\\\"<>\.;]/.exec(b)&&typeof encodeURIComponent!=z?encodeURIComponent(b):b}var z="undefined",B="object",A="application/x-shockwave-flash",
K="SWFObjectExprInst",O=window,E=document,F=navigator,U=!1,H=[function(){U?e():f()}],G=[],aa=[],D=[],M,I,Q,V,C=!1,Z=!1,N,ca,R=!0,X=function(){var b=typeof E.getElementById!=z&&typeof E.getElementsByTagName!=z&&typeof E.createElement!=z,c=F.userAgent.toLowerCase(),e=F.platform.toLowerCase(),d=e?/win/.test(e):/win/.test(c),e=e?/mac/.test(e):/mac/.test(c),c=/webkit/.test(c)?parseFloat(c.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):!1,f=!1,g=[0,0,0],h=null;if(typeof F.plugins!=z&&typeof F.plugins["Shockwave Flash"]==
B)(h=F.plugins["Shockwave Flash"].description)&&(typeof F.mimeTypes==z||!F.mimeTypes[A]||F.mimeTypes[A].enabledPlugin)&&(U=!0,f=!1,h=h.replace(/^.*\s+(\S+\s+\S+$)/,"$1"),g[0]=parseInt(h.replace(/^(.*)\..*$/,"$1"),10),g[1]=parseInt(h.replace(/^.*\.(.*)\s.*$/,"$1"),10),g[2]=/[a-zA-Z]/.test(h)?parseInt(h.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0);else if(typeof O.ActiveXObject!=z)try{var k=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");k&&(h=k.GetVariable("$version"),h&&(f=!0,h=h.split(" ")[1].split(","),
g=[parseInt(h[0],10),parseInt(h[1],10),parseInt(h[2],10)]))}catch(l){}return{w3:b,pv:g,wk:c,ie:f,win:d,mac:e}}();(function(){X.w3&&((typeof E.readyState!=z&&"complete"==E.readyState||typeof E.readyState==z&&(E.getElementsByTagName("body")[0]||E.body))&&b(),C||(typeof E.addEventListener!=z&&E.addEventListener("DOMContentLoaded",b,!1),X.ie&&X.win&&(E.attachEvent("onreadystatechange",function(){"complete"==E.readyState&&(E.detachEvent("onreadystatechange",arguments.callee),b())}),O==top&&function(){if(!C){try{E.documentElement.doScroll("left")}catch(c){setTimeout(arguments.callee,
0);return}b()}}()),X.wk&&function(){C||(/loaded|complete/.test(E.readyState)?b():setTimeout(arguments.callee,0))}(),c(b)))})();(function(){X.ie&&X.win&&window.attachEvent("onunload",function(){for(var b=D.length,c=0;c<b;c++)D[c][0].detachEvent(D[c][1],D[c][2]);b=aa.length;for(c=0;c<b;c++)r(aa[c]);for(var e in X)X[e]=null;X=null;for(var d in avpw_swfobject)avpw_swfobject[d]=null;avpw_swfobject=null})})();return{registerObject:function(b,c,e,d){if(X.w3&&b&&c){var f={};f.id=b;f.swfVersion=c;f.expressInstall=
e;f.callbackFn=d;G[G.length]=f;w(b,!1)}else d&&d({success:!1,id:b})},getObjectById:function(b){if(X.w3)return g(b)},embedSWF:function(b,c,e,f,g,l,p,r,s,t){var v={success:!1,id:c};X.w3&&!(X.wk&&312>X.wk)&&b&&c&&e&&f&&g?(w(c,!1),d(function(){e+="";f+="";var d={};if(s&&typeof s===B)for(var y in s)d[y]=s[y];d.data=b;d.width=e;d.height=f;y={};if(r&&typeof r===B)for(var A in r)y[A]=r[A];if(p&&typeof p===B)for(var D in p)typeof y.flashvars!=z?y.flashvars+="&"+D+"="+p[D]:y.flashvars=D+"="+p[D];if(u(g))A=
q(d,y,c),d.id==c&&w(c,!0),v.success=!0,v.ref=A;else{if(l&&h()){d.data=l;k(d,y,c,t);return}w(c,!0)}t&&t(v)})):t&&t(v)},switchOffAutoHideShow:function(){R=!1},ua:X,getFlashPlayerVersion:function(){return{major:X.pv[0],minor:X.pv[1],release:X.pv[2]}},hasFlashPlayerVersion:u,createSWF:function(b,c,e){return X.w3?q(b,c,e):void 0},showExpressInstall:function(b,c,e,d){X.w3&&h()&&k(b,c,e,d)},removeSWF:function(b){X.w3&&r(b)},createCSS:function(b,c,e,d){X.w3&&v(b,c,e,d)},addDomLoadEvent:d,addLoadEvent:c,getQueryParamValue:function(b){var c=
E.location.search||E.location.hash;if(c){/\?/.test(c)&&(c=c.split("?")[1]);if(null==b)return y(c);for(var c=c.split("&"),e=0;e<c.length;e++)if(c[e].substring(0,c[e].indexOf("="))==b)return y(c[e].substring(c[e].indexOf("=")+1))}return""},expressInstallCallback:function(){if(Z){var b=s(K);b&&M&&(b.parentNode.replaceChild(M,b),I&&(w(I,!0),X.ie&&X.win&&(M.style.display="block")),Q&&Q(V));Z=!1}}}}();
(function(b,d,c){var e=/\s+/;b.Events={on:function(b,c,d){var k,l;if(!c)return this;b=b.split(e);for(k=this._callbacks||(this._callbacks={});l=b.shift();)l=k[l]||(k[l]=[]),l.push(c,d);return this},off:function(b,c,d){var k,l,p;if(!(l=this._callbacks))return this;if(!b&&!c&&!d)return delete this._callbacks,this;for(b=b?b.split(e):_.keys(l);k=b.shift();)if(!(p=l[k])||!c&&!d)delete l[k];else for(k=p.length-2;0<=k;k-=2)c&&p[k]!==c||d&&p[k+1]!==d||p.splice(k,2);return this},trigger:function(b){var c,d,
k,l,p,q,r;if(!(d=this._callbacks))return this;r=[];b=b.split(e);l=1;for(p=arguments.length;l<p;l++)r[l-1]=arguments[l];for(;c=b.shift();){if(q=d.all)q=q.slice();if(k=d[c])k=k.slice();if(k){l=0;for(p=k.length;l<p;l+=2)k[l].apply(k[l+1]||this,r)}if(q){c=[c].concat(r);l=0;for(p=q.length;l<p;l+=2)q[l].apply(q[l+1]||this,c)}}return this}}})(window.AV||(window.AV={}),window,document);"undefined"==typeof AV&&(AV={});AV.JSON={};
(function(){function b(b){return 10>b?"0"+b:b}function d(b){return f.lastIndex=0,f.test(b)?'"'+b.replace(f,function(b){var c=k[b];return"string"==typeof c?c:"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+b+'"'}function c(b,e){var f,k,t,u,v=g,w,y=e[b];y&&"object"==typeof y&&"function"==typeof y.toJSON&&(y=y.toJSON(b));"function"==typeof l&&(y=l.call(e,b,y));switch(typeof y){case "string":return d(y);case "number":return isFinite(y)?String(y):"null";case "boolean":case "null":return String(y);
case "object":if(!y)return"null";g+=h;w=[];if("[object Array]"===Object.prototype.toString.apply(y)){u=y.length;for(f=0;f<u;f+=1)w[f]=c(f,y)||"null";return t=0===w.length?"[]":g?"[\n"+g+w.join(",\n"+g)+"\n"+v+"]":"["+w.join(",")+"]",g=v,t}if(l&&"object"==typeof l){u=l.length;for(f=0;f<u;f+=1)k=l[f],"string"==typeof k&&(t=c(k,y),t&&w.push(d(k)+(g?": ":":")+t))}else for(k in y)Object.hasOwnProperty.call(y,k)&&(t=c(k,y),t&&w.push(d(k)+(g?": ":":")+t));return t=0===w.length?"{}":g?"{\n"+g+w.join(",\n"+
g)+"\n"+v+"}":"{"+w.join(",")+"}",g=v,t}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(c){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+b(this.getUTCMonth()+1)+"-"+b(this.getUTCDate())+"T"+b(this.getUTCHours())+":"+b(this.getUTCMinutes())+":"+b(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(b){return this.valueOf()});var e=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
f=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,g,h,k={"\b":"\\b"," ":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!=typeof AV.JSON.stringify&&(AV.JSON.stringify=function(b,e,d){var f;h=g="";if("number"==typeof d)for(f=0;f<d;f+=1)h+=" ";else"string"==typeof d&&(h=d);l=e;if(!e||"function"==typeof e||"object"==typeof e&&"number"==typeof e.length)return c("",{"":b});throw Error("AV.JSON.stringify");
});"function"!=typeof AV.JSON.parse&&(AV.JSON.parse=function(b,c){function d(b,e){var f,g,h=b[e];if(h&&"object"==typeof h)for(f in h)Object.hasOwnProperty.call(h,f)&&(g=d(h,f),void 0!==g?h[f]=g:delete h[f]);return c.call(b,e,h)}var f;b=String(b);e.lastIndex=0;e.test(b)&&(b=b.replace(e,function(b){return"\\u"+("0000"+b.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(b.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return f=eval("("+b+")"),"function"==typeof c?d({"":f},""):f;throw new SyntaxError("AV.JSON.parse");})})();
(function(b){b.build={version:"3.1.0.223",bundled:!1,MINIMUM_FLASH_PLAYER_VERSION:"10.2.0",feather_baseURL:"http://feather.aviary.com/3.1.0.223/",feather_baseURL_SSL:"https://dme0ih8comzn4.cloudfront.net/3.1.0.223/",feather_stickerURL:"http://feather.aviary.com/stickers/",feather_stickerURL_SSL:"https://dme0ih8comzn4.cloudfront.net/stickers/",imgrecvBase:"http://featherservices.aviary.com/",imgrecvBase_SSL:"https://featherservices.aviary.com/",featherTargetAnnounce:"http://featherservices.aviary.com/feather_target_announce_v3.html",
featherTargetAnnounce_SSL:"https://featherservices.aviary.com/feather_target_announce_v3.html",imgrecvServer:"http://featherservices.aviary.com/FeatherReceiver.aspx",imgrecvServer_SSL:"https://featherservices.aviary.com/FeatherReceiver.aspx",jsonp_imgserver:"http://featherservices.aviary.com/imgjsonpserver.aspx",jsonp_imgserver_SSL:"https://featherservices.aviary.com/imgjsonpserver.aspx",proxyServer:"http://featherservices.aviary.com/proxy.aspx",proxyServer_SSL:"https://featherservices.aviary.com/proxy.aspx",
asyncImgrecvBase:"http://api.aviary.com/",asyncImgrecvBase_SSL:"https://api.aviary.com/",partnerAssetURL:"http://api.aviary.com/getassets",partnerAssetURL_SSL:"https://api.aviary.com/getassets",asyncFeatherTargetAnnounce:"http://api.aviary.com/feather_target_announce_v3.html",asyncFeatherTargetAnnounce_SSL:"https://api.aviary.com/feather_target_announce_v3.html",asyncImgrecvCreateJob:"http://api.aviary.com/createjob",asyncImgrecvCreateJob_SSL:"https://api.aviary.com/createjob",asyncImgrecvGetJobStatus:"http://api.aviary.com/getjobstatus",
asyncImgrecvGetJobStatus_SSL:"https://api.aviary.com/getjobstatus",imgtrackServer:"http://featherservices.aviary.com/featherlog.aspx",imgtrackServer_SSL:"https://featherservices.aviary.com/featherlog.aspx",googleTracker:"UA-84575-16",inAppPurchaseFrameURL:"http://purchases.viary.com/gateway.aspx?p=flickr",filterServer:"http://featherservices.aviary.com/moa.ashx",filterServer_SSL:"https://featherservices.aviary.com/moa.ashx",featherFilterAnnounce:"http://featherservices.aviary.com/feather_filter_announce.html",
featherFilterAnnounce_SSL:"https://featherservices.aviary.com/feather_filter_announce.html"}})(AV=window.AV||{});"undefined"==typeof AV&&(AV={});AV.validLanguages={en:!0,zh_hant:!0,nl:!0,fr:!0,de:!0,it:!0,ja:!0,ko:!0,pl:!0,pt_br:!0,ru:!0,es:!0,android:!0,bg:!0,zh_hans:!0,cs:!0,da:!0,fi:!0,el:!0,he:!0,hu:!0,id:!0,no:!0,pt:!0,sk:!0,sv:!0,tr:!0,vi:!0,lv:!0,lt:!0,ca:!0,sl:!0};
(function(b,d,c){b.util={getX:function(b){for(var c=0;null!=b;)c+=b.offsetLeft,b=b.offsetParent;return c},getY:function(b){for(var c=0;null!=b;)c+=b.offsetTop,b=b.offsetParent;return c},getTouch:function(b){b.originalEvent&&(b=b.originalEvent);return b.changedTouches&&1==b.changedTouches.length?b.changedTouches[0]:b.touches&&1==b.touches.length?b.touches[0]:!1},getScaledDims:function(b,c,d,h){h=h||d;var k=b,l=c,p=b/c;if(b>d||c>h)b-d>p*(c-h)?(k=d,l=d*c/b+0.5|0):(k=h*p+0.5|0,l=h);return{width:k,height:l}},
nextFrame:function(b){setTimeout(b,1)},getDomain:function(b,c){var d,h,k;d="http://"==b.substr(0,7)?7:"https://"==b.substr(0,8)?8:"ftp://"==b.substr(0,6)?6:0;h=b.indexOf("/",d);-1==h&&(h=b.length);c||(k=b.lastIndexOf(":"),k=k>d?b.substring(d,k):b.substring(d,h),k.match(/^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$/)||(k=b.lastIndexOf(".",h),k=b.lastIndexOf(".",k-1),d=-1==k?d:k+1));return b.substring(d,h)},extend:function(){var b,c,d,h,k,l=arguments[0]||{},p=1,q=arguments.length,r=!1;"boolean"===typeof l&&(r=l,
l=arguments[1]||{},p=2);"object"!==typeof l&&!jQuery.isFunction(l)&&(l={});q===p&&(l=this,--p);for(;p<q;p++)if(null!=(b=arguments[p]))for(c in b)d=l[c],h=b[c],l!==h&&(r&&h&&(jQuery.isPlainObject(h)||(k=jQuery.isArray(h)))?(k?(k=!1,d=d&&jQuery.isArray(d)?d:[]):d=d&&jQuery.isPlainObject(d)?d:{},l[c]=jQuery.extend(r,d,h)):void 0!==h&&(l[c]=h));return l},findItemByKeyValueFromArray:function(b,c,d){var h,k;for(h=0;h<d.length;h++)if(d[h]&&d[h][b]&&d[h][b]===c){k=d[h];break}return k},loadFile:function(){var b,
d,g=0,h;b=function(b,c){if(c){var e=function(b){(4==this.readyState||"complete"==this.readyState||"loaded"==this.readyState)&&c(b)};"Microsoft Internet Explorer"==navigator.appName?b.onreadystatechange=e:b.onload=c}};return function(k,l,p){var q;"js"==l?(q=c.createElement("script"),q.setAttribute("type","text/javascript"),b(q,p),q.setAttribute("src",k)):"css"==l?c.createStyleSheet?c.createStyleSheet(k,g++):(q=c.createElement("link"),q.setAttribute("rel","stylesheet"),q.setAttribute("type","text/css"),
q.setAttribute("href",k)):"img"==l&&(q=c.createElement("img"),b(q,p),q.setAttribute("src",k));q&&(d=d||c.getElementsByTagName("head")[0],"js"==l?d.appendChild(q):"css"==l&&(h=h||c.createDocumentFragment(),h.appendChild(q),d.insertBefore(q,void 0)));return q}}(),getImageElem:function(b){return"string"==typeof b?c.getElementById(b):b.length?b[0]:b},getImageId:function(b){return"string"==typeof b?b:b.id},imgOnLoad:function(b,c){var d=avpw$(b);d.load(c);(!0==d[0].complete||4==d[0].readyState||"complete"==
d[0].readyState||"loaded"==d[0].readyState)&&d.trigger("load")},color_is_white:function(b){b=b.toLowerCase();return"#fff"==b||"#ffffff"==b||"white"==b||"rgb(255,255,255)"==b||"rgb(255, 255, 255)"==b},color_is_light:function(c){c=b.util.color_to_array(c);return 127.5<0.2*c[0]+0.7*c[1]+0.1*c[2]},color_expand:function(b){var c,d;4==b.length&&(c=b.charAt(1),d=b.charAt(2),b=b.charAt(3),b="#"+c+c+d+d+b+b);return b},color_to_array:function(c){var d,g,h;"#"==c.charAt(0)?(c=b.util.color_expand(c),d=parseInt(c.substr(1,
2),16),g=parseInt(c.substr(3,2),16),h=parseInt(c.substr(5,2),16)):"r"==c.charAt(0).toLowerCase()&&(c=b.util.rgb_to_color(c),d=parseInt(c.substr(1,2),16),g=parseInt(c.substr(3,2),16),h=parseInt(c.substr(5,2),16));return c=[d,g,h,1]},array_to_color:function(c){c=b.util.array_to_rgb(c);return c=b.util.rgb_to_color(c)},array_to_rgb:function(b){var c="rgb(0,0,0)";b.join&&(3<b.length&&(b=b.slice(0,3)),c="rgb("+b.join(",")+")");return c},color_to_rgb:function(c){c=b.util.color_to_array(c);return c=b.util.array_to_rgb(c)},
rgb_to_color:function(b){var c,d;return(d=b.match(/\s*rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/))?(b=parseInt(d[1]).toString(16),1==b.length&&(b="0"+b),c=parseInt(d[2]).toString(16),1==c.length&&(c="0"+c),d=parseInt(d[3]).toString(16),1==d.length&&(d="0"+d),"#"+b+c+d):b},color_to_int:function(c){c=b.util.color_expand(c);c=b.util.rgb_to_color(c);return parseInt(c.substr(1),16)},loadImagesSync:function(c,d){for(var g=0,h=c.length,k=0;k<h;k++){var l=c[k].img,p=c[k].src;l.onload=function(){g++;d&&g==
c.length&&b.util.nextFrame(d)};l.src=p}},getApiVersion:function(b){return b&&b.apiVersion?parseInt(b.apiVersion,10):1},getUserFriendlyToolName:function(b){var c={overlay:"Stickers",drawing:"Draw",textwithfont:"Text",colorsplash:"Splash",tiltshift:"Tilt Shift",forcecrop:"Crop"},d="";b&&(d=c[b]||b.substr(0,1).toUpperCase()+b.substr(1));return d},keyDownHandlerNumber:function(b,c){9==b.keyCode||(27==b.keyCode||65==b.keyCode&&(!0===b.ctrlKey||!0===b.metaKey)||35<=b.keyCode&&39>=b.keyCode)||((48>b.keyCode||
57<b.keyCode)&&(96>b.keyCode||105<b.keyCode)&&46!==b.keyCode&&8!==b.keyCode?b.preventDefault():c&&c.apply(this,[b]))},addFontToPage:function(c,d){c||d&&d();var g=c.value;if(c.system)d&&d(c);else if(b.WebFont){var h={loading:function(){b.controlsWidgetInstance&&b.controlsWidgetInstance.showWaitThrobber(!0)},active:function(){b.controlsWidgetInstance&&b.controlsWidgetInstance.showWaitThrobber(!1);d&&d(c)},inactive:function(){b.controlsWidgetInstance&&b.controlsWidgetInstance.showWaitThrobber(!1);b.errorNotify("UNSUPPORTED_FONT",
[g]);d&&d()}};c.custom?(h.custom={families:[g],urls:[c.url]},h.active=function(){b.controlsWidgetInstance&&b.controlsWidgetInstance.showWaitThrobber(!1);d&&b.util.nextFrame(function(){d(c)},500)}):h.google={families:[g]};b.WebFont.load(h)}}}})(window.AV||(window.AV={}),window,document);"undefined"===typeof AV&&(AV={});
AV.FlashAPI=function(){var b=null,d=function(){return function(b,c,e,d,l){l=l||{};var p={quality:"high",bgcolor:"#808080",allowscriptaccess:"always",allowfullscreen:"true"},q={};q.id=b;q.name=b;AV.msie&&9>AV.msie&&(q.align="center");b+="_replace";var r;e=(e||"100%")+"";r=(d||"100%")+"";d={};if(q&&"object"===typeof q)for(var s in q)d[s]=q[s];d.data=c;d.width=e;d.height=r;c={};if(p&&"object"===typeof p)for(var t in p)c[t]=p[t];if(l&&"object"===typeof l)for(var u in l)c.flashvars="undefined"!=typeof c.flashvars?
c.flashvars+("&"+u+"="+l[u]):u+"="+l[u];if(p=document.getElementById(b))if("undefined"==typeof d.id&&(d.id=b),AV.msie){var v="",w;for(w in d)d[w]!=Object.prototype[w]&&("data"==w.toLowerCase()?c.movie=d[w]:"styleclass"==w.toLowerCase()?v+=' class="'+d[w]+'"':"classid"!=w.toLowerCase()&&(v+=" "+w+'="'+d[w]+'"'));w="";for(var y in c)c[y]!=Object.prototype[y]&&(w+='<param name="'+y+'" value="'+c[y]+'" />');p.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+v+">"+w+"</object>";
"undefined"==typeof objIdArr&&(objIdArr=[]);objIdArr[objIdArr.length]=d.id}else{y=document.createElement("object");y.setAttribute("type","application/x-shockwave-flash");for(var z in d)d[z]!=Object.prototype[z]&&("styleclass"==z.toLowerCase()?y.setAttribute("class",d[z]):"classid"!=z.toLowerCase()&&y.setAttribute(z,d[z]));for(v in c)c[v]!=Object.prototype[v]&&"movie"!=v.toLowerCase()&&(w=y,z=v,b=c[v],d=document.createElement("param"),d.setAttribute("name",z),d.setAttribute("value",b),w.appendChild(d));
p.parentNode.replaceChild(y,p)}}}(),c=function(){};c.prototype=function(){return{getPlugins:function(){return[]},createCanvas:function(){this.initsize?d("avpw_canvas_swf",AV.build.feather_baseURL+"canvas.swf",this.initsize.width,this.initsize.height):d("avpw_canvas_swf",AV.build.feather_baseURL+"canvas.swf")},_onComponentLoaded:function(b){switch(b){case "canvas":b=document.getElementById("avpw_canvas_swf"),AV.FlashAPI._onCanvasLoaded(b)}},_onComponentReady:function(b){var c=AV.paintWidgetInstance;
"canvas"===b&&c.canvasReadyCallback&&c.canvasReadyCallback.resolve()}}}();var e=function(){var b=[];return{init:function(){for(var c=0;256>c;c++)b[c]=String.fromCharCode(c);b[0]=String.fromCharCode(1)+String.fromCharCode(1);b[1]=String.fromCharCode(1)+String.fromCharCode(2)},shutdown:function(){b=[]},decode:function(b,c,e){c=[];for(var d,f=e=0,q=[0,0,1];f<b.length;)c[e++]=1!=(d=b.charCodeAt(f++))?d:q[b.charCodeAt(f++)];return c},encode:function(c){for(var e="",d=0;d<c.length;d+=4)e+=b[c[d+3]],e+=
b[c[d]],e+=b[c[d+1]],e+=b[c[d+2]];return e}}}();return function(){var d=!1,g=!1;return{mapToFlashToolName:function(b){switch(b){case "rotate":return"rotate90"}return b},mapFromFlashToolName:function(b){switch(b){case "rotate90":return"rotate"}return b},customBridge:function(b){var e=function(){};e.prototype=new c;e.prototype.constructor=c;for(var d in b)e.prototype[d]=b[d];return e},activate:function(b){this.bridge=b||new c;this.goldenEggCallback=null},setHiresSize:function(b,c){this.canvas&&this.canvas.setHiresSize(b,
c)},hiresSizeChanged:function(b,c){AV.paintWidgetInstance&&AV.paintWidgetInstance.actions&&AV.paintWidgetInstance.actions.setDims(b,c)},startEditing:function(b){this.canvas=null;this.active_target=b;this.bridge.createCanvas()},restartEditing:function(b){this.active_target=b;this._setupEditing()},close:function(){},runGoldenEgg:function(b,c,e,d){this.goldenEggCallback=d;this.canvas.renderGoldenEgg(b,c,e)},doCrop:function(){this.canvas.executeCrop()},activatePlugin:function(b){this.canvas.activatePlugin(b)},
deactivatePlugin:function(b){this.canvas.deactivatePlugin(b)},changeProperty:function(b,c){this.canvas.changeProperty(b,c)},applyPreviewFromPlugin:function(b){this.canvas.applyPreviewFromPlugin(b)},commitChangesFromPlugin:function(b){this.canvas.commitChangesFromPlugin(b)},discardChangesFromPlugin:function(b){this.canvas.discardChangesFromPlugin(b)},resizeCanvas:function(b,c){var e=this.canvas;e.width=b+"px";e.height=c+"px";AV.paintWidgetInstance&&AV.paintWidgetInstance.setDimensions(b,c)},hideCanvas:function(){this.canvas&&
(this.canvas.style.visibility="hidden")},showCanvas:function(){this.canvas&&(this.canvas.style.visibility="visible")},executePlugin:function(){this.canvas.executePlugin()},renderPreview:function(b,c){this.canvas.renderPreview(b,c)},getDynamicPropertyDefaultValue:function(b){return this.canvas.getDynamicPropertyDefaultValue(b)},syncProperty:function(b,c){},syncPreview:function(b){},setCanvasDataArray:function(b,c,e){AV.canvasDataReceiver&&AV.canvasDataReceiver.apply(this,[b,c,e])},setThumb:function(b,
c){},getHistory:function(){return this.canvas.getHistory()},getHiResStickerUrl:function(b){return AV.paintWidgetInstance&&AV.paintWidgetInstance.overlayRegistry?AV.paintWidgetInstance.overlayRegistry.getHiRes(b):null},getImageData:function(c,e){e&&"function"===typeof e&&(b=e);this.canvas.commit({})},getMaxSize:function(){return AV.launchData.maxEditSize||AV.launchData.maxSize},getMaxBitmapSize:function(){return AV.launchData.maxSize},_cropSelectionStarted:function(b,c,e){},_onPreviewRendered:function(b,
c){},_onPluginLoaded:function(b,c){var e=AV.paintWidgetInstance;e.moduleLoadedCallback&&e.moduleLoadedCallback[b]&&e.moduleLoadedCallback[b].resolve()},_onImageLoaded:function(b,c){AV.paintWidgetLauncher_Flash_stage2&&AV.paintWidgetLauncher_Flash_stage2(b,c)},_onGoldenEggComplete:function(){this.goldenEggCallback&&this.goldenEggCallback()},_onCanvasLoaded:function(b){this.canvas=b;this._setupEditing(AV.launchData.url||null)},_onGetImageDataComplete:function(c){b&&(b.apply(this,[c]),b=null)},_setupEditing:function(b){var c=
this.bridge.getPlugins();b=b||this.active_target.src;this.canvas.setup(b,AV.build.proxyServer,c)},_canUndo:function(){return d},_onUndo:function(){this.canvas.undo()},_canRedo:function(){return g},_onRedo:function(){this.canvas.redo()},_onHistoryChange:function(b,c){d=b;g=c;AV.controlsWidgetInstance&&AV.controlsWidgetInstance.layoutNotify(AV.launchData.openType,"updateUndoRedo",[b,c])},setCheckpoint:function(b){this.canvas.setCheckpoint(b)},isACheckpoint:function(b){return this.canvas.isACheckpoint(b)},
undoToCheckpoint:function(){this.canvas.undoToCheckpoint()},redoToCheckpoint:function(){return this.canvas.redoToCheckpoint()},truncateActionList:function(){this.canvas.truncateActionList()},_onError:function(b,c){"BAD_IMAGE"===b&&(AV.paintWidgetCloser(!0),AV.launchData.url&&(b="BAD_URL"));AV.errorNotify(b,c)},init:function(b){AV.FlashAPI.activate(function(){if(!b)return new c;if(b.plugins){for(var e=[],d=b.plugins,f=0;f<d.length;++f){var g=AV.FlashAPI.mapToFlashToolName(d[f]),r=AV.toolDefaults[d[f]];
r&&r.files&&e.push({id:g,presets:r.presetsFlash,files:r.files})}0<e.length&&(b.getPlugins=function(){return e});delete b.plugins}d=function(){};d.prototype=new c;d.prototype.constructor=c;for(var s in b)d.prototype[s]=b[s];return new d}());e.init()},pibeca:e}}()}();
(function(b,d,c){b.AV=b.AV||{};var e=b.AV;e.ImageSizeTracker=function(b){var c=this;c.setImageScaledIndicator=function(){e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"updateImageScaledIndicator")};c.setOrigSize=function(b,d,f){var p;if(b.hiresWidth&&b.hiresHeight)p=parseInt(b.hiresWidth,10),b=parseInt(b.hiresHeight,10);else if(b.hiresUrl)p=d.width,b=d.height;else if(b.displayImageSize)p=f.width,b=f.height;else return null;e.paintWidgetInstance.actions.setOrigSize(p,b);c.setImageScaledIndicator();
return{width:p,height:b}};c.isDisplayingImageSize=function(b){return b.hiresWidth||b.hiresHeight||b.displayImageSize};c.isUsingHiResDimensions=function(b){return b.hiresWidth||b.hiresHeight||b.displayImageSize&&b.hiresUrl}};return b})(this,"undefined"!==typeof window?window:{},"undefined"!==typeof document?document:{});
(function(b,d,c){b.AV=b.AV||{};var e=b.AV,f=e.Events;e.ToolManager=function(b){var h=null,k=function(c,e,d){return b.objectNotify("tool",c,e,d)},l=function(b){null!=b&&(avpw$(".avpw_controlpanel").each(function(){avpw$(this).hide()}),avpw$("#avpw_controlpanel_"+b).show())},p=function(){var c,p=function(p){k(h,"panelWillClose");k(p,"panelWillOpen");f.trigger("canvas:activate",b.panelMode2WidgetMode(p));l(p);k(p,"resetUI");d.setTimeout(function(b){return function(){k(b,"panelDidClose");h=p;k(p,"panelDidOpen");
c=!1}}(h),200);h=p;b.layoutNotify(e.launchData.openType,"disableZoomMode")};return function(b){c||(c=!0,p(b))}}(),q=function(d){if(!b.paintWidget||!b.paintWidget.busy){b.layoutNotify(e.launchData.openType,"showView",["editpanel"]);p(d);e.controlsWidgetInstance.onEggWaitThrobber.stop();if("mobile"==e.launchData.openType){var f;if(f=c.getElementById("avpw_main_"+d))if(f=f.getAttribute("data-header"))c.getElementById("avpw_control_toolname").innerHTML=f}e.usageTracker.addUsage(d)}},r=function(){f.on("tool:open",
t);f.on("tool:close",s);f.on("tool:init",u);f.on("tool:shutdown",y);f.on("tool:commit",v);f.on("tool:cancel",w);f.on("tool:undo",z);f.on("tool:redo",B)},s=function(){b.layoutNotify(e.launchData.openType,"showView",["main"]);p(null)},t=function(c,d){c=e.publicName2PanelMode(c);var h;var k,l=b.activeTools,p=!1;if(l){k=l.length;for(h=0;h<k;h++)if(l[h]===c){p=!0;break}}"forcecrop"===c&&e.launchData.forceCropPreset?h=!0:(p||e.errorNotify("UNSUPPORTED_TOOL",[c]),h=p);if((h||e.launchData.forceCropPreset)&&
b.paintWidget&&!b.paintWidget.moduleLoaded(c,q)&&d)b.onEggWaitThrobber.stop(),b.onEggWaitThrobber.spin(avpw$(d).children(".avpw_icon_waiter")[0]);f.trigger("usage:tool",c,"opened");f.trigger("usage:firstclick",c)},u=function(c){k(c,"init",[b])},v=function(){var b,c=h;c&&(b=k(h,"commit"),!1!==b&&(f.trigger("usage:tool",c,"applied",!0!==b?b:""),f.trigger("tool:commitDone")))},w=function(){k(h,"cancel");f.trigger("usage:tool",h,"canceled")},y=function(b){k(b,"shutdown")},z=function(){f.trigger("usage:tool",
"undo","applied",h||"");b.paintWidget.actions.isACheckpoint()?b.paintWidget.busy||!1===k(h,"onUndo",[{global:!0}])||(b.paintWidget.actions.undoToCheckpoint(),k(h,"onUndoComplete",[{global:!0}])):b.paintWidget.busy||!1===k(h,"onUndo")||(b.paintWidget.actions.undo(),k(h,"onUndoComplete"))},B=function(){f.trigger("usage:tool","redo","applied",h||"");var c;b.paintWidget.busy||!1===k(h,"onRedo",[{global:!0}])?c=!1:(c=b.paintWidget.actions.redoToCheckpoint())&&k(h,"onRedoComplete",[{global:!0}]);c||b.paintWidget.busy||
!1===k(h,"onRedo")||(b.paintWidget.actions.redo(),k(h,"onRedoComplete"))};this.init=r;this.shutdown=function(){f.off("tool:open",t);f.off("tool:close",s);f.off("tool:init",u);f.off("tool:shutdown",y);f.off("tool:commit",v);f.off("tool:cancel",w);f.off("tool:undo",z);f.off("tool:redo",B)};this.notify=k;this.getActiveTool=function(){return h};r();return this};return b})(this,"undefined"!==typeof window?window:{},"undefined"!==typeof document?document:{});
(function(b,d,c){b.AssetManager=function(c,f){var g={EFFECT:"effect",STICKER:"sticker",IMAGEBORDER:"imageborder",PERMISSION:"permission",FONTPACK:"fontpack"},h={},k,l=function(c){var e=c.resourceUrl;e&&(-1===e.indexOf("http")&&(e=b.build.feather_baseURL+e),c.resourceUrl=e)},p=function(c){for(var e=0;e<k.length;e++)for(var d=0;d<c.length;d++)c[d].assetId===k[e].assetId&&(k[e].purchased=!0,b.util.extend(k[e],c[d]),l(k[e]))},q=function(b){var c=[];if(b){b=g[b];for(var e=0;e<k.length;e++)k[e].assetType===
b&&c.push(k[e])}else c=k.slice(0);return c},r=function(c,e){k?e&&e.apply(this,[q(c)]):(h.getPartnerAssets||(h.getPartnerAssets=[],y.authenticate()),h.getPartnerAssets.push(function(d){d&&d.assets?k=d.assets:(b.errorNotify("ERROR_AUTHENTICATING"),u());b.util.nextFrame(function(){if(k){for(var b=0;b<k.length;b++)l(k[b]);e&&e.apply(this,[q(c)])}})}))},s=function(b,c){d.setTimeout(function(){try{return d.avpw_purchase_frame.postMessage("getAssets","*"),h.getAssets=c,!0}catch(b){return!1}},2E3)},t=function(b,
c){if(!k)return s(b,function(e){k=e;for(e=0;e<k.length;e++)l(k[e]);w(b,c)}),!1;try{return d.avpw_purchase_frame.postMessage("getPurchasedAssets","*"),h.getPurchasedAssets=function(e){p(e);c&&c.apply(this,[q(b)])},!0}catch(e){return!1}},u=function(c,e){k=[{needsPurchase:!1,assetId:"default_effects",assetType:"effect",displayName:"Default",resourceUrl:"js/proclist_default_effects.js"},{needsPurchase:!1,assetId:"original_effects",assetType:"effect",displayName:"Original",resourceUrl:"js/proclist_original_effects.js"},
{needsPurchase:!1,assetId:"original_stickers",assetType:"sticker",displayName:"Original",resourceUrl:"js/stickers_original_stickers.js"},{needsPurchase:!1,assetId:"borders",assetType:"imageborder",displayName:"Default Image Borders",resourceUrl:"js/borders_original.js"}];e&&b.util.nextFrame(function(){for(var b=0;b<k.length;b++)l(k[b]);e.apply(this,[q(c)])});return!0},v=function(b){var c,e,d;if(b.messageName&&(d=h[b.messageName]))if("function"===typeof d)d.apply(this,[b.data]);else{e=d.length;for(c=
0;c<e;c++)d[c].apply(this,[b.data])}},w=c?r:f?t:u,y=this;y.getAssets=w;y.getById=function(b){for(var c=0;c<k.length;c++)if(k[c].assetId===b)return k[c]};y.showAssetPurchaseView=function(c,e){var f={messageName:"showAssetPurchaseView",assetId:c},f=b.JSON.stringify(f);try{return d.avpw_purchase_frame.postMessage(f,"*"),h.showAssetPurchaseView=function(){y.showAssetPurchasePopup(c,e)},!0}catch(g){return!1}};y.showAssetPurchasePopup=function(c,e){avpw$("#avpw_purchase_frame").show();b.controlsWidgetInstance.messager.show("avpw_purchase_pack",
!0);avpw$("#avpw_purchase_pack_close").bind("click",y.hideAssetPurchasePopup);h.getPurchasedAssets=function(b){p(b);b=y.getById(c);e&&("function"===typeof e&&b)&&e.apply(this,[b]);y.hideAssetPurchasePopup()}};y.hideAssetPurchasePopup=function(){h.getPurchasedAssets=null;avpw$("#avpw_purchase_frame").hide();b.controlsWidgetInstance.messager.hide("avpw_purchase_pack");avpw$("#avpw_purchase_pack_close").unbind("click",y.hideAssetPurchasePopup)};y.authenticate=function(){var c=function(b){v({messageName:"getPartnerAssets",
data:b})};return function(){return b.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_auth_form",action:b.build.partnerAssetURL,method:"POST",dataType:"json",announcer:b.build.asyncFeatherTargetAnnounce,origin:b.build.asyncImgrecvBase,keyValues:{apikey:b.launchData.apiKey,timestamp:b.launchData.timestamp,signature:b.launchData.signature,salt:b.launchData.salt,encryptionmethod:b.launchData.encryptionMethod},callback:c})}}();y.types=g;f&&(d.avpw_purchase_frame||avpw$("#avpw_messaging").append(b.template[b.launchData.layout].inAppPurchaseFrame({src:b.build.inAppPurchaseFrameURL})));
return y}})(window.AV||(window.AV={}),window,document);
(function(b,d,c){b.ServerMessaging=function(e){var f=[],g=function(c,e){var d,g,h=!0,k=f.shift();if(k&&(e&&k.origin&&(h=e===b.util.getDomain(k.origin)),k.id&&(d=avpw$("#"+k.id),g=d.attr("target"),avpw$("#"+g).unbind("load"),avpw$("#"+k.id+"_target_holder").empty(),d.remove()),h&&k.callback)){if(k.dataType&&"json"===k.dataType&&"string"===typeof c)try{c=b.JSON.parse(c)}catch(l){}k.callback.call(this,c)}0<f.length&&s()},h=function(c,e,d,f,g){return avpw$.ajax({url:c,type:e,data:d,dataType:f,error:function(){b.errorNotify("ERROR_SAVING",
[b.build.imgrecvServer])},success:g})},k=function(c,e,d){d||(d=b.build.feather_baseURL+"blank.html");e||(e=c);return['<iframe width="1" height="1" style="position:absolute;left:-9999px;" ','id="'+c+'" name="'+e+'" src="'+d+'">',"</iframe>"].join("")},l=function(b,c,e){if(!b)return null;var d=b+"_target_holder",f="avpw_form_target_"+Math.floor(4294967295*Math.random()).toString(16),g=avpw$("#"+d);if(!g||!g.length)g=avpw$('<div id="'+d+'"></div>').css({position:"absolute",top:0,left:0}).appendTo("#avpw_holder");
g.html(k(f));c?avpw$("#"+f).load(function(){q(f,b,c)}):avpw$("#"+f).load(e);return f},p=function(b,e,d,f,g,h,k){f=l(b,h,k);e+="?responsecontenttypeheader="+escape("text/html");b=avpw$("<form></form>").attr({id:b,action:e,target:f,method:d||"POST"}).css({display:"none"});d=c.createDocumentFragment();for(var p in g)g.hasOwnProperty(p)&&d.appendChild(avpw$("<input></input>").attr({name:p,value:g[p],type:"hidden"})[0]);b.html(d);b.appendTo("#avpw_holder");b.submit();return b},q=function(c,e,f){var h=
e+"_announcer";if(d.postMessage)d[h]?d[h].postMessage("avpw_load:"+c,"*"):(e=avpw$(k(h,h,f)),e.load(function(){b.util.nextFrame(function(){d[h].postMessage("avpw_load:"+c,"*")})}),avpw$("#avpw_holder").append(e));else{var l,p=e+"_observer",q=0;l=avpw$(k(p,p,f+"#"+c))[0];avpw$(l).load(function(){var c;try{if("about:blank"==l.contentWindow.location)return}catch(e){}if(2===q&&(c=l.contentWindow.name))q=3,c!==p&&c.substr&&"avpw:"==c.substr(0,5)?(c=c.substr(5),g(c)):(b.errorNotify("ERROR_SAVING",[b.build.imgrecvServer]),
g()),avpw$(l).unbind().remove();1===q&&(q=2,l.contentWindow.location="");q||(q=1)});avpw$(l).appendTo("#avpw_holder")}},r=function(c){var e=c.data;c=b.util.getDomain(c.origin);e.substr&&"avpw:"==e.substr(0,5)&&(e=e.substr(5),g(e,c))},s=function(){var b=f[0];b&&p(b.id,b.action,b.method,b.origin,b.keyValues,b.announcer)},t=function(b){b.announcer?(f.push(b),1===f.length&&s()):p(b.id,b.action,b.method,b.origin,b.keyValues,b.announcer,b.callback)};this.shutdown=function(){d.removeEventListener?d.removeEventListener("message",
r,!1):d.detachEvent&&d.detachEvent("onmessage",r);f=[]};this.sendMessage=function(c){var e;"xhr"===(c.transport||"xhr")&&avpw$.support.cors&&(!b.firefox||4<=b.firefox)?(e=h(c.action,c.method,c.keyValues,c.dataType,c.callback))||t(c):t(c)};d.addEventListener?d.addEventListener("message",r,!1):d.attachEvent&&d.attachEvent("onmessage",r);return this}})(window.AV||(window.AV={}),window,document);
(function(b,d,c){b.AV=b.AV||{};var e=b.AV,f=e.Events;e.usageTracker=function(){var b=null,h={},k=[],l,p=!1,q={},r=function(){e.controlsWidgetInstance&&q.submit("close")},s=function(){d._gaq=d._gaq||[];if("undefined"===typeof _gat){var b=c.createElement("script");b.type="text/javascript";b.async=!0;b.src=("https:"==c.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var f=c.getElementsByTagName("script")[0];f.parentNode.insertBefore(b,f)}p||(_gaq.push(["Feather._setAccount",
e.build.googleTracker]),_gaq.push(["Feather._setCustomVar",1,"apikey",e.launchData.apiKey]),_gaq.push(["Feather._setCustomVar",2,"featherversion",e.build.version]),_gaq.push(["Feather._setCustomVar",3,"sessionid",this.getUUID()]),_gaq.push(["Feather._setCustomVar",4,"language",e.launchData.language]),_gaq.push(["Feather._setCustomVar",5,"apiversion",e.launchData.apiVersion+""]),p=!0)},t=function(b,c,e){_gaq.push(["Feather._trackEvent","tool",b+":"+c,e?e+"":""])},u=function(b,c,e){_gaq.push(["Feather._trackEvent",
"interaction",b+":"+c,e?e+"":""])},v=function(b){q.submit("firstclick",b);f.off("usage:firstclick")};q.setup=function(){avpw$(d).bind("unload",r);f.on("usage:submit",q.submit,q);f.on("usage:tool",t,q);f.on("usage:firstclick",v,q);f.on("usage:interact",u)};q.shutdown=function(){avpw$(d).unbind("unload",r);f.off("usage:submit",q.submit);f.off("usage:tool",t);f.off("usage:firstclick",v);f.off("usage:interact",u)};q.clear=function(){b=null;h={};k=[]};q.getUUID=function(){return b?b:b=Math.floor(4294967295*
Math.random()).toString(16)+Math.floor(4294967295*Math.random()).toString(16)};q.addUsage=function(b,c){c||(c=1);h[b]=void 0===h[b]?c:h[b]+c};q.setPageCount=function(b){var c;k=Array(b);for(c=0;c<b;c++)k[c]=0};q.addPageHit=function(b){b!==l&&k[b]++;l=b};q.submit=function(b,c){var d=null,d="",f;s.call(this);"launch"===b?_gaq.push(["Feather._trackPageview"]):_gaq.push(["Feather._trackEvent","submit",b,c]);if(e.controlsWidgetInstance&&e.build.imgtrackServer&&e.JSON){switch(b){case "close":d={dataver:1,
opentype:e.launchData.openType,pagehits:k,toolusage:h};d=e.JSON.stringify(d);break;case "firstclick":d={toolusage:h},d=e.JSON.stringify(d)}f=e.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_track_form",action:e.build.imgtrackServer,method:"GET",keyValues:{action:b,sessionid:this.getUUID(),featherversion:e.build.version,apikey:e.launchData.apiKey,toolusagedata:d},callback:function(){e.util.nextFrame(function(){var b=avpw$("#avpw_track_form_target_holder");b&&b.length&&b.empty();f&&(b=
f.attr("target"),avpw$("#"+b).unbind("load"),f.remove())})},transport:"form"})}};return q}();e.getActiveTools=function(b){var c=e.featherUseFlash?e.flashSupportedTools:e.defaultTools,d=b;if(!d||"all"===d||"All"===d||"ALL"===d||""===d)d=c;"string"===typeof d&&(d=b.split(","));b=[];var f,p={},q;for(q=0;q<c.length;q++)f=c[q],p[f]=!0;for(q=0;q<d.length;q++)if(!e.launchData.forceCropPreset||!("resize"===d[q]||"orientation"===d[q]||"crop"===d[q]))f=e.publicName2PanelMode(d[q]),f in p&&b.push(f);return b};
e.paintWidgetGetPopupEmbedDiv=function(b){var e=avpw$("#avpw_canvas_embed_popup");if(b){var d=avpw$(b),f,p,q="top left bottom right margin-top margin-right margin-bottom margin-left border-top border-right border-bottom border-left padding-top padding-right padding-bottom padding-left".split(" "),r={position:"relative"};for(f=0;f<q.length;f++)p=q[f],r[p]=d.css(p);d=avpw$(b).css("display");if(""==d||"inline"==d)d="inline-block";r.display=d;0==e.length&&(e=c.createElement("div"),e.id="avpw_canvas_embed_popup");
avpw$(e).hide().css(r).insertBefore(b)}return e};e.paintWidgetLauncher=function(b,c){if(!e.paintWidgetInstance)return e.usageTracker.clear(),e.featherUseFlash?e.paintWidgetLauncher_Flash(b,c):e.paintWidgetLauncher_HTML(b,c)};e.paintWidgetLauncher_Flash=function(b,h){function k(){avpw$(s).unbind("load",k);e.msie&&7==e.msie&&(avpw$("#avpw_controls").css("visibility","hidden"),avpw$("#avpw_controls").show());e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"placeControls_Flash",[1<e.util.getApiVersion(e.launchData)?
e.launchData.appendTo:void 0]);e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"enableControls");u=e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"getScaledImageDims_Flash",[s]);v=u.width;w=u.height;y=v>w?v:w;e.launchData.maxEditSize=y;e.paintWidgetInstance=new e.PaintWidget(v,w,new e.Actions,new e.ModeManager,new e.FilterManager,new e.OverlayRegistry,new e.ImageBorderManager);e.paintWidgetInstance.setOrigSize(v,w);var c=e.template[e.launchData.layout].flashCanvasBox({id:"avpw_canvas_swf_replace"});
avpw$(t).append(c);e.controlsWidgetInstance.initAllTools.call(e.controlsWidgetInstance);var l={initsize:u,plugins:z,action:{origUrl_:h?h:q.src,sessionID_:e.usageTracker.getUUID(),referrerUrl_:d.location.href,url:e.build.imgrecvServer,name:"file"}};e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"hideOriginalImage",[q]);e.util.nextFrame(function(){e.controlsWidgetInstance.setupScrollPanels()});e.msie&&7==e.msie&&(avpw$("#avpw_controls").hide(),avpw$("#avpw_controls").css("visibility","visible"));
avpw$("#avpw_controls").fadeIn(p);e.launchData.noCloseButton&&avpw$("#avpw_control_cancel_pane").css("display","none");setTimeout(function(){e.FlashAPI.init(l);e.FlashAPI.startEditing(b);e.controlsWidgetInstance.initWithPaintWidget(e.paintWidgetInstance);f.trigger("tool:close");e.controlsWidgetInstance.loaderPhase=1},p)}function l(){e.util.imgOnLoad(s,k);avpw$(s).attr("src",h?h:r)}var p=e.launchData.launchDelay,q=e.util.getImageElem(b),r=q.src,s,t,u,v,w,y,z,B;z=e.getActiveTools(e.launchData.tools);
B=new e.AssetManager(e.launchData.isPremiumPartner,e.launchData.allowInAppPurchase);e.controlsWidgetInstance=new e.ControlsWidget(null,b,z,B,new e.ServerMessaging);e.controlsWidgetInstance.origURL=h?h:avpw$(q).attr("src");avpw$(".avpw_isa_previewcanvas").hide();t=e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"getEmbedElement",[q]);avpw$(t).show();s=c.createElement("img");avpw$(s).css({display:"block",visibility:"hidden",position:"absolute"}).attr("src",h?h:q.src);e.build.bundled?l():
e.util.loadFile(e.build.feather_baseURL+"js/featherpaint_flash.js","js",l)};e.paintWidgetLauncher_Flash_stage2=function(b,c){e.controlsWidgetInstance.loaderPhase=2;e.controlsWidgetInstance.imageSizeTracker.setOrigSize(e.launchData,{width:b,height:c},{width:e.paintWidgetInstance.width,height:e.paintWidgetInstance.height});e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"launchStage2_Flash");e.controlsWidgetInstance.showWaitThrobber(!1);avpw$(e.controlsWidgetInstance.onEggWaitThrobber).hide();
f.trigger("usage:submit","launch");e.fireLaunchComplete()};e.paintWidgetLauncher_HTML=function(b,d){var f=e.launchData.launchDelay,l=e.util.getImageElem(b),p,q,r,s,t;s=e.getActiveTools(e.launchData.tools);e.isRelaunched&&"undefined"!=typeof l.avpw_prevURL&&(d=l.avpw_prevURL);t=new e.AssetManager(e.launchData.isPremiumPartner,e.launchData.allowInAppPurchase);e.controlsWidgetInstance=new e.ControlsWidget(null,b,s,t,new e.ServerMessaging);e.launchData.image instanceof HTMLImageElement&&!d&&(d=b.src);
e.controlsWidgetInstance.origURL=d?d:avpw$(l).attr("src");e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"placeControls",[1<e.util.getApiVersion(e.launchData)?e.launchData.appendTo:void 0]);e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"enableControls");e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"bindEvents");avpw$("#avpw_controls").fadeIn(f);e.util.nextFrame(function(){"mobile"==e.launchData.openType&&e.setPageWidth(avpw$("#avpw_controls").width());e.controlsWidgetInstance.setupScrollPanels()});
e.launchData.noCloseButton&&avpw$("#avpw_control_cancel_pane").css("display","none");if(l&&"canvas"===l.nodeName.toLowerCase())e.mockLauncher(l);else return q=e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"getEmbedElement",[l]),p=c.createElement("img"),p.id="avpw_temp_loading_image",e.tempLoadingImageSrc=p.src,avpw$(p).load(function(){r=e.controlsWidgetInstance.getScaledDims(avpw$(l).width(),avpw$(l).height());p.width=r.width;p.height=r.height;e.controlsWidgetInstance.layoutNotify(e.launchData.openType,
"getScaledImageDims",[p]);avpw$(p).unbind();p.style.display="block";avpw$(q).append(p);e.controlsWidgetInstance.showWaitThrobber(!0);e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"hideOriginalImage",[l]);avpw$(q).show();e.util.nextFrame(function(){e.build.bundled?e.paintWidgetLauncher_stage2(b,d):e.util.loadFile(e.build.feather_baseURL+"js/featherpaint.js","js",function(c){e.paintWidgetLauncher_stage2(b,d)})})}).error(function(){e.paintWidgetCloser(!0);e.errorNotify("BAD_IMAGE",[d])}),
p.src=l.src,!1};e.mockLauncher=function(b){var c=e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"getEmbedElement",[b]);e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"getScaledImageDims",[b]);avpw$(b).detach();avpw$(c).append(b);avpw$(c).show();e.controlsWidgetInstance.showWaitThrobber(!0);e.util.nextFrame(function(){var b=function(){};e.controlsWidgetInstance.initAllTools=function(){for(var b in this.activeTools){var c=this.activeTools[b];this.tool.hasOwnProperty(c)&&f.trigger("tool:init",
c)}};e.controlsWidgetInstance.initWithPaintWidget=function(b){this.paintWidget=b;this.initAllTools();this.bindControls();this.paintWidget.showWaitThrobber=this.showWaitThrobber.AV_bindInst(this)};e.controlsWidgetInstance.loaderPhase=1;e.paintWidgetInstance={moduleLoaded:function(b,c){return c.call(this)},setMode:b,setCurrentLayerByName:b,shutdown:b,actions:{setCheckpoint:b}};e.controlsWidgetInstance.initWithPaintWidget(e.paintWidgetInstance);e.controlsWidgetInstance.showWaitThrobber(!1);e.controlsWidgetInstance.loaderPhase=
2;e.fireLaunchComplete()})};e.paintWidgetLauncher_stage2=function(b,c){var d=e.util.getImageElem(b),l,p,q=function(b){e.controlsWidgetInstance&&e.paintWidgetInstance&&(l=new Image,avpw$.support.cors&&e.launchData.enableCORS&&(l.crossOrigin="Anonymous"),avpw$(l).load(function(b){if(e.controlsWidgetInstance&&e.paintWidgetInstance){p=e.controlsWidgetInstance.getScaledDims(l.width,l.height);e.controlsWidgetInstance.imageSizeTracker.setOrigSize(e.launchData,l,p);l.width=p.width;l.height=p.height;e.paintWidgetInstance.setDimensions(p.width,
p.height);if(!e.paintWidgetInstance.setBackground(l))return e.paintWidgetCloser(!0),e.errorNotify("IMAGE_NOT_CLEAN",[c]),!1;e.paintWidgetInstance.setOrigSize(p.width,p.height);d.src!==c&&e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"scaleCanvas");avpw$(e.paintWidgetInstance.canvas).insertBefore("#avpw_temp_loading_image");r.remove();e.tempLoadingImageSrc=c;e.controlsWidgetInstance.showWaitThrobber(!1);e.controlsWidgetInstance.loaderPhase=2;e.launchData.actionListJSON&&e.paintWidgetInstance.actions.importJSON(e.launchData.actionListJSON,
e.fireLaunchComplete)}}).attr("src",b))};p=e.controlsWidgetInstance.getScaledDims(avpw$(d).width(),avpw$(d).height());e.controlsWidgetInstance.loaderPhase=1;e.paintWidgetInstance=new e.PaintWidget(p.width,p.height,new e.Actions,new e.ModeManager,new e.FilterManager,new e.OverlayRegistry,new e.ImageBorderManager);e.controlsWidgetInstance.canvasUI=new e.PaintUI(e.paintWidgetInstance.canvas,e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"getEmbedElement"));e.controlsWidgetInstance.initWithPaintWidget(e.paintWidgetInstance);
e.paintWidgetInstance.setOrigSize(p.width,p.height);e.controlsWidgetInstance.imageSizeTracker.setOrigSize(e.launchData,d,p);var r=avpw$("#avpw_temp_loading_image");e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"scaleCanvas");if(null!=c)avpw$.support.cors&&e.launchData.enableCORS?q(c):-1===c.indexOf("data:")?avpw$.ajax({type:"GET",dataType:"json",url:e.build.jsonp_imgserver+"?callback=?",data:{url:escape(c)},success:function(b){q(b.data)},error:function(b,d,f){200===b.status&&"parsererror"===
d&&e.controlsWidgetInstance&&(e.controlsWidgetInstance.showWaitThrobber(!1),e.util.nextFrame(function(){e.paintWidgetCloser(!0);e.errorNotify("BAD_URL",[c])}))}}):q(c);else{if(!e.paintWidgetInstance.setBackground(d))return e.paintWidgetCloser(!0),e.launchData.enableCORS&&avpw$.support.cors?e.errorNotify("ERROR_BAD_IMAGE_WITHOUT_CORS"):e.errorNotify("IMAGE_NOT_CLEAN",[c]),!1;avpw$("#avpw_controls").insertAfter(e.paintWidgetInstance.canvas);avpw$(e.paintWidgetInstance.canvas).insertBefore(r);r.remove();
e.tempLoadingImageSrc=d.src;e.controlsWidgetInstance.showWaitThrobber(!1);e.controlsWidgetInstance.loaderPhase=2;e.launchData.actionListJSON&&e.paintWidgetInstance.actions.importJSON(e.launchData.actionListJSON,e.fireLaunchComplete)}f.trigger("usage:submit","launch");e.launchData.actionListJSON||e.fireLaunchComplete();return!1};e.fireLaunchComplete=function(){var b=e.launchData.initTool;b&&(e.util.nextFrame(function(){f.trigger("tool:open",b)}),e.paintWidgetInstance.moduleLoaded(b,function(b){e.util.nextFrame(function(){avpw$("#avpw_holder").removeClass("avpw_init_hide")})}));
if("function"===typeof e.launchData.onReady)e.launchData.onReady()};e.paintWidgetShutdown=function(){f.trigger("usage:submit","close");e.paintWidgetInstance&&e.paintWidgetInstance.shutdown();e.controlsWidgetInstance&&(e.controlsWidgetInstance.serverMessaging&&(e.controlsWidgetInstance.serverMessaging.shutdown(),e.controlsWidgetInstance.serverMessaging=null),e.controlsWidgetInstance.shutdown());e.featherUseFlash&&e.FlashAPI.close();avpw$("#avpw_controls").hide();e.controlsWidgetInstance.layoutNotify(e.launchData.openType,
"onShutdown");if("function"===typeof e.launchData.onClose)e.launchData.onClose(e.paintWidgetInstance.dirty);e.paintWidgetInstance=null;e.controlsWidgetInstance=null;e.tempLoadingImageSrc=null};e.paintWidgetCloser=function(b){var c=e.launchData.closeDelay;e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"onClose",[b]);b||0===c?(avpw$("#avpw_controls").hide(),e.paintWidgetShutdown()):avpw$("#avpw_controls").fadeOut(c,function(){e.paintWidgetInstance&&e.paintWidgetShutdown()})};e.controlsWidget_saveResponder=
function(b,c,d){var l;"function"===typeof b&&(l=b.apply(e.launchData,[e.util.getImageId(e.controlsWidgetInstance.paintImgIdElem),c,d]));e.controlsWidgetInstance&&(e.util.getImageElem(e.controlsWidgetInstance.paintImgIdElem).avpw_prevURL=c,f.trigger("tool:close"),l&&e.controlsWidgetInstance.messager.show("avpw_aviary_beensaved",!0),e.controlsWidgetInstance.paintWidget.dirty=!1,e.controlsWidgetInstance.saving=!1)};e.controlsWidget_onImageSaved=function(b,c){e.controlsWidget_saveResponder(e.launchData.onSave,
b,c)};e.controlsWidget_onHiResImageSaved=function(b){e.controlsWidget_saveResponder(e.launchData.onSaveHiRes,b)};e.ControlsWidget=function(b,c,d,l,p){this.maxHeight=this.maxWidth=parseInt(e.launchData.maxSize);this.saving=!1;this.origURL=null;this.activeTools=d;this.quitCount=0;e.usageTracker.setup();this.paintImgIdElem=c;f.on("layout:resize",this.setupScrollPanels,this);this.layoutNotify(e.launchData.openType,"showView",["main"]);b&&this.initWithPaintWidget(b);b={className:"avpw_tool_spinner",lines:12,
length:6,width:2,radius:6,color:"#fff",speed:0.5,trail:70};"mobile"!=e.launchData.openType&&(b.color="#555",b.length=4);this.waitThrobber=new e.Spinner({className:"avpw_canvas_spinner",lines:12,length:6,width:2,radius:6,color:"#fff",speed:0.5,trail:70});this.onEggWaitThrobber=new e.Spinner(b);this.toolManager=new e.ToolManager(this);this.assetManager=l;this.serverMessaging=p};e.ControlsWidget.prototype.tool={};e.ControlsWidget.prototype.layout={};e.ControlsWidget.prototype.layoutNotify=function(b,
c,e){return this.objectNotify("layout",b,c,e)};e.ControlsWidget.prototype.objectNotify=function(b,c,e,d){return"object"==typeof this[b][c]&&(b=this[b][c],"function"==typeof b[e])?(e=b[e],d||(d=[]),e.apply(b,d)):!0};e.ControlsWidget.prototype.shutdown=function(){this.canvasUI&&this.canvasUI.shutdown();this.messager&&this.messager.hide();f.off("layout:resize",this.setupScrollPanels);this.shutdownAllTools();this.unbindControls();this.toolsPager&&(this.toolsPager.shutdown(),this.toolsPager=null);this.paintWidget&&
(this.paintWidget.showWaitThrobber=null);e.usageTracker.shutdown();this.waitThrobber.stop();this.onEggWaitThrobber.stop();this.onEggWaitThrobber=this.waitThrobber=null;this.showPanel(null);this.toolManager.shutdown();this.toolManager=null};e.ControlsWidget.prototype.initAllTools=function(){e.paintWidgetInstance.filterManager.loadPack("tools");for(var b in this.activeTools){var c=this.activeTools[b];this.tool.hasOwnProperty(c)&&e.paintWidgetInstance.moduleLoaded(c,function(b){f.trigger("tool:init",
b)}.AV_bindInst(this))}e.launchData.forceCropPreset&&e.paintWidgetInstance.moduleLoaded("forcecrop",function(b){f.trigger("tool:init","forcecrop")}.AV_bindInst(this))};e.ControlsWidget.prototype.shutdownAllTools=function(){for(var b in this.activeTools)f.trigger("tool:shutdown",this.activeTools[b])};e.ControlsWidget.prototype.bindControls=function(){};e.ControlsWidget.prototype.unbindControls=function(){};e.ControlsWidget.prototype.initWithPaintWidget=function(b){this.paintWidget=b;this.imageSizeTracker=
new e.ImageSizeTracker(b.actions);e.featherUseFlash||this.initAllTools();this.bindControls();this.paintWidget.showWaitThrobber=this.showWaitThrobber.AV_bindInst(this)};e.ControlsWidget.prototype.showWaitThrobber=function(b,c){if(b){var f=this.layoutNotify(e.launchData.openType,"getEmbedElement");f.is(":visible")&&(this.waitThrobber.spin(f[0]),avpw$(this.waitThrobber).fadeIn(300))}else avpw$(this.waitThrobber.el).fadeOut(300,this.waitThrobber.stop);c&&d.setTimeout(c,5)};e.publicName2PanelMode=function(b){"stickers"===
b&&(b="overlay");"draw"===b&&(b="drawing");"text"===b&&!e.featherUseFlash&&(b="textwithfont");return b};e.ControlsWidget.prototype.panelMode2WidgetMode=function(b){switch(b){case "rotate":return"rotate90";case "greeneye":return"redeye";case "pinch":return"bulge"}return b};e.ControlsWidget.prototype.setupScrollPanels=function(){if(this.activeTools&&this.activeTools.length){var b,c,d=this,l=this.layoutNotify(e.launchData.openType,"getDims").TOOLS_BROWSER_WIDTH,p={itemCount:this.activeTools.length,itemsPerPage:this.layoutNotify(e.launchData.openType,
"getToolsPerPage"),pageWidth:l,leftArrow:avpw$("#avpw_lftArrow"),rightArrow:avpw$("#avpw_rghtArrow"),itemBuilder:function(f){b=d.activeTools[f];c=e.util.getUserFriendlyToolName(b);c=e.getLocalizedString(c);return e.template[e.launchData.layout].eggIcon({optionName:b,capOptionName:c})},pageTemplate:e.template[e.launchData.layout].genericScrollPanel,pipTemplate:e.template[e.launchData.layout].scrollPanelPip,lastPageTemplate:void 0,lastPageContents:{},pageContainer:avpw$("#avpw_control_main_scrolling_region"),
pipContainer:avpw$("#avpw_tools_pager ul"),onPageChange:function(b){e.usageTracker.addPageHit(b)}};d.toolsPager=new e.Pager(p);avpw$("#avpw_control_main_scrolling_region").css("width",d.toolsPager.getPageCount()*l+"px");this.assetManager.getAssets("PERMISSION",function(b){var c=!0;if(b)for(var g=0;g<b.length;g++)if(b[g]&&"whitelabel"===b[g].assetId){c=!1;break}c&&(avpw$("#avpw_powered_branding").html(e.template[e.launchData.layout].poweredByFooterLogo).click(function(){f.trigger("modal:show","avpw_aviary_aviaryfeedback",
!1,!1)}),d.toolsPager.shutdown(),d.toolsPager=new e.Pager(p),avpw$("#avpw_control_main_scrolling_region").css("width",d.toolsPager.getPageCount()*l+"px"),d.toolsPager.changePage())});e.usageTracker.setPageCount(d.toolsPager.getPageCount());d.toolsPager.changePage()}};e.ControlsWidget.prototype.messager=function(){var b={},c,k,l,p={show:function(f,l,p){c=c||avpw$("#avpw_messaging");k=k||avpw$("#avpw_messaging_inner");f=b[f]||(b[f]=avpw$("#"+f));k.append(f);c.fadeIn(150);l?(c.data("needsConfirmation",
!0),e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"disableControls")):(c.data("needsConfirmation",!1),p||d.setTimeout(this.hide,1E3))},hide:function(f,k){c=c||avpw$("#avpw_messaging");l=l||avpw$("#avpw_messages");if(f){var p=b[f];p&&l.append(p)}else avpw$.each(b,function(b,c){l.append(c)});c.data("needsConfirmation")?(d.setTimeout(function(){k&&k()},400),e.controlsWidgetInstance&&e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"enableControls")):(c.hide(),k&&k())},addMessage:function(b){l=
l||avpw$("#avpw_messages");b&&(l[0].innerHTML+=b)}};f.on("modal:show",p.show);f.on("modal:hide",p.hide);return p}();e.ControlsWidget.prototype.orientationChanged=function(b){};e.ControlsWidget.prototype.windowResized=function(){var b=null;return function(c){d.clearTimeout(b);b=d.setTimeout(function(){f.trigger("layout:resize");b=null},500)}}();e.ControlsWidget.prototype.Slider=function(b){var c=!1,e=function(e,d){!c&&b.onstart&&b.onstart.apply(this,[e,d])},d=function(e,d){!c&&b.onchange&&b.onchange.apply(this,
[e,d])},f=function(e,d){!c&&b.onslide&&b.onslide.apply(this,[e,d])},q=avpw$(b.element).slider({range:"min",max:b.max,min:b.min,value:b.defaultValue||b.max/2,delay:b.delay});this.getValue=function(){return q.slider("value")};this.setValue=function(b){return q.slider("value",b)};this.reset=function(e){c=!0;this.setValue(b.defaultValue);c=!1};this.addListeners=function(){q.bind("slidestart",e).bind("slidechange",d).bind("slide",f)};this.removeListeners=function(){q.unbind("slidestart").unbind("slide").unbind("slidechange")};
this.shutdown=function(){q.slider("destroy")};return this};e.ControlsWidget.prototype._drawUICircle=function(b,c,d,f,p){e.featherUseFlash||this._drawUICircle_HTML(b,c,d,f,p)};e.ControlsWidget.prototype._drawUICircle_HTML=function(b,c,d,f,p){b=avpw$(b)[0];var q=b.getContext("2d");q.clearRect(0,0,b.width,b.height);p&&"transparent"!==f&&this._drawUIGrid(q,b.width,b.height);q.globalCompositeOperation="source-over";null!=d?(p&&("transparent"==d||e.util.color_is_white(d)||null==f)?q.strokeStyle="#444":
q.strokeStyle=d,d=3):(q.strokeStyle="rgba(0,0,0,0)",d=1);q.lineWidth=d;q.beginPath();q.arc(b.width/2,b.height/2,c,0,2*Math.PI,!0);q.stroke();q.closePath();null!=f&&(q.save(),q.clip(),p&&"transparent"==f?this._drawUIGrid(q,b.width,b.height):(q.fillStyle=f,q.fillRect(0,0,b.width,b.height)),q.restore())};e.ControlsWidget.prototype._drawUIGrid=function(b,c,e,d){var f;d||(d=5);for(f=0;f<e+d;f+=d)for(c=0;c<e+d;c+=d)b.fillStyle=1==(c+f&1)?"#fff":"#ddd",b.fillRect(c,f,d,d)};e.ControlsWidget.prototype.showPanel=
function(b){null!=b&&(avpw$(".avpw_controlpanel").each(function(){avpw$(this).hide()}),avpw$("#avpw_controlpanel_"+b).show())};e.ControlsWidget.prototype.save=function(){var b=null,c=!0,k=function(){return{apikey:e.launchData.apiKey,timestamp:e.launchData.timestamp,signature:e.launchData.signature,salt:e.launchData.salt,encryptionmethod:e.launchData.encryptionMethod}},l=function(b,c){var d=e.controlsWidgetInstance;d.layoutNotify(e.launchData.openType,"enableControls",[!0]);d.paintWidget.showWaitThrobber(!1);
b?(avpw$(e.util.getImageElem(d.paintImgIdElem)).avpw_prevURL=b,e.controlsWidget_onHiResImageSaved(b)):(e.errorNotify("ERROR_SAVING",[e.build.asyncImgrecvBase,c]),e.controlsWidgetInstance.saving=!1)},p=function(b){var c,d,f,g="";if("string"===typeof b)c=b.split("---FEATHER-POSTMESSAGE---"),d=c[0],c=c[1];else if(f=avpw$(b).find("error"),0<f.length)g=f.text();else{if(f=avpw$(b).find("url"))d=f.text(),d=d.replace(/^\s+|\s+$/g,"");if(b=avpw$(b).find("hiresurl"))c=b.text(),c=c.replace(/^\s+|\s+$/g,"")}b=
e.controlsWidgetInstance;b.layoutNotify(e.launchData.openType,"enableControls",[!0]);b.paintWidget.showWaitThrobber(!1);d?(avpw$(e.util.getImageElem(b.paintImgIdElem)).avpw_prevURL=d,e.controlsWidget_onImageSaved(d,c)):(e.errorNotify("ERROR_SAVING",[e.build.imgrecvServer,g]),e.controlsWidgetInstance.saving=!1)},q=function(){var b=this;b.paintWidget.exportImage(null,function(c){var d=c.indexOf(";",0),f=c.indexOf(",",d);c.slice(5,d);c=c.slice(f+1);e.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_save_form",
action:e.build.imgrecvServer,method:"POST",announcer:e.build.featherTargetAnnounce,origin:e.build.imgrecvBase,keyValues:e.util.extend(k(),{file:c,postdata:e.launchData.postData,posturl:e.launchData.postUrl,sessionid:e.usageTracker.getUUID(),actionlist:b.paintWidget.actions.exportJSON(!0),origurl:b.origURL,hiresurl:e.launchData.hiresUrl,contenttype:e.launchData.fileFormat,jpgquality:e.launchData.jpgQuality,debug:e.launchData.debug,asyncsave:e.launchData.asyncSave,usecustomfileexpiration:e.launchData.useCustomFileExpiration,
encodedas:"base64text"}),callback:p})})},r=function(){var f=e.util.extend(k(),{actionlist:this.paintWidget.actions.exportJSON(!0),origurl:e.launchData.hiresUrl,fileformat:e.launchData.fileFormat,notificationmethod:"GET",backgroundcolor:"0xffffffff",jpgquality:e.launchData.jpgQuality}),p=function(e){!e||e&&"JobFailed"===e.JobStatusCode?(l(null),d.clearInterval(b)):e&&"JobCompleted"===e.JobStatusCode&&(d.clearInterval(b),l(e.JobStatus));c=!0};e.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_save_form",
action:e.build.asyncImgrecvCreateJob,method:"POST",dataType:"json",announcer:e.build.asyncFeatherTargetAnnounce,origin:e.build.asyncImgrecvBase,keyValues:f,callback:function(f){var q;f&&f.JobId?(q=f.JobId,b=d.setInterval(function(){c&&e.controlsWidgetInstance.serverMessaging.sendMessage({id:"avpw_save_form",action:e.build.asyncImgrecvGetJobStatus,method:"POST",dataType:"json",announcer:e.build.asyncFeatherTargetAnnounce,origin:e.build.asyncImgrecvBase,keyValues:e.util.extend(k(),{jobid:q}),callback:p});
c=!1},1E3)):l(null)}})},s=function(b,c,d){this.paintWidget.exportImage(d,function(d){var f=e.controlsWidgetInstance;f.saving=!1;f.layoutNotify(e.launchData.openType,"enableControls",[!0]);f.paintWidget.showWaitThrobber(!1);b&&"function"===typeof b&&(c?c=!1===b(d)?!1:!0:b(d));c&&e.util.nextFrame(function(){e.controlsWidget_onImageSaved(f.origURL)})})},t=function(b,c,d,f){var g=!e.featherUseFlash;g&&this.layoutNotify(e.launchData.openType,"disableControls");this.paintWidget.showWaitThrobber(g,function(){switch(b){case "saveHiRes":r.call(h);
break;case "getImageData":s.call(h,c,d,f);break;default:q.call(h)}});var h=this;return!1};return function(b,c,d,g){if(2>e.controlsWidgetInstance.loaderPhase||this.saving)return!1;f.trigger("tool:commit");f.trigger("tool:close");this.saving=!0;e.prevActionList=this.paintWidget.actions.exportJSON(!0);e.launchData.postData&&"string"!==typeof e.launchData.postData&&(e.launchData.postData=e.JSON.stringify(e.launchData.postData));return t.apply(this,[b,c,d,g])}}();e.ControlsWidget.prototype.onSaveButtonClicked=
function(b){f.trigger("usage:submit","saveclicked");return"function"===typeof e.launchData.onSaveButtonClicked&&!1===e.launchData.onSaveButtonClicked.apply(e.launchData,[e.util.getImageId(e.controlsWidgetInstance.paintImgIdElem)])?!1:e.controlsWidgetInstance.save()};e.ControlsWidget.prototype.showAreYouSure=function(){this.messager.show("avpw_aviary_quitareyousure",!0)};e.ControlsWidget.prototype.cancel=function(b){this.quitCount++;b=0<this.quitCount&&this.paintWidget&&this.paintWidget.dirty;if("function"===
typeof e.launchData.onCloseButtonClicked&&!1===e.launchData.onCloseButtonClicked.apply(e.launchData,[b]))return!1;b?this.showAreYouSure():e.paintWidgetCloser();return!1};e.ControlsWidget.prototype.getScaledDims=function(b,c){return e.util.getScaledDims(b,c,this.maxWidth,this.maxHeight)};e.TransformStyle=function(b){var c=b||"";this.set=function(b){if(c)for(var e in b){var d=!1;c=c.replace(RegExp(e+"\\([^\\)]*"),function(c,f,g){d=!0;return e+"("+b[e]});d||(c+=" "+e+"("+b[e]+")")}else for(e in b)c+=
" "+e+"("+b[e]+")"};this.serialize=function(){return c};return this};return b})(this,"undefined"!==typeof window?window:{},"undefined"!==typeof document?document:{});
(function(b,d,c){b.errorNotify=function(c,d){var g={BAD_IMAGE:{code:1,message:"There was a problem loading your image provided to the `image` config key. Either it's not actually an image file or it doesn't really exist."},UNSUPPORTED:{code:2,message:"It looks like you're using a browser that doesn't support the HTML canvas element (and also doesn't have Flash installed either). Please try accessing this page through a modern browser like Chrome, Firefox, Safari, or Internet Explorer (version 9 or higher). Your internets will thank you."},BAD_URL:{code:3,
message:"There was a problem loading your image provided by URI to the `url` config key. It is not reachable by the public (and our service at "+(b.featherUseFlash?b.build.proxyServer:b.build.imgrecvBase)+")"},UNSUPPORTED_TOOL:{code:4,message:"So sorry, but this tool is not available because it is not part of the set chosen with the `tools` config key. It's alternatively possible that your browser does not support this specific tool."},IMAGE_NOT_CLEAN:{code:5,message:"Uh oh! We can't edit this image because the editor wasn't set up correctly to load external files via their address. You must either provide images from the same domain as the web page with the editor OR pass the external image address via the `url` config key in order for Aviary to be able to get permission from the browser to open it for editing. Sorry for the inconvenience!"},
UNSUPPORTED_FONT:{code:6,message:"So sorry, but this font looks to be unsupported by your browser or platform"},ERROR_SAVING:{code:7,message:"There was a problem saving your photo. Please try again."},NO_APIKEY:{code:8,message:"apiKey is required and not provided. See http://www.aviary.com/web-documentation#constructor-config-apikey."},ERROR_AUTHENTICATING:{code:9,message:"There was a problem retrieving access to content from our server. Please ensure all authentication keys are present or do not attempt premium partner authentication."},
ERROR_BAD_THEME:{code:10,message:"Selected theme does not exist. Please use 'dark', 'light' or 'minimum' or see aviary.com/web for more info."},ERROR_BAD_IMAGE_WITHOUT_CORS:{code:11,message:"The image URL you are trying to use is either not on the same domain or is not configured for CORS. See http://enable-cors.org/ for more info."}}[c],h=g.message;"function"===typeof b.launchData.onError&&(g.args=d,h=b.launchData.onError(g)||h);return h}})(window.AV||(window.AV={}),window,document);
(function(b,d,c){b.AV=b.AV||{};var e=b.AV,f=e.Events;b.Aviary=e;e.feather_loaded=!1;e.feather_loading=!1;e.build=e.build||{version:"",imgrecvServer:"imgrecvserver",flashGatewayServer:"",imgrecvBase:"",inAppPurchaseFrameURL:"",imgtrackServer:"imgtrackserver",filterServer:"",jsonp_imgserver:"",featherTargetAnnounce:"feather_target_announce_v3.html",proxyServer:"",feather_baseURL:"",feather_stickerURL:"",googleTracker:"",MINIMUM_FLASH_PLAYER_VERSION:"10.2.0"};e.defaultTools="enhance effects frames overlay crop resize orientation focus brightness contrast saturation warmth sharpness colorsplash drawing textwithfont redeye whiten blemish".split(" ");
e.flashSupportedTools="enhance effects overlay crop resize orientation brightness contrast saturation sharpness drawing text redeye blemish".split(" ");e.baseConfig={image:null,apiKey:void 0,apiVersion:1,appendTo:null,language:"en",theme:null,minimumStyling:!1,maxSize:800,noCloseButton:!1,launchDelay:300,closeDelay:300,forceCropPreset:null,tools:void 0,initTool:"",cropPresets:["Custom","Original",["Square","1:1"],"3:2","3:5","4:3","4:5","4:6","5:7","8:10","16:9"],cropPresetDefault:"Custom",cropPresetsStrict:!1,
url:null,enableCORS:!1,postUrl:void 0,postData:null,fileFormat:"",jpgQuality:100,displayImageSize:!1,hiresMaxSize:1E4,hiresWidth:null,hiresHeight:null,onLoad:void 0,onReady:void 0,onSaveButtonClicked:void 0,onSave:void 0,onSaveHiRes:void 0,onClose:void 0,onError:void 0,signature:null,timestamp:null,hiresUrl:void 0,useCustomFileExpiration:!1,allowInAppPurchase:!1,forceFlash:!1,forceSupport:!1,poweredByURL:"http://www.aviary.com",giveFeedbackURL:"http://support.aviary.com/",getWidgetURL:"http://www.aviary.com",
debug:!1,asyncSave:!0};(function(b){var c=function(b){return{language:b.Feather_Language,forceFlash:b.Feather_ForceFlash,forceSupport:b.AV_Feather_ForceSupport,onLoad:b.Feather_OnLoad,onReady:b.Feather_OnLaunchComplete,onClose:b.Feather_OnClose,onSave:b.Feather_OnSave,noCloseButton:b.Feather_NoCloseButton,maxSize:b.Feather_MaxSize||b.Feather_MaxDisplaySize,tools:b.Feather_EditOptions,cropPresets:b.Feather_CropSizes,resizePresets:b.Feather_ResizeSizes,apiKey:b.Feather_APIKey,hiresUrl:b.Feather_HiResURL,
postUrl:b.Feather_PostURL,fileFormat:b.Feather_FileFormat||b.Feather_ContentType,jpgQuality:b.Feather_FileQuality,signature:b.Feather_Signature,timestamp:b.Feather_Timestamp}};e.baseConfig=e.util.extend(e.baseConfig,c(b));if("https:"==b.location.protocol||"chrome-extension:"==b.location.protocol){var d,f;for(f in e.build)d=f.split("_SSL"),2===d.length&&e.build[f]&&(d=d[0],e.build[d]=e.build[f])}(b.Feather_Theme||b.Feather_OpenType||b.Feather_APIKey)&&e.util.nextFrame(function(){var d=new e.Feather(e.baseConfig);
b.aviaryeditor=function(f,k,l,t){e.launchData=e.util.extend(e.baseConfig,c(b));f=e.util.extend(e.launchData,{image:f,url:k,postData:l,appendTo:t});d.launch(f)};b.aviaryeditor_close=d.close;b.aviaryeditor_relaunch=d.relaunch;b.aviaryeditor_activatetool=d.activateTool;b.aviarynewimage=d.replaceImage})})(d);e.getLocalizedString=function(b){try{var c=e.lang[e.launchData.language][b];void 0===c&&(c=b);return c}catch(d){}return b};Function.prototype.AV_bindInst=function(b){var c=this;return function(){return c.apply(b,
arguments)}};e.injectControls=function(){var b,d;"popup"==e.launchData.openType?(b="",d=e.template[e.launchData.layout].saveBlock()):(b=e.template[e.launchData.layout].saveBlock(),d="");if(e.criticalLayoutStyles&&!e.feather_loaded){var f=c.createElement("style");f.type="text/css";var l=c.createTextNode(e.criticalLayoutStyles);f.styleSheet?f.styleSheet.cssText=l.nodeValue:f.appendChild(l);c.getElementsByTagName("head")[0].appendChild(f)}b=e.template[e.launchData.layout].controls({internalSaveBlock:b,
externalSaveBlock:d});d=c.createElement("div");d.id="avpw_holder";f="";e.featherUseFlash&&(f="avpw_flash ");e.msie&&(f+="avpw_ie"+e.msie);f&&(d.className=f);(f=c.getElementsByTagName("body"))&&(f=f[0]);f||(f=c.documentElement);f.appendChild(d);d.innerHTML=b};e.Feather=function(b){var h=this,k=function(){e.injectControls();e.util.nextFrame(e.loadStageFinal)},l=function(){"undefined"!==typeof avpw$?avpw$(c).ready(k):k()};b&&(b.openType="aviary",b.layout="desktop");b=b||{};e.launchData=e.util.extend(e.baseConfig,
b);b=function(){function b(c){e.util.loadFile(e.build.feather_baseURL+"css/"+c+".css","css")}var c,d;e.featherUseFlash=!e.featherHtmlOk()&&e.featherFlashOk();e.launchData.language=e.launchData.language.toLowerCase();!e.feather_loaded&&!e.feather_loading&&(e.feather_loading=!0,c=e.launchData.language||"en",d="js/feathercontrols_desktop",d=e.validLanguages&&e.validLanguages[c]?d+("_"+c+".js"):d+"_en.js",e.launchData.minimumStyling?b("feather_core"):b("feather_theme_aviary"),e.util.loadFile(e.build.feather_baseURL+
"images/aviary_atlas.png","img"),e.build.bundled?l():e.util.loadFile(e.build.feather_baseURL+d,"js",l))};var p=function(){var b,c;e.featherUseFlash=!e.featherHtmlOk()&&e.featherFlashOk();e.launchData.language=e.launchData.language.toLowerCase();if(!e.feather_loaded&&!e.feather_loading){e.feather_loading=!0;b=e.launchData.language||"en";c="js/feathercontrols_desktop";c=e.validLanguages&&e.validLanguages[b]?c+("_"+b+".js"):c+"_en.js";!e.launchData.theme&&e.launchData.minimumStyling&&(e.launchData.theme=
"minimum");"minimum"==e.launchData.theme&&(e.launchData.minimumStyling=!0);e.launchData.theme||(e.launchData.theme="dark");switch(e.launchData.theme){case "dark":case "light":case "minimum":break;default:e.errorNotify("ERROR_BAD_THEME")}b=e.launchData.minimumStyling?"feather_core_":"feather_theme_aviary_";b+=e.launchData.theme;e.util.loadFile(e.build.feather_baseURL+"css/"+b+".css","css");e.build.bundled?l():e.util.loadFile(e.build.feather_baseURL+c,"js",l)}};if(2===e.util.getApiVersion(e.launchData)){e.build.feather_baseURL=
d.location.protocol+"//feather.aviary.com/2.6.2.184/";e.build.feather_baseURL_SSL=d.location.protocol+"//dme0ih8comzn4.cloudfront.net/2.6.2.184/";if("https:"==d.location.protocol||"chrome-extension:"==d.location.protocol)for(var q in e.build)p=q.split("_SSL"),2===p.length&&e.build[q]&&(p=p[0],e.build[p]=e.build[q]);b()}else p();var r=function(){if(e.paintWidgetInstance)return!1;e.paintWidgetLauncher(e.launchData.image,e.launchData.url)};h.launch=function(b){if(!e.feather_loaded)return!1;var d=c.getElementById("avpw_holder");
d||e.injectControls();if(e.paintWidgetInstance){if(d)return!1;h.close(!0)}b&&b.language&&delete b.language;e.launchData=b?e.util.extend(e.launchData,b):e.launchData;if(!e.launchData.image)return e.errorNotify("BAD_IMAGE"),!1;"object"===typeof b.forceCropPreset?(e.launchData.forceCropPreset=[b.forceCropPreset],e.launchData.initTool="forcecrop"):e.launchData.forceCropPreset=null;e.launchData.initTool&&(d.className="avpw_init_hide");if(e.featherUseFlash)r();else{if(!e.featherSupported())return e.errorNotify("UNSUPPORTED")&&
(e.controlsWidgetInstance=new e.ControlsWidget,e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"placeControls",[1<e.util.getApiVersion(e.launchData)?e.launchData.appendTo:void 0]),e.controlsWidgetInstance.bindControls(),c.getElementById("avpw_controls").style.display="block",e.controlsWidgetInstance.messager.show("avpw_aviary_unsupported",!0)),!0;e.util.nextFrame(r)}return!0};h.showWaitIndicator=function(){return e.controlsWidgetInstance&&e.controlsWidgetInstance.showWaitThrobber?(e.controlsWidgetInstance.showWaitThrobber(!0),
!0):!1};h.hideWaitIndicator=function(){return e.controlsWidgetInstance&&e.controlsWidgetInstance.showWaitThrobber?(e.controlsWidgetInstance.showWaitThrobber(!1),!0):!1};h.getImageDimensions=function(){var b=null;if(e.paintWidgetInstance&&(b=e.paintWidgetInstance.getScaledSize(),!e.launchData.hiresWidth||!e.launchData.hiresHeight))delete b.hiresWidth,delete b.hiresHeight;return b};h.save=function(){return!e.paintWidgetInstance?!1:e.controlsWidgetInstance.save()};h.saveHiRes=function(){return!e.paintWidgetInstance?
!1:e.controlsWidgetInstance.save("saveHiRes")};h.getImageData=function(b,c,d){return!e.paintWidgetInstance?!1:e.controlsWidgetInstance.save("getImageData",b,c,d)};h.close=function(b){if(!e.paintWidgetInstance)return!1;e.paintWidgetCloser(b)};h.relaunch=function(){f.trigger("usage:interact","api","relaunch");e.isRelaunched=!0;if(e.launchData)h.launch(e.launchData);else return!1};h.activateTool=function(b){f.trigger("tool:open",b,e.controlsWidgetInstance)};h.replaceImage=function(b){f.trigger("usage:interact",
"api","replaceImage");if(e.launchData)h.close(!0),e.util.nextFrame(function(){e.launchData.url=b;h.launch(e.launchData)});else return!1};h.updateConfig=function(b,c){if(e.launchData)if(b&&"object"===typeof b)for(var d in b)b.hasOwnProperty(d)&&(e.launchData[d]=b[d]);else if(b&&"string"===typeof b)e.launchData[b]=c;else return!1;else return!1};h.getIsDirty=function(){return e.paintWidgetInstance?e.paintWidgetInstance.dirty:!1};h.getActionList=function(){if(e.paintWidgetInstance)return f.trigger("tool:commit"),
e.paintWidgetInstance.actions.exportJSON(!0)};h.disableControls=function(){e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"disableControls")};h.enableControls=function(){e.controlsWidgetInstance.layoutNotify(e.launchData.openType,"enableControls")};h.on=function(b,c){if(f&&b&&c&&"function"===typeof c)f.on(b,c)};h.off=function(b,c){f&&(b&&c&&"function"===typeof c)&&f.off(b,c)};return h};e.loadStageFinal=function(){e.feather_loaded=!0;if("function"===typeof e.launchData.onLoad)e.launchData.onLoad()};
e.featherSupported=function(){return e.featherHtmlOk()||e.featherFlashOk()||e.launchData.forceSupport};e.featherFlashOk=function(){return e.launchData.forceFlash?!0:avpw_swfobject&&avpw_swfobject.hasFlashPlayerVersion(e.build.MINIMUM_FLASH_PLAYER_VERSION)};e.featherHtmlOk=function(){if(e.launchData.forceFlash)return!1;var b=!!c.createElement("canvas").getContext,f="function"===typeof d.postMessage;return b&&f};e.getFlashMovie=function(b){return d[b]||c[b]};e.msie=function(){for(var b=3,d=c.createElement("div"),
e=d.getElementsByTagName("i");d.innerHTML="\x3c!--[if gt IE "+ ++b+"]><i></i><![endif]--\x3e",e[0];);return 4<b?b:void 0}();e.firefox=function(){var b;"Gecko"===d.navigator.product&&(b=navigator.userAgent.split("Firefox/")[1],b=parseInt(b,10));return b}();e.PAGE_WIDTH=360;e.setPageWidth=function(b){e.PAGE_WIDTH=b};return b})(this,"undefined"!==typeof window?window:{},"undefined"!==typeof document?document:{});
(function(b,d,c){b.support=function(b){var d=b.navigator.userAgent,g=b.screen.width;b={0:/Android/i,1:/webOS/i,2:/iPhone/i,3:/iPod/i,4:/BlackBerry/i,5:/iPad/i};var h,k=0,l=0,p=0,q;for(q in b)d.match(b[q])&&(h=parseInt(q));d.match(/AppleWebKit/i)&&(k=1);0===h&&(l=1);1===l&&(d=d.match(/Android [0-9].[0-9]/).toString())&&(p=parseFloat(d.split("Android ")[1]));d={isAppleWebkit:function(){return 1===k},isMobileWebkit:function(){return 1===k&&g&&(480>=g||0<p&&2.3>=p)},isIPhoneOrIPod:function(){return 2===
h||3===h},isAndroid:function(){return 1===l},getAndroidVersion:function(){return p}};d.getVendorProperty=function(){var b={};return function(d){var e;if(!(e=b[d])){a:{var f=c.createElement("div");e=d;var g=["webkit","ms","Moz","O"],h,k=f.style;if(void 0===k[e]){e=e.charAt(0).toUpperCase()+e.slice(1);for(h=0;h<g.length;h++)if(f=g[h]+e,void 0!==k[f]){e=f;break a}e=void 0}}e=b[d]=e}return e}}();return d}(d)})(window.AV||(window.AV={}),window,document);YUI.add("thirdparty-aviary",function(b){},"3.1");
YUI.add("squarespace-layout-snapshot",function(b){b.Node.create("<div></div>").setStyles({position:"fixed",top:0,left:0,width:"100%",height:"100%",background:"rgba(255, 0, 0, 0.5)",zIndex:1E7})},"1.0",{requires:["squarespace-dialog-text-area"]});
YUI.add("squarespace-dialog-content-selector",function(b){var d=b.namespace("Squarespace.DialogFields").ContentSelector=b.Base.create("contentSelector",b.Squarespace.DialogField2,[],{initializer:function(c){b.Lang.isValue(c.data)&&this.set("selectedContent",c.data);(this._collectionGroupsCreated=c=b.Lang.isValue(this.get("collectionGroups")))||(0===b.Squarespace.ContentCollectionCache.size()?b.Squarespace.ContentCollectionCache.load(b.bind(function(){this._createCollectionGroups();this.syncUI()},
this)):this._createCollectionGroups())},bindUI:function(){var b=this.get("contentBox");b.delegate("click",function(b){b.target.hasClass("dropdown-button")?b.currentTarget.ancestor(".collection-wrapper").toggleClass("open"):this._selectCollection(b)},".collection",this);b.delegate("change",this._selectCategoryOrTag,"select",this)},syncUI:function(){d.superclass.syncUI.call(this);this._collectionGroupsCreated?this._setLoadedState():this._showSpinner();this.get("contentBox").toggleClass("titles-hidden",
!this.get("showGroupTitles"))},clearSelected:function(){var b=this._selectedCollectionWrapper;if(b){b.removeClass("selected");var c=b.one(".collection-filter");c&&(c.remove(),b.one(".right-paren").remove(),b.all("select").set("value","None"))}},_showSpinner:function(){var c=b.Node.create('<div class="loading"><div class="spinner"></div><div class="text">Loading...</div></div>');this.get("contentBox").setHTML(c);(new b.Squarespace.Spinner({size:20,color:"light",render:c.one(".spinner")})).spin()},
_setLoadedState:function(){var c=this.get("contentBox"),d=this.get("collectionGroups"),g=this.get("selectedContent"),d={collectionGroups:d,emptyMessage:this.get("emptyMessage")};b.Lang.isArray(g)&&(0<g.length&&g[0].filter)&&(d.filter=g[0].filter);c.setHTML(b.Squarespace.UITemplates.render("dialog-content-selector.html",d));c.all(".collection-wrapper").each(function(b){b.hasClass("selected")&&(this._selectedCollectionWrapper=b)},this);c.all(".dropdown").each(function(b){var c=b.one(".categories"),
d=b.one(".tags");c&&d?b.addClass("content-stats"):c?b.addClass("categories"):d&&b.addClass("tags")},this)},_selectCollection:function(b){b=b.currentTarget.ancestor(".collection-wrapper");this.clearSelected();b.addClass("selected");this._selectedCollectionWrapper=b;this.set("data",{urlId:b.getAttribute("data-url-id"),filter:null,id:b.getAttribute("data-collection-id")})},_selectCategoryOrTag:function(c){var d=c.currentTarget;c=d.ancestor(".collection-wrapper");var g=d.ancestor(".categories")?"category":
"tag",d=d.get("value"),h=("tag"===g?"#":"")+d;this.clearSelected();c.one(".collection-title").insert(b.Node.create('<div class="collection-filter">('+h+'</div><div class="right-paren">)</div>'),"after");c.addClass("selected");c.addClass("has-content-stat-filter");c.removeClass("open");this._selectedCollectionWrapper=c;this.set("data",{urlId:c.getAttribute("data-url-id"),filter:"none-selected"===d?null:{type:g,name:d},id:c.getAttribute("data-collection-id")})},_getCollections:function(c){var d=b.merge({},
this.get("collectionFilter"));if(d){for(var g in d)if(b.Object.hasKey(c,g)){var h=b.Lang.isArray(d[g]);if(h&&-1===b.Array.indexOf(d[g],c[g])||!h&&c[g]!=d[g])return[];h&&(d[g]=c[g])}c=b.merge(c,d)}return b.Squarespace.ContentCollectionUtils.filterCollections(c,this.get("excludeCollectionIds"))},_createCollectionGroups:function(){var c=this._getCollections({collectionType:b.Squarespace.CollectionTypes.GENERIC,folder:!1}),d=this._getCollections({collectionType:b.Squarespace.CollectionTypes.PAGE,folder:!1}),
g=this._getCollections({collectionType:b.Squarespace.CollectionTypes.PRODUCT,folder:!1}),h=this._getCollections({collectionType:b.Squarespace.CollectionTypes.TEMPLATE_PAGE,folder:!1});collectionGroups=b.Squarespace.ContentCollectionUtils.groupCollectionsByTypeName(c);0<d.length&&collectionGroups.push({title:"Page",collections:d});0<g.length&&collectionGroups.push({title:"Product",collections:g});0<h.length&&collectionGroups.push({title:"Template Pages",collections:h});this.set("collectionGroups",
collectionGroups);this._collectionGroupsCreated=!0},_setStatOnCollectionObject:function(c,d,g,h){var k=[];b.Array.each(d,function(c){var d=c.name,e={name:d};g&&b.Lang.isArray(g)&&b.Array.each(g,function(c,f){d===b.Object.getValue(c,["filter","name"])&&(e.selected=!0)});k.push(e)},this);h[c]=k},_setSelectedOnCollectionObject:function(c,d){b.Array.each(c,function(c,e){if(d.id===c.id&&(!b.Object.hasKey(c,"urlId")||c.urlId===d.urlId))d.selected=!0;c.filter&&(d.filter=c.filter)})}},{CSS_PREFIX:"sqs-content-selector",
ASYNC_DATA:!0,ATTRS:{collectionGroups:{setter:function(c){var d=this.get("selectedContent");b.Array.each(c,function(c){c.collectionObjects=[];b.Array.each(c.collections,function(e){var k=[],l=[],p=b.Squarespace.ContentStatsCache.filter(function(b){return e.get("id")===b.get("collectionId")},this)[0];p&&(k=p.get("categoryList"),l=p.get("tagList"));p=function(b,c){return b.name<c.name?-1:b.name>c.name?1:0};k.sort(p);l.sort(p);p={className:b.Squarespace.ContentCollectionUtils.getIconClassNames(e),id:e.get("id"),
title:e.get("navigationTitle"),urlId:e.get("urlId")};this.get("showCollectionTagsAndCategories")&&(p.dropdown=0!==k.length||0!==l.length,this._setStatOnCollectionObject("categories",k,d,p),this._setStatOnCollectionObject("tags",l,d,p));d&&this._setSelectedOnCollectionObject(d,p);c.collectionObjects.push(p)},this)},this);this._collectionGroupsCreated=!0;return c},value:null},collectionFilter:{value:null},data:{getter:function(c){c=this.get("dataMapper");var d=this.get("selectedContent");return b.Lang.isFunction(c)?
c(d):d},setter:function(b){this.set("selectedContent",b);return b}},selectedContent:{setter:function(c){return b.Lang.isArray(c)?b.Array.map(c,d.mapToObject):b.Lang.isValue(c)?[d.mapToObject.apply(null,arguments)]:c}},dataMapper:{value:function(b){return b},validator:b.Lang.isFunction},excludeCollectionIds:{value:[]},emptyMessage:{value:"There are no collections."},showCollectionTagsAndCategories:{value:!0},showGroupTitles:{value:!0}},mapToObject:function(c,d,g){var h={};if(b.Lang.isObject(c))if(b.instanceOf(c,
b.Model))h.id=c.get("id");else return c;else b.Lang.isValue(c)&&(h.id=c);b.Lang.isObject(d)&&!b.Lang.isArray(d)&&(h.filter=d);b.Lang.isString(g)&&(h.urlId=g);return h}}),c=function(c){if(b.Lang.isArray(c)){if(1>c.length)return"";c=c[0]}var d=b.Lang.isObject(c);return d&&b.Object.hasKey(c,"id")?c.id:d&&b.instanceOf(c,b.Model)?c.get("id"):c};b.namespace("Squarespace.DialogFields").ContentIdSelector=b.Base.create("contentIdSelector",b.Squarespace.DialogFields.ContentSelector,[],{},{ATTRS:{dataMapper:{value:c}}});
b.namespace("Squarespace.DialogFields").ContentIdArraySelector=b.Base.create("contentIdArraySelector",b.Squarespace.DialogFields.ContentSelector,[],{},{ATTRS:{dataMapper:{value:function(d){return b.Lang.isArray(d)?b.Array.map(d,c):[c(d)]}}}})},"1.0",{requires:"base base-build squarespace-dialog squarespace-dialog-field-2 squarespace-dialog-content-selector-template squarespace-animations squarespace-hb-compare squarespace-content-collection-utils squarespace-models-content-stats squarespace-ui-templates".split(" ")});
YUI.add("squarespace-content-item-types-post-editors",function(b){},"1.0",{requires:[]});
YUI.add("squarespace-content-item-types-quote",function(b){b.namespace("Squarespace.ContentItemEditor").Quote=b.Base.create("QuoteContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",width:800,height:450,overlay:0.5,tabs:[{$include:["tabs.primary.base","tabs.primary.quote"]},{$include:"tabs.options.default"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-form-utils",function(b){var d=b.namespace("Squarespace.FormUtils");d.setData=function(c,d){b.Lang.isValue(d)&&b.Array.each(c,function(c){var g=d[c.get("name")];b.Lang.isUndefined(g)||c.set("data",g)})};d.getData=function(c){c=c||[];return b.Array.reduce(c,{},function(c,d){var g=d.get("data");!b.Lang.isUndefined(g)&&b.Lang.isValue(d.get("name"))&&(c[d.get("name")]=g);return c})};d.template=function(c,d){b.Lang.isArray(d)?b.Array.each(d,function(b){var d=b.get("name"),e=c.one('[data-field-name="'+
d+'"]');e?b.render(e):console.warn('No target node found for widget "'+d+'".')}):b.Lang.isObject(d)&&b.Object.each(d.groups||{},function(d,e){var h=c.one('[data-field-group="'+e+'"]');h&&b.Array.each(d,function(b){b.render(h)})})};d.validate=function(c){return b.Array.reduce(c,{},function(c,d){if(b.Lang.isFunction(d.getErrors)){var g=d.getErrors();g.length&&(c[d.get("name")]=g[0])}return c})};d.showErrors=function(c,d){b.Array.each(c,function(c){var g=d[c.get("name")];b.Lang.isValue(g)&&""!==g&&b.Lang.isFunction(c.showError)&&
c.showError(g)})};d.hideErrors=function(c){b.Array.each(c,function(c){b.Lang.isFunction(c.hideError)&&c.hideError()})}},"1.0",{requires:["node","array-extras"]});
YUI.add("squarespace-settings-billing-linked",function(b){var d=b.namespace("Squarespace.Widgets").BillingSettingsLinked=b.Base.create("billingSettingsLinked",b.Squarespace.Widgets.SettingsPanel,[b.Squarespace.Widgets.BillingSettingsBase],{bindUI:function(){d.superclass.bindUI.call(this);this.on("fields-rendered",function(){this.getField("linkv5").setOnClick(this._unlinkAccount,this)},this)},_getHBTemplateContext:function(){var c=d.superclass._getHBTemplateContext.call(this);c.inBadStanding=Static.SQUARESPACE_CONTEXT.website.siteStatus.value===
b.Squarespace.StatusConstants.TRIAL;return c},_unlinkAccount:function(){var c=this.getField("linkv5");(new b.Squarespace.Widgets.Confirmation({position:b.Squarespace.Widgets.Confirmation.ANCHOR.ELEMENT,anchor:c.get("boundingBox"),showOverlay:!0,"strings.confirm":"Unlink Account","strings.title":"Unlink Account?","strings.message":"This Squarespace 6 account will no longer be free."})).on("confirm",function(){b.Data.post({url:"/api/account/UnlinkAccount",data:{autorenew:!1},success:function(){this.showSuccessConfirmation("V5 Account Unlinked",
"That Squarespace 5 account is no longer connected to this site.");window.location.reload()}},this)},this)}},{HANDLEBARS_TEMPLATE:"settings-site-billing-linked.html",TEMPLATED:!0,CSS_PREFIX:"sqs-billing-settings-linked",ATTRS:{buttons:{value:[]},fields:{valueFn:function(){return[{ctor:b.Squarespace.DialogFields.Description,config:{name:"account-center-description",title:"Go To Account Center",text:"Log into to your Squarespace 5 Website Manager."}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"account-center-button",
"strings.text":"Go to Squarespace 5 Billing",href:"https://"+Static.SQUARESPACE_CONTEXT.website.linkedAccountIdentifier+".squarespace.com/display/configuration/AccountCenter"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"unlink-description",title:"Unlink Account",text:"Unlink Squarespace 5 billing and place this account into trial."}},{ctor:b.Squarespace.DialogFields.Button,config:{name:"linkv5","strings.text":"Unlink Squarespace 5 Account Billing",className:"sqs-button-light"}},{ctor:b.Squarespace.DialogFields.Description,
config:{name:"v5-membership-bad-description",title:this._getExpirationString(),text:"Your Squarespace 5 account is not active and in good standing.",padding:[0,10],className:"trial billing-subpanel-unavailable"}},{ctor:b.Squarespace.DialogFields.Description,config:{name:"v5-membership-ok-description",padding:[0,10],className:"billing-subpanel-unavailable",title:"This account is included in with your Squarespace 5 Membership.",text:"As long as your Squarespace 5 account is active, this account will remain free. If you unlink your Squarespace 5 account, this account will revert to trial status for 24-hours."}}]}}}})},
"1.0",{requires:"squarespace-settings-panel squarespace-dialog-button squarespace-dialog-description squarespace-settings-billing-base squarespace-settings-site-billing-linked-template squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-models-google-apps-subscription",function(b){var d=b.namespace("Squarespace.Models").GoogleAppsSubscription=b.Base.create("googleAppsSubscription",b.Model,[b.Squarespace.ModelSync.REST],{url:"/api/google-apps/{customerId}/subscriptions/",initializer:function(){this.root="/api/google-apps/"+this.get("customerId")+"/subscriptions/"},parse:function(){var c=d.superclass.parse.apply(this,arguments);b.Lang.isNumber(c.suspensionDate)&&(c.suspensionDate=new Date(c.suspensionDate));return c},
toJSON:function(){var c=d.superclass.toJSON.call(this);b.Lang.isValue(c.customer)&&(c.customer=c.customer.toJSON(),c.customerId=c.customer.domain);return c}},{ATTRS:{suspended:{getter:function(){return b.Lang.isValue(this.get("suspensionDate"))}},domainId:{validator:b.Lang.isString},customerId:{validator:b.Lang.isString,writeOnce:"initOnly"},customer:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.GoogleAppsCustomer)}}})},"1.0",{requires:["base","model","squarespace-attr-validators",
"squarespace-model-sync-rest","squarespace-models-google-apps-customer"]});
YUI.add("squarespace-external-image-picker",function(b){var d=b.namespace("Squarespace.Widgets").ExternalImagePicker=b.Base.create("externalImagePicker",b.Squarespace.SSWidget,[b.WidgetParent],{initializer:function(b){if(!b.scrapeUrl)throw this.name+": A scrapeUrl is required in the initialization config.";},renderUI:function(){d.superclass.renderUI.call(this);this._imagePicker=new b.Squarespace.Widgets.ImagePicker({hideOnSelect:this.get("hideOnSelect"),"strings.noImages":"No large images available at that URL."});
this.after(this.get("id")+"|hideOnSelectChange",function(b){this._imagePicker.set("hideOnSelect",b.newVal)},this);this.add(this._imagePicker)},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("id");this._imagePicker.after(b+"|selectedImageURLChange",function(b){this._set("selectedImageURL",b.newVal)},this);this._imagePicker.after(b+"|cancel",function(b){this.fire("cancel")},this);this.on(b+"|visibleChange",this._updateVisibility,this)},syncUI:function(){d.superclass.syncUI.call(this);
this._scrapeUrl()},_scrapeUrl:function(){this._imagePicker.set("dataState",this._imagePicker.getProperty("DATA_STATES").LOADING);b.Data.post({url:"/api/scrape/LocateInterestingTags",data:{url:this.get("scrapeUrl")},success:function(b){this._showLargeImages(b.images)},failure:function(b){b=this._imagePicker.getProperty("DATA_STATES").LOAD_FAILED;this._imagePicker.set("dataState",b)}},this)},_showLargeImages:function(c){if(c&&0===c.length)this._imagePicker.setLoadedState();else{var d=this.get("id"),
f=new b.Squarespace.AsyncTaskSynchronizer({completionCallback:function(b){this._imagePicker.setLoadedState()},callbackContext:this}),g=this.get("minimumImageDimensions"),h=[];b.Array.each(c,function(c){var l=new b.Squarespace.Image({src:c,loadOnSrcChange:!1});l.after(d+"|loadCompleteChange",function(b){!l.get("loadFailed")&&(l.get("width")>=g.width&&l.get("height")>=g.height)&&(b=this._imagePicker.get("imageURLs"),b.push(c),this._imagePicker.set("imageURLs",b))},this);f.add(l,"loadCompleteChange");
h.push(l)},this);b.Array.each(h,function(b){b.load()},this)}},_updateVisibility:function(b){b.silent||b.newVal===b.prevVal||(b.preventDefault(),this._imagePicker.after(this.get("id")+"|visibleChange",function(b){this.set("visible",b.newVal,{silent:!0})},this),b.newVal?this._imagePicker.show():this._imagePicker.hide())},show:function(){d.superclass.show.call(this);this.set("visible",!0)},hide:function(){d.superclass.hide.call(this);this.set("visible",!1)}},{CSS_PREFIX:"sqs-external-image-picker",ATTRS:{visible:{value:!1},
scrapeUrl:{value:"",writeOnce:"initOnly"},minimumImageDimensions:{writeOnce:"initOnly",value:{height:150,width:150}},selectedImageURL:{value:null,readOnly:!0},hideOnSelect:{value:!0}}})},"1.0",{requires:["base","base-build","squarespace-image-picker","squarespace-async-task-synchronizer","squarespace-image"]});
YUI.add("squarespace-editor-navigation-external-link",function(b){var d={name:"navigationlinkconfig",waitForServerOnClose:!0,loadingText:"Loading Configuration...",style:"flyout",width:450,height:305,tabs:[{title:"Configure Link",icon:"/universal/images-v6/icons/icon-settings-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"title","strings.placeholder":"Enter a Title",required:!0,submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.CreateLink,config:{name:"createLink",condensed:!0,
required:!0}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove Link"},{type:"saveAndClose",title:"Save"}]};b.namespace("Squarespace.Editor").NavigationExternalLink=b.Base.create("NavigationExternalLinkModelEditor",b.Squarespace.ModelEditorDialog,[],{getDialogData:function(){var b=this.get("model").get("externalLink");return{title:b.title,createLink:{url:b.url,newWindow:b.newWindow}}},sanitizeDialogData:function(b){this.get("model").set("externalLink",{title:b.title,url:b.createLink.url,
newWindow:b.createLink.newWindow})}},{ATTRS:{dialogConfig:{value:d}}})},"1.0",{requires:["squarespace-dialog-text","squarespace-dialog-create-link","squarespace-model-editor"]});
YUI.add("squarespace-content-collection-utils",function(b){b.namespace("Squarespace").ContentCollectionUtils={groupCollectionsByTypeName:function(d){for(var c={},e=0;e<d.length;e++){var f=d[e];if(!f.get("isDemoCollection")){f=f.get("typeName");if(!c[f]){var g=b.Squarespace.Singletons.Template.get("collectionConfigs."+f);c[f]={title:g?g.get("title"):"Unknown",collections:[]}}c[f].collections.push(d[e])}}return b.Object.values(c)},getIconClassNames:function(b){var c=b.getTemplateConfiguration(),e="";
c&&c.get("supported")&&(e=c.get("icon"));""===e&&(e=b.get("typeName"));return e},filterCollections:function(d,c){var e=["collectionType","ordering","folder"];return b.Squarespace.ContentCollectionCache.filter(function(f){if(b.Lang.isArray(c)&&-1!==c.indexOf(f.get("id"))||f.get("isDemoCollection"))return!1;var g=!0,h=f.getTemplateConfiguration(),k;for(k in d)if(g=d[k],b.Lang.isArray(g)||(g=[g]),g=b.Array.some(g,function(c,d){var g=k,r=-1!==e.indexOf(g),s=b.Lang.isValue(h)&&h.get(g)===c,g=f.get(g)===
c;return r?s:g}),!g)break;return g})},isTemplatePage:function(d){return d.get("type")===b.Squarespace.CollectionTypes.TEMPLATE_PAGE},isIndex:function(d){return(d=d.getTemplateConfiguration())&&d.get("folderBehavior")==b.Squarespace.FolderBehavior.INDEX?!0:!1},isAdjustablePageSizeCollection:function(d){return!this.isIndex(d)&&d.get("type")==b.Squarespace.CollectionTypes.GENERIC&&this._getCollectionOrdering(d)==b.Squarespace.CollectionOrdering.CHRONOLOGICAL},_getCollectionOrdering:function(b){return b.get("ordering")||
b.getTemplateConfiguration().get("ordering")},isPostableByEmailAddress:function(d){var c=this._getCollectionOrdering(d);return!this.isIndex(d)&&d.get("type")==b.Squarespace.CollectionTypes.GENERIC&&c!==b.Squarespace.CollectionOrdering.CALENDAR&&c!==b.Squarespace.CollectionOrdering.CUSTOM&&c!==b.Squarespace.CollectionOrdering.MUSIC_ALBUM},isSupportedByBookmarklet:function(d){return!this.isIndex(d)&&d.get("type")==b.Squarespace.CollectionTypes.GENERIC&&this._getCollectionOrdering(d)==b.Squarespace.CollectionOrdering.CHRONOLOGICAL},
hasSupportForInjectableCodePerItem:function(d){return!this.isIndex(d)&&d.get("type")==b.Squarespace.CollectionTypes.GENERIC&&this._getCollectionOrdering(d)==b.Squarespace.CollectionOrdering.CHRONOLOGICAL},hasSupportForSyndication:function(d){return!this.isIndex(d)&&d.get("type")==b.Squarespace.CollectionTypes.GENERIC&&this._getCollectionOrdering(d)==b.Squarespace.CollectionOrdering.CHRONOLOGICAL},isDemoCollectionId:function(d){var c=Static.SQUARESPACE_CONTEXT.demoCollections;return!c?!1:!!b.Array.find(c,
function(b){return b.collectionId==d})},isGenericOrProduct:function(d){d=d.getTemplateConfiguration();var c=b.Squarespace.CollectionTypes;return!d?!1:!1===d.get("folder")&&(d.get("collectionType")===c.PRODUCT||d.get("collectionType")===c.GENERIC)},isProduct:function(d){var c=d.getTemplateConfiguration(),e=b.Squarespace.CollectionTypes;return!c||d.get("isDemoCollection")?!1:!1===c.get("folder")&&c.get("collectionType")===e.PRODUCT},isPage:function(d){d=d.getTemplateConfiguration();var c=b.Squarespace.CollectionTypes;
return!d?!1:!1===d.get("folder")&&d.get("collectionType")===c.PAGE},isNotCalendar:function(d){return d.getTemplateConfiguration().get("ordering")===b.Squarespace.CollectionOrdering.CALENDAR?!1:!0}}});
YUI.add("squarespace-hb-roles",function(b){b.Handlebars.registerHelper("has-role",function(d,c){c||(c=d,d=Static.SQUARESPACE_CONTEXT.authenticatedAccount);if(b.Lang.isUndefined(c.hash.role))throw"A role is required.";return(new b.Squarespace.Models.Admin.MemberAccount(d)).hasRole(c.hash.role)?c.fn(this):c.inverse(this)});b.Handlebars.registerHelper("has-any-role",function(d,c){c||(c=d,d=Static.SQUARESPACE_CONTEXT.authenticatedAccount);if(b.Lang.isUndefined(c.hash.roles))throw"A set of roles is required.";
var e=new b.Squarespace.Models.Admin.MemberAccount(d),f=c.hash.roles.split(", ");return b.Array.some(f,e.hasRole,e)?c.fn(this):c.inverse(this)});b.Handlebars.registerHelper("unless-has-role",function(d,c){c||(c=d,d=Static.SQUARESPACE_CONTEXT.authenticatedAccount);if(b.Lang.isUndefined(c.hash.role))throw"A role is required.";return(new b.Squarespace.Models.Admin.MemberAccount(d)).hasRole(c.hash.role)?"":c.fn(this)});b.Handlebars.registerHelper("has-permission",function(d){if(b.Lang.isUndefined(d.hash.permissionName))throw"A permissionName is required.";
return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions[d.hash.permissionName])?d.fn(this):d.inverse(this)});b.Handlebars.registerHelper("unless-has-permission",function(d){if(b.Lang.isUndefined(d.hash.permissionName))throw"A permissionName is required.";return b.Squarespace.Utils.userHasAccessPermission(b.Squarespace.AccessPermissions[d.hash.permissionName])?"":d.fn(this)})},"1.0",{requires:["handlebars-base","squarespace-util","squarespace-admin-models-member-account"]});
YUI.add("squarespace-settings-site-share-buttons-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-site-share-buttons.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n    <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var p="function",q=this;b='<div class="share-buttons-setting-panel">\n  ';
if((c=d["with"].call(c,c.strings,{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e="\n    ";if((f=d["if"].call(b,b.description,{hash:{},inverse:q.noop,fn:q.program(2,l,c),data:c}))||0===f)e+=f;e+='\n    <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "},k),data:k}))||0===c)b+=c;return b+'\n\n  <div class="settings-panel-fields">\n\n    <div class="sharing-wrapper">\n      <div data-field-name="facebookSharingEnabled"></div>\n      <div data-field-name="twitterSharingEnabled"></div>\n      <div data-field-name="googleSharingEnabled"></div>\n      <div data-field-name="linkedinSharingEnabled"></div>\n      <div data-field-name="stumbleSharingEnabled"></div>\n      <div data-field-name="redditSharingEnabled"></div>\n      <div data-field-name="pinterestSharingEnabled"></div>\n      <div data-field-name="tumblrSharingEnabled"></div>\n    </div>\n\n    <div class="pinterest-fields">\n      <div data-field-name="pinterest-description"></div>\n      <div data-field-name="pinterestButtonMode"></div>\n      <div data-field-name="pinterestButtonSize"></div>\n      <div data-field-name="pinterestButtonShape"></div>\n      <div data-field-name="pinterestButtonColor"></div>\n      <div data-field-name="pinterest-preview"></div>\n    </div>\n\n  </div>\n</div>\n'})})();
b.Handlebars.registerPartial("settings-site-share-buttons.html".replace("/","."),d.templates["settings-site-share-buttons.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-gallery-editor",function(b){b.namespace("Squarespace.Block.Editor").Gallery=b.Base.create("galleryEditor",b.Squarespace.Block.Editor.Dialog,[],{initializer:function(d){var c=this.get("host"),e=this._host.get("model"),f=this.configDialog.get("dialog");f.on("ready",function(){f.getField("options").after("options-changed",this._syncGallery,this)},this);e.after("change",function(b){b="slider"===e.get("design");this.set("resizable",b)},this);this.onHostEvent("resized",function(b){"columnChanged"===
b.source&&"slideshow"===e.get("design")&&c._setWidgetContent()},this);this.onHostEvent("dropped",function(d){d.oldCol!==b.Squarespace.Block.Utils.getColumnWidth(c.get("contentBox"))&&c._setWidgetContent()},this);this.afterHostEvent(["dropped","resized","widget:contentUpdate"],this.refreshGallery,this);this.beforeHostMethod("_renderBlock",this._lockBlockHeight,this);this.onHostEvent("widget:contentUpdate",function(b){this._host.requestingContent||this._unlockBlockHeight()},this);this.configDialog.on("gallery-refresh",
c._renderBlock,c)},_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.Gallery")},_lockBlockHeight:function(){var b=this._host.get("boundingBox");b.test(".sqs-locked-height")||(b.addClass("sqs-locked-height"),b.setStyles({maxHeight:b.get("region").height,overflow:"hidden"}))},_unlockBlockHeight:function(b){b=this._host.get("boundingBox");b.removeClass("sqs-locked-height");b.setStyles({maxHeight:null,overflow:null})},_setExtraDesignStyles:function(){var b=
this._model.getAttrs();switch(b.design){case "grid":this.configDialog.renderGridCSS(this.get("host").get("contentBox"),b);break;case "slideshow":this.configDialog.renderSlideshowCSS(this.get("host").get("contentBox"),b)}},refreshGallery:function(){this._setExtraDesignStyles();var b=this.get("host").get("contentBox").one(".sqs-gallery");b&&b.getData("gallery").refresh()},isSlider:function(){return"slider"===this.get("host").get("model").get("design")},_syncGallery:function(b,c){var e=b.get("name");
this.configDialog.get("dialog").getField("options").get("currentDesign");var f=this._host.get("contentBox");this.configDialog.syncGalleryOptions(e,f)}},{NS:"blockEditor",ATTRS:{resizeNode:{valueFn:function(){return this.get("host").get("boundingBox")}},resizable:{valueFn:function(){return this.isSlider()}}}})},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-block-mixin-gallery-option-sync squarespace-content-collection-utils squarespace-damask-context-globals squarespace-dialog-content-item-grid squarespace-dialog-gallery-options squarespace-dialog-multi-frame squarespace-dialog-multi-option squarespace-gallery-option-synchronizer squarespace-models-content-collection squarespace-plugin-actionoverlay".split(" ")});
YUI.add("squarespace-dialog-variants-pricing-placeholder",function(b){b.namespace("Squarespace");var d=b.namespace("Squarespace.DialogFields").VariantsPricingPlaceholder=b.Base.create("variantsPricingPlaceholder",b.Squarespace.DialogFields.PricingPlaceholder,[],{initializer:function(){},syncUI:function(){d.superclass.syncUI.call(this);this._setVariantCount()},_setVariantCount:function(){var c=this.get("data.variants").length;0===c&&(c=1);c=1>=c?"":b.Node.create('<span class="separator">-</span>'+
c+" variants");this.get("contentBox").one(".variant-count").setHTML(c)},_getHBTemplateContext:function(){var b=d.superclass._getHBTemplateContext.call(this);b.hasVariants=!0;return b}},{CSS_PREFIX:"sqs-variants-pricing-placeholder",ATTRS:{strings:{value:{title:"Pricing & Variants",prompt:"Edit"}}}})},"1.0",{requires:["squarespace-dialog-pricing-placeholder"]});
YUI.add("squarespace-stats-timeline-stack-graph",function(b){var d=b.namespace("Squarespace.Stats.Widgets").TimelineStackGraph=b.Base.create("statsTimelineStackGraph",b.Squarespace.Widgets.SSWidget,[],{_mouseQueue:null,_mouseData:[],_panZoom:!1,_oldDomain:null,_mouseWheelTimeout:null,renderUI:function(){d.superclass.renderUI.apply(this,arguments);var c=this.get("contentBox")._node,e=d3.select(c).append("svg"),f=this.get("margin"),g=this.get("width"),h=this.get("height"),k=g-f.left-f.right,l=h-f.top-
f.bottom,p=d3.time.scale().range([0,k]),q=d3.scale.linear().range([l,0]),r=this.get("interpolation"),f=d3.svg.axis().scale(p).orient("bottom").tickFormat(this._tickFormat),k=d3.svg.axis().scale(q).orient("right").tickSubdivide(!0).ticks(5).tickSize(k),s=d3.svg.area().interpolate(r).x(function(b){return p(b.d)}).y0(function(b){return q(b.y0)}).y1(function(b){return q(b.y0+b.y)}),t=d3.svg.area().interpolate(r).x(function(b){return p(b.d)}).y0(l).y1(l),r=d3.svg.area().interpolate(r).x(function(b){return p(b.d)}).y0(l).y1(function(b){return q(b.count)}),
u=b.one(e.node()).getY();e.attr("width",g).attr("height",h);e.on("mousedown",b.bind(function(){this._changeDragCursor(!0,e);this._setPanZoom(!0)},this)).on("mouseup",b.bind(function(){this._changeDragCursor(!1,e);this._setPanZoom(!1);this.get("rangeGraph")._onBrushEnd()},this));this._changeDragCursor(!1,e);g=e.append("defs").append("pattern").attr("id","stream-bg").attr("x",0).attr("y",0).attr("width",20).attr("height",20).attr("patternUnits","userSpaceOnUse");g.append("rect").attr("x",0).attr("y",
0).attr("width",20).attr("height",20);g.append("image").attr("x",0).attr("y",0).attr("width",20).attr("height",20).attr("xlink:href","/universal/images-v6/stats/white-stripe.png");e.append("g").attr("class","x axis").attr("transform","translate(0,"+l+")");e.append("g").attr("class","y axis");e.append("g").attr("class","total");e.append("g").attr("class","stack");e.append("g").attr("class","y axis y-2");l=e.append("g").attr("class","marker").style("display","none");this._renderLine(l,0,0,h,0).attr("class",
"x line");l.append("circle").attr("r",5);h=d3.select(c).append("div").attr("class","marker-tooltip").style("display","none");h.append("div").attr("class","x");h.append("div").attr("class","y");c=d3.select(c).append("div").attr("class","graph-tooltip").style("display","none");this.set("xScale",p);this.set("yScale",q);this.set("xAxis",f);this.set("yAxis",k);this.set("yOffset",u);this.set("area",s);this.set("emptyArea",t);this.set("totalArea",r);this.set("svg",e);this.set("marker",l);this.set("markerTooltip",
h);this.set("tooltip",c);this.set("pattern",g)},bindUI:function(){d.superclass.bindUI.apply(this,arguments);var c=this.get("model"),e=this.get("svg");this.get("marker");this.get("markerTooltip");c.on("extentChange",function(b){this._changeExtent(b.newVal)},this);c.on("normalizedTotalsDataChange",function(b){this.set("totalsData",b.newVal)},this);c.on("normalizedDataChange",function(b){this.set("data",b.newVal)},this);c.on("totalsByDateChange",function(b){this.set("totals",b.newVal)},this);c.on("streamsByValueChange",
function(b){this.set("streams",b.newVal)},this);c.on("isLoadingChange",function(b){this._toggleVisibility(b.newVal)},this);this.after("dataChange",this.syncUI,this);this.after("totalsDataChange",this.syncUI,this);this.after("drilldownKeyChange",this.syncUI,this);e.on("mouseover",b.bind(this._onMouseover,this)).on("mouseout",b.bind(this._onMouseout,this)).on("mousemove",b.bind(function(){this._onMousemove()},this));this._mouseQueue=new b.AsyncQueue;this._mouseQueue.on("complete",b.bind(function(){this._mouseData=
[]},this))},syncUI:function(){d.superclass.syncUI.apply(this,arguments);var c=this.get("data"),e=this.get("totalsData"),f=this.get("drilldownKey"),g;if(f){var h=this.get("streams");if(h)for(var k=0;k<h.length;k++)if(h[k].key===f){g=[h[k]];break}}else g=this.get("streams");if(c&&0<c.length&&g||e){var l=this.get("xScale"),p=this.get("yScale"),h=this.get("xAxis"),k=this.get("yAxis"),q=this.get("svg"),r=q.select(".total"),s=r.select("path"),t=this.get("model").get("extent"),u=this;e?(l.domain(d3.extent(e,
function(b){return b.d})),p.domain([0,d3.max(e,function(b){return b.count})]),s.empty()&&(s=r.append("path")),s.datum(e).attr("class","stream-totals"),s.on("mouseover",function(b){u._onStreamMouseover({values:b},this)}).on("mouseout",b.bind(this._onStreamMouseout,this))):(l.domain(d3.extent(c,function(b){return b.d})),p.domain([0,d3.max(c,function(b){return b.y0+b.y+3})]));if(!this._oldDomain||(this._oldDomain[0].getTime()!==l.domain()[0].getTime(),this._oldDomain[1].getTime()!==l.domain()[1].getTime())){this._oldDomain=
l.domain();var v=l.domain();l.domain();var w=t,c=d3.behavior.zoom().x(l).on("zoom",b.bind(function(){var b=v[0].getTime()-l.domain()[0].getTime(),c=v[1].getTime()-l.domain()[1].getTime(),b=[new Date(w[0].getTime()-b),new Date(w[1].getTime()-c)];b[0]>b[1]?v=l.domain():(v=l.domain(),w=b,c=this.get("rangeGraph"),c._changeExtent(b),c._onBrushChange())},this));q.call(c);q.on("mousewheel.zoom",null)}g&&(g=g.slice(0),g=q.select(".stack").selectAll(".stream").data(g,function(b){return b.key}),g.enter().append("path").attr("class",
"stream").attr("stroke","rgba(255,255,255,0.33)").attr("class",function(b,c){return"stream stream-"+c}),g.exit().remove(),g.on("mouseover",function(b,c){u._onStreamMouseover(b,this)}).on("mouseout",b.bind(this._onStreamMouseout,this)).on("dblclick",b.bind(function(b,c){this.set("drilldownKey",f?null:b.key)},this)));q.selectAll(".y.axis").call(k).call(this._adjustAxis);q.selectAll(".x.axis").call(h);this._changeExtent(t,!0)}},_setPanZoom:function(b){this._panZoom=b;var d=this.get("marker"),f=this.get("markerTooltip");
b&&(this._mouseover=!1,d.style("display","none"),f.style("display","none"))},_selectedStream:null,_tooltip:'<div class="graph-tooltip"></div>',_mouseover:!1,_onStreamMouseover:function(b,d){if(!this._panZoom){this._selectedStream=b;var f=this.get("svg"),g=this.get("tooltip"),h=this.get("pattern"),k=this.get("dataTable").get("savedStreams");f.style("cursor","default");for(var l,f=d3.select(d).attr("class").split(" "),p=0;p<f.length;p++)if(-1!==f[p].indexOf("stream-")){l=f[p];break}d3.select(d).classed("hovered",
!0);h.select("rect").attr("class",l);for(var q in k)q===b.key?k[q].row.addClass("active"):k[q].row.removeClass("active");g.style("display",null)}},_onStreamMouseout:function(){if(!this._panZoom){this._selectedStream=null;var b=this.get("svg"),d=this.get("tooltip"),f=this.get("dataTable").get("savedStreams");this._changeDragCursor(!1,b);b.selectAll(".total path").classed("hovered",!1);b.selectAll(".stream").classed("hovered",!1);for(var g in f)f[g].row.removeClass("active");d.style("display","none")}},
_onMouseover:function(){if(!this._panZoom){var b=this.get("marker"),d=this.get("markerTooltip");b.style("display",null);d.style("display",null)}},_onMouseout:function(){if(!this._panZoom){var b=this.get("marker"),d=this.get("markerTooltip");this._mouseover=!1;b.style("display","none");d.style("display","none")}},_onMousemove:function(c){if(!this._panZoom){var d=this.get("svg"),f=d.node(),g=this.get("xScale"),h=this.get("yScale"),k=this.get("xAxis"),l=b.one(f).getY(),p=this.get("margin"),q=this.get("height");
this.get("width");var r=this.get("marker"),s=this.get("markerTooltip"),t=3!==this.get("model").get("dataMetric")?this.get("totalsData"):this.get("totals"),u=this.get("tooltip"),v=this.get("drilldownKey"),w=this._mouseover?250:0,y={};r.style("display",null);s.style("display",null);if(t){var z=d3.bisector(function(b){return b.d}).left;b.Lang.isUndefined(c)&&(c=g.invert(d3.mouse(f)[0]));z=z(t,c);f=t[z-1];t=t[z];if(f&&t){var B=c-f.d>t.d-c?t:f;c=g.domain();if(!(B.d<c[0].getTime()||B.d>c[1].getTime())){g=
{x:g(B.d)+p.left,y:h(B.count)+p.top};c="";if(null!==this._selectedStream){for(var t=this._selectedStream.values,f=0,z=t.length,A;f<z;f++)if(t[f].d===B.d){A=t[f];break}if("other"===A.value.toLowerCase()&&(t=this.get("streams"))){if(v)for(f=0;f<t.length;f++)if(t[f].key===v){t=[t[f]];break}for(f=0;f<t.length;f++)for(v=0;v<t[f].values.length;v++);}A&&(c=this._selectedStream.title?"<h1>"+this._selectedStream.title+"</h1><p>"+A.value+"</p>":"<h1>"+A.value+"</h1>")}y={d:B.d,pos:g,tooltipText:c,markerText:k.tickFormat()(new Date(B.d))};
if(0===this._mouseData.length||this._mouseData[this._mouseData.length-1].d!==y.d||this._mouseData[this._mouseData.length-1].tooltipText!==y.tooltipText)this._mouseData.push(y),this._mouseover=!0,this._mouseQueue.add(b.bind(function(){w/=this._mouseData.length;this._mouseQueue.pause();u.html(y.tooltipText);var c,f;y.pos.x+b.one(u.node()).get("offsetWidth")>parseInt(d.attr("width"),10)?(c=y.pos.x-b.one(u.node()).get("offsetWidth")-r.select("circle").attr("r"),u.style("text-align","right")):(c=y.pos.x,
u.style("text-align","left"));f=y.pos.y+b.one(u.node()).get("offsetHeight")>parseInt(d.attr("height"),10)-p.top-p.bottom?y.pos.y+l-b.one(u.node()).get("offsetHeight"):y.pos.y+l;u.transition().duration(w).style("top",f+"px").style("left",c+"px");s.select(".x").html(y.markerText);s.select(".y").html(h.tickFormat()(B.count));s.select(".x").transition().duration(w).style("top",q+p.top-p.bottom/2-b.one(s.node()).one(".x").get("offsetHeight")/2+l+"px").style("left",y.pos.x-b.one(s.node()).one(".x").get("offsetWidth")/
2+"px");s.select(".y").transition().duration(w).style("top",y.pos.y-b.one(s.node()).one(".y").get("offsetHeight")/2+l+"px").style("left","7px");r.transition().duration(w).attr("transform","translate("+y.pos.x+","+y.pos.y+")");r.select(".x.line").transition().duration(w).attr("transform","translate(0, "+r.select("circle").attr("r")+")").attr("y1",q-y.pos.y-p.bottom/2);setTimeout(b.bind(function(){this._mouseQueue.run()},this),w)},this)),1===this._mouseData.length&&this._mouseQueue.run()}}}}},_filterDataByDates:function(b,
d,f){return b.filter(function(b){if(b.d>=d&&b.d<=f)return b.count})},_changeExtent:function(b,d){var f=this.get("svg"),g=this.get("xScale"),h=this.get("yScale"),k=this.get("area"),l=this.get("emptyArea"),p=this.get("totalArea"),q=this.get("xAxis"),r=this.get("yAxis"),s=this.get("drilldownKey"),t=this.get("margin"),t=this.get("height")-t.top-t.bottom;g.domain(b);if(g=3!==this.get("model").get("dataMetric")?this.get("totalsData"):this.get("totals"))g=this._filterDataByDates(g,b[0],b[1]),0<g.length&&
h.domain([0,Math.ceil(1.1*d3.max(g.map(function(b){return b.count})))]);f.selectAll(".total path").attr("d",p);s?k.y0(t).y1(function(b){return h(b.count)}):k.y0(function(b){return h(b.y0)}).y1(function(b){return h(b.y0+b.y)});d?f.selectAll(".stream").attr("d",function(b){return l(b.values)}).transition().duration(750).attr("d",function(b){return k(b.values)}):f.selectAll(".stream").attr("d",function(b){return k(b.values)});f.select(".x.axis").call(q);f.selectAll(".y.axis").call(r).call(this._adjustAxis)},
_tickFormat:function(){var b=d3.time.format("%I %p").apply(null,arguments);"12 AM"===b&&(b=d3.time.format("%d").apply(null,arguments),"01"===b&&(b=d3.time.format("%b").apply(null,arguments).toUpperCase()));return b.replace(/^0/,"")},_renderLine:function(b,d,f,g,h){return b.append("line").attr("x1",d).attr("x2",f).attr("y1",g).attr("y2",h)},_adjustAxis:function(b){b.selectAll("g").each(function(b){var c=d3.select(this).select("text");(0===b||"0"===b)&&c.text("")});b.selectAll("text").attr("x",10).attr("dy",
4)},_toggleVisibility:function(b){this.get("svg").selectAll(".stream").style("visibility",b?"hidden":"visible")},_changeDragCursor:function(c,d){d.style("cursor",c?b.UA.opera?"move":b.UA.gecko?"-moz-grabbing":"url(/universal/images-v6/stats/closedhand.png), move":b.UA.gecko?"-moz-grab":"url(/universal/images-v6/stats/openhand.png), move")}},{CSS_PREFIX:"sqs-timeline-stack-graph",ATTRS:{model:{value:null},rangeGraph:{value:null},dataTable:{value:null},data:{value:null},streams:{value:null},drilldownKey:{value:null},
totals:{value:null},totalsData:{value:null},width:{value:960},height:{value:400},margin:{value:{top:0,right:0,bottom:30,left:0}},colorRange:{value:"#60aaf8 #8ccaff #ff9f54 #ffc282 #60e394 #94ef9c #a592e2 #bfb4ea #a0a0a0 #bfbfbf".split(" ")},xScale:{value:null},yScale:{value:null},xAxis:{value:null},yAxis:{value:null},yOffset:{value:null},area:{value:null},emptyArea:{value:null},totalArea:{value:null},svg:{value:null},marker:{value:null},markerTooltip:{value:null},pattern:{value:null},interpolation:{value:"linear"}}})},
"1.0",{requires:["base-base","squarespace-ss-widget","squarespace-attr-validators","thirdparty-d3"]});
YUI.add("squarespace-mixins-searchable-model-list",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.SearchableModelList=b.Base.create("SearchableModelList",b.Base,[],{initializer:function(){b.Do.after(function(){var d=this._searchifyURL(b.Do.currentRetVal);return new b.Do.AlterReturn("Adding search query param.",d)},this,"getURL",this)},_searchifyURL:function(d){var c=this.get("searchQuery");if(!b.Lang.isValue(c)||""===c)return d;d=d.split("?");var e=d[1],e=b.Lang.isValue(e)?b.QueryString.parse(e):
{},e=b.merge(e,{q:c});return d[0]+"?"+b.QueryString.stringify(e)}},{ATTRS:{searchQuery:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString}}})},"1.0",{requires:["base","event-custom","querystring","squarespace-attr-validators"]});
YUI.add("squarespace-content-item-types-kbarticle",function(b){var d=b.namespace("Squarespace.ContentItemEditor").KBArticle=b.Base.create("ArticleEditor",b.Squarespace.ContentItemEditor.Base,[],{getPresentationName:function(){return"KBArticle"},_getTemplateContext:function(){var b=d.superclass._getTemplateContext.call(this);b.enableFeatured=!0;b.enablePassthrough=!0;b.enableExcerpt=!0;return b}},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",width:650,name:"kbarticle-editor",
overlay:0.5,verticalHeight:"full",initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.text"]},{$include:"tabs.options.default"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}})},"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-graphing",function(b){b.namespace("Squarespace.Graphing");b.Squarespace.Graphing.Common={humanizeNumber:function(b,c){if(c){if(1E6<=b)return Math.round(10*(b/1E6))/10+"M";if(1E3<=b)return Math.round(10*(b/1E3))/10+"K"}for(var e=b.toString(),f=(e+"").split("."),e=f[0],f=1<f.length?"."+f[1]:"",g=/(\d+)(\d{3})/;g.test(e);)e=e.replace(g,"$1,$2");return e+f}};b.Squarespace.Graphing.Popup={tokenRegex:/\{([^\}]+)\}/g,objNotationRegex:/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g,
replacer:function(d,c,e){var f=e;c.replace(b.Squarespace.Graphing.Popup.objNotationRegex,function(b,c,d,e,p){c=c||e;f&&(c in f&&(f=f[c]),p&&"function"==typeof f&&(f=f()))});return f=(null==f||f==e?d:f)+""},fill:function(d,c){return String(d).replace(b.Squarespace.Graphing.Popup.tokenRegex,function(d,f){return b.Squarespace.Graphing.Popup.replacer(d,f,c)})},show:function(b,c,e,f,g,h){g=String(g||"top-middle").split("-");g[1]=g[1]||"middle";var k=f.getBBox(),l=Math.round(k.width),p=Math.round(k.height),
q=Math.round(k.x)-5,k=Math.round(k.y)-5,r=Math.min(p/2,l/2,10),s=[{x:q+5,y:k,w:l,w4:l/4,h4:p/4,right:0,left:l-2*r,bottom:0,top:p-2*r,r:5,h:p,gap:r},{x:q+5,y:k,w:l,w4:l/4,h4:p/4,left:l/2-r,right:l/2-r,top:p/2-r,bottom:p/2-r,r:5,h:p,gap:r},{x:q+5,y:k,w:l,w4:l/4,h4:p/4,left:0,right:l-2*r,top:0,bottom:p-2*r,r:5,h:p,gap:r}]["middle"==g[1]?1:2*("top"==g[1]||"left"==g[1])],t=0,u=0;b=b.path(this.fill({top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",
bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}[g[0]],
s)).insertBefore(f);switch(g[0]){case "top":t=c-(q+5+s.left+r);u=e-(k+5+p+5+r);break;case "bottom":t=c-(q+5+s.left+r);u=e-(k-r);break;case "left":t=c-(q+5+l+5+r);u=e-(k+5+s.top+r);break;case "right":t=c-(q-r),u=e-(k+5+s.top+r)}b.translate(t,u);if(h)return h=b.attr("path"),b.remove(),{path:h,dx:t,dy:u};f.translate(t,u);return b}};b.Squarespace.Graphing.LineChart=Class.create({initialize:function(d){this.params=d;var c={font:"11px Helvetica, Arial",fill:"#000"},e=0;for(d=0;d<this.params.lines.length;++d)e=
Math.max(Math.max.apply(Math,this.params.lines[d].data),e);5>e&&(e=5);this.paper=new Raphael(this.params.targetContainer,this.params.width,this.params.height);d=this._nicenum(e,!1);var f=this._nicenum(d/7,!0),e=Math.ceil(e/f)*f;Math.max(-Math.floor(Math.log(f)/Math.log(10)),0);var g=0;for(d=0;d<e+0.5*f;d+=f){g++;var h=d;this.params.is_percentage?h=d+"%":1E6<=d?h=d/1E6+"M":1E3<=d&&(h=d/1E3+"K");var k=Math.round((1-d/e)*(this.params.height-50-20))+20,l=Math.round(25),h=this.paper.text(l,k," "+h).attr(d).toBack();
this.params.yAxisLabelStyle&&h.attr(this.params.yAxisLabelStyle)}f=(this.params.width-30)/this.params.labels.length;e=(this.params.height-50-20)/e;this._drawGrid(0.5*f+30.5,20.5,this.params.width-30-f,this.params.height-20-50,10,g-1,"#333");var p=this.paper.set();p.push(this.paper.text(60,12,"24 hits").attr(c));p.push(this.paper.text(60,27,"XXX").attr({font:"10px Helvetica, Arial",fill:"#000"}));p.hide();var q=b.Squarespace.Graphing.Popup.show(this.paper,100,100,p,"right").attr({fill:"#fff",stroke:"#333",
"stroke-width":2,"fill-opacity":0.96}).hide();d=0;for(g=this.params.labels.length;d<g;d++)k=Math.round(this.params.height-50-e*this.params.lines[0].data[d]),l=Math.round(30+f*(d+0.5))+2,b.Lang.isFunction(this.params.labelFunc)?this.params.labelFunc(this.paper,l,this.params.height-22,this.params.labels[d]):(h=this.paper.text(l-8,this.params.height-22,this.params.labels[d]).attr(c).toBack(),h.rotate(-55));c=this.paper.set();for(h=this.params.lines.length-1;0<=h;--h){var r=this.params.lines[h],s,t,u,
v=this.params.height-50;d={};r.fillStyle&&(d=r.fillStyle);d.stroke=r.color;var w=this.paper.path().attr(d),y=this.paper.path().attr(r.lineStyle),z=!1,B;d=0;for(g=this.params.labels.length;d<g;d++){k=Math.round(this.params.height-50-e*r.data[d]);l=Math.round(30+f*(d+0.5))+2;d||(s=["M",l,k,"C",l,k],u=["M",l,v,"C",l,v],t=["M",30+0.5*f,this.params.height-50+2,"L",l,k,"C",l,k]);if(d&&d<g-1){var A=Math.round(this.params.height-50-e*r.data[d-1]),K=Math.round(30+f*(d-0.5)),O=Math.round(this.params.height-
50-e*r.data[d+1]),E=Math.round(30+f*(d+1.5)),A=this._getAnchors(K,A,l,k,E,O);s=s.concat([A.x1,A.y1,l,k,A.x2,A.y2]);u=u.concat([A.x1,v,l,v,A.x2,v]);t=t.concat([A.x1,A.y1,l,k,A.x2,A.y2])}this.params.animate?(r.dotStyle.opacity=0,A=this.paper.circle(l,k,4).attr(r.dotStyle),setTimeout(b.bind(A.animate,A,{opacity:1},400),800)):A=this.paper.circle(l,k,4).attr(r.dotStyle);c.push(this.paper.circle(l,k,16).attr({stroke:"none",fill:"#444",opacity:0}));var F=c[c.length-1];(function(c,d,e,f,g,h,k){F.hover(function(){clearTimeout(B);
p[0].attr({text:b.Squarespace.Graphing.Common.humanizeNumber(e)+(k.params.is_percentage?"%":"")+" "+h.title}).show();p[1].attr({text:f,"font-weight":"bold"}).show();var l="right";c+p.getBBox().width+25>k.params.width&&(l="left");l=b.Squarespace.Graphing.Popup.show(k.paper,c+("right"==l?10:-10),d,p,l,!0);q.show().animate({path:l.path},200*z);p[0].animateWith(q,{translation:[l.dx,l.dy]},200*z);p[1].animateWith(q,{translation:[l.dx,l.dy]},200*z);g.animate({r:6},200,"backOut");z=!0},function(){g.animate({r:4},
100,"backOut");B=setTimeout(function(){q.hide();p[0].hide();p[1].hide();z=!1},1)})})(l,k,r.data[d],this.params.labels[d],A,r,this)}s=s.concat([l,k,l,k]);u=u.concat([l,v,l,v]);t=t.concat([l,k,l,k,"L",l,this.params.height-50,"z"]);this.params.animate?(y.attr({path:u}),setTimeout(b.bind(w.animate,y,{path:s},800,"backOut"),300)):y.attr({path:s});0===h&&(this.params.animate?(w.attr({opacity:0,path:t}),setTimeout(b.bind(w.animate,w,{opacity:r.fillStyle&&r.fillStyle.opacity?r.fillStyle.opacity:1},400),800)):
w.attr({path:t}))}q.toFront();p[0].toFront();p[1].toFront();c.toFront()},_nicenum:function(b,c){var e=Math.floor(Math.log(b)/Math.log(10)),f=b/Math.pow(10,e);return(c?1.5>f?1:3>f?2:7>f?5:10:1>f?1:2>f?2:5>f?5:10)*Math.pow(10,e)},_drawGrid:function(b,c,e,f,g,h,k){k=["M",Math.round(b)+0.5,Math.round(c)+0.5,"L",Math.round(b+e)+0.5,Math.round(c)+0.5,Math.round(b+e)+0.5,Math.round(c+f)+0.5,Math.round(b)+0.5,Math.round(c+f)+0.5,Math.round(b)+0.5,Math.round(c)+0.5];for(var l=f/h,p=e/g,q=1;q<h;q++)k=k.concat(["M",
Math.round(b)+0.5,Math.round(c+q*l)+0.5,"H",Math.round(b+e)+0.5]);for(q=1;q<g;q++)k=k.concat(["M",Math.round(b+q*p)+0.5,Math.round(c)+0.5,"V",Math.round(c+f)+0.5]);return this.paper.path(k.join(",")).attr({stroke:this.params.gridColor})},_getAnchors:function(b,c,e,f,g,h){var k=(e-b)/2,l=(g-e)/2;b=Math.atan((e-b)/Math.abs(f-c));g=Math.atan((g-e)/Math.abs(f-h));b=c<f?Math.PI-b:b;g=h<f?Math.PI-g:g;h=Math.PI/2-(b+g)%(2*Math.PI)/2;c=k*Math.sin(h+b);k*=Math.cos(h+b);b=l*Math.sin(h+g);l*=Math.cos(h+g);return{x1:e-
c,y1:f+k,x2:e+b,y2:f+l}}})},"1.0",{requires:["oop","thirdparty-raphael"]});
YUI.add("squarespace-models-content-stats",function(b){b.namespace("Squarespace.Models");b.Squarespace.Models.ContentStats=b.Base.create("contentStats",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.REST_API_ROOT+"content-stats",getTagsAsStringArray:function(){return this._toNameArray(this.get("tagList"))},getCategoriesAsStringArray:function(){return this._toNameArray(this.get("categoryList"))},_toNameArray:function(d){var c=[];b.Lang.isArray(d)&&b.Array.each(d,function(d){b.Lang.isString(d.name)&&
c.push(d.name)});return c}},{ATTRS:{id:{value:null,validator:b.Lang.isString},websiteId:{value:null,validator:b.Lang.isString},collectionId:{value:null,validator:b.Lang.isString},tagList:{value:[],validator:b.Lang.isArray},categoryList:{value:[],validator:b.Lang.isArray}}});b.Squarespace.Models.ContentStatsList=b.Base.create("contentStatsList",b.ModelList,[b.Squarespace.ModelSync.REST],{model:b.Squarespace.Models.ContentStats,getByCollectionId:function(b){var c;this.each(function(e){e.get("collectionId")===
b&&(c=e)});return c}});b.Squarespace.ContentStatsCache=new b.Squarespace.Models.ContentStatsList},"1.0",{requires:["base","model","model-list","squarespace-util","squarespace-model-sync-rest"]});
YUI.add("squarespace-models-order",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.Order=b.Base.create("Order",b.Model,[b.Squarespace.ModelSync.REST],{root:b.Squarespace.API_ROOT+"commerce/orders",url:b.Squarespace.API_ROOT+"commerce/orders/{id}",toJSON:function(){var b=d.superclass.toJSON.call(this);b.purchasedCart=b.purchasedCart.toJSON();return b},serialize:function(){var c=this.toJSON();delete c.paymentState;delete c.orderEvents;return b.JSON.stringify(c)},print:function(){window.open(b.Lang.sub("{urlBase}?ids={ids}&crumb={crumb}",
{urlBase:this.root+"/print",ids:this.get("id"),crumb:b.Cookie.get("crumb")}))},markShipped:function(c,d){b.Data.put({headers:{"Content-Type":"application/json"},url:this.root+"/mark-shipped",data:b.JSON.stringify({ids:[this.get("id")],sendNotification:c}),success:function(){this.set("state",b.Squarespace.OrderStates.SHIPPED);d&&d.call(this)},failure:function(b){d&&d.call(this,b)}},this)},markPending:function(c){b.Data.put({headers:{"Content-Type":"application/json"},url:this.root+"/mark-pending",
data:b.JSON.stringify({ids:[this.get("id")]}),success:function(){this.set("state",b.Squarespace.OrderStates.PENDING);c&&c.call(this)},failure:function(b){c&&c.call(this,b)}},this)},refund:function(c,d){b.Data.put({headers:{"Content-Type":"application/json"},url:this.getURL("update")+"/refund",data:b.JSON.stringify({amountCents:c}),success:function(){d&&d.call(this)},failure:function(b){d&&d.call(this,b)}},this)},cancel:function(c,d){b.Data.put({headers:{"Content-Type":"application/json"},url:this.getURL("update")+
"/cancel",data:b.JSON.stringify(c),success:function(){d&&d.call(this)},failure:function(b){d&&d.call(this,b)}},this)},notifyCustomer:function(c,d,f,g){b.Data.post({headers:{"Content-Type":"application/json"},url:this.getURL("update")+"/notify-customer",data:b.JSON.stringify({type:c,email:d,message:f}),success:function(){g&&g.call(this)},failure:function(b){g&&g.call(this,b)}},this)}},{ATTRS:{id:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},orderId:{value:null,validator:b.Squarespace.AttrValidators.isNullOrNumber},
state:{value:b.Squarespace.OrderStates.PENDING,validator:function(c){if(b.Object.hasValue(b.Squarespace.OrderStates,c))return!0;console.error("Order: Invalid state.");return!1}},paymentState:{value:b.Squarespace.OrderPaymentStates.NOT_CHARGED,validator:function(c){if(b.Object.hasValue(b.Squarespace.OrderPaymentStates,c))return!0;console.error("Order: Invalid paymentState.");return!1}},submittedOn:{value:null},completedOn:{value:null},refundedOn:{value:null},cancelledOn:{value:null},testMode:{value:!1,
validator:b.Squarespace.AttrValidators.isBoolean},currency:{value:"USD",validator:b.Squarespace.AttrValidators.isString},purchasedCartId:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},purchasedCart:{valueFn:function(){return new b.Squarespace.Models.ShoppingCart},setter:function(c){return c instanceof b.Squarespace.Models.ShoppingCart?c:new b.Squarespace.Models.ShoppingCart(c)}},customerId:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},customer:{value:{},validator:b.Squarespace.AttrValidators.isObject},
itemCount:{value:0,validator:b.Squarespace.AttrValidators.isNumber},grandTotalCents:{value:0,validator:b.Squarespace.AttrValidators.isNumber},refundTotalCents:{value:0,validator:b.Squarespace.AttrValidators.isNumber},isPurelyDigital:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},merchantNotes:{value:{},validator:b.Squarespace.AttrValidators.isObject},note:{value:null,validator:b.Squarespace.isNullOrString},orderEvents:{value:[],validator:b.Squarespace.AttrValidators.isArray},shipmentTracker:{value:null,
validator:b.Squarespace.AttrValidators.isNullOrObject},shipmentTrackers:{value:[],validator:b.Squarespace.AttrValidators.isArray}}})},"1.0",{requires:"base cookie json model squarespace-attr-validators squarespace-enum squarespace-model-sync-rest squarespace-models-shopping-cart squarespace-util".split(" ")});
YUI.add("squarespace-string-utils",function(b){var d=/^[\s]*$/,c=b.namespace("Squarespace").StringUtils={isBlank:function(b){return d.test(b.replace(RegExp("[\\u200B-\\u200D\\uFEFF]","g"),""))},isEmpty:function(b){return!b.replace(RegExp("[\\u200B-\\u200D\\uFEFF]","g"),"")},trim:function(b){var c=RegExp("(^[\\u200B-\\u200D\\uFEFF]+|[\\u200B-\\u200D\\uFEFF]+$)","g");return b.trim().replace(c,"")},toCamelCase:function(c,d){if(!c||!b.Lang.isString(c))return"";var g=0;c=c.split(/[_|\s]/);!0!==d&&(c[g]=
c[g].toLowerCase(),g++);for(g;g<c.length;g++)c[g]=c[g].charAt(0).toUpperCase()+c[g].substr(1).toLowerCase();return c.join("")},toUpperCamelCase:function(b){return c.toCamelCase(b,!0)},getPluralizedString:function(c,d,g){if(b.Lang.isNumber(c)&&1<c){if(g)return g;d=d.replace(/(?:s|x|z|sh|[^aeiou]ch|(fe?)|([^aeiou])y)$/i,function(b,c,d){return c?"ve":d?d+"ie":b+"e"})+"s"}return d}}});
YUI.add("uploader",function(b,d){var c=b.config.win;c&&c.File&&c.FormData&&c.XMLHttpRequest?b.Uploader=b.UploaderHTML5:b.SWFDetect.isFlashVersionAtLeast(10,0,45)?b.Uploader=b.UploaderFlash:(b.namespace("Uploader"),b.Uploader.TYPE="none")},"3.17.2",{requires:["uploader-html5","uploader-flash"]});
YUI.add("squarespace-block-gallery-model-editor",function(b){b.namespace("Squarespace.Block.ModelEditorDialog").Gallery=b.Base.create("blockGalleryModelEditorDialog",b.Squarespace.ModelEditorDialog,[b.Squarespace.Block.Mixins.Gallery],{initializer:function(d){d=b.Squarespace.ContentCollectionCache;0===d.size()&&(d.after("load",this._syncPlugin,this),d.load());var c=this.get("dialog");c.on("ready",function(b){this._bindTransientEvents()},this);c.on("tab-focused",function(b){"content"===b.tabName?c.getField("transientGallery").enableDragSelection():
c.getField("transientGallery").disableDragSelection()},this)},sanitizeDialogData:function(d){b.Object.hasKey(d,"options")&&(d=b.merge(d,d.options),delete d.options);switch(d.methodOption){case "existing":d.collectionId=d.existingGallery;d.existingGalleryId=d.existingGallery;break;case "transient":d.collectionId=d.transientGallery.get("id");d.transientGalleryId=d.transientGallery.get("id");break;default:console.warn("Invalid method options chose: "+d.methodOption)}"slider"!==d.design?d.aspectRatio=
null:delete d.aspectRatio;d.vSize=null;delete d.methodFrame;delete d.transientGallery;return d},getDialogData:function(){var d=this.get("model").toJSON(),c=b.merge(d,{options:d,methodOption:d.methodFrame=this._usesTransientCollection()?"transient":"existing"}),e="Gallery Block "+b.Squarespace.Utils.getGuid(),d={id:d.transientGalleryId||null,typeName:"gallery-block",type:b.Squarespace.CollectionTypes.GALLERY_BLOCK,title:e,navigationTitle:e,urlId:b.Squarespace.Utils.getGuid(),ordering:b.Squarespace.CollectionOrdering.USER,
enabled:!0};c.transientGallery=new b.Squarespace.Models.ContentCollection(d);this.get("model").get("transientGallery").get("id")||this.get("model").set("transientGallery",d,{silent:!0});return c},_usesTransientCollection:function(){var d=this.get("model").get("collectionId");return d?(d=b.Squarespace.ContentCollectionCache.getById(d),-1===b.Squarespace.ContentCollectionCache.filter(function(c){c=c.getTemplateConfiguration();return!(!c||!(c.get("collectionType")==b.Squarespace.CollectionTypes.GENERIC&&
c.get("ordering")==b.Squarespace.CollectionOrdering.USER))}).indexOf(d)):!0},_bindTransientEvents:function(){this.get("model").getAttrs();var d=this.get("dialog").getField("transientGallery"),c=d.get("data");c.isNew()&&(c.once("save",function(){var b=c.get("id");this.get("model").setAttrs({collectionId:b,transientGalleryId:b})},this),d.set("uploadPreflight",b.bind(function(b){c.save({},function(){b()})},this)));c.items.after("create add remove reordered group-reordered *:mediaProcessingStateChange bulk-remove".split(" "),
this._transientGalleryChanged,this);c.items.after("*:mediaFocalPointChange",this._refreshFocalPoints,this)},_transientGalleryChanged:function(b){b.onReorder||"bulk-remove"===b.source||this.fire("gallery-refresh")},_refreshFocalPoints:function(d){var c=b.one('img[data-image-id="'+d.target.get("id")+'"]');if(b.Lang.isNull(c))console.warn("Gallery Block: Could not find image to refresh focalPoint.");else if(c=c.loader)c.set("focalPoint",d.target.get("mediaFocalPoint")),c.fire("refresh")},_getDefaultDialogConfiguration:function(){var d=
this.get("dialog");return{title:"Edit Gallery",width:500,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?564:520}},name:"editGalleryBlock",closeOthers:!1,className:"block-configuration",style:"flyout",flyoutPointerDirection:"hidden",draggable:9!==b.UA.ie&&10!==b.UA.ie,loadingText:"Editing Gallery &hellip;",initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Gallery",tabTitle:"Content",
icon:"/universal/images-v6/icons/icon-gallery-16-light-solid.png",name:"content",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"methodOption",optionClickCb:{$valueFn:function(){return function(b){d.getField("methodFrame").switchFrames(b)}}},options:[{value:"transient",title:"Upload Media",icon:"upload-media"},{value:"existing",title:"Use Existing Gallery",icon:"existing-gallery"}]}},{ctor:b.Squarespace.DialogFields.MultiFrame,config:{name:"methodFrame",width:440,height:{$valueFn:function(){return b.Squarespace.Utils.isDamaskEnabled()?
390:420}},frames:[{name:"transient",fields:[{ctor:b.Squarespace.DialogFields.ContentItemGrid,config:{collectionConfiguration:{acceptTypes:["image","video"],addText:"Add Media"},name:"transientGallery",showAddIcon:!0,renderOnShow:!0,pageSize:200,addText:"Add Content","contentItemImageOptions.actionOverlayButtons":[b.Squarespace.ActionOverlayButtons.IMAGE_INFO,b.Squarespace.ActionOverlayButtons.EDIT_IMAGE,b.Squarespace.ActionOverlayButtons.REMOVE_IMAGE],dataState:"loading"}}]},{name:"existing",fields:[{ctor:b.Squarespace.DialogFields.ContentIdSelector,
config:{name:"existingGallery",showCollectionTagsAndCategories:!1,showGroupTitles:!1,emptyMessage:"There are no existing gallery collections.",collectionFilter:{collectionType:b.Squarespace.CollectionTypes.GENERIC,ordering:b.Squarespace.CollectionOrdering.USER,folder:!1}}}]}]}}]},{title:"Edit Gallery",icon:"/universal/images-v6/icons/icon-gallery-16-light-solid.png",tabTitle:"Design",name:"design",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.GalleryOptions,name:"options",config:{options:{$valueFn:b.bind(this._getGalleryOptions,
this)},width:450}}]}]}},_getDefaultContent:function(){var d=this._defaultGalleryOptions();return b.merge(d,{methodOption:"transient"})}},{ATTRS:{dialogConfig:{getter:"_getDefaultDialogConfiguration",validator:b.Lang.isObject}}})},"1.0",{requires:"base squarespace-block-mixin-gallery-option-sync squarespace-models-content-collection squarespace-content-collection-utils squarespace-plugin-actionoverlay squarespace-gallery-option-synchronizer squarespace-dialog-content-item-grid squarespace-dialog-gallery-options squarespace-dialog-multi-option squarespace-dialog-multi-frame squarespace-block-editor-dialog".split(" ")});
YUI.add("squarespace-settings-activity-timeline",function(b){b.namespace("Squarespace.Settings.Activity");var d=b.Squarespace.Settings.Activity.Timeline=b.Base.create("ActivityManagerTimeline",b.Squarespace.Settings.Activity.BaseManager,[],{_isDataEmpty:function(b){return!0},renderUI:function(){d.superclass.renderUI.call(this)},destructor:function(){}},{CSS_PREFIX:"sqs-activity-manager-timeline",ATTRS:{data:{value:null},strings:{value:{title:"Timeline",description:"Coming soon..."}},tabs:{value:[]}}})},
"1.0",{requires:["base","squarespace-settings-activity-base-manager","squarespace-stats-timeline-view"]});
YUI.add("squarespace-editor-order",function(b){var d={type:b.Squarespace.CommerceEmailTypes.ORDER_CONFIRMED,title:"Confirmation Email",emailFieldName:"confirmationEmailAddress"},c={type:b.Squarespace.CommerceEmailTypes.ORDER_SHIPPED,title:"Shipping Notification",emailFieldName:"shippingEmailAddress"},e={type:b.Squarespace.CommerceEmailTypes.DIGITAL_GOODS_DELIVERY,title:"Digital Goods Delivery",emailFieldName:"digitalEmailAddress"},f={type:b.Squarespace.CommerceEmailTypes.CUSTOM_MESSAGE,title:"Custom Message",
emailFieldName:"customEmailAddress",messageFieldName:"customMessage"};b.namespace("Squarespace.Editor");b.Squarespace.Editor.Order=b.Base.create("Order",b.Squarespace.ModelEditorDialog,[],{initializer:function(){this._bindDialog()},_bindDialog:function(){var c=this.get("dialog");c.on("button-markPending",this._markPending,this);c.on("button-markShipped",this._markShipped,this);c.on("button-markCancelled",this._cancelOrder,this);c.on("button-refund",this._refund,this);c.on("button-print",function(){this.get("model").print()},
this);var d=this.get("shippingConfiguration").get("containers");if(b.Lang.isValue(d))c.on("ready",this._bindShippingTab,this)},_bindShippingTab:function(){var b=this.get("dialog"),c=b.getField("shippingSelect"),d=b.getField("shippingDetails"),e=b.getField("shippingLegend"),f=b.getField("shippingRendering"),q=this.get("shippingConfiguration").get("containers");c.on("dataChange",function(b){b=q.item(b.newVal);d.set("data",b);e.set("data",b);f.set("data",b)},this);c.set("data",c.get("options")[0].value);
e.on("item-activated",function(b){f.setActiveBoxIndex(b.boxIndex)})},_markPending:function(){this.get("dialog");(new b.Squarespace.Widgets.Confirmation({"strings.title":"Mark as Pending","strings.message":'This will move the order back to the "Pending" tab.'})).on("confirm",function(){this.get("model").markPending(b.bind(function(){this.get("dialog").close();this.fire("saved")},this))},this)},_markShipped:function(){var c=this.get("dialog"),d=new b.Squarespace.OptionConfirmationDialog({width:250,
optionConfig:{title:"Send Shipping Notification",description:"Send an email to the customer.",padding:["15px","0px"]}});d.show("Mark as Completed",'This will move the order to the "Completed" tab for your records.',function(){var e=d.getValue();this.get("model").markShipped(e,b.bind(function(){c.close();this.fire("saved")},this))},this)},_cancelOrder:function(){var c=this.get("model").toJSON(),c=b.Array.map(c.purchasedCart.entries,function(b){return b.itemId});b.Squarespace.Models.Inventory.getProductStock(c,
b.bind(this._confirmCancelOrder,this))},_confirmCancelOrder:function(c){var d=this.get("dialog"),e=this.get("model"),f=e.toJSON();this._enhanceOrderWithRestockInfo(f,c.results);c=this._getMaxRefund();c="This will issue a full refund of "+b.Squarespace.Commerce.moneyString(c)+' and move the order to the "Cancelled" tab. The customer will be automatically notified.';this._zIndex();var p=new b.Squarespace.DialogFields.CancelOrderRestock({name:"restockPreview",data:{order:f}}),q=new b.Squarespace.DialogFields.Check({name:"restockInventory",
defaultValue:!0,"strings.title":"Restock Inventory","strings.description":"The below items will be added back to your inventory."});q.after("dataChange",function(){p.set("disabled",!q.getValue())});(new b.Squarespace.Widgets.DataConfirmation({"strings.title":"Cancel Order","strings.message":c,fields:[q,p],showOverlay:!0,zIndex:this._zIndex()+5,width:450,className:"question dialog-order-manager-confirm-cancel"})).on("confirm",function(c){var f=b.bind(function(c){c?new b.Squarespace.Widgets.Alert({"strings.title":"Cancel Failed",
"strings.message":c.message}):(new b.Squarespace.Widgets.Information({"strings.title":"Refund Successful","strings.message":"Refund successfully issued."}),d.close(),this.fire("saved"))},this);e.cancel({restockInventory:c.data.restockInventory},f)})},_zIndex:function(){return parseInt(this.get("dialog").el.getStyle("z-index"))},_findProductStockStatus:function(c,d,e){return b.Array.find(c,function(c){if(c.itemId===d&&(!b.Lang.isValue(e)||c.sku===e))return!0})},_enhanceOrderWithRestockInfo:function(c,
d){var e=this._findProductStockStatus;b.Array.each(c.purchasedCart.entries,function(c){var f=c.itemId,g=b.Lang.isValue(c.chosenVariant)?c.chosenVariant.sku:null,f=e(d,f,g),g=!b.Lang.isValue(f);c.restockableStatus={missing:g,unlimited:!g&&!0===f.unlimited}})},_refund:function(){var c=this.get("model").get("currency"),c=b.Squarespace.CurrencySymbol[c],d=new b.Squarespace.EditingDialog({discardChangesConfirmation:!1,width:300,height:180,overlay:0.5,closeOthers:!1,savingText:"Refunding ...",buttons:[{type:"cancel",
title:"Cancel"},{type:"issue-refund",title:"Issue Refund"}],primaryTabs:[{title:"Issue Refund",icon:"/universal/images-v6/content/shopping-cart-light.png",fields:[{ctor:b.Squarespace.DialogFields.MoneyText,config:{name:"refundTotalCents",data:this._getMaxRefund(),prefixUnit:c,"strings.title":"Refund Amount"}}]}]});d.on("button-issue-refund",function(){this._confirmAndIssueRefund(d)},this);d.show()},_confirmAndIssueRefund:function(c){var d=c.getField("refundTotalCents").getValue(),e=this._getMaxRefund(),
f=this.get("model");f.get("state");var p=function(){c.updateTitle(b.Squarespace.DialogStates.SAVING);c.showSaveOverlay();f.refund(d,b.bind(function(d){d?(new b.Squarespace.Widgets.Alert({"strings.title":"Refund Failed","strings.message":d.message}),c.allowEditing(),c.updateTitle()):(new b.Squarespace.Widgets.Information({"strings.title":"Refund Successful","strings.message":"Refund successfully issued."}),c.close(),this.get("dialog").close(),this.fire("saved"))},this))};if(d>e)new b.Squarespace.Widgets.Alert({"strings.title":"Cannot Refund",
"strings.message":"The requested refund amount is greater than the order total."});else(new b.Squarespace.Widgets.Confirmation({"strings.title":"Issue Refund","strings.message":"Are you sure you want to issue a refund? The customer will be automatically notified."})).on("confirm",p,this)},_saveMerchantNotes:function(){var c=this.get("model"),d=this.get("dialog"),e=d.getField("merchantNotes").getValue();d.updateTitle(b.Squarespace.DialogStates.SAVING);d.showSaveOverlay();c.set("merchantNotes",e);c.save(function(){d.allowEditing();
d.updateTitle()})},_sendNotification:function(c){var d=this.get("model"),e=this.get("dialog"),f=c.type,p=this._getEmailForNotification(c),q=c.messageFieldName,r;if(q&&(r=e.getField(q).get("data"),""===r)){new b.Squarespace.Widgets.Alert({"strings.title":"Email Not Sent","strings.message":"This email must contain a message."});return}e="custom"!==f?"resend":"send";c=e.capitalize()+" "+c.title;(new b.Squarespace.Widgets.Confirmation({"strings.title":c,"strings.message":"Do you want to "+e+" this email to "+
p+"?"})).on("confirm",function(){d.notifyCustomer(f,p,r,function(c){c?new b.Squarespace.Widgets.Alert({"strings.title":"Could Not Send","strings.message":c.message}):new b.Squarespace.Widgets.Information({"strings.title":"Email Sent","strings.message":"The email has been sent to the customer."})})},this)},_getEmailForNotification:function(b){b=b.emailFieldName;return(b=this.get("dialog").getField(b).get("data"))&&""!==b?b:this.get("model").get("customer").email},_getMaxRefund:function(){var b=this.get("model");
return b.get("grandTotalCents")-b.get("refundTotalCents")},_getDialogTabs:function(){var c=[];c.push(this._getSummaryTab());0<this.get("model").get("orderEvents").length&&c.push(this._getHistoryTab());c.push(this._getNotesTab());c.push(this._getEmailTab());var d=this.get("shippingConfiguration").get("containers");b.Lang.isValue(d)&&c.push(this._getShippingTab());return c},_getSummaryTab:function(){return{title:"Order Summary",tabTitle:"Order",icon:"/universal/images-v6/icons/icon-commerce-32-light.png",
scroll:!0,fields:[{type:"order-summary",order:{$valueFn:b.bind(function(){return this.get("model").toJSON()},this),$dontRecurse:!0},width:600}]}},_getHistoryTab:function(){return{title:"History",tabTitle:"History",icon:"/universal/images-v6/icons/icon-commerce-32-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.OrderHistory,config:{data:this.get("model").get("orderEvents")}}]}},_getNotesTab:function(){return{title:"Notes",tabTitle:"Notes",name:"notes",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,
config:{title:"Private Notes",style:"minor",text:"Record any notes pertaining to this order for yourself here."}},{type:"wysiwyg",engine:"text",menuConfig:"small",name:"merchantNotes",fieldStyle:"normal",height:250},{ctor:b.Squarespace.DialogFields.Button,config:{name:"saveMerchantNotes","strings.text":"Save",onClick:b.bind(this._saveMerchantNotes,this),width:53}}]}},_getEmailTab:function(){var g=this.get("model"),h=g.get("customer").email,g=g.get("purchasedCart").get("entries"),g=b.Lang.isValue(g)?
b.Array.some(g,function(c){return c.productType===b.Squarespace.ProductTypes.DIGITAL}):!1;return{title:"Email Notifications",tabTitle:"Email Notifications",name:"emails",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Resend Order Confirmation",style:"minor",text:"Send customer an order confirmation email."}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"confirmationEmailAddress","strings.placeholder":"xxx@xxxxxxxxx.com",className:"thin",
data:h,saveOnEnter:!0,width:0.85}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Send Email",name:"resendConfirm",width:0.15,className:"sqs-button-light",onClick:b.bind(function(){this._sendNotification(d)},this)}}]},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Resend Shipping Notice",style:"minor",text:"Send customer a shipping notification email."}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"shippingEmailAddress","strings.placeholder":"xxx@xxxxxxxxx.com",
className:"thin",data:h,saveOnEnter:!0,width:0.85}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Send Email",name:"resendShipped",width:0.15,className:"sqs-button-light",onClick:b.bind(function(){this._sendNotification(c)},this)}}]},{ctor:b.Squarespace.DialogFields.Description,hidden:!g,config:{title:"Resend and Refresh Digital Goods",text:"Send customer unique links to their digital goods. Their links will be refreshed so they may access them for 24 hours.",style:"minor"}},{type:"splitter",
hidden:!g,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"digitalEmailAddress","strings.placeholder":"xxx@xxxxxxxxx.com",className:"thin",data:h,saveOnEnter:!0,width:0.85}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Send Email",name:"resendDigital",className:"sqs-button-light",width:0.15,onClick:b.bind(function(){this._sendNotification(e)},this)}}]},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Send Message",style:"minor",text:"Send customer a personalized message."}},
{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"customEmailAddress","strings.placeholder":"xxx@xxxxxxxxx.com",className:"thin",data:h,saveOnEnter:!0,width:0.85}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Send Email",name:"sendCustomMessage",className:"sqs-button-light",width:0.15,onClick:b.bind(function(){this._sendNotification(f)},this)}}]},{ctor:b.Squarespace.DialogFields.HtmlCode,config:{name:"customMessage",height:50}}]}},_getShippingTab:function(){var c=
this.get("model").toJSON(),d=this.get("shippingConfiguration"),e=b.Squarespace.Commerce.currencySymbol(),f=b.Squarespace.Commerce.weightUnit(),p=b.Squarespace.Commerce.dimensionUnit(),q=d.get("containers").map(function(c,d){var e=c.get("name");return{label:b.Squarespace.Commerce.capitalizeFirst(e),value:d}},this);return{title:"Shipping Details",tabTitle:"Shipping",icon:"/universal/images-v6/icons/icon-commerce-32-light.png",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.ShippingSummary,config:{name:"shippingSummary",
data:{shippingConfiguration:{$valueFn:function(){return d},$dontRecurse:!0},order:{$valueFn:function(){return c},$dontRecurse:!0}},currencySymbol:e,weightUnit:f}},{type:"splitter",fields:[{type:"stack",width:0.4,fields:[{ctor:b.Squarespace.DialogFields.Select,config:{name:"shippingSelect","strings.title":"Select a Package","strings.description":"Select a package to see how the items were packed inside",options:q,data:q[0].value,className:"thin dark",required:!1}},{ctor:b.Squarespace.DialogFields.ShippingDetails,
config:{name:"shippingDetails",order:{$valueFn:function(){return c},$dontRecurse:!0},currencySymbol:e,weightUnit:f,dimensionUnit:p,scroll:!0}}]},{ctor:b.Squarespace.DialogFields.ShippingRendering,config:{name:"shippingRendering",width:0.6,canvasWidth:360,canvasHeight:300}}]},{ctor:b.Squarespace.DialogFields.ShippingLegend,config:{name:"shippingLegend",order:{$valueFn:function(){return c},$dontRecurse:!0},weightUnit:f,dimensionUnit:p,scroll:!0}}]}},_getDialogButtons:function(){var c=[{type:"cancel",
title:"Close"},{type:"print",title:"Print"}],d=this.get("model"),e=d.get("state"),f=e===b.Squarespace.OrderStates.CANCELLED,p=d.get("grandTotalCents"),d=d.get("refundTotalCents")<p;!f&&d&&c.push({type:"refund",title:"Issue Refund"});e===b.Squarespace.OrderStates.PENDING?(c.push({type:"markCancelled",title:"Cancel Order"}),c.push({type:"markShipped",title:"Mark Completed"})):e===b.Squarespace.OrderStates.SHIPPED&&c.push({type:"markPending",title:"Mark Pending"});return c}},{ATTRS:{model:{value:null,
validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.Order),writeOnce:"initOnly"},dialogConfig:{getter:function(){return{name:"order-manager",width:700,verticalHeight:"full",overlay:0.5,closeOthers:!1,discardChangesConfirmation:!1,tabs:this._getDialogTabs(),buttons:this._getDialogButtons(),initialData:{$valueFn:b.bind(function(){return this.get("model").toJSON()},this),$dontRecurse:!0}}},readOnly:!0},shippingConfiguration:{valueFn:function(){var c=new b.Squarespace.Models.ShippingConfiguration,
d=this.get("model").get("purchasedCart");d.get("requiresShipping")&&(d=d.get("selectedShippingOption").packingResults,c.setAttrs(d));return c},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.ShippingConfiguration),readOnly:!0}}})},"1.0",{requires:"base squarespace-model-editor squarespace-attr-validators squarespace-ui-base squarespace-commerce-utils squarespace-enum squarespace-dialog squarespace-dialog-text squarespace-dialog-order-summary squarespace-dialog-code squarespace-dialog-button squarespace-dialog-shipping-diagram squarespace-dialog-order-history squarespace-dialog-description squarespace-dialog-select squarespace-dialog-cancel-order-restock squarespace-wysiwyg squarespace-models-order squarespace-models-shipping-configuration squarespace-widgets-alert squarespace-widgets-confirmation squarespace-widgets-information squarespace-models-inventory squarespace-widgets-data-confirmation".split(" ")});
YUI.add("squarespace-newsletters-templates",function(b){var d=b.namespace("Squarespace.Newsletters").TemplateType=b.Squarespace.enumFactory({FEATURED:1,UPDATE:2,GALLERY:3});b=b.namespace("Squarespace.Newsletters").Templates={};b[d.FEATURED.value]={header:{logoAlignment:"left"},body:{layoutRows:[{columns:[{span:6,blocks:[{type:5,value:{linkTo:"",newwindow:!1,lightbox:!1,aspectRatio:null,layout:"caption-below",stretch:!1,floatDir:null,hSize:null}},{type:2,value:{hSize:null,floatDir:null,engine:"wysiwyg",
source:'<h1 style="margin-top: 0px; font-family: Helvetica, Arial, sans-serif;">The journey is the reward</h1><p style="font-family: Helvetica, Arial, sans-serif;">&nbsp;</p><p style="margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum. Phasellus non quam a sem viverra convallis ut ut nulla. Duis nulla mauris, sollicitudin sit amet tellus in, auctor varius urna. Integer vehicula enim at magna cursus semper et id nulla. Praesent odio magna, mattis nec elementum id, pulvinar eleifend magna. Vestibulum sit amet libero at est egestas consectetur. Mauris nec urna id risus facilisis congue ut ut enim.</p>',
html:'<h1 style="margin-top: 0px; font-family: Helvetica, Arial, sans-serif;">The journey is the reward</h1><p style="font-family: Helvetica, Arial, sans-serif;">&nbsp;</p><p style="margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum. Phasellus non quam a sem viverra convallis ut ut nulla. Duis nulla mauris, sollicitudin sit amet tellus in, auctor varius urna. Integer vehicula enim at magna cursus semper et id nulla. Praesent odio magna, mattis nec elementum id, pulvinar eleifend magna. Vestibulum sit amet libero at est egestas consectetur. Mauris nec urna id risus facilisis congue ut ut enim.</p>'}},
{type:53,value:{buttonText:"Learn More",buttonLink:"#",newWindow:!1,buttonAlignment:"center",buttonSize:"medium",hSize:null,floatDir:null}}]}]}]}};b[d.UPDATE.value]={header:{logoAlignment:"right"},body:{layoutRows:[{columns:[{span:6,rows:[{columns:[{span:6,blocks:[{type:2,value:{engine:"wysiwyg",source:'<h1 id="yui_3_10_1_1_1395422617983_44183">New on our blog: The Journey is The Reward, and the path to success.</h1><p style="margin-left:0px; margin-right:0px; text-align:justify" id="yui_3_10_1_1_1395422617983_44184">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum. Phasellus non quam a sem viverra convallis ut ut nulla. Duis nulla mauris, sollicitudin sit amet tellus in, auctor varius urna. Integer vehicula enim at magna cursus semper et id nulla. Praesent odio magna, mattis nec elementum id, pulvinar eleifend magna. Vestibulum sit amet libero at est egestas consectetur. Mauris nec urna id risus facilisis congue ut ut enim.</p><p style="text-align:justify" id="yui_3_10_1_1_1395422617983_44185">Donec dictum mi aliquam mauris bibendum, quis accumsan dolor mollis. Nunc congue sapien non sem adipiscing, in placerat diam laoreet. Praesent porta, ipsum quis feugiat porttitor, orci orci laoreet ante, vel eleifend dui dolor ac erat. Sed eget purus odio. Aliquam mollis odio tortor, non cursus tellus euismod et. Quisque ut lacinia lectus. Aliquam vel ante orci. Sed faucibus odio nec adipiscing sodales. In hac habitasse platea dictumst. Aliquam imperdiet augue vel augue vulputate, ut dapibus nisl mollis. Sed placerat lacus a commodo tincidunt. Cras placerat justo a sapien cursus lobortis. Nulla feugiat cursus adipiscing. Sed varius consequat aliquet. Nullam vitae egestas mi. Aenean nec ligula vel ante sagittis aliquam et vitae orci.</p>',
html:'<h1 id="yui_3_10_1_1_1395422617983_44183">New on our blog: The Journey is The Reward, and the path to success.</h1><p style="margin-left:0px; margin-right:0px; text-align:justify" id="yui_3_10_1_1_1395422617983_44184">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum. Phasellus non quam a sem viverra convallis ut ut nulla. Duis nulla mauris, sollicitudin sit amet tellus in, auctor varius urna. Integer vehicula enim at magna cursus semper et id nulla. Praesent odio magna, mattis nec elementum id, pulvinar eleifend magna. Vestibulum sit amet libero at est egestas consectetur. Mauris nec urna id risus facilisis congue ut ut enim.</p><p style="text-align:justify" id="yui_3_10_1_1_1395422617983_44185">Donec dictum mi aliquam mauris bibendum, quis accumsan dolor mollis. Nunc congue sapien non sem adipiscing, in placerat diam laoreet. Praesent porta, ipsum quis feugiat porttitor, orci orci laoreet ante, vel eleifend dui dolor ac erat. Sed eget purus odio. Aliquam mollis odio tortor, non cursus tellus euismod et. Quisque ut lacinia lectus. Aliquam vel ante orci. Sed faucibus odio nec adipiscing sodales. In hac habitasse platea dictumst. Aliquam imperdiet augue vel augue vulputate, ut dapibus nisl mollis. Sed placerat lacus a commodo tincidunt. Cras placerat justo a sapien cursus lobortis. Nulla feugiat cursus adipiscing. Sed varius consequat aliquet. Nullam vitae egestas mi. Aenean nec ligula vel ante sagittis aliquam et vitae orci.</p>',
hSize:null,floatDir:null}},{type:47,value:{hSize:null,floatDir:null}},{type:2,value:{engine:"wysiwyg",source:'<h3 class="text-align-center" id="yui_3_10_1_1_1395422617983_44186">Read the rest on our blog:</h3>',html:'<h3 class="text-align-center" id="yui_3_10_1_1_1395422617983_44186">Read the rest on our blog:</h3>'}},{type:53,value:{buttonText:"Read the blog",buttonLink:"",newWindow:!1,buttonAlignment:"center",buttonSize:"medium",hSize:null,floatDir:null}}]}]}]}]}]}};b[d.GALLERY.value]={header:{logoAlignment:"center"},
body:{layoutRows:[{columns:[{span:6,rows:[{columns:[{span:6,blocks:[{type:2,value:{hSize:null,floatDir:null,engine:"wysiwyg",source:'\n<h1 class="text-align-center" style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">New products in our store</h1>\n<p style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Come and visit our store to see&nbsp;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum.&nbsp;</p>',
html:'\n<h1 class="text-align-center" style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">New products in our store</h1>\n<p style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Come and visit our store to see&nbsp;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum.&nbsp;</p>'}},{type:47,value:{hSize:null,floatDir:null}}]}]}]}]},{columns:[{span:3,blocks:[{type:5,value:{linkTo:"",
newwindow:!1,lightbox:!1,aspectRatio:null,layout:"caption-below",stretch:!1,floatDir:null,hSize:null}},{type:5,value:{linkTo:"",newwindow:!1,lightbox:!1,layout:"caption-below",stretch:!1,floatDir:null,hSize:null}}]},{span:3,blocks:[{type:5,value:{linkTo:"",newwindow:!1,lightbox:!1,aspectRatio:null,layout:"caption-below",stretch:!1,floatDir:null,hSize:null}},{type:5,value:{linkTo:"",newwindow:!1,lightbox:!1,layout:"caption-below",stretch:!1,description:{engine:"wysiwyg",source:""},floatDir:null,hSize:null}}]}]},
{columns:[{span:6,rows:[{columns:[{span:6,blocks:[{type:47,value:{hSize:null,floatDir:null}},{type:2,value:{hSize:null,floatDir:null,engine:"wysiwyg",source:'<h2 class="text-align-center" style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Use coupon code <em style="font-family: Helvetica, Arial, sans-serif;">CODEHERE123</em> to save on your next purchase<span style="font-size: 13px; font-family: Helvetica, Arial, sans-serif;">&nbsp;</span></h2>',html:'<h2 class="text-align-center" style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Use coupon code <em style="font-family: Helvetica, Arial, sans-serif;">CODEHERE123</em> to save on your next purchase<span style="font-size: 13px; font-family: Helvetica, Arial, sans-serif;">&nbsp;</span></h2>'}},
{type:47,value:{hSize:null,floatDir:null}}]}]},{columns:[{span:4,blocks:[{type:2,value:{hSize:null,floatDir:null,engine:"wysiwyg",source:'<p style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum. Phasellus non quam a sem viverra convallis ut ut nulla. Duis nulla mauris, sollicitudin sit amet tellus in, auctor varius urna.</p>',html:'<p style="margin-top: 0px; margin-bottom: 0px; font-family: Helvetica, Arial, sans-serif;">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque vel quam at quam luctus mollis eu et ipsum. Phasellus non quam a sem viverra convallis ut ut nulla. Duis nulla mauris, sollicitudin sit amet tellus in, auctor varius urna.</p>'}}]},
{span:2,blocks:[{type:53,value:{buttonText:"Shop Now",buttonLink:"",newWindow:!1,buttonAlignment:"center",buttonSize:"small",hSize:null,floatDir:null}}]}]}]}]}]}}},"1.0",{requires:["base","squarespace-enum-factory"]});
YUI.add("overlay",function(b,d){b.Overlay=b.Base.create("overlay",b.Widget,[b.WidgetStdMod,b.WidgetPosition,b.WidgetStack,b.WidgetPositionAlign,b.WidgetPositionConstrain])},"3.17.2",{requires:"widget widget-stdmod widget-position widget-position-align widget-stack widget-position-constrain".split(" "),skinnable:!0});
YUI.add("squarespace-xero-tax-setup-dialog",function(b){var d=b.Base.create("taxSetUpRow",b.Squarespace.SSWidget,[b.WidgetParent,b.WidgetChild],{initializer:function(){this._toolTips=[];this.publish("save-requested",{emitFacade:!0})},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("requiredRate"),f=this.getClassName(),g=this.get("contentBox"),h=g.appendChild('<div class="tax-setup-rate-display"></div>');h.append(b.Lang.sub('<div class="{pfx}-header"><div class="{pfx}-display-name">{name}<span class="missing-in-xero-badge">Missing</span><span class="out-of-sync-badge">Out Of Sync</span></div></div>',
{name:c.get("name"),pfx:f}));b.Array.forEach(c.get("taxComponents"),function(b){h.append(this._renderComponent(b))},this);f=g.appendChild('<div class="tax-setup-create-rate"></div>');this.add({childType:b.Squarespace.DialogFields.Button,render:f,"strings.text":"Create In Xero",onClick:function(){(new b.Squarespace.Widgets.Confirmation({"strings.confirm":"Create","strings.title":"Create Tax Rate","strings.message":'A new Tax Rate called "'+this.get("requiredRate").get("name")+'" will be created in Xero.'})).on("confirm",
function(){this.fire("save-requested");c.save()},this)},context:this})},bindUI:function(){this.after("taxRateDiffChange",this.syncUI,this)},rateNotFound:function(){return this.get("taxRateDiff").notFound},save:function(){this.get("requiredRate").save()},syncUI:function(){var c=this.get("taxRateDiff"),d=this.get("contentBox"),g=this.getClassName(),h=g+"-issues",k=g+"-not-found",l=g+"-ok";this._clearToolTips();this._clearExtras();if(b.Lang.isObject(c))if(d.one("."+g+"-header").toggleClass(h,!c.isEqual),
d.toggleClass(k,c.notFound),d.toggleClass(l,c.isEqual),c.notFound)this._makeToolTip(d.one(".tax-setup-rate-display"),"Tax Rate Missing",'Click "Create in Xero" to add this Tax Rate to Xero.');else{c.isEqual||this._makeToolTip(d.one("."+g+"-header"),"Tax Rate Out Of Sync","This Tax Rate is out of sync with Squarespace Commerce. ");var p=c.diffs;d.all("."+g+"-component").each(function(b,c){var d=p[c],e=d.notFound||d.compoundMismatch||d.rateMismatch;b.toggleClass(l,!e);b.toggleClass(h,e);d.notFound?
(b.addClass(h),this._makeToolTip(b,"Tax Component Missing","In Xero, please enter this component as it is shown here. If you have already entered it, check that the name was typed correctly. Names are case-sensitive.")):(d.compoundMismatch||d.rateMismatch)&&this._makeToolTip(b,"Component Out of Sync","This tax component is out of sync. Please check that it isn't marked Compound, and has a rate of "+this.get("requiredRate").get("taxComponents")[c].rate+"%.")},this);b.Lang.isValue(c.extras)&&b.Array.forEach(c.extras,
function(b){b=d.appendChild(this._renderComponent(b).addClass(g+"-extra"));this._makeToolTip(b,"Extra Component","Please delete this component in Xero.")},this)}},_renderComponent:function(c){var d=this.getClassName();return b.Node.create(b.Lang.sub('<div class="{pfx}-component"><div class="{pfx}-component-name {pfx}-text">{name}</div><div class="{pfx}-component-rate {pfx}-text">{rate}%</div></div>',{name:c.name,rate:c.rate,pfx:d}))},_makeToolTip:function(c,d,g){this._toolTips.push(new b.Squarespace.ToolTip({target:c,
title:d,body:g,dialogTooltip:!0,showTimeout:200,width:250,clickToShow:!0,style:"alert"}))},_clearToolTips:function(){b.Array.forEach(this._toolTips,function(b){b.destroy()})},_clearExtras:function(){var b=this.getClassName();this.get("contentBox").all("."+b+"-extra").remove(!0)},destructor:function(){this._clearToolTips()}},{CSS_PREFIX:"sqs-xero-setup-row",ATTRS:{taxRateDiff:{validator:b.Squarespace.AttrValidators.isObject},requiredRate:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.XeroTaxRate)}}}),
c=b.namespace("Squarespace.DialogFields").XeroTaxSetup=b.Base.create("xeroTaxSetupDialog",b.Squarespace.Widgets.DialogField2,[],{initializer:function(){this.publish("statusChange",{emitFacade:!0});this._taxRows=[];this._pushQuota=0},loadDiff:function(){b.Data.get({url:b.Squarespace.REST_API_ROOT+"xero-sync/rates-needed",success:b.bind(function(b){this.get("ratesForCurrent").reset(b.ratesForCurrent);this.get("ratesForLegacy").reset(b.ratesForLegacy);this.syncUI();this.verify()},this)})},renderUI:function(){c.superclass.renderUI.call(this);
var d=this.get("contentBox");this._stateIndicator=new b.Squarespace.DialogFields.StateIndicatorBanner({boundingBox:this.get("contentBox"),stateDisplays:[{value:b.Squarespace.XeroTaxSyncStatuses.MISSING_RATES,state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.WARN,message:"You need to create the Tax Rates below in Xero."},{value:b.Squarespace.XeroTaxSyncStatuses.MISSING_AND_OUT_OF_SYNC,state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.WARN,message:"Your Tax Rates in Xero are out of sync with Squarespace Commerce."},
{value:b.Squarespace.XeroTaxSyncStatuses.OUT_OF_SYNC,state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.WARN,message:"Your Tax Rates in Xero are out of sync with Squarespace Commerce."},{value:b.Squarespace.XeroTaxSyncStatuses.IN_SYNC,state:b.Squarespace.DialogFields.StateIndicatorBanner.STATES.OK,message:"Your Tax Rates in Xero are in sync with Squarespace Commerce."}]});this._stateIndicator.render();var f=this.getClassName()+"-diff-rows";this._diffRowContainer=d.appendChild('<div class="'+
f+'"></div>');this._curRateContainer=this._diffRowContainer.appendChild('<div class="current-rates"></div>');this._diffRowContainer.append(c.LEGACY_RATES_COPY);this._legacyRateContainer=this._diffRowContainer.appendChild('<div class="legacy-rates"></div>');d.addClass(this.getClassName()+"-loading");this._diffRowContainer.plug(b.Squarespace.Plugins.LoadingOverlay,{spinnerConfig:{size:"extra-large",color:"light"}})},bindUI:function(){c.superclass.bindUI.call(this);var b=this.get("ratesForCurrent"),
d=this.get("ratesForLegacy");b.on("*:save",this._onSaveSuccess,this);d.on("*:save",this._onSaveSuccess,this)},syncUI:function(){this._destroyRows();var b=this.get("ratesForCurrent"),c=this.get("ratesForLegacy"),d=this.get("contentBox");0<c.size()&&d.one(".legacy-rates-copy").setStyle("display","block");b.each(function(b){this._addRow(b,this._curRateContainer)},this);c.each(function(b){this._addRow(b,this._legacyRateContainer)},this)},createAll:function(){var c=!0,d=[];b.Array.forEach(this._taxRows,
function(b){b.rateNotFound()&&(d.push(b),this._pushQuota+=1,c=!1)},this);c?new b.Squarespace.Widgets.Alert({className:"okay","strings.title":"Taxes Correct","strings.message":"Your taxes are already set up correctly in Xero."}):(this.showLoadOverlay(),b.Array.forEach(d,function(c,d){b.later(1200*d,c,c.save)}))},showLoadOverlay:function(){this._diffRowContainer.loadingOverlay.set("visible",!0)},hideLoadOverlay:function(){this._diffRowContainer.loadingOverlay.set("visible",!1)},verify:function(c){c=
c||{};this.showLoadOverlay();b.Data.get({url:b.Squarespace.REST_API_ROOT+"xero-sync/rates-diff",success:b.bind(function(d){var g=d.syncStatus;this.set("syncStatus",g);this._stateIndicator.set("data",g);b.Array.forEach(this._taxRows,function(b,c){b.set("taxRateDiff",d.diffs[c])});this.hideLoadOverlay();if(g===b.Squarespace.XeroTaxSyncStatuses.IN_SYNC){if(b.Lang.isFunction(c.onEqual))c.onEqual()}else if(b.Lang.isFunction(c.onDifferent))c.onDifferent()},this)})},destructor:function(){this._destroyRows()},
_destroyRows:function(){b.Array.forEach(this._taxRows,function(b){b.destroy()});this._taxRows=[]},_onSaveRequested:function(){this.showLoadOverlay();this._pushQuota+=1;console.log(this._pushQuota)},_onSaveSuccess:function(){this._pushQuota-=1;console.log(this._pushQuota);0===this._pushQuota&&this.verify()},_addRow:function(b,c){var g=new d({requiredRate:b,render:c});this._taxRows.push(g);g.on("save-requested",this._onSaveRequested,this);g.render()}},{CSS_PREFIX:"sqs-xero-tax-setup",LOADED_CLS:"sqs-xero-tax-setup-loaded",
ATTRS:{ratesForCurrent:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.XeroTaxRates),valueFn:function(){return new b.Squarespace.Models.XeroTaxRates}},ratesForLegacy:{validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Models.XeroTaxRates),valueFn:function(){return new b.Squarespace.Models.XeroTaxRates}},ratesDiff:{validator:b.Squarespace.AttrValidators.isObject},syncStatus:{},numMissing:{getter:function(){return b.Array.reduce(this._taxRows,0,function(b,c){return c.rateNotFound()?
b+1:b})}}},LEGACY_RATES_COPY:'<div class="legacy-rates-copy">The Tax Rates below are for sales tax collected on past orders. Those orders were placed under a different set of rates than the ones currently configured in Squarespace.</div>'})},"1.0",{requires:"squarespace-dialog-field-2 squarespace-dialog-check squarespace-models-xero-tax-rate squarespace-dialog-state-indicator-banner squarespace-ui-base squarespace-plugin-loading-overlay squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("arraylist-add",function(b,d){b.mix(b.ArrayList.prototype,{add:function(c,d){var f=this._items;b.Lang.isNumber(d)?f.splice(d,0,c):f.push(c);return this},remove:function(b,d,f){f=f||this.itemsAreEqual;for(var g=this._items.length-1;0<=g&&(!f.call(this,b,this.item(g))||!(this._items.splice(g,1),!d));--g);return this},itemsAreEqual:function(b,d){return b===d}})},"3.17.2",{requires:["arraylist"]});
YUI.add("squarespace-settings-site-importing",function(b){b.namespace("Squarespace");var d,c,e,f,g,h;b.Squarespace.JobWidget=d=b.Base.create("jobWidget",b.Widget,[b.WidgetChild],{initializer:function(c){b.assert(!(!c||!c.job),"You must provide a Squarespace.Job instance to create a Job Widget.");this._jobStatusNames=b.Squarespace.Utils.reverseMap(b.Squarespace.JobStatuses);this._importSourceNames=b.Squarespace.Utils.reverseMap(b.Squarespace.ImportingSources);this._jobTypeNames=b.Squarespace.Utils.reverseMap(b.Squarespace.JobTypes);
this._anims=[];this._numMessages=5},destructor:function(){var b=this.get("job");this.get("boundingBox");b.detachAll();this._anims.forEach(function(b){b.get("running")&&b.stop()})},renderUI:function(){var c=this.get("contentBox"),d=this.get("boundingBox"),e=this.get("job");e.get("name");var f=e.get("progress")/100;c.append(b.DB.DIV("general"));c.append(b.DB.DIV("detail",b.DB.DIV("messages")));c.one(".general").append(b.DB.DIV("job-info",b.DB.DIV("type-info",b.DB.DIV("icon "+this._jobTypeNames[e.get("type")].toLowerCase())),
b.DB.DIV("progress",b.DB.DIV("progress-bar")),b.DB.DIV("status",{html:this._jobStatusNames[e.get("status")].toLowerCase()}))).append(b.DB.DIV("job-buttons",b.DB.INPUT("check button light",{type:"button",value:"Clear"})));d.addClass("status-"+this._jobStatusNames[e.get("status")].toLowerCase());this._renderMessages();d=c.one(".progress-bar");c=c.one(".progress");(new b.Anim({duration:0.3,easing:b.Easing.easeOutStrong,node:d,from:{width:0},to:{width:c.get("offsetWidth")*f}})).run()},_renderMessages:function(){var c=
this.get("contentBox"),d=(this.get("job").get("messages")||[]).reverse(),c=c.one(".messages"),e=b.one(b.config.doc.createDocumentFragment());c.empty();d.forEach(function(c){e.append(b.DB.DIV("message level-"+c.get("level"),b.DB.DIV("message-text",{html:"&mdash; "+c.get("message")})))});c.setContent(e)},_getURLForSource:function(c){switch(c){case b.Squarespace.ImportingSources.V5:return this.get("job").get("data").username+".squarespace.com";case b.Squarespace.ImportingSources.WORDPRESS:case b.Squarespace.ImportingSources.TUMBLR:case b.Squarespace.ImportingSources.BIG_CARTEL:return this.get("job").get("data").hostname;
default:return""}},bindUI:function(){var b=this.get("job"),c=this.get("contentBox");b.before("statusChange",this._beforeStatusChange,this);b.after("statusChange",this._afterStatusChange,this);b.after("progressChange",this._afterProgressChange,this);b.after("messagesChange",this._renderMessages,this);this.on("click",this._onBoundingClick,this);c.one(".check").on("click",this._onCheckClick,this)},_onCheckClick:function(b){b.stopImmediatePropagation();this.fire("remove")},_onBoundingClick:function(b){b=
this.get("contentBox");this.get("job").get("messages");b.one(".messages")},_onRetryClick:function(b){b.stopImmediatePropagation();this.fire("retry")},_beforeStatusChange:function(b){var c=this.get("boundingBox");c.removeClass("status-"+this._jobStatusNames[b.prevVal].toLowerCase());c.addClass("status-"+this._jobStatusNames[b.newVal].toLowerCase())},_afterStatusChange:function(b){this.syncUI()},syncUI:function(b){b=this.get("job");var c=this.get("contentBox").one(".status");c.empty();c.setContent(this._jobStatusNames[b.get("status")].toLowerCase())},
_afterProgressChange:function(){var c=this.get("job"),d=this.get("contentBox"),e=d.one(".progress"),d=d.one(".progress-bar"),c=c.get("progress")/100,e=new b.Anim({duration:0.3,easing:b.Easing.easeOutStrong,node:d,to:{width:e.get("offsetWidth")*c}});this._anims.push(e);e.run()}},{ATTRS:{job:{}},CSS_PREFIX:"ss-job"});b.Squarespace.JobList=b.Base.create("jobList",b.Widget,[b.WidgetParent],{renderUI:function(){var c=Static.JOB_MANAGER,d=this.get("contentBox"),c=c.allJobs(),e=b.DB.DIV("jobs"),f,g;d.append(b.DB.DIV("settings-help",
{html:""}));d.append(e);c=b.Object.values(c).sort(function(c,d){return!b.DataType.Date.isGreater(c.get("addedOn"),d.get("addedOn"))});c.filter(function(c){return c.get("type")===b.Squarespace.JobTypes.IMPORTING||c.get("type")==b.Squarespace.JobTypes.EXPORTING_WORDPRESS||c.get("type")==b.Squarespace.JobTypes.STATS_MIGRATION}).forEach(function(b){if(f=h[b.get("type").toString()])g=new f({job:b}),this._bindJob(g),this.add(g),g.render(e)},this)},_addEmptyNotice:function(){this.get("contentBox").append(b.DB.DIV("empty-text large-notice",
{html:"You do not have any open jobs."}))},_removeEmptyNotice:function(){var b=this.get("contentBox").one(".empty-text");b&&b.remove(!0)},bindUI:function(){this.after("addChild",this._removeEmptyNotice,this);this.after("removeChild",function(){this.size()||this._addEmptyNotice()},this)},addJob:function(b){var c=h[b.get("type").toString()];c&&(b=new c({job:b}),this._bindJob(b),this.add(b))},_bindJob:function(b){b.on("retry",this._onRetry,this);b.on("remove",this._onRemove,this)},_onRetry:function(b){var c=
b.target,d=c.get("job");c.on("hidden",function(){c.destroy();this.fire("retry",d)},this);c.hide()},_onRemove:function(c){var d=c.target,e=d.get("job").get("id");b.Data.del({url:"/api/rest/jobs/"+e,success:function(){Static.JOB_MANAGER.removeJobById(e);this.syncUI()}},this);d.destroy();var f=-1;this.some(function(b,c){var e=b.get("id")===d.get("id");e&&(f=c);return e});this.remove(f)},syncUI:function(c){var d=this.get("contentBox");this.each(function(c){if(!c.get("rendered")){var e=b.DB.DIV("temporary-widget-container");
d.one(".jobs").prepend(e);c.render(e);c.get("boundingBox").unwrap()}});(c=d.one(".empty-text"))&&c.remove(!0);this.size()||d.append(b.DB.DIV("empty-text large-notice",{html:"You do not have any open jobs."}))},destructor:function(){Static.JOB_MANAGER.detach("jobList|*");this.detachAll();this.each(function(b){b.destroy()})}},{CSS_PREFIX:"joblist"});b.Squarespace.WordpressExportJobWidget=g=b.Base.create("wordpressExportJobWidget",d,[],{renderUI:function(){b.Squarespace.WordpressExportJobWidget.superclass.renderUI.apply(this,
arguments);var c=this.get("contentBox").one(".general");c.one(".type-info").append(b.DB.DIV("type",{html:"Exporting Site"}));c.one(".icon").addClass("wordpress")},syncUI:function(){b.Squarespace.WordpressExportJobWidget.superclass.syncUI.apply(this,arguments);if(this.get("job").get("status")===b.Squarespace.JobStatuses.SUCCESS){this.get("contentBox").one(".status").replace(b.Node.create('<a class="status download-btn">download</a>'));var c=this.get("job"),d="https://"+b.Object.getValue(Static,["SQUARESPACE_CONTEXT",
"website","identifier"])+"."+Static.SQUARESPACE_CONTEXT.appDomain,d=d+"/api/export/DownloadExport",c={jobId:c.get("id")},d=b.Data.addCrumb(d+"?"+b.QueryString.stringify(c));this.get("contentBox").one(".download-btn").setAttribute("href",d)}}});b.Squarespace.ImportJobWidget=c=b.Base.create("importJobWidget",d,[],{renderUI:function(){b.Squarespace.ImportJobWidget.superclass.renderUI.apply(this,arguments);var c=this.get("job"),d=this.get("contentBox").one(".general"),e=this._getURLForSource(c.get("data").type);
d.one(".type-info").append(b.DB.DIV("type",{html:"Importing Site"}));d.one(".type-info").append(b.DB.DIV("desc",{html:e?e:"Import From File"}));d.one(".icon").addClass(this._importSourceNames[c.get("data").type].toLowerCase())}});b.Squarespace.StatsMigrationJobWidget=e=b.Base.create("statsMigrationJobWidget",d,[],{renderUI:function(){b.Squarespace.StatsMigrationJobWidget.superclass.renderUI.apply(this,arguments);var c=this.get("contentBox").one(".general");c.one(".type-info").append(b.DB.DIV("type",
{html:"Migrating Statistics"}));c.one(".icon").addClass("social-push")}});b.Squarespace.ImageProcJobWidget=f=b.Base.create("imageProcJobWidget",d,[],{renderUI:function(){b.Squarespace.ImageProcJobWidget.superclass.renderUI.apply(this,arguments);var c=this.get("contentBox").one(".general");this.get("job").get("data");c.one(".type-info").append(b.DB.DIV("type",{html:"Image Processing"}));c.one(".icon").addClass("image-processing")}});b.Squarespace.PushJobWidget=d=b.Base.create("pushJobWidget",d,[],
{renderUI:function(){b.Squarespace.PushJobWidget.superclass.renderUI.apply(this,arguments);var c=this.get("contentBox").one(".general");c.one(".type-info").append(b.DB.DIV("type",{html:"Social Publish"}));c.one(".type-info").append(b.DB.DIV("desc",{html:"Facebook"}));c.one(".icon").addClass("social-push")}});h={2:f,3:c,4:d,16:g,26:e};var k=b.namespace("Squarespace.Settings.Site").Importing=b.Base.create("ImportingPanel",b.Squarespace.Widgets.SettingsPanel,[],{initializer:function(){this.set("strings.title",
"Import / Export");description="Squarespace allows you to import content from Wordpress, Tumblr, Squarespace 5, ";description+="Blogger, Shopify, or Big Cartel";description+=' into your Squarespace 6 site.  Use this page to track the progress of importing tasks, or to diagnose errors.  You can also use this area to export select content out of Squarespace. <a target="new" href="'+b.Squarespace.HelpLinks.IMPORT_EXPORT+'">Click here for more help regarding importing and exporting.</a>';this.set("strings.description",
description);this._authDialogMap[b.Squarespace.ImportingSources.BLOGGER]=b.merge(this._defaultAuthDialog,{initialData:{type:b.Squarespace.ImportingSources.BLOGGER},tabs:[b.merge(this._defaultAuthDialog.tabs[0],{title:"Import from Blogger",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Fill in your Blogger credentials to move your content over to Squarespace.</strong>  Please note that this process will only port over blogs and comments.  <br/><br/>Importing from Blogger will not import your site's design or other content.",
padding:[0,10]}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"username",submitOnEnter:!0,required:!0,"strings.title":"Blogspot URL","strings.description":"<strong>Example:</strong> example.blogspot.com"}}]})]});this._authDialogMap[b.Squarespace.ImportingSources.V5]=b.merge(this._defaultAuthDialog,{initialData:{type:b.Squarespace.ImportingSources.V5},tabs:[b.merge(this._defaultAuthDialog.tabs[0],{title:"Import from Squarespace 5",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Fill in your Squarespace 5 credentials to move your content over to Squarespace V6.</strong>  Please note that this process will only port over blogs, pages, galleries and comments.  <br/><br/><strong>The Squarespace 5 importing process currently does not support follow-up posts, podcasting variables, post annotations or audiences.  If you require these features, you should not move to Squarespace 6 at this time.</strong>  <br/><br/>Importing from Squarespace 5 will not import your site's design or other content.",
padding:[0,10]}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"username",className:"thin",submitOnEnter:!0,required:!0,"strings.title":"Account URL or Login","strings.description":"<strong>Example:</strong> http://test.squarespace.com/"}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{className:"thin",name:"password",submitOnEnter:!0,required:!0,password:!0,"strings.title":"Password"}}]})]});this._authDialogMap[b.Squarespace.ImportingSources.TUMBLR]=b.merge(this._defaultAuthDialog,
{initialData:{type:b.Squarespace.ImportingSources.TUMBLR},tabs:[b.merge(this._defaultAuthDialog.tabs[0],{title:"Import from Tumblr",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Fill in your Tumblr credentials to move your content over to Squarespace.</strong>  Squarespace will import all of your post types and retain their proper format.  Style and other content must be manually moved over.",padding:[0,10]}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"hostname",
className:"thin",submitOnEnter:!0,required:!0,"strings.title":"Tumblr URL","strings.description":"<strong>Example:</strong> http://test.tumblr.com/"}}]})]});this._authDialogMap[b.Squarespace.ImportingSources.WORDPRESS]=b.merge(this._defaultAuthDialog,{initialData:{type:b.Squarespace.ImportingSources.WORDPRESS},style:void 0,name:"wordpress-auth",height:365,width:440,validateActiveTabOnly:!0,tabs:[b.merge(this._defaultAuthDialog.tabs[0],{tabTitle:"Basic",title:"Import from Wordpress",fields:[{ctor:b.Squarespace.DialogFields.Description,
config:{text:"<strong>Fill in your Wordpress credentials to move your content over to Squarespace.</strong>  Squarespace will import all of your posts, pages, comments, and attachments.  Style and other content must be manually moved over.",padding:[0,10]}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"hostname",className:"thin",submitOnEnter:!0,required:!0,"strings.title":"Wordpress URL","strings.description":'<strong>Example:</strong> http://test.wordpress.com/  or "test" if your account is hosted at wordpress.com'}},
{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"username",className:"thin",submitOnEnter:!0,required:!0,"strings.title":"Login","strings.description":"<strong>Example:</strong> admin"}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"password",className:"thin",submitOnEnter:!0,required:!0,password:!0,"strings.title":"Password"}}]}),{tabTitle:"Advanced",name:"advanced",fields:[{ctor:b.Squarespace.DialogFields.Select,config:{name:"textProcessor",className:"thin dark","strings.title":"Processor",
"strings.description":"The formatting language that will be used to process your text content during the import.",options:[{value:"0",label:"Standard Wordpress"},{value:"1",label:"Textile"},{value:"2",label:"Markdown"}],defaultValue:"0"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"XML Export Upload",text:"Upload the Wordpress XML file for your site."}},{ctor:b.Squarespace.DialogFields.File,contentType:"text/xml",name:"xmlImport",uploadMessage:"Upload via Wordpress export XML.",transientStore:!0,
maxSize:200,height:188,isWordpressXmlFile:!0}]}]});this._authDialogMap[b.Squarespace.ImportingSources.BIG_CARTEL]=b.merge(this._defaultAuthDialog,{initialData:{type:b.Squarespace.ImportingSources.BIG_CARTEL},tabs:[b.merge(this._defaultAuthDialog.tabs[0],{title:"Import From Big Cartel",name:"upload",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Provide your Big Cartel URL in order to import your Big Cartel listings into  Squarespace.</strong> Squarespace will import prices, descriptions, and images. Due to the format of Big Cartel's export API, variants and inventory are not currently supported.",
padding:[0,10]}},{ctor:b.Squarespace.DialogFields.LabeledText,config:{name:"hostname",className:"thin",submitOnEnter:!0,required:!0,"strings.title":"Big Cartel URL","strings.description":"<strong>Example:</strong> https://test.bigcartel.com/"}}]})]});this._authDialogMap[b.Squarespace.ImportingSources.ETSY]=b.merge(this._defaultAuthDialog,{initialData:{type:b.Squarespace.ImportingSources.ETSY},tabs:[b.merge(this._defaultAuthDialog.tabs[0],{title:"Import From Etsy",name:"upload",fields:[{ctor:b.Squarespace.DialogFields.Description,
config:{text:'<strong>Upload an EtsyListingsDownload.csv file to import your Etsy listings into Squarespace.</strong> <p>To learn how to export your listings, see <a href = "https://www.etsy.com/help/article/338" target="_blank">this knowledge base article</a>. Squarespace will import prices, descriptions, variants, and images. Etsy\'s export file does not support distinct variant quantities and prices, so any variations should be manually entered.</p>',padding:[0,10]}},{ctor:b.Squarespace.DialogFields.File,
contentType:"text/csv",name:"xmlImport",uploadMessage:"Upload Etsy csv file.",transientStore:!0,maxSize:50,height:188}]})]});this._authDialogMap[b.Squarespace.ImportingSources.SHOPIFY]=b.merge(this._defaultAuthDialog,{initialData:{type:b.Squarespace.ImportingSources.SHOPIFY},tabs:[b.merge(this._defaultAuthDialog.tabs[0],{title:"Import From Shopify",name:"upload",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:'<strong>Upload a products.csv file to import your Shopify listings into Squarespace.</strong> To learn how to export your listings, see <a href = "http://wiki.shopify.com/Products-2#Export_products" target="_blank">this help article</a>. Squarespace will import prices, descriptions, variants, quantities, and images.',
padding:[0,10]}},{ctor:b.Squarespace.DialogFields.File,contentType:"text/csv",name:"xmlImport",uploadMessage:"Upload Shopify csv file.",transientStore:!0,maxSize:50,height:188}]})]})},renderUI:function(c){c=b.one("body");c.hasClass("section-settings")||c.addClass("section-settings");c.removeClass("ordering-user");k.superclass.renderUI.call(this);this._jobList=new b.Squarespace.JobList;this._jobList.on("retry",this._retry,this);this._jobList.render(this.get("contentBox"))},_collectionSelectDialog:{loadingText:"Loading...",
style:"flyout",closeOthers:!1,width:370,overlay:0.5,flyoutPointerDirection:"centered",buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Export"}],tabs:[{title:"Select Primary Blog",icon:"/universal/images-v6/icons/icon-export-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Unlike Squarespace, Wordpress does not allow a single installation to manage multiple blogs. Please select a blog to export."}},{ctor:b.Squarespace.DialogFields.Select,config:{className:"thin dark",
name:"collection",options:[]}}]}]},_importDialogParameters:{loadingText:"Loading...",style:"flyout",closeOthers:!1,width:420,overlay:0.5,flyoutPointerDirection:"centered",tabs:[{title:"Import Site",icon:"/universal/images-v6/icons/icon-import-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"<strong>Squarespace provides importing for many popular publishing systems.</strong>  When importing, Squarespace will attempt to ensure that your URLs in blogs are preserved during your switch, and we will download and re-host your media onto our servers.  Trial sites will only be able to import 20 posts."}}]}]},
_importMultiOption:{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"caption-position",className:"round square button",defaultValue:"normal",titleStyle:"top",buttonStyle:!0,columns:3,options:[{icon:"squarespace",title:"V5",value:b.Squarespace.ImportingSources.V5},{icon:"wordpress",title:"WordPress",value:b.Squarespace.ImportingSources.WORDPRESS},{icon:"tumblr",title:"Tumblr",value:b.Squarespace.ImportingSources.TUMBLR},{title:"Blogger",icon:"blogger",value:b.Squarespace.ImportingSources.BLOGGER}]}},
_exportDialogParameters:{loadingText:"Loading...",style:"flyout",closeOthers:!1,width:270,overlay:0.5,flyoutPointerDirection:"centered",tabs:[{title:"Export Site",icon:"/universal/images-v6/icons/icon-export-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Squarespace currently only provides exporting functionality for Wordpress.  Your blogs and pages will be exported."}},{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"caption-position",defaultValue:"normal",
className:"button square",columns:1,numeric:!1,options:[{icon:"wordpress",title:"WordPress",value:"wordpress"}]}}]}]},_defaultAuthDialog:{style:"flyout",closeOthers:!1,width:385,overlay:0.5,flyoutPointerDirection:"centered",tabs:[{title:"Authenticate",icon:"/universal/images-v6/icons/icon-import-16-light.png",fields:[]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Begin Import"}]},_authDialogMap:{},addItem:function(){var c=b.clone(this._importDialogParameters),d=b.clone(this._importMultiOption);
b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","id"]);d.config.options.push({icon:"etsy",title:"Etsy",value:b.Squarespace.ImportingSources.ETSY});d.config.options.push({icon:"shopify",title:"Shopify",value:b.Squarespace.ImportingSources.SHOPIFY});d.config.options.push({icon:"bigcartel",title:"Big Cartel",value:b.Squarespace.ImportingSources.BIG_CARTEL});c.tabs[0].fields.push(d);var e=new b.Squarespace.EditingDialog(c),f;e.once("datachange",function(b){f=b.getValue();e.once("dismiss",function(){e.detachAll();
this._authenticate(f)},this);e.close()},this);e.show()},_exportSite:function(){var c=b.clone(this._exportDialogParameters),d=new b.Squarespace.EditingDialog(c),e=function(c){return b.Array.reduce(c,[],function(b,c){b.push({value:c.get("id"),label:c.get("navigationTitle")});return b})};d.once("datachange",function(c){var f=b.Squarespace.ContentCollectionCache.filter(function(c){return(c=c.getTemplateConfiguration())?c.get("ordering")==b.Squarespace.CollectionOrdering.CHRONOLOGICAL:!1});if("wordpress"===
c.getValue()){if(1<f.length){c=b.clone(this._collectionSelectDialog);f=e(f);c.tabs[0].fields[1].config.options=f;c.tabs[0].fields[1].config.defaultValue=f[0].value;var g=new b.Squarespace.EditingDialog(c);g.once("send-requested",function(){var b=g.getField("collection").getValue();this._createWordpressExportJob(b);g.close()},this);g.show()}else this._createWordpressExportJob();d.close()}},this);d.show()},_authenticate:function(c){var d=new b.Squarespace.EditingDialog(this._authDialogMap[c]);d.on("send-requested",
function(e){c===b.Squarespace.ImportingSources.ETSY?(e=new b.Squarespace.Widgets.Confirmation({className:"alert","strings.title":"Warning","strings.message":"The Etsy CSV does not include distinct prices and quantities for individual variants. When you import, the same price and quantity will be applied to all your variants. If your prices or inventory differ across variants you will need to edit them manually. "}),e.on("confirm",function(){this._createJob(c,d)},this),e.on("cancel",function(){d.close()})):
this._createJob(c,d)},this);d.show()},_createWordpressExportJob:function(c){b.Data.post({url:"/api/export/StartUserExport",data:{blogId:c},success:function(c){c=new b.Squarespace.WordpressExportJob(c.job);Static.JOB_MANAGER.addJob(c);this._jobList.addJob(c)}},this)},_createJob:function(c,d){var e=d.getData();e.xmlImport&&(e.xmlImportId=e.xmlImport.get("id"));e=b.clone(e);delete e.xmlImport;b.Data.post({url:"/api/sync/StartImport",data:e,success:function(c){d.close();c=new b.Squarespace.ImportingJob(c);
Static.JOB_MANAGER.addJob(c);this._jobList.addJob(c)}},this)},_retry:function(c){c=c.details[0];c.get("type")===b.Squarespace.JobTypes.IMPORTING&&this._createJob(c.get("name"),c.get("data"))},destructor:function(){this._jobList.destroy()}},{CSS_PREFIX:"sqs-settings-panel-importing",ATTRS:{buttons:{getter:function(){return[{label:"Export",action:this._exportSite,className:"export"},{type:"add",label:"Import",className:"primary import"}]}}}})},"1.0",{requires:"squarespace-dombuilder squarespace-settings-panel squarespace-jobs squarespace-enum squarespace-dialog-select squarespace-dialog-multi-option squarespace-animations squarespace-json-template squarespace-dialog-description squarespace-widgets-confirmation querystring view widget test widget-parent".split(" ")});
YUI.add("squarespace-dialog-site-user-service-connect",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.SiteUserServiceConnect=b.Base.create("siteUserServiceConnect",b.Squarespace.DialogFields.ServiceConnect,[],{initializer:function(){this.get("contentBox").addClass("sqs-service-connect-content")},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",function(b){var d=!!this.get("data.connected");b=b.target;d&&b.hasClass("icon")?this._disconnect():
d||this._connect()},this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("boundingBox").toggleClass("connected",this.get("data.connected"))},_connect:function(){var b=this.get("data")||{};b.connected=!0;this.set("data",b)},_disconnect:function(){var b=this.get("data")||{};b.connected=!1;this.set("data",b)}},{CSS_PREFIX:"sqs-site-user-service-connect",HANDLEBARS_TEMPLATE:"dialog-site-user-service-connect.html",ATTRS:{strings:{value:{title:"Newsletters"}}}})},"1.0",{requires:"base squarespace-util squarespace-ui-base squarespace-dialog-service-connect squarespace-dialog-site-user-service-connect-template squarespace-dialog-text".split(" ")});
YUI.add("squarespace-dialog-statepicker-inset-calendar",function(b){var d=b.namespace("Squarespace.DialogFields").InsetCalendar=b.Base.create("insetCalendar",b.Squarespace.DialogField2,[b.WidgetChild],{initializer:function(c){var d;d=b.Lang.isDate(c.data)?c.data:b.Lang.isNumber(c.data)?new Date(c.data):new Date;b.Lang.isValue(c.day)||this.set("day",d.getDate());b.Lang.isValue(c.month)||this.set("month",d.getMonth());b.Lang.isValue(c.year)||this.set("year",d.getFullYear())},renderUI:function(){d.superclass.renderUI.call(this);
var b=this.get("contentBox");this._nextMonth=b.one(".next");this._prevMonth=b.one(".prev")},bindUI:function(){d.superclass.bindUI.call(this);this._nextMonth.on("click",this.showNextMonth,this);this._prevMonth.on("click",this.showPrevMonth,this);b.delegate("click",this.handleDayClick,this.get("contentBox"),"td",this);this.after(["dayChange","monthChange"],this.setDate,this)},syncUI:function(){d.superclass.syncUI.call(this);var b=this.get("data")||new Date;this.renderCalendar(b,this.get("type"))},setDate:function(c){if(!c.silent){var d=
this.get("day"),f=this.get("year"),g=this.get("month"),h=new Date;"day"===c.attrName?d=c.newVal:"month"===c.attrName&&(g=c.newVal,b.Lang.isValue(c.prevVal)&&(f=this.updateYear(c.newVal,c.prevVal)));h.set({year:f,month:g,day:d,hours:0,minutes:0,seconds:0,milliseconds:0});this.set("data",new Date(h))}},handleDayClick:function(c){c.halt();var d=parseInt(b.Lang.trim(c.target.get("text")),10);c=c.target;"duration"===this.get("type")&&this.get("allowNever")&&(c.hasClass("fade")||c.hasClass("selected"))||
(c.hasClass("today")||c.hasClass("active"))&&this.set("day",parseInt(d,10))},showNextMonth:function(b){this.updateMonth(1)},showPrevMonth:function(b){this.updateMonth(-1)},renderCalendar:function(c,d){var f=this.get("contentBox"),g;g=this.get("data");var h=b.Squarespace.DateUtils.shiftForWebsiteTimezoneDisplay(c),k=new Date(h.getTime()),l=new Date(h.getTime()),p=c.getDaysInMonth(),q=b.Squarespace.DateUtils.shiftForWebsiteTimezoneDisplay(new Date),r=new Date(h.getTime()),s,t=1,u=0,v=0,w="",y=b.Squarespace.DateUtils.dateFormat(c,
{format:"%B %Y"});l.moveToFirstDayOfMonth();l=l.getDay();r.addMonths(-1);for(var r=r.getDaysInMonth(),z=function(b,c){return'<td class="'+b+'">'+c+"</td>"},u=0;6>u;u++){w+='<tr class="body-row">';if(t>p+l)for(v=0;7>v;++v)w+=z("fade","&nbsp");else for(v=0;7>v;++v)displayVal=t-l,t<=l?w+=z("fade",r+displayVal):t<=p+l?(k.set({day:displayVal}),s="active",g&&h.getDate()===displayVal?s="active selected":q.getFullYear()===h.getFullYear()&&q.getMonth()===h.getMonth()&&q.getDate()===displayVal?s="today"+("duration"===
d?" active":""):k.getTime()<q.getTime()&&"duration"===d&&(s="fade"),w+=z(s,displayVal)):w+=z("fade",displayVal-p),t+=1;w+="</tr>"}g=f.one("table > tbody");g.empty();g.append(b.Node.create(w));f.one(".month").set("text",y)},updateYear:function(b,d){var f=d-b,g=this.get("year");1!==Math.abs(f)&&(1<f?g++:-1>f&&g--,this.set("year",g));return g},updateMonth:function(c){var d=this.get("data")||new Date;c=Number(c);b.Lang.isNumber(c)||(c=0);d.addMonths(c);this.set("day",d.getDate(),{silent:!0});this.setAttrs({month:d.getMonth()});
this.renderCalendar(d,this.get("type"))}},{CSS_PREFIX:"calendar-wrapper",TEMPLATE:'<div class="header"><div class="prev back">&nbsp;</div><span class="month">&nbsp;</span><div class="next">&nbsp;</div></div><table cellpadding="0" cellspacing="0"><thead><tr><td>Su</td><td>Mo</td><td>Tu</td><td>We</td><td>Th</td><td>Fr</td><td>Sa</td></tr></thead><tbody></tbody></table>',ATTRS:{day:{value:1,setter:function(b){return parseInt(b,10)}},month:{},year:{},data:{setter:function(c){return!b.Lang.isValue(c)?
null:b.Lang.isNumber(c)?new Date(c):!b.Lang.isDate(c)?new Date:c}}}})},"1.0",{requires:"base base-build squarespace-dialog-fields squarespace-dialog-field-2 squarespace-node-flyout squarespace-date-utils".split(" ")});
YUI.add("squarespace-widgets-model-list-paginator",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.ModelListPaginator=b.Base.create("ModelListPaginator",b.Squarespace.Widgets.SSWidget,[b.Squarespace.Mixins.Loadable],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox");this._previousButton=b.Node.create('<div class="previous"></div>');this._nextButton=b.Node.create('<div class="next"></div>');c.append(this._previousButton);c.append('<div class="pages">Pages</div>');
c.append(this._nextButton)},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("models");this._previousButton.on("click",function(d){!this.get("loading")&&d.target.hasClass("enabled")&&b.previousPage()},this);this._nextButton.on("click",function(d){!this.get("loading")&&d.target.hasClass("enabled")&&b.nextPage()},this);b.after(["hasNextPageChange","hasPreviousPageChange"],this.syncUI,this)},syncUI:function(){d.superclass.syncUI.call(this);this.get("contentBox").toggleClass("loading",
this.get("loading"));var b=this.get("models"),e=b.get("hasPreviousPage"),b=b.get("hasNextPage");this._previousButton.toggleClass("enabled",e);this._nextButton.toggleClass("enabled",b)}},{CSS_PREFIX:"sqs-model-list-paginator",ATTRS:{models:{valueFn:function(){return new b.Squarespace.Models.ModelList},validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.ModelList),writeOnce:"initOnly"},loadable:{getter:function(){return this.get("models")},readOnly:!0}}})},"1.0",{requires:"base event-custom squarespace-attr-validators squarespace-mixins-loadable squarespace-models-model-list squarespace-ss-widget".split(" ")});
(function(b,d,c,e,f,g){function h(b,c){var d=typeof b[c];return"function"==d||!!("object"==d&&b[c])||"unknown"==d}function k(){if(!u(navigator.plugins)&&"object"==typeof navigator.plugins["Shockwave Flash"]){var b=navigator.plugins["Shockwave Flash"].description;b&&(!u(navigator.mimeTypes)&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin)&&(Q=b.match(/\d+/g))}if(!Q){var c;try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),
Q=Array.prototype.slice.call(c.GetVariable("$version").match(/(\d+),(\d+),(\d+),(\d+)/),1)}catch(d){}}if(!Q)return!1;b=parseInt(Q[0],10);c=parseInt(Q[1],10);V=9<b&&0<c;return!0}function l(){if(!N){N=!0;for(var b=0;b<ca.length;b++)ca[b]();ca.length=0}}function p(b,c){N?b.call(c):ca.push(function(){b.call(c)})}function q(){var b=parent;if(""!==H)for(var c=0,d=H.split(".");c<d.length;c++)b=b[d[c]];return b.easyXDM}function r(b){var c=b.toLowerCase().match(E);b=c[2];var d=c[3],c=c[4]||"";if("http:"==
b&&":80"==c||"https:"==b&&":443"==c)c="";return b+"//"+d+c}function s(b){b=b.replace(U,"$1/");if(!b.match(/^(http||https):\/\//)){var d="/"===b.substring(0,1)?"":c.pathname;"/"!==d.substring(d.length-1)&&(d=d.substring(0,d.lastIndexOf("/")+1));b=c.protocol+"//"+c.host+d+b}for(;F.test(b);)b=b.replace(F,"");return b}function t(b,c){var d="",e=b.indexOf("#");-1!==e&&(d=b.substring(e),b=b.substring(0,e));var e=[],f;for(f in c)c.hasOwnProperty(f)&&e.push(f+"="+g(c[f]));return b+(I?"#":-1==b.indexOf("?")?
"?":"&")+e.join("&")+d}function u(b){return"undefined"===typeof b}function v(b,c,d){var e,f;for(f in c)c.hasOwnProperty(f)&&(f in b?(e=c[f],"object"===typeof e?v(b[f],e,d):d||(b[f]=c[f])):b[f]=c[f]);return b}function w(b){if(u(M)){var c=d.body.appendChild(d.createElement("form")),e=c.appendChild(d.createElement("input"));e.name=D+"TEST"+K;M=e!==c.elements[e.name];d.body.removeChild(c)}M?c=d.createElement('<iframe name="'+b.props.name+'"/>'):(c=d.createElement("IFRAME"),c.name=b.props.name);c.id=c.name=
b.props.name;delete b.props.name;"string"==typeof b.container&&(b.container=d.getElementById(b.container));b.container||(v(c.style,{position:"absolute",top:"-2000px",left:"0px"}),b.container=d.body);e=b.props.src;b.props.src="javascript:false";v(c,b.props);c.border=c.frameBorder=0;c.allowTransparency=!0;b.container.appendChild(c);b.onLoad&&C(c,"load",b.onLoad);if(b.usePost){var f=b.container.appendChild(d.createElement("form")),g;f.target=c.name;f.action=e;f.method="POST";if("object"===typeof b.usePost)for(var h in b.usePost)b.usePost.hasOwnProperty(h)&&
(M?g=d.createElement('<input name="'+h+'"/>'):(g=d.createElement("INPUT"),g.name=h),g.value=b.usePost[h],f.appendChild(g));f.submit();f.parentNode.removeChild(f)}else c.src=e;b.props.src=e;return c}function y(e){var f=e.protocol,g;e.isHost=e.isHost||u(ba.xdm_p);I=e.hash||!1;e.props||(e.props={});if(e.isHost)e.remote=s(e.remote),e.channel=e.channel||"default"+K++,e.secret=Math.random().toString(16).substring(2),u(f)&&(f=r(c.href)==r(e.remote)?"4":h(b,"postMessage")||h(d,"postMessage")?"1":e.swf&&h(b,
"ActiveXObject")&&k()?"6":"Gecko"===navigator.product&&"frameElement"in b&&-1==navigator.userAgent.indexOf("WebKit")?"5":e.remoteHelper?"2":"0");else{e.channel=ba.xdm_c.replace(/["'<>\\]/g,"");e.secret=ba.xdm_s;e.remote=ba.xdm_e.replace(/["'<>\\]/g,"");var f=ba.xdm_p,l;if(l=e.acl){a:{l=e.acl;var p=e.remote;"string"==typeof l&&(l=[l]);for(var q,w=l.length;w--;)if(q=l[w],q=RegExp("^"==q.substr(0,1)?q:"^"+q.replace(/(\*)/g,".$1").replace(/\?/g,".")+"$"),q.test(p)){l=!0;break a}l=!1}l=!l}if(l)throw Error("Access denied for "+
e.remote);}e.protocol=f;switch(f){case "0":v(e,{interval:100,delay:2E3,useResize:!0,useParent:!1,usePolling:!1},!0);if(e.isHost){if(!e.local){f=c.protocol+"//"+c.host;g=d.body.getElementsByTagName("img");for(p=g.length;p--;)if(l=g[p],l.src.substring(0,f.length)===f){e.local=l.src;break}e.local||(e.local=b)}f={xdm_c:e.channel,xdm_p:0};e.local===b?(e.usePolling=!0,e.useParent=!0,e.local=c.protocol+"//"+c.host+c.pathname+c.search,f.xdm_e=e.local,f.xdm_pa=1):f.xdm_e=s(e.local);e.container&&(e.useResize=
!1,f.xdm_po=1);e.remote=t(e.remote,f)}else v(e,{channel:ba.xdm_c,remote:ba.xdm_e,useParent:!u(ba.xdm_pa),usePolling:!u(ba.xdm_po),useResize:e.useParent?!1:e.useResize});g=[new G.stack.HashTransport(e),new G.stack.ReliableBehavior({}),new G.stack.QueueBehavior({encode:!0,maxLength:4E3-e.remote.length}),new G.stack.VerifyBehavior({initiate:e.isHost})];break;case "1":g=[new G.stack.PostMessageTransport(e)];break;case "2":e.remoteHelper=s(e.remoteHelper);g=[new G.stack.NameTransport(e),new G.stack.QueueBehavior,
new G.stack.VerifyBehavior({initiate:e.isHost})];break;case "3":g=[new G.stack.NixTransport(e)];break;case "4":g=[new G.stack.SameOriginTransport(e)];break;case "5":g=[new G.stack.FrameElementTransport(e)];break;case "6":Q||k(),g=[new G.stack.FlashTransport(e)]}g.push(new G.stack.QueueBehavior({lazy:e.lazy,remove:!0}));return g}function z(b){for(var c,d={incoming:function(b,c){this.up.incoming(b,c)},outgoing:function(b,c){this.down.outgoing(b,c)},callback:function(b){this.up.callback(b)},init:function(){this.down.init()},
destroy:function(){this.down.destroy()}},e=0,f=b.length;e<f;e++)c=b[e],v(c,d,!0),0!==e&&(c.down=b[e-1]),e!==f-1&&(c.up=b[e+1]);return c}function B(b){b.up.down=b.down;b.down.up=b.up;b.up=b.down=null}var A=this,K=Math.floor(1E4*Math.random()),O=Function.prototype,E=/^((http.?:)\/\/([^:\/\s]+)(:\d+)*)/,F=/[\-\w]+\/\.\.\//,U=/([^:])\/\//g,H="",G={},aa=b.easyXDM,D="easyXDM_",M,I=!1,Q,V,C,Z;if(h(b,"addEventListener"))C=function(b,c,d){b.addEventListener(c,d,!1)},Z=function(b,c,d){b.removeEventListener(c,
d,!1)};else if(h(b,"attachEvent"))C=function(b,c,d){b.attachEvent("on"+c,d)},Z=function(b,c,d){b.detachEvent("on"+c,d)};else throw Error("Browser not supported");var N=!1,ca=[],R;"readyState"in d?(R=d.readyState,N="complete"==R||~navigator.userAgent.indexOf("AppleWebKit/")&&("loaded"==R||"interactive"==R)):N=!!d.body;if(!N){if(h(b,"addEventListener"))C(d,"DOMContentLoaded",l);else if(C(d,"readystatechange",function(){"complete"==d.readyState&&l()}),d.documentElement.doScroll&&b===top){var X=function(){if(!N){try{d.documentElement.doScroll("left")}catch(b){e(X,
1);return}l()}};X()}C(b,"load",l)}var ba=function(b){b=b.substring(1).split("&");for(var c={},d,e=b.length;e--;)d=b[e].split("="),c[d[0]]=f(d[1]);return c}(/xdm_e=/.test(c.search)?c.search:c.hash),na=function(){var b={},c={a:[1,2,3]};if("undefined"!=typeof JSON&&"function"===typeof JSON.stringify&&'{"a":[1,2,3]}'===JSON.stringify(c).replace(/\s/g,""))return JSON;Object.toJSON&&'{"a":[1,2,3]}'===Object.toJSON(c).replace(/\s/g,"")&&(b.stringify=Object.toJSON);"function"===typeof String.prototype.evalJSON&&
(c='{"a":[1,2,3]}'.evalJSON(),c.a&&(3===c.a.length&&3===c.a[2])&&(b.parse=function(b){return b.evalJSON()}));return b.stringify&&b.parse?(na=function(){return b},b):null};v(G,{version:"2.4.16.3",query:ba,stack:{},apply:v,getJSONObject:na,whenReady:p,noConflict:function(c){b.easyXDM=aa;(H=c)&&(D="easyXDM_"+H.replace(".","_")+"_");return G}});G.DomHelper={on:C,un:Z,requiresJSON:function(c){"object"==typeof b.JSON&&b.JSON||d.write('<script type="text/javascript" src="'+c+'">\x3c/script>')}};(function(){var b=
{};G.Fn={set:function(c,d){b[c]=d},get:function(c,d){var e=b[c];d&&delete b[c];return e}}})();G.Socket=function(b){var c=z(y(b).concat([{incoming:function(c,d){b.onMessage(c,d)},callback:function(c){if(b.onReady)b.onReady(c)}}])),d=r(b.remote);this.origin=r(b.remote);this.destroy=function(){c.destroy()};this.postMessage=function(b){c.outgoing(b,d)};c.init()};G.Rpc=function(b,c){if(c.local)for(var d in c.local)if(c.local.hasOwnProperty(d)){var e=c.local[d];"function"===typeof e&&(c.local[d]={method:e})}var f=
z(y(b).concat([new G.stack.RpcBehavior(this,c),{callback:function(c){if(b.onReady)b.onReady(c)}}]));this.origin=r(b.remote);this.destroy=function(){f.destroy()};f.init()};G.stack.SameOriginTransport=function(b){var d,f,g,h;return d={outgoing:function(b,c,d){g(b);d&&d()},destroy:function(){f&&(f.parentNode.removeChild(f),f=null)},onDOMReady:function(){h=r(b.remote);b.isHost?(v(b.props,{src:t(b.remote,{xdm_e:c.protocol+"//"+c.host+c.pathname,xdm_c:b.channel,xdm_p:4}),name:D+b.channel+"_provider"}),
f=w(b),G.Fn.set(b.channel,function(b){g=b;e(function(){d.up.callback(!0)},0);return function(b){d.up.incoming(b,h)}})):(g=q().Fn.get(b.channel,!0)(function(b){d.up.incoming(b,h)}),e(function(){d.up.callback(!0)},0))},init:function(){p(d.onDOMReady,d)}}};G.stack.FlashTransport=function(b){function f(b,c){e(function(){h.up.incoming(b,l)},0)}function g(c){var e=b.swf+"?host="+b.isHost,f="easyXDM_swf_"+Math.floor(1E4*Math.random());G.Fn.set("flash_loaded"+c.replace(/[\-.]/g,"_"),function(){G.stack.FlashTransport[c].swf=
q=u.firstChild;for(var b=G.stack.FlashTransport[c].queue,d=0;d<b.length;d++)b[d]();b.length=0});b.swfContainer?u="string"==typeof b.swfContainer?d.getElementById(b.swfContainer):b.swfContainer:(u=d.createElement("div"),v(u.style,V&&b.swfNoThrottle?{height:"20px",width:"20px",position:"fixed",right:0,top:0}:{height:"1px",width:"1px",position:"absolute",overflow:"hidden",right:0,top:0}),d.body.appendChild(u));var h="callback=flash_loaded"+c.replace(/[\-.]/g,"_")+"&proto="+A.location.protocol+"&domain="+
A.location.href.match(E)[3]+"&port="+(A.location.href.match(E)[4]||"")+"&ns="+H;u.innerHTML="<object height='20' width='20' type='application/x-shockwave-flash' id='"+f+"' data='"+e+"'><param name='allowScriptAccess' value='always'></param><param name='wmode' value='transparent'><param name='movie' value='"+e+"'></param><param name='flashvars' value='"+h+"'></param><embed type='application/x-shockwave-flash' FlashVars='"+h+"' allowScriptAccess='always' wmode='transparent' src='"+e+"' height='1' width='1'></embed></object>"}
var h,k,l,q,u;return h={outgoing:function(c,d,e){q.postMessage(b.channel,c.toString());e&&e()},destroy:function(){try{q.destroyChannel(b.channel)}catch(c){}q=null;k&&(k.parentNode.removeChild(k),k=null)},onDOMReady:function(){l=b.remote;G.Fn.set("flash_"+b.channel+"_init",function(){e(function(){h.up.callback(!0)})});G.Fn.set("flash_"+b.channel+"_onMessage",f);b.swf=s(b.swf);var d=b.swf.match(E)[3],p=function(){G.stack.FlashTransport[d].init=!0;q=G.stack.FlashTransport[d].swf;q.createChannel(b.channel,
b.secret,r(b.remote),b.isHost);b.isHost&&(V&&b.swfNoThrottle&&v(b.props,{position:"fixed",right:0,top:0,height:"20px",width:"20px"}),v(b.props,{src:t(b.remote,{xdm_e:r(c.href),xdm_c:b.channel,xdm_p:6,xdm_s:b.secret}),name:D+b.channel+"_provider"}),k=w(b))};G.stack.FlashTransport[d]&&G.stack.FlashTransport[d].init?p():G.stack.FlashTransport[d]?G.stack.FlashTransport[d].queue.push(p):(G.stack.FlashTransport[d]={queue:[p]},g(d))},init:function(){p(h.onDOMReady,h)}}};G.stack.PostMessageTransport=function(d){function f(b){var e;
if(b.origin)e=r(b.origin);else if(b.uri)e=r(b.uri);else if(b.domain)e=c.protocol+"//"+b.domain;else throw"Unable to retrieve the origin of the event";e==l&&b.data.substring(0,d.channel.length+1)==d.channel+" "&&g.up.incoming(b.data.substring(d.channel.length+1),e)}var g,h,k,l;return g={outgoing:function(b,c,e){k.postMessage(d.channel+" "+b,c||l);e&&e()},destroy:function(){Z(b,"message",f);h&&(k=null,h.parentNode.removeChild(h),h=null)},onDOMReady:function(){l=r(d.remote);if(d.isHost){var p=function(c){c.data==
d.channel+"-ready"&&(k="postMessage"in h.contentWindow?h.contentWindow:h.contentWindow.document,Z(b,"message",p),C(b,"message",f),e(function(){g.up.callback(!0)},0))};C(b,"message",p);v(d.props,{src:t(d.remote,{xdm_e:r(c.href),xdm_c:d.channel,xdm_p:1}),name:D+d.channel+"_provider"});h=w(d)}else C(b,"message",f),k="postMessage"in b.parent?b.parent:b.parent.document,k.postMessage(d.channel+"-ready",l),e(function(){g.up.callback(!0)},0)},init:function(){p(g.onDOMReady,g)}}};G.stack.FrameElementTransport=
function(f){var g,h,k,l;return g={outgoing:function(b,c,d){k.call(this,b);d&&d()},destroy:function(){h&&(h.parentNode.removeChild(h),h=null)},onDOMReady:function(){l=r(f.remote);f.isHost?(v(f.props,{src:t(f.remote,{xdm_e:r(c.href),xdm_c:f.channel,xdm_p:5}),name:D+f.channel+"_provider"}),h=w(f),h.fn=function(b){delete h.fn;k=b;e(function(){g.up.callback(!0)},0);return function(b){g.up.incoming(b,l)}}):(d.referrer&&r(d.referrer)!=ba.xdm_e&&(b.top.location=ba.xdm_e),k=b.frameElement.fn(function(b){g.up.incoming(b,
l)}),g.up.callback(!0))},init:function(){p(g.onDOMReady,g)}}};G.stack.NameTransport=function(b){function c(d){l.contentWindow.sendMessage(d,b.remoteHelper+(k?"#_3":"#_2")+b.channel)}function d(){k?(2===++u||!k)&&h.up.callback(!0):(c("ready"),h.up.callback(!0))}function f(b){h.up.incoming(b,z)}function g(){y&&e(function(){y(!0)},0)}var h,k,l,q,u,y,z,A;return h={outgoing:function(b,d,e){y=e;c(b)},destroy:function(){l.parentNode.removeChild(l);l=null;k&&(q.parentNode.removeChild(q),q=null)},onDOMReady:function(){k=
b.isHost;u=0;z=r(b.remote);b.local=s(b.local);k?(G.Fn.set(b.channel,function(c){k&&"ready"===c&&(G.Fn.set(b.channel,f),d())}),A=t(b.remote,{xdm_e:b.local,xdm_c:b.channel,xdm_p:2}),v(b.props,{src:A+"#"+b.channel,name:D+b.channel+"_provider"}),q=w(b)):(b.remoteHelper=b.remote,G.Fn.set(b.channel,f));var c=function(){var f=l||this;Z(f,"load",c);G.Fn.set(b.channel+"_load",g);(function Ua(){"function"==typeof f.contentWindow.sendMessage?d():e(Ua,50)})()};l=w({props:{src:b.local+"#_4"+b.channel},onLoad:c})},
init:function(){p(h.onDOMReady,h)}}};G.stack.HashTransport=function(c){function d(){if(s){var b=s.location.href,c="",e=b.indexOf("#");-1!=e&&(c=b.substring(e));c&&c!=l&&(l=c,f.up.incoming(l.substring(l.indexOf("_")+1),y))}}var f,g,h,k,l,q,s,t,u,y;return f={outgoing:function(b,d){if(t){var e=c.remote+"#"+q++ +"_"+b;(g||!u?t.contentWindow:t).location=e}},destroy:function(){b.clearInterval(h);(g||!u)&&t.parentNode.removeChild(t);t=null},onDOMReady:function(){g=c.isHost;k=c.interval;l="#"+c.channel;q=
0;u=c.useParent;y=r(c.remote);if(g){v(c.props,{src:c.remote,name:D+c.channel+"_provider"});if(u)c.onLoad=function(){s=b;h=setInterval(d,k);f.up.callback(!0)};else{var p=0,z=c.delay/50;(function Ba(){if(++p>z)throw Error("Unable to reference listenerwindow");try{s=t.contentWindow.frames[D+c.channel+"_consumer"]}catch(b){}s?(h=setInterval(d,k),f.up.callback(!0)):e(Ba,50)})()}t=w(c)}else s=b,h=setInterval(d,k),u?(t=parent,f.up.callback(!0)):(v(c,{props:{src:c.remote+"#"+c.channel+new Date,name:D+c.channel+
"_consumer"},onLoad:function(){f.up.callback(!0)}}),t=w(c))},init:function(){p(f.onDOMReady,f)}}};G.stack.ReliableBehavior=function(b){var c,d,e=0,f=0,g="";return c={incoming:function(b,h){var k=b.indexOf("_"),l=b.substring(0,k).split(",");b=b.substring(k+1);l[0]==e&&(g="",d&&(d(!0),d=null));0<b.length&&(c.down.outgoing(l[1]+","+e+"_"+g,h),f!=l[1]&&(f=l[1],c.up.incoming(b,h)))},outgoing:function(b,h,k){g=b;d=k;c.down.outgoing(f+","+ ++e+"_"+b,h)}}};G.stack.QueueBehavior=function(b){function c(){if(b.remove&&
0===h.length)B(d);else if(!k&&!(0===h.length||p)){k=!0;var f=h.shift();d.down.outgoing(f.data,f.origin,function(b){k=!1;f.callback&&e(function(){f.callback(b)},0);c()})}}var d,h=[],k=!0,l="",p,q=0,r=!1,s=!1;return d={init:function(){u(b)&&(b={});b.maxLength&&(q=b.maxLength,s=!0);b.lazy?r=!0:d.down.init()},callback:function(b){k=!1;var e=d.up;c();e.callback(b)},incoming:function(c,e){if(s){var g=c.indexOf("_"),h=parseInt(c.substring(0,g),10);l+=c.substring(g+1);0===h&&(b.encode&&(l=f(l)),d.up.incoming(l,
e),l="")}else d.up.incoming(c,e)},outgoing:function(e,f,k){b.encode&&(e=g(e));var l=[],p;if(s){for(;0!==e.length;)p=e.substring(0,q),e=e.substring(p.length),l.push(p);for(;p=l.shift();)h.push({data:l.length+"_"+p,origin:f,callback:0===l.length?k:null})}else h.push({data:e,origin:f,callback:k});r?d.down.init():c()},destroy:function(){p=!0;d.down.destroy()}}};G.stack.VerifyBehavior=function(b){function c(){e=Math.random().toString(16).substring(2);d.down.outgoing(e)}var d,e,f;return d={incoming:function(g,
h){var k=g.indexOf("_");-1===k?g===e?d.up.callback(!0):f||(f=g,b.initiate||c(),d.down.outgoing(g)):g.substring(0,k)===f&&d.up.incoming(g.substring(k+1),h)},outgoing:function(b,c,f){d.down.outgoing(e+"_"+b,c,f)},callback:function(d){b.initiate&&c()}}};G.stack.RpcBehavior=function(b,c){function d(b){b.jsonrpc="2.0";g.down.outgoing(h.stringify(b))}function e(b,c){var f=Array.prototype.slice;return function(){var e=arguments.length,g,h={method:c};0<e&&"function"===typeof arguments[e-1]?(1<e&&"function"===
typeof arguments[e-2]?(g={success:arguments[e-2],error:arguments[e-1]},h.params=f.call(arguments,0,e-2)):(g={success:arguments[e-1]},h.params=f.call(arguments,0,e-1)),l[""+ ++k]=g,h.id=k):h.params=f.call(arguments,0);b.namedParams&&1===h.params.length&&(h.params=h.params[0]);d(h)}}function f(b,c,e,g){if(e){var h,k;c?(h=function(b){h=O;d({id:c,result:b})},k=function(b,e){k=O;var f={id:c,error:{code:-32099,message:b}};e&&(f.error.data=e);d(f)}):h=k=O;"[object Array]"!==Object.prototype.toString.call(g)&&
(g=[g]);try{var l=e.method.apply(e.scope,g.concat([h,k]));u(l)||h(l)}catch(p){k(p.message)}}else c&&d({id:c,error:{code:-32601,message:"Procedure not found."}})}var g,h=c.serializer||na(),k=0,l={};return g={incoming:function(b,e){var g=h.parse(b);if(g.method)c.handle?c.handle(g,d):f(g.method,g.id,c.local[g.method],g.params);else{var k=l[g.id];g.error?k.error&&k.error(g.error):k.success&&k.success(g.result);delete l[g.id]}},init:function(){if(c.remote)for(var d in c.remote)c.remote.hasOwnProperty(d)&&
(b[d]=e(c.remote[d],d));g.down.init()},destroy:function(){for(var d in c.remote)c.remote.hasOwnProperty(d)&&b.hasOwnProperty(d)&&delete b[d];g.down.destroy()}}};A.easyXDM=G})(window,document,location,window.setTimeout,decodeURIComponent,encodeURIComponent);YUI.add("thirdparty-easyxdm",function(b){},"2.4.16");
YUI.add("squarespace-dialog-text-area",function(b){b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.TextArea=b.Base.create("textArea",b.Squarespace.DialogField2,[],{initializer:function(){this._edited=!1},renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("dialog");b.Lang.isValue(c)&&this.get("contentBox").one("textarea").setAttribute("tabindex",c.getNextTabIndex())},bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").one("textarea").after("valuechange",
function(b){this._edited=!0;this.set("data",b.newVal)},this)},didDataChange:function(){return this._edited},focus:function(){d.superclass.focus.call(this);this.get("rendered")&&this.get("contentBox").one("textarea").focus()},blur:function(){d.superclass.blur.call(this);this.get("rendered")&&this.get("contentBox").one("textarea").blur()}},{CSS_PREFIX:"sqs-text-area",HANDLEBARS_TEMPLATE:"dialog-text-area.html",ATTRS:{data:{value:""},strings:{value:{placeholder:""}}}})},"1.0",{requires:["base","node",
"squarespace-dialog-field-2","squarespace-dialog-text-area-template"]});
YUI.add("squarespace-block-unrenderable",function(b){b.namespace("Squarespace.Block").Unrenderable=b.Base.create("block-unrenderable",b.Squarespace.Block.Base,[],{renderUI:function(){var d=this.get("blockType")+" blocks cannot be rendered",d=d+(b.UA.mobile?" in the mobile editor.":".");this.get("boundingBox").addClass("sqs-block-error");this.get("contentBox").setHTML('<div class="error">'+d+"</div>")}},{CSS_PREFIX:"sqs-block-unrenderable",ATTRS:{blockType:{valueFn:function(){return b.Squarespace.StringUtils.toUpperCamelCase(b.Squarespace.BlockTypeByString[this.get("type")])}}}})},
"1.0",{requires:["squarespace-block-base","squarespace-util"]});
YUI.add("squarespace-content-manager-widgets-placeholder",function(b){var d=b.Squarespace.ContentManagerWidgets.PlaceHolderWidget=b.Base.create("PlaceHolderWidget",b.Squarespace.Widgets.SSWidget,[b.WidgetChild],{renderUI:function(){this.get("boundingBox").addClass(this.getClassName("icon-"+this.get("icon")));this.get("contentBox").appendChild(b.Lang.sub(d.TEMPLATE,this.get("strings")));this.get("onClickHandler")&&this.get("boundingBox").addClass(this.getClassName("clickable"))},bindUI:function(){var b=
this.get("onClickHandler");if(b)this.get("boundingBox").on("click",b,this)}},{CSS_PREFIX:"sqs-content-manager-placeholder",TEMPLATE:'<div class="title">{title}</div><div class="description">{description}</div>',ATTRS:{icon:{value:"add"},strings:{value:{title:"Empty",description:"There are no items to display."}},onClickHandler:{value:null}}})},"1.0",{requires:["squarespace-ss-widget","base-build","widget-child"]});
YUI.add("squarespace-block-collection-link-editor",function(b){b.namespace("Squarespace.Block.Editor").CollectionLink=b.Base.create("collection-link-block-editor-dialog",b.Squarespace.Block.Editor.Dialog,[],{_getModelEditor:function(){return b.Squarespace.Damask.ContextGlobals.fromTop("Y.Squarespace.Block.ModelEditorDialog.CollectionLink")}},{NS:"blockEditor",ATTRS:{blockName:{value:"CollectionLink"}}});var d=b.namespace("Squarespace.Block.ModelEditorDialog").CollectionLink=b.Base.create("blockCollectionLinkEditor",
b.Squarespace.ModelEditorDialog,[],{_showDialog:function(){d.superclass._showDialog.call(this);var b=this.get("dialog").getField("collectionId");b.set("collectionGroups",this._getCollectionGroups());b.syncUI()},_getCollectionGroups:function(){var c=b.Squarespace.ContentCollectionUtils,d=b.Squarespace.ContentCollectionCache,f=d.filter(c.isGenericOrProduct),g=d.filter(c.isPage),d=d.filter(c.isIndex),c=c.groupCollectionsByTypeName(f);c.push({title:"Pages",collections:g});c.push({title:"Index",collections:d});
return c},_getDialogConfig:function(){return{width:335,height:400,discardChangesConfirmation:!1,closeOthers:!1,draggable:!0,flyoutPointerDirection:"hidden",style:"flyout",initialDataByReference:!0,buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Edit Content Link",icon:"/universal/images-v6/icons/icon-link-16-light-solid.png",scroll:!0,fields:[{type:"description",text:"Below, <strong>select the Squarespace page</strong> you'd like to link to. Squarespace will create a link to this page with the associated thumbnail and description set in this page's settings panel."},
{ctor:b.Squarespace.DialogFields.ContentIdSelector,config:{mode:"page",showCollectionTagsAndCategories:!1,showGroupTitles:!0,name:"collectionId",collectionGroups:[]}}]}]}}},{ATTRS:{dialogConfig:{getter:"_getDialogConfig"}}})},"1.0",{requires:"base squarespace-block-editor-dialog squarespace-content-collection-utils squarespace-damask-context-globals squarespace-dialog-content-item-grid squarespace-dialog-gallery-options squarespace-dialog-multi-option squarespace-dialog-multi-frame squarespace-gallery-option-synchronizer squarespace-models-content-collection squarespace-plugin-actionoverlay".split(" ")});
YUI.add("squarespace-settings-activity-popular-content",function(b){b.namespace("Squarespace.Settings.Activity");var d=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"]),c=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","appDomain"]);b.Squarespace.Settings.Activity.PopularContent=b.Base.create("ActivityManagerPopularContent",b.Squarespace.Settings.Activity.BaseManager,[b.Squarespace.Settings.Activity.MixinSpinnerfied],{_isDataEmpty:function(c){return!b.Lang.isArray(c.summaries)||
0===c.summaries.length},_renderSuccess:function(c){var d=this.get("contentBody"),g=b.Node.create('<div class= "chart-container clear pie"></div>'),h=b.Node.create('<div class="detail padtop"></div>'),k=b.Node.create('<div class="summary pie clear"></div>'),l=this.renderSummary(c.totalCount,null,null,"Total Page Views");k.append(l);this._isDataEmpty(c)||(l=this._getTableEl(c),h.append(l));d.append(g).append(k).append(h);this.renderPopularContentChart(c,g)},_getTableEl:function(e){var f=b.Node.create('<div class="body"></div>'),
g=b.Node.create(b.Lang.sub('<div class="table"><div class="head"><div class="row clear"><div class="cell first-column data">{firstCellText}</div><div class="cell icon">{icon}</div><div class="cell text">{lastCellText}</div></div></div></div>',{firstCellText:"Count",lastCellText:"Page",icon:""}));b.Array.each(e.summaries,function(e,g){var l=this.parseTargetName(e.page),p=l.collectionType.toLowerCase(),p=this.getCollectionTypeIcon(p),l='<a href="http:'+("//"+d+"."+c+e.path)+'" target="_blank">'+l.title+
"</a>",l=b.Node.create(b.Lang.sub('<div class="head"><div class="row clear"><div class="cell first-column data">{firstCellText}</div><div class="cell icon">{icon}</div><div class="cell text">{lastCellText}</div></div></div>',{icon:p,firstCellText:this.formatNumber(e.count),lastCellText:l}));f.append(l)},this);g.append(f);return g},getCollectionTypeIcon:function(b){return-1!=="gallery journal page link twitter rss".split(" ").indexOf(b)?'<div class="icon icon-'+b+'"><img src="'+("/universal/images-v6/modules/"+
b)+'-sitemap.png"></div>':'<div class="icon-empty">&nbsp</div>'},renderPopularContentChart:function(c,d){this.renderStandardPieChart(c.summaries,d,b.bind(function(b){return b.page},this))}},{CSS_PREFIX:"sqs-activity-manager-popular-content",ATTRS:{activeTab:{value:"week"},strings:{value:{title:"Popular Content"}},tabs:{value:[{key:"1day",label:"1 Day"},{key:"2days",label:"2 Days"},{key:"3days",label:"3 Days"},{key:"week",label:"Week"},{key:"month",label:"Month"}]},requestParams:{getter:function(){return{name:"content",
numberOfDays:this._periodToDays(this.get("activeTab")),verbose:!1}}}}})},"1.0",{requires:["base","squarespace-settings-activity-base-manager","squarespace-settings-activity-mixin-spinnerfied"]});
YUI.add("squarespace-block-base",function(b){var d=d||function(){};b.namespace("Squarespace.Block").Base=b.Base.create("block-base",b.Squarespace.SSWidget,[],{initializer:function(c){(!c||!c.model)&&this._setDefaultContent();b.before(this._renderUIBlock,this,"renderUI");b.after(this._bindUIBlock,this,"bindUI");b.after(this._syncUIBlock,this,"syncUI");this.publish("resized",{emitFacade:!0,defaultFn:this._updateBlockSizing});this.publish("blockModelChange",{emitFacade:!0})},_setDefaultContent:function(){var c=
this.get("defaultContentModel");b.Lang.isValue(c)&&this.get("model").setAttrs(c)},_renderUIBlock:function(){this.get("boundingBox").addClass("sqs-block "+this.get("classNames"));this.get("contentBox").addClass("sqs-block-content");this.get("boundingBox").setAttribute("id","block-"+this.get("id"));this._addSizeAndFloatClasses()},_bindUIBlock:function(){this.get("model").after("*:change",this._fireModelChange,this);this.after("editableChange",this.syncEditable,this);this.after("visibleChange",this.syncVisible,
this);this.after("focusedChange",this._syncFocused,this);this.after("selectedChange",this._syncSelected,this);this.after("dropped",this._trackEngagementDropped,this)},_syncUIBlock:function(){this.get("editable")&&this.syncEditable();this.syncVisible()},_sizeAttrChanged:b.Squarespace.Block.Utils.getWhitelistingFn(["floatDir","hSize","vSize","dimensions","aspectRatio"]),_fireModelChange:function(b){this._sizeAttrChanged(b.changed)&&this.fire("resized");this.fire("blockModelChange",{blockType:this.get("type"),
changed:b.changed})},_bindDOM:d,syncEditable:function(){var c=this.get("editable"),d;(d=this.get("editController").isMobileApp()?this.get("mobileEditor"):this.get("editMode")===b.Squarespace.Layout.EditMode.EMAIL?this.get("emailEditor"):this.get("editor"))?c?d&&!this.hasPlugin(d.NS)&&this.plug(d,this.get("editorConfig")):this.hasPlugin(d.NS)&&this.unplug(d.NS):console.warn("No Editor configured for this platform")},syncVisible:function(){this.get("boundingBox").toggleClass("sqs-block-hidden",!this.get("visible"))},
_syncFocused:function(b){this._uiSetFocused(b.newVal)},_syncSelected:function(b){this._uiSetSelected(b.newVal)},_uiSetFocused:function(b,c){this.get("boundingBox").toggleClass("sqs-block-focused",!!b)},_uiSetSelected:function(b){this.get("boundingBox").toggleClass("sqs-selected",!!b)},_updateBlockSizing:function(){var c=this.get("model");this._removeSizeAndFloatClasses();this._addSizeAndFloatClasses();!c.get("floatDir")&&b.Lang.isValue(c.get("hSize"))&&c.set("hSize",null)},_plugImageLoader:function(){this.get("contentBox").all("img").each(function(c){c.hasPlugin(b.Squarespace.Loader2.NS)||
c.plug(b.Squarespace.Loader2)})},_removeSizeAndFloatClasses:function(){var b=this.get("boundingBox");b.set("className",b.get("className").replace(/(?:\s|^)(sqs-col-\d+?|sqs-float-\w+?|vsize-\d+?)(?=\s|$)/g,""))},_addSizeAndFloatClasses:function(){var b=this.get("boundingBox"),c=this.get("model"),d=c.get("floatDir"),h=c.get("hSize"),c=c.get("vSize");d&&h&&b.addClass("sqs-float-"+d+" sqs-col-"+h);c&&b.addClass("vsize-"+c)},toJSON:function(){return{type:this.get("type"),id:this.get("id"),value:this.get("model").toJSON()}},
queueForDestruction:function(){this.hide();this.get("boundingBox").addClass("sqs-destroyme")},removeBlock:function(c){function d(){var b=this.get("boundingBox");!c&&b.ancestor(".sqs-block-remover")&&b.unwrap();this.queueForDestruction();var b=this.get("boundingBox").ancestor(".sqs-layout"),f=this.get("editController");f.cleanGrids(b);f.alignInsertPoints(b)}if(c)d.call(this);else{var g=b.Node.create('<div class="sqs-block-remover">');g.setStyle("overflow","hidden");this.get("boundingBox").wrap(g);
g=new b.Anim({node:g,to:{height:0,opacity:0},duration:0.5,easing:b.Easing.easeOutStrong});g.on("end",d,this);this._anims.add(g);g.run()}this._trackInternal("engagement_block_remove")},_trackEngagementDropped:function(){this._trackInternal("engagement_block_drop")},_trackEngagementCreate:function(){this._trackInternal("engagement_block_create")},_trackInternal:function(c){if(!this.get("editController").isMobileApp()&&b.Lang.isString(c)&&0<c.length){var d="sidebar";Static.IN_BACKEND&&(b.one("body").hasClass("collection-type-page")?
d="page":b.one("body").hasClass("dialog-open")&&(d="post"));b.Squarespace.Analytics.trackInternal(c,{type:b.Squarespace.BlockTypeByString[this.get("type")],backend:Static.IN_BACKEND,region:d})}},isEmpty:function(){return!1},destructor:function(){var c=this.get("id")+"|*";b.Global.detach(c);b.detach(c);this.unplug();this.get("boundingBox").purge(!0)}},{THROTTLE_DATACHANGE_TIME_MS:1E4,MODEL:b.Model,ATTRS:{blockTypeName:{valueFn:function(){return this.name.split("block-")[1].replace(/-/g,"_").toUpperCase()}},
type:{valueFn:function(){return b.Squarespace.BlockType[this.get("blockTypeName")]}},id:{getter:function(c){b.Lang.isValue(c)||(c=b.Squarespace.Utils.getGuid(),this.set("id",c));return c}},model:{writeOnce:!0,lazyAdd:!1,value:{},setter:function(c){return b.instanceOf(c,b.Model)?c:new (this.getProperty("MODEL"))(c||{})}},classNames:{valueFn:function(){return this.name.split("block-")[1]+"-block"}},floatDir:{},hSize:{},vSize:{},tabIndex:{value:0},focused:{setter:function(b){return this.get("editable")?
b:!1}},editable:{value:!1},editController:{writeOnce:!0,validator:function(c){return b.instanceOf(c,b.Squarespace.EditControllerBase)}},editor:{readOnly:!0,valueFn:function(){return b.Squarespace.Block.Editor.Base}},editMode:{writeOnce:!0,validator:function(c){return b.Squarespace.Layout.EditMode.isValid(c)}},mobileEditor:{readOnly:!0,value:null},editorConfig:{value:null,validator:b.Squarespace.AttrValidators.isNullOrObject},isWidgetParent:{readOnly:!0,value:!1},isNewBlock:{value:!1},defaultContentModel:{readOnly:!0},
floatable:{value:!0},focusHandler:{valueFn:function(){return b.Squarespace.Singletons.BlockFocusHandler}}}});var c=b.namespace("Squarespace.Block").ParentBase=b.Base.create("block-parent-base",b.Squarespace.Block.Base,[b.WidgetParent],{syncEditable:function(){c.superclass.syncEditable.call(this);var b=this.get("editable");this.each(function(c){c.set("editable",b)},this)},toJSON:function(){return c.superclass.toJSON.apply(this,arguments)}},{ATTRS:{editor:{readOnly:!0,value:null},isWidgetParent:{value:!0},
mobileEditor:{readOnly:!0,value:null},multiple:{value:!0}}})},"1.0",{requires:"base event model squarespace-attr-validators squarespace-block-editor-base squarespace-block-focus-handler squarespace-debounce squarespace-enum squarespace-ss-widget squarespace-util widget-parent".split(" ")});
YUI.add("squarespace-dialog-multi-frame",function(b){var d=b.namespace("Squarespace.DialogFields").MultiFrame=b.Base.create("multiFrame",b.Squarespace.DialogField2,[],{initializer:function(){this.get("data")||this.set("data",this.get("frames")[0]);this._frameEls=[];b.Array.each(this.get("frames"),function(c){var d=b.Node.create('<div class="frame" data-name="'+c.name+'"></div>');this._frameEls.push(d);b.Array.each(c.fields,function(b){var c=b.config||{};c.render=d;var h=this.get("dialog");h&&(c.dialog=
h,c.data=h.params.initialData[c.name]);b=new b.ctor(c);this.add(b)},this)},this);this._fields={}},renderUI:function(){d.superclass.renderUI.call(this);this._frameWrapper=b.Node.create('<div class="multi-frame-wrapper"></div>');this.get("contentBox").append(this._frameWrapper);b.Array.each(this._frameEls,this._frameWrapper.append,this._frameWrapper)},syncUI:function(){d.superclass.syncUI.call(this);this._setupFrameWidths()},_setupFrameWidths:function(){this._contentWidth=this.get("boundingBox").get("offsetWidth");
this._frameWrapper.setStyle("width",this._contentWidth*this.get("frames").length);b.Array.each(this._frameEls,function(b){b.setStyle("width",this._contentWidth);b.getAttribute("data-name")==this.get("data")&&(this._frameWrapper.setStyle("left",-(this._contentWidth*this._getFrameIndex(b))+"px"),this._visibleFrame=b)},this)},switchFrames:function(c){this.get("contentBox").all(".frame").each(function(d){if(d.getAttribute("data-name")==c){this._frameWrapper.activeAnim&&this._frameWrapper.activeAnim.stop();
var f=-1*this._contentWidth*this._getFrameIndex(d);this.get("animate")?this._frameWrapper.anim({left:f},{duration:0.3,easing:b.Easing.easeOutStrong,start:function(){this.fire("animating",{name:c})},end:function(){this._visibleFrame=d;this.fire("animated",{name:c});this.set("data",c)},context:this}).run():(this._frameWrapper.setStyle("left",f+"px"),this.set("data",c))}},this)},getField:function(b){var d;this.each(function(f){f.get("name")==b&&(d=f)},this);return d},_getFrameIndex:function(b){for(var d=
this.get("frames"),f=0;f<d.length;f++)if(b.getAttribute("data-name")==d[f].name)return f}},{CSS_PREFIX:"sqs-multi-frame",ATTRS:{animate:{value:!0},frames:{value:null},readOnly:{value:!0}}})},"1.0",{requires:["base","squarespace-dialog-field-2"]});
YUI.add("thirdparty-password-strength-async",function(b){(function(){var b;b=function(){var b,d;d=document.createElement("script");d.src="/universal/scripts-thirdparty/zxcvbn/zxcvbn-min.js";d.type="text/javascript";d.async=!0;b=document.getElementsByTagName("script")[0];return b.parentNode.insertBefore(d,b)};null!=window.attachEvent?window.attachEvent("onload",b):window.addEventListener("load",b,!1)}).call(this)},"1.0");
YUI.add("squarespace-mixin-save-changes",function(b){b.namespace("Squarespace.Mixins").SaveChanges=b.Base.create("saveChanges",b.Base,[],{ensureSavedChanges:function(){return!this.hasUnsavedChanges()?b.when():b.Squarespace.Promises.create(function(d,c){b.Squarespace.Fluent.Confirm({"strings.title":"Review Changes","strings.message":"You have made changes. Do you want to save or discard them?","strings.confirm":"Save","strings.reject":"Discard",style:b.Squarespace.Fluent.TYPE.CONFIRM_OR_REJECT,showOverlay:!0}).then(b.bind(function(){this._initSaveChanges().then(d,
c)},this),function(b){b.cancel?c():d()})},this)},requestDelete:function(){return b.Squarespace.Fluent.Confirm({"strings.title":"Delete Post","strings.message":"Are you sure you wish to remove this item?","strings.confirm":"Delete Post",showOverlay:!0}).then(b.bind(this._deleteItem,this))},revertChanges:function(){return b.Squarespace.Fluent.Confirm({"strings.title":"Revert Changes","strings.message":"This will revert the document back to the last saved version. Any changes will be lost. Do you want to proceed?",
"strings.confirm":"Revert Changes",showOverlay:!0}).then(b.bind(this._revertChanges,this)).then(b.bind(this.markAsClean,this))},_initSaveChanges:function(){return this._saveChanges().then(b.bind(this.markAsClean,this))},markAsClean:function(){this.set("dirty",!1)},markAsDirty:function(){this.set("dirty",!0)},hasUnsavedChanges:function(){return this.get("dirty")},_deleteItem:function(){throw'Y.Squarespace.ContentManagerWidgets.HasTray: No "_saveChanges" method implemented.';},_saveChanges:function(){this._throwClassError('No "_saveChanges" method implemented.')},
_revertChanges:function(){this._throwClassError("No _revertChanges method implemented")},_throwClassError:function(b){throw["Class",this.constructor.NAME,"-",b].join(" ");}},{ATTRS:{dirty:{value:!1,validator:b.Lang.isBoolean}}})},"1.0",{requires:["base","squarespace-promises","squarespace-fluent-confirmation"]});
YUI.add("squarespace-widgets-google-apps-base-subscription",function(b){b.namespace("Squarespace.Widgets.GoogleApps");var d=b.Squarespace.Widgets.GoogleApps.BaseSubscription=b.Base.create("GoogleAppsBaseSubscription",b.Squarespace.Widgets.Model,[b.WidgetParent],{renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("className");this.get("boundingBox").addClass(b)},bindUI:function(){d.superclass.bindUI.call(this);this.after("modelChange",this.syncUI,this)},syncUI:function(){d.superclass.syncUI.call(this);
this.get("contentBox").setContent(this.renderTemplate());b.Array.each(this.removeAll(),function(b){b.destroy()});var c=this.get("model");c&&(this._userList=new b.Squarespace.Widgets.GoogleAppsUserListManager({domain:c.get("customerId")}),this._userList.loadFirstPage(),c=this._getBanner(),b.Lang.isValue(c)&&this.add(c),this.add(this._userList))},addUser:function(){this._userList.addUser()},_getAdminLink:function(){var b=this.get("model"),d=b.get("customerId");return'<a target="_blank" href="'+b.get("adminUrl")+
'">'+d+"</a>"},unsubscribe:function(){b.Squarespace.Promises.chainFns([this._confirmSubscriptionRemoval,this._removeSubscription],this)()},_confirmSubscriptionRemoval:function(){return b.Squarespace.Fluent.Confirm({"strings.title":"Unsubscribe from Google Apps","strings.message":"Are you sure you would like to unsubscribe from Google Apps? This process is <strong>not</strong> reversible."})},_removeSubscription:function(){this.get("model").destroy({remove:!0})},_getBanner:function(){var c=this.get("stateBannerConfig");
return!c?null:new b.Squarespace.DialogFields.StateIndicatorBanner(b.merge(c,{name:"subscriptionState"}))}},{CSS_PREFIX:"sqs-google-apps-base-subscription",ATTRS:{model:{validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.GoogleAppsSubscription),value:null,writeOnce:!1},stateBannerConfig:{value:null,readOnly:!0}}})},"1.0",{requires:"base datatype-date-format squarespace-dialog-state-indicator-banner squarespace-attr-validators squarespace-widgets-model squarespace-models-google-apps-subscription squarespace-widgets-google-apps-user-list-manager".split(" ")});
YUI.add("thirdparty-codemirror",function(b){b.namespace("Squarespace.Thirdparty");"true"===b.Cookie.get("CMDebug")?b.Get.js("/universal/scripts-thirdparty/codemirror/4.1/lib/codemirror.js",function(){b.Squarespace.Thirdparty.CodeMirror=CodeMirror}):b.Squarespace.Thirdparty.CodeMirror=b.Squarespace.Thirdparty.CodeMirrorCompressed},"1.0",{requires:["thirdparty-codemirror-compressed"]});
YUI.add("squarespace-order-csv-export-dialog",function(b){var d={today:{value:"today",label:"Today"},yesterday:{value:"yesterday",label:"Yesterday"},thisWeekIn:{value:"this_week_in",label:"This week (Sun - Today)"},thisWeekEx:{value:"this_week_ex",label:"This week (Mon - Today)"},lastSeven:{value:"last_seven_days",label:"Last 7 days"},lastWeekIn:{value:"last_week_in",label:"Last week (Sun - Sat)"},lastWeekEx:{value:"last_week_ex",label:"Last week (Mon - Sun)"},lastBusWeek:{value:"last_week_bus",label:"Last business week (Mon - Fri)"},
lastFourteen:{value:"last_fourteen_days",label:"Last 14 days"},thisMonth:{value:"this_month",label:"This month"},lastThirty:{value:"last_thirty",label:"Last 30 days"},lastMonth:{value:"last_month",label:"Last month"},allTime:{value:"all_time",label:"All time"},range:{value:"range",label:"Specific date range"}},c=b.Object.values(d);b.namespace("Squarespace");b.Squarespace.OrderCSVExportDialog={create:function(){startDate=new Date(Static.SQUARESPACE_CONTEXT.website.createdOn);var e=new b.Squarespace.EditingDialog({name:"exportCSV",
overlay:0.5,title:"Select Orders to Export",style:"minimal",flyoutPointerPosition:"centered",width:660,discardChangesConfirmation:!1,closeOthers:!1,scroll:!0,initialData:{startDateInput:startDate,endDateInput:new Date,pendingCheck:!0,startDateDropdown:d.allTime.value},fields:[{type:"splitter",fields:[{type:"stack",width:0.4,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Filter by Order Status",text:"Select orders to include depending on status."}},{ctor:b.Squarespace.DialogFields.Check,
config:{name:"pendingCheck","strings.title":"Pending Orders",data:!0}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"completedCheck","strings.title":"Completed Orders",data:!0}},{ctor:b.Squarespace.DialogFields.Check,config:{name:"cancelledCheck","strings.title":"Cancelled Orders",data:!0}}]},{type:"stack",width:0.6,fields:[{ctor:b.Squarespace.DialogFields.Select,config:{name:"startDateDropdown",defaultValue:"",options:c,"strings.title":"Include Orders From","strings.description":"Filter orders by when they were created.",
className:"thin dark",required:!0}},{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.TextDateTimePicker,config:{"strings.title":"Start Date",className:"event-datetime-picker thin",name:"startDateInput",width:0.5}},{ctor:b.Squarespace.DialogFields.TextDateTimePicker,config:{"strings.title":"End Date",className:"event-datetime-picker thin",name:"endDateInput","strings.errorMessage":"End time must be later than start time.",validator:function(b){return b>this.get("dialog").getField("startDateInput").get("data")},
width:0.5}}]}]}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Export CSV"}]});this._bind(e);return e},_bind:function(c){c.on("send-requested",function(){var d=c.getData(),d=b.QueryString.stringify({pendingCheck:d.pendingCheck.toString(),completedCheck:d.completedCheck.toString(),cancelledCheck:d.cancelledCheck.toString(),startDate:d.startDateInput,endDate:d.endDateInput});window.location.href="/api/commerce/admin/ExportOrders?"+d;c.dismiss()},this);c.on("datachange",function(b){"startDateDropdown"===
b.getName()&&this._updateStartDate(b.getValue(),c)},this)},_updateStartDate:function(c,f){var g=new Date,h=new Date,k=function(c,d){return b.Date.addDays(c,-1*d)};switch(c){case d.yesterday.value:g=k(g,1);h=k(h,1);break;case d.thisWeekIn.value:g=k(g,b.Date.format(g,{format:"%w"}));break;case d.thisWeekEx.value:g=k(g,b.Date.format(g,{format:"%w"})-1);break;case d.lastSeven.value:g=k(g,7);break;case d.lastWeekIn.value:g=k(g,b.Date.format(g,{format:"%w"}));h=b.Date.addDays(g,6);break;case d.lastWeekEx.value:g=
k(g,b.Date.format(g,{format:"%w"})-1);h=b.Date.addDays(g,6);break;case d.lastBusWeek.value:g=k(g,b.Date.format(g,{format:"%w"})-1);h=b.Date.addDays(g,4);break;case d.lastFourteen.value:g=k(g,14);break;case d.thisMonth.value:g.setDate(1);break;case d.lastThirty.value:g=k(g,30);break;case d.lastMonth.value:g.setDate(1);g=b.Date.addMonths(g,-1);h.setDate(0);break;case d.allTime.value:g=new Date(Static.SQUARESPACE_CONTEXT.website.createdOn);break;case d.range.value:g=new Date(Static.SQUARESPACE_CONTEXT.website.createdOn)}g.setHours(0,
0,0);h.setHours(23,59,59,999);var k=f.getField("startDateInput"),l=f.getField("endDateInput");c===d.range.value?(k.setValue(g),l.setValue(h),k.temporaryShow(),l.temporaryShow()):(k.temporaryHide(),l.temporaryHide(),k.setValue(g),l.setValue(h))}}},"1.0",{requires:"datatype-date squarespace-dialog squarespace-dialog-check squarespace-dialog-description squarespace-dialog-fields-generators squarespace-dialog-select squarespace-dialog-text-datetime-picker".split(" ")});
YUI.add("squarespace-models-offset-paginator",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.OffsetPaginator=b.Base.create("OffsetPaginator",b.Squarespace.Models.Paginator,[],{firstPage:function(){d.superclass.firstPage.call(this);this.set("offset",0)},previousPage:function(){d.superclass.previousPage.call(this);var b=this.get("offset")-this.get("limit");0>b?this.firstPage():this.set("offset",b)},nextPage:function(){d.superclass.nextPage.call(this);this.set("offset",this.get("offset")+
this.get("limit"))},_getPaginationParams:function(){var c=d.superclass._getPaginationParams.call(this);return b.merge(c,this.getAttrs(["offset"]))}},{ATTRS:{offset:{value:0,validator:b.Squarespace.AttrValidators.isNumber}}})},"1.0",{requires:["base","squarespace-attr-validators","squarespace-models-paginator"]});
YUI.add("squarespace-data-backed-widget",function(b){function d(b){d.superclass.constructor.apply(this,arguments)}b.namespace("Squarespace");d.NAME="dataBackedWidget";d.ATTRS={data:{value:[],setter:function(c){return b.Lang.isArray(c)?c:[c]}},valueNameMap:{},key:{validator:function(c){var d=!0,f=this.get("data")[0];b.Object.hasKey(f,c)||(console.error("LineGraph: Invalid x key specified. "+f+' has no key "'+c+'"'),d=!1);return d}},values:{value:[],validator:function(c){var d=!0,f=this.get("data")[0];
b.Lang.isArray(c)||(c=[c]);c.forEach(function(c){b.Object.hasKey(f,c)||(console.error("LineGraph: Invalid y key specified. "+f+' has no key "'+c+'"'),d=!1)});return d},setter:function(c){return b.Lang.isArray(c)?c:[c]}},title:{setter:function(b){return""+b}},xScale:{},yScale:{},xAxis:{},yAxis:{}};b.extend(d,b.Widget,{buildScales:function(){this.buildXScale();this.buildYScale()},findMaximumValue:function(){var b=this.get("data"),d=[];this.get("values").forEach(function(f){d.push(b.reduce(function(b,
c){return Math.max(b,c[f])},b[0][f]))});return d3.max(d)},findMaximumValues:function(){var b={},d=this.get("data");this.get("values").forEach(function(f){b[f]=d.reduce(function(b,c){return Math.max(b,c[f])},d[0][f])});return b},buildXScale:function(){},buildYScale:function(){var b=this.get("graphHeight");this.set("yScale",d3.scale.linear().domain([0,this.findMaximumValue()]).nice().range([b,0]));this.set("yAxis",d3.svg.axis().scale(this.get("yScale")).ticks(8).tickSize(1).orient("left"))}});b.Squarespace.DataBackedWidget=
d},"1.0",{requires:["widget"]});
YUI.add("squarespace-mixins-recoverable",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.Recoverable=b.Base.create("Recoverable",b.Base,[],{initializeRecoveryBuffer:function(){var d=new b.Squarespace.Models.RecoveryBuffer({type:this.get("recoveryType"),sourceId:this.get("recoverableSourceId"),fieldName:this.get("recoverableFieldName"),editableBlock:this.get("recoverableField")});this.set("recoveryBuffer",d);var c=this.get("layoutNode");b.Cookie.get("fastAutoSave")&&this.set("saveInterval",
1E4);this._throttle=b.Squarespace.throttle(d.save,this.get("saveInterval"),{leading:!1});c.LayoutBuilder.after("*:blockModelChange",this._throttle,d);c.LayoutBuilder.after("*:blockModelChange",this._checkChangeInReferencedContent,this)},_checkChangeInReferencedContent:function(b){for(var c=["imageId","transientGalleryId","formId"],e=0;e<c.length;e++)if(b.changed[c[e]]){this.get("recoveryBuffer").save();break}},loadBuffers:function(d){this.get("recoverableSourceId")?b.Data.get({url:"/api/recovery-buffers",
secure:!0,data:{orderBy:"updatedOn",sourceId:this.get("recoverableSourceId")},success:d}):d&&d([])},destroyBuffers:function(d){b.Array.each(d,function(c){b.instanceOf(c,b.Squarespace.Models.RecoveryBuffer)||(c=new b.Squarespace.Models.RecoveryBuffer(c));c.destroy({remove:!0,headers:{"revert-changes":!0}})})},destroyBufferOnSave:function(){this._destroyBuffer(!1)},destroyBufferOnRevert:function(){this._destroyBuffer(!0)},_destroyBuffer:function(b){this._throttle&&this._throttle.cancel();var c=this.get("recoveryBuffer");
c&&c.save(function(){c.destroy({remove:!0,headers:{"revert-changes":b}});c.set("id",null)})}},{ATTRS:{recoveryType:{value:b.Squarespace.RecoveryBufferType.PAGE_COLLECTION_DATA,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.RecoveryBufferType),writeOnce:"initOnly"},recoverableField:{value:null,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.EditableContentBlock)},recoverableFieldName:{value:"",validator:b.Squarespace.AttrValidators.isString,writeOnce:"initOnly"},
saveInterval:{value:9E4,validator:b.Squarespace.AttrValidators.isNumber},recoverableSourceId:{value:null,validator:b.Squarespace.AttrValidators.isNullOrString},recoveryBuffer:{value:null,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Squarespace.Models.RecoveryBuffer)},layoutNode:{value:null,validator:b.Squarespace.AttrValidators.isNullOrInstanceOf(b.Node)}}})},"1.0",{requires:["base","squarespace-models-layout","squarespace-models-recovery-buffer","squarespace-throttle"]});
YUI.add("squarespace-content-item-types-image",function(b){var d=b.namespace("Squarespace.ContentItemEditor").Image=b.Base.create("ImageContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{},{ATTRS:{editorConfiguration:{value:{title:"Edit {presentationName}",width:800,height:400,overlay:0.5,initialDataByReference:!0,tabs:[{$include:["tabs.primary.base","tabs.primary.image"]},{$include:"tabs.options.image"},{$include:"tabs.location"},{$include:"tabs.social"}],buttons:{$include:"buttons"}}}}}),
c={name:"imageeditminimal",title:"Edit {presentationName}",width:340,height:400,closeOthers:!1,draggable:!0,style:"flyout",flyoutPointerDirection:"hidden",tabs:[{icon:b.Squarespace.Rendering.getIconUrl("image",16,"light"),fields:[{$include:["fields.title",{countHeight:!0,className:"thin"}]},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"body",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:157,classNames:"major",title:"Enter an image body..."}},{$include:["fields.clickthroughUrl",
{countHeight:!0,condensed:!0,disableNewWindow:!0}]}]}],buttons:{$include:"buttons"}};b.namespace("Squarespace.ContentItemEditor").ImageMinimal=b.Base.create("ImageContentItemEditor",d,[],{},{ATTRS:{editorConfiguration:{value:c}}})},"1.0",{requires:["squarespace-content-item-types-base"]});
YUI.add("squarespace-settings-panel-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["settings-panel.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n  <div class="panel-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var p="function",q=this;if((c=d["with"].call(c,c.strings,
{hash:{},inverse:q.noop,fn:q.program(1,function(b,c){var e,f;e="\n  ";if((f=d["if"].call(b,b.description,{hash:{},inverse:q.noop,fn:q.program(2,l,c),data:c}))||0===f)e+=f;e+='\n  <div class="loading-message">';(f=d.loadingMessage)?f=f.call(b,{hash:{},data:c}):(f=b.loadingMessage,f=typeof f===p?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n"},k),data:k}))||0===c)b+=c;return b+'\n\n<div class="settings-panel-fields"></div>'})})();b.Handlebars.registerPartial("settings-panel.html".replace("/","."),
d.templates["settings-panel.html"])},"1.0",{requires:["handlebars-base"]});YUI.add("squarespace-census-datametrics",function(b){b.namespace("Squarespace");b.Squarespace.CensusDataMetricLabels={VIEWS:"Page Views",VISITS:"Visits",VISITORS:"Visitors"};b.Squarespace.CensusDataMetricUtils={getLabel:function(d){var c=b.Squarespace.Utils.reverseMap(b.Squarespace.CensusDataMetric);return b.Squarespace.CensusDataMetricLabels[c[d]]}}},"1.0",{requires:["squarespace-enum"]});
YUI.add("squarespace-album-player",function(b){function d(){b.Array.each(f,function(c){b.Lang.isFunction(c.adjustAlbumImage)&&c.adjustAlbumImage()})}function c(c){g=c;b.Array.each(f,function(d){b.Lang.isFunction(d.setVolume)&&d.setVolume(c)})}function e(){b.Array.each(f,function(c){b.Lang.isFunction(c.pausePlayer)&&c.pausePlayer()})}var f=[],g=100,h=!1,k=b.namespace("Squarespace.Widgets").AlbumPlayer=b.Base.create("albumPlayer",b.Squarespace.Widgets.SSWidget,[],{render:function(){f.push(this);k.superclass.render.apply(this,
arguments);b.use("thirdparty-soundmanager2",b.bind(function(b){this._soundManager=soundManager;this._soundManager.setup({url:soundManager.url,flashVersion:8,debugMode:!1,preferFlash:!1,onready:b.bind(this.soundManagerReady,this)});this._soundManager.beginDelayedInit()},this))},renderUI:function(){this.playerNode=this.get("contentBox");this.albumImage=this.playerNode.one(".album-cover img");this.adjustAlbumImage();h?d():(h=!0,b.one("window").on("resize",d));this.trackListNode=this.playerNode.one(".tracks");
this.tracksNode=this.trackListNode.all(".track");this.numberOfTracks=this.tracksNode.size();this.controlsNode=this.playerNode.one(".album-controls");this.timerNode=this.playerNode.one(".timer");this.volumeBarNode=this.playerNode.one(".volume-bar");this.artistNameNode=this.playerNode.one(".now-playing .track-info .artist");this.trackTitleNode=this.playerNode.one(".now-playing .track-info .title");this.setupUniversalPlaybarIfExists()},soundManagerReady:function(){this.setupAudioFiles()},adjustAlbumImage:function(){var b=
this.get("contentBox"),c=b.getComputedStyle("width"),c=parseInt(c,10);800>c?b.addClass("tablet"):b.removeClass("tablet");480>c?b.addClass("phone"):b.removeClass("phone");this.albumImage&&ImageLoader.load(this.albumImage,{load:!0});b.hasClass("loading")&&b.removeClass("loading")},setupUniversalPlaybarIfExists:function(){this.playerNode.one(".now-playing")&&(this.set("hasUniversalPlaybar",!0),this.timeBarNode=this.playerNode.one(".track-progress-bar"),this.loadingBarNode=this.timeBarNode.one(".load-bar"),
this.playingBarNode=this.timeBarNode.one(".play-bar"),this.minutesNode=this.timerNode.one(".minutes"),this.secondsNode=this.timerNode.one(".seconds"),this.durationNode=this.playerNode.one(".duration"),this.durMinutesNode=this.durationNode.one(".minutes"),this.durSecondsNode=this.durationNode.one(".seconds"))},bindUI:function(){var b=this.playerNode.one(this.get("playButton"));b&&this._registerEvent(b.on("click",this.onPlayButtonClick,this));(b=this.playerNode.one(this.get("pauseButton")))&&this._registerEvent(b.on("click",
this.onPauseButtonClick,this));(b=this.playerNode.one(this.get("stopButton")))&&this._registerEvent(b.on("click",this.onStopButtonClick,this));(b=this.playerNode.one(this.get("prevButton")))&&this._registerEvent(b.on("click",this.onPrevButtonClick,this));(b=this.playerNode.one(this.get("nextButton")))&&this._registerEvent(b.on("click",this.onNextButtonClick,this));if(this.volumeBarNode=this.playerNode.one(this.get("volumeBar")))this.volumeScrubNode=this.volumeBarNode.one(".scrubber"),this._registerEvent(this.volumeBarNode.on("click",
this.onVolumeBarClick,this))},onPlayButtonClick:function(b){b.halt();this.get("currentTrack")||this.setCurrentTrackByKey(0,!0);this.isTrackPlaying()?this.pausePlayer():this.playCurrentTrack()},onPauseButtonClick:function(b){b.halt();this.pausePlayer()},onStopButtonClick:function(b){b.halt();this.stopPlayBarAndTimer();this.get("currentTrack").audioObject.stop();this.playerNode.addClass("paused").removeClass("playing")},onPrevButtonClick:function(b){b.halt();b=this.get("currentTrack").index;0<b&&b--;
this.setCurrentTrackByKey(b)},onNextButtonClick:function(b){b.halt();b=this.get("currentTrack").index;b!==this.numberOfTracks-1&&b++;this.setCurrentTrackByKey(b)},onVolumeBarClick:function(b){b.halt();var d=this.volumeBarNode.getX(),e=parseInt(this.volumeBarNode.getComputedStyle("width"),10);c(100*((b.clientX-d)/e))},setCurrentTrackByKey:function(b,c){"undefined"===typeof c&&(c=this.get("currentTrack")&&(0===this.get("currentTrack").audioObject.playState||this.get("currentTrack").audioObject.paused));
this.setCurrentTrack(this.get("trackArray")[b],c)},toggleTimerFunction:function(b){b.halt();this.countingDown.set(!this.countingDown)},setupAudioFiles:function(){var b=this.tracksNode.size();this.tracksNode.each(function(c,d){this.setupAudioTrack(c,d);d+1===b&&this.setCurrentTrackByKey(0,!0)},this)},setupAudioTrack:function(b,c){var d=b.getAttribute("id"),e=b.one(".link").getAttribute("href"),e=-1!==e.indexOf("?")?e+("&"+d):e+("?"+d),e={artist:b.getData("artist"),title:b.getData("title"),src:e,index:c,
domNode:b,duration:b.one(".track-time").get("innerHTML"),hasTimebar:!1};e.soundManagerID=(e.artist+"-"+e.title+"-"+d).replace(/\s+/g,"_");e.audioObject=this.createSoundObject(e,c===this.get("currentTrack").index);this.setupTrackTimeCnnr(e);this.get("trackArray").push(e);this.bindTrackLink(e);return e},parseTrackFromHash:function(){var c=b.QueryString.parse(window.location.hash.replace("#","")).track,c=parseInt(c,10);return b.Lang.isNumber(c)?c:0},setupTrackTimeCnnr:function(b){b.domNode.one(".track-progress-bar")&&
(b.hasTimebar=!0,b.timeBarNode=b.domNode.one(".track-progress-bar"),b.loadingBarNode=b.domNode.one(".load-bar"),b.playingBarNode=b.domNode.one(".play-bar"),b.timerNode=b.domNode.one(".track-time"),b.durationNode=b.domNode.one(".duration"),this._registerEvent(b.timeBarNode.on("click",this.onTimebarClick,this,b)))},onTimebarClick:function(b,c){b.halt();var d=c.timeBarNode.getX(),e=parseInt(c.timeBarNode.getComputedStyle("width"),10),d=(b.clientX-d)/e,e=c.audioObject.duration;this.get("currentTrack")!==
c?this.setCurrentTrack(c):this.isTrackPlaying()?c.audioObject.setPosition(e*d):this.playCurrentTrack()},createSoundObject:function(c,d){var e=c.src;8<e.split("/").length&&(e=e.split("/").slice(0,8).join("/"));var f=this._soundManager.createSound({url:e,id:c.soundManagerID,autoLoad:d,autoPlay:!1,whileplaying:b.bind(function(){this.whilePlayingDOMUpdates(f,c)},this),whileloading:b.bind(function(){this.setLoadingBar(f,c)},this),onload:b.bind(function(b){b?b&&this.finishLoading(f,c):(f.setPosition(this.playingTrackPosition),
this.playCurrentTrack())},this),onfinish:b.bind(function(){0===f.playState&&this.get("currentTrack").index===c.index&&this.playNextTrackOnList()},this)});return f},playNextTrackOnList:function(){this.get("currentTrack").index!==this.numberOfTracks-1?this.setCurrentTrack(this.get("trackArray")[this.get("currentTrack").index+1],!1):this.pausePlayer()},whilePlayingDOMUpdates:function(b,c){var d=b.position,e=b.duration,f=100*(d/e)+"%";this.playingTrackPosition=d;this.get("hasUniversalPlaybar")&&this.playingBarNode.setStyle("width",
f);this.get("currentTrack.hasTimebar")&&this.get("currentTrack").playingBarNode.setStyle("width",f);this.updateTimer(d,e,c)},updateTimer:function(b,c,d){this.countingDown&&(b=c-b);c=Math.floor(b/1E3%60);b=Math.floor(b/6E4);10>c&&(c="0"+c);d=b+":"+c;this.get("hasUniversalPlaybar")&&(this.minutesNode.set("text",b),this.secondsNode.set("text",c));this.get("currentTrack.hasTimebar")&&this.get("currentTrack.timerNode").set("text",d)},stopPlayBarAndTimer:function(){this.get("hasUniversalPlaybar")&&this.playingBarNode.setStyle("width",
"0%");this.get("currentTrack.timeCnnrNode")&&this.get("currentTrack.timeCnnrNode.playingBarNode").setStyle("width","0%");this.updateTimer(0,this.get("currentTrack").audioObject.duration)},finishLoading:function(b,c){var d=b.position,e=Math.floor(d/1E3%60),d=Math.floor(d/6E4);10>e&&(e="0"+e);this.get("hasUniversalPlaybar")&&(this.durMinutesNode.set("text",d),this.durSecondsNode.set("text",e),this.loadingBarNode.setStyle("width","100%"));this.get("currentTrack").hasTimebar&&this.get("currentTrack").loadingBarNode.setStyle("width",
"100%")},setLoadingBar:function(b,c){if(b.loaded&&b.bytesLoaded===b.bytesTotal)return this.finishLoading(b);var d=100*(b.bytesLoaded/b.bytesTotal);isNaN(d)||(d=d.toString()+"%",this.get("hasUniversalPlaybar")&&this.loadingBarNode.setStyle("width",d),this.get("currentTrack").timeCnnrNode&&this.get("currentTrack").timeCnnrNode.loadingBarNode.setStyle("width",d))},resetTimebars:function(){b.Array.each(this.get("trackArray"),function(b,c){b.hasTimebar&&b.audioObject&&(b.playingBarNode.setStyle("width",
0),b.domNode.one(".track-time").set("innerHTML",b.duration))},this)},setCurrentTrack:function(b,c){b&&(this.get("currentTrack")&&this.get("currentTrack").audioObject&&e(),this.set("currentTrack",b),this.get("hasUniversalPlaybar")&&(this.artistNameNode.set("text",b.domNode.getData("artist")),this.trackTitleNode.set("text",b.domNode.getData("title"))),this.trackListNode.all(".track").removeClass("selected"),b.domNode.addClass("selected"),c||this.playCurrentTrack())},isTrackPlaying:function(b){b=b||
this.get("currentTrack");return 0!==b.audioObject.playState&&!b.audioObject.paused},bindTrackLink:function(b){this._registerEvent(b.domNode.one(".track-info").on("click",function(c){c.halt();this.get("currentTrack")===b?(b.audioObject.setPosition(0),1!==b.audioObject.playState&&this.setCurrentTrack(b,!1)):(this.resetTimebars(),this.setCurrentTrack(b,!1))},this));this._registerEvent(b.domNode.on("dblclick",function(b){b.halt();this.isTrackPlaying()&&this.get("currentTrack").audioObject.setPosition(0)},
this))},playCurrentTrack:function(){this.pausePlayer();c(g);this.playerNode.addClass("playing").removeClass("paused");var d=this.get("currentTrack").audioObject;d.isHTML5?d.play():setTimeout(b.bind(function(){d.play()},this),150)},stopPlayer:function(){this.playerNode.removeClass("playing").removeClass("paused");this.get("currentTrack").audioObject.stop();this.stopPlayBarAndTimer()},pausePlayer:function(){var b=this.get("currentTrack");this.playerNode&&(b&&b.audioObject)&&(this.playerNode.addClass("paused").removeClass("playing"),
b.audioObject.pause())},setVolume:function(b){this.volumeBarNode&&this.volumeScrubNode.setStyle("left",b+"%");this._soundManager.setVolume(this.get("currentTrack").audioObject.id,b)}},{ATTRS:{playButton:{value:"a.button"},pauseButton:{},stopButton:{},volumeBar:{},nowPlaying:{},prevButton:{},nextButton:{},hasUniversalPlaybar:{value:!1},playingTrackPosition:{value:0},currentTrack:{value:{}},trackArray:{value:[]},countingDown:{value:!1}}});b.config.win.Squarespace.onInitialize(b,function(){b.all(".sqs-audio-playlist").each(function(c,
d){new b.Squarespace.Widgets.AlbumPlayer({contentBox:c,render:!0})})})},"1.0",{requires:["widget","querystring"]});
(function(){var b;b=function(){var b,c,e,f=0;this.makeHtml=function(f){b=[];c=[];e=[];f=f.replace(/~/g,"~T");f=f.replace(/\$/g,"~D");f=f.replace(/\r\n/g,"\n");f=f.replace(/\r/g,"\n");f=H("\n\n"+f+"\n\n");f=f.replace(/^[ \t]+$/mg,"");f=h(f);f=g(f);f=l(f);f=F(f);f=f.replace(/~D/g,"$$");return f=f.replace(/~T/g,"~")};var g=function(e){return e=e.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)[ \t]+["'(](.+?)["')][ \t]*)?(?:\n+|$)/gm,function(e,f,g,h,k){f=f.toLowerCase();b[f]=
K(g);if(h)return h+k;k&&(c[f]=k.replace(/"/g,"&quot;"));return""})},h=function(b){b=b.replace(/\n/g,"\n\n");b=b.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,k);b=b.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,k);b=b.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,k);b=b.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,
k);b=b.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,k);return b=b.replace(/\n\n/g,"\n")},k=function(b,c){var d;d=c.replace(/\n\n/g,"\n");d=d.replace(/^\n/,"");d=d.replace(/\n+$/g,"");return d="\n\n~K"+(e.push(d)-1)+"K\n\n"},l=function(b){b=t(b);var c=y("<hr />");b=b.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,c);b=b.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,c);b=b.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,c);b=v(b);b=w(b);b=A(b);b=h(b);b=b.replace(/^\n+/g,"");b=b.replace(/\n+$/g,
"");var d=b.split(/\n{2,}/g);b=[];for(var c=d.length,f=0;f<c;f++){var g=d[f];0<=g.search(/~K(\d+)K/g)?b.push(g):0<=g.search(/\S/)&&(g=p(g),g=g.replace(/^([ \t]*)/g,"<p>"),g+="</p>",b.push(g))}c=b.length;for(f=0;f<c;f++)for(;0<=b[f].search(/~K(\d+)K/);)d=e[RegExp.$1],d=d.replace(/\$/g,"$$$$"),b[f]=b[f].replace(/~K\d+K/,d);return b=b.join("\n\n")},p=function(b){b=z(b);b=q(b);b=b.replace(/\\(\\)/g,aa);b=b.replace(/\\([`*_{}\[\]()>#+-.!])/g,aa);b=b.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,
s);b=b.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,s);b=b.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,r);b=b.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,r);b=b.replace(/(\[([^\[\]]+)\])()()()()()/g,r);b=O(b);b=K(b);b=b.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");b=b.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return b=b.replace(/  +\n/g," <br />\n")},q=function(b){return b=
b.replace(/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi,function(b){b=b.replace(/(.)<\/?code>(?=.)/g,"$1`");return b=G(b,"\\`*_")})},r=function(e,f,g,h,k,l,p,q){void 0==q&&(q="");e=h.toLowerCase();if(""==k)if(""==e&&(e=g.toLowerCase().replace(/ ?\n/g," ")),void 0!=b[e])k=b[e],void 0!=c[e]&&(q=c[e]);else if(-1<f.search(/\(\s*\)$/m))k="";else return f;k=G(k,"*_");f='<a href="'+k+'"';""!=q&&(q=q.replace(/"/g,"&quot;"),q=G(q,"*_"),f+=' title="'+q+'"');return f+(">"+g+"</a>")},s=function(e,
f,g,h,k,l,p,q){e=g;h=h.toLowerCase();q||(q="");if(""==k)if(""==h&&(h=e.toLowerCase().replace(/ ?\n/g," ")),void 0!=b[h])k=b[h],void 0!=c[h]&&(q=c[h]);else return f;e=e.replace(/"/g,"&quot;");k=G(k,"*_");f='<img src="'+k+'" alt="'+e+'"';q=q.replace(/"/g,"&quot;");q=G(q,"*_");return f=f+(' title="'+q+'"')+" />"},t=function(b){function c(b){return b.replace(/[^\w]/g,"").toLowerCase()}b=b.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(b,d){return y('<h1 id="'+c(d)+'">'+p(d)+"</h1>")});b=b.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,
function(b,d){return y('<h2 id="'+c(d)+'">'+p(d)+"</h2>")});return b=b.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(b,d,e){b=d.length;return y("<h"+b+' id="'+c(e)+'">'+p(e)+"</h"+b+">")})},u,v=function(b){b+="~0";var c=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;f?b=b.replace(c,function(b,c,d){b=c;d=-1<d.search(/[*+-]/g)?"ul":"ol";b=b.replace(/\n{2,}/g,"\n\n\n");b=u(b);b=b.replace(/\s+$/,"");return"<"+d+">"+b+"</"+d+">\n"}):(c=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g,
b=b.replace(c,function(b,c,d,e){b=d;e=-1<e.search(/[*+-]/g)?"ul":"ol";b=b.replace(/\n{2,}/g,"\n\n\n");b=u(b);return c+"<"+e+">\n"+b+"</"+e+">\n"}));return b=b.replace(/~0/,"")};u=function(b){f++;b=b.replace(/\n{2,}$/,"\n");b=(b+"~0").replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(b,c,d,e,f){b=f;c||-1<b.search(/\n{2,}/)?b=l(U(b)):(b=v(U(b)),b=b.replace(/\n$/,""),b=p(b));return"<li>"+b+"</li>\n"});b=b.replace(/~0/g,"");f--;return b};var w=
function(b){b=(b+"~0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(b,c,d){b=B(U(c));b=H(b);b=b.replace(/^\n+/g,"");b=b.replace(/\n+$/g,"");b="<pre><code>"+b+"\n</code></pre>";return y(b)+d});return b=b.replace(/~0/,"")},y=function(b){b=b.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(e.push(b)-1)+"K\n\n"},z=function(b){return b=b.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(b,c,d,e,f){b=e.replace(/^([ \t]*)/g,"");b=b.replace(/[ \t]*$/g,"");b=B(b);return c+
"<code>"+b+"</code>"})},B=function(b){b=b.replace(/&/g,"&amp;");b=b.replace(/</g,"&lt;");b=b.replace(/>/g,"&gt;");return b=G(b,"*_{}[]\\",!1)},A=function(b){return b=b.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(b,c){var d;d=c.replace(/^[ \t]*>[ \t]?/gm,"~0");d=d.replace(/~0/g,"");d=d.replace(/^[ \t]+$/gm,"");d=l(d);d=d.replace(/(^|\n)/g,"$1  ");d=d.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(b,c){var d;d=c.replace(/^  /mg,"~0");return d=d.replace(/~0/g,"")});return y("<blockquote>\n"+
d+"\n</blockquote>")})},K=function(b){b=b.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");return b=b.replace(/<(?![a-z\/?\$!])/gi,"&lt;")},O=function(b){b=b.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');return b=b.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(b,c){return E(F(c))})},E=function(b){var c=[function(b){return"&#"+b.charCodeAt(0)+";"},function(b){b=b.charCodeAt(0);return"&#x"+("0123456789ABCDEF".charAt(b>>4)+"0123456789ABCDEF".charAt(b&
15))+";"},function(b){return b}];b=("mailto:"+b).replace(/./g,function(b){if("@"==b)b=c[Math.floor(2*Math.random())](b);else if(":"!=b){var d=Math.random();b=0.9<d?c[2](b):0.45<d?c[1](b):c[0](b)}return b});b='<a href="'+b+'">'+b+"</a>";return b=b.replace(/">.+:/g,'">')},F=function(b){return b=b.replace(/~E(\d+)E/g,function(b,c){var d=parseInt(c);return String.fromCharCode(d)})},U=function(b){b=b.replace(/^(\t|[ ]{1,4})/gm,"~0");return b=b.replace(/~0/g,"")},H=function(b){b=b.replace(/\t(?=\t)/g,"    ");
b=b.replace(/\t/g,"~A~B");b=b.replace(/~B(.+?)~A/g,function(b,c,d){b=c;c=4-b.length%4;for(d=0;d<c;d++)b+=" ";return b});b=b.replace(/~A/g,"    ");return b=b.replace(/~B/g,"")},G=function(b,c,d){c="(["+c.replace(/([\[\]\\])/g,"\\$1")+"])";d&&(c="\\\\"+c);return b=b.replace(RegExp(c,"g"),aa)},aa=function(b,c){return"~E"+c.charCodeAt(0)+"E"}};YUI.add("squarespace-markdown",function(d){d.namespace("Squarespace.Lang");d.Squarespace.Lang.markdownToHTML=function(c){return!c?"":(new b).makeHtml(c)}},"1.0",
{requires:[]})})();
YUI.add("squarespace-layout-insert-block-menu-web-base",function(b){var d=b.namespace("Squarespace.Layout").InsertBlockMenuWebBase=b.Base.create("layoutInsertBlockMenuBase",b.Overlay,[b.WidgetParent,b.Squarespace.Layout.InsertBlockMenuMixin],{initializer:function(){b.Event.defineOutside("mousedown");this._bb=this.get("boundingBox");this._cb=this.get("contentBox");this._cb.plug(b.Squarespace.ScrollLock)},bindUI:function(){this._bb.on("mousedownoutside",this.hide,this);if(!this._bb.getComputedStyle("position").match("sticky"))this._cb.on("scroll",this._onScroll,
this)},renderUI:function(){this._renderMenuIcons(this._getInsertableBlockItems());this.get("visible")||this._cb.hide()},destructor:function(){this._cb.unplug(b.Squarespace.ScrollLock);this._hideOnScroll&&this._hideOnScroll.detach()},_getInsertableBlockItems:function(){throw Error("_getInsertableBlockItems not implemented");},_renderMenuIcons:function(c){var d=this.get("editController").getRenderableBlocks(this.get("editMode")),f=b.Squarespace.Block.Label,g=b.Squarespace.Block.Icon,h=b.Squarespace.BlockTypeByString;
this.labels=[];b.Array.each(c,function(c){var l=this.add({type:f,label:c.label,render:this._cb}).item(0),p=b.Node.create('<div class="sqs-block-icon-container"></div>');this.labels.push(l);this._cb.append(p);b.Array.each(c.items,function(b){b=d.get(h[b]);b=new g(b);b.render(p);this._icons.push(b)},this)},this)},_getDefaultDropInfo:function(){var b=this.get("targetNode");return{node:b,region:b.get("region"),direction:this.get("direction"),layout:b.ancestor(".sqs-layout").LayoutEditor}},_onScroll:function(){for(var c=
this._cb.get("region").top,d=b.Array.map(this.labels,function(b,d){var e=b.get("boundingBox").get("region"),e=c-e.top;return 0<e?e:null},this),f=this.labels.length-1;0<=f;f--)this.labels[f].get("contentBox").setStyle("top",d[f])},_onFocusedChange:function(b){b.newVal?this.show():b.newVal!==b.prevVal&&!b.newVal&&this.hideMenu()},show:function(){b.Lang.isValue(b.Squarespace.DIALOG_ZINDEX_BASE)&&this.set("zIndex",b.Squarespace.DIALOG_ZINDEX_BASE+1);this._cb.show();d.superclass.show.call(this);this._bindBlurOnScroll()},
hide:function(){d.superclass.hide.call(this);this._cb.show()},hideMenu:function(){this._cb.hide();this._cb.set("scrollTop",0);b.DD.DDM.activeDrag||this.hide()},_bindBlurOnScroll:function(){var b=this.get("layoutScrollNode"),d=b.get("scrollTop");this._hideOnScroll=b.on("scroll",function(){10<Math.abs(b.get("scrollTop")-d)&&(this._hideOnScroll.detach(),this.blur())},this)}},{CSS_PREFIX:"sqs-layout-insert-block-menu",ATTRS:{render:{value:!0},constrain:{value:!0},tabIndex:{value:0},visible:{value:!1},
width:{value:315},height:{value:420},zIndex:{value:30011},direction:{value:"top"},targetNode:{},scrollNode:{},layoutScrollNode:{getter:function(){var c=this.get("targetNode").ancestor(".sqs-layout-scroll");return c?c:b.one(b.config.doc)}},layoutNode:{getter:function(){return this.get("targetNode").ancestor(".sqs-layout")}},editController:{readOnly:!0,valueFn:function(){return b.Squarespace.EditControllerWebApp.getInstance()}}}})},"1.0",{requires:"overlay widget-parent event-outside squarespace-util squarespace-block-label squarespace-layout-insert-block-menu-mixin squarespace-layout-renderable-blocks-web-app".split(" ")});
YUI.add("squarespace-stats-block",function(b){var d=b.namespace("Squarespace.Widgets").StatsBlock=b.Base.create("statsBlock",b.Squarespace.Widgets.SSWidget,[],{initializer:function(c){if(!c.dataView||!(new c.dataView instanceof b.Squarespace.Views.Stats.Block))throw this.name+": A stats data view is required as the dataView attr.";},destructor:function(){this._dataView&&(this._dataView.destroy({remove:!0}),this._dataView=null);this._destroyConfigFields();this._dataViewContainer=null},renderUI:function(){d.superclass.renderUI.apply(this,
arguments);this._updateColSpanClass();this._updateCfgClass();this.get("data");var b=this.get("contentBox");this._renderConfig();this._dataView=new (this.get("dataView"))(this.getAttrs(["dataMetric","granularity","timeFrame"]));this._dataView.render(b.one(".front-content"))},bindUI:function(){d.superclass.bindUI.apply(this,arguments);var b=this.get("id"),e=this.get("boundingBox");this.after(b+"|colSpanChange",this._updateColSpanClass,this);this.after(b+"|configuringChange",this._updateCfgClass,this);
e.delegate(b+"|click",function(){this.set("configuring",!0)},".edit-button",this);e.delegate(b+"|click",function(){this._commitSettingsChanges();this.set("configuring",!1)},".commit-button",this);this.after([b+"|granularityChange",b+"|timeFrameChange",b+"|dataMetricChange"],function(b){this._dataView.set(b.attrName,b.newVal)},this)},_renderConfig:function(){var c=[],d=[],f=this.get("contentBox").one(".block-config-wrapper");b.Object.each(b.Squarespace.CensusDataMetric,function(d,e){var f=b.Squarespace.CensusDataMetricUtils.getLabel(d);
f&&c.push({label:f,value:b.Squarespace.CensusDataMetric[e]})},this);b.Object.each(b.Squarespace.StatsTimeFrames,function(c,f){var k=b.Squarespace.StatsTimeFrameUtils.getLabel(c);k&&d.push({label:k,value:b.Squarespace.StatsTimeFrames[f]})},this);this._destroyConfigFields();this._configFields={};this._configFields.dataMetric=new b.Squarespace.DialogFields.LabeledSelect({render:f,name:"dataMetric",options:c,data:this.get("dataMetric"),"strings.placeholder":"Select a Data Metric","strings.label":"Data Metric"});
this._configFields.timeFrame=new b.Squarespace.DialogFields.LabeledSelect({render:f,name:"timeFrame",options:d,data:this.get("timeFrame"),"strings.placeholder":"Select a Time Frame","strings.label":"Time Frame"})},_destroyConfigFields:function(){b.Object.each(this._configFields,function(b,d){b.destroy()},this);this._configFields=null},_commitSettingsChanges:function(){b.Object.each(this._configFields,function(b){this.set(b.get("name"),parseInt(b.get("data"),10))},this)},_updateColSpanClass:function(b){var d=
this.get("boundingBox");b?(d.removeClass("colspan-"+b.prevVal),d.addClass("colspan-"+b.newVal)):d.addClass("colspan-"+this.get("colSpan"))},_updateCfgClass:function(){this.get("boundingBox")[this.get("configuring")?"addClass":"removeClass"]("configuring")}},{CSS_PREFIX:"sqs-stats-block",HANDLEBARS_TEMPLATE:"stats-block.html",ATTRS:{colSpan:{value:3,validator:function(c){if(!b.Lang.isNumber(c)||3!==c&&6!==c)throw this.name+": These blocks can only span 3 or 6 columns.";return!0}},configuring:{value:!1,
validator:b.Squarespace.AttrValidators.isBoolean},dataView:{value:null,writeOnce:"initOnly"},dataMetric:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.CensusDataMetric)},timeFrame:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.StatsTimeFrames)},granularity:{value:1,validator:b.Squarespace.AttrValidators.isValueIn(b.Squarespace.CensusGranularity)}}})},"1.0",{requires:"base-base squarespace-ss-widget squarespace-stats-block-template squarespace-attr-validators squarespace-census-datametrics squarespace-stats-timeframes squarespace-dialog-select".split(" ")});
YUI.add("squarespace-variant-row-inputs",function(b){b.namespace("Squarespace.Widgets.Variants");var d=b.Squarespace.Widgets.Variants.VariantCellInput=b.Base.create("variantCellInput",b.Squarespace.Widgets.DataWidget,[],{renderUI:function(){d.superclass.renderUI.call(this);var c=this.get("contentBox"),e=this.get("title");b.Lang.isValue(e)&&c.append(b.Node.create('<div class="title">'+e+"</div>"));e=b.Node.create('<input type="text"></input>');c.append(e);e.setAttribute("name",this.get("name"));e.set("value",
this.get("data"))},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("contentBox").one("input");c.after(["change","valuechange"],function(b){this.set("data",this._getInputValue())},this);c.on("click",c.select);c.on("key",function(){this.fire("edit-next-row-requested")},"press:13",this);var e=this.get("userOption");b.Lang.isValue(e)&&e.after("optionNameChange",function(b){this.set("name",e.get("optionName"))},this)},_getInputValue:function(){return this.get("contentBox").one("input").get("value").trim()},
disable:function(c){this.set("disabled",!0);this.get("contentBox").one("input").set("disabled",!0);b.Lang.isValue(c)&&this.get("contentBox").one("input").set("value",c)},enable:function(c){this.set("disabled",!1);this.get("contentBox").one("input").set("disabled",!1);b.Lang.isValue(c)&&this.get("contentBox").one("input").set("value",c)}},{CSS_PREFIX:"sqs-variant-cell-input",ATTRS:{title:{value:null},userOption:{value:null},name:{value:null}}}),c=b.Squarespace.Widgets.Variants.VariantCellNumericInput=
b.Base.create("variantCellNumericInput",d,[],{renderUI:function(){c.superclass.renderUI.call(this);this.get("contentBox").one("input").plug(b.Squarespace.Plugin.NumericFormatter,this.get("numericFormatterConfig"))},_getInputValue:function(){return this.get("contentBox").one("input").numericFormatterPlugin.get("data")}},{CSS_PREFIX:"sqs-variant-cell-numeric-input",ATTRS:{numericFormatterConfig:{value:null}}}),e=b.Squarespace.Widgets.Variants.VariantCellMoneyInput=b.Base.create("variantCellMoneyInput",
d,[],{renderUI:function(){e.superclass.renderUI.call(this);this.get("contentBox").one("input").plug(b.Squarespace.Plugin.MoneyFormatter)},_getInputValue:function(){return this.get("contentBox").one("input").moneyFormatterPlugin.get("data")}},{CSS_PREFIX:"sqs-variant-cell-money-input"}),f=b.Base.create("pricingInput",b.Base,[],{initializer:function(){var c=this.get("hostNode");c.plug(b.Squarespace.Animations.Flyout,{duration:0.1});var d=c.flyoutPlugin;this._flyout=d;var e=b.Node.create('<div class="flyout-variant-edit"><div class="fields"></div><div class="notch"></div></div>');
e.addClass(this.get("name"));d.setAttrs({node:e,alignment:"tc"});c.on("click",this.showFlyout,this);d.on("shown",function(){b.Lang.isValue(e.one("input:enabled"))&&e.one("input:enabled").focus()},this);e.delegate("key",function(){this.fire("edit-next-row-requested")},"press:13","input",this);b.Array.each(this.get("fields"),function(b){b.render(e.one(".fields"));b.after("dataChange",function(){this.set("data",this._getFieldData())},this)},this)},showFlyout:function(){this._flyout.show();this._syncFieldsFromData();
this.fire("open")},closeFlyout:function(){this.set("data",this._getFieldData());this._flyout.hide();this.fire("close")},_syncFieldsFromData:function(){b.Squarespace.FormUtils.setData(this.get("fields"),this.get("data"))},_getFieldData:function(){return b.Squarespace.FormUtils.getData(this.get("fields"))}},{CSS_PREFIX:"sqs-field-flyout",ATTRS:{hostNode:{value:null},fields:{value:[]},content:{value:null},name:{value:null}}}),g=b.Squarespace.Widgets.Variants.FlyoutDrivenDataWidget=b.Base.create("flyoutDrivenDataWidget",
b.Squarespace.Widgets.DataWidget,[],{renderUI:function(){g.superclass.renderUI.call(this);this.get("contentBox").setHTML('<span class="placeholder"></span>');this._flyout=new f(this._getFlyoutConfig());this._flyout.set("data",this.get("data"))},bindUI:function(){g.superclass.bindUI.call(this);this.get("boundingBox");this.get("data");this._flyout.after("close",function(){this.set("data",this._flyout.get("data"))},this);this._flyout.after("dataChange",function(){this.set("data",this._flyout.get("data"))},
this);this._flyout.after("edit-next-row-requested",function(){this.fire("edit-next-row-requested")},this);this._flyout.after("open",function(){this.get("dialog").setActiveFlyout({constraintClasses:".flyout-variant-edit",field:this._flyout})},this)},showFlyout:function(){this._flyout.showFlyout()},syncUI:function(){g.superclass.syncUI.call(this);var b=this.get("contentBox").one(".placeholder");this.get("data");b.setContent(this._getPlaceholderContent())},_getFlyoutConfig:function(){throw"FlyoutDrivenDataWidget._getFlyoutConfig: pleaseee implement meeee.";
},_getPlaceholderContent:function(){throw"FlyoutDrivenDataWidget._getPlaceholderContent: pleaseee implement meeee.";}},{CSS_PREFIX:"sqs-flyout-driven-data-widget",ATTRS:{dialog:{value:null}}});b.Squarespace.Widgets.Variants.PricingInput=b.Base.create("pricingInput",b.Squarespace.Widgets.Variants.FlyoutDrivenDataWidget,[],{_getFlyoutConfig:function(){var c=this.get("data"),d=this.get("boundingBox"),f=new e({data:c.price,title:"Price",name:"price"}),g=new b.Squarespace.Widgets.BasicCheck({data:c.onSale,
title:"On Sale",name:"onSale"});g.after("dataChange",function(){g.get("data")?f.disable():f.enable()},this);return{hostNode:d,dialog:this.get("dialog"),name:"pricing",fields:[f,new e({data:c.salePrice,title:"Sale Price",name:"salePrice"}),g]}},_getPlaceholderContent:function(){var c=this.get("data"),d=b.Squarespace.Commerce.moneyString(c.price);return c.onSale?b.Squarespace.Commerce.moneyString(c.salePrice)+' <span class="original-price">'+d+"<span>":d}},{CSS_PREFIX:"sqs-pricing-input",ATTRS:{data:{value:{price:100,
salePrice:0,onSale:!1}},name:{value:"pricing"}}});b.Squarespace.Widgets.Variants.StockInput=b.Base.create("stockInput",b.Squarespace.Widgets.Variants.FlyoutDrivenDataWidget,[],{_getFlyoutConfig:function(){var d=this.get("boundingBox"),e=this.get("data"),f=new c({data:e.qtyInStock,title:"Quantity In Stock",name:"qtyInStock"}),g=new b.Squarespace.Widgets.BasicCheck({data:e.onSale,title:"Unlimited",name:"unlimited"});g.after("dataChange",function(){g.get("data")?f.disable("\u221e"):f.enable(f.get("data"))},
this);return{hostNode:d,name:"stock",dialog:this.get("dialog"),fields:[f,g]}},_getPlaceholderContent:function(){var b=this.get("data");return b.unlimited?"\u221e":b.qtyInStock}},{CSS_PREFIX:"sqs-stock-input",ATTRS:{data:{value:{qtyInStock:0,unlimited:!1}},name:{value:"stock"}}});b.Squarespace.Widgets.Variants.DimensionsInput=b.Base.create("dimensionsInput",b.Squarespace.Widgets.Variants.FlyoutDrivenDataWidget,[],{_getFlyoutConfig:function(){var d=this.get("boundingBox"),e=this.get("data"),f=this.get("measurementStandard")===
b.Squarespace.MeasurementStandard.IMPERIAL?"in.":"cm",g=new c({data:e.len,title:"Length",name:"len",numericFormatterConfig:{postfixUnit:f}}),q=new c({data:e.width,title:"Width",name:"width",numericFormatterConfig:{postfixUnit:f}}),e=new c({data:e.height,title:"Height",name:"height",numericFormatterConfig:{postfixUnit:f}});return{hostNode:d,name:"dimensions",dialog:this.get("dialog"),fields:[g,q,e]}},_getPlaceholderContent:function(){var b=this.get("data");return 0===b.len||0===b.width||0===b.height?
"\u2014":[b.len,b.width,b.height].join('<span class="x">\u2715</span>')}},{CSS_PREFIX:"sqs-dimensions-input",ATTRS:{data:{value:{len:0,width:0,height:0}},name:{value:"stock"},measurementStandard:{value:null}}})},"1.0",{requires:"base node widget-child squarespace-ss-widget squarespace-basic-check squarespace-animations squarespace-panel squarespace-plugin-money-formatter squarespace-plugin-numeric-formatter squarespace-form-utils".split(" ")});
YUI.add("squarespace-list",function(b){var d=b.namespace("Squarespace.DialogFields").List=b.Base.create("list",b.Squarespace.DialogField2,[],{initializer:function(b){var d=this.getProperty("DATA_STATES");(b=b.data)?(this.set("dataState",this.getProperty("DATA_STATES").LOADED),this._addItems(b)):(this.after(this.get("id")+"|dataStateChange",function(b){b.newVal===d.LOADED&&this._addItems(b.data||this.get("data"))},this),this._loadData())},renderUI:function(){d.superclass.renderUI.call(this);var b=
this.get("boundingBox"),e=this.get("strings");b.one("button.add-item").setContent(e.addButton);b.one(".list-title").setContent(e.title);e=b.one(".list-items .empty");e.setContent(this.get("strings.emptyText"));e.show();e=b.one(".add-item");this.get("showAddControl")?e.show():e.hide();this._childrenContainer=b.one(".list-items")},bindUI:function(){d.superclass.bindUI.call(this);var c=this.get("boundingBox");c.on(this.get("id")+"|click",function(c){if(c.target.ancestor(".list-items",!1)){var d=c.target.ancestor("."+
b.Squarespace.DialogField2.CSS_PREFIX,!0).getAttribute("id"),d=this.getFieldById(d);null===d?console.warn(this.name+": Field widget not found, no event will fire."):this.fire("list-item-click",{originalClickEvent:c,field:d,fieldData:d.get("data")})}},this);c.one("button.add-item").on(this.get("id")+"|click",function(){this.fire("add-requested")},this)},syncUI:function(){d.superclass.syncUI.call(this);var b=this.get("data"),e=this.get("boundingBox").one(".list-items").one(".empty");this.clearItems();
b&&b.length?(this._addItems(b),e.hide()):e.show()},getFieldById:function(b){var d=null;this.some(function(f){return f.get("boundingBox").get("id")===b?(d=f,!0):!1});return d},_addItems:function(c){if(!b.Lang.isArray(c))throw this.name+": List data was not an array";b.Array.each(c,function(b){this._addItem(b)},this)},_addItem:function(b){this.get("rendered")&&this.get("boundingBox").one(".list-items .empty").hide();b=this.add({childType:this.get("listItemConstructor"),data:b},0).item(0);if(!b)throw this.name+
": Creating list item failed.";b.after(this.get("id")+"|dataChange",this._updateItem,this);b.after("destroy",function(b){this._removeItem(b.target)},this);return b},addItem:function(c){var d=this._addItem(c),f=this._parseURLObject(this.get("apiURLs.createURL")),g=f.url,h=f.responseDataProperty;g&&b.Data.post({url:g,data:c,success:function(f){this.get("mergeResponseData")&&d.set("data",b.merge(c,h?f[h]:f),{silent:!0})},failure:function(b){console.warn(this.name+": Failed to save item, reverting.");
d.destroy()}},this);return d},removeItem:function(b){-1===this.indexOf(b)?console.warn(this.name+": That item is not in this list"):b.destroy()},_removeItem:function(c){var d=c.get("boundingBox");d.remove();var f=this._parseURLObject(this.get("apiURLs.deleteURL")).url,g=b.bind(function(){c.get("destroyed")||this.remove(this.indexOf(c));this.isEmpty()&&this.get("contentBox").one(".list-items .empty").show()},this);f?b.Data.post({url:f,data:c.get("data"),success:g,failure:function(){d.appendTo(this._childrenContainer)}},
this):g()},clearItems:function(){for(;0<this.size();)this._removeItem(this.item(0),!1);this.get("boundingBox").one(".list-items .empty").show()},_loadData:function(){var c=this.getProperty("DATA_STATES");this.set("dataState",c.LOADING);var d=this.get("apiURLs");if(!d||!this._parseURLObject(d.readURL).url)this.set("dataState",c.LOADED);else{var d=this._parseURLObject(d.readURL),f=d.responseDataProperty,g=d.responseDataSanitizer;b.Data.get({url:d.url,data:this.get("requestData")||{},success:function(d){b.Lang.isFunction(g)&&
(d=g(d));d=f?d[f]:d;this.set("data",d);this.set("dataState",c.LOADED,{data:d})},failure:function(){this.get("boundingBox").one(".list-items").setContent(this.get("strings.loadFail"));this.set("dataState",c.LOAD_FAILED)}},this)}},_parseURLObject:function(c){var d={url:null,requestData:null,responseDataProperty:null,responseDataSanitizer:null};return!c?d:b.Lang.isString(c)?b.merge(d,{url:c||null}):b.merge(d,{url:c.url||null,requestData:c.requestData||null,responseDataProperty:c.responseDataProperty||
null,responseDataSanitizer:c.responseDataSanitizer||null})},_updateItem:function(c){var d=this._parseURLObject(this.get("apiURLs.updateURL")).url;if(d&&!c.silent){var f=c.target,g=f.get("data");b.Data.post({url:d,data:g,success:function(c){this.get("mergeResponseData")&&(c=this.get("mergeResponseDataProperty"),f.set("data",b.merge(g,c?responseData[c]:responseData),{silent:!0}))},failure:function(b){f.set("data",c.prevVal,{silent:!0})}},this)}}},{CSS_PREFIX:"sqs-list",ASYNC_DATA:!0,TEMPLATE:'<div class="controls"><button class="add-item" type="button"></button></div><div class="list-title"></div><div class="list-items"><div class="empty"></div></div>',
ATTRS:{strings:{value:{title:"Set strings.title to something.",addButton:"Add Item",emptyText:"No items.",loadFail:"Unable to load items."}},data:{value:[],getter:function(){var b=[];this.each(function(d){b.push(d.get("data"))},this);return b}},apiURLs:{value:{createURL:null,readURL:null,updateURL:null,deleteURL:null}},listItemConstructor:{value:b.Squarespace.DialogField2},requestData:{value:null},responseDataProperty:{value:null},mergeResponseData:{value:!0,validator:b.Lang.isBoolean},mergeResponseDataProperty:{value:null},
showAddControl:{value:!0}}})},"1.0",{requires:["widget-child","widget-parent","squarespace-dialog","squarespace-dialog-field-2"]});
YUI.add("squarespace-dialog-state-picker",function(b){function d(c,f){if(!b.Lang.isObject(c)||!b.Lang.isObject(f))return c===f;var g=!0;b.Object.each(c,function(c,e){b.Lang.isObject(c)&&b.Lang.isObject(f[e])?g=g&&d(c,f[e]):c!==f[e]&&(g=!1)});return g}b.namespace("Squarespace.DialogFields");var c=b.Squarespace.DialogFields.Statepicker2=b.Base.create("statepicker",b.Squarespace.DialogField2,[b.WidgetParent],{renderUI:function(){c.superclass.renderUI.call(this);var b=this.get("contentBox");this.stateLabel=
b.one(".field-workflow-title");this.stateDesc=b.one(".field-workflow-description");this.buildStateMenu()},bindUI:function(){c.superclass.bindUI.call(this);this.on("*:stateSelected",this.onStateChosen,this)},onStateChosen:function(b){console.log("state chosen!!",b.target.get("data"));this.each(function(c){c.set("isSelected",b.target===c)},this);this.set("data",b.target.get("data.key"))},getStateType:function(){var b=this.get("data"),b=this.get("states")[b.state].stateDesc,b=/\[\s*([^|\]]+?)\s*(?:\|([^]]*))?\s*\]/g.exec(b);
return null!==b?String(b[1]).toLowerCase():!1},buildStateMenu:function(){this.get("contentBox");var b=this.get("stateOrder"),c=this.get("states");this._renderStatesObject(c,b)},_renderStatesObject:function(c,d){var g=b.Array.map(d,function(b,d){var f=c[b];f.key=b;return f});b.Array.each(g,this._renderState,this)},_renderState:function(c,d){var g=this.get("data.state"),h=this.get("contentBox").one(".sqs-state-picker-options");if(!h)throw"No element to attach states to.";this.add({childType:b.Squarespace.DialogFields.StateOption,
isSelected:g===c.key,data:c,render:h})},didDataChange:function(){return d(this.get("data"),this._initialData)}},{CSS_PREFIX:"sqs-state-picker",TEMPLATE:'<div class="sqs-state-picker-wrapper"><div class="sqs-state-picker-options"></div></div>',ATTRS:{strings:{},data:{getter:function(c){return b.Lang.isObject(c)?b.merge(c,{}):c}},states:{},stateOrder:{},stateType:{},durationOffset:{value:-1},allowNever:{}}})},"1.0",{requires:["base","base-build","squarespace-dialog-fields","squarespace-dialog-state-option",
"squarespace-dialog-field-2"]});
YUI.add("squarespace-content-item-types-selector",function(b){var d={};d[b.Squarespace.Enums.RecordType.DIGITALGOOD]="Squarespace will automatically send customers a secure link to the file lasting 24 hours";d[b.Squarespace.Enums.RecordType.STORE_ITEM]="A package must be shipped by the merchant.";b.namespace("Squarespace.ContentItemTypes").Selector=b.Base.create("ContentItemTypesSelector",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var c=this.get("dialog");c.on("datachange",function(d){d=
d.get("data");var f=this.get("onContentItemTypeSelected");if(f)c.updateTitle(b.Squarespace.DialogStates.LOADING),c.showSaveOverlay(),f(this.getContentItemConfiguration(d),function(){c.hideSaveOverlay();c.close()});else throw"No onContentItemTypeSelected handler function?";},this)},getContentItemConfiguration:function(c){var d=b.Array.find(this.get("acceptTypes"),function(b){return b.value==c}),f={recordType:d.recordType};d.customType&&(f.customContent={customType:d.customType});d.recordType==b.Squarespace.Enums.RecordType.STORE_ITEM&&
(f.structuredContent={productType:d.productType});return f}},{ATTRS:{onContentItemTypeSelected:{},acceptTypes:{valueFn:function(){var c=b.Squarespace.Singletons.Template.get("customTypes"),e=b.Object.keys(c),f=[];b.Array.each(this.get("model").get("acceptTypes"),function(g){var h=b.Squarespace.Enums.RecordType.valueForString(g),k=b.Squarespace.Enums.RecordType.titleForValue(h),l;b.Lang.isNull(h)&&-1!==e.indexOf(g)&&(l=c[g],h=b.Squarespace.Enums.RecordType.valueForString(l.get("base")),k=l.get("title"));
if(!h)return new b.Squarespace.Widgets.Alert({"strings.title":"Custom Type Configuration Not Found","strings.message":'Configuration not found for accept type "'+g+'". Please double check the collection configuration.'}),null;if(h==b.Squarespace.Enums.RecordType.STORE_ITEM)f.push({icon:"store-item-physical",title:"Physical",value:"store-item-physical",description:"A package must be shipped by the merchant.",recordType:b.Squarespace.Enums.RecordType.STORE_ITEM,productType:b.Squarespace.ProductTypes.PHYSICAL}),
f.push({icon:"store-item-digital-good",title:"Digital",value:"store-item-digital-good",description:"Squarespace will send customers a secure link to the file lasting 24 hours.",recordType:b.Squarespace.Enums.RecordType.STORE_ITEM,productType:b.Squarespace.ProductTypes.DIGITAL}),f.push({icon:"store-item-service",title:"Service",value:"store-item-service",description:"A service must be rendered. Services do not have shipping costs applied.",recordType:b.Squarespace.Enums.RecordType.STORE_ITEM,productType:b.Squarespace.ProductTypes.SERVICE});
else{var p=b.Squarespace.Enums.RecordType.stringForValue(h);if(!b.Lang.isValue(k))return console.warn('Could not find title for acceptType "'+g+'"'),null;f.push({icon:p,title:k,value:g,description:d[h],recordType:h,customType:l?l.get("name"):null})}},this);return f=f.filter(function(b){return null!==b})}},dialogConfig:{valueFn:function(){return{width:{$valueFn:function(c){return c.get("collectionType")==b.Squarespace.CollectionTypes.PRODUCT?600:370}},name:{$valueFn:function(c){return c.get("collectionType")==
b.Squarespace.CollectionTypes.PRODUCT?"productType":"content type"}},overlay:0.5,style:"flyout",closeOthers:!1,discardChangesConfirmation:!1,flyoutPointerDirection:"centered",loadingText:"Loading...",tabs:[{title:{$valueFn:function(c){return c.get("collectionType")==b.Squarespace.CollectionTypes.PRODUCT?"Select Product Type":c.get("addText")}},icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{$valueFn:b.bind(function(c){var d=this.get("acceptTypes"),f=3>d.length?d.length:3;c.get("collectionType")==
b.Squarespace.CollectionTypes.PRODUCT&&(f=1);return{ctor:b.Squarespace.DialogFields.MultiOption,config:{numeric:!1,options:d,columns:f}}},this)}]}]}}}}});b.namespace("Squarespace.Mixins").AddContentItemHandlerMixin=b.Base.create("AddContentItemHandlerMixin",b.Base,[],{_createNewContentItemAndShowEditor:function(c,d){var f=this.get("collection"),g=this._createNewContentItem(c),h=new (b.Squarespace.ContentItemEditorFactory.getEditor(g,this.get("itemEditorOptions")))({model:g}),k=g.on("save",function(b){(!b.options||
!b.options.headers||!b.options.headers["X-AutoSave"])&&f.items.add(g)},this);h.on("visibleChange",function(b){b.newVal||(k.detach(),g.isNew()&&f.items.remove(g))});d();h.show();return h},_createNewContentItem:function(c){var d=this.get("collection"),f={collectionId:d.get("id")};if(d.get("ordering")===b.Squarespace.CollectionOrdering.USER||d.get("ordering")===b.Squarespace.CollectionOrdering.MUSIC_ALBUM)f.displayIndex=d.get("nextDisplayIndex");c=new b.Squarespace.Models.ContentItem(b.merge(c,f));b.Squarespace.Utils.isDamaskEnabled()&&
d.items.add(c);return c},handleAddContentRequest:function(){var c=new b.Squarespace.ContentItemTypes.Selector({model:this.get("collectionConfiguration"),onContentItemTypeSelected:b.bind(this._createNewContentItemAndShowEditor,this)}),d=c.get("acceptTypes"),f=this.get("selectorAnchorNode"),g=this.get("collection"),h=b.Squarespace.Constants.MAX_TRACKS_IN_ALBUM;if(g.get("ordering")===b.Squarespace.CollectionOrdering.MUSIC_ALBUM&&g.get("nextDisplayIndex")>=h)new b.Squarespace.Widgets.Alert({"strings.title":"Max Size Reached",
"strings.message":"This album has a maximum size of "+h+" tracks."});else{if(0===d.length)new b.Squarespace.Widgets.Alert({"strings.title":"Configuration Error","strings.message":"There are no valid accept types defined for the collection type "+this.get("collectionConfiguration").get("title")+"."});else{if(1===d.length){this._createNewContentItemAndShowEditor(c.getContentItemConfiguration(d[0].value),function(){});return}f&&c.set("anchorNode",f)}g.isNew()?c.show():g.load({},function(){(new b.Promise(function(c){g.get("type")!==
b.Squarespace.CollectionTypes.PRODUCT?c({isAtOrOverLimit:!1}):b.Data.get({url:"/api/commerce/inventory/violation",success:function(b){c(b)}})})).then(function(d){if(d.isAtOrOverProductLimit)if(d.blockUserAction)(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Product Limit Reached","strings.message":d.message})).on("confirm",CONFIG_PANEL.goToUpgrade);else(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Continue",
"strings.title":"Warning: Product Limit","strings.message":d.message})).on("confirm",c.show,c);else g.get("itemCountExceeded")?new b.Squarespace.Widgets.Alert({"strings.title":"Max Size Reached","strings.message":"This page has a maximum size of "+g.get("maxItemCount")+" items."}):c.show()})},this)}}},{ATTRS:{itemEditorOptions:{value:{}},collectionConfiguration:{},collection:{},selectorAnchorNode:{}}})},"1.0",{requires:"squarespace-model-editor squarespace-content-item-types-enum-record-type squarespace-util squarespace-enum squarespace-widgets-alert squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-mixins-expandable",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.Expandable=b.Base.create("Expandable",b.Base,[],{initializer:function(){this.publish("expandableOpened");this.publish("expandableClosed");this.after("expandableNodeChange",function(d){d.newVal.plug(b.Squarespace.Animations.Expandable,{duration:this.get("expandDuration")})},this)},open:function(b){var c=this.get("expandableNode");c.hasClass("expandable-hidden")&&(c.once("opened",function(){this._set("animating",
!1);this._set("isOpen",!0);this.fire("expandableOpened")},this),this._set("animating",!0),c.show(b))},close:function(b){var c=this.get("expandableNode");c.hasClass("expandable-hidden")||(c.once("closed",function(){this._set("animating",!1);this._set("isOpen",!1);this.fire("expandableClosed")},this),this._set("animating",!0),c.hide(b))}},{ATTRS:{expandableNode:{valueFn:function(){return this.get("contentBox")},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Node)},expandDuration:{value:0.2,validator:b.Squarespace.AttrValidators.isNumber,
readOnly:!0},isOpen:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0},animating:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,readOnly:!0}}})},"1.0",{requires:["base","node","squarespace-animations","squarespace-attr-validators"]});
YUI.add("squarespace-block-markdown",function(b){b.namespace("Squarespace.ContentModel").MarkdownBlock=b.Base.create("MarkdownContentModel",b.Model,[],{},{ATTRS:{wysiwyg:{value:{engine:"code",mode:"markdown",isSource:!1,source:""}},html:{value:""}}});b.namespace("Squarespace.Block").Markdown=b.Base.create("block-markdown",b.Squarespace.Block.Base,[],{initializer:function(){this.get("editController").isMobileApp()&&this._populateEmptyHtml()},bindUI:function(){this.get("model").on("change",this.syncUI,
this)},syncUI:function(){var b=this.get("model").get("html");this.get("contentBox").setHTML(b);this.fire("widget:contentUpdate")},_populateEmptyHtml:function(){var d=this.get("model"),c=d.get("wysiwyg.source");c&&!d.get("html")&&d.set("html",b.Squarespace.Lang.markdownToHTML(c))},isEmpty:function(){return!this.get("model").get("html")}},{CSS_PREFIX:"sqs-block-markdown",MODEL:b.Squarespace.ContentModel.MarkdownBlock,ATTRS:{editor:{valueFn:function(){return b.Squarespace.Block.Editor.Markdown}},mobileEditor:{valueFn:function(){return b.Squarespace.Block.Editor.MarkdownMobile}},
emailEditor:{valueFn:function(){return b.Squarespace.Block.Editor.MarkdownEmail}}}})},"1.0",{requires:"base model squarespace-block-base squarespace-markdown squarespace-ss-widget widget-parent".split(" ")});
YUI.add("squarespace-dialog-site-user-service-connect-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-site-user-service-connect.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l,p=this.escapeExpression;h=d.blockHelperMissing;b='<div class="sqs-content-inner">\n\n    <div class="text">\n        ';l={hash:{},inverse:this.noop,fn:this.program(1,function(b,c){var e,f;e='\n        <div class="title">';
(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f="function"===typeof f?f.apply(b):f);return e+=p(f)+'</div>\n        <div class="message">Click to connect</div>\n        '},k),data:k};(k=d.strings)?k=k.call(c,l):(k=c.strings,k="function"===typeof k?k.apply(c):k);d.strings||(k=h.call(c,k,l));if(k||0===k)b+=k;return b+'\n    </div>\n\n    <div class="fields"></div>\n\n    <div class="icon"></div>\n\n</div>\n'})})();b.Handlebars.registerPartial("dialog-site-user-service-connect.html".replace("/",
"."),d.templates["dialog-site-user-service-connect.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-pie-chart",function(b){b.namespace("Squarespace");b.Squarespace.PieChart=b.Base.create("pieChart",b.Squarespace.DataBackedWidget,[],{initializer:function(b){this._arcGenerator={};this._selectedArcGenerator={};this._collapseArcGenerator={};this._pieLayout={};this._colorScale={}},renderUI:function(){var b=d3.select(this.get("contentBox").getDOMNode()).select(".pie-chart"),c=this.get("data"),e=this.get("key"),f=this.get("minSize"),g,h;b.empty()&&(b=this.initializePie());this._arcGenerator=
d3.svg.arc().outerRadius(this.get("radius"));this._selectedArcGenerator=d3.svg.arc().outerRadius(1.1*this.get("radius"));this._collapseArcGenerator=d3.svg.arc().outerRadius(0);this._pieLayout=d3.layout.pie().value(function(b){return parseFloat(b[e])});this.set("data",c.sort(function(b,c){return-(parseFloat(b[e])-parseFloat(c[e]))}));h=c.reduce(function(b,c){return b+parseFloat(c[e])},0);c.forEach(function(b){b.__percentage=100*(parseFloat(b[e])/h)});0<f&&(g=100*f,this.set("data",c.filter(function(b){return b.__percentage>=
g})));this.buildScales();this.renderPieChart(b.select(".pieChart g"));this.renderColorKey(b.select(".colorKey"))},initializePie:function(){var b=this.get("contentBox"),c=d3.select(b.getDOMNode()),e=b.get("offsetWidth"),b=b.get("offsetHeight"),f=this.get("radius"),e=b=2.3*f;this._pieChartHOffset=1.1*f;this._pieChartVOffset=1.1*f;c.append("div").attr("class","pieChart").append("svg:svg").attr("width",e).attr("height",b).append("svg:g").attr("transform","translate("+this._pieChartHOffset+","+this._pieChartVOffset+
")");c.append("div").attr("class","colorKey");return c},buildScales:function(){this.buildXScale()},buildXScale:function(){var b=this.get("range"),c=this.get("data"),e=b[0],b=b[1];this._colorScale=d3.scale.linear().domain([0,c.length]).range([e,b])},renderPieChart:function(b){var c=this.get("data");this.get("key");this.get("radius");var e=this._pieLayout,f=this._arcGenerator,g=this._collapseArcGenerator,h=this._colorScale,k;b=b.append("svg:g").data([c]).selectAll("g.slice").data(e).enter().append("svg:g").attr("class",
function(b,c){return"slice id-"+c});k=this;b.append("svg:path").attr("fill",function(b,c){return h(c)}).on("mouseover",function(b,c){k.select(c)}).on("mouseout",function(b,c){k.deselect(c)}).attr("d",g).transition().delay(function(b,c){return 300+20*c}).duration(600).ease("elastic",1,1).attr("d",f)},renderColorKey:function(b){var c=this.get("data").slice(0,this.get("colorKeySize"));this.get("key");var e=this.get("rows"),f=Math.ceil(c.length/e),g=this._colorScale,h=this.get("label"),k=this.get("formatter"),
l=0;b.selectAll(".colorKey-col").data(d3.range(f)).enter().append("div").attr("class","colorKey-col").selectAll(".colorKey-item").data(function(b,d){return c.slice(d*e,(d+1)*e)}).enter().append("div").attr("class","colorKey-item").each(function(b,c){var d=d3.select(this);d.append("div").attr("class","colorKey-rect id-"+l).style("background-color",function(b,c){return g(l)});d=d.append("div").attr("class","labels");d.append("div").attr("class","colorKey-text").text(b.__percentage.toFixed(2)+"%");if(h||
k)d.append("div").attr("class","colorKey-label").text(k?k(b):b[h]);++l})},bindUI:function(){this.after("dataChange",this.onDataChange,this)},syncUI:function(){},onDataChange:function(){},select:function(b){this.selectSlice(b);this.selectKeyBlock(b)},deselect:function(b){this.deselectSlice(b);this.deselectKeyBlock(b)},selectSlice:function(b){var c=d3.select(this.get("contentBox").getDOMNode()),e=this.get("selectDuration"),f=this._selectedArcGenerator;c.select(".slice.id-"+b+" path").transition().duration(e).ease("elastic",
1,3).attr("d",f)},selectKeyBlock:function(b){var c=d3.select(this.get("contentBox").getDOMNode()),e=this.get("selectDuration");b=c.select(".colorKey-rect.id-"+b);b[0][0]&&b.transition().duration(e).ease("elastic").style("-webkit-transform","scale(1.3)").style("-moz-transform","scale(1.3)").style("transform","scale(1.3)")},deselectKeyBlock:function(b){var c=d3.select(this.get("contentBox").getDOMNode()),e=this.get("selectDuration");b=c.select(".colorKey-rect.id-"+b);b[0][0]&&b.transition().duration(e).ease("elastic").style("-webkit-transform",
"scale(1)").style("-moz-transform","scale(1)").style("transform","scale(1)")},deselectSlice:function(b){var c=d3.select(this.get("contentBox").getDOMNode()),e=this.get("selectDuration"),f=this._arcGenerator;c.select(".slice.id-"+b+" path").transition().duration(e).ease("elastic").attr("d",f)}},{ATTRS:{rows:{value:5},selectDuration:{value:300},radius:{value:40,validator:function(b){return 0<=b}},range:{value:["#FFF","#000"]},label:{setter:function(b){return""+b}},formatter:{validator:b.Lang.isFunction},
minSize:{value:0},colorKeySize:{value:10}}})},"1.0",{requires:["squarespace-data-backed-widget","base"]});
YUI.add("squarespace-dialog-product-chooser",function(b){b.Squarespace.ProductChooserModes={squarespace:Class.create({DATA_PROPERTY:"id",URL:"/api/content-items/search",TEMPLATE:'<div class="thumbnail-wrapper"><img src="/item/{id}?format=100w" class="thumbnail"/></div><div class="description"><div class="text">{title}</div><div class="author">{numVariants} {variantText}</div></div>',TITLE:"Find A Product",render:function(c){return b.Lang.sub(this.TEMPLATE,{id:c.id,title:c.title,numVariants:c.variants.length,
variantText:1!=c.variants.length?"variants":"variant"})},acResultFormatter:function(c,d){return b.Array.map(d,function(b){return'<div class="ac-product">'+this.render(b.raw)+"</div>"},this)},getAcRequestTemplate:function(){var c;return c="?q={query}"+b.Lang.sub("&collectionType={collectionType}&recordType={recordType}",{collectionType:b.Squarespace.CollectionTypes.PRODUCT,recordType:b.Squarespace.Enums.RecordType.STORE_ITEM})}}),amazon:Class.create({DATA_PROPERTY:"asin",URL:"/api/config/AmazonProductSearch",
TEMPLATE:'<div class="thumbnail-wrapper"><img src="{thumbUrl}" class="thumbnail"/></div><div class="description"><div class="text">{title}</div><div class="author">{author}</div></div>',TITLE:"Search For Product Keywords or paste product URL",render:function(c){return b.Lang.sub(this.TEMPLATE,{thumbUrl:c.imageUrlMedium,title:c.title,author:this._formatByline(c)})},acResultFormatter:function(c,d){return b.Array.map(d,function(b){return'<div class="ac-product">'+this.render(b.raw,b.highlighted)+"</div>"},
this)},getAcRequestTemplate:function(){return"?q={query}"},_formatByline:function(b){return b.authors&&b.authors.length?"By "+b.authors.join(", "):b.artists&&b.artists.length?"By "+b.artists.join(", "):b.actors&&b.actors.length?"Starring "+b.actors.join(", "):b.manufacturer}})};b.namespace("Squarespace.DialogFields");var d=b.Squarespace.DialogFields.ProductChooser=b.Base.create("productChooser",b.Squarespace.DialogField2,[],{initializer:function(c){this._mode=new (b.Squarespace.ProductChooserModes[this.get("mode")])},
destructor:function(){this._autoCompleteField&&this._autoCompleteField.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._hintNode=b.appendChild('<div class="hint">'+this._mode.TITLE+"</div>");this._productSearchNode=b.appendChild('<div class="product-search"></div>');this._productPreviewNode=b.appendChild('<div class="product-preview"></div>');this._autoCompleteField=this._createAutoCompleteField();this._autoCompleteField.render(this._productSearchNode)},
bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("contentBox"),e=this._autoCompleteField;b.delegate("click",function(){this.set("data",null)},".clear-selected-product",this);e.on("select",this._onAutoCompleteSelect,this);e.on("blur",e.hideError,this)},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("contentBox"),e=this._hintNode,f=this._autoCompleteField;f.clear();f.focus();this._updatePreview(this.get("data"));b.Lang.isValue(this.get("data"))?(c.addClass("has-data"),
c.removeClass("no-data"),e.setContent("Selected Product")):(c.addClass("no-data"),c.removeClass("has-data"),e.setContent("Find A Product"))},focus:function(){this._autoCompleteField.focus()},getErrors:function(){return this.get("required")&&!b.Lang.isValue(this.get("data"))?["You must choose a product"]:[]},_onAutoCompleteSelect:function(){var c=this._autoCompleteField,d=c.get("data"),c=c.get("dataObject");b.Lang.isValue(d)&&("amazon"===this.get("mode")?this.set("data",c):this.set("data",d))},_updatePreview:function(c){if(b.Lang.isValue(c))if("squarespace"===
this.get("mode")&&b.Lang.isString(c))this._getProductItem(c);else{var d=this._productPreviewNode;c=this._mode.render(c)+'<div class="clear-selected-wrapper"><div class="clear-selected-product"></div></div>';d.setContent(c);d.setStyle("opacity",0);d.show("fadeIn",{duration:0.25})}},_getProductItem:function(c){b.Data.get({url:"/api/commondata/GetItem",data:{itemId:c},success:function(b){this._updatePreview(b.item)},failure:function(b){this.set("data",null)}},this)},_createAutoCompleteField:function(){var c=
this._mode,c={source:this._createDataSource(),requestTemplate:c.getAcRequestTemplate(),resultTextLocator:"title",resultFormatter:b.bind(c.acResultFormatter,c),maxResults:this.get("maxResults")},c=b.merge(c,this.get("acConfig"));return new b.Squarespace.DialogFields.AutoComplete({"strings.placeholder":"Search",requireListEntry:!0,responseDataProperty:this._mode.DATA_PROPERTY,acConfig:c})},_createDataSource:function(){var c=new b.DataSource.IO({source:this._mode.URL});c.plug(b.Plugin.DataSourceJSONSchema,
{schema:{resultListLocator:"amazon"===this.get("mode")?"products":"results"}});c.on("error",function(c){c.stopped||(c=JSON.parse(c.data.response).error,b.Lang.isValue(c)&&this._autoCompleteField.showError(c))},this);return c}},{CSS_PREFIX:"sqs-product-chooser",ATTRS:{mode:{value:"squarespace",validator:function(b){if(-1!==["squarespace","amazon"].indexOf(b))return!0;console.error("ProductChooser: invalid attributte mode.");return!1},writeOnce:"initOnly"},maxResults:{validator:b.Squarespace.AttrValidators.isNumber,
writeOnce:"initOnly"},acConfig:{validator:b.Squarespace.AttrValidators.isObject,writeOnce:"initOnly",value:{}}}})},"1.0",{requires:"base datasource squarespace-dialog-field-2 squarespace-dialog-auto-complete squarespace-util squarespace-content-item-types-enum-record-type squarespace-attr-validators".split(" ")});
YUI.add("squarespace-block-social-account-links-v2",function(b){b.namespace("Squarespace.Block").SocialAccountLinksV2=b.Base.create("block-social-account-links-v2",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-socialaccountlinks",MODEL:b.Squarespace.ContentModel.SocialAccountLinksBlock,ATTRS:{type:{value:b.Squarespace.BlockType.SOCIAL_ACCOUNT_LINKS_V2},editor:{value:b.Squarespace.Block.Editor.SocialAccountLinks}}})},"1.0",{requires:"base model squarespace-block-social-account-links-model squarespace-block-social-account-links-editor squarespace-block-base-modelsync squarespace-enum".split(" ")});
YUI.add("squarespace-plugin-node-expander",function(b){b.namespace("Squarespace.Plugins").NodeExpander=b.Base.create("NodeExpander",b.Plugin.Base,[],{initializer:function(){var d=this.get("node");d.addClass("sqs-node-expander");this._button=d.appendChild('<div class="sqs-node-expander-button"><div class="arrow-top"></div><div class="arrow-bottom"></div></div>');this._placeholderNode=b.Node.create("<div></div>");this.publishEvents();this.bindEvents()},publishEvents:function(){this.publish("expand-start",
{emitFacade:!0,defaultFn:this._expand});this.publish("expand-end",{emitFacade:!0});this.publish("contract-start",{emitFacade:!0,defaultFn:this._contract});this.publish("contract-end",{emitFacade:!0})},bindEvents:function(){this._button.on("tap",this.toggleExpanded,null,this);this.after("expandedChange",function(b){this._button.toggleClass("sqs-node-expander-active",!!b.newVal);b.newVal?this.fire("expand-start"):this.fire("contract-start")},this)},_expand:function(){var b=this.get("node");b.insert(this._placeholderNode.setStyles({width:b.get("offsetWidth"),
height:b.get("offsetHeight")}),"after");var c=b.get("region");b.addClass("sqs-node-expander-active");b.setStyles({position:"fixed",top:c.top,left:c.left,right:window.innerWidth-c.right,bottom:window.innerHeight-c.bottom,zIndex:101});b.anim({top:0,left:0,right:0,bottom:0},{duration:0.5,end:function(){this.fire("expand-end")}},this).run()},_contract:function(){var b=this.get("node"),c=this._placeholderNode.get("region");b.anim({top:c.top,left:c.left,right:window.innerWidth-c.right,bottom:window.innerHeight-
c.bottom,zIndex:101},{end:function(){this._placeholderNode.remove();b.removeClass("sqs-node-expander-active");b.setStyles({position:null,top:null,left:null,right:null,bottom:null});this.fire("contract-end")}},this).run()},toggleExpanded:function(){this.set("expanded",!this.get("expanded"))},destructor:function(){this._button.remove();this.get("node").removeClass("sqs-node-expander")}},{NS:"NodeExpander",ATTRS:{expanded:{value:!1},node:{valueFn:function(){return this.get("host")}}}})},"1.0",{requires:["base-build",
"plugin","node"]});
YUI.add("squarespace-content-item-filter",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.SearchFilter=b.Base.create("SearchFilter",b.Squarespace.Widgets.SSWidget,[b.WidgetParent],{initializer:function(c){if(!b.Lang.isValue(c.listSource))throw"listSource was not supplied.";this._listSource=this.get("listSource")},renderUI:function(){d.superclass.renderUI.apply(this,arguments);var b=this.get("contentBox");this._inputEl=b.one(".search-filter");this._clearEl=b.one(".btn-clear")},
bindUI:function(){d.superclass.bindUI.apply(this,arguments);this._clearEl.on("click",this._clearFilter,this);this._inputEl.on(["keydown","keyup"],function(b){27==b.keyCode&&(this._clearFilter(),this._inputEl.focus(),b.halt())},this);this._inputEl.on("valuechange",function(){this._loadFilter();this._handleFiltration()},this);this.after(["thresholdChange","visibleChange"],this.syncUI,this);this._listSource.after("syncComplete",this.syncUI,this)},syncUI:function(){d.superclass.syncUI.apply(this,arguments);
this.isFilterActive()?(this._clearEl.show({duration:0.2}),this._handleFiltration()):this._clearEl.hide()},_loadFilter:function(b){b=this._inputEl.get("value");var d=this._getFacet();this.set("filterFn",{value:b,facet:d})},_clearFilter:function(b){this._inputEl.set("value","").blur();this._loadFilter(b);this._handleFiltration(b)},_handleFiltration:function(c){c=this.get("listSource");var d=this._inputEl.get("value"),f=this._getFacet(),g=this._getFacetSelector(f),h=this._buildFilterFn({value:d,facet:f}),
k=function(c){var f,k;f=c.get("item");h(f)&&this.get("highlighting")&&g?(f=c.get("contentBox").one(g),k=b.Highlight.all(f.get("text"),d.split(" "),{caseSensitive:!1}),f.setHTML(k),c.set("visible",!0)):c.set("visible",!1)};c.get("defaultChildType")===b.Squarespace.Blog.Item?c.each(k,this):c.get("defaultChildType")&&c.each(function(b){b.each(k,this)},this)},update:function(c){b.Lang.isObject(c)&&(b.Lang.isValue(c.pageSize)&&this.set("threshold",c.pageSize),b.Lang.isValue(c.itemCount)&&this.set("visible",
c.itemCount>c.pageSize))},focusInput:function(){this._inputEl&&this._inputEl.focus()},_getFacet:function(){return"title"},isFilterActive:function(){var c=this._inputEl.get("value");return b.Lang.isString(c)&&0<c.length},_getFacetSelector:function(c){var d={title:"header > h2",author:".author-name"};return b.Object.hasKey(d,c)?d[c]:!1},_getTextContent:function(c,d){var f;if("author"===d)return f=c.get(d),f.displayName;if("email"===d)return f=c.get("author"),f.email;f=c.get(d);return b.Lang.isValue(f)?
f:""},_buildFilterFn:function(c){if(!c||!b.Lang.isValue(c.value)||!b.Lang.isValue(c.facet))return!1;var d=c.value,f=c.facet;return b.bind(function(c){var h=b.Array.unique(d.toLowerCase().split(" ")),k=this._getTextContent(c,f),k=k.toLowerCase();return b.Array.every(h,function(b){return-1!==k.indexOf(b)})},this)}},{CSS_PREFIX:"sqs-content-item-filter",TEMPLATE:'<div class="search-filter-wrapper"><div class="search-filter-input"><input class="search-filter" placeholder="Search items by title..." type="text"><div class="btn-clear">Clear</div></div><div id="search-filter-by-type"> </div></div>',
ATTRS:{threshold:{validate:b.Lang.isNumber,value:20},highlighting:{value:!0},strings:{},listSource:{value:{},writeOnce:"initOnly"},filterFn:{setter:function(){return this._buildFilterFn.apply(this,arguments)}},visible:{value:!1}}})},"1.0",{requires:["base","node","squarespace-ss-widget"]});
YUI.add("squarespace-node-flyover",function(b){var d=b.namespace("Squarespace.Animations").Flyover=b.Base.create("flyoverPlugin",b.Squarespace.Animations.Flyout,[],{_getIntendedMaskPosition:function(){var c=d.superclass._getIntendedMaskPosition.call(this),e=this.get("host").get("region").width,f=this.get("host").get("region").height,g=this.get("paddingOffset"),h=g,k=g,l=0,p=0;b.Lang.isObject(g)&&(h=b.Object.hasKey(g,"x")?g.x:0,k=b.Object.hasKey(g,"y")?g.y:0);var g=this.get("alignment"),q=b.Squarespace.Animations.Flyout;
switch(g){case q.TC:case q.BC:break;case q.BR:case q.TR:p=h;break;case q.BL:case q.TL:p=-1*h;break;case q.LT:case q.LC:case q.LR:p=e+h;break;case q.RT:case q.RC:case q.RB:p=-1*(e+h);break;default:throw"Flyover errror: Unhandled parentClass (but maybe I should have thrown this earlier...)";}switch(g){case q.BL:case q.BC:case q.BR:l=-1*(f+k);break;case q.TL:case q.TC:case q.TR:l=f+k;break;case q.LC:case q.RC:break;case q.RT:case q.RB:case q.LT:case q.LR:l=k;break;default:throw"Flyover errror: Unhandled direction (but maybe I should have thrown this earlier...)";
}c.y+=l;c.x+=p;return c}},{NS:"flyoutOver",ATTRS:{overlay:{value:!0},paddingOffset:{value:{}}}})},"1.0",{requires:["base","base-build","squarespace-dialog-fields","squarespace-dialog-field-2","squarespace-node-flyout"]});
YUI.add("squarespace-block-social-summary",function(b){var d=b.namespace("Squarespace.Block").SocialSummaryBase=b.Base.create("block-social-summary",b.Squarespace.Block.Summary,[],{_setDefaultContent:function(){this.get("model").setAttrs(this._getDefaultContent())},bindUI:function(){d.superclass.bindUI.call(this)},_renderSuccess:function(b){d.superclass._renderSuccess.call(this,b);this._togglePolling()},destructor:function(){this.stopRenderPolling()},startRenderPolling:function(){this._synchronizingRenderTimer||
(this._synchronizingRenderTimer=b.later(3E3,this,function(){this.render()},[],!0))},stopRenderPolling:function(){this._synchronizingRenderTimer&&(this._synchronizingRenderTimer.cancel(),this._synchronizingRenderTimer=null)},_togglePolling:function(){var c=this.get("contentBox");b.Lang.isNull(c.one(".sqs-state-message.synchronizing"))?this.stopRenderPolling():this.startRenderPolling()},_getDefaultContent:function(){return{title:!0,thumbnail:!0,excerpt:!0,pageSize:10,collectionId:"",filter:{}}}},{CSS_PREFIX:"sqs-block-social-summary",
MODEL:b.Squarespace.ContentModel.SocialSummaryBlock,ATTRS:{defaultContentModel:{valueFn:"_getDefaultContent"},editor:{value:b.Squarespace.Block.Editor.Dialog},type:{value:b.Squarespace.BlockType.SOCIAL_SUMMARY}}})},"1.0",{requires:["base","squarespace-enum","squarespace-block-summary","squarespace-block-social-summary-model-editor"]});
YUI.add("squarespace-dialog-checklist",function(b){b.namespace("Squarespace.DialogFields");b.Squarespace.DialogFields.Checklist=b.Base.create("checklist",b.Squarespace.DialogField2,[],{bindUI:function(){b.Squarespace.DialogFields.Checklist.superclass.bindUI.call(this);var d=this.get("contentBox");d.delegate("click",this._skipTask,".markComplete",this);d.delegate("click",this._showTip,".task",this);CONFIG_PANEL.on("state-changed",function(){this._hideAllTips()},this);this._openTips=[]},syncUI:function(){b.Squarespace.DialogFields.Checklist.superclass.syncUI.call(this);
var d=this.get("data"),c=this.get("contentBox");c.all(".task").each(function(b){var c=b.getAttribute("data-task"),e=this._getTutorialName(c);(d[c]||this.get("websiteSettings.tutorialsCompleted."+e))&&b.addClass("completed")},this);var e=!0,f;for(f in d)e=e&&d[f];e&&(c.one(".checklist-status").addClass("checklist-complete"),e=this.get("allDoneCallback"),b.Lang.isFunction(e)&&e(c))},_getTutorialName:function(b){return this.get("tutorialNamePrefix")+"-"+b},_skipTask:function(d){d=d.currentTarget.ancestor(".task").getAttribute("data-task");
d=this._getTutorialName(d);b.Data.post({url:"/api/config/MarkWebsiteTutorialCompleted",data:{tutorial:d}},this);this.get("websiteSettings").tutorialsCompleted[d]=!0;this.syncUI()},_showTip:function(d){if(!d.target.hasClass("markComplete")){d=d.currentTarget.getAttribute("data-task");d=this.get("tips."+d);var c=b.one(d.alignNodeSelector),e=new b.Squarespace.Tourtip({title:d.title,body:d.body,"align.node":c});d.pulseNavItem&&(b.Lang.isUndefined(c.pulseWarn)&&c.plug(b.Squarespace.Plugin.PulseWarn,{iterations:1,
useClass:!0,targetClass:"warn",interval:2E3}),c.pulseWarn.warn());this._hideAllTips();this._openTips.push(e)}},_hideAllTips:function(){this._openTips.forEach(function(b){b.hide()})}},{CSS_PREFIX:"sqs-checklist",HANDLEBARS_TEMPLATE:"dialog-checklist.html",ATTRS:{allDoneCallback:{validator:b.Squarespace.AttrValidators.isFunction},readOnly:{value:!0},tasks:{required:!0,setter:function(d){b.Array.each(d,function(b,d){b.number=d+1});return d},validator:b.Squarespace.AttrValidators.isArray},tips:{valueFn:function(){var d=
{};b.Array.each(this.get("tasks"),function(b){d[b.task]=b.tip},this);return d},readOnly:!0},tutorialNamePrefix:{required:!0,validator:b.Squarespace.AttrValidators.isString},websiteSettings:{setter:function(d){b.Lang.isValue(d.tutorialsCompleted)||(d.tutorialsCompleted={});return d},valueFn:function(){return b.Object.getValue(Static,["SQUARESPACE_CONTEXT","websiteSettings"])}}}})},"1.0",{requires:["base","squarespace-dialog-checklist-template","squarespace-dialog-field-2","squarespace-dombuilder",
"squarespace-settings-panel"]});
YUI.add("squarespace-dialog-shipping-summary-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-shipping-summary.html"]=b(function(b,c,d,h,k){this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};var l=this.escapeExpression;b='<div class="clearfix">\n  <div class="title">Shipment Summary</div>\n  <div class="header method left">';(h=d.shippingMethod)?h=h.call(c,{hash:{},data:k}):(h=c.shippingMethod,h="function"===typeof h?h.apply(c):
h);b+=l(h)+'</div>\n  <div class="header cost">Est. Cost: ';(h=d.currencySymbol)?h=h.call(c,{hash:{},data:k}):(h=c.currencySymbol,h="function"===typeof h?h.apply(c):h);b+=l(h);(h=d.totalCost)?h=h.call(c,{hash:{},data:k}):(h=c.totalCost,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n  <div class="header weight">Total Weight: ';(h=d.totalWeight)?h=h.call(c,{hash:{},data:k}):(h=c.totalWeight,h="function"===typeof h?h.apply(c):h);b+=l(h)+" ";(h=d.weightUnit)?h=h.call(c,{hash:{},data:k}):(h=c.weightUnit,
h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n  <div class="header efficiency">Packing Efficiency: ';(h=d.efficiency)?h=h.call(c,{hash:{},data:k}):(h=c.efficiency,h="function"===typeof h?h.apply(c):h);b+=l(h)+'</div>\n  <div class="header containers right">Packages: ';(h=d.numContainers)?h=h.call(c,{hash:{},data:k}):(h=c.numContainers,h="function"===typeof h?h.apply(c):h);return b+=l(h)+"</div>\n</div>"})})();b.Handlebars.registerPartial("dialog-shipping-summary.html".replace("/","."),d.templates["dialog-shipping-summary.html"])},
"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-dialog-pricing-placeholder",function(b){b.namespace("Squarespace");var d=b.namespace("Squarespace.DialogFields").PricingPlaceholder=b.Base.create("pricingPlaceholder",b.Squarespace.DialogField2,[],{initializer:function(){},renderUI:function(){d.superclass.renderUI.call(this);this.get("boundingBox").addClass("field-wrapper").addClass("major");this.get("contentBox").one(".placeholder").plug(b.Squarespace.Plugin.PulseWarn,{iterations:1,color:"#C1B12E"});this._edited=!1},bindUI:function(){this.get("contentBox").on("click",
function(){this.fire("clicked")},this);this.after("dataChange",function(){this._edited=!0;this.syncUI()},this)},syncUI:function(){var c={structuredContent:this.get("data")};this.get("contentBox").one(".pricing").setHTML(b.Squarespace.Commerce.priceString(c))},didDataChange:function(){return this._edited},pulseWarn:function(){this.get("contentBox").one(".placeholder").pulseWarn.warn()}},{CSS_PREFIX:"sqs-pricing-placeholder",HANDLEBARS_TEMPLATE:"dialog-pricing-placeholder.html",ATTRS:{strings:{value:{title:"Pricing",
prompt:"Edit"}}}})},"1.0",{requires:"base json squarespace-animations squarespace-commerce-utils squarespace-dialog-field-2 squarespace-dialog-pricing-placeholder-template squarespace-hb-product-types squarespace-hb-product-price-string squarespace-plugin-pulsewarn".split(" ")});
YUI.add("squarespace-dialog-content-selector-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-content-selector.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n      <div class="collection-wrapper ';if((f=d["if"].call(b,b.filter,{hash:{},inverse:A.program(5,q,c),fn:A.program(3,p,c),data:c}))||0===f)e+=f;e+=" ";if((f=d["if"].call(b,b.selected,{hash:{},inverse:A.noop,fn:A.program(7,r,c),data:c}))||0===f)e+=f;e+='" data-url-id="';(f=
d.urlId)?f=f.call(b,{hash:{},data:c}):(f=b.urlId,f=typeof f===O?f.apply(b):f);e+=E(f)+'" data-collection-id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===O?f.apply(b):f);e+=E(f)+'">\n        <div class="collection ';(f=d.className)?f=f.call(b,{hash:{},data:c}):(f=b.className,f=typeof f===O?f.apply(b):f);e+=E(f)+'">\n          <div class="collection-title">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=typeof f===O?f.apply(b):f);e+=E(f)+"</div>\n          ";if((f=d["if"].call(b,
b.filter,{hash:{},inverse:A.noop,fn:A.program(9,s,c),data:c}))||0===f)e+=f;e+="\n\n          ";if((f=d["if"].call(b,b.dropdown,{hash:{},inverse:A.noop,fn:A.program(12,u,c),data:c}))||0===f)e+=f;e+="\n        </div>\n\n        ";if((f=d["if"].call(b,b.dropdown,{hash:{},inverse:A.noop,fn:A.program(14,v,c),data:c}))||0===f)e+=f;return e+"\n      </div>\n    "}function p(b,c){return"has-content-stat-filter"}function q(b,c){return"no-filter"}function r(b,c){return"selected"}function s(b,c){var e,f,h;e=
'\n            <div class="collection-filter">(';h={hash:{compare:"tag"},inverse:A.noop,fn:A.program(10,t,c),data:c};if((h=(f=d.if_eq||b.if_eq,f?f.call(b,(f=b.filter,null==f||!1===f?f:f.type),h):K.call(b,"if_eq",(f=b.filter,null==f||!1===f?f:f.type),h)))||0===h)e+=h;return e+=E((f=(f=b.filter,null==f||!1===f?f:f.name),typeof f===O?f.apply(b):f))+'</div>\n            <div class="right-paren">)</div>\n          '}function t(b,c){return"#"}function u(b,c){return'\n            <div class="dropdown-button"></div>\n          '}
function v(b,c){var e,f;e='\n          <div class="dropdown">\n            ';if((f=d["if"].call(b,b.categories,{hash:{},inverse:A.noop,fn:A.program(15,w,c),data:c}))||0===f)e+=f;e+="\n\n            ";if((f=d["if"].call(b,b.tags,{hash:{},inverse:A.noop,fn:A.program(19,B,c),data:c}))||0===f)e+=f;return e+"\n          </div>\n        "}function w(b,c){var e,f;e='\n              <div class="categories">\n                <div class="icon-title">Choose Category</div>\n                <select>\n                  <option value="none-selected">None</option>\n                  ';
if((f=d.each.call(b,b.categories,{hash:{},inverse:A.noop,fn:A.program(16,y,c),data:c}))||0===f)e+=f;return e+"\n                </select>\n              </div>\n            "}function y(b,c){var e,f;e='\n                    <option value="';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===O?f.apply(b):f);e+=E(f)+'" ';if((f=d["if"].call(b,b.selected,{hash:{},inverse:A.noop,fn:A.program(17,z,c),data:c}))||0===f)e+=f;e+=">";(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===
O?f.apply(b):f);return e+=E(f)+"</option>\n                  "}function z(b,c){return'selected="selected"'}function B(b,c){var e,f;e='\n              <div class="tags">\n                <div class="icon-title">Choose Tag</div>\n                <select>\n                  <option value="none-selected">None</option>\n                  ';if((f=d.each.call(b,b.tags,{hash:{},inverse:A.noop,fn:A.program(16,y,c),data:c}))||0===f)e+=f;return e+"\n                </select>\n              </div>\n            "}
this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var A=this,K=d.helperMissing,O="function",E=this.escapeExpression,F=d.blockHelperMissing;if((h=d.each.call(c,c.collectionGroups,{hash:{},inverse:A.noop,fn:A.program(1,function(b,c){var e,f;e='\n  <div class="collection-group" data-title="';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=typeof f===O?f.apply(b):f);e+=E(f)+'">\n    <div class="collection-group-title">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=
typeof f===O?f.apply(b):f);e+=E(f)+"</div>\n\n    ";if((f=d.each.call(b,b.collectionObjects,{hash:{},inverse:A.noop,fn:A.program(2,l,c),data:c}))||0===f)e+=f;return e+"\n\n  </div>\n"},k),data:k}))||0===h)b+=h;b+="\n\n\n";k={hash:{},inverse:A.program(21,function(b,c){var e,f;e='\n  <div class="empty-message">';(f=d.emptyMessage)?f=f.call(b,{hash:{},data:c}):(f=b.emptyMessage,f=typeof f===O?f.apply(b):f);return e+=E(f)+"</div>\n"},k),fn:A.noop,data:k};(h=d.collectionGroups)?h=h.call(c,k):(h=c.collectionGroups,
h=typeof h===O?h.apply(c):h);d.collectionGroups||(h=F.call(c,h,k));if(h||0===h)b+=h;return b})})();b.Handlebars.registerPartial("dialog-content-selector.html".replace("/","."),d.templates["dialog-content-selector.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-stats-timeline-view",function(b){var d=b.namespace("Squarespace.Stats.Views").Timeline=b.Base.create("statsTimelineView",b.Squarespace.View,[],{initializer:function(){d.superclass.initializer.apply(this,arguments);this.get("model").on("error",this._renderError,this)},render:function(){d.superclass.render.apply(this,arguments);var c=this.get("container"),e=this.get("model");c.setHTML('<div class="timeline-range-graph"></div><div class="timeline-nav"></div><div class="timeline-stack-graph"></div><div class="timeline-highlights"></div><div class="timeline-data-table"></div>');
var f=c.width();this._rangeGraph=new b.Squarespace.Stats.Widgets.TimelineRangeGraph({render:c.one(".timeline-range-graph"),model:e,width:f});this._stackGraph=new b.Squarespace.Stats.Widgets.TimelineStackGraph({render:c.one(".timeline-stack-graph"),model:e,rangeGraph:this._rangeGraph,width:f});this._dataTable=new b.Squarespace.Stats.Widgets.TimelineDataTable({render:c.one(".timeline-data-table"),stackGraph:this._stackGraph,width:f,model:e});this._navigation=new b.Squarespace.Stats.Widgets.TimelineNav({render:c.one(".timeline-nav"),
stackGraph:this._stackGraph,model:e,width:f});this._rangeGraph.set("nav",this._navigation);this._stackGraph.set("dataTable",this._dataTable);e.loadTotals()},_renderError:function(){console.warn("Error loading data.")}},{ATTRS:{model:{value:new b.Squarespace.Stats.Models.Timeline}}})},"1.0",{requires:"base-build squarespace-view squarespace-stats-timeline-model squarespace-stats-timeline-nav squarespace-stats-timeline-range-graph squarespace-stats-timeline-stack-graph squarespace-stats-timeline-data-table thirdparty-d3".split(" ")});
YUI.add("squarespace-settings-activity-subscribers",function(b){b.namespace("Squarespace.Settings.Activity");var d=b.Squarespace.Settings.Activity.Subscribers=b.Base.create("ActivityManagerSubscribers",b.Squarespace.Settings.Activity.BaseManager,[],{bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").delegate("click",this._blogClicked,".sqs-sub-tab",this);this.after("activeBlogChange",this._showNewBlogTab,this)},syncUI:function(){var b=this.get("data");this.clearElements();null!==
b&&(b&&b.blogs&&this._renderBlogTabHolder(b.blogs),this._hasDataErrors(b)||this._isDataEmpty(b)?this._renderEmptyOrError(b):this._renderSuccess(b))},destructor:function(){this._barTable&&this._barTable.destroy()},_isDataEmpty:function(b){this.get("activeTab");var d=this._getLabelFromId(this.get("activeBlog"));return!b||!b.blogs||!b.blogs[d]||!b.blogs[d].trafficBySegment||0===b.blogs[d].trafficBySegment.length},_renderSuccess:function(c){if(this._isDataEmpty(c)||c.error)this._renderError(c);else{this.get("contentBox");
var d=this.get("activeBlog"),d=this._getLabelFromId(d),f=this.get("activeTab"),g=this.get("contentBody"),h=b.Node.create('<div class="sub-details clear"></div>'),k=b.Node.create('<div class="detail overview"></div>'),l=b.Node.create('<div class="table"></div>'),p=b.Node.create('<div class="chart-container clear line">'),q=b.Node.create('<div class="details-description">'+this.get("strings.description")+"</div>"),r=new b.Squarespace.BarTable({data:c.blogs[d].trafficBySegment.reverse(),key:"timePeriodShort",
values:["subs"],valueNameMap:{subs:"subscribers"}});r.render(l);this._barTable=r;r=b.Node.create('<div class="analyses"></div>');0<c.blogs[d].trafficBySegment.length&&r.append(this.renderAnalysis("Feed Readers",c.blogs[d],"bot",!1));k.append(l);h.append(k).append(r);g.append(p).append(q).append(h);this.renderSubscribersChart(c.blogs[d],p,f)}},_renderBlogTabHolder:function(c){var d=this.get("contentBody"),f=[{key:"all",label:"All"}];b.Object.each(c,function(b,c){"all"!==c.toLowerCase()&&f.push({label:c,
key:this._getIdFromLabel(c)})},this);f.sort(function(b,c){return b.label>c.label?1:-1});this.set("blogs",f);d.append(this._renderBlogSubscriberTabs(f))},_blogClicked:function(c){c=c.currentTarget;!c.hasClass("active")&&b.Lang.isValue(c.getData("key"))&&this._enableBlogTab(c)},_showNewBlogTab:function(b){this.get("rendered")&&this.syncUI()},_enableBlogTab:function(b){this.set("activeBlog",b.getData("key"))},_renderBlogSubscriberTabs:function(c){this._blogTabHolderEl=b.Node.create('<div class="settings-filters sub-tabs blogs tabs">');
b.Array.each(c,this._addBlogTabEl,this);return this._blogTabHolderEl},_addBlogTabEl:function(c,d){var f=b.Node.create('<div class="sqs-tab filter view-tab blog sqs-sub-tab" id ="tab-'+c.key+'"><div class="sqs-tab-content"><a>'+c.label+"</a></div></div>");f.setData({key:c.key});c.key===this.get("activeBlog")&&f.addClass("active");this._blogTabHolderEl.append(f)},renderSubscribersChart:function(c,d,f){if(0===c.trafficBySegment.length)d.append(this.renderNoData());else{var g={font:"Helvetica Neue","font-size":"10px",
fill:"#a3a3a3"},h={"letter-spacing":"1px",font:"Helvetica Neue","font-weight":700,"font-size":"7px",fill:"#fff"},k={targetContainer:b.Node.getDOMNode(d),gridColor:"#e9e9e9",width:716,height:235,animate:!0,yAxisLabelStyle:g,labelFunc:function(b,c,d,e){var f=b.text(c,d-2,e.text).attr(g).toBack();e.image&&b.image(e.image,c-10,d+f.getBBox().height-2,20,15);e.subText&&(d=d+f.getBBox().height+2,c=b.text(c,d+3,e.subText).attr(h).getBBox(),b.rect(c.x-2,c.y-3,c.width+4,c.height+6).attr({stroke:"#c6c6c6",fill:"#c6c6c6"}).toBack())},
labels:[],lines:[]},l={title:"Subscribers",fillStyle:{fill:"#c4c4c4",opacity:0.4},lineStyle:{stroke:"#222222","stroke-width":2,"stroke-linejoin":"round"},dotStyle:{fill:"#fff",stroke:"#333"},data:[]};k.lines=[l];var p="";c=c.trafficBySegment.reverse();b.Array.each(c,function(b,c){var d=this.formatShortDate(b,f),e={toString:function(){return this.flyout},text:d.primary,flyout:b.timePeriodShort},d=d.secondary.toUpperCase();d!==p&&(p=e.subText=d);k.labels.push(e);l.data.push(b.subs)},this);new b.Squarespace.Graphing.LineChart(k)}},
_getIdFromLabel:function(c){var d=this.get("blogs");return b.Lang.isArray(d)&&0<d.length&&(d=b.Array.find(d,function(b){return b.label===c||b.key===c},this))?d.key:c.replace("/","").replace(/ /g,"-").toLowerCase()},_getLabelFromId:function(c){var d=this.get("blogs");return!(b.Lang.isArray(d)&&0<d.length)?c:b.Array.find(d,function(b){return c===b.key},this).label}},{CSS_PREFIX:"sqs-activity-manager-subscribers",ATTRS:{activeTab:{value:"week"},activeBlog:{value:"all",getter:function(c){return b.Array.some(this.get("blogs"),
function(b){return b.key===c||b.label===c})?c:"all"}},blogs:{value:[],validator:b.Lang.isArray},requestParams:{getter:function(){return{name:"subscriber",segmentName:this.get("activeTab"),verbose:"true"}}},strings:{value:{title:"Subscribers",description:"Subscribers is an estimate of the number of unique active subscribers you have for each RSS feed on your site.&nbsp;&nbsp;Squarespace attempts to count individual subscriber requests as well as requests from popular news readers."}},tabs:{value:[{label:"Daily",
key:"month"},{label:"Weekly",key:"week"},{label:"Monthly",key:"year"}]}}})},"1.0",{requires:["base","squarespace-graphing","squarespace-settings-activity-base-manager"]});
YUI.add("squarespace-widgets-newsletters-subscriber",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.NewslettersSubscriber=b.Base.create("NewslettersSubscriber",b.Squarespace.Widgets.Model,[b.Squarespace.Mixins.EditableModel],{initializer:function(){this._selector=new b.Squarespace.DialogFields.Check({name:"subscriberSelector",data:0!==this.get("selected"),className:"dark"})},destructor:function(){this._selector.destroy()},renderUI:function(){d.superclass.renderUI.call(this);
this._selector.render(this.get("contentBox").one(".subscriber-selector"))},bindUI:function(){d.superclass.bindUI.call(this);var b=this._selector;this.after("selectedChange",function(d){b.set("data",0!==d.newVal,{silent:!0})});b.after("dataChange",function(b){b.silent||this.set("selected",b.newVal?1:0)},this)}},{CSS_PREFIX:"sqs-newsletters-subscriber",HANDLEBARS_TEMPLATE:"widgets-newsletters-subscriber.html"})},"1.0",{requires:"base squarespace-commerce-utils squarespace-date-utils squarespace-dialog-check squarespace-enum squarespace-mixins-editable-model squarespace-util squarespace-widgets-model squarespace-widgets-newsletters-subscriber-template".split(" ")});
YUI.add("squarespace-dialog-shipstation-connect",function(b){b.Squarespace.DialogFields.ShipStationConnect=b.Base.create("shipStationConnect",b.Squarespace.DialogField2,[],{bindUI:function(){b.Squarespace.DialogFields.ShipStationConnect.superclass.bindUI.call(this);var d=this.get("contentBox");this.on("websiteSettingsChange",this.syncUI,this);d.one(".configure-button").on("click",this._configureShipStation,this);d.one(".disconnect-button").on("click",function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Disconnect",
"strings.message":"Are you sure you want to disconnect ShipStation? ShipStation will no longer receive orders or notify Squarespace of shipments."})).on("confirm",this._disconnectShipStation,this)},this)},syncUI:function(){b.Squarespace.DialogFields.ShipStationConnect.superclass.syncUI.call(this);this.get("websiteSettings").load(b.bind(function(){var d=this.get("contentBox"),c=d.one(".connection-info"),e=d.one(".links"),f=d.one(".title"),g=d.one(".configure-button"),h=d.one(".disconnect-button");
b.Lang.isValue(this.get("isPasswordConfigured"))?d.one(".password .value").setContent("***********"):d.one(".password .value").setContent("Not Configured");b.Lang.isValue(this.get("whenLastSynced"))?d.one(".last-synced .value").setContent(b.Squarespace.DateUtils.humanizeDate(this.get("whenLastSynced"))):d.one(".last-synced .value").setContent("Never");b.Lang.isValue(this.get("whenLastNotified"))?d.one(".last-notified .value").setContent(b.Squarespace.DateUtils.humanizeDate(this.get("whenLastNotified"))):
d.one(".last-notified .value").setContent("Never");this.get("isPasswordConfigured")?(c.show(),e.hide(),f.setContent("ShipStation Connected"),g.setContent("Reset Connection"),h.show()):(c.hide(),e.show(),f.setContent("Connect ShipStation to Print Shipping Labels"),g.setContent("Connect ShipStation"),h.hide());this.get("isIncompleteConnection")&&f.setContent("ShipStation Not Connected");this.fire("isIncompleteConnectionChange")},this))},showUpgradeLock:function(){var d=this.get("boundingBox");d.addClass("upgrade-locked");
new b.Squarespace.ToolTip({target:".sqs-shipstation-connect",title:"Upgrade to Connect",body:"You must be on the Business Plan to connect with ShipStation.",showTimeout:250});d.on("click",function(){(new b.Squarespace.Widgets.Confirmation({"strings.cancel":"Not Now","strings.confirm":"Go to Upgrade","strings.title":"Do you want to upgrade?","strings.message":"Upgrading to the Business Plan will enable this feature."})).on("confirm",CONFIG_PANEL.goToUpgrade)},this)},_disconnectShipStation:function(){b.Data.del({url:"/api/settings/store-settings/shipstation/password",
success:function(){window.location.reload()}})},_configureShipStation:function(){var d=b.bind(function(){var c=b.Squarespace.Utils.getRandomAlphanumericString(10);this._saveNewPassword(c,b.bind(function(){this.get("websiteSettings").load(b.bind(function(){this._showConfigureConnectionDialog(c)},this))},this))},this);if(this.get("isPasswordConfigured"))(new b.Squarespace.Widgets.Confirmation({"strings.title":"Reset Connection","strings.message":"You are about to reset the password that ShipStation uses to connect to Squarespace. Are you sure you want to continue?"})).on("confirm",
d);else d()},_showConfigureConnectionDialog:function(d){var c=new b.Squarespace.EditingDialog({name:"configureShipStation",title:"Connect ShipStation",style:"minimal",width:500,height:415,overlay:0.5,discardChangesConfirmation:!1,closeOthers:!1,buttons:[{type:"next",title:"Next"},{type:"saveAndClose",title:"Connect"}],primaryTabs:[{title:"Connect ShipStation",tabTitle:"Step One",name:"step-one",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Create a ShipStation Account and Log In",
text:'ShipStation simplifies your shipping operations by enabling you to purchase and print shipping labels from all major carriers in batch. ShipStation offers a free trial account for 30 days. Plans start at $25 per month.<br /><div class="create-account"><a target="_blank" href="http://www.shipstation.com/squarespace_pricing/?utm_source=SQSP&utm_medium=app&utm_campaign=app_link2&ref=SQSP">Create a ShipStation Account &rarr;</a><br /><a target="_blank" href="http://app.shipstation.com?utm_source=SQSP&utm_medium=app&utm_campaign=app_link3&ref=SQSP">Log In to ShipStation &rarr;</a></div>Once you have logged in, click "Next" to continue connecting ShipStation with Squarespace.'}}]}],
secondaryTabs:[{tabTitle:"Step Two",name:"step-two",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:'Enter ShipStation "Settings" > "Stores"',text:'Manage your account\'s connected stores. To go directly there <a target="_blank" href="https://app.shipstation.com/settings/stores">click here &rarr;</a>'}},{ctor:b.Squarespace.DialogFields.HTML,config:{content:'<div class="help"><img src="/universal/images-v6/welcome/shipstation/shipstation_stores.png" /></div>'}},{ctor:b.Squarespace.DialogFields.Description,
config:{title:'Click "Add a New Store"',text:"Then, add Squarespace as a connected Marketplace."}},{ctor:b.Squarespace.DialogFields.HTML,config:{content:'<div class="help"><img src="/universal/images-v6/welcome/shipstation/shipstation_add.png" /></div>'}}]},{tabTitle:"Step Three",name:"step-three",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Enter Connection Information within ShipStation",text:'After choosing "Squarespace", copy and paste the username and password below into the prompt. ShipStation will then be able to access your orders and send shipping notifications via Squarespace to your customers.'}},
{ctor:b.Squarespace.DialogFields.Text,config:{name:"username","strings.title":"Squarespace Domain","strings.description":"Copy this into the Squarespace configuration in ShipStation.",className:"thin copy-paste",readOnly:!0,selectAllOnFocus:!0,data:this.get("siteIdentifier")}},{ctor:b.Squarespace.DialogFields.Text,width:0.5,config:{name:"password","strings.title":"Generated Password","strings.description":"Copy this into the Squarespace configuration in ShipStation. This generated password enables ShipStation to access your Squarespace store to retrieve orders and shipment notifications.",
readOnly:!0,selectAllOnFocus:!0,className:"thin copy-paste",data:this.get("websiteSettings").get("storeSettings").shipStationConnectionSettings.password}}]}]});c.after("shown",function(){c.getField("password").set("data",d)},this);c.on("button-next",function(){c.activateTab(null,c.params.tabs[c.currentTabIndex+1])},this);c.on("tab-focused",function(b){"step-three"==b.tabName?c.setButtons([{type:"saveAndClose",title:"Connect"}]):c.setButtons([{type:"next",title:"Next"}])},this);c.on("send-requested",
function(){c.getField("password");var d=new b.Squarespace.Widgets.Confirmation({"strings.title":"Confirm Connection","strings.message":'Have you finished copying and pasting your username and password into ShipStation and saved your changes? If so, click "Confirm" to complete the connection.'});d.on("confirm",function(){c.close();this.syncUI()},this);d.on("cancel",function(){c.hideSaveOverlay()})},this);c.show()},_saveNewPassword:function(d,c){b.Data.put({url:"/api/settings/store-settings/shipstation/password",
data:{password:d},success:c})}},{CSS_PREFIX:"sqs-shipstation-connect",HANDLEBARS_TEMPLATE:"dialog-shipstation-connect.html",ATTRS:{siteIdentifier:{validator:b.Squarespace.AttrValidators.isString,writeOnce:"initOnly"},isIncompleteConnection:{getter:function(){return this.get("isPasswordConfigured")&&!b.Lang.isValue(this.get("whenLastSynced"))}},isPasswordConfigured:{getter:function(){return this.get("websiteSettings").get("storeSettings").shipStationConnectionSettings.passwordConfigured}},whenLastSynced:{getter:function(){return this.get("websiteSettings").get("storeSettings").shipStationConnectionSettings.lastSynced}},
whenLastNotified:{getter:function(){return this.get("websiteSettings").get("storeSettings").shipStationConnectionSettings.lastShipNotified}},websiteSettings:{writeOnce:!0,setter:function(d){return d instanceof b.Squarespace.Models.WebsiteSettings?d:new b.Squarespace.Models.WebsiteSettings(d)}}}})},"1.0",{requires:"base squarespace-enum squarespace-util squarespace-date-utils squarespace-dialog-field-2 squarespace-attr-validators squarespace-dialog-button squarespace-dialog-text squarespace-dialog-description squarespace-models-website-settings squarespace-dialog-shipstation-connect-template squarespace-dialog-shipstation-connect-css squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-dialog-external-member-account-descriptor",function(b){b.namespace("Squarespace.DialogFields").ExternalMemberAccountDescriptor=b.Base.create("ExternalMemberAccountDescriptor",b.Squarespace.DialogField2,[],{renderUI:function(){var d=this.get("data"),c=d.externalId.split("_")[0],e=this.get("contentBox");e.addClass("network-"+c);b.Lang.isValue(d.avatarUrl)?e.append('<img class="member-image" src="'+d.avatarUrl+'" />'):e.append('<div class="member-image-default"></div>');e.appendChild('<div class="member-info"></div>').append('<div class="member-description">Connected via '+
c.capitalize()+' as <span class="member-name">'+b.Escape.html(d.displayName)+"</div>")}},{CSS_PREFIX:"sqs-external-member-account-descriptor",ATTRS:{height:{value:52},readOnly:{value:!0}}})},"1.0",{requires:["squarespace-dialog-field-2"]});
YUI.add("squarespace-line-graph",function(b){function d(b){d.superclass.constructor.apply(this,arguments)}b.namespace("Squarespace");b.Squarespace.LineGraph=b.Base.create("lineGraph",b.Squarespace.DataBackedWidget,[],{renderUI:function(){this.buildScales();this.buildLineGenerators();this.get("showGraphHandles")&&this.buildHandleGenerators();this.renderGraph()},renderGraph:function(){var b=d3.select(this.get("contentBox").getDOMNode()).select(".graph");this.get("xScale");this.get("yScale");b.empty()&&
(b=this.initializeGraph());this.renderRules(b);this.renderAxes(b);this.renderLines(b);this.get("showGraphHandles")&&this.renderHandles(b)},initializeGraph:function(){return d3.select(this.get("contentBox").getDOMNode()).append("svg:svg").attr("width",this.get("width")).attr("height",this.get("height")).append("svg:g").attr("class","graph").attr("width",this.get("graphWidth")).attr("height",this.get("graphHeight")).attr("transform","translate("+this.get("padding")+","+this.get("padding")+")")},updateGraph:function(b){},
renderRules:function(b){var d=this.get("xScale"),f=this.get("yScale"),g=this.get("graphWidth"),h=this.get("graphHeight"),k=this.get("numHorizontalGridLines"),l=this.get("numVerticalGridLines");b.selectAll(".verticalRule").data(d.ticks(l)).enter().append("svg:line").attr("class","verticalRule").attr("x1",d).attr("x2",d).attr("y1",0).attr("y2",h);b.selectAll(".horizontalRule").data(f.ticks(k)).enter().append("svg:line").attr("class","horizontalRule").attr("x1",0).attr("x2",g).attr("y1",f).attr("y2",
f)},renderLabels:function(b){},renderAxes:function(b){b.append("svg:g").attr("class","y-axis").call(this.get("yAxis"));b.append("svg:g").attr("class","x-axis").attr("transform","translate(0,"+this.get("graphHeight")+")").call(this.get("xAxis"))},renderLines:function(c){var d=this.get("lineGenerators"),f=this.get("flatLineGenerator"),g=this.get("data"),h=this.get("lineAnimDelay"),k=this.get("lineAnimDuration");b.Object.each(d,function(b,d){c.append("svg:path").data(g).attr("class","line-"+d).attr("fill",
"none").attr("stroke","black").attr("d",f(g)).transition().delay(h).duration(k).attr("d",b(g))},this)},renderHandles:function(c){var d=this.get("handleHeightGenerators"),f=this.get("data"),g=this.get("xScale"),h=this.get("key"),k=this.get("handleAnimDelay"),l=this.get("handleAnimDuration"),p=this.get("graphHeight");b.Object.each(d,function(b,d){c.selectAll(".circle-"+d).data(f).enter().append("svg:circle").attr("class","circle-"+d).attr("r",4).attr("stroke","black").attr("fill","white").attr("cy",
p).attr("cx",function(b){return g(b[h])}).transition().delay(k).duration(l).attr("cy",function(c){return b(c)})},this)},buildScales:function(){this.buildXScale();this.buildYScale()},buildLineGenerators:function(){var b=this.get("lineGenerators"),d=this.get("lineInterpolator"),f=this.get("xScale"),g=this.get("yScale"),h=this.get("graphHeight"),k=this.get("values"),l=this.get("key");this.set("flatLineGenerator",d3.svg.line().x(function(b){return f(b[l])}).y(h).interpolate(d));k.forEach(function(k){this.isArea(k)?
b[k]=d3.svg.area().x(function(b){return f(b[l])}).y0(h).y1(function(b){return g(b[k])}).interpolate(d):b[k]=d3.svg.line().x(function(b){return f(b[l])}).y(function(b){return g(b[k])}).interpolate(d)},this)},isArea:function(b){return!1},buildHandleGenerators:function(){var b=this.get("handleHeightGenerators"),d=this.get("yScale");this.get("values").forEach(function(f){b[f]=function(b){return d(b[f])}})},bindUI:function(){this.after("dataChange",this.onDataChange,this)},onDataChange:function(){this.renderUI()}},
{ATTRS:{width:{value:500},height:{value:500},graphWidth:{readOnly:!0,getter:function(){return this.get("width")-2*this.get("padding")}},graphHeight:{readOnly:!0,getter:function(){return this.get("height")-2*this.get("padding")}},yLabel:{value:"",setter:function(b){return b+""}},xLabel:{value:"",setter:function(b){return b+""}},title:{value:""},padding:{value:50,readOnly:!0},lineAnimDelay:{value:600,validator:function(b){return 0<=b}},lineAnimDuration:{value:600,validator:function(b){return 0<=b}},
lineInterpolator:{value:"monotone",readOnly:!0},lineGenerators:{value:{},readOnly:!0},flatLineGenerator:{readOnly:!0},handleHeightGenerators:{value:{},readOnly:!0},showGraphHandles:{value:!0,setter:function(b){return!!b}},handleAnimDelay:{value:600,validator:function(b){return 0<=b}},handleAnimDuration:{value:600,validator:function(b){return 0<=b}},numVerticalGridLines:{value:8,readOnly:!0},numHorizontalGridLines:{value:10,readOnly:!0}}});d.NAME="timeScale";d.NS="scale";d.ATTRS={format:{value:"%b %d",
validator:b.Lang.isString},origin:{value:"left",validator:b.Lang.isString}};b.extend(d,b.Plugin.Base,{initializer:function(b){this.doBefore("buildXScale",this._buildXScale)},parseDates:function(){var b=this.get("host"),d=b.get("data"),f=b.get("key"),g=d3.time.format(this.get("format")).parse;d.forEach(function(b){b[f]=g(b[f])})},_buildXScale:function(){var c=this.get("host"),d=this.get("format"),f=c.get("data");c.get("graphHeight");var g=c.get("graphWidth"),h=c.get("key");b.Lang.isString(f[0][h])&&
this.parseDates();"left"===this.get("origin")?c.set("xScale",d3.time.scale().range([0,g]).domain([f[0][h],f[f.length-1][h]])):c.set("xScale",d3.time.scale().range([g,0]).domain([f[0][h],f[f.length-1][h]]));c.set("xAxis",d3.svg.axis().scale(c.get("xScale")).tickSize(1).tickPadding(4).tickSubdivide(!0).tickFormat(d3.time.format(d)));return new b.Do.Halt}});b.Squarespace.TimeScale=d},"1.0",{requires:["squarespace-data-backed-widget","plugin"]});
YUI.add("squarespace-dialog-item-push",function(b){b.namespace("Squarespace.DialogFields").ItemPush=b.Base.create("itemPushDialogField",b.Squarespace.DialogField2,[],{initializer:function(b){this._widgets=[]},destructor:function(){b.Array.each(this._widgets,function(d){b.Object.each(d,function(c,d){b.Lang.isValue(c)&&c.destroy()})})},_isPushable:function(d){return b.Squarespace.ConnectedAccountCapabilities.can(d,b.Squarespace.ConnectedAccountCapabilities.PUSH)},_addEmptyMessage:function(){var b=this.get("contentBox");
Static.IN_BACKEND?(b.append('<div class="instructions"><p>You do not have any accounts connected to your site configured for pushing content. Press the button below to connect an account.<p><p><div class="add-account"><a>Connect Account</a></div><p></div>'),b.one(".add-account").on("click",this._onAddAccountClick,this)):b.append('<div class="instructions"><p>You do not have any accounts connected to your site configured for pushing content. Go to your site management page to add an account.</p></div>')},
_onAddAccountClick:function(){var d=(new b.Squarespace.Widgets.Confirmation({showOverlay:!0,"strings.title":"Add Account","strings.message":"All unsaved changes to this item will be lost. Are you sure you want to leave?"})).on("confirm",function(){d.once("hide",function(){this.get("dialog").params.discardChangesConfirmation=!1;this._guideToConnectedAccounts()},this)},this)},_guideToConnectedAccounts:function(){"undefined"!==typeof CONFIG_PANEL&&CONFIG_PANEL.getHistory().replace({module:"settings",
"settings-subpanelName":"social-account-settings"});this.get("dialog").close()},show:function(){if(!this._shownOnce){this._shownOnce=!0;var d=this.get("models").filter(this._isPushable);d.length?b.Array.each(d,this._renderAccount,this):this._addEmptyMessage()}},bindUI:function(){this.get("contentBox").delegate("click",this._hidePushedMessage,".already-pushed-msg",this)},_hidePushedMessage:function(d){d=d.target.ancestor(".account",!0);var c=d.one(".sqs-toggle-button");(c=b.Widget.getByNode(c))&&c.set("active",
!0);d.removeClass("pushed")},_renderAccount:function(d){var c=this.get("contentBox").appendChild('<div class="account"></div>'),e=d.get("hash"),f=this.get("pushedServices")[e],g=this.get("pendingPushedServices")[e],h=b.Array.some(this._initialData,function(b){return b.connectedAccountId===d.get("id")&&b.pushEnabled})&&!f&&!(this.get("published")&&g),e=new b.Squarespace.Widgets.ConnectedAccount({model:d,editable:!1});e.render(c);var k=new b.Squarespace.Widgets.ToggleButton;k.after("activeChange",function(){"tumblr"!==
d.get("serviceName")&&c.toggleClass("pushing",k.get("active"))});k.render(c);this.get("published")&&g?(c.addClass("pushed").addClass("pushing"),c.one(".sqs-toggle-button").insert('<div class="pending-push-msg"><div class="title">Content Push Pending</div><div class="msg">This content is being sent to <span class="service-name">'+d.get("serviceName")+"</span>.</div></div>","after")):f&&(c.addClass("pushed").addClass("pushing"),c.one(".sqs-toggle-button").insert('<div class="already-pushed-msg"><div class="title">Content Already Pushed</div><div class="msg">This content has already been sent to <span class="service-name">'+
d.get("serviceName")+"</span>.  Click to re-send.</div></div>","after"));k.set("active",h);f=null;"tumblr"===d.get("serviceName")?c.appendChild('<div class="desc">Content will be pushed to Tumblr in its entirety. No post format is needed.</div>'):(f=c.appendChild('<div class="format" type="text" spellcheck="false"><div class="structured-input"></div></div>'),g=b.Array.find(this._initialData,function(b){return b.connectedAccountId===d.get("id")}),f=new b.Squarespace.Widgets.StructuredInput({render:f.one(".structured-input"),
value:g?g.message:d.get("defaultPushMessage"),variables:{"%a":{title:"Author",tip:"The author of this post."},"%t":{title:"Title",tip:"The title of this post."},"%u":{title:"URL",tip:"The URL to this post."}}}));this._widgets.push({account:e,toggle:k,format:f})}},{CSS_PREFIX:"sqs-dialog-item-push",ATTRS:{data:{getter:function(){return!this._shownOnce?this._initialData||[]:b.Array.map(this._widgets,function(b){var c=b.account.get("model");return{message:b.format&&b.format.get("value"),connectedAccountId:c.get("id"),
pushEnabled:b.toggle.get("active")}})}},pushedServices:{value:{}},pendingPushedServices:{value:{}},models:{valueFn:function(){return new b.Squarespace.Models.ConnectedAccounts}},published:{value:!1}}})},"1.0",{requires:"base squarespace-connected-account-widget squarespace-dialog-field-2 squarespace-toggle squarespace-structured-input squarespace-connected-account-capabilities squarespace-models-connected-accounts squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-autocomplete-types",function(b){b.namespace("Squarespace.Constants").AutocompleteTypes={GIVEN_NAME:"given-name",FAMILY_NAME:"family-name",CITY:"city",STATE:"state",POSTAL_CODE:"postal-code",COUNTRY_NAME:"country-name",CC_FULL_NAME:"cc-full-name",CC_NUMBER:"cc-number",CC_EXP_MOTNH:"cc-exp-month",CC_EXP_YEAR:"cc-exp-year",CC_CSC:"cc-csc"};b.Squarespace.AutocompleteTypeATTR={value:null,writeOnce:"initOnly",validator:function(d){if(b.Lang.isNull(d)||b.Object.hasValue(b.Squarespace.Constants.AutocompleteTypes,
d))return!0;console.warn(this.name+": That constant is not an available autocomplete type.");return!1}}},"1.0");
YUI.add("squarespace-widgets-order-list-header",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.OrderListHeader=b.Base.create("OrderListHeader",b.Squarespace.Widgets.ModelListHeader,[],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-header-content");var c=this.get("models");c.after("searchQueryChange",function(b){b.fromTabSync||c.firstPage()},this);this._paginator=new b.Squarespace.Widgets.ModelListPaginator({models:c});this._search=new b.Squarespace.Widgets.ModelListSearch({models:c,
"strings.placeholder":this._getSearchPlaceholderForState(this.get("currentTab").orderState)})},destructor:function(){this._paginator.destroy();this._search.destroy()},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox").one(".header-controls"),e=this._paginator;e.hide();e.render(b);e=this._search;e.hide();e.render(b)},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("models");b.after("searchQueryChange",function(){b.firstPage()},this)},_syncCurrentTab:function(){d.superclass._syncCurrentTab.call(this);
var c=this.get("models"),e=this.get("currentTab").orderState,f;f=e===b.Squarespace.OrderStates.PENDING?b.Squarespace.OrderDirection.ASCENDING:b.Squarespace.OrderDirection.DESCENDING;var g=this._getSearchPlaceholderForState(this.get("currentTab").orderState);this._search.set("strings.placeholder",g);c.get("paginator").set("orderDirection",f);c.set("state",e);e=c.get("searchQuery");b.Lang.isValue(e)&&""!==e&&c.set("searchQuery",null,{fromTabSync:!0});c.firstPage()},_updateControlsVisibility:function(){var c=
this.get("models"),d=this._paginator;!c.get("hasPreviousPage")&&!c.get("hasNextPage")?d.hide():d.show();var d=this._search,f=c.get("searchQuery"),f=b.Lang.isValue(f)&&""!==f;c.isEmpty()&&!f?d.hide():d.show()},_getSearchPlaceholderForState:function(c){if(c===b.Squarespace.OrderStates.PENDING)c="pending";else if(c==b.Squarespace.OrderStates.SHIPPED)c="shipped";else if(c==b.Squarespace.OrderStates.CANCELLED)c="cancelled";else throw"Invalid Order State provided";return b.Lang.sub("Search {stateLabel} orders by order #, email, or name",
{stateLabel:c})},_clearTestOrders:function(){(new b.Squarespace.Widgets.Confirmation({"strings.title":"Clear Test Orders","strings.message":"This will permanently remove all test orders."})).on("confirm",function(){var c=b.bind(function(){this.get("models").firstPage()},this);b.Squarespace.Models.OrderList.deleteAllTestOrders(c)},this)},_exportToCSV:function(){var c=b.Squarespace.OrderCSVExportDialog.create();c.show();c.getField("startDateInput").temporaryHide(!0);c.getField("endDateInput").temporaryHide(!0)}},
{CSS_PREFIX:"sqs-order-list-header",ATTRS:{tabs:{value:[{name:"pending",orderState:b.Squarespace.OrderStates.PENDING,title:"Pending",description:"Here, you can view orders that have recently been placed on your site. Once you have marked these orders as completed, they will be moved to the completed tab."},{name:"completed",orderState:b.Squarespace.OrderStates.SHIPPED,title:"Completed",description:"You have marked these orders as completed. You can use this tab to re-open these orders or re-send order related emails."},
{name:"cancelled",orderState:b.Squarespace.OrderStates.CANCELLED,title:"Cancelled",description:"You have marked these orders as cancelled."}]},actionButtons:{valueFn:function(){return[{name:"clearTestOrders",label:"Clear Test Orders",action:b.bind(this._clearTestOrders,this)},{name:"exportToCSV",label:"Export All Orders to CSV",action:b.bind(this._exportToCSV,this)}]}},strings:{value:{title:"Orders"}}}})},"1.0",{requires:"base squarespace-enum squarespace-models-order-list squarespace-order-csv-export-dialog squarespace-util squarespace-widgets-model-list-header squarespace-widgets-model-list-paginator squarespace-widgets-model-list-search squarespace-widgets-confirmation".split(" ")});
YUI.add("squarespace-block-horizontal-rule-editor-email",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.HorizontalRuleEmail=b.Base.create("blockHorizontalRuleEditorEmail",b.Squarespace.Block.Editor.HorizontalRule,[],{initializer:function(){this.get("host").set("floatable",!1)}},{NS:"blockEditor",ATTRS:{minHSize:{value:2}}})},"1.0",{requires:["base","squarespace-block-horizontal-rule-editor"]});
YUI.add("squarespace-plugin-progress-bar",function(b){b.namespace("Squarespace.Plugin");var d=b.Squarespace.Plugin.ProgressBar=b.Base.create("ProgressBar",b.Squarespace.Plugin.ProgressBase,[],{_renderContent:function(){d.superclass._renderContent.call(this);this._syncProgressBar()},_bindAttributeChanges:function(){d.superclass._bindAttributeChanges.call(this);this.after("progressChange",this._syncProgressBar,this)},_syncProgressBar:function(){var b=this._meterEl.one(".bar-inner"),d=this.get("progress"),
d=Math.max(0,Math.min(100,0+d));b.setStyle("width",d+"%")}},{NS:"progress",PROGRESS_METER_TEMPLATE:'<div class="bar"><div class="bar-inner"></div></div>',ATTRS:{progress:{value:0,validator:function(c,d){return b.Lang.isNumber(c)&&0<=c&&100>=c}}}})},"1.0",{requires:["base","squarespace-plugin-progress-base"]});
YUI.add("squarespace-models-domain",function(b){var d=b.Base.create("domain",b.Model,[b.Squarespace.ModelSync.REST],{url:b.Squarespace.REST_API_ROOT+"domains/{id}",root:b.Squarespace.REST_API_ROOT+"domains",getUnlockKey:function(){return new b.Promise(b.bind(function(c,d){b.Data.get({url:this.getURL("update")+"/unlock-key",success:function(b){c(b.key)},failure:d},this)},this))}},{ATTRS:{websiteId:{validator:b.Lang.isString},applicationSupplied:{value:!1,validator:b.Lang.isBoolean},dnsActive:{value:!1,
validator:b.Lang.isBoolean},googleDnsActive:{value:!1,validator:b.Lang.isBoolean},managed:{value:!1,validator:b.Lang.isBoolean},revokable:{value:!1,validator:b.Lang.isBoolean},withinPropagationWindow:{value:!1,validator:b.Lang.isBoolean},id:{validator:b.Lang.isString},name:{validator:b.Lang.isString}}});b.namespace("Squarespace.Models").Domain=d},"1.0",{requires:["base","model","promise","squarespace-model-sync-rest","squarespace-util"]});
YUI.add("squarespace-dialog-developer-registration",function(b){var d=b.Base.create("DeveloperRegistration",b.Squarespace.DialogField2,[],{bindUI:function(){this.get("contentBox").delegate("click",function(b){b.halt();this._edit()},"a.signup, a.edit",this);var b=this.get("data");this._registerEvent(b.after("developerAccountMarketingDetailsChange",this.syncUI,this))},syncUI:function(){this.get("contentBox").setContent(this.renderTemplate())},_edit:function(){var c=this.get("data");b.Squarespace.Singletons.DeveloperRegistrar.register(c)},
_getHBTemplateContext:function(){var c=this.get("data"),d=c.get("developerAccountMarketingDetails");return{isDeveloperWithMarketingDetails:c.get("developerAccount")&&b.Lang.isObject(d),marketingData:d}}},{CSS_PREFIX:"sqs-dialog-developer-registration",HANDLEBARS_TEMPLATE:"dialog-developer-registration.html",ATTRS:{readOnly:{value:!0},preventRenderTemplate:{value:!0}}});b.namespace("Squarespace.DialogFields").DeveloperRegistration=d},"1.0",{requires:["base","squarespace-dialog-field-2","squarespace-developer-registrar",
"squarespace-dialog-developer-registration-template"]});
YUI.add("squarespace-dialog-domain-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-domain.html"]=b(function(b,c,d,h,k){function l(b,c){return"primary"}function p(b,c){var e,f;e="\n        ";if((f=d["if"].call(b,b.applicationSuppliedDomain,{hash:{},inverse:N.program(7,r,c),fn:N.program(5,q,c),data:c}))||0===f)e+=f;return e+"\n      "}function q(b,c){return'\n          <a class="rename">rename</a>\n        '}function r(b,c){var e,f;e="\n          ";
if((f=d["if"].call(b,b.primary,{hash:{},inverse:N.program(11,u,c),fn:N.program(8,s,c),data:c}))||0===f)e+=f;e+="\n          ";if((f=d["if"].call(b,b.managed,{hash:{},inverse:N.program(21,A,c),fn:N.program(13,v,c),data:c}))||0===f)e+=f;e+='\n          <a class="visit" target="_blank" href="http://';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===R?f.apply(b):f);return e+=X(f)+'">visit</a>\n        '}function s(b,c){var e,f,h;e="\n            ";h={hash:{},inverse:N.noop,fn:N.program(9,
t,c),data:c};if((h=(f=d.ifAllowWwwToggle||b.ifAllowWwwToggle,f?f.call(b,b,h):ca.call(b,"ifAllowWwwToggle",b,h)))||0===h)e+=h;return e+"\n          "}function t(b,c){return'\n            <a class="www-toggle"> toggle www display</a>\n            '}function u(b,c){return'\n            <a class="make-primary">make primary</a>\n          '}function v(b,c){var e,f;e="\n            ";if((f=d["if"].call(b,b.revokable,{hash:{},inverse:N.noop,fn:N.program(14,w,c),data:c}))||0===f)e+=f;e+="\n            ";
if((f=d["if"].call(b,b.locked,{hash:{},inverse:N.program(18,z,c),fn:N.program(16,y,c),data:c}))||0===f)e+=f;return e+"\n          "}function w(b,c){return'\n              <a class="remove">remove</a>\n            '}function y(b,c){return'\n              <a class="lock-toggle unlock">unlock</a>\n            '}function z(b,c){var e,f;e="\n              ";if((f=d.unless.call(b,b.unlockKey,{hash:{},inverse:N.noop,fn:N.program(19,B,c),data:c}))||0===f)e+=f;return e+'\n              <a class="lock-toggle lock">lock</a>\n            '}
function B(b,c){return'\n                <a class="get-transfer-key">get transfer key</a>\n              '}function A(b,c){return'\n            <a class="unlink">unlink</a>\n          '}function K(b,c){var e,f;e='\n        <a class="visit" target="_blank" href=http://';(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===R?f.apply(b):f);return e+=X(f)+">visit</a>\n      "}function O(b,c){return"transferring"}function E(b,c){return'\n\n      <div class="website-settings settings application-supplied">\n\n        <div class="title">Built-in Domain <span class="service">Squarespace</span></div>\n        <div class="description">\n          This is your built in Squarespace domain.  You can rename it, but not remove it.  You can always access your site via your built-in domain, even if you are using a custom domain instead.\n          <div class="rename-button">\n            <button>Rename Built-In Domain</button>\n          </div>\n        </div>\n      </div>\n\n    '}
function F(b,c){var e,f;e='\n\n      <div class="website-settings settings">\n\n        ';if((f=d["if"].call(b,b.managed,{hash:{},inverse:N.program(32,H,c),fn:N.program(30,U,c),data:c}))||0===f)e+=f;e+='\n      </div>\n      <div class="googleapps-settings settings">\n        ';if((f=d["if"].call(b,b.purchasedGoogleApps,{hash:{},inverse:N.program(37,D,c),fn:N.program(35,aa,c),data:c}))||0===f)e+=f;return e+"\n      </div>\n    "}function U(b,c){var e,f;e='\n          <div class="title">Website <span class="service">Squarespace</span></div>\n          <div class="description">\n            This domain is currently managed by Squarespace. We\'ve configured <strong>';
(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===R?f.apply(b):f);e+=X(f)+"</strong> and\n            <strong>www.";(f=d.name)?f=f.call(b,{hash:{},data:c}):(f=b.name,f=typeof f===R?f.apply(b):f);return e+=X(f)+'</strong> to point to your Squarespace website. Keep the toggle below in the "on" position to\n            ensure your domain is properly linked. If you need to manage additional settings,\n            <a href="#" class="send-email">click here to request additional access</a>.\n          </div>\n          <div class="website-toggle"></div>\n        '}
function H(b,c){var e,f,h;e='\n          <div class="title">Website</div>\n          <div class="description">\n            This domain is <strong>not managed by Squarespace</strong>. To link this domain, you must access your registrar\'s interface and\n            create a CNAME record that points ';h={hash:{},inverse:N.noop,fn:N.program(33,G,c),data:c};if((h=(f=d.ifNakedDomain||b.ifNakedDomain,f?f.call(b,b.name,h):ca.call(b,"ifNakedDomain",b.name,h)))||0===h)e+=h;(h=d.name)?h=h.call(b,{hash:{},
data:c}):(h=b.name,h=typeof h===R?h.apply(b):h);return e+=X(h)+' to\n            ext.squarespace.com. Please note that it can take up to 24 hours for the domain pointing process to complete.\n\n            <p><a target="_blank" href="http://help.squarespace.com/customer/portal/articles/413088-mapping-a-domain-general-instructions-">Need help? View an illustrated domain setup guide.</a></p>\n          </div>\n        '}function G(b,c){return"www."}function aa(b,c){return'\n          <div class="title">Email <span class="service">Google Apps</span></div>\n          <div class="description">\n            You have set up your email with Squarespace. You can manage your email settings and accounts in the\n            Email settings area.\n          </div>\n          <div class="button configure-email">\n            Configure Email\n          </div>\n        '}
function D(b,c){var e,f;e="\n          ";if((f=d["if"].call(b,b.betaFeatures,{hash:{},inverse:N.noop,fn:N.program(38,M,c),data:c}))||0===f)e+=f;e+='\n          <div class="title">Email via External Google Apps</div>\n          ';if((f=d["if"].call(b,b.managed,{hash:{},inverse:N.program(43,V,c),fn:N.program(41,Q,c),data:c}))||0===f)e+=f;e+="\n          ";if((f=d["if"].call(b,b.googleAppsFilename,{hash:{},inverse:N.program(47,Z,c),fn:N.program(45,C,c),data:c}))||0===f)e+=f;return e+"\n        "}function M(b,
c){var e,f;e="\n            ";if((f=d["if"].call(b,b.managed,{hash:{},inverse:N.noop,fn:N.program(39,I,c),data:c}))||0===f)e+=f;return e+"\n          "}function I(b,c){return'\n              <div class="title">Email via Squarespace</div>\n              <div class="description">\n                You can also purchase email powered by Google Apps directly from Squarespace. Click here to get started.\n              </div>\n              <div class="button configure-email">\n                Configure Email\n              </div>\n            '}
function Q(b,c){return'\n            <div class="description">\n              Adding email to your domain with a Google Apps account is simple. To do this, turn on Google Apps below and\n              follow the instructions at <a target="_blank" href="http://goo.gl/yAIgZ">http://goo.gl/yAIgZ</a> to complete the setup\n              process. For more information, <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/581494-how-do-i-setup-google-apps-for-my-domain-">please visit our help article</a>.\n            </div>\n            <div class="googleapps-toggle"></div>\n          '}
function V(b,c){return'\n            <div class="description">\n              Adding email to your domain with a Google Apps account is simple.\n              <a target="_blank" href="http://goo.gl/yAIgZ">Visit the Google Apps homepage</a> for instructions on getting\n              started. To complete your setup process, click below to upload your Google HTML file.  For more information,\n              <a target="_blank" href="http://help.squarespace.com/customer/portal/articles/581494-how-do-i-setup-google-apps-for-my-domain-">please visit our help article</a>.\n            </div>\n          '}
function C(b,c){return'\n          <div class="upload-text">\n            <div class="checkmark"></div>\n            <div class="success-description">\n              <strong>Upload successful.</strong>  Click the <strong>Verify</strong> link in your Google Apps interface to complete setup. <a href="#" class="remove-googleapps-file">(remove file)</a>\n            </div>\n          </div>\n          '}function Z(b,c){return'\n            <div class="googleapps-upload-button"></div>\n          '}this.compilerInfo=
[4,">= 1.0.0"];d=this.merge(d,b.helpers);k=k||{};b="";var N=this,ca=d.helperMissing,R="function",X=this.escapeExpression;if((c=d["with"].call(c,c.data,{hash:{},inverse:N.noop,fn:N.program(1,function(b,c){var e,f,h;e='\n  <div class="header ';if((f=d["if"].call(b,b.primary,{hash:{},inverse:N.noop,fn:N.program(2,l,c),data:c}))||0===f)e+=f;h={hash:{},data:c};e=e+" "+(X((f=d["status-class"]||b["status-class"],f?f.call(b,b,h):ca.call(b,"status-class",b,h)))+" type-");h={hash:{},data:c};e+=X((f=d["type-class"]||
b["type-class"],f?f.call(b,b,h):ca.call(b,"type-class",b,h)))+'">\n    <span class="name">\n      ';h={hash:{},data:c};e+=X((f=d["domain-name"]||b["domain-name"],f?f.call(b,b,h):ca.call(b,"domain-name",b,h)))+'\n    </span>\n\n    <span class="controls">\n      ';if((h=d.unless.call(b,b.transferring,{hash:{},inverse:N.program(23,K,c),fn:N.program(4,p,c),data:c}))||0===h)e+=h;e+='\n    </span>\n\n    <div class="managed-text type-';h={hash:{},data:c};e+=X((f=d["type-class"]||b["type-class"],f?f.call(b,
b,h):ca.call(b,"type-class",b,h)))+'">managed by</div>\n    <div class="status-icon ';h={hash:{},data:c};e+=X((f=d["status-class"]||b["status-class"],f?f.call(b,b,h):ca.call(b,"status-class",b,h)))+'"></div>\n  </div>\n  <div class="body ';if((h=d["if"].call(b,b.transferring,{hash:{},inverse:N.noop,fn:N.program(25,O,c),data:c}))||0===h)e+=h;e+='">\n    <div class="errors">\n    </div>\n    ';if((h=d["if"].call(b,b.applicationSuppliedDomain,{hash:{},inverse:N.program(29,F,c),fn:N.program(27,E,c),data:c}))||
0===h)e+=h;return e+="\n  </div>\n"},k),data:k}))||0===c)b+=c;return b+"\n"})})();b.Handlebars.registerPartial("dialog-domain.html".replace("/","."),d.templates["dialog-domain.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-plugin-pulsewarn",function(b){b.namespace("Squarespace.Plugin");b.Squarespace.Plugin.PulseWarn=b.Base.create("pulseWarn",b.Plugin.Base,[],{initializer:function(d){this.config=d;this.set("color",d.color);this.set("useClass",d.useClass);this.set("targetClass",d.targetClass);this.set("iterations",d.iterations);b.Lang.isUndefined(d.interval)||this.set("interval",d.interval);this._timer=null},warn:function(){var d=this.get("host"),c=this.get("iterations"),e=d.getStyle("backgroundColor"),
f=this.get("color");b.Lang.isNull(this._timer)||(this._timer.cancel(),this._timer=null);if(this.get("useClass")){var g=this.get("targetClass"),e=this.get("interval");this.fire("start");d.addClass(g);this._timer=b.later(e,this,function(){0===c?(d.removeClass(g),this.fire("stop"),this._timer.cancel(),this._timer=null):(d.hasClass(g)?d.removeClass(g):d.addClass(g),c--)},{},!0)}else{var h=new b.Anim({node:d,to:{backgroundColor:f,opacity:0.8},easing:this.get("easingUp"),duration:this.get("duration")}),
k=new b.Anim({node:d,to:{backgroundColor:e,opacity:1},easing:this.get("easingDown"),duration:this.get("duration")});h.on("end",function(){0<c&&k.run();c--});k.on("end",function(){0<c?h.run():this.fire("stop")},this);this.fire("start");h.run()}}},{NS:"pulseWarn",ATTRS:{useClass:{value:!1},iterations:{value:3},color:{value:"#c1b12e"},interval:{value:2E3},duration:{value:0.7},easingUp:{value:b.Easing.easeInSine},easingDown:{value:b.Easing.easeOutSine}}})},"1.0",{requires:["base","plugin","anim"]});
YUI.add("squarespace-content-collection-bulk-actionable",function(b){b.namespace("Squarespace.Mixins").ContentCollectionBulkActionable=b.Base.create("ContentCollectionBulkActionable",b.Base,[b.Squarespace.TimerMixin],{initializer:function(){b.Do.after(this._renderActionTray,this,"renderUI",this);b.Do.after(this._bindActionTray,this,"bindUI",this);this.after("actionTrayRelativePositionFixedNodeChange",function(d){d.newVal&&b.Lang.isValue(this._actionTray)&&this._actionTray.set("relativeNode",d.newVal)},
this)},destructor:function(){b.Lang.isValue(this._actionTray)&&this._actionTray.destroy();this._loadEventHandle&&this._loadEventHandle.detach()},_bindActionTray:function(d){this._loadEventHandle=this.get("model").after("load",function(){b.Lang.isValue(this._actionTray)&&this._actionTray.set("buttons",this._getTrayButtons())},this)},_getTrayButtons:function(){var b=[{label:"Select All",action:this.selectAll,context:this,className:"light no-frame"},{label:"Clear Selection",action:this.deselectAll,context:this,
className:"light no-frame"},{label:"Delete",action:this.removeSelected,context:this,className:"dark no-frame"}];this.get("moveable")&&this._hasValidCollectionsToMoveTo()&&b.splice(2,0,{label:"Move Items",action:this.moveSelected,context:this,className:"dark no-frame"});return b},_renderActionTray:function(){var d=this._getTrayButtons();this._actionTray=new b.Squarespace.Widgets.ActionTray({"strings.title":"{count} {label} Selected",visible:!1,showThreshold:1,buttons:d,render:this.get("contentBox")});
(d=this.get("actionTrayRelativePositionFixedNode"))&&this._actionTray.plug(b.Squarespace.Plugin.RelativePositionFixed,{relativeNode:d,anchor:"bottom",offset:this.get("actionTrayRelativePositionOffset")||[44,-22]})},updateActionTray:function(){this._timer(b.later(0,this,function(){this._actionTray.set("count",this.get("selection")?this.get("selection").size():0)}))},selectAll:function(){this.each(function(b){b.set("selected",1)})},deselectAll:function(){this.each(function(b){b.set("selected",0)})},
removeSelected:function(){var d=this.get("selection");if(d)(new b.Squarespace.Widgets.Confirmation({"strings.title":"Remove Selected?","strings.message":"Are you sure you wish to remove your selection? This action cannot be undone."})).on("confirm",function(){this.removeItems(d)},this)},removeItems:function(b){var c=[];b.each(function(b){b.get("item").get("id")&&c.push(b.get("item"));b.set("selected",0);b.destroy()},this);0<c.length&&this.get("model").items.removeItems(c)},moveSelected:function(){var d=
this.get("model"),c=new b.Squarespace.EditingDialog({width:380,height:300,overlay:0.5,style:"flyout",savingText:"Moving Items...",buttons:[{type:"cancel",title:"Cancel"},{type:"moveItems",title:"Move Items"}],tabs:[{title:"Select Destination Collection",scroll:!0,icon:"/universal/images-v6/icons/icon-import-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.ContentSelector,config:{name:"content-selector",showCollectionTagsAndCategories:!1,collectionFilter:{collectionType:d.get("type"),ordering:d.get("ordering")},
excludeCollectionIds:[d.get("id")]}}]}]});c.on("show",function(){this.set("dragSelectionEnabled",!1)},this);c.on("dismiss",function(){this.set("dragSelectionEnabled",!0)},this);c.on("button-moveItems",function(){var e=c.getField("content-selector").get("data");b.Lang.isArray(e)&&(e=e[0]);e?(c.showSaveOverlay(),c.updateTitle(b.Squarespace.DialogStates.SAVING),b.Squarespace.ContentCollectionCache.getCollectionById(e.id,function(e){var g=[];this.get("selection").each(function(b){g.push(b.get("item"))},
this);d.items.moveItems(g,e,b.bind(function(){c.cancel()},this))},this)):new b.Squarespace.Widgets.Alert({"strings.title":"No Collection Selected","strings.message":"Please select a collection to move the selected items to."})},this);c.show()},_hasValidCollectionsToMoveTo:function(){var d=this.get("model").getTemplateConfiguration();return 0<b.Squarespace.ContentCollectionUtils.filterCollections({collectionType:d.get("collectionType"),ordering:d.get("ordering")},[this.get("model").get("id")]).length}},
{ATTRS:{actionTrayRelativePositionOffset:{value:[44,-22],validator:b.Lang.isArray},actionTrayRelativePositionFixedNode:{},showActionTray:{value:!0},moveable:{value:!1},multiple:{value:!0}}})},"1.0",{requires:["base-build","squarespace-timer-mixin","squarespace-tray","squarespace-widgets-alert","squarespace-widgets-confirmation"]});
YUI.add("squarespace-dialog-social-account-toggle",function(b){var d=b.namespace("Squarespace.DialogFields").SocialAccountToggle=b.Base.create("socialAccountToggle",b.Squarespace.DialogField2,[],{renderUI:function(){b.Squarespace.DialogFields.SocialAccountToggle.superclass.renderUI.call(this);var c=this.get("account"),c=new b.Squarespace.Widgets.TinySocialAccount({account:c}),d=this.get("contentBox");c.render(d);this._toggle=new b.Squarespace.Widgets.ToggleButton;this._toggle.plug(b.Squarespace.ToggleDrag);
this._toggle.render(d);this._eventHandles=[]},syncUI:function(){d.superclass.syncUI.call(this);this._toggle.set("active",this.get("active"))},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("boundingBox"),e=this.get("id");this.after(e+"|activeChange",function(b){b.silent||this.syncUI()},this);this._toggle.after(e+"|activeChange",function(){this.set("active",this._toggle.get("active"),{silent:!0})},this);b.on(e+"|click",function(){this.set("active",!this.get("active"))},this);this._toggle.get("boundingBox").on(e+
"|click",function(b){b.halt()})}},{CSS_PREFIX:"sqs-social-account-toggle",ATTRS:{account:{},active:{value:!0},data:{getter:function(){return this.get("account.id")},setter:function(b){var d=this.get("account");d&&(d.id=b)}}}})},"1.0",{requires:["base","base-build","squarespace-dialog-field-2","squarespace-tiny-social-account","squarespace-toggle"]});
YUI.add("squarespace-block-foursquare-model",function(b){b.namespace("Squarespace.ContentModel").FoursquareBlock=b.Base.create("FoursquareBlockModel",b.Squarespace.ContentModel.SummaryGalleryBlock,[],{},{ATTRS:{}})},"1.0",{requires:["base","model","squarespace-enum","squarespace-block-summary-gallery-model"]});
YUI.add("squarespace-dialog-select",function(b){var d=b.namespace("Squarespace.DialogFields").Select=b.Base.create("select",b.Squarespace.DialogField2,[],{initializer:function(c){!b.Lang.isValue(c.data)&&b.Lang.isValue(c.defaultValue)&&this.set("data",c.defaultValue);b.Lang.isArray(c.optGroups)&&this.set("options",b.Array.reduce(c.optGroups,[],function(b,c){return b.concat(c.options)}))},renderUI:function(){d.superclass.renderUI.call(this);var b=this.get("contentBox");this._selectField=b.one("select");
this._selectField.setAttribute("name",this.get("name"));var e=this.get("dialog");e&&this._selectField.setAttribute("tabindex",e.getNextTabIndex());(e=this.get("autocompleteType"))&&this._selectField.setAttribute("x-autocompletetype",e);this._prevSelectFieldValue=null;this._renderOptions();this._updateLabel();this._updateStrings();this._updateIconClasses(this.get("icon"));this._set("errorFlyoutAnchor",b.one(".select-facade"))},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("id");this.get("contentBox");
this.after(b+"|optionsChange",function(){this._renderOptions();this._updateLabel();this.syncUI()},this);this.get("contentBox").one(".select-facade").on(b+"|click",function(b){"disabled"!==this._selectField.getAttribute("disabled")&&(b.halt(),"SELECT"!==b.target.get("tagName")&&this._selectField.simulate("mousedown"))},this);this._selectField.on("change",function(){var b=this.get("value"),c=this._selectField.get("value");c!==b&&(this.get("numeric")&&(c=parseInt(c,10)),this.set("data",c))},this);var e=
this.get("boundingBox"),f=this.getProperty("CSS_PREFIX")+"-focus";e.on(b+"|focus",function(){this._selectField.focus()},this);this._selectField.on(b+"|focus",function(){e.addClass(f)},this);this._selectField.on(b+"|blur",function(){e.removeClass(f)},this);this.after("stringsChange",this._updateStrings,this);this.after("iconChange",this._updateIcon,this)},syncUI:function(){d.superclass.syncUI.call(this);var c=this.get("data");!b.Lang.isUndefined(c)&&!b.Lang.isNull(c)&&this._uiSelectOption(c)},_updateIcon:function(b){this._updateIconClasses(b.newVal,
b.prevVal)},_updateIconClasses:function(c,d){var f=this.get("contentBox").one(".select-facade"),g=b.Lang.isString(c)&&0<c.length;b.Lang.isString(d)&&f.removeClass(d);g&&f.addClass(c);f.toggleClass("icon",g)},_updateStrings:function(b){this._renderTitle();this._renderDescription()},_renderOptions:function(){var c=this.get("options"),d=this.get("optGroups"),f=this._selectField;f.empty();b.Lang.isArray(d)?b.Array.each(d,this._renderOptGroup,this):(b.Array.each(c,function(b){this._renderOption(b,f)},
this),f.set("selectedIndex",-1))},_renderTitle:function(){var b=this.get("contentBox").one(".title");this.get("strings.title")?b.setContent(this.get("strings.title")):b.hide()},_renderDescription:function(){var b=this.get("contentBox").one(".description");this.get("strings.description")?b.setContent(this.get("strings.description")):b.hide()},_renderOptGroup:function(c){var d=b.Node.create("<optgroup></optgroup>");d.setAttribute("label",c.label);b.Array.each(c.options,function(b){this._renderOption(b,
d)},this);this._selectField.append(d)},_renderOption:function(c,d){var f=b.Node.create("<option></option>");f.setAttribute("value",c.value);f.setContent(c.label);c.disabled&&f.setAttribute("disabled","disabled");d.appendChild(f)},getOptionLabel:function(c){var d=this.get("options"),f=this.get("strings.labelTemplate")||"{label}",g="";if(b.Lang.isNull(c)||b.Lang.isUndefined(c))return g;b.Array.some(d,function(b,d){return b.value.toString()===c.toString()?(g=b.label,!0):!1},this);return b.substitute(f,
{label:g})},getOptionValue:function(c){var d=this.get("options"),f;if(b.Lang.isNull(f)||b.Lang.isUndefined(f))return f;b.Array.some(d,function(b,d){return b.label.toString()===c.toString()?(f=b.value,!0):!1},this);return f},_uiSelectOption:function(c){b.Lang.isUndefined(c)?console.warn(this.name+": Cannot select undefined value"):(b.Lang.isNull(c)||(c=c.toString(),this._selectField.set("value",c)),this._updateLabel())},_updateLabel:function(){this.hideError();var c=this.get("contentBox").one(".select-facade .label"),
d=this.get("data"),f=this.get("strings.placeholder"),g=this.getOptionLabel(d);b.Lang.isNull(d)||!g?(f?c.setContent(f):(console.warn(this.name+": No placeholder or option selected. (fieldname: "+this.get("name")+")"),c.setContent("&nbsp;")),c.addClass("empty")):(c.setContent(g),c.toggleClass("empty",0===d.length))},focus:function(){d.superclass.focus.call(this);this.get("rendered")&&this._selectField.focus()},blur:function(){d.superclass.blur.call(this);this.get("rendered")&&this._selectField.blur()},
disable:function(){d.superclass.disable.call(this);this.get("rendered")&&(this._selectField.setAttribute("disabled","disabled"),this.get("boundingBox").addClass(this.getProperty("CSS_PREFIX")+"-disabled"))},enable:function(){d.superclass.enable.call(this);this.get("rendered")&&(this._selectField.removeAttribute("disabled"),this.get("boundingBox").removeClass(this.getProperty("CSS_PREFIX")+"-disabled"))},_getErrors:function(){return this.get("required")&&this.isEmpty()?["This is a required field."]:
[]}},{CSS_PREFIX:"sqs-select",TEMPLATE:'<div class="title"></div><div class="select-facade sqs-disable-drag-selection"><div class="label"></div><select></select></div><div class="description"></div>',ATTRS:{data:{getter:function(c){return this.get("numeric")?!b.Lang.isNumber(parseInt(c,10))?0:parseInt(c,10):!b.Lang.isValue(c)?"":!b.Lang.isString(c)?c+"":c}},icon:{value:"",validator:b.Lang.isString},numeric:{value:!1},options:{value:[],setter:function(c){if(b.Lang.isArray(c))return c;if(b.Lang.isObject(c))return this.convertToOptionsArray(c)},
validator:function(c){if(!b.Lang.isArray(c))return console.warn(this.name+": options must be an array. Was:",c),!1;for(var d=c.length-1;0<=d;d--){var f=c[d];if(!f.hasOwnProperty("label"))return console.warn(this.name+": option had no label property. Was:",f),!1;if(!f.hasOwnProperty("value"))return console.warn(this.name+": option had no value property. Was:",f),!1}return!0}},optGroups:{value:null,validator:b.Squarespace.AttrValidators.isNullOrArray},strings:{value:{placeholder:"Select an option"}},
autocompleteType:b.Squarespace.AutocompleteTypeATTR},convertToOptionsArray:function(c){var d=[];if(b.Lang.isArray(c))return c;if(!b.Lang.isObject(c)&&!b.Lang.isValue(c))return console.warn("Could not convert to new style options, not an object."),d;b.Object.each(c,function(b,c){d.push({value:c,label:b.title||c})},this);return d}});b.Squarespace.DialogFields.LabeledSelect=b.Base.create("labeledSelect",b.Squarespace.DialogFields.Select,[b.Squarespace.DialogFields.DialogFieldLabel],{renderUI:function(){b.Squarespace.DialogFields.LabeledSelect.superclass.renderUI.call(this);
var c=this.get("contentBox");c.prepend('<div class="label-wrapper"></div>');this._set("errorFlyoutAnchor",c.one(".select-facade"))}},{CSS_PREFIX:"sqs-labeled-select",LABEL_CONFIG:{renderNode:".label-wrapper",forNode:"select"}})},"1.0",{requires:"base base-build node-event-simulate squarespace-dialog-field-2 squarespace-dialog-label squarespace-autocomplete-types".split(" ")});
YUI.add("squarespace-editor-member-account",function(b){var d={fields:{}};d.fields.avatar={ctor:b.Squarespace.DialogFields.FileImage,config:{name:"avatar",height:183,useFocalPoint:!1,contentLabel:"an avatar",mode:b.Squarespace.UploadModes.GLOBAL}};d.tabs={};d.tabs.account={title:{$valueFn:function(c){return c.get("pseudonymAccount")?b.Lang.sub("{action} Basic Author",{action:c.isNew()?"Add":"Edit"}):"Profile"}},tabTitle:"Account",icon:{$valueFn:function(b){return b.get("pseudonymAccount")&&b.isNew()?
"/universal/images-v6/icons/icon-plus-16-light.png":"/universal/images-v6/content/member.png?2"}},scroll:!0,fields:[{type:"splitter",fields:[{type:"stack",width:0.3,fields:[{$include:"fields.avatar"}]},{type:"stack",width:0.7,fields:[{ctor:b.Squarespace.DialogFields.Text,config:{name:"displayName","strings.placeholder":"Your Name",required:!0,submitOnEnter:!0,className:"large"}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"email","strings.placeholder":"your@email.com",required:!0,submitOnEnter:!0,
mailcheck:!0,className:"large"},$when:function(b){return!b.get("pseudonymAccount")}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"googlePlusProfile","strings.title":"Google+ Profile URL","strings.description":"By validating your site within your Google+ Profile, Google Author Rank will be enabled for your posts, making your profile show up next to them on Google search results.","strings.placeholder":"https://plus.google.com/+YourName",submitOnEnter:!0}}]}]},{ctor:b.Squarespace.DialogFields.ExternalMemberAccountDescriptor,
config:{name:"accountInfo"},$when:function(c){return b.Lang.isValue(c.get("externalId"))}}]};d.tabs.bio={tabTitle:"Bio",name:"bio",scroll:!0,fields:[{type:"splitter",fields:[{type:"stack",width:0.5,fields:[{type:"splitter",fields:[{ctor:b.Squarespace.DialogFields.Text,config:{required:!1,width:0.5,name:"firstName","strings.title":"First Name",submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Text,config:{required:!1,width:0.49,name:"lastName","strings.title":"Last Name",submitOnEnter:!0}}]},{ctor:b.Squarespace.DialogFields.Text,
config:{required:!1,name:"websiteUrl","strings.title":"Website",submitOnEnter:!0}},{ctor:b.Squarespace.DialogFields.TextArea,config:{name:"bio",height:240,"strings.title":"Bio"}}]},{type:"social-accounts",width:0.5,name:"socialOptions",maxCount:7}]}]};d.tabs.location={tabTitle:"Location",name:"location",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Map,config:{height:400,verticalSpan:!0,countHeight:!0,name:"location",title:"Enter a location...",titleStyle:"inline"}}]};d.tabs.subscriptions={tabTitle:"Subscriptions",
name:"subscriptions",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Comment Subscriptions",text:"Squarespace will automatically notify site owners and managers of comment activity. Here you can enable or disable this feature for all the sites you manage.",padding:[10,10]}},{ctor:b.Squarespace.DialogFields.SiteSubscriptions,config:{name:"siteSubscriptions"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Store Subscriptions",text:"Squarespace will automatically notify store owners and managers of order activity. Here you can enable or disable this feature for all the sites you manage.",
padding:[10,10]}},{ctor:b.Squarespace.DialogFields.SiteSubscriptions,config:{name:"storeSubscriptions"}}],$when:function(b){return!b.get("pseudonymAccount")}};d.tabs.developer={tabTitle:"Developer",name:"developer",scroll:!0,fields:[{ctor:b.Squarespace.DialogFields.DeveloperRegistration,config:{name:"developer"}}],$when:function(b){return!b.get("pseudonymAccount")}};d.buttons=[{type:"sendVerification",title:"Send Verification Email",$when:function(b){return b.get("eligibleForMarketingDiscount")&&
!b.get("emailVerified")}},{type:"cancel",title:"Cancel"},{type:"remove",title:"Remove Author",$when:function(b){return b.get("pseudonymAccount")&&!b.isNew()}},{type:"setPassword",title:"Change Password",$when:function(b){return!b.get("pseudonymAccount")}},{type:"saveAndClose",title:"Save"}];var c=b.namespace("Squarespace.Editor").MemberAccount=b.Base.create("MemberAccountEditor",b.Squarespace.ModelEditorDialog,[],{initializer:function(){var c=this.get("dialog");c.on("button-sendVerification",this._sendVerificationEmail,
this);c.on("button-setPassword",this._setPassword,this);c.on("remove-requested",function(){b.Squarespace.MemberPermissionUtils.createReplaceAndRemoveDialog(this.get("attachedMemberPermission"),this.get("model"),this)},this);c.on("ready",function(){c.getField("avatar").on("dataChange",function(b){b.newVal&&b.newVal.set("isGlobalFakeContentItem",!0)})})},_sendVerificationEmail:function(){var c=this.get("model");c.sendVerificationEmail().then(function(){new b.Squarespace.Widgets.Information({"strings.title":"Verification Sent",
"strings.message":"A verification email has been sent to <strong>"+c.get("email")+"</strong>. It may take several minutes for it to appear in your inbox."})},function(){new b.Squarespace.Widgets.Alert({"strings.title":"Account Verified","strings.message":"This account has already been verified."})})},_setPassword:function(){var c=this.get("model"),d=b.Squarespace.ObjectBuilder.make({style:"flyout",name:"set-password",closeOthers:!1,overlay:0.5,width:420,height:260,top:200,buttons:[{type:"cancel",
title:"Cancel"},{type:"saveAndClose",title:"Set"}],tabs:[{title:"Set Password",icon:"/universal/images-v6/dialog/login-icon.png",fields:[{$value:{ctor:b.Squarespace.DialogFields.Password,name:"currentPassword",config:{"strings.placeholder":"Current Password",classname:"large",submitOnEnter:!0,required:!0}},$when:function(){return c.get("emailAccount")}},{ctor:b.Squarespace.DialogFields.Password,name:"newPassword",config:{"strings.placeholder":"New Password",classname:"large",submitOnEnter:!0,required:!0,
strengthMeterVisible:!0}},{ctor:b.Squarespace.DialogFields.Password,name:"newPasswordConfirm",config:{"strings.placeholder":"New Password (Again)",classname:"large",submitOnEnter:!0,required:!0,strengthMeterVisible:!0}}]}]},{},c.toJSON()),g=new b.Squarespace.EditingDialog(d);g.on("send-requested",function(){var d=g.getData();c.setPassword(d.newPassword,d.newPasswordConfirm,d.currentPassword).then(function(){new b.Squarespace.Widgets.Information({"strings.title":"Password Saved","strings.message":"Your new password has been saved."});
g.close()},function(b){g.showErrors(b.errors)})});g.show()},getDialogData:function(){var d=this.get("model"),f=c.superclass.getDialogData.call(this);f.avatar=new b.Squarespace.Models.ContentItem({id:d.get("avatarId"),mediaProcessingState:b.Squarespace.MediaProcessingState.READY,assetUrl:d.get("avatarAssetUrl"),isGlobalFakeContentItem:!0});f.accountInfo={externalId:d.get("externalId"),avatarUrl:d.get("avatarUrl"),displayName:d.get("displayName")};delete f.developerAccountMarketingDetails;delete f.developerAccount;
f.developer=d;return f},sanitizeDialogData:function(d){d=c.superclass.sanitizeDialogData(d);delete d.developer;b.Lang.isValue(d.avatar)?(d.avatarId=d.avatar.get("id"),d.avatarAssetUrl=d.avatar.get("assetUrl")):(d.avatarId=null,d.avatarAssetUrl=null);delete d.avatar;return d},save:function(d,f){var g=this.get("dialog"),h=g.getData().email,k=this.get("model");k.get("email")!=h?this.askForPassword({message:"You changed your email address to <strong>"+h+"</strong>, to be allowed to do this you need to provide your password below."}).then(b.bind(function(g){c.superclass.save.call(this,
b.merge(d,{headers:{password:g}}),f)},this),b.bind(function(){g.getField("email").setValue(k.get("email"));g.hideSaveOverlay()},this)):c.superclass.save.call(this,d,f)},askForPassword:function(c){return new b.Promise(b.bind(function(d,g){this.get("model");var h=new b.Squarespace.EditingDialog({style:"flyout",name:"get-password",closeOthers:!1,overlay:0.5,width:420,height:140,top:200,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Save"}],tabs:[{title:"Please provide Password",
icon:"/universal/images-v6/dialog/login-icon.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:c.message,padding:[0,10]}},{type:"text",required:!0,password:!0,name:"password",title:"Password",style:"major",titleStyle:"left",submitOnEnter:!0}]}]});h.on("send-requested",function(){var b=h.getField("password").getValue();h.dismiss();d(b)},this);h.on("close",function(){g()},this);h.show()},this))}},{ATTRS:{dialogConfig:{value:{initialDataByReference:!0,flyoutPointerDirection:"hidden",
waitForServerOnClose:!0,closeOthers:!1,width:700,height:440,overlay:0.5,buttons:{$include:"buttons"},tabs:[{$include:"tabs.account"},{$include:"tabs.bio"},{$include:"tabs.location"},{$include:"tabs.subscriptions"},{$include:"tabs.developer"}]}},dialogConfigContext:{value:d},attachedMemberPermission:{value:null,validator:function(c){return c instanceof b.Squarespace.Models.MemberPermission}}}})},"1.0",{requires:"base squarespace-dialog-description squarespace-dialog-external-member-account-descriptor squarespace-dialog-file-image squarespace-dialog-map squarespace-dialog-developer-registration squarespace-dialog-password squarespace-dialog-site-subscriptions squarespace-dialog-text squarespace-dialog-text-area squarespace-member-permission-utils squarespace-model-editor squarespace-models-member-account squarespace-models-member-permission squarespace-widgets-alert squarespace-widgets-information".split(" ")});
YUI.add("squarespace-block-embed",function(b){b.namespace("Squarespace.Block").Embed=b.Base.create("block-embed",b.Squarespace.Block.ModelSyncBase,[],{_renderSuccess:function(d){var c=b.Node.create("<div></div>");c.insert(d.html);b.Squarespace.UrlUtils.securifyBlockEmbed(c);this.get("contentBox").setHTML(c)}},{CSS_PREFIX:"sqs-block-embed",ATTRS:{editor:{value:b.Squarespace.Block.Editor.Embed},type:{value:b.Squarespace.BlockType.EMBED}}})},"1.0",{requires:["squarespace-enum","squarespace-url-utils",
"squarespace-block-base-modelsync","squarespace-block-embed-editor"]});
YUI.add("squarespace-product-utils",function(b){b.Squarespace.ProductUtils={getProductAveragePrice:function(d){d=d.get("structuredContent");if(d.get("productType")===b.Squarespace.ProductTypes.DIGITAL)return d.get("priceCents");d=d.get("variants");return b.Array.reduce(d,0,function(b,d){return b+(d.onSale?d.salePrice:d.price)})/d.length},getProductEffectiveStock:function(d){d=d.get("structuredContent");if(d.get("productType")===b.Squarespace.ProductTypes.DIGITAL)return Number.MAX_VALUE;d=d.get("variants");
var c=0;b.Array.some(d,function(b){if(b.unlimited)return c=Number.MAX_VALUE,!0;c+=b.qtyInStock});return c},initializeVariantDropdowns:function(){b.all(".product-variants[data-variants]").each(function(d){var c=JSON.parse(d.getAttribute("data-variants")),e=d.all("select"),f=d.siblings(".product-price").item(0),g;f&&(g=f.getHTML());b.Squarespace.ProductUtils._checkVariantStockAndPrice(d,c,e,f,g);e.detach("change");e.each(function(h){h.after("change",function(h){b.Squarespace.ProductUtils._checkVariantStockAndPrice(d,
c,e,f,g)},this)},this)},this)},_checkVariantStockAndPrice:function(d,c,e,f,g){d.removeAttribute("data-unselected-options");d.removeAttribute("data-selected-variant");d.removeAttribute("data-variant-in-stock");var h=d.one(".variant-out-of-stock");h&&h.remove();var k=[],h=null,l=!1,p={};e.each(function(b){var c=b.get("value");b=b.getAttribute("data-variant-option-name");"none"!=c?p[b]=c:k.push(b)},this);if(0===k.length){for(e=0;e<c.length;e++){g=c[e];var q=!0,r;for(r in p)if(p[r]!=g.attributes[r]){q=
!1;break}if(q){h=g;if(g.unlimited||0<g.qtyInStock)l=!0;break}}!h&&f?f.set("text","Unavailable"):f&&(h.onSale?(f.setHTML(b.Squarespace.Commerce.moneyString(h.salePrice)),f.append(b.Node.create('<span> </span><span class="original-price">'+b.Squarespace.Commerce.moneyString(h.price)+"</span>"))):f.setHTML(b.Squarespace.Commerce.moneyString(h.price)));h&&!l&&d.append(b.Node.create('<div class="variant-out-of-stock">Out of stock.</div>'))}else f&&f.getHTML()!==g&&f.setHTML(g);d.setAttribute("data-unselected-options",
JSON.stringify(k));h&&d.setAttribute("data-selected-variant",JSON.stringify(h));l&&d.setAttribute("data-variant-in-stock",l)}}},"1.0",{requires:["base","node","squarespace-commerce-utils","squarespace-enum"]});
YUI.add("squarespace-plugin-progress-base",function(b){b.namespace("Squarespace.Plugin");b.Squarespace.Plugin.ProgressBase=b.Base.create("ProgressBase",b.Plugin.Base,[],{initializer:function(){this._renderContent();this._bindAttributeChanges();this._setClasses();this._bindContent()},destructor:function(){var d=this._contentEl;d.setStyle("opacity",0);b.later(this.get("unplugDelay"),d,d.remove);d=this.get("host");d.removeClass(this.constructor.NS+"-show-meter");d.removeClass(this.constructor.NS+"-show-cancel")},
_renderContent:function(){var d=this._contentEl=b.Node.create('<div class="progress-container"><div class="progress"><div class="cancel-process">Cancel</div></div></div>'),c=d.one(".progress");this._meterEl=b.Node.create(this.constructor.PROGRESS_METER_TEMPLATE);c.prepend(this._meterEl);this._cancelEl=d.one(".cancel-process");c=this.get("host");this.get("append")?c.append(d):c.prepend(d)},_bindAttributeChanges:function(){this.after(["showChange","showCancelChange"],this._setClasses,this)},_setClasses:function(){var b=
this.get("host"),c=this.constructor.NS,e=this.get("show"),f=this.get("showCancel");b.toggleClass(c+"-show-meter",e);this._meterEl.toggleClass("visible",e);b.toggleClass(c+"-show-cancel",f);this._cancelEl.toggleClass("visible",f)},_bindContent:function(){this._cancelEl.on("click",function(b){b.halt();this.fire("cancel")},this)}},{NS:"progress",PROGRESS_METER_TEMPLATE:"",ATTRS:{show:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},showCancel:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean},
unplugDelay:{value:300,validator:b.Squarespace.AttrValidators.isNumber},append:{value:!1,validator:b.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"}}})},"1.0",{requires:["base","node","plugin","squarespace-attr-validators"]});
YUI.add("squarespace-dialog-cancel-order-restock-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["dialog-cancel-order-restock.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n        <span class="non-restockable-indicator ';(f=d.nonRestockableIndicatorClass)?f=f.call(b,{hash:{},data:c}):(f=b.nonRestockableIndicatorClass,f=typeof f===r?f.apply(b):f);e+=s(f)+'">';(f=d.nonRestockableReason)?f=f.call(b,{hash:{},data:c}):(f=b.nonRestockableReason,
f=typeof f===r?f.apply(b):f);return e+=s(f)+"</span>\n      "}function p(b,c){var e,f;e='\n        <span class="restock-quantity">';(f=d.restockQuantity)?f=f.call(b,{hash:{},data:c}):(f=b.restockQuantity,f=typeof f===r?f.apply(b):f);return e+=s(f)+"</span>\n      "}function q(b,c){var e,f;e='\n        <span class="variant-description">';(f=d.variantDescription)?f=f.call(b,{hash:{},data:c}):(f=b.variantDescription,f=typeof f===r?f.apply(b):f);return e+=s(f)+"</span>\n      "}this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,b.helpers);k=k||{};var r="function",s=this.escapeExpression,t=this;b="<ul>\n  ";if((c=d.each.call(c,c,{hash:{},inverse:t.noop,fn:t.program(1,function(b,c){var e,f;e="\n    <li>\n      ";if((f=d["if"].call(b,b.nonRestockableReason,{hash:{},inverse:t.program(4,p,c),fn:t.program(2,l,c),data:c}))||0===f)e+=f;e+='\n      <span class="product-name">';(f=d.productName)?f=f.call(b,{hash:{},data:c}):(f=b.productName,f=typeof f===r?f.apply(b):f);e+=s(f)+"</span>\n      ";if((f=d["if"].call(b,
b.variantDescription,{hash:{},inverse:t.noop,fn:t.program(6,q,c),data:c}))||0===f)e+=f;return e+"\n    </li>\n  "},k),data:k}))||0===c)b+=c;return b+"\n</ul>\n\n"})})();b.Handlebars.registerPartial("dialog-cancel-order-restock.html".replace("/","."),d.templates["dialog-cancel-order-restock.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-models-model-list",function(b){b.namespace("Squarespace.Models");var d=b.Squarespace.Models.ModelList=b.Base.create("ModelList",b.ModelList,[b.Squarespace.ModelSync.REST],{parse:function(c){c=d.superclass.parse.call(this,c);var e=this._getResponseAttrs(c);b.Object.each(e,function(b,c){this._set(c,b)},this);return c.results},_getResponseAttrs:function(b){return{}}})},"1.0",{requires:["base","model-list","squarespace-model-sync-rest"]});
YUI.add("squarespace-connected-account-dialog-settings",function(b){b.namespace("Squarespace");var d=b.Object.getValue(Static,["SQUARESPACE_CONTEXT","website","identifier"]),c=b.Squarespace.ConnectedAccountCapabilities,e={ctor:b.Squarespace.DialogFields.StructuredInput,config:{name:"defaultPushMessage","strings.title":"Default Posting Format","strings.description":"When posting to this service from Squarespace, this will be the default message format used.",value:"New post %t from %a.",variables:{"%t":{title:"Title",
tip:"The title of this post."},"%a":{title:"Author",tip:"The author of this post."},"%u":{title:"URL",tip:"The URL to this post."}}}},f=function(b){return function(c){return c.get("serviceName")!==b}},g={$valueFn:function(b){return e},$when:f("tumblr")},h={};h[c.NONE]=[];h[c.PULL|c.PUSH|c.ICON]=[{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Show Social Icon","strings.description":"Allow visitors to connect with you through an icon for this service on the front of your site.",name:"iconEnabled"}},
{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Download Data","strings.description":"When new items are posted to this account, download them to Squarespace for publishing on your site.",name:"pullEnabled"}},{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Show Push Option","strings.description":"When posting on Squarespace, show this account as a cross-publishing option.",name:"pushEnabled"}},g,{ctor:b.Squarespace.DialogFields.Text,config:{name:"profileUrl","strings.title":"Profile URL",
"strings.description":"Enter the URL to your profile.",submitOnEnter:!0}}];h[c.PULL|c.ICON]=[{type:"splitter",fields:[{type:"stack",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Show Social Icon","strings.description":"Allow visitors to connect with you through an icon for this service on the front of your site.",name:"iconEnabled"}}]},{type:"stack",width:0.5,fields:[{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Download Data","strings.description":"When new items are posted to this account, download them to Squarespace for publishing on your site.",
name:"pullEnabled"}}]}]},{ctor:b.Squarespace.DialogFields.Text,config:{name:"profileUrl","strings.title":"Profile URL","strings.description":"Enter the URL to your profile.",submitOnEnter:!0}}];h[c.ICON]=[{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Show Social Icon","strings.description":"Allow visitors to connect with you through an icon for this service on the front of your site.",name:"iconEnabled"}},{$value:{ctor:b.Squarespace.DialogFields.Text,config:{name:"profileUrl","strings.title":"Profile URL",
"strings.description":"Enter the URL to your profile.",description:"",submitOnEnter:!0}},$when:f("email")}];h[c.ICON|c.PUSH]=[{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Show Social Icon","strings.description":"Allow visitors to connect with you through an icon for this service on the front of your site.",name:"iconEnabled"}},{ctor:b.Squarespace.DialogFields.Check,config:{"strings.title":"Show Push Option","strings.description":"When posting on Squarespace, show this account as a cross-publishing option.",
name:"pushEnabled"}},g,{$value:{ctor:b.Squarespace.DialogFields.Text,config:{name:"profileUrl","strings.title":"Profile URL","strings.description":"Enter the URL to your profile.",submitOnEnter:!0}},$when:f("tumblr")}];b.Squarespace.ConnectedAccountDialogSettingsContext={buttons:[{type:"cancel",title:"Cancel"},{type:"remove",title:"Disconnect"},{$value:{type:"reset",title:"Reset Data"},$when:function(b){return c.can(b,c.PULL)}},{type:"saveAndClose",title:"Save"}]};var k=function(c){return b.clone(h[b.Squarespace.ConnectedAccountCapabilities.get(c)])},
f=function(b){b=b.get("serviceName");return b.charAt(0).toUpperCase()+b.substr(1)+" Settings"},l={style:"flyout",flyoutPointerDirection:"centered",verticalHeight:"fit",overlay:0.5,name:"social-account-settings",closeOthers:!1,width:400,tabs:[{icon:"/universal/images-v6/icons/icon-settings-16-light.png",title:{$valueFn:f},fields:{$valueFn:k}}],buttons:{$include:"buttons"}},p=function(c){c=c.get("metaData.managedPages");return{ctor:b.Squarespace.DialogFields.FacebookMetaData,name:"metaData",config:{pages:b.Array.map(c,
function(b){return{label:b.name+" (Page)",value:b.id}})}}},q={flickr:b.merge(l,{width:420}),github:b.merge(l,{width:400}),smugmug:b.merge(l,{width:400}),dribbble:b.merge(l,{width:400}),vimeo:b.merge(l,{width:400}),email:b.merge(l,{width:400}),pinterest:b.merge(l,{width:400}),fivehundredpix:b.merge(l,{width:400}),google:b.merge(l,{width:400}),instagram:b.merge(l,{width:600}),foursquare:b.merge(l,{width:400}),youtube:b.merge(l,{width:330}),facebook:b.merge(l,{width:400,tabs:[{scroll:!0,icon:"/universal/images-v6/icons/icon-settings-16-light.png",
title:{$valueFn:f},fields:{$valueFn:function(c){var d=k(c);c.get("metaData")?d.push(p(c)):d.push({ctor:b.Squarespace.DialogFields.Description,config:{padding:[15,0],title:"Reconnect to Enable Push Targets",text:"Please reconnect your Facebook account to enable pushing to brand pages."}});return d}}}]}),tumblr:b.merge(l,{tabs:[{icon:"/universal/images-v6/icons/icon-settings-16-light.png",title:{$valueFn:f},fields:[{$valueFn:function(b){return k(b)[0]}},{$value:{ctor:b.Squarespace.DialogFields.Description,
config:{title:"Primary Blog",text:"Select the blog content will be pushed to.",padding:[20,0]}},$when:function(b){return b.get("metaData")}},{$valueFn:function(c){c=c.get("metaData").blogs;var d=[];b.Array.each(c,function(b,c){d.push({value:b.name,label:b.title||b.name})},this);return{ctor:b.Squarespace.DialogFields.Select,config:{className:"thin dark",name:"primaryBlog",options:d,width:0.3}}},$when:function(b){return b.get("metaData")}}]}]}),dropbox:b.merge(function(c,d){var e=b.clone(l);e.tabs[0].fields=
d;return e}(l,[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Dropbox Connection Activated",text:"Your Squarespace account is connected to your Dropbox account.  Pressing the publish button from the previous screen will let you synchronize your content into Squarespace."}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Instructions",text:"After you have connected your account to Dropbox, a <strong>Squarespace</strong> folder will appear in the <strong>Apps</strong> directory of your Dropbox account.  To publish files to Squarespace, within our directory, create a folder called <strong>"+
d+"</strong> (the name of your site), and then create a sub-folder for each collection you would like to create on your Squarespace site.<br/><br/>For instance, creating a folder with images at <strong>/Apps/Squarespace/"+d+'/Test Images</strong> would create a corresponding collection called <strong>Test Images</strong> on Squarespace, and your images would be automatically transferred to that collection. If you want a specific file to be ignored by Squarespace just prefix the file name with underscrore ("_").<br/><br/>Squarespace for Dropbox currently only supports images. <br/><br/> Please note that you must press the <strong>Publish to Squarespace</strong> button from the main Connected Accounts panel to push changes from Dropbox to Squarespace &mdash; they will not be automatically uploaded.',
padding:[10,0]}}]),{width:550})};b.Squarespace.ConnectedAccountDialogSettings={get:function(c){return b.clone(q[c]||l)}}},"1.0",{requires:"squarespace-dialog-fields squarespace-dialog-fields-generators squarespace-dialog-facebook-meta-data squarespace-dialog-description squarespace-dialog-toggle squarespace-dialog-select squarespace-dialog-structured-input squarespace-connected-account-capabilities".split(" ")});
YUI.add("squarespace-numeric-badge",function(b){b.namespace("Squarespace.Widgets").NumericBadge=b.Base.create("numericBadge",b.Widget,[],{initializer:function(){this.plug(b.Plugin.WidgetAnim,{duration:0.3})},bindUI:function(){this.after(this.get("id")+"|valueChange",this.syncUI,this)},syncUI:function(){var b=this.get("value");this.get("contentBox").setContent(this.get("value"));0<b?this.show():this.hide()}},{ATTRS:{value:{value:0}},CSS_PREFIX:"sqs-numeric-badge"})},"1.0",{requires:["widget","widget-anim",
"base-build"]});YUI.add("squarespace-block-spacer-editor-email",function(b){b.namespace("Squarespace.Block.Editor");b.Squarespace.Block.Editor.SpacerEmail=b.Base.create("blockSpacerEditorEmail",b.Squarespace.Block.Editor.Spacer,[],{initializer:function(){this.get("host").set("floatable",!1)}},{NS:"blockEditor",ATTRS:{minHSize:{value:2}}})},"1.0",{requires:["base","squarespace-block-spacer-editor"]});
YUI.add("squarespace-throttle",function(b){b.namespace("Squarespace");b.Squarespace.throttle=function(d,c,e){var f,g,h,k=null,l=0,p=function(){l=!1===e.leading?0:b.Lang.now();k=null;h=d.apply(f,g);f=g=null},q=function(){var q=b.Lang.now();!l&&!1===e.leading&&(l=q);var s=c-(q-l);f=this;g=arguments;0>=s?(k&&(k.cancel(),k=null),l=q,h=d.apply(f,g),f=g=null):!k&&!1!==e.trailing&&(k=b.later(s,f,p,g));return h};q.cancel=function(){k&&k.cancel()};return q}},"1.0",{requires:[]});
YUI.add("squarespace-models-domain-list",function(b){b.namespace("Squarespace.Widgets");b.Squarespace.Models.DomainList=b.Base.create("domainList",b.ModelList,[b.Squarespace.ModelSync.REST],{model:b.Squarespace.Models.Domain,getURL:function(){var d=b.Squarespace.ModelSync.REST.prototype.getURL.apply(this,arguments),c=this.get("managed");return!b.Lang.isNull(c)?d+"?managed="+c:d}},{ATTRS:{managed:{value:null,validator:b.Squarespace.AttrValidators.isBoolean}}})},"1.0",{requires:["base","model-list",
"squarespace-attr-validators","squarespace-models-domain","squarespace-model-sync-rest"]});
YUI.add("squarespace-settings-site-basic",function(b){var d='This area contains the most basic information for your website.  Pick a site title, logo, business information (if applicable) and tell us about the purpose of your site. <a target="new" href="'+b.Squarespace.HelpLinks.BASIC_INFO+'">Click here for more help regarding your site information.</a>',c=[{ctor:b.Squarespace.DialogFields.Description,config:{title:"Site Title / Tag Line",text:"The Site Title is used wherever the title of the site appears, while the Tag Line is used on some templates where applicable.",
padding:[0,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"siteTitle","strings.placeholder":"Site Title",saveOnEnter:!0,required:!0,maxLength:120}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"siteTagLine","strings.placeholder":"Tag Line",saveOnEnter:!0,maxLength:300}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Site Description",text:"A description of your site, or a short bio.  Some templates will use this bio on the main presentation of your website.",padding:[15,
0]}},{ctor:b.Squarespace.DialogFields.Wysiwyg,config:{name:"siteDescription",toolbarType:b.Squarespace.Wysiwyg.ToolbarTypes.DIALOG_SMALL,editorHeight:197,classNames:"title",saveOnEnter:!0}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Logo Image",text:"Upload a logo image to be used in the place of your site title. <strong>Use the template style editor to control your logo size on screen directly from the front of your site.</strong>",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.FileImage,
config:{name:"logoImage",contentLabel:"a logo",mode:b.Squarespace.UploadModes.TRANSIENT,height:200,width:0.6,spinnerColor:"dark"}},{ctor:b.Squarespace.DialogFields.HTML,config:{content:"Need just a basic logo? Squarespace Logo is a simple tool you can use to design a mark quickly via your web browser. It's free for Squarespace Customers",className:"description"}},{ctor:b.Squarespace.DialogFields.Button,config:{"strings.text":"Try Squarespace Logo",href:"https://www.squarespace.com/logo",newWindow:!0}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Search Engine Description",text:'In one or two short sentences, describe your website. This description is used in the search results of search engines like Google. <a target="new" href="'+b.Squarespace.HelpLinks.META_DESCRIPTION+"\">How do I increase my site's visibility in search engines?</a>",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"metaDescription","strings.placeholder":"Enter a description...",saveOnEnter:!0}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Browser Icon (Favicon)",text:"Using the field below, you can upload a browser URL icon for use with your site.  This icon can be in PNG or ICO format and will be resized by the browser for display in your URL bar. Note: IE does not support PNG format.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.FileImage,config:{name:"favicon",contentLabel:"a favicon",mode:b.Squarespace.UploadModes.TRANSIENT,width:0.4,height:167,spinnerColor:"dark"}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Site Type",text:"Select the the nature of your site.",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Select,config:{name:"type",defaultValue:"",className:"thin",options:[{value:"",label:"Select One",empty:!0},{value:"Business",label:"Business"},{value:"Personal",label:"Personal"},{value:"Non-Profit",label:"Non-Profit"}]}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Site Subject",text:"Select the industry most representative of the site you are running.",
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.WebsiteSubjects,config:{name:"subjects"}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Contact Phone Number",text:"If you are a business, your primary contact phone number.  <strong>This number will be made public and is used by some templates on the front of your site.</strong>",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"contactPhoneNumber","strings.placeholder":"(xxx) xxx-xxxx",saveOnEnter:!0,maxLength:120}},
{ctor:b.Squarespace.DialogFields.Description,config:{title:"Contact Email",text:"Your primary contact email address.  <strong>This email will be made public and is used by some templates on the front of your site.</strong>",padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Text,config:{name:"contactEmail","strings.placeholder":"xxx@xxxxxxxxx.com",saveOnEnter:!0,maxLength:120}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Physical Location",text:"A location for your website used on certain business templates.",
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.Map,config:{name:"location",title:"Enter a location...",titleStyle:"inline",height:350,scrollwheelEnabled:!1}},{ctor:b.Squarespace.DialogFields.Description,config:{title:"Business Hours",text:"The hours your business operates. <strong>These will be visible on the Mobile Info Bar if enabled</strong>. You should specify hours using plain text:<pre>8am to 5pm\n8am to 5pm, 7pm to 11pm\n10pm to 3am\nOpen\nAll Day\n08:00 to 13:00, 17:00 to 23:00</pre>",
padding:[15,0]}},{ctor:b.Squarespace.DialogFields.BusinessHours,config:{name:"businessHours"}}],e=b.namespace("Squarespace.Settings.Site").Basic=b.Base.create("siteSettings",b.Squarespace.Widgets.SettingsPanel,[],{bindUI:function(){e.superclass.bindUI.call(this);this.on("fields-rendered",function(){var b=this.getField("location");b.get("data")||b._set("data",b.get("defaultLocation"),{silent:!0})},this);this.on("saved-changes",function(c){c=this._getSanitizedPanelData();for(var d in Static.SQUARESPACE_CONTEXT.websiteSettings)c.hasOwnProperty(d)&&
(Static.SQUARESPACE_CONTEXT.websiteSettings[d]=c[d]);Static.SQUARESPACE_CONTEXT.website.location=c.location;b.Squarespace.Utils.isDamaskEnabled()?(b.one("title").setContent(c.siteTitle),this.get("damask").get("previewFrame").requestRefresh()):b.one(".site-title span").setContent(c.siteTitle)})},_getSanitizedPanelData:function(){var c=e.superclass._getSanitizedPanelData.call(this);b.Array.each(["logoImage","favicon"],function(b){c[b]&&(c[b+"Id"]=c[b].get("id"),delete c[b])});c.subjects=b.JSON.stringify(c.subjects);
return c}},{CSS_PREFIX:"sqs-basic-settings",ATTRS:{initialDataUrl:{value:"/api/config/GetSiteSettings"},initialDataPropertyName:{value:"settings"},saveUrl:{value:"/api/config/SaveSiteSettings"},"strings.title":{value:"Basic Information"},"strings.description":{value:d},fields:{value:c},damask:{}}})},"1.0",{requires:"node oop anim json datatype-number squarespace-help squarespace-dialog-description squarespace-dialog-file-image squarespace-dialog-select squarespace-dialog-map squarespace-dialog-website-subjects squarespace-dialog-wysiwyg squarespace-settings-panel squarespace-dialog-business-hours".split(" ")});
YUI.add("squarespace-content-manager-widgets-template-page",function(b){b.namespace("Squarespace.ContentManagerWidgets").TemplatePage=b.Base.create("templatePageContentManagerWidget",b.Squarespace.ContentManagerWidgets.Base,[],{initializer:function(){this.add({childType:b.Squarespace.ContentManagerWidgets.PlaceHolderWidget,strings:this.get("strings"),icon:"template-page"})},hasUnsavedChanges:function(){return!1}},{CSS_PREFIX:"sqs-content-manager-template-page",ATTRS:{addContentButtonVisible:{value:!1},
strings:{value:{title:"Template Page",description:"This page has a fixed design set by your current template.  Use the controls in the upper right to view this page."}}}})},"1.0",{requires:["squarespace-content-manager-widgets-base","squarespace-content-manager-widgets-placeholder"]});
YUI.add("squarespace-oauth-authenticator",function(b){b.namespace("Squarespace");b.Squarespace.OAuthAuthenticator=b.Base.create("oauthAuthenticator",b.Base,[],{authenticate:function(d,c,e){b.Lang.isObject(c)&&(e=c,c=void 0);d=b.Squarespace.ExternalServiceProviders[d.toUpperCase()];c=b.merge({serviceProvider:d,type:"website",existingAccountId:c},e);this._oauthWindow=window.open("/auth/ExternalAuthenticationInitiate?"+b.QueryString.stringify(c),"AddConnectedAccount","location=0,status=0,width=1020,height=520");
this.closeCheckHandle=b.later(500,this,this._closeCheck,{},!0)},_closeCheck:function(){if(this._oauthWindow.closed||window.callbackFinished)window.callbackFinished=!1,this.fire("oauth-completed"),this.closeCheckHandle.cancel()}})},"1.0",{requires:["base","base-build","querystring-stringify"]});
YUI.add("squarespace-block-email-footer-editor",function(b){b.namespace("Squarespace.Block.Editor").EmailFooter=b.Base.create("email-footer-block-editor",b.Squarespace.Block.Editor.Base,[],{initializer:function(){this.get("host").set("floatable",!1);this.set("lockedLayout",!0)}},{NS:"blockEditor",ATTRS:{blockName:{value:"EmailFooter"},minHSize:{value:6}}})},"1.0",{requires:["base","squarespace-block-editor-base"]});
YUI.add("squarespace-tab-view-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["tab-view.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n    <div class="navigation-title">';(f=d.title)?f=f.call(b,{hash:{},data:c}):(f=b.title,f=typeof f===t?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "}function p(b,c){var e,f;e='\n    <div class="navigation-description">';(f=d.description)?f=f.call(b,{hash:{},data:c}):(f=b.description,f=typeof f===
t?f.apply(b):f);if(f||0===f)e+=f;return e+"</div>\n  "}function q(b,c){var e,f;e="\n      ";if((f=u.invokePartial(h["tab-view-tab-group.html"],"tab-view-tab-group.html",b,d,h,c))||0===f)e+=f;return e+"\n    "}function r(b,c){var e,f;e="\n      ";if((f=u.invokePartial(h["tab-view-tab.html"],"tab-view-tab.html",b,d,h,c))||0===f)e+=f;return e+"\n    "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,b.helpers);h=this.merge(h,b.partials);k=k||{};b="";var s,t="function",u=this;if((s=d["with"].call(c,c.strings,
{hash:{},inverse:u.noop,fn:u.program(1,function(b,c){var e,f;e="\n  ";if((f=d["if"].call(b,b.title,{hash:{},inverse:u.noop,fn:u.program(2,l,c),data:c}))||0===f)e+=f;e+="\n  ";if((f=d["if"].call(b,b.description,{hash:{},inverse:u.noop,fn:u.program(4,p,c),data:c}))||0===f)e+=f;return e+"\n"},k),data:k}))||0===s)b+=s;b+='\n<div class="sqs-tab-view-self">\n  ';if((s=d.each.call(c,c.widgets,{hash:{},inverse:u.noop,fn:u.program(6,function(b,c){var e,f;e="\n    ";if((f=d["if"].call(b,b.widgets,{hash:{},
inverse:u.program(9,r,c),fn:u.program(7,q,c),data:c}))||0===f)e+=f;return e+"\n  "},k),data:k}))||0===s)b+=s;return b+"\n</div>"})})();b.Handlebars.registerPartial("tab-view.html".replace("/","."),d.templates["tab-view.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-block-quote",function(b){b.namespace("Squarespace.Block").Quote=b.Base.create("block-quote",b.Squarespace.Block.ModelSyncBase,[],{},{CSS_PREFIX:"sqs-block-quote",MODEL:b.Squarespace.ContentModel.Quote,ATTRS:{editor:{value:b.Squarespace.Block.Editor.Quote}}})},"1.0",{requires:"squarespace-ss-widget squarespace-block-base-modelsync squarespace-block-quote-editor squarespace-block-quote-model squarespace-block-content-html widget-parent".split(" ")});
YUI.add("squarespace-stats-timeline-data-table",function(b){var d=b.namespace("Squarespace.Stats.Widgets").TimelineDataTable=b.Base.create("statsTimelineDataTable",b.Squarespace.Widgets.SSWidget,[],{renderUI:function(){d.superclass.renderUI.apply(this,arguments)},bindUI:function(){d.superclass.bindUI.apply(this,arguments);var b=this.get("model"),e=this.get("stackGraph");b.after("streamsByValueChange",function(b){b.newVal.sort(function(b,c){return c.extentCount-b.extentCount});this.set("streams",b.newVal)},
this);b.after("normalizedDataChange",this.syncUI,this);e.after("drilldownKeyChange",this.syncUI,this)},syncUI:function(){d.superclass.syncUI.apply(this,arguments);var c=this.get("model"),e=this.get("streams"),f=this.get("stackGraph"),g=f.get("drilldownKey"),h=this.get("title"),k=this.get("savedStreams"),l=this.get("contentBox"),p=l.one("tbody"),q=0,r,s,t=null;if(g)for(var u=0;u<e.length;u++)if(e[u].key===g){e=[e[u]];break}var g=e.length,u=function(b){null===t?p.append(b):t.insert(b,"after");t=b},
v=function(){var b=this.getData("key"),c=f.get("drilldownKey");b&&f.set("drilldownKey",c?null:b)};r=h.dataType[c.get("dataType")];h=h.dataMetric[c.get("dataMetric")];l.one(".section-title").setHTML(r.header);l.one("thead tr td.count").setHTML(h);l.one("thead tr td.description").setHTML(r.description);for(l.one("thead tr td.count-graph").setHTML(h+" Over Time");q<g;q++)l=e[q],h=l.values.reverse(),b.Object.hasKey(k,l.key)?(r=k[l.key],s=r.row,s.one(".count").set("text",this._formatTotal(l.extentCount)),
s.one(".percentage-text").set("text",l.extentPercentage),l.title&&s.one(".title-text").set("text",l.title),s.one(".description-text").set("text",l.key),u(s),r.graph.set("cls","stream-"+r.index),r.graph.set("data",h)):(r=l.title?b.Lang.sub('<div class="title-text split-text">{title}</div><div class="description-text split-text">{key}</div>',{title:l.title,key:l.key}):b.Lang.sub('<div class="description-text">{key}</div>',{key:l.key}),s=b.Node.create(b.Lang.sub(this.constructor.ROW_TEMPLATE,{extentCount:this._formatTotal(l.extentCount),
extentPercentage:l.extentPercentage,desc:r})).setData("key",l.key),s.on("dblclick",v),u(s),k[l.key]={row:s,index:q,graph:this._renderGraph(s.one(".graph-container"),h,c,q,l.key)}),k[l.key].updated=!0;for(var w in k)r=k[w],r.updated||(r.graph.destroy(),r.row.remove(!0),delete k[w]),r.updated=!1},_renderGraph:function(c,d,f,g,h){c=new b.Squarespace.Stats.Widgets.AreaGraph({render:c,data:d,model:f,cls:"stream-"+g,animate:!0});d=c.get("svg");var k=d.node();g=parseInt(d.attr("height"),10);var l=c.get("x"),
p=this.get("stackGraph"),q=d.append("g").attr("class","marker").style("display","none");q.append("line").attr("class","x line").attr("y1",g);d.on("mouseover",function(){q.style("display",null);p._onMouseover()}).on("mouseout",function(){q.style("display","none");p._onStreamMouseout();p._onMouseout()}).on("mousemove",function(){var b,c,d=d3.mouse(k),e=d3.bisector(function(b){return b.d}).left,d=l.invert(d[0]),g=3!==f.get("dataMetric")?p.get("totalsData"):p.get("totals"),w=e(g,d),e=g[w-1],g=g[w];e&&
g&&q.attr("transform","translate("+l((d-e.d>g.d-d?g:e).d)+", 0)");p.get("svg").select(".stack").selectAll(".stream").each(function(d,e){h===d.key&&(b=d,c=this)});p._onStreamMouseover(b,c);p._onMousemove(d)});return c},_formatTotal:function(c){return b.Number.format(c,{thousandsSeparator:",",decimalSeparator:"."})}},{CSS_PREFIX:"sqs-stats-timeline-data-table",TEMPLATE:'<div><div class="section-title">Popular Content (URL)</div><table class="activity-by-content"><thead><tr><td class="count">Visits</td><td class="percentage">%</td><td class="description">Title</td><td class="count-graph">Visits Over Time</td></tr></thead><tbody></tbody></table></div>',
ROW_TEMPLATE:'<tr><td class="count">{extentCount}</td><td class="percentage"><span class="percentage-text">{extentPercentage}</span>%</td><td class="description">{desc}</td><td class="count-graph"><div class="graph-container"></div></td></tr>',ATTRS:{model:{value:null},stackGraph:{value:null},width:{value:800},height:{value:"auto"},streams:{value:[]},savedStreams:{value:{}},title:{value:{dataType:{2:{header:"Popular Content (URL)",description:"Title"},4:{header:"Popular Browsers",description:"Browser"},
5:{header:"Popular Operating Systems",description:"OS"},6:{header:"Popular Countries",description:"Country"},7:{header:"Popular Referrers",description:"Referrer"}},dataMetric:{1:"Views",2:"Visits",3:"Visitors"}}}}})},"1.0",{requires:["base-base","squarespace-ss-widget","squarespace-attr-validators","squarespace-stats-area-graph"]});
YUI.add("handlebars-compiler",function(b,d){var c=b.Handlebars,e=function(){function b(){this.yy={}}var c={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,
INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",31:"STRING",32:"INTEGER",33:"BOOLEAN",36:"ID",37:"EQUALS",38:"DATA",40:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,
3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function(b,c,d,e,f,g,h){b=g.length-1;switch(f){case 1:return g[b-1];case 2:this.$=new e.ProgramNode([],g[b]);break;case 3:this.$=new e.ProgramNode(g[b-2],g[b]);break;case 4:this.$=new e.ProgramNode(g[b-1],[]);break;case 5:this.$=new e.ProgramNode(g[b]);
break;case 6:this.$=new e.ProgramNode([],[]);break;case 7:this.$=new e.ProgramNode([]);break;case 8:this.$=[g[b]];break;case 9:g[b-1].push(g[b]);this.$=g[b-1];break;case 10:this.$=new e.BlockNode(g[b-2],g[b-1].inverse,g[b-1],g[b]);break;case 11:this.$=new e.BlockNode(g[b-2],g[b-1],g[b-1].inverse,g[b]);break;case 12:this.$=g[b];break;case 13:this.$=g[b];break;case 14:this.$=new e.ContentNode(g[b]);break;case 15:this.$=new e.CommentNode(g[b]);break;case 16:this.$=new e.MustacheNode(g[b-1][0],g[b-1][1]);
break;case 17:this.$=new e.MustacheNode(g[b-1][0],g[b-1][1]);break;case 18:this.$=g[b-1];break;case 19:this.$=new e.MustacheNode(g[b-1][0],g[b-1][1],"&"===g[b-2][2]);break;case 20:this.$=new e.MustacheNode(g[b-1][0],g[b-1][1],!0);break;case 21:this.$=new e.PartialNode(g[b-1]);break;case 22:this.$=new e.PartialNode(g[b-2],g[b-1]);break;case 24:this.$=[[g[b-2]].concat(g[b-1]),g[b]];break;case 25:this.$=[[g[b-1]].concat(g[b]),null];break;case 26:this.$=[[g[b-1]],g[b]];break;case 27:this.$=[[g[b]],null];
break;case 28:this.$=[[g[b]],null];break;case 29:g[b-1].push(g[b]);this.$=g[b-1];break;case 30:this.$=[g[b]];break;case 31:this.$=g[b];break;case 32:this.$=new e.StringNode(g[b]);break;case 33:this.$=new e.IntegerNode(g[b]);break;case 34:this.$=new e.BooleanNode(g[b]);break;case 35:this.$=g[b];break;case 36:this.$=new e.HashNode(g[b]);break;case 37:g[b-1].push(g[b]);this.$=g[b-1];break;case 38:this.$=[g[b]];break;case 39:this.$=[g[b-2],g[b]];break;case 40:this.$=[g[b-2],new e.StringNode(g[b])];break;
case 41:this.$=[g[b-2],new e.IntegerNode(g[b])];break;case 42:this.$=[g[b-2],new e.BooleanNode(g[b])];break;case 43:this.$=[g[b-2],g[b]];break;case 44:this.$=new e.PartialNameNode(g[b]);break;case 45:this.$=new e.PartialNameNode(new e.StringNode(g[b]));break;case 46:this.$=new e.PartialNameNode(new e.IntegerNode(g[b]));break;case 47:this.$=new e.DataNode(g[b]);break;case 48:this.$=new e.IdNode(g[b]);break;case 49:g[b-2].push({part:g[b],separator:g[b-1]});this.$=g[b-2];break;case 50:this.$=[{part:g[b]}]}},
table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,
8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,
14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,
14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,
28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,
31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,
35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,
16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],
33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function(b,
c){throw Error(b);},parse:function(b){var c=[0],d=[null],e=[],f=this.table,g="",h=0,k=0,l=0;this.lexer.setInput(b);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});b=this.lexer.yylloc;e.push(b);var p=this.lexer.options&&this.lexer.options.ranges;"function"===typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var q,r,s,H,G={},aa,D;;){s=c[c.length-1];if(this.defaultActions[s])H=this.defaultActions[s];else{if(null===
q||"undefined"==typeof q)q=void 0,q=this.lexer.lex()||1,"number"!==typeof q&&(q=this.symbols_[q]||q);H=f[s]&&f[s][q]}if("undefined"===typeof H||!H.length||!H[0]){var M="";if(!l){D=[];for(aa in f[s])this.terminals_[aa]&&2<aa&&D.push("'"+this.terminals_[aa]+"'");M=this.lexer.showPosition?"Parse error on line "+(h+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+D.join(", ")+", got '"+(this.terminals_[q]||q)+"'":"Parse error on line "+(h+1)+": Unexpected "+(1==q?"end of input":"'"+(this.terminals_[q]||
q)+"'");this.parseError(M,{text:this.lexer.match,token:this.terminals_[q]||q,line:this.lexer.yylineno,loc:b,expected:D})}}if(H[0]instanceof Array&&1<H.length)throw Error("Parse Error: multiple actions possible at state: "+s+", token: "+q);switch(H[0]){case 1:c.push(q);d.push(this.lexer.yytext);e.push(this.lexer.yylloc);c.push(H[1]);q=null;r?(q=r,r=null):(k=this.lexer.yyleng,g=this.lexer.yytext,h=this.lexer.yylineno,b=this.lexer.yylloc,0<l&&l--);break;case 2:D=this.productions_[H[1]][1];G.$=d[d.length-
D];G._$={first_line:e[e.length-(D||1)].first_line,last_line:e[e.length-1].last_line,first_column:e[e.length-(D||1)].first_column,last_column:e[e.length-1].last_column};p&&(G._$.range=[e[e.length-(D||1)].range[0],e[e.length-1].range[1]]);s=this.performAction.call(G,g,k,h,this.yy,H[1],d,e);if("undefined"!==typeof s)return s;D&&(c=c.slice(0,-2*D),d=d.slice(0,-1*D),e=e.slice(0,-1*D));c.push(this.productions_[H[1]][0]);d.push(G.$);e.push(G._$);H=f[c[c.length-2]][c[c.length-1]];c.push(H);break;case 3:return!0}}return!0}},
d=function(){return{EOF:1,parseError:function(b,c){if(this.yy.parser)this.yy.parser.parseError(b,c);else throw Error(b);},setInput:function(b){this._input=b;this._more=this._less=this.done=!1;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};this.options.ranges&&(this.yylloc.range=[0,0]);this.offset=0;return this},input:function(){var b=this._input[0];this.yytext+=b;this.yyleng++;this.offset++;
this.match+=b;this.matched+=b;b.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++;this.options.ranges&&this.yylloc.range[1]++;this._input=this._input.slice(1);return b},unput:function(b){var c=b.length,d=b.split(/(?:\r\n?|\n)/g);this._input=b+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-c-1);this.offset-=c;b=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-
1);d.length-1&&(this.yylineno-=d.length-1);var e=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:d?(d.length===b.length?this.yylloc.first_column:0)+b[b.length-d.length].length-d[0].length:this.yylloc.first_column-c};this.options.ranges&&(this.yylloc.range=[e[0],e[0]+this.yyleng-c]);return this},more:function(){this._more=!0;return this},less:function(b){this.unput(this.match.slice(b))},pastInput:function(){var b=
this.matched.substr(0,this.matched.length-this.match.length);return(20<b.length?"...":"")+b.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var b=this.match;20>b.length&&(b+=this._input.substr(0,20-b.length));return(b.substr(0,20)+(20<b.length?"...":"")).replace(/\n/g,"")},showPosition:function(){var b=this.pastInput(),c=Array(b.length+1).join("-");return b+this.upcomingInput()+"\n"+c+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var b,c,d;this._more||(this.match=
this.yytext="");for(var e=this._currentRules(),f=0;f<e.length;f++)if((c=this._input.match(this.rules[e[f]]))&&(!b||c[0].length>b[0].length))if(b=c,d=f,!this.options.flex)break;if(b){if(c=b[0].match(/(?:\r\n?|\n).*/g))this.yylineno+=c.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:c?c[c.length-1].length-c[c.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length};this.yytext+=b[0];this.match+=b[0];this.matches=
b;this.yyleng=this.yytext.length;this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]);this._more=!1;this._input=this._input.slice(b[0].length);this.matched+=b[0];b=this.performAction.call(this,this.yy,this,e[d],this.conditionStack[this.conditionStack.length-1]);this.done&&this._input&&(this.done=!1);if(b)return b}else return""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,
line:this.yylineno})},lex:function(){var b=this.next();return"undefined"!==typeof b?b:this.lex()},begin:function(b){this.conditionStack.push(b)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(b){this.begin(b)},options:{},performAction:function(b,c,d,e){switch(d){case 0:return c.yytext="\\",
14;case 1:"\\"!==c.yytext.slice(-1)&&this.begin("mu");"\\"===c.yytext.slice(-1)&&(c.yytext=c.yytext.substr(0,c.yyleng-1),this.begin("emu"));if(c.yytext)return 14;break;case 2:return 14;case 3:return"\\"!==c.yytext.slice(-1)&&this.popState(),"\\"===c.yytext.slice(-1)&&(c.yytext=c.yytext.substr(0,c.yyleng-1)),14;case 4:return c.yytext=c.yytext.substr(0,c.yyleng-4),this.popState(),15;case 5:return 25;case 6:return 16;case 7:return 20;case 8:return 19;case 9:return 19;case 10:return 23;case 11:return 22;
case 12:this.popState();this.begin("com");break;case 13:return c.yytext=c.yytext.substr(3,c.yyleng-5),this.popState(),15;case 14:return 22;case 15:return 37;case 16:return 36;case 17:return 36;case 18:return 40;case 20:return this.popState(),24;case 21:return this.popState(),18;case 22:return c.yytext=c.yytext.substr(1,c.yyleng-2).replace(/\\"/g,'"'),31;case 23:return c.yytext=c.yytext.substr(1,c.yyleng-2).replace(/\\'/g,"'"),31;case 24:return 38;case 25:return 33;case 26:return 33;case 27:return 32;
case 28:return 36;case 29:return c.yytext=c.yytext.substr(1,c.yyleng-2),36;case 30:return"INVALID";case 31:return 5}},rules:[/^(?:\\\\(?=(\{\{)))/,/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[}\/ ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,
/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],conditions:{mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:!1},emu:{rules:[3],inclusive:!1},com:{rules:[4],inclusive:!1},INITIAL:{rules:[0,1,2,31],inclusive:!0}}}}();c.lexer=d;b.prototype=c;c.Parser=b;return new b}();c.Parser=e;c.parse=function(b){if(b.constructor===
c.AST.ProgramNode)return b;c.Parser.yy=c.AST;return c.Parser.parse(b)};c.AST={};c.AST.ProgramNode=function(b,d){this.type="program";this.statements=b;d&&(this.inverse=new c.AST.ProgramNode(d))};c.AST.MustacheNode=function(b,c,d){this.type="mustache";this.escaped=!d;this.hash=c;d=this.id=b[0];b=this.params=b.slice(1);this.isHelper=(this.eligibleHelper=d.isSimple)&&(b.length||c)};c.AST.PartialNode=function(b,c){this.type="partial";this.partialName=b;this.context=c};c.AST.BlockNode=function(b,d,e,f){var g=
b.id;if(g.original!==f.original)throw new c.Exception(g.original+" doesn't match "+f.original);this.type="block";this.mustache=b;this.program=d;if((this.inverse=e)&&!this.program)this.isInverse=!0};c.AST.ContentNode=function(b){this.type="content";this.string=b};c.AST.HashNode=function(b){this.type="hash";this.pairs=b};c.AST.IdNode=function(b){this.type="ID";for(var d="",e=[],f=0,g=0,h=b.length;g<h;g++){var k=b[g].part,d=d+((b[g].separator||"")+k);if(".."===k||"."===k||"this"===k){if(0<e.length)throw new c.Exception("Invalid path: "+
d);".."===k?f++:this.isScoped=!0}else e.push(k)}this.original=d;this.parts=e;this.string=e.join(".");this.depth=f;this.isSimple=1===b.length&&!this.isScoped&&0===f;this.stringModeValue=this.string};c.AST.PartialNameNode=function(b){this.type="PARTIAL_NAME";this.name=b.original};c.AST.DataNode=function(b){this.type="DATA";this.id=b};c.AST.StringNode=function(b){this.type="STRING";this.original=this.string=this.stringModeValue=b};c.AST.IntegerNode=function(b){this.type="INTEGER";this.original=this.integer=
b;this.stringModeValue=Number(b)};c.AST.BooleanNode=function(b){this.type="BOOLEAN";this.bool=b;this.stringModeValue="true"===b};c.AST.CommentNode=function(b){this.type="comment";this.comment=b};var f=c.Compiler=function(){},g=c.JavaScriptCompiler=function(){};f.prototype={compiler:f,disassemble:function(){for(var b=this.opcodes,c,d=[],e,f,g=0,h=b.length;g<h;g++)if(c=b[g],"DECLARE"===c.opcode)d.push("DECLARE "+c.name+"="+c.value);else{e=[];for(var k=0;k<c.args.length;k++)f=c.args[k],"string"===typeof f&&
(f='"'+f.replace("\n","\\n")+'"'),e.push(f);d.push(c.opcode+" "+e.join(" "))}return d.join("\n")},equals:function(b){var c=this.opcodes.length;if(b.opcodes.length!==c)return!1;for(var d=0;d<c;d++){var e=this.opcodes[d],f=b.opcodes[d];if(e.opcode!==f.opcode||e.args.length!==f.args.length)return!1;for(var g=0;g<e.args.length;g++)if(e.args[g]!==f.args[g])return!1}c=this.children.length;if(b.children.length!==c)return!1;for(d=0;d<c;d++)if(!this.children[d].equals(b.children[d]))return!1;return!0},guid:0,
compile:function(b,c){this.children=[];this.depths={list:[]};this.options=c;var d=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(d)for(var e in d)this.options.knownHelpers[e]=d[e];return this.program(b)},accept:function(b){return this[b.type](b)},program:function(b){b=b.statements;var c;this.opcodes=[];for(var d=0,e=b.length;d<e;d++)c=b[d],this[c.type](c);this.isSimple=1===e;this.depths.list=this.depths.list.sort(function(b,
c){return b-c});return this},compileProgram:function(b){b=(new this.compiler).compile(b,this.options);var c=this.guid++,d;this.usePartial=this.usePartial||b.usePartial;this.children[c]=b;for(var e=0,f=b.depths.list.length;e<f;e++)d=b.depths.list[e],2>d||this.addDepth(d-1);return c},block:function(b){var c=b.mustache,d=b.program;b=b.inverse;d&&(d=this.compileProgram(d));b&&(b=this.compileProgram(b));var e=this.classifyMustache(c);"helper"===e?this.helperMustache(c,d,b):"simple"===e?(this.simpleMustache(c),
this.opcode("pushProgram",d),this.opcode("pushProgram",b),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(c,d,b),this.opcode("pushProgram",d),this.opcode("pushProgram",b),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue"));this.opcode("append")},hash:function(b){b=b.pairs;var c,d;this.opcode("pushHash");for(var e=0,f=b.length;e<f;e++)c=b[e],d=c[1],this.options.stringParams?(d.depth&&this.addDepth(d.depth),this.opcode("getContext",d.depth||0),this.opcode("pushStringParam",
d.stringModeValue,d.type)):this.accept(d),this.opcode("assignToHash",c[0]);this.opcode("popHash")},partial:function(b){var c=b.partialName;this.usePartial=!0;b.context?this.ID(b.context):this.opcode("push","depth0");this.opcode("invokePartial",c.name);this.opcode("append")},content:function(b){this.opcode("appendContent",b.string)},mustache:function(b){var c=this.options,d=this.classifyMustache(b);"simple"===d?this.simpleMustache(b):"helper"===d?this.helperMustache(b):this.ambiguousMustache(b);b.escaped&&
!c.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousMustache:function(b,c,d){b=b.id;var e=b.parts[0],f=null!=c||null!=d;this.opcode("getContext",b.depth);this.opcode("pushProgram",c);this.opcode("pushProgram",d);this.opcode("invokeAmbiguous",e,f)},simpleMustache:function(b){b=b.id;"DATA"===b.type?this.DATA(b):b.parts.length?this.ID(b):(this.addDepth(b.depth),this.opcode("getContext",b.depth),this.opcode("pushContext"));this.opcode("resolvePossibleLambda")},helperMustache:function(b,
c,d){c=this.setupFullMustacheParams(b,c,d);b=b.id.parts[0];if(this.options.knownHelpers[b])this.opcode("invokeKnownHelper",c.length,b);else{if(this.options.knownHelpersOnly)throw Error("You specified knownHelpersOnly, but used the unknown helper "+b);this.opcode("invokeHelper",c.length,b)}},ID:function(b){this.addDepth(b.depth);this.opcode("getContext",b.depth);b.parts[0]?this.opcode("lookupOnContext",b.parts[0]):this.opcode("pushContext");for(var c=1,d=b.parts.length;c<d;c++)this.opcode("lookup",
b.parts[c])},DATA:function(b){this.options.data=!0;if(b.id.isScoped||b.id.depth)throw new c.Exception("Scoped data references are not supported: "+b.original);this.opcode("lookupData");b=b.id.parts;for(var d=0,e=b.length;d<e;d++)this.opcode("lookup",b[d])},STRING:function(b){this.opcode("pushString",b.string)},INTEGER:function(b){this.opcode("pushLiteral",b.integer)},BOOLEAN:function(b){this.opcode("pushLiteral",b.bool)},comment:function(){},opcode:function(b){this.opcodes.push({opcode:b,args:[].slice.call(arguments,
1)})},declare:function(b,c){this.opcodes.push({opcode:"DECLARE",name:b,value:c})},addDepth:function(b){if(isNaN(b))throw Error("EWOT");0!==b&&!this.depths[b]&&(this.depths[b]=!0,this.depths.list.push(b))},classifyMustache:function(b){var c=b.isHelper,d=b.eligibleHelper,e=this.options;d&&!c&&(e.knownHelpers[b.id.parts[0]]?c=!0:e.knownHelpersOnly&&(d=!1));return c?"helper":d?"ambiguous":"simple"},pushParams:function(b){for(var c=b.length,d;c--;)if(d=b[c],this.options.stringParams)d.depth&&this.addDepth(d.depth),
this.opcode("getContext",d.depth||0),this.opcode("pushStringParam",d.stringModeValue,d.type);else this[d.type](d)},setupMustacheParams:function(b){var c=b.params;this.pushParams(c);b.hash?this.hash(b.hash):this.opcode("emptyHash");return c},setupFullMustacheParams:function(b,c,d){var e=b.params;this.pushParams(e);this.opcode("pushProgram",c);this.opcode("pushProgram",d);b.hash?this.hash(b.hash):this.opcode("emptyHash");return e}};var h=function(b){this.value=b};g.prototype={nameLookup:function(b,
c){return/^[0-9]+$/.test(c)?b+"["+c+"]":g.isValidJavaScriptVariableName(c)?b+"."+c:b+"['"+c+"']"},appendToBuffer:function(b){return this.environment.isSimple?"return "+b+";":{appendToBuffer:!0,content:b,toString:function(){return"buffer += "+b+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(b,d,e,f){this.environment=b;this.options=d||{};c.log(c.logger.DEBUG,this.environment.disassemble()+"\n\n");this.name=this.environment.name;this.isChild=
!!e;this.context=e||{programs:[],environments:[],aliases:{}};this.preamble();this.stackSlot=0;this.stackVars=[];this.registers={list:[]};this.compileStack=[];this.inlineStack=[];this.compileChildren(b,d);b=b.opcodes;this.i=0;for(p=b.length;this.i<p;this.i++)d=b[this.i],"DECLARE"===d.opcode?this[d.name]=d.value:this[d.opcode].apply(this,d.args);return this.createFunctionContext(f)},nextOpcode:function(){return this.environment.opcodes[this.i+1]},eat:function(){this.i+=1},preamble:function(){var b=
[];if(this.isChild)b.push("");else{var c=this.namespace,d="helpers = this.merge(helpers, "+c+".helpers);";this.environment.usePartial&&(d=d+" partials = this.merge(partials, "+c+".partials);");this.options.data&&(d+=" data = data || {};");b.push(d)}this.environment.isSimple?b.push(""):b.push(", buffer = "+this.initializeBuffer());this.lastContext=0;this.source=b},createFunctionContext:function(b){var d=this.stackVars.concat(this.registers.list);0<d.length&&(this.source[1]=this.source[1]+", "+d.join(", "));
if(!this.isChild)for(var e in this.context.aliases)this.context.aliases.hasOwnProperty(e)&&(this.source[1]=this.source[1]+", "+e+"="+this.context.aliases[e]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";");this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n");this.environment.isSimple||this.source.push("return buffer;");d=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];e=0;for(var f=this.environment.depths.list.length;e<
f;e++)d.push("depth"+this.environment.depths.list[e]);e=this.mergeSource();this.isChild||(f=c.COMPILER_REVISION,e="this.compilerInfo = ["+f+",'"+c.REVISION_CHANGES[f]+"'];\n"+e);if(b)return d.push(e),Function.apply(this,d);b="function "+(this.name||"")+"("+d.join(",")+") {\n  "+e+"}";c.log(c.logger.DEBUG,b+"\n\n");return b},mergeSource:function(){for(var b="",c,d=0,e=this.source.length;d<e;d++){var f=this.source[d];f.appendToBuffer?c=c?c+"\n    + "+f.content:f.content:(c&&(b+="buffer += "+c+";\n  ",
c=void 0),b+=f+"\n  ")}return b},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var b=["depth0"];this.setupParams(0,b);this.replaceStack(function(c){b.splice(1,0,c);return"blockHelperMissing.call("+b.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var b=["depth0"];this.setupParams(0,b);var c=this.topStack();b.splice(1,0,c);b[b.length-1]="options";this.source.push("if (!"+this.lastHelper+
") { "+c+" = blockHelperMissing.call("+b.join(", ")+"); }")},appendContent:function(b){this.source.push(this.appendToBuffer(this.quotedString(b)))},append:function(){this.flushInline();var b=this.popStack();this.source.push("if("+b+" || "+b+" === 0) { "+this.appendToBuffer(b)+" }");this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression";this.source.push(this.appendToBuffer("escapeExpression("+
this.popStack()+")"))},getContext:function(b){this.lastContext!==b&&(this.lastContext=b)},lookupOnContext:function(b){this.push(this.nameLookup("depth"+this.lastContext,b,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"';this.replaceStack(function(b){return"typeof "+b+" === functionType ? "+b+".apply(depth0) : "+b})},lookup:function(b){this.replaceStack(function(c){return c+" == null || "+
c+" === false ? "+c+" : "+this.nameLookup(c,b,"context")})},lookupData:function(b){this.push("data")},pushStringParam:function(b,c){this.pushStackLiteral("depth"+this.lastContext);this.pushString(c);"string"===typeof b?this.pushString(b):this.pushStackLiteral(b)},emptyHash:function(){this.pushStackLiteral("{}");this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var b=this.hash;
this.hash=void 0;this.options.stringParams&&(this.register("hashContexts","{"+b.contexts.join(",")+"}"),this.register("hashTypes","{"+b.types.join(",")+"}"));this.push("{\n    "+b.values.join(",\n    ")+"\n  }")},pushString:function(b){this.pushStackLiteral(this.quotedString(b))},push:function(b){this.inlineStack.push(b);return b},pushLiteral:function(b){this.pushStackLiteral(b)},pushProgram:function(b){null!=b?this.pushStackLiteral(this.programExpression(b)):this.pushStackLiteral(null)},invokeHelper:function(b,
c){this.context.aliases.helperMissing="helpers.helperMissing";var d=this.lastHelper=this.setupHelper(b,c,!0),e=this.nameLookup("depth"+this.lastContext,c,"context");this.push(d.name+" || "+e);this.replaceStack(function(b){return b+" ? "+b+".call("+d.callParams+") : helperMissing.call("+d.helperMissingParams+")"})},invokeKnownHelper:function(b,c){var d=this.setupHelper(b,c);this.push(d.name+".call("+d.callParams+")")},invokeAmbiguous:function(b,c){this.context.aliases.functionType='"function"';this.pushStackLiteral("{}");
var d=this.setupHelper(0,b,c),e=this.lastHelper=this.nameLookup("helpers",b,"helper"),f=this.nameLookup("depth"+this.lastContext,b,"context"),g=this.nextStack();this.source.push("if ("+g+" = "+e+") { "+g+" = "+g+".call("+d.callParams+"); }");this.source.push("else { "+g+" = "+f+"; "+g+" = typeof "+g+" === functionType ? "+g+".apply(depth0) : "+g+"; }")},invokePartial:function(b){b=[this.nameLookup("partials",b,"partial"),"'"+b+"'",this.popStack(),"helpers","partials"];this.options.data&&b.push("data");
this.context.aliases.self="this";this.push("self.invokePartial("+b.join(", ")+")")},assignToHash:function(b){var c=this.popStack(),d,e;this.options.stringParams&&(e=this.popStack(),d=this.popStack());var f=this.hash;d&&f.contexts.push("'"+b+"': "+d);e&&f.types.push("'"+b+"': "+e);f.values.push("'"+b+"': ("+c+")")},compiler:g,compileChildren:function(b,c){for(var d=b.children,e,f,g=0,h=d.length;g<h;g++){e=d[g];f=new this.compiler;var k=this.matchExistingProgram(e);null==k?(this.context.programs.push(""),
k=this.context.programs.length,e.index=k,e.name="program"+k,this.context.programs[k]=f.compile(e,c,this.context),this.context.environments[k]=e):(e.index=k,e.name="program"+k)}},matchExistingProgram:function(b){for(var c=0,d=this.context.environments.length;c<d;c++){var e=this.context.environments[c];if(e&&e.equals(b))return c}},programExpression:function(b){this.context.aliases.self="this";if(null==b)return"self.noop";var c=this.environment.children[b];b=c.depths.list;for(var d=[c.index,c.name,"data"],
e=0,f=b.length;e<f;e++)c=b[e],1===c?d.push("depth0"):d.push("depth"+(c-1));return(0===b.length?"self.program(":"self.programWithDepth(")+d.join(", ")+")"},register:function(b,c){this.useRegister(b);this.source.push(b+" = "+c+";")},useRegister:function(b){this.registers[b]||(this.registers[b]=!0,this.registers.list.push(b))},pushStackLiteral:function(b){return this.push(new h(b))},pushStack:function(b){this.flushInline();var c=this.incrStack();b&&this.source.push(c+" = "+b+";");this.compileStack.push(c);
return c},replaceStack:function(b){var c="",d=this.isInline(),e;d?(e=this.popStack(!0),e instanceof h?e=e.value:(c=this.stackSlot?this.topStackName():this.incrStack(),c="("+this.push(c)+" = "+e+"),",e=this.topStack())):e=this.topStack();b=b.call(this,e);d?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+c+b+")")):(/^stack/.test(e)||(e=this.nextStack()),this.source.push(e+" = ("+c+b+");"));return e},nextStack:function(){return this.pushStack()},incrStack:function(){this.stackSlot++;
this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot);return this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var b=this.inlineStack;if(b.length){this.inlineStack=[];for(var c=0,d=b.length;c<d;c++){var e=b[c];e instanceof h?this.compileStack.push(e):this.pushStack(e)}}},isInline:function(){return this.inlineStack.length},popStack:function(b){var c=this.isInline(),d=(c?this.inlineStack:this.compileStack).pop();if(!b&&d instanceof
h)return d.value;c||this.stackSlot--;return d},topStack:function(b){var c=this.isInline()?this.inlineStack:this.compileStack,c=c[c.length-1];return!b&&c instanceof h?c.value:c},quotedString:function(b){return'"'+b.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(b,c,d){var e=[];this.setupParams(b,e,d);b=this.nameLookup("helpers",c,"helper");return{params:e,name:b,callParams:["depth0"].concat(e).join(", "),
helperMissingParams:d&&["depth0",this.quotedString(c)].concat(e).join(", ")}},setupParams:function(b,c,d){var e=[],f=[],g=[],h,k;e.push("hash:"+this.popStack());h=this.popStack();if((k=this.popStack())||h)k||(this.context.aliases.self="this",k="self.noop"),h||(this.context.aliases.self="this",h="self.noop"),e.push("inverse:"+h),e.push("fn:"+k);for(k=0;k<b;k++)h=this.popStack(),c.push(h),this.options.stringParams&&(g.push(this.popStack()),f.push(this.popStack()));this.options.stringParams&&(e.push("contexts:["+
f.join(",")+"]"),e.push("types:["+g.join(",")+"]"),e.push("hashContexts:hashContexts"),e.push("hashTypes:hashTypes"));this.options.data&&e.push("data:data");e="{"+e.join(",")+"}";d?(this.register("options",e),c.push("options")):c.push(e);return c.join(", ")}};for(var e="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),
k=g.RESERVED_WORDS={},l=0,p=e.length;l<p;l++)k[e[l]]=!0;g.isValidJavaScriptVariableName=function(b){return!g.RESERVED_WORDS[b]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(b)?!0:!1};c.precompile=function(b,d){if(null==b||"string"!==typeof b&&b.constructor!==c.AST.ProgramNode)throw new c.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+b);d=d||{};"data"in d||(d.data=!0);var e=c.parse(b),e=(new f).compile(e,d);return(new g).compile(e,d)};c.compile=function(b,d){if(null==
b||"string"!==typeof b&&b.constructor!==c.AST.ProgramNode)throw new c.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+b);d=d||{};"data"in d||(d.data=!0);var e;return function(h,k){if(!e){var l=c.parse(b),l=(new f).compile(l,d),l=(new g).compile(l,d,void 0,!0);e=c.template(l)}return e.call(this,h,k)}};c.logger.log=function(b,c){};c.render=function(b,d,e){return c.compile(b)(d,e)}},"3.17.2",{requires:["handlebars-base"]});
YUI.add("squarespace-content-item-types-product",function(b){b.namespace("Squarespace.ContentItemEditor");var d=b.Squarespace.ContentItemEditor.Product=b.Base.create("ProductPhysicalContentItemEditor",b.Squarespace.ContentItemEditor.Base,[],{initializer:function(){var b=this.get("dialog");b.on("ready",function(){b.getField("pricingPlaceholder").on("clicked",function(){b.activateTab(null,b.params.tabs[1])})},this);b.after("tab-focused",function(d){var f=b.getField("gallery");"item"===d.tabName?f.enableDragSelection():
f.disableDragSelection()},this)},getDialogData:function(){var b=d.superclass.getDialogData.call(this),e=b.structuredContent;b.customAddButtonText=e.customAddButtonText;b.useCustomAddButtonText=e.useCustomAddButtonText;b.additionalFieldsForm=e.additionalFieldsForm;b.additionalFieldsFormId=e.additionalFieldsFormId;return b},sanitizeDialogData:function(c){c=d.superclass.sanitizeDialogData.call(this,c);c.structuredContent=b.merge(c.structuredContent,{customAddButtonText:c.customAddButtonText,useCustomAddButtonText:c.useCustomAddButtonText,
additionalFieldsFormId:c.additionalFieldsFormId});delete c.customAddButtonText;delete c.useCustomAddButtonText;delete c.additionalFieldsFormId;return c},getPresentationName:function(){throw"Must implement a Presentation Name for this product type";}})},"1.0",{requires:["base","squarespace-content-item-types-base","squarespace-models-form","squarespace-util"]});
YUI.add("squarespace-video-gallery-template",function(b){var d=b.Handlebars;(function(){var b=d.template;(d.templates=d.templates||{})["video-gallery.html"]=b(function(b,c,d,h,k){function l(b,c){var e,f;e='\n          <li class="playlist-item" data-video-id="';(f=d.id)?f=f.call(b,{hash:{},data:c}):(f=b.id,f=typeof f===p?f.apply(b):f);e+=q(f)+'" data-video-index="';(f=d.index)?f=f.call(b,{hash:{},data:c}):(f=b.index,f=typeof f===p?f.apply(b):f);e+=q(f)+'">\n            <div class="index">';(f=d.index)?
f=f.call(b,{hash:{},data:c}):(f=b.index,f=typeof f===p?f.apply(b):f);e+=q(f)+'</div>\n            <div class="info">\n              <div class="title">';(f=d.shortTitle)?f=f.call(b,{hash:{},data:c}):(f=b.shortTitle,f=typeof f===p?f.apply(b):f);e+=q(f)+'</div>\n              <div class="duration">';(f=d.duration)?f=f.call(b,{hash:{},data:c}):(f=b.duration,f=typeof f===p?f.apply(b):f);return e+=q(f)+"</div>\n            </div>\n          </li>\n        "}this.compilerInfo=[4,">= 1.0.0"];d=this.merge(d,
b.helpers);k=k||{};var p="function",q=this.escapeExpression,r=this;b='<div class="overlay"></div>\n<div class="close-button"></div>\n<div class="content">\n  <div class="player"></div>\n  ';if((c=d["if"].call(c,c.playlist,{hash:{},inverse:r.noop,fn:r.program(1,function(b,c){var e,f;e='\n    <div class="playlist">\n      <ul class="videos">\n        ';if((f=d.each.call(b,b.videos,{hash:{},inverse:r.noop,fn:r.program(2,l,c),data:c}))||0===f)e+=f;return e+"\n      </ul>\n    </div>\n  "},k),data:k}))||
0===c)b+=c;return b+"\n</div>\n"})})();b.Handlebars.registerPartial("video-gallery.html".replace("/","."),d.templates["video-gallery.html"])},"1.0",{requires:["handlebars-base"]});
YUI.add("squarespace-layout-insert-marker",function(b){var d=b.Squarespace.Block.Utils.convertToValueInPixel,c=b.namespace("Squarespace.Layout").InsertMarker=b.Base.create("insert-marker",b.Overlay,[],{renderUI:function(){this.get("lowerPerformance")||(this.constrainNode=this._createConstrainNode(),this.positionConstrainNode())},bindUI:function(){this.after("infoChange",this._syncInfoToMarker,this);this.after("lockedChange",this._onLockedChange,this);this.on("floatChange",function(b){var c=this.getClassName("float");
this.get("boundingBox").toggleClass(c,!!b.newVal)},this);b.DD.DDM.on("insertMarker|ddm:end",this.hide,this);this.get("boundingBox").plug(b.Squarespace.NodeDestroyNotifier,{onDestroy:function(){this.destroy()},context:this})},_onLockedChange:function(b){b.newVal?this.hide():this.show()},positionConstrainNode:function(){if(this.constrainNode){var c=this.get("boundingBox").get("parentNode").ancestor(".sqs-layout",!0)||b.one(".sqs-layout.sqs-editing");if(c){var c=(c.ancestor(".sqs-layout-wrapper")||c.ancestor(".sqs-content-manager")||
b.one(b.config.doc.body)).get("region"),d=c.top;this.constrainNode.setStyles({left:Math.max(c.left,0),right:Math.max(b.config.win.innerWidth-c.right,0),top:Math.max(d,0),bottom:Math.max(b.config.win.innerHeight-c.bottom,0),height:"auto",zIndex:this.get("constrainZIndex")})}}},_createConstrainNode:function(){var d=b.Node.create('<div class="'+c.CSS_PREFIX+'-constrain"></div>');b.one("body").append(d);return d},_syncInfoToMarker:function(){var c=this.get("info");if(!c||!c.node)console.warn("There is no marker info nor info node.");
else if(!this.get("locked")){var d=c.node,g=c.type,h=c.direction,k=c.region,l=b.WidgetPositionAlign,p=!1,q={node:d,points:[]};switch(h){case "top":q.points=[l.LC,l.TL];p=!0;break;case "bottom":q.points=[l.LC,l.BL];p=!0;break;case "left":q.points=[l.TC,l.TL];break;case "right":q.points=[l.TC,l.TR]}c.shouldFloat?(d=b.DD.DDM.activeDrag.get("dragNodeRegion"),k=k.width/2,c=d&&0!==d.height?k*(d.height/d.width):0.5625*k,q.points[0]="left"===h?l.TL:l.TR,this.set("float",!0)):(p?(c=this.get("lineThickness"),
k="content"===g?d.ancestor(".sqs-block").get("clientWidth"):k.width):(c="column"===g?k.height:k.bottom-k.top,k=this.get("lineThickness")),this.set("float",!1));this.setAttrs({width:k,height:c,align:q})}},destructor:function(){this.constrainNode&&this.constrainNode.remove();b.DD.DDM.detach("insertMarker|*")},_getRegion:function(c){var d;c?(c=b.Node.one(c))&&(d=c.get("region")):(d=this._posNode.get("viewportRegion"),d.height=b.config.win.innerHeight,d.bottom=d.height+b.config.win.pageYOffset);return d},
_getCollapsedVerticalMargin:function(b,c,g){var h=0;switch(g){case "top":h=Math.max(d(c.getStyle("marginBottom")),d(b.getStyle("marginTop")));break;case "bottom":h=Math.max(d(b.getStyle("marginBottom")),d(c.getStyle("marginTop")))}return h},move:function(){var c=arguments,c=b.Lang.isArray(c[0])?c[0]:[c[0],c[1]];if(!b.one("html").hasClass("scrolling")){var f=this.get("info"),g=f.node;if("content"===f.type){var h=g.ancestor(".sqs-block"),k,l=0;k=0;h&&(l="right"===f.direction?d(h.getStyle("paddingRight")):
-1*d(h.getStyle("paddingLeft")));"top"===f.direction||this.get("float")?(k=g.previous(),k=null===k&&h?-1*d(h.getStyle("paddingTop")):k?-1*this._getCollapsedVerticalMargin(g,k,f.direction)/2:-1*d(g.getStyle("marginTop"))/2):"bottom"===f.direction&&(k=g.next(),k=null===k&&h?d(h.getStyle("paddingBottom")):k?this._getCollapsedVerticalMargin(g,k,f.direction)/2:d(g.getStyle("marginBottom"))/2);c=[c[0]+l,c[1]+k]}this.set("xy",c)}}},{CSS_PREFIX:"sqs-layout-insert-marker",ATTRS:{zIndex:{value:8900},constrainZIndex:{valueFn:function(){this.get("zIndex")},
validator:function(c){return b.Lang.isString(c)||b.Lang.isNumber(c)}},info:{value:{node:null,type:"",direction:"",region:null,shouldFloat:!1},lazyAdd:!1},locked:{value:!1},lineThickness:{valueFn:function(){return b.UA.mobile?2:3}},lowerPerformance:{value:!1}}})},"1.0",{requires:["node","event","overlay","squarespace-ss-widget","squarespace-block-utils"]});
YUI.add("squarespace-widgets-commerce-coupon",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.CommerceCoupon=b.Base.create("CommerceCoupon",b.Squarespace.Widgets.Model,[b.Squarespace.Mixins.EditableModel],{bindUI:function(){d.superclass.bindUI.call(this);this.get("contentBox").on("click",function(c){if(this.get("model").get("isValid"))this._edit();else(new b.Squarespace.Widgets.Alert({"strings.title":"Coupon Invalid","strings.message":this.get("couponInvalidMessages")[this.get("model").get("type")]})).on("confirm",
this._edit,this)},this)},syncUI:function(){this.get("contentBox").setHTML(this.renderTemplate())},_getHBTemplateContext:function(){var c=d.superclass._getHBTemplateContext.call(this),e=c.model,f=e.startDate,g=e.endDate,f=this._formatDate(f),g=this._formatDate(g);return b.merge(c,{isInactiveOrExpired:!e.active||e.expired,startDate:f,endDate:g,couponSummary:b.Squarespace.CommerceCouponFormatters.getCouponSummary(e)})},_formatDate:function(c){return c=b.Lang.isUndefined(c)?"":b.Squarespace.DateUtils.dateFormat(c,
{format:"<strong>%m/%d/%Y</strong> at <strong>%l:%M %p</strong>"})}},{CSS_PREFIX:"sqs-commerce-coupon",HANDLEBARS_TEMPLATE:"widgets-commerce-coupon.html",ATTRS:{editorCtor:{value:b.Squarespace.Editor.CommerceCoupon},editorConfig:{valueFn:function(){return{validCouponCategories:this.get("validCouponCategories")}}},preventRenderTemplate:{value:!0,readOnly:!0},validCouponCategories:{value:[],writeOnce:"initOnly"},couponInvalidMessages:{valueFn:function(){var c={};c[b.Squarespace.CommerceCouponType.CATEGORIES]=
"All categories referred to by this coupon no longer exist. Please edit the coupon or deactivate it.";c[b.Squarespace.CommerceCouponType.SINGLE_PRODUCT]="The product referred to by this coupon no longer exists. Please edit the coupon or deactivate it.";return c},readOnly:!0}}})},"1.0",{requires:"base squarespace-commerce-coupon-formatters squarespace-date-utils squarespace-mixins-editable-model squarespace-widgets-model squarespace-widgets-commerce-coupon-template squarespace-editor-commerce-coupon squarespace-widgets-alert".split(" ")});
YUI.add("squarespace-widgets-order-list-manager",function(b){b.namespace("Squarespace.Widgets");var d=b.Squarespace.Widgets.OrderListManager=b.Base.create("OrderListManager",b.Squarespace.Widgets.SyncModelListManager,[],{initializer:function(){this.get("contentBox").addClass("sqs-model-list-manager-content");var b=this.get("models");b.after(["firstPage","previousPage","nextPage","currentPage"],function(){b.load()})},renderUI:function(){d.superclass.renderUI.call(this);this.get("body").set("actionTrayButtons",
this._getBodyActionTrayButtons())},bindUI:function(){d.superclass.bindUI.call(this);var b=this.get("body");this.get("header").after("currentTabChange",function(){b.set("actionTrayButtons",this._getBodyActionTrayButtons())},this)},_getBodyActionTrayButtons:function(){var c=this.get("header").get("currentTab").orderState,d=this.get("body"),f=[{label:"Print",action:d.printSelected,context:d,className:"dark"}];c===b.Squarespace.OrderStates.PENDING?f.push({label:"Mark Completed",action:d.markSelectedAsCompleted,
context:d,className:"dark"}):c===b.Squarespace.OrderStates.SHIPPED&&f.push({label:"Mark Pending",action:d.markSelectedAsPending,context:d,className:"dark"});return f}},{CSS_PREFIX:"sqs-order-list-manager",ATTRS:{constructors:{value:{models:b.Squarespace.Models.OrderList,header:b.Squarespace.Widgets.OrderListHeader,body:b.Squarespace.Widgets.OrderList}}}})},"1.0",{requires:"base squarespace-enum squarespace-models-order-list squarespace-widgets-sync-model-list-manager squarespace-widgets-order-list squarespace-widgets-order-list-header".split(" ")});
YUI.add("squarespace-layout-insert-point",function(b){var d=b.namespace("Squarespace.Layout").InsertPoint=b.Base.create("layout-insert-point",b.Plugin.Base,[],{initializer:function(){this._blockNode=this.get("host").get("boundingBox");this.after("insertPointsChange",this._bindInsertPointEvents);this._bindInsertPointEvents();this.onHostEvent("destroy",function(){this.get("controller").alignInsertPoints(this._getLayoutNode())},this);this.onHostEvent("resized",function(b){"columnChanged"===b.source&&
this.align(!0)},this);this.afterHostEvent("dropped",this._getInsertPoints,this);this.get("controller").get("enabled")&&this.align();this.registerWithController()},destructor:function(){this._clearInsertPointNodes();this._clearInsertPointEvents();this.deregisterWithController()},_getLayoutNode:function(){var b=this.get("layoutNode");b||(b=this._blockNode.ancestor(".sqs-layout"))&&this.set("layoutNode",b);return b},_getNewInsertPointNode:function(){var c=b.DOM.create('<div class="'+d.CSS_PREFIX+'"></div>');
this._docFrag.appendChild(c);return b.one(c)},_getInsertPointConfig:function(b,e,f,g){g=this._getNewInsertPointNode();"block"===b&&"bottom"===f&&g.addClass(d.CSS_PREFIX+"-topmost");g.setData("ipType",b);return{type:b,position:f,alignTo:e,node:g,offset:"row"===b?[-10,0]:null}},_getInitInsertPoints:function(){var c=this.get("host"),d=[],f=this._getLayoutNode();if(!f||!c||!c.get("boundingBox"))return console.warn("Could not init insert points",this.getAttrs()),d;this._blockNode||(this._blockNode=c.get("boundingBox"));
this._docFrag=b.config.doc.createDocumentFragment();var c=this._blockNode,g=c.ancestor(".sqs-col"),h=g?g.ancestor(".sqs-row"):null;if(g)return d.push(this._getInsertPointConfig("block",c,"top")),this._isInMultiColumnRow(g)?(this._isLastBlockInColumn()&&d.push(this._getInsertPointConfig("block",c,"bottom")),this._isFirstColumnInRow(g)&&(this._isFirstBlockInColumn()&&d.push(this._getInsertPointConfig("row",h,"top")),this._isLastBlockInColumn()&&d.push(this._getInsertPointConfig("row",h,"bottom",this._isLastRowInLayout(h))))):
this._isLastBlockInColumn()&&this._isLastRowInLayout(h)&&d.push(this._getInsertPointConfig("block",c,"bottom",!0)),this.get("divideSelectors")&&(d=d.concat(this._getDivideInsertPoints())),f.appendChild(this._docFrag),this._docFrag=null,d},_isFirstColumnInRow:function(b){return!b.previous(".sqs-col")},_isInMultiColumnRow:function(b){return 0<b.siblings(".sqs-col").size()},_isLastRowInLayout:function(b){for(;b;){if(b.next(".sqs-row, .sqs-block"))return!1;b=b.ancestor(".sqs-row",!1,".sqs-layout")}return this._blockNode.next(".sqs-row")?
!1:!0},_isFirstBlockInColumn:function(){return!this._blockNode.previous(".sqs-block:not(.sqs-destroyme)")},_isLastBlockInColumn:function(){return!this._blockNode.next(".sqs-block:not(.sqs-destroyme)")},_getDivideInsertPoints:function(){var b=this.get("divideSelectors"),b=this._savedDivideNodes=this._blockNode.all(b),d=[];1<b.size()&&b.each(function(b,c){0!==c&&d.push(this._getInsertPointConfig("content",b,"top"))},this);return d},_getInsertPoints:function(c){var d=this._blockNode,f=d.hasClass("sqs-float-left")||
d.hasClass("sqs-float-right"),g=this._isInMultiColumnRow(d.ancestor(".sqs-col")),h=this.get("insertPoints")||[],k=this.get("divideSelectors"),d=k?d.all(k):null,k=this.get("host").get("editController").getInsertMenu(this._getEditMode());if(b.Lang.isValue(k)&&k.get("visible"))return h;if(!h.length&&!f)h=this._getInitInsertPoints();else if(f)h=[];else if(d&&(!this._savedDivideNodes||!this._listsAreEqual(d,this._savedDivideNodes)))h=this._getInitInsertPoints();else if(c||g)h=this._getInitInsertPoints();
this.get("insertPoints")!==h&&this.set("insertPoints",h);return h},_listsAreEqual:function(b,d){return b.size()===d.size()&&!b.some(function(b){return-1===d.indexOf(b)})},_bindInsertPointEvents:function(){this._insertPointEvents||(this._insertPointEvents=[]);b.Array.each(this.get("insertPoints"),function(b){var d=b.node;d&&d.getDOMNode()&&(this._insertPointEvents.push(d.on("click",function(d){d.preventDefault();this._onClick(b)},this)),this._insertPointEvents.push(d.on("mouseenter",function(){this._onMouseEnter(b)},
this)),this._insertPointEvents.push(d.on("mouseleave",this._onMouseLeave,this)))},this)},_clearInsertPointNodes:function(c){c=c||this.get("insertPoints")||[];b.Array.each(c,function(b){b.node&&b.node.getDOMNode()&&b.node.remove()})},_clearInsertPointEvents:function(){if(this._insertPointEvents)for(var b=0,d=this._insertPointEvents.length;b<d;b++)this._insertPointEvents[b].detach();this._insertPointEvents=[]},align:function(c){var d=this._blockNode;if(!d||!d.getDOMNode())this.destroy();else if(c||
this.get("controller").get("enabled")){c=this._getInsertPoints(c);d=c.length;c=b.Array.filter(c,function(b){var c=b.alignTo;return!c||!c.ancestor()?(console.warn("No node to align insert point to."),b.node.remove(),!1):!0});var f=b.Array.map(c,function(b){var c=b.alignTo,d="bottom"===b.position?"bottom":"top",e=b.node.get("region"),f="content"===b.type,q=(f?this._blockNode:c).get("region").left,d=c.get("region")[d];f&&(d-=(d-c.previous().get("region").bottom)/2);q-=e.width/2;d-=e.height/2;b.offset&&
(q+=b.offset[0],d+=b.offset[1]);return{node:b.node._node,xy:[q,d]}},this);this._massSetXY(f);c.length!==d&&this.set("insertPoints",c)}},_massSetXY:function(c){var d=b.DOM;b.Array.each(c,function(b){b.pos=d.getStyle(b.node,"position");b.delta=d._getOffset(b.node);b.currentXY=d.getXY(b.node)});b.Array.each(c,function(b){b.node&&b.xy&&(null!==b.xy[0]&&d.setStyle(b.node,"left",b.xy[0]-b.currentXY[0]+b.delta[0]+"px"),null!==b.xy[1]&&d.setStyle(b.node,"top",b.xy[1]-b.currentXY[1]+b.delta[1]+"px"))},this)},
registerWithController:function(){this.get("controller").registerInsertPoint(this,this._getLayoutNode())},deregisterWithController:function(){this.get("controller").deregisterInsertPoint(this,this._getLayoutNode())},_onMouseEnter:function(b){var d=b.alignTo,f=b.position;b=b.type;var g=this.get("host").get("editController");!d||!d.inDoc()?(console.warn("no alignNode",d),this.align()):(g.setInsertMarkerLayout(this._getLayoutNode()),g.alignInsertMarker({node:d,direction:f,region:d.get("region"),type:b}))},
_onMouseLeave:function(){this.get("host").get("editController").hideInsertMarker()},_onClick:function(b){var e=d.CSS_PREFIX+"-active";b.node.addClass(e);this.openBlockMenu(b);this.toggleInsertPointsDisabled(!0);var f=this.get("host").get("editController").getInsertMenu(this._getEditMode());f.after("insertPoint|visibleChange",function(d){d.newVal||(f.detach("insertPoint|visibleChange"),b.node.removeClass(e),this.toggleInsertPointsDisabled(!1))},this);this._logMaxNumBlocks()},_logMaxNumBlocks:function(){var c=
this._getLayoutNode().all(".sqs-block:not(.sqs-block-html,.sqs-destroyme)").size();c>b.Squarespace.Constants.MAX_BLOCKS_PER_LAYOUT&&(console.warn("Appears to have "+c+" blocks in this layout."),b.Squarespace.Logger.log("Appears to have "+c+" blocks in this layout."))},openBlockMenu:function(c){c={align:{node:c.node,points:[b.WidgetPositionAlign.LC,b.WidgetPositionAlign.RC]},targetNode:c.alignTo,direction:c.position,type:c.type,scrollNode:this._getLayoutNode().LayoutEditor.get("scrollNode"),editMode:this._getEditMode()};
this.get("controller").openBlockMenu(c)},toggleInsertPointsDisabled:function(b){var d=this.get("host").get("editController");b?d.disableInsertPoints():d.enableInsertPoints()},_getEditMode:function(){return this.get("host").get("editMode")}},{NS:"insertPoint",CSS_PREFIX:"sqs-layout-insert-point",ATTRS:{insertPoints:{valueFn:"_getInitInsertPoints",setter:function(b){this._clearInsertPointNodes();this._clearInsertPointEvents();return b}},layoutNode:{value:null,validator:function(c){return null===c||
b.instanceOf(c,b.Node)}},controller:{valueFn:function(){return b.Squarespace.Singletons.InsertPointController}},divideSelectors:{value:""}}})},"1.0",{requires:["plugin","squarespace-layout-insert-point-controller","squarespace-attr-validators"]});
YUI.add("squarespace-mixins-selected-action-tray",function(b){b.namespace("Squarespace.Mixins");b.Squarespace.Mixins.SelectedActionTray=b.Base.create("SelectedActionTray",b.Base,[],{initializer:function(){var d=this.get("actionTray");this.after("actionTrayButtonsChange",function(b){d.set("buttons",b.newVal)});b.Do.after(function(){d.render(this.get("boundingBox"))},this,"renderUI",this);this.after("selectionChange",function(b){b=b.newVal;d.set("count",b?b.size():0)},this)},destructor:function(){this.get("actionTray").destroy()}},
{ATTRS:{actionTray:{valueFn:function(){return new b.Squarespace.Widgets.ActionTray({buttons:this.get("actionTrayButtons")})},validator:b.Squarespace.AttrValidators.isInstanceOf(b.Squarespace.Widgets.ActionTray),readOnly:!0},actionTrayButtons:{value:[],setter:function(b){return[{label:"Select All",action:this.selectAll,context:this,className:"light"},{label:"Clear Selection",action:this.deselectAll,context:this,className:"light"}].concat(b||[])},validator:b.Squarespace.AttrValidators.isArray},multiple:{value:!0,
validator:b.Squarespace.AttrValidators.isBoolean,writeOnce:"initOnly"},selectedModels:{getter:function(){var b=new (this.get("models").constructor),c=this.get("selection");c&&c.each(function(c){b.add(c.get("model"))});return b},readOnly:!0}}})},"1.0",{requires:["base","event-custom","squarespace-attr-validators","squarespace-tray"]});
YUI.add("squarespace-social-authenticator",function(b){var d={loadingText:"Loading...",style:"flyout",width:480,overlay:0.5,closeOthers:!1,flyoutPointerDirection:"centered",primaryTabs:[{title:"Add Account",icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.MultiOption,config:{name:"caption-position",hideDisabled:!0,defaultValue:"normal",className:"round square button icon32",iconDropPx:32,columns:4,options:[{icon:"facebook",title:"Facebook",value:"facebook"},
{icon:"twitter",title:"Twitter",value:"twitter"},{icon:"google",title:"Google",value:"googleauth2"},{icon:"tumblr",title:"Tumblr",value:"tumblr"},{icon:"dropbox",title:"Dropbox",value:"dropbox"},{icon:"foursquare",title:"Foursquare",value:"foursquare"},{icon:"instagram",title:"Instagram",value:"instagram"},{icon:"flickr",title:"Flickr",value:"flickr"},{icon:"youtube",title:"Youtube",value:"youtube"},{icon:"vimeo",title:"Vimeo",value:"vimeo"},{icon:"linkedin",title:"LinkedIn",value:"linkedin"},{icon:"dribbble",
title:"Dribbble",value:"dribbble"},{icon:"pinterest",title:"Pinterest",value:"pinterest"},{icon:"smugmug",title:"SmugMug",value:"smugmug"},{icon:"fivehundredpix",title:"500px",value:"fivehundredpix"},{icon:"email",title:"Email",value:"email"},{icon:"github",title:"Github",value:"github"}]}}]}]},c=function(){return function(c,d){d=d||"username";var e=d.slice(0,1).toUpperCase()+d.slice(1);c=c.slice(0,1).toUpperCase()+c.slice(1);return{loadingText:"Loading...",style:"flyout",width:385,overlay:0.5,flyoutPointerDirection:"centered",
closeOthers:!1,tabs:[{title:"Connect to "+c,icon:"/universal/images-v6/icons/icon-plus-16-light.png",fields:[{ctor:b.Squarespace.DialogFields.Description,config:{text:"Enter your "+c+" account "+d+" to connect it to your Squarespace site. <strong>Please be sure this information is correct.</strong>",padding:[10,10]}},{ctor:b.Squarespace.DialogFields.Text,config:{"strings.title":c+" "+e,name:"username",submitOnEnter:!0}}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Connect to "+
c}]}}}(),e=c("dribbble"),f=c("pinterest"),g=c("smugMug","nickname"),h=function(b){b=c(b);b.tabs[0].title="Add Email";b.tabs[0].fields[0].text="Enter your Email Address to add it to your Squarespace site. <strong>Please be sure this information is correct.</strong>";b.tabs[0].fields[1].config["strings.title"]="Email Address";b.buttons[1].title="Add Email";return b}("email");b.Squarespace.SocialAuthenticator=b.Base.create("socialAuthenticator",b.Base,[],{initializer:function(){this._oauthClient=new b.Squarespace.OAuthAuthenticator},
addAccount:function(){var c=new b.Squarespace.EditingDialog(d);c.show();c.getField("caption-position").set("optionClickCb",b.bind(function(d){c.cancel();switch(d){case "smugmug":var e=new b.Squarespace.EditingDialog(g);e.once("send-requested",function(){this._startOAuth(d,null,{nickname:e.getData().username});e.cancel()},this);e.show();break;case "dribbble":case "email":case "pinterest":this._createNonOAuthAccount(d);break;default:this._startOAuth(d)}c.cancel()},this))},_buildNicknameDialog:function(c){switch(c){case b.Squarespace.ExternalServiceProviders.DRIBBBLE:c=
e;break;case b.Squarespace.ExternalServiceProviders.PINTEREST:c=f;break;case b.Squarespace.ExternalServiceProviders.EMAIL:c=h;break;default:return null}return new b.Squarespace.EditingDialog(c)},_createNonOAuthAccount:function(c){var d=b.Squarespace.ExternalServiceProviders[c.toUpperCase()],e=this._buildNicknameDialog(d);e.once("send-requested",function(){b.Data.sendForm(e,{url:"/api/config/CreateNonOAuthAccount",data:{service:d},success:function(b){e.close();this._refreshConnectedAccounts()}},this)},
this);e.show()},_startOAuth:function(b,c,d){this._oauthClient.once("oauth-completed",function(){this.fire("oauth-completed");this._refreshConnectedAccounts()},this);this._oauthClient.authenticate(b,c,d)},reauthenticate:function(b,c){this._oauthClient.once("oauth-completed",function(){this.fire("oauth-completed")},this);this._oauthClient.authenticate(b,c)},_refreshConnectedAccounts:function(){b.Data.get({url:"/api/config/GetSocialAccounts",success:function(b){Static.SQUARESPACE_CONTEXT.connectedAccounts=
b.connectedAccounts;this.fire("account-added")}},this)}},{ATTRS:{accountTypes:{value:[]}}})},"1.0",{requires:"base base-build squarespace-oauth-authenticator squarespace-dialog squarespace-dialog-multi-option squarespace-dialog-description squarespace-dialog-text".split(" ")});
